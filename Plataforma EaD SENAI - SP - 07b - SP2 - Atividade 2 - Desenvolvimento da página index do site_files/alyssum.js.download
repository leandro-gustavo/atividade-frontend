(()=>{"use strict";var e,t,i,n,r={5762:(e,t,i)=>{i.d(t,{SV:()=>s});var n=i(7363),r=i.n(n);i(7821),i(8318);class s extends r().Component{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e,t){throw this.setState({hasError:!0}),new Error(e.message)}render(){return this.state.hasError?null:this.props.children}}},6694:(e,t,i)=>{var n=i(7363),r=i.n(n),s=i(8975),o=i(8686),a=i.n(o);window.Blsm=window.Blsm||{},Blsm.isPlainObject=e=>"[object Object]"===Object.prototype.toString.call(e),window.lng=function(e,t){var i=[].slice.call(arguments);Blsm.isPlainObject(t)&&i.splice(1,1);var n=!1;if(t&&t.phrase){if(n=Blsm.InitialData&&Blsm.InitialData.phrases&&Blsm.InitialData.phrases[e])return t.replace&&(n=n.replaceAll("%s",t.replace)),a()(n);if(t.replace)return window.lng(e,t.replace)}i[0]=Blsm.translations&&Blsm.translations[e]||e,i[0].indexOf("|")>0&&(i[0]=i[0].split("|")[0]);try{return i.length>1?s.sprintf.apply(null,i):i[0]}catch(e){return console&&console.error&&console.error(e),i[0]}};i(6418);var l=i(917),c=i(6920),d=i(7678),p=i(5560),u=i(3346),m=i(4210),g=i(7821),h=i(441),b=i(6975),v=i(8318),_=i(7392),f=i(1619),y=i(5944);const w=(0,l.iv)(".tagline{color:",c.g.colors.text_main,";font-weight:700;text-align:center;font-size:1.3rem;margin-bottom:10px;}.sub-title{display:block;text-align:center;font-weight:600;margin-top:10px;}.msg{display:block;color:",c.g.colors.positive,";text-align:center;margin-top:10px;font-size:0.9rem;&.error{color:",c.g.colors.negative,";}}.main_button{width:100%;border-radius:12px;padding:10px 0;margin-top:17px;}.bottom_link{text-align:center;margin-top:20px;font-weight:600;margin:20px -20px -20px -20px;background:",c.g.colors.bg_1,";padding:10px 0;a{color:",c.g.colors.dominant_main,";}}.password_meter{margin:20px 0;}",""),x=(0,p.observer)((function(){var e;const t=(0,n.useRef)(),i=(0,n.useRef)(),r=(0,n.useRef)(new k).current;let{auth_details:s,sms_otp:o,login_providers:a={},login_error:p,message:x,hide_form:Z}=Blsm.InitialData;const{dir:C,hash:S,vendev:O,local:B}=(0,v.Lv)();let T,N=!1;s?Z=!1:((a.google||a.facebook||a.saml)&&(T="",C&&(T+="&dir="+encodeURIComponent(C)),S&&(T+="&hash="+encodeURIComponent(S))),N=o||void 0!==T),void 0!==B&&(Z=!1);const I=(0,g.get)(r.values,"t_username")&&(0,g.get)(r.values,"t_password"),D=e=>{var n;if(null===(n=e.preventDefault)||void 0===n||n.call(e),!I)return;const r=i.current;!r||r.getValue()?t.current.submit():r.execute()};return(0,y.BX)("div",{css:[(0,l.iv)(">.ext_auth{text-align:center;margin-top:20px;>a{display:block;width:100%;border-radius:12px;border:1px solid ",c.g.colors.separator,";padding:9px 0;margin-top:15px;cursor:pointer;background-color:",c.g.colors.yellow,";color:",c.g.colors.text_main,";img{height:16px;vertical-align:sub;}}}.grecaptcha-badge{margin:15px auto 0;}.saml_button{background-color:",c.g.colors.yellow,";}.other-login-separator{display:flex;>span{display:block;border-top:1px solid ",c.g.colors.separator,";width:100%;position:relative;top:10px;margin:0 6px;}>div{flex-grow:1;white-space:nowrap;color:",c.g.colors.text_sec,";}}",""),w,"",""],children:[(0,y.tZ)("div",{className:"tagline",children:(s?lng("welcome %s",s.auth_name):lng("welcome!")).caps()}),!s&&x&&(0,y.tZ)(f.xn,{content:x}),N&&(0,y.tZ)("div",{className:"sub-title",children:(Z?lng("how would you like to connect?"):lng("enter your username & password")).caps()}),p&&(0,y.tZ)("div",{className:"msg error",children:p}),s&&(0,y.tZ)("div",{className:"msg",children:lng("please enter your login details to connect your %s account.",s.auth_provider).caps()}),!Z&&(0,y.tZ)(m.q3.Provider,{value:r,children:(0,y.BX)("form",{autoComplete:"off",method:"post",ref:t,onSubmit:D,children:[(0,y.tZ)(u.au,{input:r.fields}),(0,y.tZ)("input",{type:"submit",hidden:!0}),(0,y.tZ)(_.l,{className:"main_button",theme:"contained",disabled:!I,onClick:D,children:lng("continue").caps()}),Blsm.InitialData.recaptcha_key&&(0,y.tZ)(d.Z,{sitekey:Blsm.InitialData.recaptcha_key,size:"invisible",badge:"inline",ref:i,onChange:D,hl:Blsm.lang.short}),s&&(0,y.tZ)(_.l,{className:"main_button",theme:"outlined",onClick:()=>window.location="?",children:lng("cancel").caps()})]})}),(0,v.B5)(Blsm.user.id)&&(0,y.tZ)("div",{className:"ext_auth",children:(0,y.tZ)(h.A,{href:(C||Blsm.prm.index_url)+(void 0!==O?"?vendev":"")+(S?"#"+S:""),children:lng("enter as %s",(0,v.v2)(Blsm.user.real_data||Blsm.user)).caps()})}),N&&(0,y.BX)("div",{className:"ext_auth",children:[!Z&&(0,y.BX)("div",{className:"other-login-separator",children:[(0,y.tZ)("span",{}),(0,y.tZ)("div",{children:lng("or login with").caps()}),(0,y.tZ)("span",{})]}),o&&(0,y.BX)(h.A,{href:"#sms",children:[(0,y.tZ)(b.JO,{icon:"mobile"})," ",lng("code via text message").caps()]}),null===(e=a.saml)||void 0===e?void 0:e.map((e=>(0,y.BX)(h.A,{href:`${Blsm.prm.Mainref}oauth?s=saml${T}&id=${e.id}`,className:"saml_button",children:[(0,y.tZ)(b.JO,{icon:"suitcase"})," ",(e.login_button_text||lng("organization login")).caps()]},e.id))),a.google&&(0,y.BX)(h.A,{href:`${Blsm.prm.Mainref}oauth?s=google${T}`,children:[(0,y.tZ)(b.JO,{icon:"google"})," ",lng("continue with google").caps()]}),a.facebook&&(0,y.BX)(h.A,{href:`${Blsm.prm.Mainref}oauth?s=facebook${T}`,children:[(0,y.tZ)(b.JO,{icon:"facebook"})," ",lng("continue with facebook").caps()]})]}),Blsm.prm.register_link&&(0,y.BX)("div",{className:"bottom_link",children:[lng("don't have an account?").caps()," ",(0,y.tZ)(h.A,{href:Blsm.prm.register_link,children:lng("sign up").caps()})]})]})}));class k extends m.I{constructor(){super();const{t_username:e,t_remember:t,auth_details:i}=Blsm.InitialData;this._fields=[{type:"hidden",name:"t_login",value:1},{type:"text",name:"t_username",placeholder:lng("login name",{phrase:!0}).caps(),value:e,focusOnShow:!e},{type:"password",name:"t_password",placeholder:lng("password",{phrase:!0}).caps(),autoComplete:"current-password",focusOnShow:!!e},{type:"row_set",fields:[{type:"checkbox",name:"t_remember",label:lng("remember me"),value:t,insert:!(0,v.R4)()&&!Blsm.prm.inactivity_logout},{type:"component",node:(0,y.tZ)("div",{style:{textDecoration:"underline"},onClick:()=>window.ReactNativeWebView.postMessage("detach"),children:lng("back to connect screen").caps()}),insert:(0,v.R4)()},{type:"component",node:(0,y.tZ)("div",{children:(0,y.tZ)(h.A,{href:"#recovery",style:{whiteSpace:"nowrap",color:c.g.colors.dominant_main},children:lng("forgot password?").caps()})}),skinny:!0,align:c.g.far}]}],i&&this._fields.push({type:"hidden",name:"auth_provider",value:i.auth_provider},{type:"hidden",name:"auth_id",value:i.auth_id}),this._prepFields()}}var Z=i(81),C=i(8e3);const S=(0,p.observer)((function(){const e=Blsm.InitialData.sms_active,[t,i]=(0,n.useState)(!1),[r,s]=(0,n.useState)(""),[o,a]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),[d,p]=(0,n.useState)(!1),[m,g]=(0,n.useState)(""),[b,f]=(0,n.useState)(""),x=(0,n.useRef)();(0,n.useEffect)((()=>()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.abortFetch()}),[]);const k=()=>{i(!0),x.current=(0,C.SC)("login/recover_password",{method:"POST",data:{username:r,email:o},onComplete:()=>i(!1)},(e=>{c(e.msg),p(e.error)}))},Z=()=>{i(!0),x.current=(0,C.SC)("login/recover_user_name",{method:"POST",data:{email:m},onComplete:()=>i(!1)},(e=>{f(e)}))},S=!t&&r&&(e?o:(0,v.s$)(o)),O=!t&&(0,v.s$)(m),B=e=>S&&"Enter"===e.key&&k();return(0,y.BX)("div",{css:w,children:[(0,y.tZ)("div",{className:"tagline",children:lng("forgot your password? no worries!").caps()}),(0,y.tZ)(u.gN,{input:{type:"text",name:"rec_username",placeholder:lng("login name",{phrase:!0}).caps(),maxLength:50,onKeyUp:B},value:r,onChange:s}),(0,y.tZ)(u.gN,{input:{type:"text",name:"rec_email",placeholder:e?lng("email").caps()+" / "+lng("mobile phone").caps():lng("email").caps(),onKeyUp:B},value:o,onChange:a}),l&&(0,y.tZ)("div",{className:(0,v.AK)("msg",{error:d}),children:l.split("\n").map(((e,t)=>(0,y.tZ)("div",{children:e},t)))}),(0,y.tZ)(_.l,{className:"main_button",theme:"contained",disabled:!S,onClick:k,children:(t?lng("please wait"):e||(0,v.s$)(o,!0)?lng("reset my password"):lng("enter valid email")).caps()}),(0,y.tZ)("div",{style:{textAlign:"center",margin:"20px 0"},children:lng("or")}),(0,y.tZ)("div",{className:"tagline",children:lng("forgot your user name?").caps()}),(0,y.tZ)(u.gN,{input:{type:"text",name:"name_rec_email",placeholder:lng("email").caps(),onKeyUp:e=>O&&"Enter"===e.key&&Z()},value:m,onChange:g}),b&&(0,y.tZ)("div",{className:"msg",children:b.split("\n").map(((e,t)=>(0,y.tZ)("div",{children:e},t)))}),(0,y.tZ)(_.l,{className:"main_button",theme:"contained",disabled:!O,onClick:Z,children:(t?lng("please wait"):(0,v.s$)(m,!0)?lng("send me my user name"):lng("enter valid email")).caps()}),(0,y.tZ)("div",{className:"bottom_link",children:(0,y.tZ)(h.A,{href:"#",children:lng("back to login").caps()})})]})})),O=(0,p.observer)((function(){const e=(0,n.useRef)(),[t,i]=(0,n.useState)(""),{login_error:r,otp_form:s}=Blsm.InitialData;let o;return o="sms"===s.type?lng("enter the code"):lng("enter 2-step verification code"),(0,y.BX)("div",{css:w,children:[s.msg&&(0,y.tZ)("div",{className:"sub-title",dangerouslySetInnerHTML:{__html:s.msg}}),r&&(0,y.tZ)("div",{className:"msg error",children:r}),(0,y.BX)("form",{autoComplete:"off",method:"post",ref:e,onSubmit:t?void 0:e=>e.preventDefault(),children:[(0,y.tZ)(u.gN,{input:{type:"text",name:"t_otp",placeholder:o.caps(),maxLength:10,focusOnShow:!0},value:t,onChange:i}),(0,y.tZ)("input",{type:"submit",hidden:!0}),(0,y.tZ)(_.l,{className:"main_button",theme:"contained",disabled:!t,onClick:()=>e.current.submit(),children:lng("continue").caps()})]}),(0,y.tZ)("div",{className:"bottom_link",children:(0,y.tZ)(h.A,{href:"#",children:lng("back to login").caps()})})]})}));var B=i(1786);const T=(0,p.observer)((function(e){let{recovery:t}=e;const i=(0,n.useRef)(),[r,s]=(0,n.useState)(t?void 0:""),[o,a]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),{login_error:d,password_options:p}=Blsm.InitialData,m={minlength:p.minlength,change_threshold:p.change_threshold,complex:p.complex};let g=!0;return o&&l&&(t||r)?0===(0,B.x)(o,{oldPassword:r,requirements:m}).rate?g=lng("better password required"):o!==l&&(g=lng("both passwords must match")):g=!1,(0,y.BX)("div",{css:w,children:[(0,y.tZ)("div",{className:"tagline",children:t?lng("reset your password").caps():Blsm.InitialData.reason}),d&&(0,y.tZ)("div",{className:"msg error",children:d}),(0,y.BX)("form",{autoComplete:"off",method:"post",ref:i,onSubmit:!0===g?void 0:e=>e.preventDefault(),children:[!t&&(0,y.tZ)(u.gN,{input:{type:"password",name:"old_password",placeholder:lng("old password").caps(),autoComplete:"current-password",focusOnShow:!0},className:"old_password",value:r,onChange:s}),(0,y.tZ)(u.gN,{input:{type:"password",name:"new_password",placeholder:lng("new password").caps(),autoComplete:"new-password"},value:o,onChange:a}),(0,y.tZ)(B.k,{className:"password_meter",password:o,oldPassword:!t&&p.check_history?r:void 0,requirements:m}),(0,y.tZ)(u.gN,{input:{type:"password",name:"confirm_password",placeholder:lng("confirm new password").caps(),autoComplete:"new-password"},value:l,onChange:c}),(0,y.tZ)("input",{type:"submit",hidden:!0}),(0,y.tZ)(_.l,{className:"main_button",theme:"contained",disabled:!0!==g,onClick:()=>i.current.submit(),children:("string"==typeof g?g:lng("continue")).caps()}),!t&&(0,v.B5)(Blsm.user.id)&&(0,y.tZ)("div",{className:"msg",children:lng("currently logged as %s",(0,v.v2)(Blsm.user)).caps()})]})]})})),N=(0,p.observer)((function(){const e=(0,n.useRef)(),t=(0,n.useRef)(new I).current,{login_error:i}=Blsm.InitialData,r=(0,g.get)(t.values,"t_username"),s=t=>{var i;null===(i=t.preventDefault)||void 0===i||i.call(t),r&&e.current.submit()};return(0,y.BX)("div",{css:w,children:[(0,y.tZ)("div",{className:"tagline",children:lng("welcome!").caps()}),(0,y.tZ)("div",{className:"sub-title",children:lng("enter your username and receive a code to your mobile").caps()}),i&&(0,y.tZ)("div",{className:"msg error",children:i}),(0,y.tZ)(m.q3.Provider,{value:t,children:(0,y.BX)("form",{autoComplete:"off",method:"post",ref:e,onSubmit:s,children:[(0,y.tZ)(u.au,{input:t.fields}),(0,y.tZ)("input",{type:"submit",hidden:!0}),(0,y.tZ)(_.l,{className:"main_button",theme:"contained",disabled:!r,onClick:s,children:lng("send code to my mobile").caps()})]})}),(0,y.tZ)("div",{className:"bottom_link",children:(0,y.tZ)(h.A,{href:"#",children:lng("back").caps()})})]})}));class I extends m.I{constructor(){super();const{t_username:e,t_remember:t}=Blsm.InitialData;this._fields=[{type:"hidden",name:"t_login",value:"sms_only"},{type:"text",name:"t_username",placeholder:lng("login name",{phrase:!0}).caps(),value:e,focusOnShow:!e},{type:"row_set",fields:[{type:"checkbox",name:"t_remember",label:lng("remember me"),value:t,insert:!(0,v.R4)()&&!Blsm.prm.inactivity_logout}]}],this._prepFields()}}var D=i(409),j=i(4576);function P(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const z=(0,p.observer)((function(){const{registration_fields:e}=Blsm.InitialData,[t,i]=(0,n.useState)(!1),[r,s]=(0,n.useState)(""),o=(0,n.useRef)(),a=(0,n.useRef)(null);a.current||(a.current=new E);const l=a.current;let c=!0;const d=l.errors.values().next();d.done||(c=d.value),!0!==c||l.allFilled(["user_first_name","user_last_name","user_name","user_email","user_password","user_password_confirmation"])||(c=!(null==e||!e.length)&&lng("fill all basic details"));const p=(0,n.useRef)();(0,n.useEffect)((()=>()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.abortFetch()}),[]);return(0,y.BX)("div",{css:w,children:[(0,y.tZ)("div",{className:"tagline",children:lng("new user? welcome!").caps(!1)}),r&&(0,y.tZ)("div",{className:"msg error",children:r}),(0,y.tZ)(m.q3.Provider,{value:l,children:(0,y.BX)("form",{autoComplete:"off",method:"post",ref:o,onSubmit:e=>e.preventDefault(),children:[(0,y.tZ)(u.au,{input:l.fields}),(0,y.tZ)(_.l,{className:"main_button",theme:"contained",disabled:t||!0!==c,onClick:()=>l.validate().then((e=>!0===e&&(i(!0),void(p.current=(0,C.SC)("login/create_user_self",{method:"POST",data:l.buildFinalValues(),onComplete:()=>i(!1)},(e=>{if(e.url)return location.href=e.url;s(e.error||"")})))))),children:("string"==typeof c?c:lng("continue")).caps()})]})}),(0,y.BX)("div",{className:"bottom_link",children:[lng("already have an account?")," ",(0,y.tZ)(h.A,{href:Blsm.prm.Mainref+"login",children:lng("login").caps()})]})]})}));class E extends m.I{constructor(){super(),P(this,"validateOnChange",!0);const{registration_fields:e=[],org_units:t,custom_fields:i,password_options:n,field_masks:r,mandatory_fields:s=[],domain:o,unique_user_identity_num:a,quota_limits:l}=Blsm.InitialData,c=(0,p.observer)((function(e){let{value:t}=e;return(0,y.tZ)(B.k,{password:(0,g.get)(t,"user_password"),requirements:{minlength:n.minlength}})}));this._fields=[{type:"section",fields:[{type:"hidden",name:"domain_id",value:o},{type:"row_set",fields:[{type:"text",name:"user_first_name",label:lng("first name")},{type:"text",name:"user_last_name",label:lng("last name")}]},{type:"text",name:"user_name",label:lng("login name",{phrase:!0}),remoteValidate:{url:"login/validate_user_name"}},{type:"text",name:"user_email",label:lng("email"),validate:e=>!!(0,v.s$)(e)||{error:lng("please insert valid email")}},{type:"row_set",fields:[{type:"password",name:"user_password",label:lng("password"),autoComplete:"new-password",validate:e=>0<(0,B.x)(e,{requirements:{minlength:n.minlength}}).rate||{error:lng("better password required")}},{type:"password",name:"user_password_confirmation",label:lng("confirm password"),validate:e=>(0,g.get)(this.values,"user_password")===e||{error:lng("both passwords must match")}}]},{type:"component",Render:c}]}];for(const e of this._fields[0].fields)if(e.fields)for(const t of e.fields)this._fieldMask(t,r);else this._fieldMask(e,r);const d=[],u=[];for(let n of e){let e;if("user_gender"===n)e={type:"select",options:[["Male",lng("male").caps()],["Female",lng("female").caps()],["Other",lng("other",{phrase:!0}).caps()]],emptyOption:!0};else if("user_ou"===n)e={type:"select",options:t,emptyOption:!0};else if("employment_date"===n||"user_birthdate"===n)e={type:"date"};else{if(i[n]){u.push(i[n]);continue}e={type:"text"}}e.name=n,e.label||(e.label=(0,D.X)(n).caps()),e.maxLength=(0,j.i1)(n),a&&"user_identity_num"===n&&(e.remoteValidate=`login/validate_user_identity_num/domain=${o}&`),this._fieldMask(e,r),d.push(e)}u.length&&d.push(...this._customFieldsPrep(u));for(let e of d)e.name&&(this._fieldMask(e,r),s.includes(e.name)&&"checkbox"!==e.type&&(e.required=!0));d.length&&(this._fields.push({type:"section",title:lng("extra details"),titleSmall:!0,fields:d}),Object.assign(this._fields[0],{title:lng("basic details"),titleSmall:!0})),!1===l["can create"]&&(this.disableFields(this._fields),this._fields.unshift({type:"component",node:`${lng("currently, registration is not possible").caps()} (${lng("user quota reached")})`})),this._prepFields()}disableFields(e){for(let t of e)t.fields?this.disableFields(t.fields):t.disabled=!0}}var R=i(3051),F=i(2698),M=i(9523);const A=(0,l.iv)("z-index:1;display:flex;background-color:",c.g.colors.bg_main,";",c.g.classes.shadow_strong,";position:fixed;justify-content:flex-end;top:20px;",c.g.far,":30px;padding:7px;border-radius:50px;",c.g.mQuery.mobile,"{top:0;",c.g.far,":0;width:100%;border-radius:0;}>div{padding:3px 10px;&:not(:first-of-type){",c.g.classes.border_near(`1px solid ${c.g.colors.separator}`),";}a{&:hover{text-decoration:underline;}}._btn{font-weight:600;}}",""),q=function(e){let{registrationMode:t}=e;const i=Blsm.lang.available&&Object.entries(Blsm.lang.available).map((e=>{let[t,i]=e;return{val:t,label:i,active:Blsm.lang.current===t}}));return(0,y.BX)("div",{css:A,children:[(0,v.B5)(Blsm.user.id)&&(0,y.tZ)("div",{children:(0,y.tZ)(b.JO,{icon:"exit",href:Blsm.prm.Mainref+"?logout=1",toolTip:lng("logout")})}),!t&&Blsm.prm.register_link&&(0,y.tZ)("div",{children:(0,y.tZ)(h.A,{href:Blsm.prm.register_link,children:lng("register").caps()})}),!t&&Blsm.prm.anonymous_portal&&(0,y.tZ)("div",{children:(0,y.tZ)(h.A,{href:Blsm.prm.Mainref+"?anonymous=1#portal",children:lng("portal").caps()})}),!t&&Blsm.prm.anonymous_courses_catalog&&(0,y.tZ)("div",{children:(0,y.tZ)(h.A,{href:Blsm.prm.Mainref+"?anonymous=1#cregistration",children:lng("courses catalog").caps()})}),i&&(0,y.tZ)("div",{children:(0,y.tZ)(R.x,{options:i,onSelect:M.rt,dropDownLike:!0,children:Blsm.lang.current.substring(0,2).caps()})}),(0,y.tZ)("div",{children:(0,y.tZ)(F.Dq,{})})]})};const X={name:"1n6so1b",styles:"line-height:1em;border-radius:20px;padding:5px;max-width:40px;white-space:nowrap;height:40px;overflow:hidden;background-color:white;color:#505050;position:fixed;bottom:20px;left:20px;transition:max-width 1s;.Icon{display:inline-block;vertical-align:middle;transition:transform .3s ease-in;font-size:24px;margin:3px;}&:hover{max-width:100%;.Icon{transform:rotate(360deg);}}"},L=function(){const{contact_link:e}=Blsm.InitialData;return e?(0,y.BX)(h.A,{css:X,href:e,newTab:!0,children:[(0,y.tZ)(b.JO,{icon:"support_login"}),"   ",lng("contact & support").caps(!1),"  "]}):null};var $=i(3178),V=i(8973);const U=()=>(0,l.iv)("color:",c.g.colors.text_sec,";>.middle{min-height:100vh;display:flex;justify-content:center;align-items:center;",c.g.mQuery.mobile,"{padding-top:40px;}>._dialog{background-color:",c.g.colors.bg_main,";",c.g.classes.shadow_strong,';width:360px;max-width:90vw;margin:20px 0;border-radius:20px;overflow:hidden;padding:20px;.logo{background:transparent url("',c.g.theme.login_logo,'") no-repeat center center;background-size:contain;height:63px;margin:27px 0;}.separator{border-bottom:1px solid ',c.g.colors.separator,";margin:0 12px 30px;}}}.qr{position:fixed;opacity:0.8;bottom:20px;right:20px;border:2px solid white;}",""),H=function(e){let{text:t}=e;return(0,y.BX)("div",{css:w,children:[(0,y.tZ)("div",{style:{textAlign:"center"},children:t.caps()}),(0,y.tZ)("div",{className:"bottom_link",children:(0,y.tZ)(h.A,{href:"#",children:lng("back to login").caps()})})]})};var J=i(4238),G=i(2213),W=i(9483);const K=(0,l.iv)("width:660px;max-width:100%;padding:10px;margin:0 auto;.subject{color:",c.g.colors.text_main,";font-size:1.6em;font-weight:700;margin-bottom:10px;}.greeting{color:",c.g.colors.text_main,";font-size:1.2em;margin-bottom:20px;}",""),Y=(0,p.observer)((function(e){let{com_id:t,subject:i,patient_first_name:r,patient_last_name:s}=e;const[o,a]=(0,n.useState)(!1),l={type:"patients_communication",object_id:t},c=new G.pE(l,{endPoint:"patientCom"});return(0,y.BX)("div",{css:K,children:[(0,y.tZ)(V.Y,{bgColor:"#fff"}),(0,y.tZ)(W.m,{className:"subject",children:i}),(0,y.tZ)(W.m,{className:"greeting",children:`${lng("hello").caps()} ${r} ${s}`}),o?(0,y.tZ)("div",{className:"greeting",children:lng("your message was sent, you can now close the window.").caps()}):(0,y.tZ)(J.H,{commentsStore:c,connectTo:c.connectTo,afterSend:()=>a(!0),confirmSend:!0,richTextOptions:{attach:!0}})]})}));var Q=i(6852),ee=i(4074);const te={name:"18fwt0k",styles:"margin:0 auto 50px;max-width:1000px;.chart-title{font-size:20px;text-align:center;}"};var ie=i(1092);i(7882);const ne=(0,l.iv)(c.g.classes.margin_far("5px"),";display:flex;flex-direction:column;height:100%;overflow:hidden;>.Tabs{flex-grow:0;margin:10px 0;display:flex;justify-content:center;}",""),re=function(e){let{assignmentId:t,opened:i}=e;const[r,s]=(0,n.useState)("launcher"),o=(0,n.useRef)({}).current,a=(0,n.useRef)();if((0,n.useEffect)((()=>{Blsm.InitLauncherComments=e=>o[r]&&(o[r].inner_context=e),Blsm.prm.performance_id&&setInterval((()=>(0,C.SC)("generic/performance_online/performance="+Blsm.prm.performance_id)),3e4)}),[]),(0,n.useEffect)((()=>{var e;return i&&(null===(e=a.current)||void 0===e?void 0:e.resize())}),[i]),!i)return null;o[r]||(o[r]=new G.pE({object_id:t,type:r,to_user:"launcher_manager"===r?Blsm.user.id:void 0}));const l=[{val:"launcher",label:lng("public")},{val:"launcher_private",label:lng("personal")},{val:"launcher_manager",label:lng("manager")}];return(0,y.BX)("div",{css:ne,children:[(0,y.tZ)(ie.m,{tabs:l,activeTab:r,onSelect:s,ref:a}),(0,y.tZ)(J.H,{commentsStore:o[r],connectTo:o[r].connectTo,refresh:"launcher_private"!==r,spreadHeight:"calc(100% - 60px)"})]})};var se=i(745);const oe=e=>(0,l.iv)("width:100%;height:100%;background:transparent url('",e,"') no-repeat center;background-size:contain;",""),ae=(0,n.memo)((function(e){let{image:t}=e;return(0,y.tZ)("div",{css:oe(t)})}));var le=i(6220),ce=i(2334);const de={name:"kh17m3",styles:"width:100%;height:100%;>.MediaPlayer{display:block;height:100%;.Equalizer{height:100%;}}"},pe=(0,n.memo)((function(e){const t=(0,n.useRef)(),i=(0,n.useRef)({sum:0,lastTime:0}).current;return(0,n.useEffect)((()=>{var n,r;null===(n=(r=Blsm).InitLauncherComments)||void 0===n||n.call(r,"0",10),t.current.addEventListener("timeupdate",(()=>{var e,n;const r=t.current.currentTime;i.sum+=r-i.lastTime,i.lastTime=r;const s=Math.floor(r);null===(e=(n=Blsm).InitLauncherComments)||void 0===e||e.call(n,""+s,10,(0,ce.xt)(s))})),t.current.addEventListener("seeking",(()=>{i.lastTime=t.current.currentTime})),t.current.addEventListener("ended",(()=>null==e?void 0:e.onEnded())),Blsm.prm.measure_time_pid&&window.addEventListener("beforeunload",(()=>{Blsm.beacon(Blsm.prm.Mainref+"api?/assignment/update_performance_data",{performance_id:Blsm.prm.measure_time_pid,performance_data:JSON.stringify({video_view_time:i.sum,video_duration:t.current.duration})})}))}),[]),(0,y.tZ)("div",{css:de,children:(0,y.tZ)(le.S,{...e,mediaRef:t})})}));const ue={name:"1osfmq2",styles:"vertical-align:bottom;border:0;width:100%;height:100%"},me=(0,n.memo)((function(e){let{url:t,name:i}=e;return(0,y.tZ)("iframe",{css:ue,src:t,name:i,allowFullScreen:!0,allow:"microphone *; camera *; fullscreen *; autoplay *"})}));var ge=i(539),he=i(5155),be=i(8534);const ve={name:"xzur6n",styles:"margin-top:10px;padding:10px;background-color:#f5f5f5;border-radius:5px;>form{._buttons{padding:15px 0;display:flex;justify-content:center;}}"},_e=(0,p.observer)((function(e){let{form:t}=e;return(0,y.tZ)("div",{css:ve,children:(0,y.tZ)(m.q3.Provider,{value:t,children:t.status?(0,y.tZ)(ge.$,{}):(0,y.BX)("form",{autoComplete:"off",onSubmit:e=>e.preventDefault(),children:[(0,y.tZ)(u.au,{input:t.fields}),(0,y.tZ)("div",{className:"_buttons",children:(0,y.tZ)(he.O,{primary:!0,onClick:t.callSave,highlight:t.dirty,id:"submit_button",children:t.confirmButtonLabel})})]})})})}));class fe extends m.I{constructor(e,t,i){super(e);const{details:n={},may_upload_file:r,request:s,request_id:o,optional_approvers:a}=e;if(this.confirmButtonLabel=lng("submit").caps(),"manager_review"===t);else if("approval_waiting"===t)this._fields.push({type:"hidden",name:"change_file",value:1}),!s.status&&r&&this._fields.push({type:"file",name:i?"files":"file",label:i?lng("add files"):lng("change file"),maxSize:Blsm.InitialData.parameters.max_file_size.activity,required:!0,multiFile:i});else{var l,c,d;this._fields.push({type:"hidden",name:"submit_request",value:1}),"1"===n.user_text&&this._fields.push({type:"textarea",name:"user_text",label:lng("enter text")}),r&&this._fields.push({type:"file",name:i?"files":"file",label:i?lng("add files"):lng("attach a file"),maxSize:Blsm.InitialData.parameters.max_file_size.activity,multiFile:i}),o&&this._fields.push({type:"hidden",name:"request_id",value:o}),null!==(l=n.assignment_options)&&void 0!==l&&l.partner_submission&&r&&"manager_review"!==n.completion_requirement&&this._fields.push({type:"multiple_items",name:"partner",label:lng("add partners"),poster:!0,theme:"bright",searchData:(e,t)=>{(0,C.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||"",group:n.group_id,assignment:n.assignment_id,exclude_self:1}},t)}}),a&&this._fields.push({type:"select",name:"approver_id",label:lng("select approver"),options:(0,v.wd)(a)}),null!==(c=n.assignment_options)&&void 0!==c&&c.reading_confirmation_signature&&this._fields.push({type:"signpad",name:"reading_confirmation_signature",label:lng("sign in the section below to confirm submission").caps()+":",required:!0}),null!==(d=n.assignment_options)&&void 0!==d&&d.reading_confirmation_password&&this._fields.push({type:"password",name:"reading_confirmation_password",label:lng("type your password to confirm submission"),required:!0,remoteValidate:{url:"users/verify_password",method:"POST",parseResult:e=>!0===e.pass?"":lng("wrong password").caps()}})}this._prepFields(),this.ready=!0}save(e){this.saveToUrl("Launcher?"+(0,v.$t)((0,v.Lv)()),e)}SaveSuccess(e){e.error?(this.status="",(0,be.Mj)(e.error||lng("unknown error"))):e.redirect?"ReturnToMainPage"===e.redirect?window.ReturnToMainPage():location=e.redirect:location.reload()}}var ye=i(676),we=i(5940),xe=i(9637);const ke=function(e){let{request:t}=e;const i=e=>(0,C.hn)(null,{request:t.request_id,partner_status:1,status:e}),n=[{title:lng("name").caps()},{title:lng("status").caps()}];return(0,y.tZ)(ye.iA,{cols:n,collection:t.partners,RowRenderer:e=>{let{row:n}=e;return(0,y.BX)("tr",{children:[(0,y.tZ)(xe.U6,{children:(0,y.tZ)(h.A,{href:{user:n.user_id,absolute:!0},children:(0,v.v2)(n)})}),(0,y.BX)("td",{children:["accepted"===n.status?(0,y.tZ)("span",{style:{color:c.g.colors.positive},children:lng("accepted").caps()}):"declined"===n.status?(0,y.tZ)("span",{style:{color:c.g.colors.negative},children:lng("declined").caps()}):lng("waiting").caps(),"  ",(0,v.Tz)(n.user_id)&&"accepted"!==n.status&&(0==t.approval_step||1==t.approval_step)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(we.zx,{theme:we.jR,onClick:()=>i("accepted"),children:lng("join as partner").caps()}),!n.status&&(0,y.BX)(y.HY,{children:[" ",(0,y.tZ)(we.zx,{theme:we.AE,onClick:()=>i("declined"),children:lng("decline join request").caps()})]})]})]})]})},rowIdCol:"user_id"})};var Ze=i(8567),Ce=i(9180);const Se=function(e){let{request_report:t,multiFile:i}=e;const[r,s]=(0,n.useState)(0),o=[{title:"#"},{title:lng("user").caps()},{title:lng("time").caps()},{title:lng("data").caps()}];return(0,y.BX)("div",{className:"_section",children:[(0,y.BX)("div",{className:"blue_title",children:[lng("this activity is waiting for approval").caps(),":"]}),(0,y.tZ)(ye.iA,{cols:o,collection:t.steps,RowRenderer:e=>{var n,o;let{row:a}=e;return(0,y.BX)("tr",{children:[(0,y.tZ)("td",{children:a.step}),(0,y.tZ)(xe.U6,{children:(0,y.tZ)(h.A,{href:{user:a.user_id,absolute:!0},children:(0,v.v2)(a)})}),(0,y.tZ)("td",{children:(0,y.tZ)(Ce.qp,{time:a.time})}),(0,y.BX)("td",{children:[a.text,(null===(n=t.step_files)||void 0===n||null===(o=n[a.step])||void 0===o?void 0:o.length)>0&&(0,y.tZ)("div",{children:t.step_files[a.step].map((e=>(0,y.BX)("div",{children:[(0,y.BX)(h.A,{href:{file:e},newTab:!0,children:[e.file_name," (",(0,y.tZ)(Ce.qp,{time:e.creation_time}),")"]})," ",i&&(0,y.tZ)(b.JO,{icon:"trash",onClick:()=>{return i=a.step,n=e.file_id,void(0,Ze.BB)(lng("are you sure you want to delete this file?"),{onConfirm:()=>{(0,C.SC)("file/file_id="+n,{method:"DELETE"}),t.step_files[i]=t.step_files[i].filter((e=>e.file_id!==n)),s(r+1)}});var i,n}})]},e.file_id)))})]})]})},rowIdCol:"step"})]})};var Oe=i(8714);const Be=(0,l.iv)("padding:10px;background-color:#f5f5f5;border-radius:5px;>.review_head{display:flex;align-items:center;width:100%;>.by_user{flex-grow:1;}>.review_status{background-color:#00A8F6;padding:5px;border-radius:4px;color:white;&.Review{background-color:",c.g.colors.chart.progress,";}&.Yes{background-color:",c.g.colors.chart.success,";}}}>.review_text{font-size:1.3em;padding:20px 0;}>.files_list{margin-bottom:20px;}>.Comments{padding:20px 10px;}",""),Te=function(e){var t;let{performance:i}=e;const{user_id:n,answer_text:r,files:s,performance_id:o,performance_completed:a,canSetScore:l,performance_score:c}=i,d=new G.pE({type:"performance",object_id:o});return(0,y.BX)("div",{css:Be,className:"_section",children:[(0,y.BX)("div",{className:"review_head",children:[(0,y.BX)("div",{className:"by_user",children:[(0,v.Tz)(n)?lng("your answer"):lng("%s's answer",(0,v.v2)(i)),":"]}),(0,v.Tz)(i.user_id)&&(0,y.BX)("div",{className:(0,v.AK)("review_status",a),children:["Review"===a&&lng("under review").caps(),"Yes"===a&&`${lng("score").caps()}: ${c}`]}),((null===(t=Blsm.InitialData)||void 0===t?void 0:t.canSetScore)||l)&&(0,y.tZ)(Ie,{performance_id:o,initialScore:"Yes"===a?parseInt(c):void 0})]}),(0,y.tZ)(W.m,{className:"review_text",value:r,children:(0,v.rj)(r)}),(null==s?void 0:s.length)>0&&(0,y.tZ)("div",{className:"files_list",children:s.map((e=>(0,y.tZ)("div",{children:(0,y.BX)(h.A,{href:{file:e},newTab:!0,children:[e.file_name," (",(0,y.tZ)(Ce.qp,{time:e.creation_time}),")"]})},e.file_id)))}),(0,y.tZ)(J.Y.Provider,{value:{bgColor:"white"},children:(0,y.tZ)(J.H,{commentsStore:d,connectTo:d.connectTo})})]})},Ne={name:"kig23s",styles:">.Icon.disabled{color:silver;}"},Ie=function(e){let{initialScore:t,performance_id:i}=e;const[r,s]=(0,n.useState)(t),o=!(0,v.kE)(r)||t===r;return(0,y.BX)("div",{css:Ne,children:[" ",lng("set score").caps(),": ",(0,y.tZ)(Oe.A,{min:0,max:100,value:r,onChange:s})," ",(0,y.tZ)(b.JO,{icon:"mark_v_strong",className:(0,v.AK)({disabled:o}),disabled:o,toolTip:lng("save score"),onClick:()=>{if(o)return;const e={req:"set_score",score:r,performance_id:i};(0,C.SC)("Launcher?"+(0,v.$t)((0,v.Lv)()),{method:"POST",data:e},(()=>{location.reload()}))}})]})},De=(0,l.iv)("padding:0 15px 15px 15px;margin:0 auto;max-width:800px;overflow:hidden;._head{margin:25px 0;>._title{margin:15px 0;font-size:1.5em;font-weight:600;}>._description{font-size:1.2em;}>._files_links{margin:15px 0;font-size:0.9em;._files_header{font-size:1.1rem;text-decoration:underline;}}}.blue_title{color:",c.g.colors.dominant_main,";}._section{margin:25px 0;}",""),je=(0,n.memo)((function(e){var t;const{details:i={},assignment:r={},other_users_answers:s,files_links:o,request:a,request_report:l,partner_requests:c}=e,d="sequence"===i.completion_requirement;let p=!1;"manager_review"===i.completion_requirement&&["Review","Yes"].includes(r.performance_completed)?p="manager_review":r.approval_waiting&&a&&(p="approval_waiting");const u=(0,n.useMemo)((()=>new fe(e,p,d)),[]);return(0,y.BX)("div",{css:De,children:[(0,y.BX)("div",{className:"_head",children:[i.assignment_name&&(0,y.tZ)(W.m,{className:"_title",children:i.assignment_name.caps()}),i.text&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(W.m,{className:"_title",children:lng("description").caps()+":"}),(0,y.tZ)(f.xn,{className:"_description",content:i.text})]}),i.instructions&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(W.m,{className:"_title",children:lng("instructions").caps()+":"}),(0,y.tZ)(f.xn,{className:"_instructions",content:i.instructions})]}),(null==o?void 0:o.length)>0&&(0,y.BX)("div",{className:"_files_links",children:[(0,y.BX)("div",{className:"_files_header",children:[lng("attachments").caps(),":"]}),o.map((e=>{let[t,i]=e;return(0,y.tZ)("div",{children:(0,y.tZ)(h.A,{href:t,children:i})},t)}))]})]}),"manager_review"===p&&(0,y.tZ)(Te,{performance:r}),"approval_waiting"===p&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(Se,{request_report:l,multiFile:d}),(null===(t=a.partners)||void 0===t?void 0:t.length)>0&&(0,y.BX)("div",{className:"_section",children:[(0,y.BX)("div",{className:"blue_title",children:[lng("your partners").caps(),":"]}),(0,y.tZ)(ke,{request:a})]})]}),!p&&(0,y.tZ)(y.HY,{children:(null==c?void 0:c.length)>0&&(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{className:"_section",children:[(0,y.BX)("div",{className:"blue_title",children:[lng("join one of the following partner groups, or create new submission below").caps(),":"]}),c.length>1&&(0,y.BX)("i",{children:[lng("you can only join one group of partners").caps(),"!"]}),c.map(((e,t)=>(0,y.BX)(n.Fragment,{children:[c.length>1&&(0,y.BX)("div",{children:["#",t+1]}),(0,y.tZ)(ke,{request:e},e.request_id)]},t)))]}),(0,y.BX)("div",{className:"blue_title",children:[lng("create new submission").caps(),":"]})]})}),u.fields.length>0&&(0,y.tZ)(_e,{form:u}),"manager_review"===i.completion_requirement&&(null==s?void 0:s.length)>0&&(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{className:"blue_title",children:[lng("other users answers").caps(),":"]}),s.map((e=>(0,y.tZ)(Te,{performance:e},e.performance_id)))]})]})}));const Pe={name:"jixj4z",styles:"width:100%;height:100%;direction:ltr"},ze=(0,n.memo)((function(){return(0,y.tZ)("div",{css:Pe,id:"kaltura_launcher_player"})})),Ee=(0,l.iv)("padding:0 15px 15px 15px;margin:0 auto;max-width:800px;overflow:hidden;background-color:",c.g.colors.bg_main,";._head{padding:10px 0;._title{margin:15px 0;font-size:1.5em;font-weight:600;}._author{margin:15px 0;font-size:1.2em;font-weight:600;}._description{font-size:1em;}._last-modified{font-weight:600;}}._content{margin-top:10px;padding:10px;min-height:50px;background-color:",c.g.colors.background_dark,';border-radius:5px;font-size:1.2em;ul,ol{padding:0 20px;}img[src]{max-width:100%;max-height:500px;height:auto;margin:0 auto;@media screen and (max-width: unit((1024 - 1), px)){margin:0;}&[style*="width"]{max-height:initial;}&.image-max-width{width:100%;max-height:initial;}}}',""),Re=(0,n.memo)((function(e){let{name:t,lesson_description:i,lesson_data:n,lesson_author:r,last_modified:s}=e;return(0,y.BX)("div",{css:Ee,children:[(0,y.BX)("div",{className:"_head",children:[t&&(0,y.tZ)(W.m,{className:"_title",children:t.caps()}),r&&(0,y.BX)(W.m,{className:"_author",children:[lng("by").caps(),": ",r.caps()]}),i&&(0,y.tZ)(f.xn,{content:i,className:"_description"}),s&&(0,y.BX)(W.m,{className:"_last-modified",children:[lng("last modified").caps()+": "," ",(0,v.rj)((0,ce.GG)(s,{time:!0,date:!0}))]})]}),(0,y.tZ)(f.xn,{content:n,className:"_content"})]})}));const Fe=(0,n.memo)((function(e){let{url:t,conversion_required:i,post:r}=e;const[s,o]=(0,n.useState)(i);return window.pageChanged||(window.pageChanged=e=>Blsm.InitLauncherComments(""+--e)),(0,n.useEffect)((()=>{var e,t;null===(e=(t=Blsm).InitLauncherComments)||void 0===e||e.call(t,"0")}),[]),s?(0,y.tZ)(Ae,{onReady:()=>o(!1),post:r}):(0,y.tZ)(me,{url:t})})),Me={name:"eub3t0",styles:"display:flex;height:100%;align-items:center;justify-content:center;font-size:1.5em"},Ae=e=>{let{onReady:t,post:i}=e;const[r,s]=(0,n.useState)(null);return(0,n.useEffect)((()=>{(0,C.SC)("Launcher"+location.search+"&conv=1",{method:"POST",data:i},(e=>{e.conv_err?s(e.conv_err):t(e)}))}),[]),(0,y.tZ)("div",{css:Me,children:r||(0,y.tZ)(ge.$,{label:lng("please wait, document is getting ready...").caps(),color:c.g.colors.text_main})})},qe=(0,l.iv)("width:100%;height:100%;outline-width:0;.slide-main{",c.g.classes.float,";width:100%;height:100%;text-align:center;transition:width 200ms;position:relative;min-width:320px;.slide-img{width:100%;height:100%;background-repeat:no-repeat;background-position:center center;background-size:contain;transition:background 300ms;}.slideNav{position:absolute;top:0;height:100%;background:rgba(0, 0, 0, 0.2);cursor:pointer;display:flex;align-items:center;opacity:0;transition:opacity 200ms;&.prev{",c.g.near,":0;}&.next{",c.g.far,":0;}>.Icon{font-size:40px;color:#fff;}&:hover{opacity:1;}}}.slide-comments{",c.g.classes.float,";height:calc(100vh - 60px);display:none;overflow:auto;white-space:nowrap;background:#fff;>.comments>.comments-list{margin:10px;}}&.comments-open{.slide-comments{display:block;white-space:normal;width:330px;}.slide-main{width:calc(100% - 330px);padding:0 10px;}}&.arrows-visible .slideNav{opacity:1;}",""),Xe=(0,n.memo)((function(e){let{lesson_id:t,total_slides:i,fileTitle:r,conversion_required:s,post:o,setTitleAppendix:a}=e;const[l,d]=(0,n.useState)(s),[p,u]=(0,n.useState)(0),[m,g]=(0,n.useState)(i);m&&a(` (${p+1}/${m})`);const h=(0,n.useMemo)((()=>m&&(0,v.w6)(m).map((e=>{const i=new Image;return i.src=`GetFile.php?type=lesson_slide&lid=${t}&ft=${encodeURIComponent(r)}&sn=${e}`,i}))),[t,m,r]),[_,f]=(0,n.useState)(0),w=(0,n.useCallback)((0,v.Ds)((()=>f(!1)),1e3),[f]),x=e=>u(Math.min(m-1,Math.max(0,p+e))),k=(0,n.useRef)(0),Z=e=>{const t=(new Date).getTime();t-k.current>400&&(k.current=t,x(e))};return(0,n.useEffect)((()=>{var e,t;null===(e=(t=Blsm).InitLauncherComments)||void 0===e||e.call(t,p)}),[p]),l?(0,y.tZ)(Ae,{onReady:e=>{let{total_slides:t}=e;return g(t),d(!1)},post:o}):(0,y.tZ)("div",{css:qe,className:(0,v.AK)({"arrows-visible":_}),onMouseMove:()=>{!_&&f(!0),w()},tabIndex:0,onKeyDown:e=>{const t="ArrowRight"===e.key?1:"ArrowLeft"===e.key?-1:0;0!==t&&x(t*(c.g.isRTL?-1:1))},ref:e=>null==e?void 0:e.focus(),children:(0,y.BX)("div",{className:"slide-main",children:[p>0&&(0,y.tZ)("div",{onClick:()=>Z(-1),className:"slideNav prev",title:lng("previous slide").caps()+` (${p}/${m})`,children:(0,y.tZ)(b.JO,{icon:"arrow_near"})}),p<m-1&&(0,y.tZ)("div",{onClick:()=>Z(1),className:"slideNav next",title:lng("next slide").caps()+` (${p+2}/${m})`,children:(0,y.tZ)(b.JO,{icon:"arrow_far"})}),(0,y.tZ)("div",{className:"slide-img",style:{backgroundImage:"url('"+h[p].src+"')"},onClick:()=>Z(1)})]})})}));var Le,$e,Ve,Ue,He,Je=i(101);function Ge(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function We(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ke(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Ye=(Le=class{constructor(e){let{url:t,single_sco:i,debug:n,token:r,api_data:s,initial_sco:o,end_link:a,scos_menu:l}=e;if(Ge(this,"url",$e,this),Ge(this,"log",Ve,this),Ge(this,"scosMenu",Ue,this),We(this,"scosMenuFlat",[]),Ge(this,"_activeScoId",He,this),(0,g.makeObservable)(this),this.url=t,this.api=new window.RunTimeApi(r,n,s,o,null,(function(e){Blsm.InitLauncherComments(""+e),Blsm.prm.performance_id&&(0,C.SC)(`generic/performance_location/performance=${Blsm.prm.performance_id}&location=${e}`)})),window.API=window.API_1484_11=this.api,l){this._activeScoId=o,(0,Je.v0)(l),this.scosMenu=l;const e=this.api.CalcStatusIcon();(0,v.oH)(this.scosMenu,(t=>{null!=t&&t.id&&t.href&&(t.icon=e[t.id],this.scosMenuFlat.push(t))}))}let c=i;window.ScormExit=e=>{if(l){const t=this.scosMenuFlat.find((t=>t.id===e.cur_sco));t&&(t.icon=this.api.CalcStatusIcon(e.cur_sco))}c&&(this.api.SubmitData(),!n&&i&&window.ScormEnd())},window.addEventListener("beforeunload",(()=>c=!0)),window.WriteLog=e=>this.log=e,window.ScormEnd=()=>window.AssignmentEnd(a)}get activeScoId(){return this._activeScoId}set activeScoId(e){const t=e&&this.scosMenuFlat.find((t=>t.id===e));t&&(this.api.SetSco(e),this._activeScoId=e,this.url=t.href)}},$e=Ke(Le.prototype,"url",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=Ke(Le.prototype,"log",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ue=Ke(Le.prototype,"scosMenu",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),He=Ke(Le.prototype,"_activeScoId",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke(Le.prototype,"activeScoId",[g.computed],Object.getOwnPropertyDescriptor(Le.prototype,"activeScoId"),Le.prototype),Le);const Qe={name:"1yyt0yl",styles:"height:100%;>.log{margin:3px;padding:3px;font-size:.9em;border:1px solid #f0f;}>.scos{height:100%;display:flex;}"},et=(0,p.observer)((function(e){const{sideMenuOpened:t}=e,i=(0,n.useMemo)((()=>new Ye(e)),[]),{log:r,url:s,scosMenu:o}=i;return(0,n.useEffect)((()=>{Blsm.InitLauncherComments()})),(0,y.BX)("div",{css:Qe,children:[r&&(0,y.tZ)("div",{className:"log",children:r}),(0,y.BX)("div",{className:"scos",children:[o&&t&&(0,y.tZ)(it,{ss:i}),(0,y.tZ)(me,{url:s})]})]})})),tt=(0,l.iv)("width:250px;",c.g.classes.border_far(`1px solid ${c.g.colors.separator}`),";>.buttons{margin-top:20px;display:flex;flex-direction:column;align-items:center;>*+*{margin-top:10px;}}",""),it=(0,p.observer)((function(e){let{ss:t}=e;const{scosMenu:i,activeScoId:n,scosMenuFlat:r}=t,s=r.findIndex((e=>e.id===n));return(0,y.BX)("div",{css:tt,children:[(0,y.tZ)(Je.mp,{tree:i,activeId:n,onSelect:e=>t.activeScoId=e}),(0,y.BX)("div",{className:"buttons",children:[(0,y.BX)("div",{children:[(0,y.tZ)(_.l,{theme:"outlined",disabled:s<=0,onClick:()=>t.activeScoId=r[s-1].id,children:"<"})," ",(0,y.tZ)(_.l,{theme:"outlined",disabled:s>=r.length-1,onClick:()=>t.activeScoId=r[s+1].id,children:">"})]}),(0,y.tZ)("div",{children:(0,y.tZ)(_.l,{theme:"contained",onClick:()=>window.ReturnToMainPage(),children:lng("finish attempt").caps()})})]})]})}));var nt=i(3205);const rt=function(e){let{requirements:t,onCancel:i}=e;(0,Z.IV)(i,"ReadingConfirmation");const n=new st(t),r=[{label:lng("cancel").caps(),action:i,keyboard:"Escape"},{label:lng("confirm").caps(),action:n.callSave,keyboard:"Enter"}];return(0,y.tZ)(nt.l,{form:n,onClose:i,title:n.title,dialogTailButtons:r,dialogWidth:"400px",internalForm:!0})};class st extends m.I{constructor(e){super(e),this.confirmButtonLabel=!1,this.title=lng("reading confirmation").caps();const{reqPassword:t,reqSignature:i,postData:n,type:r}=e;if(i){let e;e="attendance_confirm"===r?lng("sign in the section below to confirm attendance").caps():lng("sign in the section below to confirm submission").caps(),this._fields.push({type:"signpad",name:"reading_confirmation_signature",label:e+":",required:!0})}if(t){let e;e="attendance_confirm"===r?lng("type your password to confirm attendance").caps():lng("type your password to confirm submission").caps(),this._fields.push({type:"password",name:"reading_confirmation_password",label:e,required:!0,remoteValidate:{url:"users/verify_password",method:"POST",parseResult:e=>!0===e.pass?"":lng("wrong password").caps()}})}if(null!=n&&n.length)for(const e of n)this._fields.push({type:"hidden",name:e.name,value:e.value});this._prepFields(),this.ready=!0}save(e){(0,C.hn)(null,{confirm_read:1,...e})}}const ot=(0,l.iv)("width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;>form{max-width:90vw;background-color:white;border:1px solid ",c.g.colors.separator,";padding:20px;border-radius:10px;>.intro{font-weight:600;font-size:1.2em;}>.error{color:",c.g.colors.negative,";margin-top:15px;}>.Button{width:100%;margin-top:20px;}}",""),at=e=>{let{assignment_id:t,requirePassword:i,error:r}=e;const s=(0,n.useRef)(new lt({assignment_id:t,requirePassword:i,error:r})).current;return(0,y.tZ)("div",{css:ot,children:(0,y.tZ)(m.q3.Provider,{value:s,children:(0,y.BX)("form",{autoComplete:"off",method:"post",children:[(0,y.tZ)("div",{className:"intro",children:i?lng("please select your user, fill in your password, then click run.").caps():lng("please select your user, then click run.").caps()}),(0,y.tZ)(u.au,{input:s.fields}),r&&(0,y.tZ)("div",{className:"error",children:r}),(0,y.tZ)(he.O,{primary:!0,formButton:!0,label:lng("run").caps()})]})})})};class lt extends m.I{constructor(e){let{assignment_id:t,requirePassword:i}=e;super(),this._fields=[{type:"hidden",name:"search_user_id"},{type:"text",name:"search_user",label:lng("connect as user"),placeholder:lng("search user").caps(),suggest:{getData:(0,v.pR)(((e,i)=>(0,C.SC)("assignment/autocomplete_assignment_users",{data:{term:e||"",assignment:t}},i)))},onSelect:e=>{this.updateValue(e.value,"search_user_id")}},{type:"password",name:"user_password",label:lng("password"),autoComplete:"new-password",insert:i}],this._prepFields()}}var ct=i(8116),dt=i(5311),pt=i(5680),ut=i(7154),mt=i(4902);const gt=(0,l.iv)("padding:0 15px 15px 15px;margin:30px auto;border-radius:10px;max-width:533px;overflow:hidden;border:1px solid ",c.g.colors.separator,";._title_row{margin:15px 0;display:flex;._title{font-size:1.5em;font-weight:600;.Icon{font-size:30px;padding:0 10px;color:",c.g.colors.entity.meeting,";}}}._attribute{margin-bottom:5px;._label{font-weight:600;}}._warnings{color:",c.g.colors.warning,";}._section{margin-top:40px;margin-bottom:15px;}._section_label{font-size:1.2em;font-weight:600;margin-top:30px;margin-bottom:10px;}._instructors{display:flex;>div{display:flex;align-items:center;",c.g.classes.margin_far("12px"),";>div{",c.g.classes.margin_far("6px"),";}}}._coach{display:flex;align-items:center;>span{",c.g.classes.margin_near("5px"),";}}._desc{min-height:100px;background-color:",c.g.colors.bg_2,";padding:10px;border-radius:10px;}",""),ht=e=>{var t,i,r,s,o,a,l;let{meeting:c,onLoad:d}=e;const p=new ct.Ag(c);return(0,n.useEffect)((()=>{moment().isAfter(c.start_date)&&d(!0)}),[]),(0,y.BX)("div",{css:gt,children:[(0,y.BX)("div",{className:"_title_row",children:[(0,y.BX)("div",{className:"_title",children:[(0,y.tZ)(b.JO,{icon:"entity_meeting"})," ",p.title]}),(0,y.tZ)(dt.zh,{}),(0,y.tZ)("span",{children:(0,y.tZ)(pt.Vp,{tag:p.status.text,color:p.status.color})})]}),(null===(t=p.dateNote)||void 0===t?void 0:t.date)&&(0,y.BX)("div",{className:"_attribute",children:[(0,y.BX)("span",{className:"_label",children:[(null===(i=p.dateNote.toolTip)||void 0===i?void 0:i.caps())||lng("date").caps(),": "]}),(0,y.tZ)(Ce.qm,{dateNote:p.dateNote})]}),p.warnings&&(0,y.tZ)("div",{className:"_attribute _warnings",children:p.warnings}),(null==p||null===(r=p.locations)||void 0===r?void 0:r.length)>0&&(0,y.tZ)("div",{className:"_section",children:p.locations.map(((e,t)=>(0,y.BX)("div",{className:"_attribute",children:[(0,y.BX)("span",{className:"_label",children:[e.label,":"]})," ",e.value]},t)))}),(null===(s=p.instructors)||void 0===s?void 0:s.length)>0&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("instructors").caps()}),(0,y.tZ)("div",{className:"_instructors",children:p.instructors.map((e=>(0,y.BX)("div",{children:[(0,y.tZ)(mt.qE,{user:e}),(0,y.tZ)("span",{children:e.full_name})]},e.resource_id)))})]}),(null==p?void 0:p.maySeeResources)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("resources").caps()}),(0,y.tZ)("div",{children:p.resources.map((e=>(0,y.BX)("div",{className:"_attribute",children:[e.resource_name," (",(0,y.tZ)(ut.u,{text:lng("amount in use"),children:e.amount_in_use}),")"]},e.user_id)))})]}),(null===(o=p.description)||void 0===o?void 0:o.text)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("description").caps()}),(0,y.tZ)("div",{className:"_desc",children:p.description.isHtml?(0,y.tZ)(f.xn,{content:null===(a=p.description)||void 0===a?void 0:a.text}):(0,y.tZ)("div",{children:null===(l=p.description)||void 0===l?void 0:l.text})})]})]})},bt=e=>{let{type:t,launcherData:i={}}=e;const r="iframe"in(0,v.Lv)(),s=(0,n.useRef)(),[o,a]=(0,n.useState)(null),{title:d,content_comments:p,assignment_id:u,reading_confirmation:m,reqPassword:g,reqSignature:h,anonymousPostData:b,..._}=Blsm.LauncherModelData||{},[f,w]=(0,n.useState)(""),[x,k]=(0,n.useState)(i.side_menu),[Z,C]=(0,n.useState)(!1),S=(0,n.useRef)(),[O,B]=(0,n.useState)(!1),[T,N]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=()=>{window.innerHeight>window.innerWidth&&window.scrollTo(0,0)};window.navigator.userAgent.includes("iPhone")&&window.addEventListener("orientationchange",e);const t=()=>S.current&&(S.current.style.height=window.innerHeight+"px");return window.navigator.userAgent.includes("Mobile")&&(window.addEventListener("resize",t),t()),()=>{window.removeEventListener("orientationchange",e),window.removeEventListener("resize",t)}}),[]);let I="media"===t?O?lng("i confirm that I have watched and understood the contents of this video"):lng("please watch the entire video to confirm the assignment"):"attendance_confirm"===t?T?lng("i confirm that I have attended the meeting"):lng("meeting did not start yet"):lng("i confirm that I have read and understood the contents of this document");return(0,y.BX)("div",{css:(D=!m&&!["text","activity","kiosk","kaltura"].includes(t),(0,l.iv)("display:flex;flex-direction:column;",D?"min-":"","height:100vh;>.main_space{background-color:",c.g.colors.bg_main,";flex-grow:1;overflow:auto;display:flex;>.launcher{flex-grow:1;}>.comments{height:100%;width:330px;background:#FFF;border-left:1px solid #d8d8d8;border-right:1px solid #d8d8d8;}}>form{padding:7px;text-align:center;}@media print{height:auto;display:block;>.main_space{display:block;}}","")),ref:S,children:[!r&&(0,y.tZ)(_t,{..._,title:d+f,scoMenuIcon:i.side_menu,toggleScoMenu:()=>k(!x),content_comments:p,openFullScreen:v.Rh?()=>{var e;return null===(e=s.current)||void 0===e?void 0:e[v.Rh]()}:null,toggleComments:()=>a(!o)}),(0,y.BX)("div",{className:"main_space",ref:s,children:[(0,y.tZ)("div",{className:"launcher",children:"image"===t?(0,y.tZ)(ae,{...i}):"media"===t?(0,y.tZ)(pe,{...i,onEnded:()=>B(!0)}):"activity"===t?(0,y.tZ)(je,{...i}):"kaltura"===t?(0,y.tZ)(ze,{...i}):"text"===t?(0,y.tZ)(Re,{...i}):"docs"===t?(0,y.tZ)(Fe,{...i}):"slides"===t?(0,y.tZ)(Xe,{...i,setTitleAppendix:w}):"scorm"===t?(0,y.tZ)(et,{...i,sideMenuOpened:x}):"iframe"===t?(0,y.tZ)(me,{...i}):"kiosk"===t?(0,y.tZ)(at,{...i}):"attendance_confirm"===t?(0,y.tZ)(ht,{...i,onLoad:N}):"unknown launcher"}),p&&(0,y.tZ)("div",{className:"comments",style:{display:o?"block":"none"},children:(0,y.tZ)(re,{assignmentId:u,opened:null!==o})})]}),m&&("media"!==t||O)&&(0,y.BX)("form",{method:"post",onSubmit:e=>{(g||h)&&(e.preventDefault(),C(!0))},children:[(0,y.tZ)(he.O,{primary:!0,formButton:!0,name:"confirm_read",value:"1",label:I.caps(),disabled:"attendance_confirm"===t&&!T||"media"===t&&!O}),Z?(0,y.tZ)(rt,{requirements:{reqPassword:g,reqSignature:h,postData:b,type:t},onCancel:()=>C(!1)}):b.map((e=>(0,y.tZ)("input",{type:"hidden",name:e.name,value:e.value},e.name)))]})]});var D},vt=(0,l.iv)("background:",c.g.theme.ln_bg," linear-gradient(45deg, rgba(0, 0, 0, 0.3), transparent);color:",c.g.theme.ln_fg,";position:relative;z-index:1;box-shadow:0 0 5px rgba(0, 0, 0, .5);padding:11px 20px 13px 20px;height:50px;font-size:19px;display:flex;justify-content:space-between;>.actions{display:flex;align-items:center;.logo{max-width:65px;max-height:21px;margin:0 10px;}.exit{",c.g.classes.margin_near("10px"),";cursor:pointer;}}.title{",c.g.classes.ellipsis,";.about_user{font-size:0.6em;}}",""),_t=e=>{let{title:t,pretend:i,show_download:n,openFullScreen:r,toggleComments:s,content_comments:o,scoMenuIcon:a,toggleScoMenu:l,about_user:d}=e;return(0,y.BX)("div",{css:vt,children:[(0,y.BX)("div",{className:"actions",children:[a&&(0,y.tZ)(b.JO,{buttonLike:!0,icon:"list",onClick:l}),(0,y.tZ)("img",{className:"logo",src:c.g.theme.logo_small||`${Blsm.prm.Mainref}images/v4/blossom_logo_small_white.png`,alt:"logo"}),r&&(0,y.tZ)(b.JO,{buttonLike:!0,icon:"full_screen",onClick:r}),n&&(0,y.tZ)("a",{href:location.href+"&dl=1",target:"_blank",rel:"noreferrer",children:(0,y.tZ)(b.JO,{buttonLike:!0,icon:"download",toolTip:`${lng("download")} / ${lng("open in a new tab")}`.caps()})}),i&&(0,y.tZ)(b.JO,{buttonLike:!0,icon:"pretend",toolTip:lng("pretending to be %s",i)})]}),(0,y.tZ)("div",{className:"title",children:(0,y.tZ)("span",{children:(0,y.BX)(W.m,{children:[t," ",d&&(0,y.tZ)("span",{className:"about_user",title:lng("about user"),children:(0,y.tZ)("a",{target:"_blank",rel:"noreferrer",href:(0,h.p4)({absolute:!0,user:d.user_id}),children:d.user_full_name})})]})})}),(0,y.BX)("div",{className:"actions",children:[o&&(0,y.tZ)(b.JO,{buttonLike:!0,icon:"discussion",onClick:s}),(0,y.BX)("div",{className:"exit",onClick:()=>window.ReturnToMainPage(),children:[(0,y.BX)("span",{className:"mobile_off",children:[lng("exit").caps()," "]}),(0,y.tZ)(b.JO,{buttonLike:!0,icon:"exit"})]})]})]})},ft=(0,l.iv)("width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;>form{max-width:90vw;background-color:white;border:1px solid ",c.g.colors.separator,";padding:20px;border-radius:10px;>.intro{font-weight:600;}>.error{color:",c.g.colors.negative,";margin-top:15px;text-align:center;}>.Button{width:100%;margin-top:20px;}}",""),yt=function(e){let{wrong_pass:t,...i}=e;const r=(0,n.useRef)(new wt(i)).current;return(0,y.tZ)("div",{css:ft,children:(0,y.tZ)(m.q3.Provider,{value:r,children:(0,y.BX)("form",{autoComplete:"off",method:"post",onSubmit:e=>{var t;null===(t=e.preventDefault)||void 0===t||t.call(e),r.callSave()},children:[(0,y.tZ)("div",{className:"intro",children:lng("please fill the form below, then click start.").caps()}),t&&(0,y.tZ)("div",{className:"error",children:lng("incorrect password").caps()}),(0,y.tZ)(u.au,{input:r.fields}),(0,y.tZ)(he.O,{primary:!0,formButton:!0,label:lng("start").caps()})]})})})};class wt extends m.I{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e);const{assignment_password:t,anonymous_fetch_form:i}=e;i&&this._fields.push({type:"text",name:"anonymous_details[first_name]",label:lng("first name").caps()},{type:"text",name:"anonymous_details[last_name]",label:lng("last name").caps()},{type:"text",name:"anonymous_details[identification]",label:lng("identification").caps()}),t&&this._fields.push({type:"text",name:"password",label:lng("password").caps()+":",required:!0}),this._prepFields(),this.ready=!0}save(e){(0,C.hn)(null,{start:1,...e})}}var xt=i(5875),kt=i(5832),Zt=i(6421);const Ct=(0,l.iv)("width:100%;height:100%;display:flex;flex-direction:column;align-items:center;>div{width:600px;max-width:85vw;}.header{margin:2em 0 1em;>.title{font-size:1.5em;margin-bottom:1em;&.center{text-align:center;}}}>.list{flex-grow:1;overflow:auto;>div+div{margin-top:1em;}.strip_data{display:flex;align-items:center;>*{",c.g.classes.margin_near("10px"),";}}}",""),St=function(e){let{users:t,print:i,title_none:r,select_title:s,show_avatar:o}=e;const[a,l]=(0,n.useState)("");return(0,y.BX)("div",{css:Ct,children:[(0,y.tZ)("div",{className:"header",children:0===t.length?(0,y.tZ)("div",{className:"title center",children:r||lng("no users").caps()}):(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{className:"title",children:[s||lng("choose user").caps(),":"]}),(0,y.tZ)(Zt.I,{type:"search",wrapped:!0,value:a,onChange:l,placeholder:lng("filter").caps()})]})}),(0,y.tZ)("div",{className:"list",children:(0,kt.WB)(t,{label:a}).map((e=>{var t;const n=["Yes","Exemption"].includes(e.performance_completed)?[lng("completed"),c.g.colors.green]:e.has_resume?[lng("resume"),c.g.colors.blue]:!1===e.dependencies_satisfied?[lng("dependencies not completed"),c.g.colors.disabled_background]:[lng("to do"),c.g.colors.yellow];let r;var s;(null===(t=e.dependency_list)||void 0===t?void 0:t.length)>0&&(r=(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{children:[lng("dependencies").caps(),":"]}),null===(s=e.dependency_list)||void 0===s?void 0:s.map((e=>(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"mark_"+(e.satisfied?"v":"x")})," ",e.assignment_name||e.lesson_name]},e.assignment_id)))]}));return(0,y.tZ)(xt.o,{title:e.label,subTitle:e.sub_title,avatar:o?e:void 0,avatarBalloon:!0,img:e.poster,markColor:n[1],onClick:()=>(e=>{!1===e.dependencies_satisfied?(0,Ze.BB)(lng("this user has unsatisfied dependencies for this assignment, are you sure you want to run it?"),{confirmText:lng("yes"),cancelText:lng("no"),onConfirm:()=>setTimeout((()=>window.location=e.url),10)}):window.location=e.url})(e),children:(0,y.BX)("div",{className:"strip_data",children:[(0,y.tZ)(ut.u,{html:r,children:(0,y.tZ)(pt.Vp,{tag:n[0],color:n[1]})}),i&&(0,y.tZ)(b.JO,{icon:"print",href:e.url+"&print=1",toolTip:lng("print")}),e.count_performances>0&&(0,y.tZ)(ut.u,{text:lng("number of performances"),children:e.count_performances})]})},e.user_id)}))})]})},Ot=(0,l.iv)("width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;>div{max-width:90vw;background-color:white;border:1px solid ",c.g.colors.separator,";padding:20px;border-radius:10px;.msg{font-size:1.5em;}.redirect_msg{margin-top:1em;}a{text-decoration:underline;}}",""),Bt=function(e){let{msg:t,url:i,redirect_msg:r,time:s}=e;const[o,a]=(0,n.useState)(s||5);return(0,n.useEffect)((()=>{const e=setInterval((()=>{if(o>=1)return 1===o&&(clearInterval(e),Blsm.prm.LOCALHOST||(i?window.location=i:window.location.reload())),a(o-1)}),1e3);return()=>clearInterval(e)})),(0,v.HD)(r)&&r.includes("TIME")&&(r=r.replace("TIME",o)),(0,y.tZ)("div",{css:Ot,children:(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"msg",children:t.replace("TIME",o)}),r&&(0,y.tZ)("div",{className:"redirect_msg",dangerouslySetInnerHTML:{__html:r}})]})})},Tt=(0,l.iv)("width:100%;height:100%;display:flex;flex-direction:column;align-items:center;>div{width:400px;max-width:85vw;}.header{margin:2em 0 1em;>.title{font-size:1.5em;margin-bottom:1em;&.center{text-align:center;}}}>.list{flex-grow:1;overflow:auto;>div+div{margin-top:1em;}.strip_data{display:flex;align-items:center;>*{",c.g.classes.margin_near("10px"),";}}}",""),Nt=function(e){let{languages:t,resume_lesson:i}=e;return(0,y.BX)("div",{css:Tt,children:[(0,y.tZ)("div",{className:"header",children:(0,y.BX)("div",{className:"title",children:[lng("choose language").caps(),":"]})}),(0,y.tZ)("div",{className:"list",children:t.map((e=>{let[t,n,r]=e;return(0,y.tZ)(xt.o,{title:r.caps(),onClick:()=>location.href+=`&lang=${t}`,children:(null==i?void 0:i.toString())===n&&(0,y.tZ)(pt.Vp,{tag:lng("resume"),color:c.g.colors.blue})},t)}))})]})};const It={name:"m0ybr9",styles:"display:flex;flex-direction:column;height:100vh;>.main_space{background-color:#eee;flex-grow:1;overflow:auto;display:flex;}"},Dt=e=>{let{type:t,data:i}=e;const{title:n}=i||{};return(0,y.BX)("div",{css:It,children:[(0,y.tZ)(_t,{title:n}),(0,y.tZ)("div",{className:"main_space",children:"anonymous_form"===t?(0,y.tZ)(yt,{...i}):"user_select"===t?(0,y.tZ)(St,{...i}):"language_select"===t?(0,y.tZ)(Nt,{...i}):"error"===t?(0,y.tZ)(Bt,{...i}):"unknown type"})]})};var jt=i(8172),Pt=i(6026),zt=i(5007),Et=i(6291),Rt=i(5405),Ft=i(1137),Mt=i(8207),At=i(7018),qt=i(3755),Xt=i(5967),Lt=i(7376),$t=i(443),Vt=i(2906),Ut=i(8432);const Ht=(0,l.iv)("color:",c.g.colors.text_main,";._body{display:flex;align-items:center;height:240px;justify-content:space-between;padding:0 2em;}",""),Jt=(0,l.iv)("width:66%;display:flex;flex-direction:column;height:100%;justify-content:space-around;>div{display:flex;align-items:center;justify-content:space-between;}._progress{width:270px;margin-right:25px;._title{font-weight:bold;font-size:1.15em;}}._next{width:270px;margin-top:25px;._title{margin-bottom:8px;}>div:nth-of-type(2){display:flex;}.Icon{font-size:20px;",c.g.classes.margin_far("13px"),";color:",c.g.colors.text_sec,";}._name{font-weight:600;}._details{color:",c.g.colors.text_sec,";}}",""),Gt=(0,l.iv)("width:180px;._status{color:",c.g.colors.green,";border :4px solid ",c.g.colors.green,";font-weight:bold;font-size:1.5em;padding:.8em 1em;min-width:180px;text-align:center;}._score{text-align:center;margin-top:1.5em;display:flex;justify-content:space-around;align-items:end;>div{width:50%;>._title{font-size:1.15em;}>._value{font-size:3.5em;line-height:1em;color:",c.g.colors.green,";}}>._diploma{color:",c.g.colors.green,";width:50%;font-size:40px;}}&._failed{._status{color:",c.g.colors.negative,";border :4px solid ",c.g.colors.negative,";}._value{color:",c.g.colors.negative,";}}",""),Wt=(0,p.observer)((function(e){var t,i;let{ws:n}=e;const r=n.features.assignments&&n.user_scores&&n.is_member,s=n.features.meetings&&n.arrived_to_meetings&&n.is_member,o=n.features.tasks&&!(r||s),a=null===(t=n.user_scores)||void 0===t?void 0:t.performance.c_completed,l=null===(i=n.user_scores)||void 0===i?void 0:i.performance.c_performance_score,d=n.getDiploma();return(0,y.BX)(Mt.W2,{css:Ht,children:[(0,y.BX)($t.B,{title:lng("progress"),icons:n.headerActions(),children:[(0,y.tZ)(Ut.Yy,{ws:n}),(0,y.tZ)(Ut.ns,{ws:n})]}),(0,y.BX)("div",{className:"_body",children:[(0,y.BX)("div",{css:Jt,children:[(0,y.BX)("div",{children:[r&&(0,y.tZ)(Kt,{count_assignments:n.user_scores.count_assignments,count_completed:n.user_scores.count_completed,required_assignments_completion:n.scoring_details.required_assignments_completion}),s&&(0,y.tZ)(Yt,{attendance:n.arrived_to_meetings.attendance,total_meetings:n.arrived_to_meetings.total_meetings,required_meetings_attendance:n.scoring_details.required_meetings_attendance}),o&&!(0,v.xb)(n.tasks_stats.resolutions)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(ii,{resolutions:n.tasks_stats.resolutions,title:lng("all tasks")}),(0,y.tZ)("div",{style:{height:"170px",borderLeft:`1px solid ${c.g.colors.separator}`,margin:"0 25px"}}),!(0,v.xb)(n.tasks_stats.mine)&&(0,y.tZ)(ii,{resolutions:n.tasks_stats.mine,title:lng("tasks allocated to me")})]})]}),n.is_member&&(0,y.BX)("div",{children:[n.nextAssignment&&(0,y.tZ)(Qt,{nextAssignment:n.nextAssignment}),n.nextMeeting&&(0,y.tZ)(ei,{nextMeeting:n.nextMeeting})]})]}),("0"===a||"1"===a)&&(0,y.BX)("div",{css:Gt,className:"0"===a?"_failed":"",children:[(0,y.tZ)("div",{className:"_status",children:("1"===a?lng("completed|workspace"):lng("not completed|workspace")).toUpperCase()}),(0,y.BX)("div",{className:"_score",children:[l&&(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"_title",children:lng("score").caps()}),(0,y.tZ)("div",{className:"_value",children:l})]}),d&&(0,y.tZ)(b.JO,{icon:"diploma",className:"_diploma",toolTip:lng("download diploma").caps(),href:d,color:c.g.colors.green})]})]})]})]})})),Kt=e=>{let{count_completed:t,count_assignments:i,required_assignments_completion:n}=e;return(0,y.BX)("div",{className:"_progress",children:[(0,y.tZ)("div",{className:"_title",children:lng("assignments").caps()}),(0,y.tZ)(qt.k,{numerator:t,denominator:i,valueInBar:!0,bigLabel:!0,note:lng("%s required",(n||"0")+"%")})]})},Yt=e=>{let{attendance:t,total_meetings:i,required_meetings_attendance:n}=e;return(0,y.BX)("div",{className:"_progress",children:[(0,y.tZ)("div",{className:"_title",children:lng("meetings").caps()}),(0,y.tZ)(qt.k,{numerator:t,denominator:i,valueInBar:!0,bigLabel:!0,note:lng("%s participation required",(n||"0")+"%")})]})},Qt=e=>{let{nextAssignment:t}=e;return(0,y.BX)("div",{className:"_next",children:[(0,y.tZ)("div",{className:"_title",children:lng("next assignment").caps()}),(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"play",href:t.link}),(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"_name",children:t.title}),(0,y.tZ)("div",{className:"_details",children:(0,ce.GG)(t.date)})]})]})]})},ei=e=>{let{nextMeeting:t}=e;return(0,y.BX)("div",{className:"_next",children:[(0,y.tZ)("div",{className:"_title",children:lng("next meeting").caps()}),(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"meeting"}),(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"_name",children:t.title}),(0,y.tZ)("div",{className:"_details",children:(0,ce.GG)((0,Vt.Lj)(t,"start_date"))})]})]})]})},ti={name:"1owieab",styles:".title{font-weight:bold;font-size:1.15em;padding-bottom:15px;}.data{display:flex;}.legend{display:flex;flex-wrap:wrap;width:260px;}"},ii=e=>{let{resolutions:t,title:i}=e;const n=[];let r=0;for(const[e,i]of Object.entries(t))n.push({label:(0,Lt.Ey)(e),color:(0,Lt.Pp)(e),number:i}),r+=1*i;return 0===n.length&&n.push({label:(0,Lt.Ey)("open"),color:(0,Lt.Pp)("open"),number:0}),(0,y.BX)("div",{css:ti,children:[(0,y.tZ)("div",{className:"title",children:i.caps()}),(0,y.BX)("div",{className:"data",children:[(0,y.tZ)(Q.k,{type:"pie",data:n,height:"140px",width:"160px"}),(0,y.tZ)("div",{className:"legend",children:n.map(((e,t)=>{let{label:i,color:n,number:s}=e;return(0,y.tZ)(Xt.t,{numerator:s,denominator:r,label:i,color:n},t)}))})]})]})};var ni=i(5898),ri=i(6597),si=i(6401);const oi=(0,l.iv)(ri.N,";margin-right:1em;._menu{",c.g.classes.opposite_float,";}._fore{padding:10px;top:55px;color:",c.g.colors.text_main,";>._question{height:100px;padding-top:20px;font-weight:700;._ellipsis{",c.g.classes.ellipsis_lines(3),";}}>._choices{height:155px;display:flex;flex-direction:column;>*{flex-grow:1;}}}",""),ai=e=>(0,y.tZ)(Rt.aK,{children:(0,y.tZ)(li,{...e})}),li=(0,p.observer)((function(e){let{poll:t,color:i,workspaceStore:n}=e;const{question:r,choices:s,answered:o,results:a,due_date:l,past:c,vote:d,mayEdit:p}=t,u=t.isAnswered?a.reduce(((e,t)=>e+t),0):null;return(0,y.BX)("div",{css:oi,children:[(0,y.tZ)("div",{className:"_back",style:{backgroundColor:i},children:l&&(0,y.BX)(ni.jC,{color:"rgba(255, 255, 255, .4)",noBoxShadow:!0,icon:"clock",children:[c?lng("poll ended at"):lng("poll ends at")," ",(0,y.tZ)(Ce.qp,{time:l,showTime:!1})]})}),(0,y.BX)("div",{className:"_fore",children:[p&&(0,y.tZ)(R.x,{className:"_menu",options:[{label:lng("edit").caps(),onClick:()=>(0,zt.vm)().openDialog("form",new si.y({data:{poll:t,groupId:n.group_id},onSaveSuccess:()=>(0,zt.vm)().closeDialog()}))},{label:lng("delete").caps(),onClick:()=>n.deletePoll(t)}],children:(0,y.tZ)(b.JO,{icon:"menu"})}),(0,y.tZ)(W.m,{className:"_question",children:(0,y.tZ)(ut.u,{text:r,minLength:60,children:(0,y.tZ)("div",{className:"_ellipsis",children:r})})}),(0,y.tZ)(W.m,{className:"_choices",children:s.map(((e,i)=>(0,y.tZ)(di,{userAnswer:i===parseInt(o),text:e,count:a.length>i?a[i]:0,total:u,onclick:()=>!t.isAnswered&&d(i)},i)))})]})]})})),ci=(0,l.iv)("border:1px solid ",c.g.colors.separator,";border-radius:9px;min-height:21px;position:relative;&._clickable{cursor:pointer;}&.userAnswer,&._clickable:hover{box-shadow:0 0 3px ",c.g.colors.dominant_main,";border-color:",c.g.colors.dominant_main,";}>._p{border-radius:9px;background-color:#C2D8FD;height:100%;}>._t{display:flex;align-items:center;position:absolute;top:0;width:100%;height:100%;padding:0 10px;>._ellipsis{",c.g.classes.ellipsis,";width:83%;}._grow{flex-grow:1;}._voted{font-size:.8em;}}",""),di=e=>{let{text:t,userAnswer:i,count:n=0,total:r,onclick:s}=e;return(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{css:ci,className:(0,v.AK)({userAnswer:i,_clickable:null===r}),onClick:s,title:t.length>19?t:void 0,children:[r>0&&(0,y.tZ)("div",{className:"_p",style:{width:100*n/r+"%"}}),(0,y.BX)("div",{className:"_t",children:[(0,y.tZ)("div",{className:"_ellipsis",children:t}),(0,y.tZ)("span",{className:"_grow"}),r>0&&(0,y.BX)("span",{className:"_voted",children:[n," ",lng("voted")]})]})]}),(0,y.tZ)("div",{})]})};var pi=i(1991),ui=i(7938),mi=i(1766),gi=i(6364),hi=i(8411),bi=i(5247),vi=i(2883),_i=i(7697),fi=i(493),yi=i(2755),wi=i(5519);function xi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ki extends m.I{constructor(e){super(e),xi(this,"group_id",null),xi(this,"groupName",""),this.group_id=(null==e?void 0:e.group_id)||this.group_id,this.groupName=(null==e?void 0:e.groupName)||this.groupName,this.required_qualifications=Object.values(null==e?void 0:e.required_qualifications),this.title=lng("required qualifications")+" - "+this.groupName,this.saveUrl="groups/save_required_qualifications",(0,C.SC)("groups/required_qualifications",{data:{group_id:this.group_id}},(e=>{this.buildFields({required_qualifications:e})}))}buildFields(e){this._fields=[{type:"set",insert:"qualification",fields:[{type:"component",node:(0,y.BX)("div",{children:[" ",lng("choose other qualifications that are required to complete this qualification").caps()]})},{type:"multiple_items",name:"required_qualifications",label:lng("select required qualifications"),poster:!0,theme:"bright",valueIsMap:!0,objectKeys:["id","order"],searchData:(e,t)=>{let i={req:"AutoComplete",exclude:null==this?void 0:this.group_id,owned:1,types:["Qualification"],term:e.term||"",id:e.ids||""};(0,C.SC)("ajax/GroupsAjax.class.php",{data:i},t)},buttons:[{Render:wi.Pl,onChange:(e,t)=>{let{value:i}=t;return e.order=i,e}}]}]}],this._prepFields(e),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,Object.assign({group_id:this.group_id},e))}}const Zi=(0,l.iv)("height:85px;width:250px;border-radius:10px;padding:10px 15px;position:relative;color:",c.g.colors.text_sec,";z-index:1;background-color:",c.g.colors.half_white,";&.row-style{min-height:55px;width:600px;justify-content:start;background-color:",c.g.colors.dominant_white,";}&.completed{display:flex;align-items:center;border:1px solid ",c.g.colors.blossom,";cursor:pointer;>div{",c.g.classes.margin_far("10px"),";}&:hover{box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);}}&.open,&.failed{border:1px solid ",c.g.colors.blossom,";display:flex;flex-direction:column;justify-content:space-around;cursor:pointer;&:hover{box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);}}&.locked{border:1px solid ",c.g.colors.separator,";display:flex;align-items:center;>div{",c.g.classes.margin_far("10px"),";}}&.manager{display:flex;align-items:center;border:1px solid ",c.g.colors.light_blue,";cursor:pointer;justify-content:space-between;>div{",c.g.classes.margin_far("10px"),";}&:hover{box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);}}.current{position:absolute;top:-15px;",c.g.classes.far("3px"),";font-size:24px;}.name{",c.g.classes.ellipsis_lines(2),";}&:hover{z-index:2;}",""),Ci=function(e){var t,i,n,r;let s,{qualification:o,current:a,id:l,className:d,fetchQualList:p}=e;s=o.has_perm?"manager":"1"===o.c_completed?"completed":"0"===o.c_completed?"failed":o.user_id?"open":"locked";const u=o.user_id||o.has_perm?()=>(0,h.p4)({workspace:o.group_id},!0):void 0,m=o.is_owner?()=>(0,zt.vm)().openDialog("form",new ki({group_id:o.group_id,groupName:o.group_name,required_qualifications:o.deps,onSaveSuccess:()=>((0,zt.vm)().closeDialog(),p())})):void 0,g="row-style"===d,_=g?15:20,f=g?35:45;return(0,y.BX)("div",{css:Zi,className:(0,v.AK)("QualificationCard",s,d),id:l,onClick:u,children:["manager"===s&&(0,y.tZ)("div",{children:(0,y.tZ)(yi.ZT,{icon:"manager",color:"#FFF",bgColor:c.g.colors.light_blue,iconSize:_,size:f})}),"completed"===s&&(0,y.tZ)("div",{children:(0,y.tZ)(yi.ZT,{icon:"mark_v_light",color:"#FFF",bgColor:c.g.colors.blossom,iconSize:_,size:f})}),"failed"===s&&(0,y.tZ)("div",{children:(0,y.tZ)(yi.ZT,{icon:"mark_x_light",color:"#FFF",bgColor:c.g.colors.negative,iconSize:20})}),"locked"===s&&(0,y.tZ)("div",{children:(0,y.tZ)(yi.ZT,{icon:"lock",color:c.g.colors.text_main,bgColor:c.g.colors.disabled_background,iconSize:_,size:f})}),(0,y.tZ)("div",{className:"name",children:(0,y.tZ)("span",{children:o.group_name})}),"open"===s&&(0,y.tZ)(qt.k,{denominator:(null==o||null===(t=o.ras)||void 0===t?void 0:t.required)+(null==o||null===(i=o.rcs)||void 0===i?void 0:i.required),numerator:(null==o||null===(n=o.ras)||void 0===n?void 0:n.done)+(null==o||null===(r=o.rcs)||void 0===r?void 0:r.done)}),a&&(0,y.tZ)("div",{children:(0,y.tZ)(b.JO,{toolTip:lng("you are here"),icon:"pointer",className:"current",color:c.g.colors.dominant_main})}),g&&(0,y.tZ)(dt.zh,{}),o.is_owner&&(0,y.tZ)(R.x,{options:[{label:lng("edit"),href:{edit:"workspace",id:o.group_id}},{label:lng("edit required qualifications"),onClick:m}],children:(0,y.tZ)(b.JO,{icon:"menu",buttonLike:!0})})]})},Si=(0,n.lazy)((()=>Promise.all([i.e(866),i.e(833)]).then(i.t.bind(i,1420,23)))),Oi=(0,l.iv)("margin:20px 60px 0;padding:10px 30px 0;position:relative;max-height:calc(100vh - 335px);overflow:auto;border-top:1px solid ",c.g.colors.separator,";.level{padding-bottom:40px;display:flex;justify-content:center;flex-wrap:wrap;&.spaced{justify-content:space-between;}}.QualificationCard{margin-bottom:10px;}",""),Bi=e=>{let{ws:t}=e;const i=[];t.qual_list.forEach((e=>{const t=e.deps.reduce(((e,t)=>{let n=i.length-1;for(;n>=0&&!i[n].find((e=>e.group_id===t));n--);return Math.max(e,n)}),-1);i[t+1]||(i[t+1]=[]),i[t+1].push(e)}));for(let e=i.length-2;e>=0;e--)i[e].sort(((t,n)=>i[e+1].findIndex((e=>e.deps.includes(t.group_id)))-i[e+1].findIndex((e=>e.deps.includes(n.group_id)))));return(0,y.tZ)(n.Suspense,{fallback:(0,y.tZ)(ge.$,{}),children:(0,y.tZ)("div",{css:Oi,children:i.map(((e,i)=>(0,y.tZ)("div",{className:(0,v.AK)("level",{spaced:e.length>1}),children:e.map(((e,r)=>(0,y.BX)(n.Fragment,{children:[(0,y.tZ)(Ci,{id:"qc_"+e.group_id,qualification:e,css:(0,l.iv)("margin-left:",i%2==0?25:-25,"px;",""),fetchQualList:()=>t.fetchQualList(),current:t.group_id==e.group_id}),e.deps.map((t=>(0,y.tZ)(Si,{start:"qc_"+t,end:"qc_"+e.group_id,headSize:4,lineColor:c.g.colors.set[(i+r)%16],headColor:c.g.colors.set[(i+r)%16],curvness:.5,arrowBodyProps:{strokeDasharray:""}},`qc_${t}_${e.group_id}`)))]},e.group_id)))},i)))})})};var Ti=i(7033);const Ni=(0,l.iv)("margin:20px 60px 0;padding:10px 30px 0;position:relative;max-height:calc(100vh - 335px);overflow:auto;border-top:1px solid ",c.g.colors.separator,";",""),Ii=e=>{let{ws:t}=e;const i=[],n=[],r=[],s=[];return t.qual_list.forEach((e=>{e.has_perm?s.push(e):"1"===e.c_completed?i.push(e):e.user_id?r.push(e):n.push(e)})),(0,y.tZ)("div",{css:Ni,children:(0,y.BX)(Ti.U,{children:[s.length>0&&(0,y.tZ)(ji,{data:s,title:lng("manager"),groupId:t.group_id,fetchQualList:()=>t.fetchQualList()}),i.length>0&&(0,y.tZ)(ji,{data:i,title:lng("completed"),groupId:t.group_id,fetchQualList:()=>t.fetchQualList()}),r.length>0&&(0,y.tZ)(ji,{data:r,title:lng("open"),groupId:t.group_id,fetchQualList:()=>t.fetchQualList()}),n.length>0&&(0,y.tZ)(ji,{data:n,title:lng("next"),fetchQualList:()=>t.fetchQualList()})]})})},Di={name:"mbeivf",styles:"padding-top:10px;.title{font-size:1.6em;font-weight:600;padding-bottom:10px;}.list{display:flex;flex-wrap:wrap;>div{margin:10px;}}"},ji=e=>{let{data:t,title:i,groupId:n,fetchQualList:r}=e;return(0,y.BX)("div",{css:Di,children:[(0,y.tZ)("div",{className:"title",children:i.caps()}),(0,y.tZ)("div",{className:"list",children:t.map((e=>(0,y.tZ)(Ci,{qualification:e,current:n==e.group_id,fetchQualList:()=>r()},e.group_id)))})]})},Pi=(0,l.iv)("display:flex;justify-content:center;margin:20px 60px 0;padding:40px 30px 0;position:relative;max-height:calc(100vh - 335px);overflow:auto;border-top:1px solid ",c.g.colors.separator,";",""),zi=e=>{let{ws:t}=e;return(0,y.tZ)("div",{css:Pi,children:(0,y.tZ)(Ti.U,{children:(0,y.tZ)(Je.mp,{tree:t.conditionsTree,idField:"group_id",nameField:"group_name",activeId:t.group_id+"",renderNode:(e,t)=>(0,y.tZ)(Ci,{qualification:e,current:t,className:"row-style"},e.group_id),nodeHeight:61,treeMargin:60})})})},Ei=(0,l.iv)("height:125px;background-color:#FFF;color:",c.g.colors.dark_blue,";padding:30px 70px;display:flex;align-items:center;justify-content:space-between;.title-info{width:68%;}",c.g.mQuery.mobile,"{flex-direction:row;width:100%;padding:20px;}.title-info{display:flex;flex-direction:row;text-align:",c.g.near,";>div{",c.g.classes.margin_near("15px"),";}}.level-title{display:flex;flex-direction:column;justify-content:center;align-items:start;.top-level-title{display:inline-block;font-size:1em;font-weight:500;}.bottom-level-title{display:inline-block;font-size:1.5em;font-weight:600;margin-top:7px;}}.progress-expand{display:flex;width:30%;.levels-progress{padding:0 40px;display:flex;width:50%;flex-direction:column;border-left:1px solid ",c.g.colors.separator,";text-align:center;",c.g.mQuery.mobileNarrow,"{display:none;}}.levels-progress-number{font-size:2em;font-weight:300;>span{color:",c.g.colors.disabled_text,";}}.expand-button{width:40%;align-self:center;text-align:",c.g.far,";",c.g.mQuery.mobile,"{display:none;}}}",""),Ri=(0,p.observer)((e=>{var t;let{ws:i}=e;const n=null===(t=i.qual_list)||void 0===t?void 0:t.filter((e=>!!e.c_completed));return(0,y.BX)("div",{css:Ei,children:[(0,y.BX)("div",{className:"title-info",children:[(0,y.tZ)(_i.F$,{ribbon:!0,color:"#F25341",size:"75",label:i.qual_top_name,underLabel:!1}),(0,y.BX)("div",{className:"level-title",children:[(0,y.tZ)("div",{className:"top-level-title",children:i.qual_top_name}),(0,y.tZ)("div",{className:"bottom-level-title",children:i.group_name})]})]}),i.is_member&&!!i.creditRequired&&(0,y.BX)("div",{className:"top-level-title",children:[lng("credits").caps(),": ",i.userCredit,"/",i.creditRequired]}),(0,y.BX)("div",{className:"progress-expand",children:[(0,y.BX)("div",{className:"levels-progress",children:[(0,y.tZ)("div",{children:lng("progress").caps()}),(0,y.BX)("div",{className:"levels-progress-number",children:[n.length," ",(0,y.BX)("span",{children:["/ ",i.qual_list.length]})]})]}),(0,y.tZ)("div",{className:"expand-button",children:(0,y.tZ)(_.l,{theme:i.qualificationLevelsExpand>1?"outlined":"contained",onClick:()=>i.qualificationLevelsExpand++,children:i.qualificationLevelsExpand>1?(0,y.tZ)("span",{children:lng("close").caps()}):(0,y.BX)("span",{children:[(0,y.tZ)(b.JO,{icon:"map_spot"})," ",lng("view full path").caps()]})})})]}),i.qualificationLevelsExpand>1&&(0,y.tZ)(Mi,{ws:i,onClose:()=>i.qualificationLevelsExpand=1,wantToClose:i.qualificationLevelsExpand>2})]})})),Fi=(0,l.iv)("@keyframes levelsSlideIn{from{top:calc(-100% - 100px);}to{top:-100px;}}@keyframes levelsSlideOut{from{top:-100px;}to{top:calc(-100% - 100px);}}position:fixed;z-index:",c.g.z.top_bar-1,";top:195px;bottom:0;left:0;right:0;color:initial;overflow:hidden;margin:0;border-top:1px solid ",c.g.colors.dark_blue,";.slider{position:absolute;background-color:#FFF;animation:levelsSlideIn .8s cubic-bezier(.65, -0.32, .44, 1.33);top:-100px;width:100%;height:calc(100% + 100px);padding:100px 20px 0;>div{padding:40px 80px;}}&._start{.slider{top:calc(-100% - 100px);}}&._close{.slider{animation:levelsSlideOut .5s cubic-bezier(.65, -0.32, .44, 1.33);top:calc(-100% - 100px);}}.top-bar{display:flex;margin:0 100px;align-items:center;.title{font-size:2em;font-weight:600;}}",""),Mi=e=>{var t;let{ws:i,onClose:r,wantToClose:s}=e;(0,Z.Ry)();const[o,a]=(0,n.useState)(0),[l,c]=(0,n.useState)((null===(t=i.group_options)||void 0===t?void 0:t.qualification_path_default)||"cards");(0,n.useEffect)((()=>{a(o+1),s&&r&&setTimeout(r,500)}),[s]);const d=[{val:"cards",icon:"view_tiles",label:lng("card view")},{val:"chart",icon:"tree",label:lng("flow chart")},{val:"conditions",icon:"hierarchy",label:lng("conditions tree")}],p=d.find((e=>e.val===l));return(0,y.tZ)("div",{css:Fi,className:(0,v.AK)({_start:0===o,_close:2===o}),children:(0,y.tZ)("div",{className:"slider",children:(0,y.BX)("div",{children:[(0,y.BX)("div",{className:"top-bar",children:[(0,y.tZ)("div",{className:"title",children:lng("my path").caps()}),(0,y.tZ)(dt.zh,{}),(0,y.tZ)("div",{style:{margin:"0 15px",fontSize:"1.2em"},children:p.label.caps()}),(0,y.tZ)(fi.T,{options:d,onChange:c,value:l,size:40})]}),"cards"===l&&(0,y.tZ)(Ii,{ws:i}),"chart"===l&&(0,y.tZ)(Bi,{ws:i}),"conditions"===l&&(0,y.tZ)(zi,{ws:i})]})})})};var Ai=i(3016);const qi=(0,p.observer)((function(e){let{filteredItems:t,actions:i}=e;const n=[{title:lng("subject")},{title:lng("started by")},{title:lng("start date")},{title:lng("last update")},{}];return(0,y.tZ)(ye.iA,{cols:n,collection:t,actions:i,RowRenderer:Li,rowIdCol:"com_id",noWindow:!0})})),Xi=(0,l.iv)(".Avatar{vertical-align:middle;",c.g.classes.margin_far(".5em"),";}",""),Li=(0,p.observer)((function(e){let{row:t}=e;return(0,y.BX)("tr",{css:Xi,onClick:()=>(0,zt.vm)().openCommentsDialog({type:"patients_communication",object_id:t.com_id}),children:[(0,y.tZ)(xe.U6,{children:t.subject}),(0,y.BX)("td",{children:[(0,y.tZ)(mt.qE,{user:t.owner})," ",(0,v.v2)(t.owner)]}),(0,y.tZ)("td",{children:(0,y.tZ)(Ce.qp,{time:t.creation_time})}),(0,y.tZ)("td",{children:(0,y.tZ)(Ce.ij,{time:t.modification_time})}),(0,y.tZ)(xe.jA,{children:(0,y.tZ)(b.JO,{icon:"pretend",toolTip:lng("open communication as patient"),href:Blsm.prm.Mainref+`patient_com?com=${t.com_id}_${t.access_key}${"vendev"in(0,v.Lv)()?"&vendev":""}`,newTab:!0})})]})}));var $i=i(7138),Vi=i(2267);class Ui extends $i.U{constructor(e){super({...e,baseRoute:"tasks"})}createAttributes(){var e;this.attributes=[{name:"task_type_id",label:lng("type"),type:"component",Render:Vi.Sj,props:{tasks_types:this.serverResponse.tasks_types}},{name:"status_id",label:lng("status"),type:"component",Render:Vi.A_,props:{tasks_status:null===(e=this.serverResponse.tasks_status)||void 0===e?void 0:e.map((e=>{let{status_id:t,status_name:i,task_resolution:n,enabled:r}=e;return{status_id:t,status_name:i,task_resolution:n,enabled:r}}))}},{name:"allocated_to",label:lng("assignee"),type:"select",emptyOption:!0,options:[{optgroup:!0,label:lng("managers").caps(),options:this.serverResponse.users.filter((e=>e.is_manager)).map((e=>({val:e.user_id,label:e.full_name})))},{optgroup:!0,label:lng("members").caps(),options:this.serverResponse.users.filter((e=>!e.is_manager)).map((e=>({val:e.user_id,label:e.full_name})))}]},{type:"component",Render:wi.R9,label:lng("some of the tasks may not allow changing the assignee to the selected one").caps(),bold:!0,visible:e=>e.get("allocated_to")&&!this.serverResponse.users.find((t=>t.user_id===e.get("allocated_to"))).is_manager},this.serverResponse.is_group_manager&&{name:"priority",label:lng("priority"),type:"select",options:(0,v.wd)(Blsm.InitialData.parameters.priority),emptyOption:!0},{name:"severity",label:lng("severity"),type:"select",options:(0,v.wd)(Blsm.InitialData.parameters.severity),emptyOption:!0},{name:"start_date",label:lng("start date"),type:"date_time",minDate:moment().subtract(1,"days")},{name:"due_date",label:lng("due date"),type:"date_time",minDate:moment().subtract(1,"days")},{name:"manager_only",label:lng("manager only"),type:"checkbox"},{name:"task_locked",label:lng("lock for members"),type:"checkbox"},{name:"archive",label:lng("archive|verb"),type:"checkbox"},{name:"tags",label:lng("tags"),type:"tags"}].filter((e=>e)),this._fields=[{type:"checkbox",name:"send_notifications",label:lng("send notifications")}]}SaveSuccess(){}}function Hi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ji extends m.I{constructor(e){super(e),Hi(this,"groupId",void 0),this.groupId=e.group_id;const t={};t.assignments=e.assignments.reduce(((e,t)=>({...e,[t.assignment_id]:{id:t.assignment_id,label:t.title,poster:t.image}})),{}),t.content=e.content.reduce(((e,t)=>({...e,[t._attr.lesson_id]:{id:t._attr.lesson_id,label:t.title,poster:t.image}})),{});const i=(0,zt.vm)().getStore("workspace",this.groupId);this.title=lng("manage components").caps(),this.successMessage=lng("components saved successfully"),this._fields=[i.mayCreateAssignments()&&{type:"multiple_items",name:"assignments",label:lng("assignments"),valueIsMap:!0,poster:!0,theme:"bright",searchData:(e,t)=>{let{term:i,ids:n}=e;(0,C.SC)("assignment/search_owned",{data:{term:i,id:n,limit:n?null:10}},t)}},i.mayShareContent()&&{type:"multiple_items",name:"content",label:lng("content"),valueIsMap:!0,poster:!0,theme:"bright",searchData:(e,t)=>{let{term:i,ids:n}=e;(0,C.SC)("content",{data:{join_catalog:1,term:i,id:n,limit:n?null:10}},t)}},{type:"single_item",name:"import_from_group",label:lng("import from another workspace"),searchData:(e,t)=>{(0,C.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",managed_perm:"manage",term:e.term||"",id:e.ids||""}},t)},onValueChange:e=>{e.length&&(0,C.SC)("groups/import_components/group_id="+e,{},(e=>{let{assignments:t,content:n}=e;if(i.mayCreateAssignments()){let e=t.filter((e=>!Array.from(this.getValue("assignments").values()).find((t=>t.id===e.assignment_id))));const i=[...e.map((e=>[e.assignment_id,{id:e.assignment_id,label:e.name,poster:e.assignment_image,subLabel:{text:lng("new").caps(),color:c.g.colors.positive}}])),...this.getValue("assignments").entries()];this.updateValue(new Map(i),"assignments")}if(i.mayShareContent()){const e=[...n.filter((e=>!Array.from(this.getValue("content").values()).find((t=>t.id===e.lesson_id)))).map((e=>[e.lesson_id,{id:e.lesson_id,label:e.name,poster:e.assignment_image,subLabel:{text:lng("new").caps(),color:c.g.colors.positive}}])),...this.getValue("content").entries()];this.updateValue(new Map(e),"content")}this.updateValue([],"import_from_group")}))}}],this._prepFields(t),this.ready=!0}save(e){e.groupId=this.groupId,this.saveToUrl("groups/syncComponents",e)}SaveSuccess(){const e=(0,zt.vm)();e.closeDialog(),e.invalidateStore("workspace",this.groupId)}}var Gi,Wi,Ki=i(8989);let Yi=(Gi=g.action.bound,Wi=class extends m.I{constructor(e){super(e),(0,g.makeObservable)(this),this.title=lng("add existing workspace as sub",e.typeName),this._build_fields()}_build_fields(){const e=this.params.availableRootGroups.filter((e=>e.id!==this.params.parent_id));this._fields=[{type:"single_item",name:"group",label:lng("select workspace")+` (${this.params.typeName})`,theme:"bright",poster:!0,searchData:(t,i)=>{const n=t.term.toLowerCase();i(e.filter((e=>e.label.toLowerCase().includes(n)||e.id.toString().includes(n))))}}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("groups/add_sub_group",{sub_groups:[e.group],parent:this.params.parent_id})}SaveSuccess(){(0,zt.vm)().closeDialog(),this.params.fetchHierarchy()}},Qi=Wi.prototype,en="SaveSuccess",tn=[Gi],nn=Object.getOwnPropertyDescriptor(Wi.prototype,"SaveSuccess"),rn=Wi.prototype,sn={},Object.keys(nn).forEach((function(e){sn[e]=nn[e]})),sn.enumerable=!!sn.enumerable,sn.configurable=!!sn.configurable,("value"in sn||sn.initializer)&&(sn.writable=!0),sn=tn.slice().reverse().reduce((function(e,t){return t(Qi,en,e)||e}),sn),rn&&void 0!==sn.initializer&&(sn.value=sn.initializer?sn.initializer.call(rn):void 0,sn.initializer=void 0),void 0===sn.initializer&&(Object.defineProperty(Qi,en,sn),sn=null),Wi);var Qi,en,tn,nn,rn,sn,on=i(8297);const an=[{val:"0",label:lng("off"),color:c.g.colors.text_placeholder,icon:"notice"},{val:"2",label:lng("managers only"),color:c.g.colors.warning,icon:"notice"},{val:"1",label:lng("on"),color:c.g.colors.dominant_main,icon:"notice"}],ln=e=>{let{index:t}=e;return(0,l.iv)("display:flex;color:",c.g.colors.dominant_white,";justify-content:center;height:100%;position:relative;>*{display:flex;margin:auto 0;flex:1;justify-content:center;align-items:center;}>.group-messages-visibility-selector{position:absolute;top:0;",c.g.far,":10px;padding:5px;margin:10px;}>.group-messages-scroll-button-container{&.end{justify-content:flex-end;align-items:flex-end;}&.start{justify-content:flex-start;align-items:flex-start;}>.group-messages-scroll-button{display:flex;cursor:pointer;border-radius:40px;height:40px;width:40px;background-color:rgba(255, 255, 255, 0.2);& .disabled{cursor:default;display:none;}&:hover{background-color:rgba(255, 255, 255, 0.5);}>.scroll-icon{margin:auto;}}}>.group-message{width:100%;display:flex;flex-direction:column;margin:auto 10px;position:relative;>.message-list-container{position:relative;overflow:hidden;max-width:25vw;>.message-list{display:flex;flex-wrap:nowrap;flex-direction:row;>.message{width:100%;flex-shrink:0;transition:transform .5s ease-in-out;transform:translateX(",100*t*(c.g.isRTL?1:-1),"%);}}}>.group-message-actions{position:absolute;top:-10px;",c.g.far,":0;}}","")},cn=(0,p.observer)((function(e){let{id:t}=e;const i=(0,n.useContext)(zt.l9).getStore("workspace",t),{groupMessages:r,mayAddMessage:s,mayEditMessageVisibility:o,group_options:a,addGroupMessage:d,removeGroupMessage:p,toggleGroupMessage:u,updateNoticeBoardVisibility:m}=i,[g,h]=(0,n.useState)(0);let v;switch((0,n.useEffect)((()=>{h(0)}),[r]),a.notice_board){case"0":v=c.g.colors.text_placeholder;break;case"2":v=c.g.colors.warning;break;default:v=c.g.colors.dominant_main}const _=[{val:"remove",label:lng("remove message"),icon:"trash"},{val:"edit",label:lng("edit message"),icon:"edit"}];var f;r.length>0&&r[g]&&_.push(2==(null===(f=r[g])||void 0===f?void 0:f.deleted)?{val:"toggle",label:lng("activate message"),icon:"notifications"}:{val:"toggle",label:lng("deactivate message"),icon:"notifications_off"});return(0,y.BX)("div",{css:ln({index:g}),className:"mobile_off",children:[o&&(null==a?void 0:a.notice_board)&&(0,y.tZ)("div",{css:(0,l.iv)("color:",c.g.colors.text_main,";",""),className:"group-messages-visibility-selector",children:(0,y.tZ)(R.x,{title:lng("message board"),onSelect:e=>m(e),options:[0!==parseInt(a.notice_board)&&{label:lng("add a new message"),onClick:()=>d(),icon:"new"},{label:lng("visibility"),separator:!0},...an],children:(0,y.tZ)(yi.ZT,{icon:"notice",bgColor:v})})}),i.features.group_messages&&r&&r.length>0&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"group-messages-scroll-button-container end",children:0!==g&&(0,y.tZ)("div",{className:"group-messages-scroll-button",onClick:()=>h(g-1),children:(0,y.tZ)(b.JO,{className:"scroll-icon",icon:"arrow_near"})})}),(0,y.BX)("div",{className:"group-message",children:[s&&(0,y.tZ)("div",{className:"group-message-actions",children:(0,y.tZ)(R.x,{options:_,onSelect:e=>{switch(e){case"remove":(0,Ze.BB)(lng("are you sure you want to delete this message?"),{onConfirm:()=>p(r[g],(()=>h(0)))});break;case"edit":(0,zt.vm)().openDialog("form",new on.M({data:{ws:t,message:r[g]}}));break;case"toggle":u(r[g])}},title:lng("message options"),children:(0,y.tZ)(b.JO,{icon:"menu_h"})})}),(0,y.tZ)("div",{className:"message-list-container",children:(0,y.tZ)("div",{className:"message-list",children:r.map(((e,t)=>(0,y.tZ)("div",{className:"message",children:(0,y.tZ)(pn,{message:e,index:t,currentIndex:g})},t)))})})]}),(0,y.tZ)("div",{className:"group-messages-scroll-button-container start",children:g!==r.length-1&&(0,y.tZ)("div",{className:"group-messages-scroll-button",onClick:()=>h(g+1),children:(0,y.tZ)(b.JO,{className:"scroll-icon",icon:"arrow_far"})})})]})]})})),dn=(0,l.iv)("display:flex;max-width:100%;flex-direction:column;justify-content:center;align-items:center;>.message-date{font-weight:bold;font-size:.9em;}>.message-text{max-width:100%;max-height:1.5em;word-wrap:break-word;",c.g.classes.ellipsis,";}>.show-full-message{text-decoration:underline;cursor:pointer;}",""),pn=(0,p.observer)((e=>{let{message:t}=e;return(0,y.BX)("div",{css:dn,children:[(0,y.tZ)("div",{className:"message-date",children:moment(new Date(1e3*t.time)).format(`${Blsm.prm.date_moment_format} kk:mm`)}),(0,y.tZ)("div",{className:"message-text",children:(0,v.s9)(t.text)}),(0,y.tZ)("div",{onClick:()=>{(0,Ze.qR)((0,y.tZ)(f.xn,{content:t.text}),{title:moment(new Date(1e3*t.time)).format(`${Blsm.prm.date_moment_format} kk:mm`),width:"60%"})},className:"show-full-message",children:lng("show full message").caps()})]})}));var un=i(9234),mn=i(2307),gn=i(5758),hn=i(9793);class bn extends m.I{constructor(e){super(e),this.options=e.options||{},this.onSave=e.onSave,this.data=e.data,this.title=lng("create learning unit").caps(),this.headExtra=(0,y.tZ)(hn.b,{children:e.data.unit_id&&(0,y.tZ)(b.JO,{icon:"trash",className:"task-button",onClick:()=>e.onDelete()})}),this._buildFields(),this._prepFields(e.data||{}),this.ready=!0}save(e){var t;null===(t=this.onSave)||void 0===t||t.call(this,e)}_buildFields(){this._fields=[{type:"text",name:"unit_name",label:lng("unit name")},{type:"select",name:"parent_unit",label:lng("parent unit"),options:this.options.parentUnits.filter((e=>{let[t]=e;return!(0,v.B5)(this.data.unit_id)||t!=this.data.unit_id}))},{type:"number",name:"unit_order",label:lng("unit position")+` (${lng("relative to parent")})`},{type:"checkbox",name:"unit_hide",label:lng("hide unit"),disable:()=>!!this.values.get("unit_hide_to_date")&&!this.values.get("unit_hide")},{type:"date",name:"unit_hide_to_date",label:lng("hide until date"),disable:()=>!!this.values.get("unit_hide")},{type:"component",node:(0,y.BX)("div",{style:{fontWeight:"600",textAlign:c.g.near},children:[(0,y.BX)("div",{children:[lng("notice").caps(),": ",lng("hiding the learning unit will only affect the learning units tab.").caps()]}),(0,y.tZ)("div",{children:lng("components can still be accessed from other places, such as: search, portal and more").caps()})]})}]}}var vn=i(9039);const _n=(0,l.iv)(">._title{display:flex;margin-bottom:2rem;align-items:center;>div{color:",c.g.colors.text_main,";font-size:1.4rem;font-weight:600;}}>.units-scroll{max-height:83vh;overflow-x:hidden;overflow-y:auto;padding-top:5px;",c.g.classes.padding_near("8px"),";",c.g.classes.padding_far("3px"),";border-bottom:1px solid ",c.g.colors.separator_light,";>._main_unit{color:",c.g.colors.text_sec,";min-height:50px;",c.g.classes.padding_near("18px"),";",c.g.classes.border_near("2px solid #dfdfdf"),";padding-bottom:1.5em;&:last-of-type{border-color:transparent;}._unit_name{display:flex;position:relative;>._completed{position:absolute;top:6px;",c.g.near,":-24px;width:11px;height:11px;border-radius:50%;transition:all .1s ease-in-out;text-align:center;font-size:0.5rem;}span.name{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}.unit-edit{visibility:hidden;padding:0 3px;}span.count{font-weight:normal;color:",c.g.colors.text_light_disabled,';margin-left:15px;}}>div{position:relative;top:-5px;>._unit_name:before{content:"";position:absolute;top:5px;',c.g.near,":-24px;width:11px;height:11px;border-radius:50%;background-color:",c.g.colors.text_sec,";transition:all .1s ease-in-out;}>div ._unit_name{font-size:.85em;",c.g.classes.margin_near(".5em"),";margin-top:.5em;}._unit_name{font-weight:600;cursor:pointer;&.disabled{color:",c.g.colors.text_light_disabled,";cursor:not-allowed;}}}}.learning-unit:hover{>div>div>.unit-edit{visibility:visible;}}}&:not(.disabled)>.units-scroll>._main_unit>div ._unit_name{>._completed{background-color:",c.g.colors.text_sec,";&:not(._main){",c.g.near,":-30.5px;top:3.5px;.fas{margin-top:2.5px;}}}&:hover,&._active{color:",c.g.colors.dominant_main,";&:before{top:1px;",c.g.near,":-28px;width:19px;height:19px;background-color:",c.g.colors.dominant_main,";}>._completed{background-color:",c.g.colors.dominant_main,";&._main{font-size:0.85rem;top:1.5px;}}}}&.disabled>.units-scroll>._main_unit>div{>._unit_name:before{background-color:",c.g.colors.text_light_disabled,";}._unit_name{color:",c.g.colors.text_light_disabled,";cursor:not-allowed;}}",""),fn=(0,p.observer)((function(e){let{ws:t}=e;return(0,y.BX)("div",{css:_n,children:[(0,y.BX)("div",{className:"_title",children:[(0,y.tZ)("div",{children:lng("learning units",{phrase:!0}).caps()}),(0,y.tZ)(dt.zh,{}),(null==t?void 0:t.mayChangeComponents())&&(0,y.tZ)("span",{children:(0,y.tZ)(b.JO,{icon:"new",toolTip:lng("new learning unit"),onClick:()=>(()=>{var e,i,n;const r=new bn({data:{parent_unit:(null===(e=t.active_unit)||void 0===e||null===(i=e.parent_unit)||void 0===i?void 0:i.unit_id)||(null===(n=t.active_unit)||void 0===n?void 0:n.unit_id)},options:{parentUnits:t.parentUnitsList()},onSave:e=>{t.saveUnit(e),(0,zt.vm)().closeDialog()}});(0,zt.vm)().openDialog("form",r)})()})})]}),(0,y.tZ)("div",{className:"units-scroll",children:t.orderedUnits.length>0&&t.orderedUnits.map((e=>(0,y.tZ)(yn,{unit:e,main:!0},(0,Vt.Lj)(e,"unit_id"))))})]})})),yn=(0,p.observer)((function e(t){var i,n;let{unit:r,main:s}=t;const o=null===(i=r.workspace)||void 0===i?void 0:i.mayChangeComponents(),a=(null===(n=r._attr)||void 0===n?void 0:n.unit_hide)||r._attr.unit_hide_to_date&&r._attr.unit_hide_to_date>(0,v.c7)();if((0===r.fullCount||a)&&!o)return null;return(0,y.tZ)("div",{className:(0,v.AK)("learning-unit",{_main_unit:s}),children:(0,y.BX)("div",{children:[(0,y.BX)("div",{className:(0,v.AK)("_unit_name",{_active:r.active}),onClick:()=>r.workspace.setActiveUnit(r),title:(0,Vt.Lj)(r,"unit_name"),children:[r.isCompleted&&(0,y.tZ)(b.JO,{className:(0,v.AK)("_completed",{_main:s}),icon:"mark_v",color:c.g.colors.bg_main}),(0,y.tZ)("span",{className:"name",children:(0,Vt.Lj)(r,"unit_name")}),(0,y.tZ)(dt.zh,{}),o&&(0,v.B5)(r.unit_id)&&a&&(0,y.tZ)(b.JO,{className:"unit-hidden",icon:"preview",toolTip:lng("unit hidden")}),o&&(0,v.B5)(r.unit_id)&&(0,y.tZ)(b.JO,{icon:"edit",className:"unit-edit",toolTip:lng("edit learning unit"),onClick:e=>(e.stopPropagation(),(()=>{const e=new bn({data:r._attr,options:{parentUnits:r.workspace.parentUnitsList()},onSave:e=>{r.workspace.saveUnit(e,r.unit_id),(0,zt.vm)().closeDialog()},onDelete:()=>{(0,Ze.BB)(lng("are you sure you want to delete the learning unit?"),{onConfirm:()=>{r.workspace.deleteUnit(r.unit_id),(0,zt.vm)().closeDialog()}})}});(0,zt.vm)().openDialog("form",e)})())}),r.count>0&&(0,y.tZ)("span",{className:"count",children:r.count})]}),r.active&&(0,y.tZ)("div",{className:"_sub_units",children:r.sub_units.length>0&&r.sub_units.map((t=>(0,y.tZ)(e,{unit:t},(0,Vt.Lj)(t,"unit_id"))))})]})})})),wn=(0,l.iv)(">.InputDropDown{display:block;}>.title{color:",c.g.colors.text_main,";font-size:1.2rem;font-weight:600;}",""),xn=e=>{let{ws:t}=e;const i=t.orderedUnits.map((e=>0!==e.fullCount&&{id:e.unit_id,name:e.name,count:e.count,sons:e.sub_units.map((e=>({id:e.unit_id,name:e.name,count:e.count,sons:[]})))}));return(0,y.BX)("div",{css:wn,children:[(0,y.tZ)("div",{className:"title",children:lng("learning units",{phrase:!0}).caps()}),(0,y.tZ)(vn.B,{tree:i,value:t.active_unit_id,onChange:e=>t.setActiveUnit({unit_id:e}),showSearch:!1})]})};var kn=i(3550),Zn=i(4765),Cn=i(5033),Sn=i(619),On=i(7166);const Bn=(0,l.iv)("display:flex;.components{flex-grow:1;padding:20px;min-height:550px;width:100%;.title-container{display:flex;justify-content:space-between;}.drop-files{",c.g.classes.opposite_float,";}.title{font-size:1.3rem;color:",c.g.colors.text_main,";font-weight:700;padding:0 10px 5px;}}",c.g.mQuery.mobile,"{flex-direction:column;.components{padding:0px;min-height:0;}}",""),Tn=(0,p.observer)((function(e){var t;let{ws:i}=e;const n=i.filteredAssignments.length,r=i.allEvents.length,s=i.filteredSharedContent.length,o=i.unitsTree(),a=i.components.filter((e=>e.selected)),l=!(0,v.xb)((0,g.toJS)(i.components_filterNsort).filter),c=i.components.length>0||l,d=i.MeetingActions(),p=a.filter((e=>"share"===e.type)),u=p.every((e=>e._attr.lesson_owners.some((e=>(0,v.Tz)(e)))||3==e._attr.lesson_public||Blsm.user.isManager&&2==e._attr.lesson_public));(0,Z.iP)(),d.push(c&&i.mayChangeComponents()&&{icon:"edit",toolTip:u?lng("edit multiple content"):lng("some of the content cannot be edited as you do not have the editing permissions"),action:u&&p.length?()=>{(0,zt.vm)().openDialog("form",new mn.s({names:p.map((e=>e.title)),ids:p.map((e=>{let{_attr:t,assignment_id:i}=e;return t.lesson_id?t.lesson_id:i})),folderOptions:i.folderTree,extraUrlData:{ws:i.id},onSaveSuccess:()=>((0,zt.vm)().closeDialog(),i.fetch())}))}:void 0},(null==o?void 0:o.length)&&i.mayChangeComponents()&&{icon:"AssignOutsource",menu:a.length>0&&o,onSelect:e=>i.moveSelectedToUnit(e),toolTip:0===a.length?lng("move component"):void 0});const{filtersVals:m,setFilterVals:_,sort:f,setSort:w}=(0,Z.qD)(i.components_filterNsort),{filters:x,sorts:k}=i.tabFiltersSorts,C=i.mayCreateMeetings()?[{href:(0,h.p4)({edit:"meeting",params:{ws:i.group_id,unit:(0,v.B5)(i.active_unit_id),date:(0,ce.k6)(i.activeCalendarDate,{format:"YYYY-MM-DD"})}}),label:lng("new meeting")},(0==i.units.length||0===i.active_unit_id||-1===i.active_unit_id)&&{label:lng("new event"),onClick:()=>i.openEventForm()}]:[];let S=i.unitIds.length>0&&(i.componentsList.some((e=>e.unitId))||i.mayCreateComponent())||i.showUnits;return(0,y.BX)("div",{css:Bn,children:[S&&((0,v.tq)()?(0,y.tZ)("div",{children:(0,y.tZ)(xn,{ws:i})}):(0,y.tZ)(gn.h,{className:"lu-side-panel",width:"250px",children:(0,y.tZ)(fn,{ws:i})})),(0,y.tZ)("div",{className:"components",children:c?i.componentsView?(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"title-container",children:(0,y.tZ)("div",{className:"title",children:null===(t=i.active_unit)||void 0===t?void 0:t.attr("unit_name")})}),(0,y.tZ)(hi.CX,{actions:d,filters:c?x:[],filtersVals:m,onFilter:_,sorts:c?k:[],sort:f,onSort:w,alwaysShow:!0,checkAll:i.mayChangeComponents()?{checked:i.isVisibleChecked,onCheck:e=>i.checkVisible(e)}:void 0}),i.mayChangeComponents()?(0,y.tZ)(kn.b,{onSort:e=>{let{new_order:t}=e;return i.setComponentOrder(t)},children:i.components.map((e=>(0,y.tZ)(Zn.Q,{item:e,onClick:()=>i.setActiveComponent(e.assignment_id)},e.assignment_id)))}):i.components.map((e=>(0,y.tZ)(Zn.Q,{item:e,onClick:()=>i.setActiveComponent(e.assignment_id)},e.assignment_id))),i.meetingUrl&&(0,y.tZ)(Ze.bZ,{title:lng("invite guest"),width:"40vw",onCancel:()=>i.setMeetingUrl(!1),children:(0,y.BX)("div",{children:[(0,y.tZ)(On.g,{copy:i.meetingUrl,success:lng("invite link copied to clipboard"),buttonLike:!0,toolTip:lng("copy|verb")}),lng("copy and send to user:").caps(),(0,y.tZ)("br",{}),(0,y.tZ)(Zt.I,{wrapped:!0,type:"text",value:i.meetingUrl,onFocus:e=>(e.target.select(),document.execCommand("copy"))})]})})]}):(0,y.BX)(y.HY,{children:[n+r+s===0&&(0,y.tZ)("div",{children:lng("nothing to show")}),n>0&&(0,y.BX)(y.HY,{children:[(0,y.BX)(Mt.uD,{children:[lng("assignments").caps()," (",n,")"]}),(0,y.tZ)(Cn.Mz,{assignments:i.filteredAssignments,useCarousel:!0,filtersAbove:!0})]}),r>0&&(0,y.BX)(y.HY,{children:[(0,y.BX)(Mt.uD,{children:[lng("schedule",{phrase:!0}).caps()," (",r,")"]}),(0,y.tZ)(Sn.V,{sideComponent:(0,y.tZ)(R.x,{options:C,children:(0,y.tZ)(b.JO,{icon:"new"})}),activeDate:i.activeCalendarDate,onDateSelect:e=>i.activeCalendarDate=e,onStripClick:e=>i.onCalendarStripClick(e),events:i.allEvents})]}),s>0&&(0,y.BX)(y.HY,{children:[(0,y.BX)(Mt.uD,{children:[lng("content").caps()," (",s,")"]}),(0,y.tZ)(Cn.Mz,{displayTags:!0,assignments:i.filteredSharedContent,filtersAbove:!0})]})]}):(0,y.tZ)(In,{ws:i})})]})})),Nn=(0,l.iv)(".first-title{text-align:center;font-size:1.5em;font-weight:600;}.second-title{text-align:center;font-size:1.1em;}.buttons{display:flex;justify-content:center;margin-top:20px;>div{margin:0 15px;min-width:200px;text-align:center;border-radius:12px;padding:30px 10px;border:1px solid ",c.g.colors.separator_light,";.header{font-size:1.2em;padding:10px 0 15px;}.el_icon{font-size:2.1em;}}}._nothing{text-align:center;width:100%;font-size:2em;color:",c.g.colors.text_sec,";font-style:italic;}",""),In=e=>{let{ws:t}=e;return(0,y.tZ)("div",{css:Nn,children:t.mayCreateComponent()?(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"first-title",children:lng("let's create the first component").caps()}),(0,y.tZ)("div",{className:"second-title",children:lng("what do you want to create?").caps()}),(0,y.BX)("div",{className:"buttons",children:[t.mayCreateAssignments()&&(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"menu_overview",color:c.g.colors.green}),(0,y.tZ)("div",{className:"header",children:lng("assignment").caps()}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>(0,zt.vm)().openDialog("TypeSelector",(0,Cn.aA)({ws:t.group_id,unit:(0,v.B5)(t.active_unit_id)})),children:lng("create assignment").caps()})]}),t.mayCreateMeetings()&&(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"menu_calendar",color:c.g.colors.purple}),(0,y.tZ)("div",{className:"header",children:lng("meeting").caps()}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>(0,h.p4)({edit:"meeting",params:{ws:t.group_id,unit:(0,v.B5)(t.active_unit_id)}},!0),children:lng("create meeting").caps()})]}),t.mayShareContent()&&(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"content",color:c.g.colors.light_blue}),(0,y.tZ)("div",{className:"header",children:lng("content").caps()}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>(0,h.p4)({edit:"share",params:{ws:t.group_id,unit:(0,v.B5)(t.active_unit_id)}},!0),children:lng("share content").caps()})]})]})]}):(0,y.tZ)("div",{className:"_nothing",children:lng("nothing to show").caps()})})};var Dn=i(5104),jn=i(4061),Pn=i(2464);const zn=(0,p.observer)((function(e){let{userStore:t}=e;const{blog:i,user_id:n,removeBlog:r,toggleLockPostComments:s,toggleUserVotePost:o}=t;return(0,y.tZ)(En,{collection:i,userId:n,removeBlog:r,toggleLockPostComments:s,toggleUserVotePost:o})})),En=(0,p.observer)((function(e){let{collection:t,userId:i,removeBlog:r,toggleLockPostComments:s,toggleUserVotePost:o}=e;const[a,l]=(0,n.useState)(!1),d=[lng("title"),lng("comments"),lng("actions")],p=[{icon:"new",action:()=>(0,h.p4)({edit:"content",params:{type:"blog",blog_in_profile:i}},!0),toolTip:lng("new post")}];return(0,y.BX)(y.HY,{children:[(0,y.tZ)(ye.iA,{cols:d,rowIdCol:"lesson_id",collection:t,actions:p,RowRenderer:Rn,noWindow:!0,rowProps:{removeBlog:r,toggleLockPostComments:s,toggleUserVotePost:o,rowAction:e=>l(e)},sticky:c.g.consts.TABLE_HEAD_HEIGHT,mobileSupport:!0}),a&&(0,y.tZ)(Mt.T,{icon:{icon:"vendor_blog",color:"green"},poster:{image:a.poster,title:a.lesson_name},title:a.poster?"":a.lesson_name,onClose:()=>l(!1),children:(0,y.tZ)(Mn,{postInfo:a})})]})})),Rn=(0,p.observer)((function(e){var t;let{row:i,rowProps:n}=e;const{lesson_id:r,lesson_name:s,likes:o,lesson_options:a,poster:l,author:d,can_edit:p,comment_count:u}=i,{removeBlog:m,toggleLockPostComments:g,toggleUserVotePost:_,rowAction:f}=n,w=c.g.consts.ITEM_IMG_SIZE+"px",x=parseInt(u),k=(0,v.Tz)(d.user_id)||Blsm.user.isPowerManager,Z="0"!=p,C=[{_:(0,y.BX)(y.HY,{children:[(0,y.tZ)(Pn.XI,{className:"_img",img:c.g.func.imgUrl(l),size:[w,w]})," ",s]})},{_:(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.JO,{icon:"discussion"})," ",x?x+" "+lng("comments"):lng("no comments").caps()]})},{type:"icons",icons:[{icon:o.user_vote?"love_full":"love",badge:null===(t=i.likes)||void 0===t?void 0:t.likes,onClick:()=>_(i),color:o.user_vote?c.g.colors.dominant_main:void 0},Blsm.isFeatureEnabled("assignments_comments")&&k&&(null!=a&&a.lock_comments?{icon:"lock",toolTip:lng("unlock comments"),onClick:()=>g(i)}:{icon:"lock_open",toolTip:lng("lock comments"),onClick:()=>g(i)}),Z&&{icon:"edit",onClick:()=>(0,h.p4)({edit:"content",id:r},!0)},Z&&{icon:"trash",onClick:()=>m(i)}]}];return(0,y.tZ)(ye.lF,{tds:C,onClick:()=>null==f?void 0:f(i)})})),Fn=(0,l.iv)(".title{font-weight:600;color:",c.g.colors.text_main,";margin:15px 0;}.post-content{margin:15px 0;padding:20px 2px;border-top:1px solid ",c.g.colors.separator,";}",""),Mn=e=>{let{postInfo:t}=e;const{lesson_id:i,author:n,creation_time:r,lesson_text_data:s,category_name:o,lesson_options:a,comments:l}=t,c=new G.pE({type:"content",object_id:i});return(0,y.BX)("div",{css:Fn,children:[(0,y.tZ)("div",{className:"title",children:(0,v.v2)(n)}),(0,y.tZ)(Ce.qp,{time:r,showTime:!1}),(0,y.tZ)("div",{children:o.caps()}),(0,y.tZ)(f.xn,{className:"post-content",content:s}),Blsm.isFeatureEnabled("assignments_comments")&&(0,y.BX)("div",{children:[(l.length>0||!(null!=a&&a.lock_comments))&&(0,y.BX)("div",{className:"title",children:[(0,y.tZ)(b.JO,{icon:"discussion"})," ",lng("comments").caps()]}),(0,y.tZ)(J.H,{locked:null==a?void 0:a.lock_comments,commentsStore:c,deletable:"1"===t.can_edit,connectTo:{type:"content",object_id:i},refresh:!0,allowFileSharing:!0})]})]})};var An=i(918),qn=i(5584);const Xn=(0,p.observer)((e=>{let{ws:t}=e;const[i,r]=(0,n.useState)("list"),[s,o]=(0,n.useState)((new Date).getFullYear());let a=[{name:"group_id",label:"#",type:"text"},{name:"group_name",label:lng("name"),type:"text",outOfMenu:!0},{name:"classification_name",label:lng("classification"),type:"select_multi",options:(0,kt._V)("classification_name",t.planning)}];const l=[{val:"",label:lng("default")},{val:"group_id",label:"#"},{val:"group_name",label:lng("name")},{val:"classification_name",label:lng("classification")}],d=[{title:"#",sortVal:"group_id",input:"text"},{title:lng("name"),sortVal:"group_name",input:"text",outOfMenu:!0},{title:lng("classification"),sortVal:"classification_name",input:"text"},{title:lng("actions")},{checkAll:!0}];if("calendar"===i)return(0,y.BX)("div",{children:[(0,y.tZ)(hi.$Q,{actions:[{icon:"list",action:()=>r("list"),toolTip:lng("list view")},{icon:"arrow_near",action:()=>o(s-1),toolTip:lng("previous year")},{text:s},{icon:"arrow_far",action:()=>o(s+1),toolTip:lng("next year")}]}),(0,y.tZ)(An.v,{curYear:s,moveYear:e=>o("up"===e?s+1:s-1),eventsArray:(0,An.a)(t.planning,s)})]});const p=[{icon:"calendar",action:()=>r("calendar"),toolTip:lng("yearly calendar")},{icon:"edit",toolTip:lng("edit multiple items"),action:()=>t.checkedPlanningItems.length&&(0,zt.vm)().openDialog("form",new qn.d({ids:t.checkedPlanningItems.map((e=>e.group_id)),names:t.checkedPlanningItems.map((e=>e.group_name)),objName:"Group",showStatusSelection:!0,fieldsSelectInitialValue:["cb_status","cb_group_invisible"],onSaveSuccess:()=>((0,zt.vm)().closeDialog(),t.fetch())}))},t.mayEditSetting()&&{icon:"visible_off",toolTip:lng("turn off all of plan visibility"),action:()=>(0,Ze.BB)(lng("are you sure you want to turn off visibility for all the courses in this workplan?"),{onConfirm:()=>(0,C.SC)("groups/workplan_off",{method:"POST",data:{group_id:t.group_id}},(()=>(0,be.qV)(lng("plan visibility turned off!"))))})}];return(0,y.tZ)("div",{children:(0,y.tZ)(ye.iA,{cols:d,collection:t.filteredPlanning,filters:a,sorts:l,filterNsort:t.planning_filterNsort,actions:p,RowRenderer:Ln,rowIdCol:"group_id",displayCount:!0,sticky:c.g.consts.TABLE_HEAD_HEIGHT+1})})})),Ln=(0,p.observer)((e=>{let{row:t}=e;const{group_id:i,group_name:n,classification_name:r,poster:s}=t;return(0,y.BX)("tr",{onClick:()=>(0,h.p4)({edit:"workspace",id:i},!0),children:[(0,y.BX)("td",{children:["#",i]}),(0,y.tZ)(xe.U6,{children:(0,y.BX)(dt.c_,{style:{alignItems:"center"},children:[(0,y.tZ)(mt.cU,{img:c.g.func.imgUrl(s)}),"   ",(0,y.tZ)("span",{children:n})]})}),(0,y.tZ)("td",{children:r}),(0,y.tZ)(xe.jA,{children:(0,y.tZ)(b.JO,{buttonLike:!0,icon:"enter",toolTip:lng("go to the workspace"),href:{workspace:i}})}),(0,y.tZ)(xe.Fo,{o:t})]})}));var $n=i(6005),Vn=i(9489);const Un={name:"ich0ul",styles:"max-width:900px;margin:0 auto;min-height:400px;._welcome_message{line-height:1.8em;img{max-width:100%;}}"},Hn=(0,p.observer)((e=>{let{ws:{welcome_message:t,displayManagers:i}}=e;return(0,y.BX)("div",{css:Un,children:[(0,y.tZ)(f.xn,{content:t,className:"_welcome_message"}),(0,y.tZ)("div",{className:"_managers",children:(0,y.tZ)(Gn,{displayManagers:i})})]})})),Jn=(0,l.iv)(">._title{display:block;overflow:hidden;color:",c.g.colors.text_main,";font-size:1.2em;font-weight:600;margin:17px 12px;padding:3px;}._about_manager{margin:20px 0;._inner{align-items:unset;}._inner_content{padding:10px 20px;}._title{font-weight:600;margin-bottom:15px;}._subTitle{color:",c.g.colors.text_main,";white-space:pre-line;}}",""),Gn=(0,p.observer)((e=>{let{displayManagers:t}=e;return t&&t.length?(0,y.BX)("div",{css:Jn,children:[(0,y.tZ)("div",{className:"_title",children:lng("about managers",{phrase:!0}).caps()}),t.map((e=>(0,y.tZ)(xt.o,{avatar:e,avatarBalloon:!1,title:e.full_name,subTitle:e.user_about,href:{user:e.user_id},className:"_about_manager",avatarSize:"150px"},e.user_id)))]}):null}));var Wn,Kn,Yn;function Qn(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let er=(Wn=g.action.bound,Kn=class extends m.I{constructor(e){super(e),function(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}(this,"currentTab",Yn,this),(0,g.makeObservable)(this),this.title=lng("task settings"),this.group_id=e.group_id,(0,C.SC)("tasks/edit_group_task_settings/group_id="+e.group_id,{},(e=>this.buildFields(e)))}buildFields(e){let{task_types:t,progress_percent:i,task_status:n,task_fields:r,task_privacy:s,task_description_template:o}=e;const a=i,l=t.filter((e=>!e.global)),d=n.filter((e=>!e.global));this._fields=[{type:"component",Render:wi.HA,props:{tabs:[{name:"general",title:lng("general")},r.length>0&&{name:"fields",title:lng("fields")}].filter((e=>e)),onChange:e=>this.currentTab=e}},{type:"section",visible:()=>"general"===this.currentTab,title:lng("task instructions that will show in the description").caps(),titleSmall:!0,fields:[{type:"richtext",name:"task_description_template",label:lng("task description template"),visible:()=>"general"===this.currentTab}]},{type:"checkbox",name:"task_privacy",label:lng("a task is available only to its creator and group managers"),visible:()=>"general"===this.currentTab},{type:"select_multi",name:"task_types",label:lng("additional task types for this workspace"),options:l.filter((e=>!e.global)).map((e=>({label:e.name,val:e.id,color:e.colors[0]}))),insert:l.length>0,visible:()=>"general"===this.currentTab},{type:"select_multi",name:"task_status",label:lng("additional task statuses for this workspace"),options:d.filter((e=>!e.global)).map((e=>({label:e.name,val:e.id,color:(0,Lt.Pp)(e.resolve)}))),insert:d.length>0,visible:()=>"general"===this.currentTab},{type:"section",bold:!0,title:lng("select the visibility of fields:").caps(),titleSmall:!0,visible:()=>r.length>0&&"fields"===this.currentTab,fields:[...r.map((e=>({type:"switcher",name:"task_fields["+e.field_id+"]",label:e.field_name,fullWidth:!0,options:[{val:"0",label:lng("off").caps(),color:c.g.colors.text_placeholder},{val:"2",label:lng("managers only").caps(),color:c.g.colors.warning},{val:"1",label:lng("on").caps(),color:c.g.colors.dominant_main}]}))),{type:"switcher",name:"progress_percent",label:lng("task progress"),fullWidth:!0,options:[{val:"0",label:lng("off").caps(),color:c.g.colors.text_placeholder},{val:"2",label:lng("managers only").caps(),color:c.g.colors.warning},{val:"1",label:lng("on").caps(),color:c.g.colors.dominant_main}],value:a}]}];const p=r.reduce(((e,t)=>({[t.field_id]:t.enabled,...e})),{});this._prepFields({task_types:l.filter((e=>e.enabled)).map((e=>e.id)),task_status:d.filter((e=>e.enabled)).map((e=>e.id)),task_fields:p,task_privacy:s,task_description_template:o}),this.ready=!0}save(e){this.saveToUrl("tasks/update_group_task_settings",Object.assign({group_id:this.group_id},e))}SaveSuccess(){(0,zt.vm)().closeDialog()}},Yn=Qn(Kn.prototype,"currentTab",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"general"}}),Qn(Kn.prototype,"SaveSuccess",[Wn],Object.getOwnPropertyDescriptor(Kn.prototype,"SaveSuccess"),Kn.prototype),Kn);const tr=(0,l.iv)("._top_widgets{padding-top:90px;",c.g.classes.content_width,";margin:-65px auto ",c.g.consts.CONT_MARGIN,"px;color:",c.g.colors.text_sec,";display:flex;>*:nth-of-type(2){flex-grow:1;}}._display_message{text-align:center;color:white;font-size:2em;padding-top:18px;}",""),ir=(0,p.observer)((function(e){var t,i,r,s;let{id:o}=e;const a=(0,n.useContext)(zt.l9).getStore("workspace",o),{ready:l,group_name:d}=a;(0,v.Ju)(d);const p=(0,Z.iP)();if((0,n.useEffect)((()=>{const e=Ki.X.get("recent_groups")||[],t=[...new Set([+o,...e])].slice(0,10);Ki.X.set("recent_groups",t)}),[]),!l)return(0,y.tZ)(bi.h,{});const{display_message:u,polls:m,filteredDiscussionsBlogs:g,discussionsBlogs:_,discussions_blogs_filterNsort:f,filteredTasks:w,tasks:x,showTaskProgress:k,tasks_filterNsort:C,is_manager:S,is_owner:O,selectedTasks:B,tab:T,lastBackTab:N,tabs:I,createPoll:D,removeBlog:j,toggleUserVotePost:P,toggleLockPostComments:z,activeBlog:E,setActiveBlog:R,patients_communication:F,loading_tasks:M,showNewComponentButton:A}=a;if(u)return(0,y.tZ)(Et.T,{css:tr,bottomPadding:!0,contBG:!0,children:(0,y.tZ)(vi.Fz,{children:(0,y.tZ)("div",{className:"_display_message",children:u})})});const q=[{icon:"trash",action:B.length?()=>a.deleteTasks(B):void 0,toolTip:lng("delete task")},S&&{icon:"edit",action:B.length?()=>(0,zt.vm)().openDialog("form",new Ui({names:B.map((e=>e.task_title)),ids:B.map((e=>e.task_id)),extraUrlData:{ws:o},onSaveSuccess:()=>((0,zt.vm)().closeDialog(),a.fetchTasks())})):void 0},(S||O)&&{icon:"AssignOutsource",toolTip:lng("move task"),action:B.length?()=>a.moveTasks(B):void 0},(S||O)&&{icon:"settings",action:()=>(0,zt.vm)().openDialog("form",new er({group_id:o}))},(S||O)&&{icon:"menu",menu:[{label:lng("import tasks"),href:{import:"tasks",params:{group_id:o}}},{label:lng("task status report"),href:{report:"TasksStatusReport",params:{group:o}}}]}];let X,L=null;const $=e=>{switch(e){case"components":return(0,y.tZ)(Tn,{ws:a});case"social":return(0,y.BX)(y.HY,{children:[(a.features.discussions||a.features.blog)&&(0,y.tZ)(Ai.O,{filteredItems:g,items:_,filterNsort:f,removeBlog:j,toggleUserVotePost:P,toggleLockPostComments:z,setActiveBlog:R}),a.features.polls&&(0,y.tZ)(pi.T,{children:m.map((e=>(0,y.tZ)(ai,{workspaceStore:a,poll:e,color:c.g.func.id2color(e.assignment_id)},e.assignment_id)))}),E&&(0,y.tZ)(Mt.T,{icon:{icon:"vendor_blog",color:"green"},poster:{image:E.poster,title:E.lesson_name},title:E.poster?"":E.lesson_name,onClose:()=>R(!1),children:(0,y.tZ)(Mn,{postInfo:E})})]});case"tasks":return(0,y.tZ)(At.B,{filteredTasks:w,tasks:x,showTaskProgress:k,displayCount:!0,filterNsort:C,actions:q,priorityOn:S,loading:M,barExtraComponent:S?(0,y.tZ)(b.JO,{icon:"report",href:{report:"TasksActivityReport",params:{range:"today",group:a.group_id}},toolTip:lng("open tasks activity report")}):void 0,showArchiveFilter:!0});case"patients_communication":return(0,y.tZ)(qi,{filteredItems:F,actions:[a.isGeneralManager()&&{icon:"by_mail",action:()=>a.createCommunication(),toolTip:lng("send message to patient")}]});case"schedule":return(0,y.tZ)(Dn.D,{ws:a});case"requirements":return(0,y.tZ)(un.TY,{workspaces:a.required_courses});case"welcome":return(0,y.tZ)(Hn,{ws:a});case"planning":return(0,y.tZ)(Xn,{ws:a})}return null};a.backTabsList.includes(T)?X=$(T):(L=T,X=$(N));const V="components"===T&&a.mayCreateComponent(),U=[a.mayCreateAssignments()&&{label:lng("assignment"),onClick:()=>(0,zt.vm)().openDialog("TypeSelector",(0,Cn.aA)({ws:a.group_id,unit:(0,v.B5)(a.active_unit_id)}))},a.mayCreateMeetings()&&{label:lng("meeting"),onClick:()=>(0,h.p4)({edit:"meeting",params:{ws:a.group_id,unit:(0,v.B5)(a.active_unit_id)}},!0)},a.mayShareContent()&&{label:lng("content"),onClick:()=>(0,h.p4)({edit:"share",params:{ws:a.group_id,unit:(0,v.B5)(a.active_unit_id)}},!0)},a.mayCreateMeetings()&&dr(a,["course","group","qualification","course_template"])&&{label:lng("import meetings from excel"),onClick:()=>(0,h.p4)({import:"meetings"},!0)},a.mayCreateEvents()&&{label:lng("new event"),onClick:()=>a.openEventForm()},a.mayCreateDiscussion()&&{label:lng("new discussion").caps(),onClick:()=>(0,h.p4)({edit:"discussion",params:{ws:o}},!0)},a.mayCreatePoll()&&{label:lng("new poll").caps(),onClick:D},a.mayCreatePost()&&{label:lng("new post").caps(),onClick:()=>(0,h.p4)({edit:"content",params:{type:"blog",blog_in_group:a.group_id}},!0)},a.mayCreateTask()&&{label:lng("new task"),onClick:()=>(0,h.p4)({edit:"task",params:{ws:o}},!0)}].filter((e=>e)),H=[V&&Blsm.isFeatureEnabled("learning_units")&&(0,v.B5)(a.group_id)&&0===a.unitIds.length&&{icon:"arrow_to_near",action:()=>a.showUnits=!a.showUnits,toolTip:lng("toggle learning units panel")},V&&{icon:"create",toolTip:lng("manage components"),action:()=>{const e=new Ji({assignments:a.assignments.filter((e=>"manual"!==e.attr("assignment_type"))).slice(),content:a.contents,group_id:a.group_id});(0,zt.vm)().openDialog("form",e)}},A&&U.length?U.length>1?{icon:"new",menu:U}:{icon:"new",toolTip:U[0].label,action:U[0].onClick}:null],J=p.width>600&&((null===(t=a.arrived_to_meetings)||void 0===t?void 0:t.total_meetings)||(null===(i=a.user_scores)||void 0===i?void 0:i.count_assignments)||(null===(r=a.tasks_stats)||void 0===r?void 0:r.resolutions)||(null===(s=a.user_scores)||void 0===s?void 0:s.c_completed));return(0,y.BX)(Et.T,{css:tr,bottomPadding:!0,contBG:!0,children:["Qualification"===a.group_type&&a.qual_list.length>1&&(0,y.tZ)(Ri,{ws:a}),(0,y.tZ)(vi.Fz,{children:(0,y.tZ)(cn,{id:o})}),(0,y.tZ)(Et.a,{children:J?(0,y.BX)(y.HY,{children:[(0,y.tZ)(Rt.SV,{children:(0,y.tZ)(Ut.bp,{ws:a})}),(0,y.tZ)(Rt.SV,{children:(0,y.tZ)(Wt,{ws:a})})]}):(0,y.tZ)(Rt.SV,{children:(0,y.tZ)(Ut.iR,{ws:a})})}),I.length>0&&(0,y.tZ)(Mt.W2,{fitWidth:!0,noBottomPadding:!0,head:(0,y.tZ)(hi.$Q,{tabs:(0,y.tZ)(ie.m,{tabs:I,activeTab:T,inContainerHead:!0,onSelect:e=>a.tab=e}),actions:H,extraComponent:a.canUploadFiles()&&(0,y.tZ)(jn.Ss,{onDrop:e=>a.onFileDrop(e),toolTip:lng("drag files here to add them as assignments or shared content")}),compactView:"compact"===a.componentsView,onViewSelect:"components"===a.tab?e=>a.componentsCompactView(e):void 0}),children:(0,y.tZ)(Rt.SV,{children:X})}),L?(0,y.tZ)(sr,{onClose:()=>a.tab=N,tab:L,ws:a}):void 0,(0,y.tZ)(gi.$,{})]})})),nr=(0,l.iv)("._head{display:flex;align-items:center;}.Icon-close{",c.g.classes.opposite_text_align,";color:",c.g.colors.text_sec,";cursor:pointer;}._grow{flex-grow:1;}>._title{font-size:1.3rem;color:",c.g.colors.text_main,";font-weight:700;}",""),rr={name:"6l0w94",styles:"display:flex;flex-direction:row;>*{margin:0 5px;}"},sr=(0,p.observer)((function(e){let{tab:t,onClose:i,ws:r}=e;const s=(0,n.useRef)(null),[o,a]=(0,n.useState)(null),l=e=>{(0,zt.vm)().openDialog("form",new Vn.y({files:e,share:r.group_id,my_content_in_group:r.group_id,onSaveSuccess:e=>r.addToMyContents(e.lessons)}))},c=[{icon:"new",menu:[{label:lng("text content"),href:(0,h.p4)({edit:"content",params:{type:"text",my_content_in_group:r.group_id}})},{label:lng("file content"),href:(0,h.p4)({edit:"content",params:{type:"file",my_content_in_group:r.group_id}})}]}],d=[{label:"#",name:"lesson_id",type:"text"},{label:lng("name"),name:"name",type:"text"},{label:lng("description"),name:"lesson_description",type:"text"},{label:lng("category").caps(),name:"category_name",type:"text"},{label:lng("content type").caps(),name:"lesson_type",type:"select_multi",options:[{val:"Text",label:lng("text")},{val:"File",label:lng("file")}]}],p=()=>s.current.close();return(0,y.tZ)(Ft.d,{scroll:!0,onClose:i,ref:s,refDrawerBody:a,from:"hierarchy"===t?"side":"bottom",children:(0,y.tZ)("div",{css:nr,children:(0,y.tZ)(Mt.W2,{head:(e=>{var t,i;const n=(0,y.tZ)(_.l,{theme:"contained",onClick:()=>history.back(),children:lng("go back").caps()});switch(e){case"members":return(0,y.tZ)(Mt.$0,{icon:"user",title:r.group_name?lng("members of %s|workspace",r.group_name):lng("members"),onClose:p,headExtra:(0,y.BX)("div",{css:rr,children:[r.sections.includes("waiting_list")&&r.waitingList&&r.waitingList.length>0&&(0,y.BX)(_.l,{theme:"contained",onClick:()=>r.tab="waiting_list",children:[lng("waiting list").caps()," (",r.waitingList.length,")"]}),r.sections.includes("registration")&&r.registeredUsers&&(null===(t=r.registeredUsers)||void 0===t?void 0:t.length)>0&&(0,y.BX)(_.l,{theme:"contained",onClick:()=>r.tab="registration",children:[lng("users in registration").caps()," (",null===(i=r.registeredUsers)||void 0===i?void 0:i.length,")"]})]})});case"managers":return(0,y.tZ)(Mt.$0,{icon:"manager",title:r.group_name?lng('managers of "%s"',r.group_name):lng("managers"),onClose:p,headExtra:r.mayEditSetting()?(0,y.tZ)("div",{css:rr,children:r.sections.includes("mailing_list")&&(0,y.tZ)(_.l,{theme:"contained",onClick:()=>r.tab="mailing_list",children:lng("mailing list").caps()})}):null});case"reports":return(0,y.tZ)(Mt.$0,{icon:"report",title:r.group_name?lng('reports of "%s"',r.group_name):lng("reports"),onClose:p});case"waiting_list":return(0,y.tZ)(Mt.$0,{icon:"waiting_list",title:r.group_name?lng('waiting list of "%s"',r.group_name):lng("waiting list"),onClose:p,headExtra:n});case"registration":return(0,y.tZ)(Mt.$0,{icon:"users",title:r.group_name?lng('users in registration to "%s"',r.group_name):lng("registration"),onClose:p,headExtra:n});case"hierarchy":return(0,y.tZ)(Mt.$0,{icon:"hierarchy",title:lng("hierarchy"),onClose:p});case"my_contents":return(0,y.tZ)(Mt.$0,{icon:"content",title:lng("my content"),onClose:p});case"mailing_list":return(0,y.tZ)(Mt.$0,{icon:"message",title:lng("mailing list"),onClose:p,headExtra:n});default:return null}})(t),stickyHead:!0,children:(e=>{switch(e){case"members":return!!r.members&&(0,y.tZ)(ui.PH,{collection:r.members,scrollParent:o,reload:()=>r.fetchMembers(),allowedUserFields:r.allowedUserFields,usersCustomFieldsNames:r.usersCustomFieldsNames,workspace:r});case"managers":return!!r.managers&&(0,y.tZ)(ui.J,{collection:r.managers,scrollParent:o,reload:()=>r.fetchManagers(),workspace:r});case"reports":return!!r.reports&&(0,y.tZ)(mi.uP,{reports:r.reports,reportsBundle:r.reportsBundle,group_id:r.group_id,workspace:r});case"registration":return(0,y.tZ)(ui.h3,{collection:r.registeredUsers,scrollParent:o,workspace:r});case"waiting_list":return!(!r.waiting_list_active||!r.waitingList)&&(0,y.tZ)(ui.v2,{collection:r.waitingList,scrollParent:o,allowedUserFields:r.allowedUserFields,workspace:r});case"hierarchy":return(0,y.tZ)(ar,{workspace:r,drawerEl:s});case"my_contents":return(0,y.tZ)($n.E,{collection:r.myContents,actions:c,filters:d,barExtraComponent:(0,y.tZ)(jn.Ss,{onDrop:l})});case"mailing_list":return(0,y.tZ)(ui.Z5,{scrollParent:o,workspace:r});default:return(0,y.tZ)(ge.$,{})}})(t)})})})}));var or={name:"1azpx8r",styles:"margin-bottom:20px"};const ar=(0,p.observer)((e=>{let{workspace:t}=e;const[i,r]=(0,n.useState)("");let s=t.group_type;"group"===s.toLowerCase()&&t.is_course&&(s="course");const{fetchHierarchy:o,availableRootGroups:a}=t,l=Blsm.isFeatureEnabled("group_subset")&&"Group"===t.group_type&&t.isGeneralManager(),c=(0,D.p)(t.group_type,t.is_course).caps(),d=a.filter((e=>e.id!==t.id)).length>0;return(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{css:or,children:(0,y.tZ)(Zt.I,{type:"search",onChange:r,value:i,label:lng("search"),wrapped:!0})}),(0,y.tZ)(Je.mp,{tree:t.hierarchy,filterText:i,onSelect:e=>(0,h.p4)({workspace:e},!0),idField:"id",nameField:"name",mayEdit:t.is_owner||l,activeId:t.id,buttons:(e,i)=>{var n;const r={icon:"edit",label:lng("edit workspace")+` (${c})`,onClick:()=>(0,h.p4)({edit:"workspace",id:e},!0)};var p;if("Subset"===i.type)return[(t.is_manager||t.is_owner||(null===(p=Blsm.user)||void 0===p?void 0:p.isPowerManager))&&{icon:"trash",label:lng("delete subset"),onClick:()=>(0,Ze.BB)(lng("are you sure that you want to delete this subset?").caps(),{onConfirm:()=>(0,C.SC)("groups/remove_sub_group",{method:"POST",data:{group_id:i.id}},(()=>o()))})},r];const u={label:lng("add subset"),onClick:t=>{t.stopPropagation(),(0,Ze.cS)(lng("insert subset name"),{title:lng("add new subset"),confirmText:lng("save"),onConfirm:t=>(0,C.SC)("groups/add_subset",{method:"POST",data:{group_name:t,parent_id:e}},(0,g.action)((()=>o())))})}};if(t.is_owner||null!==(n=Blsm.user)&&void 0!==n&&n.isPowerManager){return[{icon:"new",actions:[{label:lng("add new workspace")+` (${c})`,onClick:t=>{t.stopPropagation(),(0,h.p4)({edit:"workspace",params:{type:s.toLowerCase(),parent_id:e}},!0)}},d&&{label:lng("add existing workspace")+` (${c})`,onClick:t=>{t.stopPropagation(),(0,zt.vm)().openDialog("form",new Yi({parent_id:e,availableRootGroups:a,fetchHierarchy:o,typeName:c}))}},l&&u]},r]}return l?[{icon:"new",actions:[u]}]:[]}})]})})),lr=(0,l.iv)("width:100%;",c.g.classes.margin_far("1em"),";color:",c.g.colors.text_main,";._poster-outline{border-radius:20px;height:164px;width:164px;margin:-102px auto 0;box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);overflow:hidden;._poster{height:164px;width:164px;background-color:",c.g.colors.bg_1,";background-size:cover;background-position:center;}}._top{justify-content:space-between;align-items:flex-start;margin-bottom:10px;}",""),cr=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("workspace","personal"),{ready:t,group_name:i}=e;return(0,v.Ju)(i),t?(0,y.BX)(Et.T,{css:tr,bottomPadding:!0,contBG:!0,children:[(0,y.tZ)(vi.Fz,{}),(0,y.tZ)(Et.a,{children:(0,y.tZ)(Mt.W2,{css:lr,children:(0,y.tZ)(dt.c_,{className:"_top",children:(0,y.tZ)(Ut.p8,{ws:e})})})}),(0,y.tZ)(Mt.W2,{fitWidth:!0,noBottomPadding:!0,head:(0,y.tZ)(hi.$Q,{compactView:"compact"===e.componentsView,onViewSelect:"components"===e.tab?t=>e.componentsCompactView(t):void 0}),children:(0,y.tZ)(Rt.SV,{children:(0,y.tZ)(Tn,{ws:e})})}),(0,y.tZ)(gi.$,{})]}):(0,y.tZ)(bi.h,{})})),dr=(e,t)=>t.indexOf(e.is_course?"course":e.group_type.toLowerCase())>-1;var pr=i(4065);const ur=(0,p.observer)((function(e){let{onDialogClose:t}=e;const i=(0,n.useContext)(zt.l9).getStore("edit"),{loadingChunk:r,error:s,ready:o,formObj:a}=i;return r?(0,y.tZ)(bi.h,{}):s?(0,y.tZ)(Et.T,{children:s}):((0,v.Ju)(a.windowTitle),a.setOnClose(t),a.dialog||a.drawer?(0,y.tZ)(pr.m,{form:i.formObj,onClose:t,inDrawer:a.drawer}):!1===o?(0,y.tZ)(bi.h,{}):(0,y.tZ)(nt.l,{type:"page",form:a}))}));var mr=i(3389);const gr=(0,p.observer)((function(e){let{userStore:t}=e;const{roles:i,managed_ous:n,managed_groups:r}=t,s=n.concat(r);return(0,y.BX)(y.HY,{children:[s.length>0&&(0,y.tZ)(hr,{title:lng("workspaces"),collection:s}),i.length>0&&(0,y.tZ)(_r,{title:lng("roles"),collection:i})]})})),hr=(0,p.observer)((function(e){let{title:t,collection:i}=e;const n=[lng("workspace name"),lng("type"),lng("permission type"),`${lng("create")}\n(${lng("assignments")})`,`${lng("set weights")}\n(${lng("assignments")})`,`${lng("create")}\n(${lng("meetings")})`,`${lng("edit")}\n(${lng("meetings")})`,`${lng("set attendance")}\n(${lng("meetings")})`,`${lng("share")}\n${lng("content")}`,Blsm.isFeatureEnabled("evaluation")&&`${lng("view")}\n${lng("evaluations")}`,`${lng("grades management")}`,lng("members director"),lng("create portal"),lng("general")];return(0,y.BX)(y.HY,{children:[t&&(0,y.tZ)(Mt.uD,{children:t.caps()}),(0,y.tZ)(ye.iA,{cols:n,rowIdCol:"group_id",collection:i,RowRenderer:vr,compact:!0,noWindow:!0,mobileSupport:!0})]})})),br=(e,t,i,n)=>0<e&&e<=i&&!(n&&["perm_assignments|1","perm_assignments|2","perm_meetings|1"].includes(t+"|"+i)),vr=(0,p.observer)((function(e){let{row:t}=e;const{group_name:i,group_type:n,group_id:r,is_course:s,permission_name:o,perm_assignments:a,perm_meetings:l,perm_content:c,perm_evaluation:d,perm_grades_management:p,members_director:u,perm_portal:m,perm_config:g,template_guard:v}=t;let _=[{type:"main",_:(0,y.tZ)(h.A,{href:{workspace:r},children:i})},(0,D.p)(n,s),{_:o||(0,y.BX)("i",{children:["-",lng("custom").caps(),"-"]})},{type:"icons",_:br(a,"perm_assignments",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(a,"perm_assignments",2,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(l,"perm_meetings",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(l,"perm_meetings",2,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(l,"perm_meetings",3,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(c,"perm_content",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},Blsm.isFeatureEnabled("evaluation")&&{type:"icons",_:br(d,"perm_evaluation",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(p,"perm_grades_management",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(u,"members_director",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(m,"perm_portal",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})},{type:"icons",_:br(g,"perm_config",1,v)&&(0,y.tZ)(b.JO,{icon:"mark_v"})}];return(0,y.tZ)(ye.lF,{tds:_})})),_r=(0,p.observer)((function(e){let{title:t,collection:i}=e;const n=[lng("name"),lng("description"),lng("permissions")];return(0,y.BX)(y.HY,{children:[t&&(0,y.tZ)(Mt.uD,{children:t.caps()}),(0,y.tZ)(ye.iA,{cols:n,rowIdCol:"group_id",collection:i,RowRenderer:fr,compact:!0,noWindow:!0,mobileSupport:!0})]})})),fr=(0,p.observer)((function(e){let{row:t}=e;const{group_name:i,group_description:n,permissions:r}=t,s=[{type:"main",_:i},{type:"description",html:n},{_:r.map(((e,t)=>(0,y.tZ)("div",{children:e},t)))}];return(0,y.tZ)(ye.lF,{tds:s})}));const yr=(0,l.iv)("width:100%;transition:0.4s;",c.g.mQuery.mobile,"{padding:25px 0;}",""),wr=e=>{let{title:t,content:i,initialState:r=!0}=e;const[s,o]=(0,n.useState)(r);return(0,y.BX)("div",{css:yr,children:[(0,y.tZ)(Zr,{open:s,onClick:()=>o(!s),title:t.caps()}),s&&(0,y.tZ)(Sr,{open:s,children:i})]})},xr={name:"134wp3x",styles:"width:100%;cursor:pointer;display:flex;.title{font-size:1.3rem;font-weight:600;}"};var kr={name:"t10jb8",styles:"margin:5px"};const Zr=e=>{let{title:t,open:i,onClick:n}=e;return(0,y.BX)("div",{css:xr,onClick:n,className:"_title",children:[(0,y.tZ)("span",{className:"title",children:t}),(0,y.tZ)(b.JO,{css:kr,icon:"arrow_"+(i?"down":"up")})]})},Cr={name:"1qv38fn",styles:"padding:10px;max-height:100%"},Sr=e=>{let{children:t}=e;return(0,y.tZ)("div",{css:Cr,className:"_content",children:t})},Or=e=>(e=parseInt(e),isNaN(e)?"":(0,y.tZ)(ni.jC,{icon:"bookmark_filled",color:Tr(e,!1),children:e+""})),Br=e=>{if(!e)return null;const t=(0,ce._3)(e),i=(0,ce._3)((new Date).getTime());return(0,y.tZ)(ni.jC,{color:Tr((0,ce.GG)(i<t,!0)),children:(0,ce.GG)(t,{date:!0,time:!1})})},Tr=(e,t)=>t?e>=75?c.g.colors.positive:e>=50?c.g.colors.chart.waiting:"0"==e?c.g.colors.task.in_progress:c.g.colors.negative:c.g.colors[e?"positive":"negative"],Nr=(0,p.observer)((function(e){let{collection:t,isSelf:i,viewed_user_id:n,profLevel:r=!1,showComponents:s,showDependenciesOf:o,updateShowDependenciesOf:a,filterNsort:l,title:c}=e;const d=[],p=t.map((e=>parseInt(e.group_id)));t.forEach(((e,t)=>{var i;e.key=c+"_"+t,d.push(e),null===(i=e.dependencies)||void 0===i||i.forEach(((e,i)=>{p.includes(parseInt(e.group_id))||(e.key=c+"_"+t+"_"+i,d.push(e))}))}));const u=(0,kt.WB)(d,l.filter,l.sort),m=!!t[0].authorization_qualification,g=[lng("name"),lng(""),lng("classification"),lng("components",{phrase:!0}),r&&lng("professional level"),m?lng("authorized"):lng("status"),m?lng("authorized date"):lng("completed at"),m?lng("expiry date"):lng("due date"),lng("score"),!r&&lng("diploma"),i&&lng("actions")],h=s?u:u.filter((e=>!e.hidden_row||(0,v.B5)(o.group_id)&&(null==e?void 0:e.dependency_of)==o.group_id));return(0,y.tZ)(wr,{title:c,content:(0,y.tZ)(ye.iA,{cols:g,collection:h,RowRenderer:Ir,compact:!0,noWindow:!0,mobileSupport:!0,rowIdCol:"key",rowProps:{isSelf:i,viewed_user_id:n,profLevel:r,showComponents:s,showDependenciesOf:o,updateShowDependenciesOf:a,haveDependencies:e=>{var t;return(null==e||null===(t=e.dependencies)||void 0===t?void 0:t.length)>0||u.filter((t=>(null==t?void 0:t.dependency_of)==e.group_id)).length>0}}})})})),Ir=(0,p.observer)((function(e){let{row:t,rowProps:i}=e;return t.assignment_id?(0,y.tZ)(Pr,{row:t,rowProps:i}):t.dependency_of||t.dependency_type?(0,y.tZ)(jr,{row:t,rowProps:i}):(0,y.tZ)(Dr,{row:t,rowProps:i})})),Dr=e=>{let{row:t,rowProps:i}=e;const{isSelf:n,profLevel:r,showComponents:s,showDependenciesOf:o,updateShowDependenciesOf:a,haveDependencies:l}=i,{rds:d,user_id:p,group_id:u,c_completed:m,course_certificate:g,file_id:_,user_email:f,is_member:w,group_name:x,classification_name:k,c_performance_date:Z,calc_due_date:C,expired:S,repeat_type:O,c_performance_score:B,available:T,is_owner:N,level_name:I,level_value:D,expire_time:P,confirm_time:z,status_label:E,status_color:R,auth_status_color:F,auth_status_label:M}=t,A=Blsm.user.isPowerManager||(0,v.P$)(N),q=!!t.authorization_qualification,X="object"==typeof d;let L,$;q?(L=c.g.colors.reports[F],$=M):(L=c.g.colors.reports[R],$=E);const V="from_required_qualifications"!==O||C?O&&"none"!==O||!Z?Br(C):(0,ce.GG)(C,{date:!0,time:!1}):lng("according to required qualifications").caps(),U=null!==(null==d?void 0:d.done)?null==d?void 0:d.done:0,H=[{type:"main",_:(0,y.BX)(y.HY,{children:[X&&l(t)?(0,y.tZ)(b.JO,{icon:o.group_id===u||s?"arrow_down":"arrow_far",onClick:()=>a(t),buttonLike:!0}):"",w?"":(0,y.tZ)(b.JO,{icon:"menu_info",color:c.g.colors.warning,toolTip:lng("not a member")})," ",A?(0,y.tZ)(h.A,{href:{workspace:u},children:x}):x]})},{},k,{_:X?n?(0,y.tZ)(qt.k,{width:"75px",showPercent:!0,numerator:U,denominator:d.required,color:Tr(100*U/d.required),className:"_progress"}):(0,y.tZ)(h.A,{href:(0,h.p4)({report:"QualificationComponents",params:{user:p,qualification:u}}),children:(0,y.tZ)(qt.k,{width:"75px",numerator:U,denominator:d.required,color:c.g.colors.positive,className:"_progress"})}):(0,y.tZ)(b.JO,{icon:(0,v.P$)(m)?"mark_v":"mark_x",color:(0,v.P$)(m)?c.g.colors.positive:c.g.colors.negative})},r&&(0,j.h1)({level_name:I,level_value:D}),{_:(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.gT,{color:L||"gray"})," ",$||"not approved yet"," ",t.equivalent_qualification?(0,y.tZ)(b.JO,{icon:"asterisk",color:c.g.colors.warning,toolTip:lng("completed by equivalent qualification")+(t.equivalent_qualification_name?`: "${t.equivalent_qualification_name}"`:"")}):"","  "]})},{_:Z>0&&(0,y.tZ)(Ce.qp,{time:q?z:Z})},q?{_:P?Br(P):""}:{_:V},S||null===m?"":{_:Or(B)},!r&&{type:"icons",_:m&&(_||(0,v.B5)(g)||f&&(0,v.B5)(g))&&(0,y.BX)(y.HY,{children:[m&&(_||(0,v.B5)(g))&&(0,y.tZ)(b.JO,{color:c.g.colors.dominant_main,icon:"diploma",href:_?{file:{file_id:_}}:`ajax/requests.php?user=${p}&group=${u}&req=diploma`,newTab:!0,toolTip:lng("download diploma")}),m&&f&&(0,v.B5)(g)&&(0,y.tZ)(b.JO,{icon:"by_mail",href:`ajax/requests.php?user=${p}&group=${u}&req=diploma&target=mail`,newTab:!0,toolTip:lng("send diploma by mail")})]})},n&&{type:"icons",_:1===T&&(0,y.tZ)(h.A,{href:{workspace:u},children:(0,y.tZ)(b.JO,{icon:"go_arrow"})})}];return(0,y.tZ)(ye.lF,{tds:H})},jr=e=>{let{row:t,rowProps:i}=e;const{isSelf:n,profLevel:r,haveDependencies:s}=i,{rds:o,group_type:a,user_id:l,group_id:d,c_completed:p,course_certificate:u,file_id:m,user_email:g,is_member:_,group_name:f,classification_name:w,c_performance_date:x,calc_due_date:k,expired:Z,repeat_type:C,c_performance_score:S,available:O,is_owner:B,level_name:T,level_value:N,expire_time:I,confirm_time:P,status_label:z,status_color:E,auth_status_color:R,auth_status_label:F,is_course:M}=t,A="object"==typeof o,q=Blsm.user.isPowerManager||(0,v.P$)(B),X=!!t.authorization_qualification;let L,$;X?(L=c.g.colors.reports[R],$=F):A?(L=c.g.colors.reports[E],$=z):(L=(0,v.P$)(p)?c.g.colors.reports.green:c.g.colors.reports.yellow,$=(0,v.P$)(p)?lng("completed").caps():lng("not completed").caps());const V=null!==(null==o?void 0:o.done)?null==o?void 0:o.done:0,U="group"===(null==a?void 0:a.toLowerCase())&&M?"course":null==a?void 0:a.toLowerCase(),H=t.equivalent_qualification?(0,y.tZ)(b.JO,{icon:"asterisk",color:c.g.colors.warning,toolTip:lng("completed by equivalent qualification")+(t.equivalent_qualification_name?`: "${t.equivalent_qualification_name}"`:"")}):"",J="from_required_qualifications"!==C||k?C&&"none"!==C||!x?Br(k):(0,ce.GG)(k,{date:!0,time:!1}):lng("according to required qualifications").caps(),G=[{type:"main",indent:!A||A&&!s(t),_:(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.vB,{}),_||!A?"":(0,y.tZ)(b.JO,{icon:"menu_info",color:c.g.colors.warning,toolTip:lng("not a member")})," ",q?(0,y.tZ)(h.A,{href:{workspace:d},children:f}):f]})},{_:(0,y.tZ)(ni.jC,{color:c.g.colors.entity[U],children:(0,D.p)(U).caps()})},w,{_:A?n?(0,y.tZ)(qt.k,{width:"75px",showPercent:!0,numerator:V,denominator:o.required,color:Tr(100*V/o.required),className:"_progress"}):(0,y.tZ)(h.A,{href:(0,h.p4)({report:"QualificationComponents",params:{user:l,qualification:d}}),children:(0,y.tZ)(qt.k,{width:"75px",numerator:V,denominator:o.required,color:c.g.colors.positive,className:"_progress"})}):(0,y.tZ)(b.JO,{icon:(0,v.P$)(p)?"mark_v":"mark_x",color:(0,v.P$)(p)?c.g.colors.positive:c.g.colors.negative})},r&&(0,j.h1)({level_name:T,level_value:N}),{_:(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.gT,{color:L||"gray"})," ",$||"not approved yet"," ",H]})},{_:x>0&&(0,y.tZ)(Ce.qp,{time:X?P:x})},X?{_:I?Br(I):""}:{_:J},Z||null===p?"":{_:Or(S)},!r&&{type:"icons",_:p&&(m||(0,v.B5)(u)||g&&(0,v.B5)(u))&&(0,y.BX)(y.HY,{children:[p&&(m||(0,v.B5)(u))&&(0,y.tZ)(b.JO,{color:c.g.colors.dominant_main,icon:"diploma",href:m?{file:{file_id:m}}:`ajax/requests.php?user=${l}&group=${d}&req=diploma`,newTab:!0,toolTip:lng("download diploma")}),p&&g&&(0,v.B5)(u)&&(0,y.tZ)(b.JO,{icon:"by_mail",href:`ajax/requests.php?user=${l}&group=${d}&req=diploma&target=mail`,newTab:!0,toolTip:lng("send diploma by mail")})]})},n&&{type:"icons",_:1===O&&(0,y.tZ)(h.A,{href:{workspace:d},children:(0,y.tZ)(b.JO,{icon:"go_arrow"})})}];return(0,y.tZ)(ye.lF,{tds:G,style:{background:c.g.colors.separator}})},Pr=e=>{let{row:t,rowProps:i}=e;const{isSelf:n,viewed_user_id:r,profLevel:s}=i,{assignment_id:o,assignment_name:a,lesson_name:l,completed:d,last_success_date:p,managerun:u}=t,m=(0,v.P$)(d)?c.g.colors.reports.green:c.g.colors.reports.yellow,g=(0,v.P$)(d)?lng("completed").caps():lng("not completed").caps(),_=[{type:"main",indent:!0,_:(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.vB,{}),a||l]})},{_:(0,y.BX)("span",{children:[(0,y.tZ)(ni.jC,{color:c.g.colors.entity.assignment,text:lng("assignment").caps()}),(0,y.tZ)(b.JO,{icon:"report",toolTip:lng("performance report").caps(),buttonLike:!0,spaceBefore:!0,onClick:()=>(0,h.p4)({report:"ReportUserPerformances",params:{user:r,assignment:o}},!0)})]})},"",{_:(0,y.tZ)(b.JO,{icon:(0,v.P$)(d)?"mark_v":"mark_x",color:(0,v.P$)(d)?c.g.colors.positive:c.g.colors.negative})},s&&"",{_:(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.gT,{color:m||"gray"})," ",g||"missing"," "]})},{_:p>0&&(0,y.tZ)(Ce.qp,{time:p})},"","",!s&&"",n&&{type:"icons",_:!u&&(0,y.tZ)(b.JO,{icon:"play",href:{launcher:"assignment",id:o}})}];return(0,y.tZ)(ye.lF,{tds:_,style:{background:c.g.colors.separator}})},zr=(0,p.observer)((function(e){let{collection:t,manageGroups:i,filterNsort:n,removeUserWorkspace:r,title:s}=e;const o=t.some((e=>e.time_commitment)),a=t.some((e=>e.weekly_hours)),l=(0,kt.WB)(t,n.filter,n.sort),c=[lng("name"),lng("active"),lng("hours"),lng("start date"),lng("end date"),lng("completion date"),lng("attendance"),lng("score"),lng("completed"),lng("diploma"),o&&lng("time commitment"),a&&lng("weekly hours"),i&&lng("actions")];return(0,y.tZ)(wr,{title:s,content:(0,y.tZ)(ye.iA,{cols:c,rowIdCol:"group_id",collection:l,RowRenderer:Er,filterNsort:n,compact:!0,noWindow:!0,mobileSupport:!0,rowProps:{hasTimeCommitment:o,hasWeeklyHours:a,manageGroups:i,removeUserWorkspace:r}})})})),Er=(0,p.observer)((function(e){let{row:t,rowProps:i}=e;const{hasTimeCommitment:n,hasWeeklyHours:r,manageGroups:s,removeUserWorkspace:o}=i,{group_id:a,is_member:l,group_name:d,is_active:p,total_time:u,group_open_date:m,group_close_date:g,c_performance_date:_,c_completed:f,passed_meetings:w,total_meetings:x,arrived_to_meetings:k,c_performance_score:Z,diploma_link:C,diploma_file_ext:S,diploma_send:O,time_commitment:B,weekly_hours:T,is_course:N,is_owner:I}=t,D=Blsm.user.isPowerManager||(0,v.P$)(I),j=[{type:"main","data-group_id":a,_:(0,y.BX)(y.HY,{children:[!l&&(0,y.tZ)(b.JO,{icon:"menu_info",className:"warning",toolTip:lng("not a member")})," ",D?(0,y.tZ)(h.A,{href:{workspace:a},children:d}):d]})},{type:"icons",_:(0,v.P$)(p)?(0,y.tZ)(b.JO,{color:c.g.colors.positive,icon:"mark_v"}):(0,y.tZ)(b.JO,{color:c.g.colors.negative,icon:"mark_x"})},{_:u>0?(0,v.Rn)(u/3600):""},{_:m>0&&(0,y.tZ)(Ce.qp,{time:m})},{_:g>0?_<g?(0,ce.GG)(g,{date:!0,time:!1}):Br(g):""},{_:_>0&&(0,y.tZ)(Ce.qp,{time:_})},{_:x>0?(0,y.tZ)(qt.k,{width:"75px",showPercent:!0,numerator:k,denominator:x,color:Tr(100*k/x),className:"_progress"}):""},{className:(0,v.AK)({color_negative:"1"!=f}),_:null!==f&&Or(Z)},{type:"icons",_:(0,v.P$)(f)?(0,y.tZ)(b.JO,{icon:"mark_v",color:c.g.colors.positive}):"0"!=f||w?"":(0,y.tZ)(b.JO,{icon:"mark_x",color:c.g.colors.negative,toolTip:lng("not reached required attendance")})},{type:"icons",_:(C||O)&&(0,y.BX)(y.HY,{children:[C&&(0,y.tZ)(b.JO,{color:c.g.colors.dominant_main,icon:"diploma",href:C,toolTip:lng("download diploma"),"data-preview":S}),O&&(0,y.BX)(y.HY,{children:[" ",(0,y.tZ)(b.JO,{color:c.g.colors.dominant_main,icon:"by_mail",href:O,toolTip:lng("send diploma by mail to user")})]})]})},!!n&&(B&&(0,y.BX)(y.HY,{children:[B," ",((0,v.P$)(B)?lng("month"):lng("months")).caps()]})),!!r&&T,!!s&&{type:"icons",_:(0,y.tZ)(y.HY,{children:D&&!_&&(0,y.tZ)(b.JO,{icon:"mark_x",toolTip:(N?lng("remove from course"):lng("remove from group")).caps(),onClick:()=>o(t)})})}];return(0,y.tZ)(ye.lF,{tds:j})})),Rr=(0,p.observer)((function(e){let{userStore:t}=e;const{courses:i,groups:n,qualifications_roles:r,all_sub_professions:s,qualifications:o,isSelf:a,wsFilterNsort:l,wsShowComponents:c,showDependenciesOf:d,updateShowDependenciesOf:p,manageGroups:u,filteredCourses:m,removeUserWorkspace:g,user_id:h}=t,b=(0,v.v7)({all_sub_professions:s.length>0&&lng("professions"),qualifications_roles:r.length>0&&lng("qualification roles",{phrase:!0}),qualifications:o.length>0&&lng("qualifications",{phrase:!0}),courses:i.length>0&&lng("courses"),groups:n.length>0&&lng("other workspaces")},(e=>!!e));let _=[{name:"group_name",label:lng("name"),type:"text",outOfMenu:!0},{name:"group_id",label:"#",type:"text"}];const{filtersVals:f,setFilterVals:w}=(0,Z.qD)(l),x=l.filter.table?(0,v.v7)(b,((e,t)=>l.filter.table.includes(t))):b,k=(0,y.tZ)(hi.CX,{filters:_,filtersVals:f,onFilter:w,extraComponent:(0,y.tZ)(Zt.I,{type:"checkbox",value:c,onChange:e=>t.wsShowComponents=!!e,label:lng("show components").caps()}),alwaysShow:!0});return(0,y.BX)(y.HY,{children:[k,(0,y.BX)("div",{children:[x.all_sub_professions&&(0,y.tZ)(Nr,{title:b.all_sub_professions,collection:s,isSelf:a,showComponents:c,showDependenciesOf:d,filterNsort:l,updateShowDependenciesOf:p,profLevel:!0,viewed_user_id:h}),x.qualifications_roles&&(0,y.tZ)(Nr,{title:b.qualifications_roles,collection:r,isSelf:a,showComponents:c,showDependenciesOf:d,updateShowDependenciesOf:p,filterNsort:l,viewed_user_id:h}),x.qualifications&&(0,y.tZ)(Nr,{title:b.qualifications,collection:o,isSelf:a,showComponents:c,showDependenciesOf:d,updateShowDependenciesOf:p,filterNsort:l,viewed_user_id:h}),x.courses&&(0,y.tZ)(zr,{title:b.courses,collection:m||i,manageGroups:u,filterNsort:l,removeUserWorkspace:g}),x.groups&&(0,y.tZ)(zr,{title:b.groups,collection:n,manageGroups:u,filterNsort:l,removeUserWorkspace:g})]})]})}));const Fr=(0,p.observer)((function(e){let{userStore:t}=e;const{compliance_qualifications:i,compliance_courses:n,compliance_assignments:r,compliance_assignments_docs:s}=t;return(0,y.BX)(y.HY,{children:[i.length>0&&(0,y.tZ)(qr,{title:lng("compliance qualifications"),collection:i}),n.length>0&&(0,y.tZ)(qr,{title:lng("compliance courses"),collection:n}),r.length>0&&(0,y.tZ)(Lr,{title:lng("compliance assignments"),collection:r}),s.length>0&&(0,y.tZ)(Lr,{title:lng("procedure documents"),collection:s})]})})),Mr=(0,l.iv)("color:",c.g.colors.negative,";font-weight:bold;",""),Ar={name:"f2qx9q",styles:"max-width:300px;margin:10px 0"},qr=(0,p.observer)((function(e){let{title:t,collection:i}=e;const n=[lng("name"),lng("classification"),lng("completion date"),lng("completed"),lng("due date"),lng("diploma")];return(0,y.BX)(y.HY,{children:[t&&(0,y.tZ)(Mt.uD,{children:t.caps()}),(0,y.tZ)("div",{css:Ar,children:(0,y.tZ)(qt.k,{numerator:i.filter((e=>(0,v.P$)(e.c_completed))).length,denominator:i.length})}),(0,y.tZ)(ye.iA,{cols:n,rowIdCol:"group_id",collection:i,RowRenderer:Xr,compact:!0,noWindow:!0,mobileSupport:!0})]})})),Xr=(0,p.observer)((function(e){let{row:t}=e;const{group_name:i,course_certificate:n,classification_name:r,c_performance_date:s,c_completed:o,expired:a,next_due_date:l,file_id:c,user_id:d,group_id:p,user_email:u}=t,m=[{type:"main",_:i},r,s,{type:"icons",_:(0,y.tZ)(b.JO,{icon:o?"mark_v":"empty"})},{_:(0,y.tZ)(ut.u,{css:a?Mr:void 0,text:a?lng("expired"):void 0,children:l})},{type:"icons",icons:[o&&(c||(0,v.B5)(n))&&{icon:"diploma",href:c?{file:{file_id:c}}:`ajax/requests.php?user=${d}&group=${p}&req=diploma`,newTab:!0,toolTip:lng("download diploma")},o&&u&&(0,v.B5)(n)&&{icon:"by_mail",href:`ajax/requests.php?user=${d}&group=${p}&req=diploma&target=mail`,toolTip:lng("send diploma by mail")}]}];return(0,y.tZ)(ye.lF,{tds:m})})),Lr=(0,p.observer)((function(e){let{title:t,collection:i}=e;const n=[lng("name"),lng("completion date"),lng("completed"),lng("due date")];return(0,y.BX)(y.HY,{children:[t&&(0,y.tZ)(Mt.uD,{children:t.caps()}),(0,y.tZ)("div",{css:Ar,children:(0,y.tZ)(qt.k,{numerator:i.filter((e=>(0,v.P$)(e.completed))).length,denominator:i.length})}),(0,y.tZ)(ye.iA,{cols:n,rowIdCol:"assignment_id",collection:i,RowRenderer:$r,compact:!0,noWindow:!0,mobileSupport:!0})]})})),$r=(0,p.observer)((function(e){let{row:t}=e;const{assignment_name:i,last_success_date:n,completed:r,expired:s,next_due_date:o}=t,a=[{type:"main",_:i},n,{_:(0,y.tZ)(b.JO,{icon:(0,v.P$)(r)?"mark_v":"empty"})},{_:o&&(0,y.tZ)(ut.u,{css:s?Mr:void 0,text:s?lng("expired"):void 0,children:o})}];return(0,y.tZ)(ye.lF,{tds:a})})),Vr=(0,p.observer)((function(e){let{userStore:t}=e;const{evaluation:i,self_evaluation:n}=t;return(0,y.BX)(y.HY,{children:[i.length>0&&(0,y.tZ)(Ur,{title:lng("evaluation"),collection:i}),n.length>0&&(0,y.tZ)(Ur,{title:lng("self evaluation"),collection:n})]})})),Ur=(0,p.observer)((function(e){let{title:t,collection:i}=e;const n=[lng("name"),lng("date"),lng("ran by"),lng("report")];return(0,y.BX)(y.HY,{children:[t&&(0,y.tZ)(Mt.uD,{children:t.caps()}),(0,y.tZ)(ye.iA,{cols:n,rowIdCol:"performance_id",collection:i,RowRenderer:Hr,compact:!0,noWindow:!0,mobileSupport:!0})]})})),Hr=(0,p.observer)((function(e){let{row:t}=e;const{assignment_name:i,lesson_name:n,performance_date:r,may_access:s,performance_id:o,full_name:a,assignment_id:l,about_user:c,actual_user_id:d}=t,p=c||d;let u=[{type:"main",className:"list_table-main_cell",_:i||n},{_:r?(0,y.tZ)(Ce.qp,{time:r}):""},(0,v.v2)({full_name:a}),{type:"icons",_:[s&&(0,y.tZ)(R.x,{options:[{val:"",label:lng("performance report"),href:{report:"Performance",params:{performance_id:o}}},Blsm.isFeatureEnabled("reports")&&{val:"",label:lng("user question distribution"),href:{report:"UserQuestionDistribution",params:{assignment:l,user:p}}}],children:(0,y.tZ)(b.JO,{icon:"report"})})]}];return(0,y.tZ)(ye.lF,{tds:u})}));var Jr=i(9844),Gr=i(4525),Wr=i(7693);const Kr=(0,l.iv)(c.g.classes.margin_near(c.g.consts.CARDS_SPACING+"px"),";color:",c.g.colors.text_sec,";div._title{color:",c.g.colors.text_main,";font-weight:600;font-size:1.1em;margin-bottom:1em;}.EmptyMessage{margin-top:30px;}",c.g.mQuery.mobile,"{",c.g.classes.margin_near("0"),";margin-top:20px;}",""),Yr=(0,p.observer)((function(e){var t;let{userStore:i}=e;const n=(Blsm.isFeatureEnabled("assignments")||Blsm.isFeatureEnabled("meetings")||Blsm.isFeatureEnabled("competency"))&&(null===(t=i.assignments_stats)||void 0===t?void 0:t.total)>0,r=(i.rolesBadges.length||i.badges.length)>0;return(0,y.BX)("div",{css:Kr,children:[n&&(0,y.tZ)(es,{userStore:i}),r&&(0,y.tZ)(is,{userStore:i}),!n&&!r&&(0,y.tZ)(Wr.M,{title:lng("no extra details for now"),icon:"user"})]})})),Qr=(0,l.iv)("margin-bottom:1em;>div._charts{display:flex;flex-wrap:wrap;overflow-y:hidden;overflow-x:auto;flex-direction:initial;",c.g.mQuery.mobile,"{justify-content:center;}&>div{background-color:",c.g.colors.bg_cont,";border:1px solid ",c.g.colors.separator,";border-radius:",c.g.consts.WIDGET_BORDER_RADIUS,"px;width:225px;margin:0 .5em 1em;padding:10px 10px 30px;display:flex;flex-direction:column;>div:nth-child(1){flex-basis:3em;text-align:center;font-weight:600;}>div:nth-child(2){flex-grow:1;display:flex;justify-content:center;align-items:center;}}}",""),es=(0,p.observer)((function(e){let{userStore:t}=e;const{assignments_stats:i}=t,n=2+(i.meetings>0?1:0)+(Blsm.isFeatureEnabled("competency")?3:0),r=Math.min(150,720/n)+"px",s=t.id;return(0,y.BX)("div",{css:Qr,children:[(0,y.tZ)("div",{className:"_title",children:lng("status").caps()}),(0,y.BX)("div",{className:"_charts",children:[Blsm.isFeatureEnabled("assignments")&&(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{className:"pointer",onClick:()=>(0,h.p4)({report:"ReportUserStatus",params:{user:s}},!0),children:[(0,y.tZ)(ut.u,{text:lng("there may be differences between the information displayed on this screen and the report").caps(),children:(0,y.BX)("div",{children:[lng("assignment success").caps(),"*"]})}),(0,y.tZ)("div",{children:(0,y.tZ)(Gr.C,{color:c.g.colors.set[3],numerator:i.completed,denominator:i.total,size:r,valueSign:"%"})})]}),(0,y.BX)("div",{className:"pointer",onClick:()=>(0,h.p4)({report:"ReportUserStatus",params:{user:s}},!0),children:[(0,y.tZ)(ut.u,{text:lng("there may be differences between the information displayed on this screen and the report").caps(),children:(0,y.BX)("div",{children:[lng("assignment average score").caps(),"*"]})}),(0,y.tZ)("div",{children:(0,y.tZ)(Gr.C,{color:c.g.colors.set[8],percent:i.avg_score,size:r})})]})]}),Blsm.isFeatureEnabled("meetings")&&i.meetings>0&&(0,y.BX)("div",{children:[(0,y.tZ)("div",{children:lng("attendance").caps()}),(0,y.tZ)("div",{children:(0,y.tZ)(Gr.C,{color:c.g.colors.set[1],numerator:i.attended,denominator:i.meetings,size:r,valueSign:"%"})})]}),Blsm.isFeatureEnabled("competency")&&(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{children:[(0,y.tZ)("div",{children:lng("total competency").caps()}),(0,y.tZ)("div",{children:(0,y.tZ)(Gr.C,{color:c.g.colors.set[6],numerator:i.prof_completed,denominator:i.prof_total,size:r,valueSign:"%"})})]}),(0,y.BX)("div",{children:[(0,y.tZ)("div",{children:lng("compliance competency").caps()}),(0,y.tZ)("div",{children:(0,y.tZ)(Gr.C,{color:c.g.colors.set[2],numerator:i.prof_comp_completed,denominator:i.prof_comp_total,size:r,valueSign:"%"})})]}),(0,y.BX)("div",{children:[(0,y.tZ)("div",{children:lng("professional competency").caps()}),(0,y.tZ)("div",{children:(0,y.tZ)(Gr.C,{color:c.g.colors.set[9],numerator:i.prof_non_comp_completed,denominator:i.prof_non_comp_total,size:r,valueSign:"%"})})]})]})]})]})})),ts=(0,l.iv)(">div{>div._badges{display:flex;margin:0 20px;",c.g.mQuery.mobile,"{justify-content:center;}>div+div{",c.g.classes.margin_near("45px"),";}}}",""),is=(0,p.observer)((function(e){let{userStore:t}=e;const{badges:i,rolesBadges:n,basicDetails:r}=t,{rewards_total_points:s}=r;return(0,y.BX)("div",{css:ts,children:[n.length>0&&(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"_title",children:lng("qualification roles",{phrase:!0}).caps()}),(0,y.tZ)("div",{className:"_badges",children:n.map((e=>(0,y.tZ)("div",{children:(0,y.tZ)(_i.F$,{size:"100",ribbon:!0,color:1==e.c_completed?c.g.colors.set[e.color%c.g.colors.set.length]:c.g.colors.disabled_background,label:e.group_name})},e.group_id)))})]}),i.length>0&&(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"_title",children:`${lng("earned badges").caps()} (${s||0} ${lng("points")})`}),(0,y.tZ)("div",{className:"_badges",children:i.map((e=>(0,y.tZ)("div",{children:(0,y.tZ)(_i.Pp,{icon:e.icon,color:e.color,label:e.badge_name,description:e.badge_description,date:e.reward_time})},e.badge_id)))})]})]})}));var ns=i(2620);const rs=(0,p.observer)((function(e){let{userStore:t}=e;const{loginWithLocationData:i,disconnectSession:n}=t,r=[lng("device"),lng("origin ip"),lng("origin location"),lng("expiry"),""];return(0,y.tZ)(ye.iA,{cols:r,collection:i,RowRenderer:ss,compact:!0,noWindow:!0,mobileSupport:!0,rowProps:{disconnectSession:n}})})),ss=(0,p.observer)((function(e){let{row:t,rowProps:i}=e,{expiry:n,user_agent:r,ip:s,current_session:o,geoData:a}=t,{disconnectSession:l}=i;const c=[{type:"icons",_:(0,y.tZ)(ut.u,{text:r,children:(0,y.tZ)("span",{style:{cursor:"default"},children:"💻"})})},{type:"main",_:s},a?`${a.city}, ${a.country_name}`:"",{_:(0,y.tZ)(Ce.qp,{time:n})},{type:"icons",icons:[!o&&{icon:"exit",toolTip:lng("disconnect session"),onClick:()=>l(t)}]}];return(0,y.tZ)(ye.lF,{tds:c})}));function os(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class as extends m.I{constructor(e){super(e),os(this,"user_id",null);const{data:t={}}=e;this.user_id=t.user_id,this.title=lng("add a connected user").caps();this._fields=[{type:"select",name:"domain",label:lng("find users in this domain"),options:Blsm.user.domains_list},{type:"single_item",name:"connect_id",label:`${lng("find user").caps()} (${lng("empty")}:${lng("new")})`,searchData:(e,t)=>{(0,C.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",cross_domain:1,term:e.term,admins:"omit",choose_domain:this.values.get("domain")}},t)},searchDataCacheFunc:e=>(0,v.SZ)(Object.assign({domain:this.values.get("domain")},e))},{type:"checkbox",name:"is_power",label:lng("set as power user"),value:1}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("users/connect_multi_user",Object.assign({user_id:this.user_id},e))}}const ls=(0,p.observer)((function(e){let{userStore:t}=e;const{slaves:i,disconnectMultiUser:n,user_id:r}=t,s=["#",lng("user"),lng("domain"),""],o=[{icon:"new",action:()=>(0,zt.vm)().openDialog("form",new as({data:{user_id:r},onSaveSuccess:e=>((0,zt.vm)().closeDialog(),i.push(e))})),toolTip:lng("add a connected user")}];return(0,y.tZ)(ye.iA,{cols:s,rowIdCol:"user_id",collection:i,RowRenderer:cs,compact:!0,noWindow:!0,rowProps:{disconnectMultiUser:n},actions:o,mobileSupport:!0})})),cs=(0,p.observer)((function(e){let{row:t,rowProps:i}=e,{user_id:n,user_name:r,domain_name:s,can_remove:o}=t,{disconnectMultiUser:a}=i;const l=[n,{type:"main",_:(0,y.tZ)(h.A,{href:{user:n},newTab:!0,children:`${(0,v.v2)(t)} (${r})`})},s,{type:"icons",_:o?(0,y.tZ)(b.JO,{icon:"mark_x",toolTip:lng("remove"),onClick:()=>(0,Ze.BB)(lng("are you sure you want to disconnect this user?").caps(),{onConfirm:()=>a(t)})}):lng("auto by identity number").caps()}];return(0,y.tZ)(ye.lF,{tds:l})}));const ds=(0,l.iv)("overflow-y:auto;padding:15px;>*{margin:15px;}& ._detail_section{border-top:1px solid ",c.g.colors.separator_light,";padding-top:15px;}._avatar{display:flex;margin-top:20px;justify-content:center;>div{border:6px solid white;box-sizing:content-box;box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);border-radius:50%;}}._full_name,._org_unit,._contact{text-align:center;}._full_name{",c.g.classes.widget_title,";margin-top:13px;}._org_unit{a[href]{color:",c.g.colors.link_blue,";&:hover{color:",c.g.colors.link_blue_hover,";}}}._contact{margin-top:0.7em;}._deleted{color:",c.g.colors.warning,";text-align:center;}",c.g.mQuery.mobile,"{width:100%;}",""),ps=(0,p.observer)((e=>{let{userStore:t}=e;const{org_unit_id:i,org_unit_name:r,user_about:s}=t.basicDetails,{user_id:o,isSelf:a,direct_manager:l,userDetails:c,deleted:d,canEdit:p}=t,u=(0,n.useRef)(null);return(0,y.tZ)(Ft.d,{ref:u,from:"side",onClose:()=>t.basicDetailsWidgetSpread=!1,scroll:!0,children:(0,y.tZ)(Mt.W2,{head:(0,y.tZ)(Mt.$0,{title:lng("more information"),onClose:()=>u.current.close()}),stickyHead:!0,children:(0,y.BX)("div",{css:ds,children:[(0,y.tZ)("div",{className:"_avatar",children:(0,y.tZ)(mt.qE,{user:t.basicDetails,size:"152px",shadowed:!0,balloon:!1})}),(0,y.BX)("div",{className:"_full_name",children:[(0,v.v2)(t.basicDetails),d&&(0,y.BX)("span",{className:"_deleted",children:[" (",lng("deleted").caps(),")"]})]}),i&&(0,y.BX)("div",{className:"_org_unit",children:[(0,y.tZ)(h.A,{href:Blsm.user.isPowerManager?{edit:"workspace",id:i}:void 0,toolTip:lng("org' unit"),children:r}),l.user_id&&(0,y.BX)(y.HY,{children:[" (",(0,y.tZ)(ui.DL,{user:l,toolTip:lng("direct manager")}),")"]}),(Blsm.user.isPowerManager||a||p)&&(0,y.tZ)(b.JO,{icon:"history",smallButtonLike:!0,onClick:()=>{t.OUHistory||t.loadOUHistory(),(0,Ze.qR)((0,y.tZ)(bs,{store:t,OU:t.basicDetails.org_unit_id,currentOU:t.basicDetails.org_unit_name}),{title:lng("org' unit history"),width:"min(100vw, 800px)"})},toolTip:lng("view org' units history").caps()})]}),!a&&!d&&(0,y.BX)("div",{className:"_contact",children:[(0,y.tZ)(_.l,{theme:"contained",onClick:()=>(0,h.p4)({message:"new",params:{to:o}},!0),children:lng("message").caps()})," ",void 0!==window.bchat&&(0,y.tZ)(_.l,{theme:"outlined",onClick:()=>window.bchat.openChat(o),children:lng("chat").caps()})]}),(0,y.tZ)(gs,{details:c,user_about:s})]})})})})),us={name:"1jj7er4",styles:"padding:15px"},ms={name:"1v99fnz",styles:"padding:15px;white-space:pre-line"},gs=(0,p.observer)((e=>{let{details:t,user_about:i}=e;return(0,y.BX)(y.HY,{children:[(t||[]).map((e=>{let{label:t,fields:i}=e;return(0,y.tZ)(u.fM,{toggleTitle:t,toggle:!0,addMargin:!1,children:(0,y.tZ)("div",{css:us,children:(0,y.tZ)(ye.VD,{pairs:i})})},t)})),i&&(0,y.tZ)(u.fM,{toggleTitle:lng("about user"),toggle:!0,addMargin:!1,children:(0,y.tZ)("div",{css:ms,children:i})})]})})),hs=(0,l.iv)("._org_unit{a[href]{color:",c.g.colors.dominant_main,";}}",""),bs=(0,p.observer)((e=>{let{store:t}=e;const{OUHistory:i,basicDetails:n,direct_manager:r}=t,{org_unit_id:s,org_unit_name:o}=n,a=[{title:lng("org' unit").caps()},{title:lng("date").caps()},{title:lng("action").caps()},{title:lng("note").caps()}];return(0,y.BX)("div",{css:hs,children:[s&&(0,y.tZ)(Mt.uD,{children:(0,y.BX)("div",{className:"_org_unit",children:[lng("current org' unit").caps(),": ",(0,y.tZ)(h.A,{href:Blsm.user.isPowerManager?{edit:"workspace",id:s}:void 0,toolTip:lng("org' unit"),children:o}),r.user_id&&(0,y.BX)(y.HY,{children:[" (",(0,y.tZ)(ui.DL,{user:r,toolTip:lng("direct manager")}),")"]})]})}),(0,y.tZ)(ye.iA,{cols:a,collection:i,RowRenderer:vs})]})})),vs=e=>{let{row:t}=e;const{group_name:i,log_time:n,log_type:r,log_note:s}=t;return(0,y.BX)("tr",{children:[(0,y.tZ)(xe.U6,{children:i}),(0,y.tZ)("td",{children:(0,v.ey)(n)}),(0,y.tZ)("td",{children:"JOIN"===r?lng("joined"):"LEAVE"===r?lng("left|verb"):r}),(0,y.tZ)("td",{children:s||null})]})};var _s=i(4268);const fs=(0,l.iv)("position:relative;color:",c.g.colors.text_sec,";padding:20px 10px;>._children{display:flex;flex-direction:column;height:100%;}._avatar{display:flex;justify-content:center;>div{border:6px solid white;box-sizing:content-box;box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);border-radius:50%;}}._full_name,._org_unit,._contact{text-align:center;}._full_name{",c.g.classes.widget_title,";margin-top:13px;}._about_user{padding:10px;margin:10px;}._org_unit{a[href]{color:",c.g.colors.link_blue,";&:hover{color:",c.g.colors.link_blue_hover,";}}}._contact{margin-top:0.7em;}._deleted{color:",c.g.colors.warning,";text-align:center;}",c.g.mQuery.mobile,"{width:100%;}.RoundIconBatch{display:flex;justify-content:center;padding:30px 0 10px;flex-wrap:wrap;column-gap:11px;row-gap:11px;}",""),ys=(0,p.observer)((function(e){let{userStore:t}=e;const{org_unit_id:i,org_unit_name:n}=t.basicDetails,{user_id:r,isSelf:s,direct_manager:o,userDetails:a,deleted:l,actionIcons:d}=t;let p=[],u=[];return a.forEach((e=>{let{fields:t,id:i}=e;"monitor"===i?u.push(...t):p.push(...t)})),p=(0,v.KX)(p,4),u=(0,v.KX)(u,3),(0,y.BX)(gn.h,{css:fs,children:[(0,y.tZ)("div",{className:"_avatar",children:(0,y.tZ)(mt.qE,{user:t.basicDetails,size:"100px",shadowed:!0,balloon:!1})}),(0,y.BX)("div",{className:"_full_name",children:[(0,v.v2)(t.basicDetails),l&&(0,y.BX)("span",{className:"_deleted",children:[" (",lng("deleted").caps(),")"]})]}),i&&(0,y.BX)("div",{className:"_org_unit",children:[(0,y.tZ)(h.A,{href:Blsm.user.isPowerManager?{edit:"workspace",id:i}:void 0,toolTip:lng("org' unit"),children:n}),o.user_id&&(0,y.BX)(y.HY,{children:[" (",(0,y.tZ)(ui.DL,{user:o,toolTip:lng("direct manager")}),")"]})]}),!s&&!l&&(0,y.BX)("div",{className:"_contact",children:[(0,y.tZ)(_.l,{theme:"contained",onClick:()=>(0,h.p4)({message:"new",params:{to:r}},!0),children:lng("message").caps()})," ",void 0!==window.bchat&&(0,y.tZ)(_.l,{theme:"outlined",onClick:()=>window.bchat.openChat(r),children:lng("chat").caps()})]}),(0,y.tZ)(yi.bV,{icons:d,size:35,className:"action_icons"}),p.length>0&&(0,y.tZ)(ks,{profileFields:p[0]}),u.length>0&&(0,y.tZ)(ks,{profileFields:u[0]}),(0,y.tZ)(dt.c_,{style:{justifyContent:"center"},children:(0,y.tZ)(_.l,{theme:"outlined",onClick:()=>t.basicDetailsWidgetSpread=!0,style:{position:"relative",top:"5px",[c.g.near]:"5px"},children:lng("see all details").caps()+"..."})})]})})),ws=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:140;return(0,l.iv)("white-space:pre-line;max-height:",e,'px;transition:max-height 0.15s ease-out;overflow:hidden;position:relative;&:after{content:"";position:absolute;background-image:linear-gradient(to bottom, transparent, ',c.g.colors.bg_cont,");height:2em;bottom:0;left:0;right:0;}&._opened{height:auto;overflow:auto;max-height:unset;transition:max-height 0.25s ease-in;&:after{content:none;}}","")},xs=((0,p.observer)((e=>{let{user_about:t,maxHeight:i,mouse:r}=e;const[s,o]=(0,n.useState)(!1),{events:a}=(0,Z.Xf)(500,(()=>o(!0)),(()=>o(!1)));return(0,y.tZ)("div",{css:ws(i),className:(0,v.AK)({_opened:r&&s}),onMouseEnter:a.onMouseEnter,onMouseLeave:a.onMouseLeave,children:t})})),(0,l.iv)("margin-top:10px;padding:10px;border-top:1px solid ",c.g.colors.separator_light,";>div{margin-top:10px;>.label{font-size:0.8em;}>.value{color:",c.g.colors.text_main,";}}","")),ks=function(e){let{profileFields:t}=e;return(0,y.tZ)("div",{css:xs,children:t.map(((e,t)=>{let[i,n]=e;return(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"label",children:i.caps()}),(0,y.BX)("div",{className:"value",children:["string"==typeof n&&n,n.icon&&(0,y.tZ)(b.JO,{icon:n.icon})]})]},t)}))})},Zs=(0,p.observer)((function(e){let{title:t,collection:i}=e;const n=[lng("form name"),lng("date started"),lng("current approver"),lng("approval status")].map((e=>e.caps()));return(0,y.BX)(y.HY,{children:[t&&(0,y.tZ)(Mt.uD,{children:t.caps()}),(0,y.tZ)(ye.iA,{cols:n,rowIdCol:"performance_id",collection:i,RowRenderer:Cs,compact:!0,noWindow:!0,mobileSupport:!0})]})})),Cs=(0,p.observer)((function(e){let{row:t}=e,{lesson_name:i,performance_date:n,status:r}=t;const s=[{type:"main",_:i},{_:(0,y.tZ)(Ce.qp,{time:n})},(0,v.v2)(t),null==r?void 0:r.caps()];return(0,y.tZ)(ye.lF,{tds:s})}));var Ss=i(8621);const Os=(0,p.observer)((function(e){let{title:t,collection:i,store:n}=e;const r=[lng("name"),lng("required days"),lng("planned days"),lng("completed days"),lng("remaining days"),lng("member of group")],s=[{icon:"new",action:()=>(0,zt.vm)().openDialog("form",new Ss.Z({userMode:!0,user_id:n.user_id,onSaveSuccess:()=>{(0,zt.vm)().closeDialog(),n.fetch()}}))}];return(0,y.BX)(y.HY,{children:[t&&(0,y.tZ)(Mt.uD,{children:t.caps()}),(0,y.tZ)(ye.iA,{cols:r,actions:s,collection:i,RowRenderer:Bs,compact:!0,noWindow:!0})]})})),Bs=(0,p.observer)((function(e){let{row:t}=e,{group_name:i,required_days:n,planned_days:r,completed_days:s,remaining_days:o,member_of_group:a,first_date:l,user_id:d,group_id:p}=t;const u=[{type:"main",_:i},n,{style:{color:parseInt(r)>=parseInt(n)?c.g.colors.positive:c.g.colors.negative},_:r},s,o,{_:(0,y.BX)(y.HY,{children:["1"===a&&(0,y.tZ)(b.JO,{icon:"mark_v"})," ",(0,y.tZ)(Ce.qp,{time:l,showTime:!1})]})}];return(0,y.tZ)(ye.lF,{tds:u,onClick:()=>(0,zt.vm)().openDialog("form",new Ss.Z({userMode:!0,user_id:d,group_id:p,onSaveSuccess:()=>{(0,zt.vm)().closeDialog(),(0,zt.vm)().getStore("user",d).fetch()}}))})}));var Ts=i(7137),Ns=i(1612),Is=i(2645),Ds=i(5562),js=i(7477),Ps=i(5293);class zs extends m.I{constructor(e){var t;super(e);const i=e.approverData,n=null==i||null===(t=i.approver_options)||void 0===t?void 0:t.map((e=>({val:e.id,label:`[#${e.id}] ${e.label}`})));this.confirmButtonLabel=lng("register").caps(),this.title=e.group_name.caps(),this._fields=[{type:"hidden",name:"group_id",required:!0},{type:"hidden",name:"action",required:!0},{type:"textarea",name:"message",label:lng("you may enter additional text")},{type:"select",name:"chosen_approver_id",label:lng("you may choose the approver"),options:n,insert:(null==n?void 0:n.length)>0}],this._prepFields(e),this.ready=!0}save(e){this.saveToUrl("registration/action",e)}}var Es=i(2216);const Rs=(0,l.iv)(".close{color:",c.g.colors.text_sec,";}.title{font-size:1.3rem;color:",c.g.colors.text_main,";font-weight:700;margin-bottom:10px;}.select-instance{font-size:1.1em;color:",c.g.colors.text_main,";margin-bottom:10px;}.sub-title,.course-dependencies{font-size:1.2em;color:",c.g.colors.text_main,";margin:10px 0;font-weight:600;}.description{margin-top:16px;color:",c.g.colors.text_sec,";}.row{position:relative;display:flex;}.description-text{color:#92929D;}.register-btn{flex-grow:2;font-size:1.1em;}.showMore-btn{flex-grow:1;margin-inline-start:10px;}.course-field{margin:10px auto;}",""),Fs=(0,p.observer)((e=>{var t,i,r,s;let{onClose:o,info:a,activeTab:l}=e;const d=(0,n.useContext)(Is.wV),p=e=>{var t,i;if(d.anonymous){const t="login?hash=cregistration/"+e.group_id,i="register?domain="+e._attr.domain_id,n=Blsm.prm.registrable_domains.indexOf(e._attr.domain_id)>-1,r=()=>(0,h.p4)(t,!0),s=()=>(0,h.p4)(i,!0);return void(0,Ze.qR)((0,y.BX)("div",{children:[lng("to register to this course please").caps()," ",(0,y.tZ)(_.l,{theme:"outlined",onClick:r,children:lng("login")}),n&&(0,y.BX)("div",{children:[(0,y.tZ)("b",{children:lng("if you do not have a login, sign up").caps()})," ",(0,y.tZ)(_.l,{theme:"outlined",onClick:s,children:lng("register")})]})]}),{closeText:lng("close"),title:lng("you are not logged in!")})}let n=null;switch(e.statusInfo.action){case"join":n={text:lng('are you sure you want to join "%s"?',{phrase:!0,replace:e.group_name}),title:lng('you successfully joined "%s"',e.group_name).caps(),hrefTitle:lng("go to workspace").caps(),href:{workspace:e.group_id},color:c.g.colors.positive};break;case"join_waiting_list":n={text:lng('are you sure you want to join "%s" waiting list?',{phrase:!0,replace:e.group_name}),msg:lng("you joined the waiting list").caps()};break;case"leave":n={text:lng('are you sure you want to leave "%s"?',e.group_name),msg:lng('you left "%s"',e.group_name).caps()};break;case"leave_waiting_list":n={text:lng('are you sure you want to leave "%s" waiting list?',e.group_name),msg:lng("you left the waiting list").caps()};break;case"cancel_request":n={text:lng("are you sure you want to cancel the registration request?"),msg:lng("registration request canceled").caps()};break;case"register":null!==(t=d.options)&&void 0!==t&&null!==(i=t.general_options)&&void 0!==i&&i.disable_req_text?n={text:lng('are you sure you want to register to "%s"?',e.group_name),msg:lng("registration request sent and is waiting for approval").caps()}:(0,zt.vm)().openDialog("form",new zs({group_id:e.group_id,group_name:e.group_name,action:e.statusInfo.action,approverData:e.approver_data,onSaveSuccess:()=>{(0,zt.vm)().closeDialog(),(0,be.qV)(lng("registration request sent and is waiting for approval")),d.fetch()}}));break;case"manageMembers":d.setActive(e.group_id);break;case"buy":(0,C.SC)("registration/begin_paypal_purchase",{data:{id:e.group_id,type:"group",name:e.group_name},method:"POST"},(e=>(0,h.p4)(e.redirect_url,!0)))}n&&(0,Ze.BB)(n.text,{onConfirm:()=>(0,C.SC)("registration/action",{data:{group_id:e.group_id,action:e.statusInfo.action},method:"POST"},(()=>{d.fetch(),"join"===e.statusInfo.action?(0,Es.S)(n):(0,be.LB)(n)}))})},u=(0,n.useRef)(null),{menuOptions:m,statusInfo:g}=a,[v,f]=(0,n.useState)(null),w=a.typeName||(0,D.p)(null===(t=a._attr)||void 0===t?void 0:t.group_type,null===(i=a._attr)||void 0===i?void 0:i.is_course),x=a.isTemplate&&"reg_to_template"!==a.attr("registration_type")?lng("select course instance"):"manager"===a.tab?lng("manage your users in this %s|course",w):lng("apply for %s|course",w);return(0,y.tZ)(Ft.d,{size:"550px",from:"side",onClose:o,ref:u,scroll:!0,refDrawerBody:f,children:(0,y.tZ)(Mt.W2,{head:(0,y.tZ)(Mt.$0,{title:x,onClose:()=>u.current.close(),headExtra:(0,y.tZ)(ni.jC,{color:null===(r=a.statusInfo)||void 0===r?void 0:r.cardColor,children:null===(s=a.statusInfo)||void 0===s?void 0:s.selfText})}),stickyHead:!0,children:(0,y.BX)("div",{css:Rs,children:[(0,y.BX)("div",{className:"row",children:[(0,y.tZ)("span",{className:"title",children:a.title}),(0,y.tZ)(dt.zh,{}),a._attr.is_member&&a.isAvailable&&(0,y.tZ)(yi.ZT,{icon:"go_arrow",size:30,buttonLike:!0,toolTip:lng("go to workspace"),onClick:()=>(0,h.p4)({workspace:a.group_id},!0)}),m&&(0,y.tZ)(R.x,{className:"_menu",options:m,children:(0,y.tZ)(b.JO,{icon:"menu"})})]}),a.category&&(0,y.tZ)("span",{children:a.category}),"manager"!==l||a.registerNumbers.instances.length>0?(0,y.BX)("div",{children:[!a.haveInstances&&(0,y.tZ)("div",{className:"sub-title",children:lng("details").caps()}),(0,y.tZ)(Ds.RN,{courseInfo:a}),!a.haveInstances&&(0,y.tZ)(Ds.Td,{...a.registerNumbers}),a.haveInstances?a.registerNumbers.instances.map((e=>(0,y.tZ)(As,{instance:e,onSelectAction:p},e.group_id))):g&&(0,y.tZ)("div",{className:"row",children:(0,y.tZ)(_.l,{disabled:!g.action,className:`register-btn ${null==g?void 0:g.selfButtonClass}`,theme:"contained",onClick:()=>p(a),children:lng(g.selfButtonText).caps()})})]}):(0,y.tZ)("div",{children:(0,y.tZ)(Ds.RN,{courseInfo:a})}),"manager"===l&&!a.haveInstances&&(0,y.tZ)(Xs,{drawerBody:v,info:a})]})})})})),Ms=(0,l.iv)("border:1px solid ",c.g.colors.separator,";border-radius:7px;padding:17px 24px;margin-bottom:16px;font-size:14px;.title{font-size:18px;}.status-n-numbers{padding-top:10px;padding-right:16px;margin-top:11px;margin-bottom:23px;}",""),As=e=>{var t;let{instance:i,onSelectAction:r}=e;const{group_name:s,description:o,statusInfo:a,registerNumbers:l,activityDates:c,estimated_cost_for_member:d,registrationDates:p}=i,u=(0,v.s9)(o.text,70),[m,g]=(0,n.useState)(!1),h=m?lng("less information").caps():lng("more information").caps();return(0,y.BX)("div",{css:Ms,children:[(0,y.BX)("div",{className:"row",children:[(0,y.tZ)("span",{className:"title",children:s}),(0,y.tZ)(dt.zh,{})]}),o.text&&!m&&(0,y.tZ)("div",{className:"description-text",onClick:()=>g(!m),children:u}),c&&!m&&(0,y.tZ)(Ds.L0,{title:lng("activity dates"),className:"course-field",start:c.start,end:c.end}),"FUTURE_REGISTRATION"===(null==a?void 0:a.status)&&(0,y.tZ)(Ds.L0,{title:lng("registration dates"),className:"course-field",start:p.start,end:p.end}),d&&!m&&(0,y.BX)("div",{className:"course-field",children:[lng("estimated cost").caps(),": ",(0,y.tZ)("span",{className:"description-text",children:d})]}),m&&(0,y.tZ)(Ds.RN,{courseInfo:i}),(0,y.BX)("div",{className:"status-n-numbers row",children:["manager_register"!==i._attr.group_access&&(0,y.tZ)("div",{children:(0,y.tZ)(ni.jC,{color:null==a?void 0:a.cardColor,children:null==a?void 0:a.selfText})}),(0,y.tZ)(Ds.Jx,{inLine:!0,text:lng("members").caps(),number:l.members}),(0,y.tZ)(Ds.Jx,{inLine:!0,text:lng("remaining places").caps(),number:l.remainingPlaces})]}),(0,y.BX)("div",{className:"row",children:[a&&(0,y.tZ)(_.l,{className:"register-btn",disabled:!a.action,theme:"contained",onClick:()=>r(i),children:null==a||null===(t=a.selfButtonText)||void 0===t?void 0:t.caps()}),i.displayCourseFieldsBtn&&(0,y.tZ)(_.l,{className:"showMore-btn",theme:"outlined",onClick:()=>g(!m),children:h})]})]})},qs={name:"7mkb9f",styles:".addBtn,.removeBtn{display:block;margin:5px;}"},Xs=(0,p.observer)((e=>{let{info:t}=e;const i=(0,n.useContext)(Is.wV),{newMembers:r,addNewMembers:s,handleSelectNewMember:o,group_close_date:a,group_open_date:l,usersDrawerTabs:c}=i,{group_id:d}=t,[p,u]=(0,n.useState)("new");return 0===i.existingMembers.length&&0===i.waitingRequests.length&&i.fetchMembers(d),(0,y.BX)("div",{css:qs,children:[(0,y.tZ)(ie.m,{tabs:c,activeTab:p,onSelect:e=>u(e)}),"new"===p&&(0,y.tZ)(Js,{group_id:d,isMember:t._attr.is_member,handleSelectNewMember:o,otherUsers:{existing:i.existingMembers,waiting:i.waitingRequests},addNewMembers:s,newMembers:r,start:l,end:a}),["waiting","existing"].includes(p)&&(0,y.tZ)(Ls,{type:p,members:"waiting"===p?i.waitingRequests:i.existingMembers,group_id:d})]})})),Ls=(0,p.observer)((function(e){let{type:t,members:i,group_id:n,onRemoveMyself:r}=e;return(0,y.BX)(y.HY,{children:[(0,y.tZ)(ye.iA,{collection:i,RowRenderer:"new"===t?Vs:$s,rowIdCol:"user_id",rowProps:{removeNewUser:e=>{i.remove(e),e.user_id==Blsm.user.id&&r()}},noWindow:!0,showBar:!1}),"existing"===t&&i.length>0&&(0,y.tZ)(_.l,{className:"removeBtn",theme:"contained",onClick:()=>{const e=i.filter((e=>e._checked));0!==e.length&&(0,Ze.BB)(lng("are you sure you want to delete the selected members?"),{onConfirm:()=>{(0,C.SC)("registration/departmental_remove_members",{data:{members:e.map((e=>e.user_id)),workspace:n}},(()=>i.replace(i.filter((e=>!e._checked)))))}})},children:lng("remove selected members").caps()})]})})),$s=(0,p.observer)((function(e){let{row:t}=e;const{full_name:i,org_unit_name:n,isNew:r,addition_time:s,request_date:o,approver_name:a}=t;return(0,y.BX)("tr",{children:[(0,y.tZ)("td",{children:i}),(0,y.tZ)("td",{children:n}),(0,y.BX)("td",{children:[(0,y.tZ)(Ce.qp,{time:s})," ",r&&lng("new").caps()]}),(0,y.tZ)("td",{children:(0,y.tZ)(Ce.qp,{time:o})}),(0,y.tZ)("td",{children:a}),(s||r)&&(0,y.tZ)(xe.Fo,{o:t})]})})),Vs=(0,p.observer)((function(e){let{row:t,rowProps:i}=e;const{full_name:n,group_name:r,statusInfo:s,canJoin:o,result:a}=t,{removeNewUser:d}=i;return(0,y.BX)("tr",{children:[(0,y.tZ)("td",{children:(0,y.tZ)(b.JO,{icon:"close",buttonLike:!0,toolTip:lng("remove user"),onClick:()=>d(t)})}),(0,y.tZ)("td",{children:n}),(0,y.tZ)("td",{children:r}),(0,y.tZ)("td",{children:(0,y.tZ)(ni.jC,{color:o?c.g.colors.positive:c.g.colors.negative,children:s.departmental})}),(0,y.tZ)("td",{children:(0,y.tZ)("span",{css:(0,l.iv)({color:a.color},"",""),children:null==a?void 0:a.label})})]})}));var Us={name:"1h3l51g",styles:"justify-content:space-between;gap:10px;align-items:center"},Hs={name:"1r0yqr6",styles:"margin-top:10px"};const Js=(0,p.observer)((function(e){let{group_id:t,isMember:i,handleSelectNewMember:r,newMembers:s,addNewMembers:o,start:a,end:l,otherUsers:c}=e;const[d,p]=(0,n.useState)(""),[u,m]=(0,n.useState)(!1),[g,h]=(0,n.useState)(i),[b,f]=(0,n.useState)(!0),w=(0,n.useCallback)((0,v.pR)(((e,i)=>(0,C.SC)("registration/departmental_users_autocomplete/"+t,{data:{term:e,exclude:s.map((e=>e.user_id))}},(t=>(c.existing.concat(c.waiting).filter((t=>t.full_name.toLowerCase().includes(e.toLowerCase()))).forEach((e=>{e.label=e.full_name,e.description=e.org_unit_name&&`(${e.org_unit_name})`,t.find((t=>t.user_id==e.user_id))||t.unshift(e)})),i(t)))))),[]);return(0,y.BX)("div",{css:Hs,children:[(0,y.tZ)(Ds.L0,{title:lng("activity dates"),start:a,end:l}),(0,y.BX)(dt.c_,{css:Us,children:[(0,y.tZ)("div",{style:{flexGrow:1},children:(0,y.tZ)(Ps.n2,{label:lng("find your users"),filled:!!d,focused:u,children:(0,y.tZ)(js.Q,{showId:!0,getData:w,onTextChange:p,onSelect:r,onFocus:()=>m(!0),onBlur:()=>m(!1)})})}),b&&Blsm.isFeatureEnabled("manager_registration_self_add")&&!(null!=s&&s.find((e=>(0,v.Tz)(e.user_id))))&&(g?(0,y.tZ)(_.l,{theme:"outlined",onClick:()=>{(0,Ze.BB)(lng("are you sure you want to remove yourself as a member?"),{onConfirm:()=>{(0,C.SC)("registration/departmental_remove_members",{data:{members:[Blsm.user.id],workspace:t}},(()=>h(!1)))}})},style:{display:"inline-flex",alignItems:"center"},children:lng("remove myself").caps()}):(0,y.tZ)(_.l,{theme:"contained",onClick:()=>{(0,C.SC)("registration/get_status",{data:{user_id:Blsm.user.id,workspace_id:t}},(e=>{const t={user_id:Blsm.user.id,full_name:(0,v.v2)(Blsm.user),group_name:lng("myself").caps(),status:e,poster:Blsm.user.user_avatar};r(t)})),f(!1)},style:{display:"inline-flex",alignItems:"center"},children:lng("add myself").caps()}))]}),s&&(0,y.tZ)("div",{style:{maxHeight:"64vh",overflow:"auto"},children:(0,y.tZ)(Ls,{onRemoveMyself:()=>f(!0),type:"new",members:s,group_id:t})}),s.length>0&&(0,y.tZ)(_.l,{className:"addBtn",theme:"contained",onClick:o,children:lng("register selected users").caps()})]})}));var Gs=i(6704);const Ws=(0,n.lazy)((()=>Promise.all([i.e(866),i.e(287),i.e(94)]).then(i.bind(i,1112)).then((e=>({default:e.FullCalendarWrapperInner}))))),Ks=r().forwardRef(((e,t)=>(0,y.tZ)(n.Suspense,{fallback:(0,y.tZ)(ge.$,{}),children:(0,y.tZ)(Ws,{...e,ref:t})})));Ks.displayName="FullCalendarWrapper";var Ys=i(5690);const Qs={month:"dayGridMonth",week:"timeGridWeek",day:"timeGridDay"},eo=(0,p.observer)((function(){var e;const t=(0,n.useContext)(zt.l9).getStore("cregistration");(0,v.Ju)(lng("catalog",{phrase:!0}));const{ready:i}=t;if(!i)return(0,y.tZ)(bi.h,{});const{tabs:r,activeTab:s}=t;return(0,y.tZ)(Is.wV.Provider,{value:t,children:(0,y.BX)(Et.T,{contBG:!0,children:[(0,y.tZ)(vi.v7,{headline:lng("catalog",{phrase:!0}),noGradient:!0,banner:(null==t||null===(e=t.options)||void 0===e?void 0:e.catalog_page_poster)||"",tabs:{tabs:r,activeTab:s,onSelect:e=>t.activeTab=e},actions:Blsm.user.isPowerManager&&(0,y.tZ)(b.JO,{icon:"settings",toolTip:lng("courses management").caps(),href:{edit:"courses_management"},buttonLike:!0})}),(0,y.tZ)(no,{})]})})}));var to={name:"xo8qzt",styles:"font-weight:700;font-size:0.8em"},io={name:"6npg5x",styles:"position:relative;padding:10px;paddimg-top:24px;.relationSwitcher{font-weight:600;font-size:1.1rem;padding-bottom:10px;}"};const no=(0,p.observer)((function(){var e,t,i;const r=(0,n.useContext)(Is.wV),{filtersVals:s,setFilterVals:o,sort:a,setSort:l}=(0,Z.qD)(r.filters),c=(0,n.useRef)(null),[d,p]=(0,n.useState)(""),[u,m]=(0,n.useState)("month"),{activeTab:g,sections:h,groupInfo:b,view:_,searchTagRelation:f,setSearchTagRelation:w,getTags:x,selectedTags:k,toggleTagSelection:C,removeTag:S,clearTagSelection:O,digitalLibrary:B}=r,T=x(!0),N=x(),I=[{name:"group_name",label:lng("search by name"),type:"search",outOfMenu:!0,wrapped:!0},(null===(e=r.classifications)||void 0===e?void 0:e.length)>0&&{name:"classification_name",maxLabelLength:20,outOfMenu:!0,wrapped:!0,label:lng("classification"),options:[...(0,v.wd)(r.classifications)],type:"select_multi",showSearch:!0},(null===(t=r.statuses)||void 0===t?void 0:t.length)>0&&{name:"status",maxLabelLength:20,outOfMenu:!0,wrapped:!0,label:lng("status"),options:[...(0,v.wd)(r.statuses)],type:"select_multi"},(null===(i=r.tags)||void 0===i?void 0:i.length)>0&&{type:"select_multi",name:"tags",outOfMenu:!0,wrapped:!0,label:lng("tags"),emptyLabel:lng("select tags"),staticLabel:!0,showSearch:!0,options:[{optgroup:!0,label:lng("important tags").caps(),options:(0,v.wd)(T.map((e=>[e.tag,e.tag])))},{optgroup:!0,label:lng("other tags").caps(),options:(0,v.wd)(N.map((e=>[e.tag,e.tag])))}]},{name:"group_open_date",outOfMenu:!0,wrapped:!0,label:lng("from date"),type:"date"},{name:"group_close_date",outOfMenu:!0,wrapped:!0,label:lng("to date"),type:"date"},{name:"has_allocation",label:lng("allocated for my org' unit"),type:"checkbox"}],D=[{val:"",label:lng("default")},{val:"sorting_date",label:lng("open date")}],j=io,P=[{val:"AND",label:lng("all the tags")},{val:"OR",label:lng("one of the tags")}];return(0,y.BX)(_s.Q,{children:[(0,y.tZ)(hi.CX,{title:(0,y.tZ)("div",{css:to,children:lng("filters:").caps()}),filters:I,filtersVals:s,onFilter:e=>{C(null==e?void 0:e.tags),o(e)},sorts:D,sort:a,onSort:l,spreadFilters:!0,extraComponent:(0,y.tZ)(so,{}),alwaysShow:!0,zIndex:2}),(0,y.BX)("div",{css:j,className:"tags_wrapper",children:[k.size>1&&(0,y.tZ)("div",{className:"relationSwitcher",children:(0,y.tZ)(fi.T,{label:lng("show results using"),inline:!0,value:f,size:25,onChange:e=>w(e),options:P,inlineLabels:!0})}),(0,y.tZ)(pt.r$,{className:"canRemove",justify:!0,onClear:k.size>0?O:void 0,removableTags:!0,toggleShowMore:!0,children:T.map((e=>{let{tag:t,disabled:i}=e;return!i&&(0,y.tZ)(pt.Vp,{bright:!B,tag:t,active:k.has(t),onRemove:()=>S(t),bigger:!0},t)}))}),(0,y.tZ)(pt.r$,{justify:!0,onClear:0===T.length&&k.size>0?O:void 0,removableTags:!0,toggleShowMore:!0,children:N.map((e=>{let{tag:t,disabled:i}=e;return!i&&(0,y.tZ)(pt.Vp,{bright:!B,tag:t,active:k.has(t),onRemove:()=>S(t)},t)}))})]}),"calendar"!==_?"sorting_date"===a.by?(0,y.tZ)(uo,{regStore:r,activeTab:g,view:_}):(0,y.tZ)(ao,{sections:h,activeTab:g,compactView:"list"===_}):(0,y.BX)(y.HY,{children:[(0,y.tZ)("br",{}),(0,y.tZ)(po,{workspaces:r.extractSchedule(r.workspaces)}),(0,y.tZ)(Ys.A,{goPrev:()=>c.current.prev(),goNext:()=>c.current.next(),goToday:()=>c.current.today(),viewType:u,onChangeViewType:e=>(c.current.changeView(Qs[e]),m(e)),title:d}),(0,y.tZ)(Ks,{ref:c,noHeader:!0,height:"calc(100vh - 325px)",events:r.asEvents,eventClick:e=>r.setActive(e.event.ect_id?"e"+e.event.ect_id:e.event.group_id),viewType:Qs[u],onChange:e=>p(e.title)},g)]}),b&&!b.ect_id&&(0,y.tZ)(Fs,{info:b,activeTab:g,onClose:()=>r.setActive(null)}),b&&b.ect_id&&(0,y.tZ)(Gs.G,{createNew:!0,user_id:b.user_id,ect_id:b.ect_id,onClose:()=>r.setActive(null),manager_register:b.manager_register,ectName:b.group_name})]})})),ro=[{val:"tiles",label:lng("tiles"),icon:"view_tiles"},{val:"list",label:lng("list"),icon:"view_list"},{val:"calendar",label:lng("calendar"),icon:"calendar"}],so=(0,p.observer)((()=>{const e=(0,n.useContext)(Is.wV),t={};return t["margin"+c.g.near.caps()]="20px",(0,y.tZ)("div",{style:t,children:(0,y.tZ)(R.x,{options:ro,onSelect:t=>e.view=t,title:lng("display"),children:(0,y.tZ)(b.JO,{icon:{list:"view_list",calendar:"calendar",tiles:"view_tiles"}[e.view]})})})})),oo=(0,l.iv)(".no_courses{color:",c.g.colors.grey_1,";text-align:center;padding-top:60px;font-size:1.3em;text-transform:uppercase;}",""),ao=e=>{let{sections:t,activeTab:i,compactView:n}=e;const r=[];for(const e in t)switch(i){case"self":["external","available","pending","registered"].includes(e)&&r.push(t[e]);break;case"manager":["external","manager"].includes(e)&&r.push(t[e])}let s=0;return r.forEach((e=>{var t;return s+=(null==e||null===(t=e.courses)||void 0===t?void 0:t.length)||0})),(0,y.tZ)("div",{css:oo,children:s?r.map((e=>{let{classifications:t,courses:r,title:s}=e,o=[];return t&&(o=Object.keys(t).sort(((e,t)=>e.localeCompare(t,void 0,{sensitivity:"accent"}))),o.push(o.splice(o.indexOf("others"),1)[0])),0===(null==r?void 0:r.length)?null:(0,y.tZ)("div",{children:t?(0,y.BX)(y.HY,{children:[(0,y.tZ)(un.PQ,{mainTitle:!0,title:s,count:null==r?void 0:r.length}),o.map((e=>{var r;return(null===(r=t[e])||void 0===r?void 0:r.length)>0&&(0,y.tZ)(lo,{courses:t[e],activeTab:i,compactView:n,title:"others"===e?lng("other classifications").caps():e},e)}))]}):(0,y.tZ)(lo,{courses:r,activeTab:i,compactView:n,title:s})},s)})):(0,y.BX)("div",{className:"no_courses",children:[(0,y.tZ)(b.JO,{icon:"mng_courses"})," ",lng("no courses").caps()]})})},lo=e=>{let{courses:t,activeTab:i,compactView:n,title:r,useCarousel:s}=e;return(0,y.tZ)(un.TY,{useCarousel:void 0===s?!n:s,floatingControls:!0,workspaces:t,page:"registration",activeTab:i,title:r,count:null==t?void 0:t.length,mainTitle:!0,compactView:n})},co=(0,l.iv)("display:flex;margin-top:10px;margin-bottom:10px;>div{padding:0 10px;border-",c.g.near,":1px solid ",c.g.colors.border,";&:first-of-type{border-",c.g.near,":none;}}",""),po=e=>{let{workspaces:t}=e;const i=new Map;return t.forEach((e=>{var t;if(null===(t=e.statusInfo)||void 0===t||!t.cardColor)return;const n=i.has(e.statusInfo.cardColor)?i.get(e.statusInfo.cardColor):new Set;n.add(e.statusInfo.selfText),i.set(e.statusInfo.cardColor,n)})),0===i.size?null:(0,y.BX)("div",{css:co,children:[(0,y.BX)("span",{children:[lng("legend").caps(),": "]}),[...i.entries()].map((e=>(0,y.BX)("div",{children:[(0,y.tZ)(b.gT,{color:e[0],size:".7em"})," ",(0,y.tZ)("span",{children:[...e[1]].join(" / ")})]},e[0])))]})};function uo(e){let{activeTab:t,regStore:i,view:n}=e;return(0,y.BX)("div",{children:[(0,y.tZ)("br",{}),i.dateSorted.length>0&&(0,y.tZ)(lo,{courses:i.dateSorted,activeTab:t,compactView:"list"===n,useCarousel:!1}),i.dateSorted.length>0&&i.noDate.length>0&&(0,y.tZ)(un.PQ,{mainTitle:!0,title:lng("without dates"),count:0}),i.noDate.length>0&&(0,y.tZ)(lo,{courses:i.noDate,activeTab:t,compactView:"list"===n,useCarousel:!1})]})}var mo=i(6259),go=i(5151);const ho=(0,l.iv)("font-size:1rem;display:flex;align-items:center;>div{",c.g.classes.margin_far(".5em"),";}",""),bo=function(e){let{crumbs:t,onClick:i,idAttr:r="id",labelAttr:s="label"}=e;return(0,y.tZ)("div",{css:ho,className:"BreadCrumbs",children:t.map(((e,t)=>(0,y.BX)(n.Fragment,{children:[t>0&&(0,y.tZ)(b.JO,{icon:"arrow_far"}),(0,y.tZ)(we.zx,{onClick:()=>i(e[r]),theme:we.zy,children:e[s].caps()})]},e[r])))})};var vo=i(236);const _o=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("catalog");(0,v.Ju)(lng("catalog",{phrase:!0}));const{ready:t}=e;if(!t)return(0,y.tZ)(bi.h,{});const{haveMyContentPermission:i,mayDragFiles:r,onFileDrop:s}=e;return(0,y.tZ)(mo.s.Provider,{value:e,children:(0,y.BX)(Et.T,{internalScrolling:!0,children:[(0,y.tZ)(vi.v7,{headline:lng("knowledge center",{phrase:!0}),after_tabs:r()?(0,y.tZ)("div",{children:(0,y.tZ)(jn.Ss,{onDrop:e=>s(e),toolTip:lng("drag files here to add them as shared content")})}):void 0,actions:i()&&(0,y.tZ)(_.l,{theme:"contained",href:{list:"content"},className:"mobile_off",children:lng("my content").caps()})}),(0,y.tZ)(wo,{})]})})})),fo=(0,l.iv)("padding-top:4px;",c.g.mQuery.mobile,"{border-bottom:1px solid ",c.g.colors.separator,";transition:max-height .2s ease;max-height:700px;overflow:hidden;",c.g.classes.shadow_strong,";&:not(.expanded){max-height:73px;}}.tags_wrapper{position:relative;.TagsContainer{margin-top:10px;}}",""),yo=(0,l.iv)("height:100vh;.BreadCrumbs{margin-bottom:18px;}.title{font-size:1.3rem;font-variant-ligatures:no-contextual;font-weight:600;margin:16px 0 10px;}.cat_cards{margin-bottom:15px;>div.cat_card{border:1px solid ",c.g.colors.separator,";width:",c.g.consts.CARD_WIDTH,"px;border-radius:15px;padding:10px 15px;cursor:pointer;background-color:",c.g.colors.bg_cont,";}}",""),wo=(0,p.observer)((function(){const e=(0,n.useContext)(mo.s),{loading:t,content:i,filtersForm:r,tags:s,skills:o,selectedSkills:a,toggleSkillSelection:l,clearSkillsSelection:d,selectedTags:p,toggleTagSelection:g,clearTagSelection:h,tag_categories:_,contentCount:f,pageSize:w,curPage:x,subCategories:k,categoryBreadCrumbs:Z,setActiveContent:C}=e,S=(0,y.tZ)(gn.h,{className:(0,v.AK)({expanded:r.expanded}),css:fo,children:(0,y.BX)(m.q3.Provider,{value:r,children:[(0,y.tZ)(u.au,{input:r.fields}),(0,y.BX)("div",{className:"tags_wrapper",children:[(p.size>0||a.size>0)&&(0,y.tZ)(b.JO,{icon:"clear",toolTip:lng("clear|verb"),onClick:()=>(d(),h()),css:b.y$}),(0,y.tZ)(pt.r$,{justify:!0,title:lng("relevant tags"),children:s.map((e=>{let{tag_id:t,tag_name:i,times:n}=e;return(0,y.tZ)(pt.Vp,{tag:i,count:n,active:p.has(t),onClick:()=>g(t)},t)}))}),(0,y.tZ)(pt.r$,{justify:!0,title:lng("relevant skills"),children:o.map((e=>{let{sk_id:t,name:i}=e;return(0,y.tZ)(pt.Vp,{tag:i,active:a.has(t),onClick:()=>l(t)},t)}))}),_.map((e=>{let{tags_category_id:t,tag_category_name:i,tags:n}=e;return(0,y.tZ)(pt.r$,{justify:!0,title:i,children:n.map((e=>{let{tag_id:t,tag_name:i,times:n}=e;return(0,y.tZ)(pt.Vp,{tag:i,count:n,active:p.has(t),onClick:()=>g(t)},t)}))},t)}))]})]})});let O="";return null!=r&&r.getValue("cat")&&(k||null!=r&&r.getValue("term"))?null!=r&&r.getValue("term")&&(O=lng("maybe it's somewhere else")):O=lng("we looked really hard!"),(0,y.BX)(_s.Z,{side:S,css:yo,children:[(null==Z?void 0:Z.length)>0&&(0,y.tZ)(bo,{crumbs:Z,onClick:t=>e.setCategoryId(t)}),(null==k?void 0:k.length)>0&&!Blsm.isFeatureEnabled("hide_categories_in_knowledge_center")&&(0,y.BX)("div",{style:{overflow:"hidden"},children:[(0,y.tZ)("div",{className:"title",children:null!=r&&r.getValue("cat")?lng("sub categories").caps():lng("categories").caps()}),(0,y.tZ)(vo.Hl,{className:"cat_cards",vertSpacing:c.g.consts.CARDS_SPACING/2,children:null==k?void 0:k.map((t=>(0,y.BX)("div",{className:"cat_card",onClick:()=>e.setCategoryId(t.id),children:[(0,y.tZ)(b.JO,{icon:"vendor_master"})," ",t.label.caps()]},t.id)))})]}),t?(0,y.tZ)(ge.$,{}):(0,y.BX)(y.HY,{children:[i.length<1&&!(k&&(null==r||!r.getValue("term")))&&(0,y.tZ)(y.HY,{children:(0,y.tZ)(Wr.M,{title:lng("there is no content to display"),subTitle:O,icon:"digging",buttons:null!=r&&r.getValue("cat")&&null!=r&&r.getValue("term")?[{label:lng("check in all categories"),click:()=>null==r?void 0:r.updateValue("","cat")}]:null})}),i.length>0&&(0,y.BX)("div",{style:{overflow:"hidden"},children:[(0,y.tZ)("div",{className:"title",children:lng("content").caps()+" ("+f+")"}),(0,y.tZ)(Cn.Mz,{assignments:i,noFilterSort:!0,compactView:!1,onTitleClick:e=>C(e)}),(0,y.tZ)(go.t,{pageSize:w,totalItems:f,curPage:x||0,onChange:t=>e.curPage=t})]})]})]})}));var xo=i(8918),ko=i(7659),Zo=i(919),Co=i(4821);const So=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("library");(0,v.Ju)(lng("digital library",{phrase:!0}));const{tabs:t,activeTab:i}=e,r=e.tabStore(i);return(0,y.tZ)(Ns.W.Provider,{value:e,children:(0,y.BX)(Et.T,{children:[(0,y.tZ)(vi.v7,{headline:lng("digital library ",{phrase:!0}),tabs:{tabs:t,activeTab:i,onSelect:t=>e.activeTab=t}}),(e=>{switch(e){case"cregistration":return(0,y.tZ)(Oo,{cregistrationStore:r});case"catalog":return(0,y.tZ)(To,{catalogStore:r});case"ocontent":return(0,y.tZ)(Io,{onlineContentStore:r});case"channels":return(0,y.tZ)(Bo,{channelStore:r});default:return(0,y.tZ)(zo,{store:r})}})(i)||"",(null==r?void 0:r.sideMenu)&&(0,y.tZ)(Po,{store:r,onClose:()=>r.toggleSideMenu()})]})})})),Oo=(0,p.observer)((function(e){let{cregistrationStore:t}=e;if(!t.ready)return(0,y.tZ)(Et.T,{children:(0,y.tZ)(ge.$,{})});const{tabs:i,activeTab:n}=t;return(0,y.BX)(Is.wV.Provider,{value:t,children:[(0,y.tZ)(ie.m,{tabs:i,activeTab:n,onSelect:e=>t.activeTab=e,subTabs:!0}),(0,y.tZ)(no,{})]})})),Bo=(0,p.observer)((function(e){let{channelStore:t}=e;const{ready:i,channels:n,filterNsort:r,filtersArr:s,sortsArr:o}=t,{filtersVals:a,setFilterVals:l,sort:c,setSort:d}=(0,Z.qD)(r);return i?(0,y.BX)(_s.Q,{children:[(0,y.tZ)(hi.CX,{filters:s,filtersVals:a,onFilter:l,sorts:o,sort:c,onSort:d,spreadFilters:!0}),(0,y.BX)(Mt.W2,{children:[(0,y.tZ)(un.PQ,{title:lng("channels"),mainTitle:!0,count:n.length}),n&&(0,y.tZ)(vo.Hl,{children:null==n?void 0:n.map((e=>(0,y.tZ)(Ro,{data:e},e.channel_id)))})]})]}):(0,y.tZ)(Et.T,{children:(0,y.tZ)(ge.$,{})})})),To=(0,p.observer)((function(e){let{catalogStore:t}=e;return t.ready?(0,y.tZ)(mo.s.Provider,{value:t,children:(0,y.tZ)(wo,{})}):(0,y.tZ)(Et.T,{children:(0,y.tZ)(ge.$,{})})}));var No={name:"yijsf5",styles:"position:relative;.tagsSwitcher{font-weight:600;font-size:1.1rem;margin-bottom:10px;}"};const Io=(0,p.observer)((function(e){let{onlineContentStore:t}=e;const{content:i,filtersArr:n,filterNsort:r,followed_content:s,loading:o,selectedCategories:a,filter_skills:l,toggleCategoriesSelection:d,removeTag:p,clearTagSelection:u,categories:m,importantCategories:g}=t,{filtersVals:h,setFilterVals:b}=(0,Z.qD)(r),v=No,_=e=>{r.filter.filter_skills=e?r.filter.filter_skills.filter((t=>parseInt(t)!==parseInt(e.sk_id))):[],t.filter_skills.replace(e?t.filter_skills.filter((t=>parseInt(t.sk_id)!==parseInt(e.sk_id))):[]),t.updateNav()},f=[{val:"AND",label:lng("all the skills")},{val:"OR",label:lng("one of the skills")}];return t.ready?(0,y.BX)(_s.Q,{children:[(0,y.tZ)(hi.CX,{spreadFilters:!0,filters:n,filtersVals:h,onFilter:e=>{d(null==e?void 0:e.category),b(e)},minHeight:"70px"}),l&&(0,y.BX)("div",{className:"skills-filter",style:{display:"flex",flexDirection:"column",gap:"10px"},children:[l.length>1&&(0,y.tZ)(fi.T,{label:lng("show results using"),inline:!0,value:t.filterSkillsRelation,size:25,onChange:e=>(t.filterSkillsRelation=e,t.updateNav()),options:f,inlineLabels:!0}),(0,y.tZ)(pt.r$,{justify:!0,onClear:()=>_(),removableTags:!0,children:l.map((e=>(0,y.tZ)(pt.Vp,{tag:e.name,active:!0,onRemove:()=>_(e)},`${e.id}_${Math.random()}`)))})]}),((null==g?void 0:g.length)>0||(null==m?void 0:m.length)>0)&&(0,y.BX)("div",{css:v,children:[(0,y.tZ)(pt.r$,{justify:!0,onClear:a.size>0?u:void 0,removableTags:!0,toggleShowMore:!0,children:g.map((e=>{let{val:t}=e;return a.has(t)&&(0,y.tZ)(pt.Vp,{tag:t,active:!0,onRemove:()=>p(t),bigger:!0},t)}))}),(0,y.tZ)(pt.r$,{justify:!0,onClear:0===g.length&&a.size>0?u:void 0,removableTags:!0,toggleShowMore:!0,children:m.map((e=>{let{val:t}=e;return a.has(t)&&(0,y.tZ)(pt.Vp,{tag:t,active:!0,onRemove:()=>p(t)},t)}))})]}),s.length>0&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(un.PQ,{title:lng("pinned content"),mainTitle:!0,count:s.length}),(0,y.tZ)(vo.Hl,{children:s.map((e=>(0,y.tZ)(ni.xr,{entity:e,playLink:{onClick:()=>t.toggleSideMenu(e)},onTitleClick:()=>t.toggleSideMenu(e)},e.id)))})]}),(0,y.tZ)(un.PQ,{title:lng("online content"),mainTitle:!0,count:i.length,suffix:{color:c.g.colors.yellow,text:lng("displaying up to 30 random items, use the search bar to explore more online content").caps()}}),o?(0,y.tZ)(ge.$,{}):(0,y.tZ)(vo.Hl,{children:i.map((e=>(0,y.tZ)(ni.xr,{entity:e,playLink:{onClick:()=>t.toggleSideMenu(e)},onTitleClick:()=>t.toggleSideMenu(e)},e.id)))})]}):(0,y.tZ)(Et.T,{children:(0,y.tZ)(ge.$,{})})})),Do=e=>(0,l.iv)(".close{color:",c.g.colors.text_sec,";}.details{background-image:url(",e,");background-repeat:no-repeat;background-size:cover;background-position:top;min-height:250px;padding-top:1rem;display:flex;flex-direction:column;justify-content:space-between;.title{font-size:1.3rem;color:",c.g.colors.text_main,";font-weight:700;padding:10px;background:rgba(240, 240, 240, .85);}.note{margin:10px;}.link-btn{margin:0 auto;font-size:1.2rem;border-left:4px solid white;border-top:4px solid white;border-right:4px solid white;border-radius:10px 10px 0 0;background-color:white;a{border-radius:10px 10px 0 0;}}}.content{padding:0 1rem;.upper-note{color:",c.g.colors.text_sec,";display:flex;align-items:center;font-size:1.2rem;margin:6px 0;}.TagsContainer{padding-top:10px;}.description{margin:16px 0;color:",c.g.colors.text_main,";padding:5px;background:rgba(240, 240, 240, .6);border-radius:10px;}.sub-title{font-weight:600;font-size:1.1rem;}}","");var jo={name:"1otlq80",styles:"font-size:1.3rem"};const Po=(0,p.observer)((function(e){var t;let{onClose:i,store:r}=e;const s=(0,n.useRef)(null),o=r.currentContent;if(!o)return!1;const{group_id:a,title:l,icon:d,tags:p,description:u,category:m,link:g,following:h,image:v,completed:w,gradeInfo:x,status:k,bottomNote:Z,estimated_duration:C}=o,S=new G.pE({type:"group",object_id:a});return(0,y.tZ)(Ft.d,{from:"side",onClose:i,ref:s,scroll:!0,children:(0,y.tZ)(Mt.W2,{padded:!1,head:(0,y.tZ)(Mt.$0,{title:m,icon:d,onClose:()=>s.current.close(),headExtra:(0,y.tZ)(b.JO,{css:jo,iconClass:"pin-icon",buttonLike:!0,onClick:()=>o.togglePin(o),color:h?c.g.colors.dominant_main:void 0,icon:h?"pin_filled":"pin",toolTip:h?lng("unpin"):lng("pin")})}),stickyHead:!0,children:(0,y.BX)("div",{css:Do(v),children:[(0,y.BX)("div",{className:"details",children:[(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"title",children:l}),w&&(0,y.tZ)("div",{className:"note",children:(0,y.BX)(ni.jC,{title:x?x.label+": "+x.displayGrade:"",color:c.g.colors.positive,className:"mainNote",children:[(0,y.tZ)(b.JO,{icon:"mark_v_light"})," ",null==k||null===(t=k.text)||void 0===t?void 0:t.caps()]})})]}),(0,y.tZ)("div",{className:"link-btn",children:(0,y.BX)(_.l,{theme:"contained",href:g,children:[lng("enter").caps()," ",(0,y.tZ)(b.JO,{icon:"enter"})]})})]}),(0,y.BX)("div",{className:"content",children:[(Z||C)&&(0,y.BX)("div",{className:"upper-note",children:[Z&&(0,y.BX)("div",{className:"provider",children:[Z.text," "]})," ",Z&&C&&(0,y.tZ)("span",{children:" | "})," ",C&&(0,y.BX)("span",{className:"duration",children:[" ",(0,y.tZ)(b.JO,{icon:"sand_clock"})," ",C]})," "]}),p&&(0,y.tZ)(pt.r$,{children:null==p?void 0:p.map((e=>(0,y.tZ)(pt.Vp,{tag:e,smaller:!0},e)))}),null!=u&&u.isHtml?(0,y.tZ)(f.xn,{className:"description",content:null==u?void 0:u.text}):(0,y.tZ)("div",{className:"description",children:null==u?void 0:u.text}),Blsm.isFeatureEnabled("assignments_comments")&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"sub-title",children:lng("comments").caps()}),(0,y.tZ)(J.H,{locked:!1,commentsStore:S,deletable:!1,connectTo:{type:"online_content",object_id:a},refresh:!0,allowFileSharing:!0})]})]})]})})})})),zo=(0,p.observer)((e=>{let{store:t}=e;if(!t.ready)return(0,y.tZ)(Et.T,{children:(0,y.tZ)(ge.$,{})});const{popular:i,recent:r,skills:s,unfinished:o,bookmarked:a,followedOc:l,channels:c}=t,d=[{items:s,title:lng("recommended for you")},{items:i,title:lng("popular")},{items:r,title:lng("new")},{items:o,title:lng("in progress")},{items:a,title:lng("bookmarked")},{items:l,title:lng("pinned")},{items:c,title:lng("channels")}];return(0,y.tZ)(_s.Q,{children:d.map(((e,i)=>{const{items:r,title:s}=e;return(null==r?void 0:r.length)>0&&(0,y.BX)(n.Fragment,{children:[(0,y.tZ)(un.PQ,{title:s,mainTitle:!0,count:r.length}),(0,y.tZ)(pi.T,{floatingControls:!0,children:r.map(((e,i)=>(0,y.tZ)(Eo,{store:t,entity:e},i)))})]},i)}))})})),Eo=e=>{let{entity:t,store:i}=e;return t instanceof xo.N?(0,y.tZ)(un.gL,{entity:t,activeTab:"self",inContainer:!0}):t instanceof ko.m?(0,y.tZ)(Cn.Al,{assignment:t,inContainer:!0}):t instanceof Zo.O?(0,y.tZ)(ni.xr,{entity:t,playLink:{onClick:()=>i.toggleSideMenu(t)},onTitleClick:()=>i.toggleSideMenu(t)}):t instanceof Co.$?(0,y.tZ)(Ro,{data:t}):void 0},Ro=e=>{let{data:t}=e;const{channel_name:i,ownerId:n,ownerName:r,ownerAvatar:s,followersNum:o,playlistsNum:a}=t,l={user_id:n,full_name:r,user_avatar:s};return(0,y.BX)("div",{css:Fo,children:[(0,y.BX)("div",{className:"card-header",children:[(0,y.tZ)(mt.qE,{user:l,size:"40px"}),(0,y.tZ)("h3",{className:"channel-name",children:i}),(0,y.tZ)("span",{className:"channel-user",children:r})]}),(0,y.BX)("div",{className:"card-content",children:[(0,y.BX)("div",{className:"followers content-el",children:[(0,y.tZ)("span",{className:"title",children:lng("followers").caps()}),(0,y.tZ)("span",{children:o})]}),(0,y.BX)("div",{className:"playlists content-el",children:[(0,y.tZ)("span",{className:"title",children:lng("playlists").caps()}),(0,y.tZ)("span",{children:a})]})]}),(0,y.tZ)("div",{className:"card-bottom",children:(0,y.tZ)(_.l,{style:{width:"100%"},theme:"contained",href:{user:n,tab:"channel"},children:lng("visit channel").caps()})})]})},Fo=(0,l.iv)(ri.N,";width:250px;display:flex;flex-direction:column;margin:20px;padding:20px;justify-content:center;text-align:center;color:",c.g.colors.text_main,";border:1px solid ",c.g.colors.separator,";border-radius:8px;.card-header{display:flex;flex-direction:column;align-items:center;}.card-content{margin-top:30px;display:flex;justify-content:space-around;.content-el{display:flex;flex-direction:column;font-weight:600;>.title{margin-bottom:7px;font-weight:400;color:",c.g.colors.text_sec,";}}}.card-bottom{margin-top:20px;}","");var Mo=i(5761);var Ao={name:"bn94ig",styles:">div{height:100%;display:flex;flex-direction:column;justify-content:center;}"};const qo=(0,p.observer)((function(e){let{userStore:t}=e;const{skillsStore:i,isSelf:n,basicDetails:r,user_id:s}=t;if(!i.ready)return(0,y.tZ)(ge.$,{});if(i.skillStore)return(0,y.tZ)($o,{store:i});const{occupationSkills:o,additionalSkills:a,unrankedSkills:l,gainedSkills:c,filterNsort:d,leaderboard:p}=i,{user_first_name:u}=r,m=[{name:"name",label:lng("name").caps(),type:"search",outOfMenu:!0,wrapped:!0},{name:"skill_level",label:lng("level").caps(),type:"select_multi",options:[{val:0,label:"entry"},{val:1,label:"basic"},{val:2,label:"intermediate"},{val:3,label:"advanced"}]}],g=[{val:"",label:lng("default")},{val:"name",label:lng("name")},{val:"skill_level",label:lng("level")}];const h=n?lng("my skills"):lng("%s's skills",u),b=(null==o?void 0:o.length)+(null==a?void 0:a.length)>0,v=i.userOccupation,_=e=>{if(parseInt(s)===parseInt(Blsm.user.id))return[parseInt(s)===parseInt(Blsm.user.id)&&{label:lng("remove from skill list").caps(),val:e,onClick:()=>i.onRemoveSkill(e),icon:"trash"}]},f={user:lng("you dont have any documented skills right now.").caps(),other:lng("%s doesn't have any documented skills right now.",u)},w={user:lng("we have gathered all your skills in one place.").caps(),other:lng("we have gathered all of %s's skills in one place.",u).caps()},x={user:lng("wow!").caps()+" "+lng("you have such special skills!").caps(),other:lng("wow! %s have such special skills!",u).caps()};let k=n?f.user:f.other;b&&(k=(0,y.BX)(y.HY,{children:[n?w.user:w.other," ",(0,y.tZ)("br",{})," ",n?x.user:x.other]}));const Z=Ao;return(0,y.BX)("div",{children:[(0,y.tZ)(vi.Of,{headline:h,tagline:k,contentStyle:Z,content:v&&"loading"!==v&&(0,y.tZ)(Ts.BD,{occupation:v}),image:`${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/astronaut.svg`}),l.length>0&&(Blsm.user.isManager||Blsm.user.isPowerManager)&&(0,y.tZ)(Xo,{info:{message:lng("this user have %i unranked skills",l.length),icon:"warning_triangle"}}),b&&(0,y.tZ)(hi.CX,{filters:m,filtersVals:i.filterNsort.filter,onFilter:e=>i.filterNsort.filter=e,sorts:g,sort:i.filterNsort.sort,onSort:e=>{const t={...d.sort};t.desc=d.sort.by===e&&!d.sort.desc,t.by=e,d.sort=t},collection:i._skills}),o.length>0&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(un.PQ,{title:lng("occupation skills"),mainTitle:!0,count:o.length}),(0,y.tZ)(pi.T,{cardHeight:205,expandHeight:0,children:o.map((e=>(0,y.tZ)(Ts.rX,{onSetLevelClick:(e,t)=>i.setSkillLevel({user_id:s,sk_id:e,val:t}),onClick:()=>i.setCurrentSkill(e),showFlag:n,skill:e},`o_${e.sk_id}`)))})]}),(parseInt(s)===parseInt(Blsm.user.id)||a.length>0)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(un.PQ,{title:lng("personal skills"),mainTitle:!0,count:a.length}),(0,y.BX)(pi.T,{cardHeight:205,expandHeight:0,children:[parseInt(s)===parseInt(Blsm.user.id)&&(0,y.tZ)(Ts.ET,{user_id:s,store:i}),a.map((e=>(0,y.tZ)(Ts.rX,{onSetLevelClick:(e,t)=>i.setSkillLevel({user_id:s,sk_id:e,val:t}),onClick:()=>i.setCurrentSkill(e),onFlagClick:t=>i.setFollowing({sk_id:e.sk_id,following:t}),showFlag:!o.find((t=>t.sk_id===e.sk_id))&&n,actions:_(e.sk_id),user_id:s,skill:e},`a_${e.sk_id}`)))]})]}),c.length>0&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(un.PQ,{title:lng("skills i gained"),mainTitle:!0,count:c.length}),(0,y.tZ)(pi.T,{cardHeight:205,expandHeight:0,children:c.map((e=>(0,y.tZ)(Ts.rX,{onClick:()=>i.setCurrentSkill(e),skill:e},`g_${e.sk_id}`)))})]}),p.length>0&&(0,y.BX)("div",{className:"skill-leaderboard",children:[(0,y.tZ)("div",{className:"leaderboard-header",children:(0,y.tZ)(un.PQ,{title:lng("skill leaderboard"),mainTitle:!0})}),(0,y.tZ)(Yo,{leaderboard:p})]}),i.loaded&&i.onBoardingShowingNeeded&&((0,zt.vm)().openDialog("form",new Mo.ty({skillsStore:i,user_id:s,boarding:!0,onSave:(e,t)=>i.onAddSkill(e,t)}),{wizard:!0}),i.onBoardingShowingNeeded=!1)]})})),Xo=e=>{let{children:t,info:i={}}=e;const{message:n,icon:r}=i;return(0,y.BX)("div",{css:Lo,children:[(0,y.BX)("div",{className:"info",children:[r&&(0,y.tZ)(b.JO,{icon:r}),(0,y.tZ)("div",{className:"info-message",children:n.caps()})]}),(0,y.tZ)(dt.zh,{}),(0,y.tZ)("div",{children:t})]})},Lo=(0,l.iv)("border:1px solid ",c.g.colors.dominant_main,";background-color:",c.g.colors.dominant_main_shade,";display:flex;justify-content:space-between;height:auto;border-radius:10px;font-size:1.3rem;color:",c.g.colors.dominant_main,";align-items:center;padding:2%;margin-bottom:10px;.info{align-self:center;font-weight:700;.Icon{font-size:2rem;",c.g.classes.margin_far("10px"),";}.info-message{display:inline-block;}}",""),$o=(0,p.observer)((function(e){var t,i,n;let{store:r}=e;if(!r.skillStore.ready)return(0,y.tZ)(ge.$,{});const{skillStore:s,userStore:o,type:a}=r,{skill:l,leaderboard:d,skillLog:p,skillSuggestions:u,user_id:m}=s,{name:g,skill_level:h,manager_level:v,sk_id:_,editable:f,is_personal:w}=l,x="additional"===a?h:v||h,k=(0,Ts.r0)(x),Z=[1,2,3].map((e=>(0,Ts.r0)(e))),{label:C}=Z[x-1]||{color:"#757575",label:lng("unranked|level"),icon:"skill_unranked",val:null},S=!(!x||!d)&&(null===(t=d.find((e=>e.user_id==m)))||void 0===t?void 0:t.rank);return Z.forEach((e=>e.onClick=()=>{s.setSkillLevel({user_id:m,sk_id:_,val:e.val,is_personal:w});const t=Blsm.user;r._skills.forEach((i=>{i.sk_id==_&&((t.isPowerManager||t.isManager)&&(i.manager_level=e.val),t.id==m&&(i.skill_level=e.val))}))})),(0,y.BX)("div",{css:Vo((O=k.color,`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none">\n\t<rect height="100" width="100" fill="${O}"/>\n\t<ellipse cx="${c.g.isRTL?100:-10}" cy="-20" rx="45" ry="105" fill="#FFF" fill-opacity=".2"/>\n\t<ellipse cx="${c.g.isRTL?-15:115}" cy="100" rx="40" ry="70" fill="#FFF" fill-opacity=".2"/>\n</svg>`)),children:[null==x&&f&&(0,y.tZ)(Xo,{info:{message:lng("set the level of this skill"),icon:"warning_triangle"}}),(0,y.BX)("div",{className:"skill-header",children:[(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"back",onClick:()=>r.setCurrentSkill(!1)})," ",g.caps()]}),m&&f&&(0,y.BX)(R.x,{options:Z,className:"level",children:[(0,y.tZ)("span",{children:C.caps()})," ",(0,y.tZ)("span",{children:(0,y.tZ)(b.JO,{icon:"caret_down"})})]}),m&&!f&&(0,y.tZ)("div",{className:"level",children:C.caps()})]}),d.length>0&&(0,y.BX)("div",{className:"skill-leaderboard",children:[(0,y.BX)("div",{className:"leaderboard-header",onClick:()=>s.showLeaderboard=!s.showLeaderboard,children:[(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"leaderboard-title",children:(0,y.tZ)("span",{children:lng("skill leaderboard").caps()})}),S&&(0,y.BX)("div",{className:"leaderboard-sub-title",children:[o.isSelf?lng("your rank is").caps():`${o.basicDetails.user_first_name} ${o.basicDetails.user_last_name}`,": #",S]})]}),(0,y.tZ)(b.JO,{icon:s.showLeaderboard?"caret_up":"caret_down"})]}),s.showLeaderboard&&(0,y.tZ)("div",{className:"leaderboard-content",children:(0,y.tZ)(Uo,{leaderboard:d})})]}),o.isSelf&&(null===(i=s.skillLog)||void 0===i?void 0:i.length)>0&&(0,y.BX)("div",{className:"skill-log",children:[(0,y.tZ)(un.PQ,{title:lng("log"),mainTitle:!0,count:p.length}),(0,y.tZ)(pi.T,{floatingControls:!0,children:p.map(((e,t)=>(0,y.tZ)(Eo,{entity:e},t)))})]}),o.isSelf&&(null===(n=s.skillSuggestions)||void 0===n?void 0:n.length)>0&&(0,y.BX)("div",{className:"skill-suggestions",children:[(0,y.tZ)(un.PQ,{title:lng("suggestions"),mainTitle:!0,count:u.length}),(0,y.tZ)(pi.T,{floatingControls:!0,children:u.map(((e,t)=>(0,y.tZ)(Eo,{store:r,entity:e},t)))})]}),(null==r?void 0:r.sideMenu)&&(0,y.tZ)(Po,{store:r,onClose:()=>r.toggleSideMenu()})]});var O})),Vo=e=>(0,l.iv)(".skill-header{margin-top:15px;border-radius:10px;background-image:url('data:image/svg+xml;utf8,",encodeURIComponent(e),"');height:250px;color:white;padding:50px;font-size:2rem;font-weight:700;justify-content:space-between;.level{font-size:1rem;color:#fff;background-color:rgba(255, 255, 255, .3);border-radius:8px;padding:6px 10px;width:fit-content;&:hover{cursor:pointer;}}}.skill-leaderboard{display:flex;justify-content:space-between;padding:30px;margin-top:30px;box-shadow:-10px 0 13px -17px #000000,10px 0 13px -17px #000000,5px 5px 15px 5px rgba(0, 0, 0, 0);border-radius:10px;flex-direction:column;width:100%;.leaderboard-content{display:flex;flex-direction:row;width:100%;.leaderboard-table{width:300px;margin:10px;}}.leaderboard-header{display:flex;justify-content:space-between;.leaderboard-title{font-size:1.3rem;}.leaderboard-sub-title{color:",c.g.colors.text_sec,";margin-top:10px;}}}",""),Uo=(0,p.observer)((function(e){let{leaderboard:t}=e;const i=[{title:lng("name").caps()},{title:lng("level").caps()},{title:lng("rank").caps()}];return(0,y.tZ)("div",{css:Ho,children:(0,y.tZ)(ye.iA,{cols:i,collection:t,RowRenderer:Jo,rowIdCol:"user_id",compact:!0})})})),Ho={name:"1lmku8l",styles:"display:flex;margin-top:50px;flex-wrap:wrap;width:100%;.leaderboard-table{margin:10px 20px;th:nth-child(n+2){text-align:center;}.lb-table-header{font-size:1.2rem;color:white;border-radius:10px 10px 0 0;padding:5px 10px;display:flex;justify-content:space-between;}.td-rank{text-align:center;}.td-name span.name{vertical-align:super;}}"},Jo=(0,p.observer)((function(e){let{row:t}=e;const{skill_level:i,rank:n,full_name:r}=t,{label:s,color:o,icon:a}=(0,Ts.r0)(parseInt(i));return(0,y.BX)("tr",{css:Go(o),children:[(0,y.tZ)("td",{className:"td-name",children:(0,y.BX)("div",{children:[(0,y.tZ)(mt.qE,{user:t}),"  ",(0,y.tZ)("span",{className:"name",children:r})]})}),(0,y.tZ)("td",{children:(0,y.BX)("div",{className:"td-skill",children:[s.caps()," ",(0,y.tZ)(b.JO,{icon:a})]})}),(0,y.BX)("td",{className:"td-rank",children:["#",n]})]},n)})),Go=e=>(0,l.iv)("font-weight:600;.td-name{>div{display:flex;align-items:center;min-width:200px;}}.td-skill{display:flex;background-color:",e,";color:white;height:30px;justify-content:space-between;padding:0 10px;align-items:center;border-radius:50px;width:130px;.Icon{",c.g.classes.margin_near("10px"),";}}",""),Wo=e=>(0,l.iv)("display:flex;background-color:",e,";color:white;height:30px;justify-content:space-between;padding:0 10px;margin:10px 0;align-items:center;border-radius:50px;max-width:25%;width:auto;gap:10px;>div{>._btn{max-width:200px;}}.td-skill-name{display:block;max-width:85%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;",c.g.classes.margin_far("10px"),";}span{display:flex;justify-content:space-between;}",""),Ko=(0,l.iv)(".tooltip-score{border-top:1px solid ",c.g.colors.separator_light,";margin-top:10px;}.tooltip-title{margin-bottom:5px;font-size:1.2rem;font-weight:600;}",""),Yo=(0,p.observer)((function(e){let{leaderboard:t}=e;const i=[{title:""},{title:lng("name").caps()},{title:lng("skills").caps()}];return(0,y.tZ)("div",{css:Ho,children:(0,y.tZ)(ye.iA,{cols:i,collection:t,RowRenderer:Qo,rowIdCol:"user_id",compact:!0})})})),Qo=(0,p.observer)((function(e){let{row:t}=e;const{full_name:i,skills:n,rank:r}=t;return(0,y.BX)("tr",{css:Go,children:[(0,y.tZ)("td",{children:r}),(0,y.tZ)("td",{className:"td-name",children:(0,y.BX)("div",{children:[(0,y.tZ)(mt.qE,{user:t}),"  ",(0,y.tZ)("span",{className:"name",children:i})]})}),(0,y.tZ)("td",{style:{display:"flex",gap:"10px"},children:n.map((e=>{const{sk_id:t,manager_level:i,name:n,description:s,sk_rating_details:o}=e,{color:a,icon:l}=(0,Ts.r0)(i),c=JSON.parse(o),d=null!=c&&c.groups?Object.values(c.groups).reduce(((e,t)=>e+t),0):0,p=null!=c&&c.lessons?Object.values(c.lessons).reduce(((e,t)=>e+t),0):0;return(0,y.tZ)("div",{css:Wo(a),children:(0,y.BX)(ut.u,{html:(0,y.BX)("div",{css:Ko,className:"td-skill-inner",children:[(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"tooltip-title",children:n.caps()}),null==s?void 0:s.caps()]}),(0,y.BX)("div",{className:"tooltip-score",children:[lng("courses").caps(),": ",d,", ",lng("shared content").caps(),": ",p]})]}),children:[(0,y.tZ)("span",{className:"td-skill-name",children:n.caps()})," ",(0,y.tZ)(b.JO,{icon:l})]})},`${t}_${r}`)}))})]})}));var ea=i(6344);class ta extends m.I{constructor(e){var t;super(e),(0,g.makeObservable)(this),this.title=lng("invite friends"),this.challenge=e.currentChallenge,this.leaderboard=this.challenge.leaderboard,this.challengeId=e.currentChallenge.id,this.confirmButtonLabel=lng("invite").caps(),this.participants=null===(t=this.leaderboard)||void 0===t?void 0:t.map((e=>e.user_id)),this.buildFields()}buildFields(){this._fields=[{type:"hidden",name:"badge_id",value:this.challenge.id},{type:"component",Render:wi.R9,label:lng("only friends who meet the challenge conditions can be invited").caps(),bold:!0},{type:"multiple_items",name:"ids",label:lng("select users"),poster:!0,theme:"bright",searchData:(e,t)=>{let{term:i,ids:n}=e;const r=(this.values.get("ids")||[]).concat(this.inList||[],this.participants||[]);(0,C.SC)("gamification/autocomplete",{data:{req:"AutoComplete",term:i,id:n||"",exclude:r,challenge_id:this.challengeId}},t)},searchDataCacheFunc:e=>(0,v.SZ)(Object.assign({ids:(this.values.get("ids")||[]).concat(this.inList)},e))},{type:"richtext",name:"custom_message",label:`${lng("add message")} (${lng("optional")})`,toolbarOptions:{font:!0,color:!0,link:!0,list:!0,align:!0}}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("gamification/invite_to_challenge",{...e})}SaveSuccess(){(0,zt.vm)().closeDialog()}}const ia=(0,p.observer)((e=>{let{store:t}=e;const i=t||(0,n.useContext)(zt.l9).getStore("challenges");if(!i.ready)return(0,y.tZ)(bi.h,{});const r=(0,y.tZ)(na,{store:i});return null!=t&&t.user.id?(0,y.tZ)("div",{children:r}):(0,y.tZ)(Et.T,{children:r})})),na=(0,p.observer)((e=>{var t;let{store:i}=e;const{filterNsort:n,filters:r,sorts:s,sideMenu:o}=i,{filtersVals:a,setFilterVals:l,sort:c,setSort:d}=(0,Z.qD)(n),p=null===(t=i.user)||void 0===t?void 0:t.id;let u;return i.getCurrentChallenge&&i.toggleSideMenu(i.getCurrentChallenge),u=(0,v.Tz)(p)?(0,y.BX)("div",{children:[(0,y.tZ)(_.l,{href:{challenges:!0},theme:"outlined",children:lng("find new challenges").caps()}),(0,y.tZ)("br",{}),(0,y.tZ)("br",{}),(0,y.tZ)("br",{}),(0,y.tZ)("br",{}),lng("below, a list of the challenges you joined.").caps()]}):p?"":(0,y.BX)("div",{children:[(0,y.tZ)(_.l,{href:{user:Blsm.user.id,tab:"challenges"},theme:"outlined",children:lng("back to %s|back to some page",lng("my challenges")).caps()}),(0,y.tZ)("br",{}),(0,y.tZ)("br",{}),(0,y.tZ)("br",{}),(0,y.tZ)("br",{}),lng("join challenges to earn points and badges and maybe your name will be displayed on the wall of fame.").caps()]}),(0,y.BX)(y.HY,{children:[(0,y.tZ)(vi.Of,{headline:lng("challenges"),tagline:u,image:`${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/canoe.svg`,padding:!0}),(0,y.BX)(_s.Q,{children:[(0,y.tZ)(hi.CX,{filters:r,filtersVals:a,onFilter:l,sorts:s,sort:c,onSort:d,colelction:i.challenges}),0===i.challenges.length?(0,y.tZ)(Wr.M,{title:lng("no challenges to show"),icon:"challenge"}):(0,y.tZ)(vo.Hl,{children:i.challenges.map((e=>(0,y.tZ)(Rt.SV,{children:(0,y.tZ)(oa,{challenge:e,onChallengeClick:()=>i.toggleSideMenu(e)})},e.attr("badge_id"))))})]}),o&&(0,y.tZ)(ra,{onClose:()=>i.toggleSideMenu(!1),store:i})]})})),ra=(0,p.observer)((function(e){var t;let{store:i,onClose:r}=e;const s=(0,n.useRef)(null),{currentChallenge:o}=i;if(!o)return!1;const{color:a,icon:d,title:p,explain:u,dueDate:m,description:g,type:h,joined:v,leaderboard:f,progress:w}=o,x=null===(t=o._attr)||void 0===t?void 0:t.badge_conditions,k=null==x?void 0:x.cond_desc,Z=o._attr.badge_type,C=o._attr.badge_access,S=()=>o.invite();f&&(f.req="object"==typeof(null==x?void 0:x.ids)?null==x?void 0:x.ids.length:x.amount?x.amount:1);const O=(0,y.tZ)(Mt.$0,{title:p,onClose:r});return(0,y.tZ)(Ft.d,{onClose:r,from:"side",scroll:!0,ref:s,children:(0,y.tZ)("div",{children:(0,y.BX)(Mt.W2,{head:O,css:sa(a),children:[(0,y.tZ)("div",{className:"top-strip",children:(0,y.tZ)("div",{className:"badge",children:(0,y.tZ)(_i.Pp,{icon:d,color:a})})}),(0,y.BX)("div",{className:"header",children:[(0,y.BX)("div",{children:[p&&(0,y.tZ)("div",{className:"title",children:p.caps()}),h&&(0,y.tZ)("div",{className:"type",children:(0,y.tZ)("span",{children:h.caps()})})]}),(0,y.tZ)("div",{className:"explain",children:u.caps()}),(0,y.tZ)("div",{className:"condition-details",children:k&&k.map((e=>(0,y.BX)("div",{css:(0,l.iv)("color:",e.done?c.g.colors.green:"",";",""),children:[(0,y.BX)("div",{children:["(",e.id,") ",e.name]}),e.done&&(0,y.tZ)("span",{children:(0,y.tZ)(b.JO,{icon:"mark_v",color:c.g.colors.green})})]},e.id)))}),g&&(0,y.tZ)("div",{children:g.caps()}),h&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{children:v?(0,y.tZ)(ca,{progress:w,badgeType:Z}):(0,y.tZ)(_.l,{bold:!0,chunky:!0,theme:"contained",onClick:()=>o.join(),children:lng("join").caps()})}),(0,y.tZ)("div",{children:v&&(0,y.tZ)(_.l,{bold:!0,chunky:!0,theme:"contained",onClick:()=>(0,zt.vm)().openDialog("form",new ta({currentChallenge:o,onSave:S})),children:lng("invite friends").caps()})})]})]}),h&&(0,y.BX)(y.HY,{children:[m&&(0,y.tZ)("div",{className:"middle",children:(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"calendar"})," ",(0,y.tZ)(Ce.qp,{time:m,showTime:!1})]})}),f&&(0,y.tZ)(la,{list:f,type:Z}),(0,y.tZ)(dt.c_,{style:{justifyContent:"center",marginBottom:"10px"},children:v&&null!=w&&w.completed?(0,y.BX)("span",{className:"completed-success",children:[lng("challenge completed")," ",(0,y.tZ)(b.JO,{icon:d})]}):v&&"auto"!=C?(0,y.tZ)(_.l,{bold:!0,chunky:!0,theme:"outlined",onClick:()=>(0,Ze.BB)(lng("are you sure you want to leave the challenge?"),{onConfirm:()=>o.leave()}),children:lng("leave challenge").caps()}):null})]})]})})})})),sa=e=>(0,l.iv)(".top-strip{height:76px;background-color:",(0,ea.mR)(e,.3),";position:relative;display:flex;justify-content:center;.badge{position:absolute;top:20px;}}.header{height:auto;display:flex;flex-direction:column;align-items:center;justify-content:space-evenly;padding:10px 0;border-bottom:1px solid ",c.g.colors.border,";.explain{margin:12px auto;}.condition-details{display:flex;flex-direction:column;>div{display:flex;justify-content:space-between;padding:5px 10px;}.Icon{",c.g.classes.margin_near("15px"),";}}.title{font-size:1.7em;font-weight:600;text-align:center;margin-top:40px;}.type{margin-top:15px;text-align:center;span{",c.g.classes.content_type_style,";}}.Button{width:250px;}}.middle{padding:20px 0;display:flex;flex-direction:column;align-items:center;justify-content:space-evenly;border-bottom:1px solid ",c.g.colors.border,";color:",c.g.colors.text_sec,";}.completed-success{color:",c.g.colors.green,";border :4px solid ",c.g.colors.green,";font-weight:bold;font-size:1.5em;padding:.8em 1em;min-width:180px;text-align:center;}",""),oa=(0,p.observer)((e=>{let{challenge:t,onChallengeClick:i}=e;const{color:n,dueDate:r,explain:s,icon:o,title:a,id:d,type:p,joined:u,progress:m}=t;return(0,y.BX)("div",{css:(g=n,(0,l.iv)("position:relative;width:",c.g.consts.CARD_WIDTH,"px;min-width:",c.g.consts.CARD_WIDTH,"px;height:",c.g.consts.CARD_HEIGHT,"px;border-radius:18px;",c.g.classes.shadow_strong,";display:flex;flex-direction:column;justify-content:space-between;.top{border-radius:18px 18px 0 0;position:relative;height:",100,"px;background-color:",(0,ea.mR)(g,.3),";display:flex;justify-content:center;.badge{position:absolute;top:40px;}.edit{color:",c.g.colors.text_sec,";position:absolute;top:10px;",c.g.far,":10px;}}.middle{height:",c.g.consts.CARD_HEIGHT-100-60,"px;",c.g.classes.padding_near("10px"),";display:flex;flex-direction:column;justify-content:space-evenly;padding:50px 20px 0;color:",c.g.colors.text_sec,";.title{font-size:1.2em;font-weight:600;text-align:center;margin-bottom:10px;color:",c.g.colors.text_main,";}}&:hover .title{text-decoration:underline;}.bottom{height:",60,"px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:0 20px 20px;>div{width:100%;}}","")),children:[(0,y.BX)("div",{className:"top",children:[(0,y.tZ)("div",{className:"badge",children:(0,y.tZ)(_i.Pp,{icon:o,color:n})}),Blsm.user.isPowerManager&&(0,y.tZ)("div",{className:"edit",children:(0,y.tZ)(b.JO,{smallButtonLike:!0,icon:"edit",href:{edit:"challenge",id:d}})})]}),(0,y.BX)("div",{className:"middle",children:[(0,y.tZ)("div",{className:"title",onClick:i,children:a}),p&&(0,y.tZ)("div",{children:(0,y.tZ)("span",{css:c.g.classes.content_type_style,children:null==p?void 0:p.caps()})}),s&&(0,y.tZ)("div",{children:s.caps()}),r&&(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"calendar"})," ",(0,y.tZ)(Ce.qp,{time:r,showTime:!1})]})]}),p&&(0,y.tZ)("div",{className:"bottom",children:u?(0,y.tZ)(ca,{progress:m,badgeType:t._attr.badge_type}):(0,y.tZ)(_.l,{bold:!0,chunky:!0,theme:"contained",onClick:()=>t.join(),children:lng("join").caps()})})]});var g})),aa=(0,l.iv)("width:400px;margin:30px auto;.title{font-size:1.2em;font-weight:600;margin:10px 5px;}.columns{color:",c.g.colors.text_light_disabled,";>div:first-child{",c.g.classes.margin_near("40px"),";}}.leader{color:",c.g.colors.text_sec,";padding:7px 10px;border-bottom:1px solid ",c.g.colors.separator,";align-items:center;.number{padding:0 5px;width:30px;}.name{align-items:center;}}",""),la=e=>{let{list:t,type:i}=e;if(null==t||!t.length)return null;let n=null;const r={score:{types:["score_assignment","score_workspace"],term:lng("score").caps()},amount:{types:["social_like","social_comment","social_discussion","social_join_challenge","action_enroll","action_view_content"],term:lng("amount").caps()},points:{types:["points"],term:lng("points").caps()}};for(const e in r)r[e].types.includes(i)&&(n=r[e].term);return(0,y.BX)("div",{css:aa,children:[(0,y.tZ)("div",{className:"title",children:lng("challenge leaderboard").caps()}),(0,y.BX)(dt.c_,{className:"columns",children:[(0,y.tZ)("div",{children:lng("name").caps()}),(0,y.tZ)(dt.zh,{}),(0,y.tZ)("div",{children:n})]}),t.map(((e,i)=>(0,y.BX)(dt.c_,{className:"leader",children:[(0,y.tZ)("div",{className:"number",children:i+1}),(0,y.BX)(dt.c_,{className:"name",children:[(0,y.tZ)(mt.qE,{user:e}),"  ",(0,y.tZ)("span",{children:e.full_name})]}),(0,y.tZ)(dt.zh,{}),(0,y.BX)("div",{children:[e.score," ",t.req&&"/"+t.req]})]},i)))]})},ca=e=>{let{progress:t,badgeType:i}=e;if(!t)return(0,y.tZ)("div",{style:{color:c.g.colors.text_light_disabled},children:lng("no progress to show").caps()});if("string"==typeof t)return(0,y.tZ)("div",{style:{color:c.g.colors.text_sec},children:t});let{req:n,res:r,text:s}=t;const o="object"==typeof r?parseInt(r.count):r,a=o>n?n:o,l=["social_like","social_comment","social_discussion","social_join_challenge","action_view_point","points"].includes(i);return(0,y.BX)(y.HY,{children:[(0,y.tZ)("br",{}),(0,y.tZ)(qt.k,{numerator:a,denominator:n,showPercent:l}),(0,y.tZ)("div",{style:{color:c.g.colors.text_sec},children:s})]})},da=(0,p.observer)((function(e){let{store:t}=e;const{user:i,channelPlaylists:n,channelPlaylistsEmpty:r,filterNsort:s}=t;return n?(0,y.BX)(y.HY,{children:[n.length>0&&(0,y.tZ)(y.HY,{children:n.map(((e,n)=>{const{items:r,title:o,id:a,skills:l,status:c}=e,d=s.filter.playlistItems?r.filter((e=>e.title.includes(s.filter.playlist_items))):r;return(0,y.tZ)(ua,{items:d,status:c,title:o,id:a,skills:l,user:i,channelStore:t},n)}))}),i.isSelf&&(null==r?void 0:r.length)>0&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(un.PQ,{mainTitle:!0,title:lng("empty playlists"),count:r.length,className:"title"}),r.map(((e,n)=>{const{title:r,id:s}=e;return(0,y.tZ)(ua,{title:r,id:s,user:i,channelStore:t},n)}))]})]}):(0,y.tZ)(Wr.M,{title:lng("there is no content to display"),subTitle:lng("we looked really hard!"),icon:"digging"})})),pa=(0,l.iv)("margin:30px 0;.header-title{font-weight:600;>.title{display:inline-block;padding:10px 0;&.inactive span{text-decoration:line-through;}&:hover{cursor:pointer;}>span{font-size:1.2rem;color:",c.g.colors.text_main,";&.title-count{color:",c.g.colors.text_sec,";}}}&.hide-icons{.Icon{display:none;}&:hover{.Icon{display:inline-block;}}}}.header-cont{display:flex;justify-content:space-between;flex-direction:column;margin-bottom:10px;}",""),ua=function(e){let{items:t,title:i,id:n,skills:r,user:s,status:o,channelStore:a}=e;return(0,y.BX)("div",{css:pa,children:[(0,y.BX)("div",{className:"playlist-header",children:[(0,y.BX)("div",{className:(0,v.AK)("header-title",{"hide-icons":t}),children:[(0,y.BX)("div",{className:(0,v.AK)("title",{inactive:!o}),children:[(0,y.tZ)("span",{onClick:()=>(0,h.p4)((null==t?void 0:t[0].playLink)||{playlist:n},!0),children:null==i?void 0:i.caps()})," ",(0,y.BX)("span",{className:"title-count",children:["(",(null==t?void 0:t.length)||lng("empty").caps(),")"]})]}),s.isSelf&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.JO,{icon:"edit",smallButtonLike:!0,onClick:()=>(0,h.p4)({playlist:n,play:"edit"},!0)}),(0,y.tZ)(b.JO,{icon:"trash",smallButtonLike:!0,onClick:()=>(0,Ze.BB)(lng("are you sure you want to delete this playlist?").caps(),{title:lng("delete playlist"),confirmText:lng("delete").caps(),onConfirm:()=>(0,C.SC)("channel/delete_playlist",{method:"POST",data:{id:n}},(()=>a.removePlaylist(n)))})})]})]}),(0,y.tZ)("div",{className:"header-cont",children:(null==r?void 0:r.length)>0&&(0,y.tZ)(pt.r$,{children:r.map((e=>(0,y.tZ)(pt.Vp,{tag:e.label,color:(0,Ts.r0)(e.skill_level).color,smaller:!0,tooltip:e.description},e.id)))})})]}),t&&(0,y.tZ)(pi.T,{floatingControls:!0,css:(0,l.iv)(c.g.classes.margin_near("1rem;"),";",""),children:t.map((e=>(e.playLink={play:e.assignment_id,playlist:n},(0,y.tZ)(Cn.Al,{assignment:e},e.assignment_id))))})]})};var ma={name:"1d3w5wq",styles:"width:100%"};const ga=(0,p.observer)((e=>{let{store:t}=e;const i=t.channelStore||(0,n.useContext)(zt.l9).getStore("channel"),{channel:r,ready:s,user:o,bottomMenu:a}=i,{filtersVals:l,setFilterVals:c,sort:d,setSort:p}=(0,Z.qD)(i.filterNsort);if(!s)return(0,y.tZ)(bi.h,{});const u=[{name:"playlist_name",label:lng("playlist name").caps(),type:"search",outOfMenu:!0,wrapped:!0},{name:"playlist_items",label:lng("item name").caps(),type:"search",outOfMenu:!0,wrapped:!0},{name:"playlist_skills",label:lng("skills"),type:"search",outOfMenu:!0,wrapped:!0},{name:"playlist_id",label:lng("ID").caps(),type:"search"}],m=[{val:"",label:lng("default")},{val:"playlist_name",label:lng("name")},{val:"playlist_id",label:lng("ID")}];return(0,y.BX)("div",{children:[(0,y.tZ)(vi.Of,{content:(0,y.tZ)(va,{channelStore:i,channel:r,onFullListClick:()=>i.toggleBottomMenu(),user:o}),contentStyle:ma}),(0,y.tZ)(hi.CX,{filters:u,filtersVals:l,onFilter:c,sorts:m,spreadFilters:!0,sort:d,onSort:p}),(0,y.tZ)(da,{store:i}),a&&(0,y.tZ)(ha,{onClose:()=>i.toggleBottomMenu(),channel:r})]})})),ha=(0,p.observer)((function(e){let{channel:t,onClose:i}=e;const r=(0,n.useRef)(null),[s,o]=(0,n.useState)(null),{title:a,followers:l,following:c}=t,d="following"===t.drawerType?c:l,p="following"===t.drawerType?lng("followed by %s",a.caps()):lng("followers of %s",a.caps()),u=(0,y.tZ)(Mt.$0,{icon:"manager",title:p.caps(),onClose:i});return(0,y.tZ)(Ft.d,{onClose:i,from:"side",scroll:!0,ref:r,refDrawerBody:o,children:(0,y.tZ)("div",{children:(0,y.tZ)(Mt.W2,{head:u,stickyHead:!0,children:(0,y.tZ)(Co.Z,{collection:d,scrollParent:s,type:t.drawerType})})})})})),ba=(0,l.iv)("display:flex;justify-content:space-between;min-width:100%;flex-direction:column;.user-section{display:flex;justify-content:space-between;.user{display:flex;margin:20px 0 25px;",c.g.classes.margin_near("10px"),";align-items:flex-end;width:60%;.header-content{display:flex;flex-direction:column;justify-content:space-around;",c.g.classes.margin_near("30px"),";>div>A{color:",c.g.colors.link_blue,";}>.title{font-size:1.5em;font-weight:600;height:2rem;>.Icon{font-size:1rem;display:none;}}}&:hover{>.header-content>.title>.Icon{display:inline-block;}}}}.actions-buttons{",c.g.classes.margin_far("20px"),";display:flex;flex-direction:column;.explore{display:flex;width:100%;justify-content:space-between;}}.about-section{",c.g.classes.margin_far("20px"),";margin-bottom:20px;display:flex;justify-content:space-between;.explore-btn{margin-top:50px;}}",""),va=(0,p.observer)((e=>{let{channelStore:t,user:i,onFullListClick:r}=e;const[s,o]=(0,n.useState)(t.channel.subscribed),{channel:a}=t,{id:l,title:c,store:d,followers:p,following:u}=a,m=(null==p?void 0:p.length)>0,g=(null==u?void 0:u.length)>0,{isSelf:f,basicDetails:w}=i,x=l&&c?c:`${(0,v.v2)(w)} ${lng("channel")}`;return(0,y.BX)("div",{css:ba,children:[(0,y.BX)("div",{className:"user-section",children:[(0,y.BX)("div",{className:"user",children:[(0,y.tZ)(mt.qE,{user:w,size:"75px"}),(0,y.BX)("div",{className:"header-content",children:[(0,y.BX)("span",{className:"title",children:[x," ",f&&(0,y.tZ)(b.JO,{buttonLike:!0,onClick:()=>a.editChannel(),icon:"edit"})]}),(m||g)&&(0,y.BX)("div",{children:[m&&(0,y.BX)(h.A,{theme:"hover",onClick:()=>(a.drawerType="followers",r()),children:[lng("followers").caps()," (",p.length,")"]}),m&&g&&" / ",g&&(0,y.BX)(h.A,{theme:"hover",onClick:()=>(a.drawerType="following",r()),children:[lng("following").caps()," (",u.length,")"]})]})]})]}),(0,y.BX)("div",{className:"actions-buttons",children:[f&&(0,y.tZ)(_.l,{chunky:!0,bold:!0,theme:"contained",onClick:()=>d.addPlaylist(),children:lng("add new playlist").caps()}),!f&&(0,y.tZ)(_.l,{chunky:!0,bold:!0,theme:"contained",onClick:()=>{return e=s?1:0,(0,C.SC)("channel/channel_subscribe",{method:"POST",data:{channel_id:l,leave:e}},(()=>o(!s)));var e},children:s?lng("unfollow").caps():lng("follow").caps()}),l&&f&&(0,y.tZ)(_.l,{chunky:!0,bold:!0,theme:"contained",onClick:()=>t.Recommend(),children:lng("invite users").caps()})]})]}),(0,y.BX)("div",{className:"about-section",children:[(0,y.tZ)(_a,{channel:a}),f&&!g&&(0,y.tZ)("div",{className:"explore-btn",children:(0,y.tZ)(_.l,{chunky:!0,bold:!0,theme:"outlined",onClick:()=>(0,h.p4)({library:!0,tab:"channels"},!0),children:lng("explore more channels").caps()})})]})]})})),_a=(0,p.observer)((function(e){let{channel:t}=e;const[i,r]=(0,n.useState)(!1),s=(0,ce.k6)((0,ce._3)(t.creation_time),{time:!1,named_month:!0,format:"LL"}),o=`${lng("created").caps()}: ${s} ${t.description}`,a=!!t.description;return(0,y.tZ)("div",{css:fa,children:a?(0,y.BX)(y.HY,{children:[(0,y.BX)("div",{className:"about-title",onClick:()=>r(!i),children:[lng("about").caps()," ",(0,y.tZ)(b.JO,{icon:i?"arrow_up":"arrow_down"})]}),(0,y.tZ)("div",{className:"about",children:(0,y.tZ)(f.xn,{css:!i&&a&&c.g.classes.descriptionShowMore,content:o})})]}):(0,y.BX)("div",{children:[lng("created").caps(),": ",s]})})})),fa=(0,l.iv)("margin:10px;display:flex;flex-direction:column;.about-title{margin:5px 0;&:hover{cursor:pointer;}.Icon{font-size:.8rem;}}.about{width:100%;",c.g.classes.padding_far("45px"),";}",""),ya=(0,p.observer)((function(e){let{userStore:t}=e;const{authorization_qualification:i,isSelf:n,wsFilterNsort:r,wsShowComponents:s,showDependenciesOf:o,updateShowDependenciesOf:a,user_id:l}=t,c=i.filter((e=>e.c_completed)),d=i.filter((e=>!e.c_completed)),p=(0,v.v7)({completed_authorization_qualification:c.length>0&&lng("job authorizations"),potential_authorization_qualification:d.length>0&&lng("potential job authorizations")},(e=>!!e));let u=[{name:"group_name",label:lng("name"),type:"text",outOfMenu:!0},{name:"group_id",label:"#",type:"text"}];const{filtersVals:m,setFilterVals:g}=(0,Z.qD)(r),h=r.filter.table?(0,v.v7)(p,((e,t)=>r.filter.table.includes(t))):p,b=(0,y.tZ)(hi.CX,{filters:u,filtersVals:m,onFilter:g,extraComponent:(0,y.tZ)(Zt.I,{type:"checkbox",value:s,onChange:e=>t.wsShowComponents=!!e,label:lng("show components").caps()}),alwaysShow:!0}),_={showDependenciesOf:o,updateShowDependenciesOf:a,isSelf:n,showComponents:s,filterNsort:r,viewed_user_id:l};return(0,y.BX)(y.HY,{children:[b,(0,y.BX)("div",{children:[h.completed_authorization_qualification&&(0,y.tZ)(Nr,{title:p.completed_authorization_qualification,collection:c,..._}),h.potential_authorization_qualification&&(0,y.tZ)(Nr,{title:p.potential_authorization_qualification,collection:d,..._})]})]})})),wa=(0,l.iv)(".MainCol{padding-top:20px!important;}",c.g.mQuery.mobile,"{.TopWidgets{justify-content:center;}}",""),xa=(0,p.observer)((function(e){let{id:t}=e;const i=(0,n.useContext)(zt.l9).getStore("user",t);if(!i.ready)return(0,y.tZ)(bi.h,{});(0,v.Ju)((0,v.v2)(i.basicDetails));const{tab:r,topTabs:s,subTabs:o,userFiles:a,basicDetailsWidgetSpread:l}=i,c={tabs:s,activeTab:o?"":r,onSelect:e=>i.tab=e};return(0,y.BX)(Et.T,{css:wa,internalScrolling:"general"===r,children:[(0,y.tZ)(vi.v7,{headline:(0,v.v2)(i.basicDetails),tabs:c}),o&&(0,y.tZ)(ie.m,{tabs:o,activeTab:r,onSelect:c.onSelect,subTabs:!0}),(0,y.tZ)(Rt.SV,{children:"general"===r?(0,y.tZ)(y.HY,{children:(0,y.tZ)(_s.Z,{side:(0,y.tZ)(ys,{userStore:i}),children:(0,y.tZ)(Rt.SV,{children:(0,y.tZ)(Yr,{userStore:i})})})}):(0,y.tZ)(_s.Q,{children:(0,y.tZ)(ka,{userStore:i})})}),a.showFiles&&(0,y.tZ)(ns.G,{userStore:i}),l&&(0,y.tZ)(ps,{userStore:i})]})})),ka=(0,p.observer)((function(e){let{userStore:t}=e;const{tab:i,tasks:n,filteredTasks:r,tasks_filterNsort:s,user_id:o}=t;switch(i){case"workspaces":return(0,y.tZ)(Rr,{userStore:t});case"management":return(0,y.tZ)(gr,{userStore:t});case"evaluation":return(0,y.tZ)(Vr,{userStore:t});case"compliance":return(0,y.tZ)(Fr,{userStore:t});case"job_authorizations":return(0,y.tZ)(ya,{userStore:t});case"requests":return(0,y.tZ)(Jr.V,{userStore:t});case"tasks":return(0,y.tZ)(At.B,{filteredTasks:r,tasks:n,filterNsort:s,priorityOn:!0,viewMode:!0,displayCount:!0,barExtraComponent:(0,y.tZ)(b.JO,{icon:"report",href:{report:"TasksActivityReport",params:{range:"today",user:o}},toolTip:lng("open tasks activity report")})});case"logins":return(0,y.tZ)(rs,{userStore:t});case"multiuser":return(0,y.tZ)(ls,{userStore:t});case"blog":return(0,y.tZ)(zn,{userStore:t});case"forms":return(0,y.tZ)(Zs,{title:lng("submitted forms"),collection:t.forms});case"participation":return(0,y.tZ)(Os,{title:lng("planned participation"),collection:t.participation,store:t});case"skills":return(0,y.tZ)(qo,{userStore:t});case"challenges":return t.challengesStore.fetch(),(0,y.tZ)(ia,{store:t.challengesStore});case"channel":return(0,y.tZ)(ga,{store:t})}return null}));var Za=i(541),Ca=i(6691),Sa=i(1019);function Oa(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ba=(0,l.iv)("display:flex;flex-direction:column;color:",c.g.colors.text_main,";>._head{padding:20px 20px;display:flex;border-bottom:1px solid ",c.g.colors.separator,";>._subject{flex-grow:1;font-weight:700;font-size:1.8em;}}._options{display:flex;flex-direction:column;}>._body{padding:0 20px;}>.buttonbar{margin-top:1em;margin-bottom:40px;margin-inline-start:20px;display:flex;flex-direction:row;gap:1em;}",""),Ta=(0,p.observer)((function(e){var t;let{subject:i,message:r,message_to_user:s,message_to_group:o,planned:a,form_values:l,message_id:c}=e;const d=(0,n.useContext)(Ca.Zm),p=(0,n.useMemo)((()=>a?new Na(l,d,!0):new Na({subject:i,message:r,message_to_user:s,message_to_group:o},d)),[i,r,s,o,a,l]);if(a&&!l)return null;const g=()=>d.activeMsg=null,h=p.getValue("subject")&&p.getValue("message"),v=p.getValue("message_to_user")||(null===(t=p.getValue("message_to_group"))||void 0===t?void 0:t.size)>0;return(0,y.tZ)(m.q3.Provider,{value:p,children:(0,y.tZ)("form",{autoComplete:"off",method:"post",children:(0,y.BX)("div",{css:Ba,children:[(0,y.BX)("div",{className:"_head",children:[(0,y.tZ)("div",{className:"_subject",children:a?lng("scheduled message").caps():lng("new message").caps()}),(0,y.tZ)("div",{children:(0,y.tZ)(b.JO,{icon:"close",buttonLike:!0,onClick:()=>p.dirty?(0,Ze.BB)("",{title:lng("close without sending"),onConfirm:g,confirmText:lng("leave"),cancelText:lng("keep writing")}):g()})})]}),(0,y.BX)("div",{className:"_body",children:[(0,y.tZ)(u.au,{input:p.getFieldByName("message_to_user")}),(0,y.tZ)(u.au,{input:p.getFieldByName("message_to_group")}),(0,y.BX)("div",{className:"_options",children:[(0,y.tZ)(u.au,{input:p.getFieldByName("msg_sub_groups")}),(0,y.tZ)(u.au,{input:p.getFieldByName("recipients_hidden")}),(0,y.BX)("div",{children:[(0,y.tZ)(u.au,{input:p.getFieldByName("choose_sending_time")}),p.getValue("choose_sending_time")&&(0,y.tZ)("div",{style:{display:"inline-block"},children:(0,y.tZ)(u.au,{input:p.getFieldByName("sending_time")})})]}),(0,y.tZ)(u.au,{input:p.getFieldByName("send_sms")})]}),(0,y.tZ)(u.au,{input:p.getFieldByName("subject")}),(0,y.tZ)(u.au,{input:p.getFieldByName("message")})]}),(0,y.tZ)("div",{className:"buttonbar",children:a?(0,y.BX)(y.HY,{children:[(0,y.BX)(we.zx,{theme:we.jR,onClick:()=>p.updatePlanned(c),disabled:!(!p.status&&h&&v),children:[(0,y.tZ)(b.JO,{icon:"save"})," ",lng("save").caps()]}),(0,y.BX)(we.zx,{theme:we.AE,onClick:()=>p.deletePlanned(c),children:[(0,y.tZ)(b.JO,{icon:"trash"})," ",lng("delete").caps()]})]}):(0,y.BX)(y.HY,{children:[(0,y.tZ)(_.l,{theme:"contained",onClick:()=>p.callSave(),disabled:!(!p.status&&h&&v),children:"saving"===p.status?lng("please wait..."):p.values.get("choose_sending_time")?lng("schedule send").caps():lng("send").caps()}),!p.values.get("choose_sending_time")&&(0,y.tZ)(_.l,{theme:"outlined",onClick:()=>p.preset(),disabled:!(!p.status&&h&&!v),children:lng("save draft").caps()})]})})]})})})}));class Na extends m.I{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),Oa(this,"msgStore",void 0),Oa(this,"planned",void 0),this.planned=i,this.msgStore=t,this.buildFields(e,t)}buildFields(e,t){if(Object.keys((null==e?void 0:e.message_to_group)||{}).length)for(const t of Object.keys(e.message_to_group))e.message_to_group[t].group_recipient||(e.message_to_group[t]={id:t,group_recipient:["members"]});const i=!!(Blsm.user.isPowerManager||Blsm.user.perm.isGroupViewer||Blsm.user.perm.isOuManager||Blsm.user.perm.isGroupOwner);this._fields=[{type:"multiple_items",name:"message_to_user",label:lng("select user"),outer_label:lng("send to"),separateLines:!1,inline:!0,theme:"bright",searchData:(e,t)=>{let{ids:i,term:n}=e;(0,C.SC)("ajax/UsersAjax.class.php",{method:"POST",data:{req:"AutoComplete",term:n||"",id:i||"",exclude_self:1,limit:!i&&null}},t)}},{insert:i,type:"multiple_items",name:"message_to_group",label:lng("select workspace"),outer_label:lng("send to"),separateLines:!1,inline:!0,theme:"bright",valueIsMap:!0,objectKeys:["id","label","group_recipient"],validate:e=>!!(e=>![...e].find((t=>{var i,n;let[r]=t;return 0===(null===(i=e.get(r))||void 0===i||null===(n=i.group_recipient)||void 0===n?void 0:n.length)})))(e)||{error:lng("please select at least one item")},buttons:[{Render:e=>{let{onChange:i,item:n}=e;return(e=>{let{onChange:t,item:i,permission_types:n}=e;return"all"===i.id?null:(0,y.tZ)(Zt.I,{type:"select_multi",options:(0,v.wd)(n),onChange:t,value:i.group_recipient})})({onChange:i,item:n,permission_types:t.permission_types})},onChange:(e,t)=>(t.find((e=>(0,v.B5)(e)))&&(t=t.filter((e=>"managers"!==e))),e.group_recipient=t,e)}],searchData:(e,t)=>{const i=this.values.get("message_to_group"),n=i&&Array.from(i.values()).map((e=>e.id));(0,C.SC)("groups/autocomplete",{method:"POST",json:!0,data:{managed_perm:Blsm.ManagerPermissions.VIEW,term:e.term||"",id:e.ids||"",limit:e.ids?null:10,exclude:n}},(i=>(i.forEach((e=>e.group_recipient=["members"])),Blsm.user.isPowerManager&&(0,v.DM)(e.term)&&i.unshift({id:"all",label:lng("all users in the domain").caps(),name:lng("all users in the domain").caps()}),t(i))))}},{type:"checkbox",name:"msg_sub_groups",label:lng("include sub workspaces").caps(),mod:["","ENT"],insert:i},{type:"checkbox",name:"recipients_hidden",label:lng("conceal recipients list").caps(),mod:["","ENT"]},{type:"checkbox",name:"choose_sending_time",label:lng("schedule send").caps(),disabled:this.planned,mod:["","ENT"]},{name:"sending_time",type:"date_time",label:lng("select date"),minDate:moment(),required:()=>this.values.get("choose_sending_time"),mod:["","ENT"]},{type:"checkbox",name:"send_sms",label:lng("also send as a text message").caps(),insert:Blsm.InitialData.special.sms&&Blsm.user.isManager,mod:["","ENT"]},{type:"section",fields:[{type:"text",name:"subject",outer_label:lng("subject")},{type:"richtext",name:"message",label:lng("message"),toolbarOptions:{font:!0,color:!0,link:!0,attach:!0,media_link:!0,list:!0,align:!0},onValueChange:(e,t)=>this.values.set("message_commands",t.commands)}]},{type:"hidden",name:"planned_message_id"}],this._prepFields(e)}SaveSuccess(e){if(this.status="success",this.msgStore.boxes[this._saving_to_box].invalidate(),(0,v.B5)(e.message_id)){let t=this._saving_to_box;this.values.get("choose_sending_time")&&this.values.get("sending_time")&&((0,be.qV)(lng("future message saved successfully").caps()),t="planned",this.msgStore.activeMsg=null),(0,h.p4)({message:e.message_id,tab:t},!0)}else e.deleted?(0,h.p4)({messages:!0,tab:this._saving_to_box},!0):(0,be.Mj)((0,v.HD)(e)?e:JSON.stringify(e))}save(e){this.status="saving",this._saving_to_box="out",this.saveToUrl("messages/new",e)}preset(){this._saving_to_box="preset",this.saveToUrl("messages/preset",this.buildFinalValues())}updatePlanned(e){this._saving_to_box="planned",this.saveToUrl("messages/planned",Object.assign({message_id:e},this.buildFinalValues()))}deletePlanned(e){this._saving_to_box="planned",this.saveToUrl("messages/delete",{message_id:e})}}const Ia=(0,l.iv)(c.g.mQuery.mobile,"{.MainCol{position:fixed;background:white;width:100vw;height:calc(100vh - ",c.g.consts.TOP_BAR_HEIGHT,"px);overflow-y:auto;}}",""),Da=(0,l.iv)("display:flex;flex-direction:column;height:100%;justify-content:center;align-items:center;color:",c.g.colors.text_main,";>.Icon{display:block;font-size:150px;}>span{font-size:2em;}",""),ja=(0,p.observer)((function(){var e,t;const i=(0,n.useContext)(zt.l9).getStore("messages");(0,Z.iP)(),(0,v.Ju)(lng("messages"));const{ready:r,activeMsg:s,activeBoxKey:o,draftSubject:a,draftBody:l,queryParams:c}=i;if(!r)return(0,y.tZ)(bi.h,{});let d=null==c||null===(e=c.to)||void 0===e?void 0:e.split(","),p=(null==c?void 0:c.ws)&&{[null==c?void 0:c.ws]:{}};return(0,y.tZ)(Et.T,{css:Ia,internalScrolling:!0,children:(0,y.tZ)(Ca.Zm.Provider,{value:i,children:(0,y.tZ)(_s.Z,{side:(0,y.tZ)(Za.U,{}),children:s||!(0,v.tq)()?(0,y.tZ)(y.HY,{children:"new"===s?(0,y.tZ)(Ta,{subject:a,message:l,message_to_user:d,message_to_group:p}):s instanceof Ca.v0?"planned"===o?(0,y.tZ)(Ta,{planned:!0,...s}):(0,y.tZ)(Sa.t,{msg:s}):(0,y.BX)("div",{css:Da,children:[(0,y.tZ)(b.JO,{icon:"mailbox"}),(0,y.tZ)("span",{children:0===parseInt(null===(t=i.activeBox)||void 0===t?void 0:t.totalItems)?"in"===i.activeBoxKey?lng("your inbox is empty"):lng("nothing to show"):"　"})]})}):void 0})})})}));var Pa=i(554),za=i(4401),Ea=i(9159),Ra=i(4925);const Fa=(0,l.iv)(c.g.mQuery.mobile,"{margin:20px;}.topButtons{display:flex;margin-bottom:18px;>*{display:block;padding:12px 0;border-radius:10px;}>._new_button{flex-grow:1;}>._import_button{",c.g.classes.margin_near("10px"),";}}>.calendarDiv{padding-inline-start:15px;>.calendar-action{display:none;}}>.calendarDiv:hover{>.calendar-action{display:inline;margin:10px;",c.g.classes.opposite_float,";}}","");var Ma={name:"15kp1k9",styles:"vertical-align:text-bottom"};const Aa=(0,p.observer)((function(e){let{onClose:t}=e;const i=(0,n.useContext)(Pa.i),r=e=>()=>(e(),t());return(0,y.BX)("div",{css:Fa,children:[(0,y.BX)("div",{className:"topButtons",children:[i.mayAddEvent()&&(0,y.BX)(_.l,{theme:"contained",bold:!0,className:"_new_button",onClick:r((()=>(0,zt.vm)().openDialog("form",new za.Z))),children:[(0,y.tZ)(b.JO,{icon:"create"})," ",lng("create new event").caps()]}),Blsm.user.isPowerManager&&(0,y.tZ)(_.l,{theme:"outlined",bold:!0,className:"_import_button",onClick:r((()=>(0,h.p4)({import:"ical"},!0))),children:(0,y.tZ)(b.JO,{icon:"import",toolTip:lng("import events from icalendar (ical/ics) file").caps()})})]}),(0,y.tZ)("div",{className:"title",children:(0,y.tZ)(Ea.XZ,{value:i.allMyCalendars,label:lng("my calendars").caps(),onChange:e=>i.checkCalendars(e,"allMyCalendars")})}),i.mineCalendars.map((e=>(0,y.BX)("div",{className:"calendarDiv",children:[(0,y.tZ)(Ea.XZ,{label:e.name,color:e.color,value:i.activeCalendars[e.id],onChange:t=>i.activeCalendars[e.id]=!!t}),!e.user_id&&(0,y.tZ)(b.JO,{toolTip:lng("public calendar"),spaceBefore:!0,css:Ma,icon:"globe-americas"}),(0,y.tZ)(b.JO,{icon:"edit",className:"calendar-action",onClick:()=>(e=>{i.updateCalendar(e),t()})({calendar:e})}),(0,y.tZ)(b.JO,{icon:"trash",className:"calendar-action",onClick:()=>(e=>{i.deleteCalendar(e),t()})({calendar:e})})]},e.id))),(0,y.BX)("div",{children:[(0,y.tZ)(b.JO,{icon:"new",toolTip:lng("add calendar").caps(),buttonLike:!0,onClick:()=>(i.addCalendar(),void t())}),(0,y.tZ)("span",{children:lng("add calendar").caps()})]}),(0,y.tZ)("hr",{}),(0,y.tZ)("div",{className:"title",children:(0,y.tZ)(Ea.XZ,{value:i.allOtherCalendars,label:lng("other calendars").caps(),onChange:e=>i.checkCalendars(e,"allOtherCalendars")})}),i.otherCalendars.map((e=>(0,y.tZ)("div",{className:"calendarDiv",children:(0,y.tZ)(Ea.XZ,{label:e.name,color:e.color,value:i.activeCalendars[e.id],onChange:t=>i.activeCalendars[e.id]=!!t})},e.id))),(0,y.tZ)("hr",{}),(0,y.tZ)("div",{className:"title",children:lng("options").caps()}),(0,y.tZ)("div",{children:(0,y.tZ)(Ea.XZ,{label:lng("schedule",{phrase:!0}),value:i.preferences.meetings,onChange:e=>i.preferences.meetings=e})}),(0,y.tZ)("div",{children:(0,y.tZ)(Ea.XZ,{label:lng("workspace events"),value:i.preferences.workspace_events,onChange:e=>i.preferences.workspace_events=e})}),(0,y.tZ)("div",{children:(0,y.tZ)(Ea.XZ,{label:lng("assignments"),value:i.preferences.assignments,onChange:e=>i.preferences.assignments=e})}),(0,y.tZ)("div",{children:(0,y.tZ)(Ea.XZ,{label:lng("courses"),value:i.preferences.courses,onChange:e=>i.preferences.courses=e})}),(0,y.tZ)("div",{children:(0,y.tZ)(Ea.XZ,{label:lng("only blocking events"),value:i.preferences.blocking_events,onChange:e=>i.preferences.blocking_events=e})}),(0,y.tZ)("hr",{}),Blsm.isFeatureEnabled("resources")&&(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"title",children:lng("resources").caps()}),(0,y.tZ)(Ra.Uz,{label:lng("resources"),showId:!0,theme:"bright",value:i.resources,onChange:e=>i.resources.replace(e),searchData:(e,t)=>(0,C.SC)("resources/search_resource",{data:{req:"AutoComplete",by_id:e.ids,mode:"all",matches_only:!0}},t)}),(0,y.tZ)("div",{className:"title",children:lng("resource bundle").caps()}),(0,y.tZ)(Ra.Uz,{label:lng("resource bundles"),showId:!0,theme:"bright",value:i.resourceBundle,onChange:e=>i.resourceBundle.replace(e),searchData:(e,t)=>(0,C.SC)("search/groups",{data:{types:"ResourceBundle",id:e.ids,term:e.term||" "}},t)})]}),(0,y.tZ)("hr",{}),(0,y.tZ)("div",{className:"title",children:lng("agenda").caps()}),i.agenda.map(((e,t)=>(0,y.tZ)(Xa,{agenda:e},t)))]})}));Aa.defaultProps={onClose:()=>{}};var qa={name:"3zy121",styles:"margin:20px"};const Xa=e=>{let{agenda:t}=e;return(0,y.tZ)("div",{css:qa,children:(0,y.tZ)(xt.o,{title:`${(0,ce.GG)(t.start_date)} - ${(0,ce.GG)(t.due_date).split(" ")[0]}`,subTitle:t.name,onClick:()=>(0,h.p4)({workspace:t.group_id},!0)})})},La=(0,l.iv)(c.g.mQuery.mobile,"{display:none;}.agendaDiv{padding:10px;}.agendaDiv:hover{background-color:",c.g.colors.bg_2,";}",""),$a=(0,p.observer)((function(e){return(0,y.tZ)(gn.h,{css:La,children:(0,y.tZ)(Aa,{...e})})})),Va=(0,l.iv)(c.g.mQuery.mobileNarrow,"{.fc-daygrid-day-events{font-size:10px;a>.fc-event-title{display:none;}.fc-daygrid-event-dot{margin:0 2px;}}}",""),Ua=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("calendar"),{calendarRef:t,title:i,viewType:r,todayDisabled:s,updateFromFC:o}=e,[a,l]=(0,n.useState)(!1);(0,v.Ju)(lng("calendar"));const{ready:c}=e;if(!c)return(0,y.tZ)(bi.h,{});const d=(0,y.tZ)($a,{addCalendar:e.addCalendar,updateCalendar:e.updateCalendar,deleteCalendar:e.deleteCalendar});return(0,y.tZ)(Et.T,{css:Va,internalScrolling:!0,children:(0,y.tZ)(Pa.i.Provider,{value:e,children:(0,y.BX)(_s.Z,{side:d,children:[(0,y.BX)(dt.c_,{children:[(0,y.tZ)(Ys.A,{title:(0,y.tZ)("b",{children:i}),goPrev:()=>t.current.prev(),goNext:()=>t.current.next(),goToday:!s&&(()=>t.current.today()),viewType:r,onChangeViewType:i=>(e.viewType=i,t.current[i]())}),(0,y.tZ)("div",{className:"mobile_only",children:(0,y.tZ)(ut.y,{content:(0,y.tZ)(Aa,{onClose:()=>l(!1)}),mobileLayoutSupport:!0,behavior:"trigger",onClose:()=>l(!1),trigger:a,children:(0,y.tZ)(b.JO,{icon:"filter",onClick:()=>l(!0),buttonLike:!0})})})]}),(0,y.tZ)("div",{style:{height:"calc(100vh - 154px)"},children:(0,y.tZ)(Ks,{noHeader:!0,ref:t,viewType:e.viewTypes[r],initialDate:e.start,onChange:o,events:e.getEvents,eventClick:e.eventClick,eventMouseEnter:e.eventMouseEnter,select:i=>e.datesSelect(i,t),eventDrop:e.eventDrop,eventResize:e.eventResize})})]})})})}));var Ha,Ja=i(5474);let Ga=(function(e,t,i,n,r){var s={};Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null)}((Ha=class extends m.I{constructor(e){super(e),(0,g.makeObservable)(this);const{data:t={}}=e;this.sqlStore=e.sqlStore,this.query=t.query,this.title=lng("query report"),this.saveUrl="SQL/save_report",this.listSavedReports=e.data.listSavedReports,this.requiredSelectedOpt="",this.reportName="",this._fields=[{type:"select",name:"report_id",options:this.listSavedReports,label:lng("overwrite existing report"),emptyOption:lng("create new report"),onValueChange:e=>{const t=this.sqlStore.getSavedReportById(e);this.reportName=e,this.requiredSelectedOpt=e.length>0?"dropdown":"none",this.values.set("report_name",(null==t?void 0:t.name)||""),this.values.set("available_to_pm",t.available_to_managers)},value:this.reportName},{type:"text",name:"report_name",label:lng("enter report name"),onValueChange:e=>{this.reportName=e}},{type:"checkbox",name:"available_to_pm",label:lng("available to power managers")}],this._prepFields(),this.ready=!0}save(e){e.is_update="dropdown"===this.requiredSelectedOpt?1:0,this.saveToUrl(this.saveUrl,Object.assign({QueryText:this.query},e))}SaveSuccess(){}}).prototype,"SaveSuccess",[g.action],Object.getOwnPropertyDescriptor(Ha.prototype,"SaveSuccess"),Ha.prototype),Ha);const Wa=(0,l.iv)(">*+*{margin-top:5px;}direction:ltr;._buttons_row{display:flex;align-items:center;>*{",c.g.classes.margin_far("3px"),";}.Icon-wizard{color:",c.g.colors.dominant_main,";}select{max-width:calc(100% - 80px);}}textarea{height:120px;width:100%;direction:ltr;text-align:left;}iframe{background-color:",c.g.colors.bg_main,";color:",c.g.colors.text_main,";border:1px solid silver;margin-top:20px;width:100%;height:calc(100vh - ",c.g.consts.TOP_BAR_HEIGHT,"px - 58px);}",""),Ka=(0,p.observer)((function(){var e;const t=(0,n.useContext)(zt.l9).getStore("sql"),[i,r]=(0,n.useState)(),[s,o]=(0,n.useState)(),[a,l]=(0,n.useState)(),[d,p]=(0,n.useState)();(0,v.Ju)("sql");const u=(0,n.useRef)(),m=(0,n.useRef)(),{tables:g,recentQueries:h,savedReports:f,query:w,size:x,reformatQuery:k}=t,Z=[{optgroup:!0,label:lng("tables").caps(),options:g.filter((e=>!e.is_view)).map((e=>({val:e.name,label:e.name+e.details})))},{optgroup:!0,label:lng("views").caps(),options:g.filter((e=>e.is_view)).map((e=>({val:e.name,label:e.name+e.details})))}],S=null===(e=t.selectedTableCols(i))||void 0===e?void 0:e.map((e=>({val:e,label:e}))),O=h.map((e=>({val:e,label:e}))),B=[{optgroup:!0,label:lng("admin only reports").caps(),options:f.filter((e=>!(0,v.P$)(e.available_to_managers))).map((e=>({val:e.id,label:e.name})))},{optgroup:!0,label:lng("power manager reports").caps(),options:f.filter((e=>(0,v.P$)(e.available_to_managers))).map((e=>({val:e.id,label:e.name})))}],T=[{label:lng("dump schema (selective)"),onClick:()=>t.selectiveDownload()},{label:lng("dump schema (slim)"),onClick:()=>t.sendScehma(1)},{label:lng("dump schema (no logs)"),onClick:()=>t.sendScehma("no_logs")},{label:lng("dump schema"),onClick:()=>t.sendScehma()},{label:lng("dump schema (chat only)"),onClick:()=>t.sendScehma("chat_only")}],N=e=>{var i;if(null===(i=e)||void 0===i||!i.trim())return;const n=m.current,r=n.selectionEnd,s=n.selectionStart;e="from_unixtime"===e&&s<r?`from_unixtime(${t.query.substring(s,r).trim()})`:e.trim()+" ",t.query=t.query.substring(0,s)+e+t.query.substring(r);const o=s+e.length;setTimeout((()=>n.setSelectionRange(o,o)),0)},I=()=>h.unshift(w);return(0,y.BX)(Et.T,{contBG:!0,children:[(0,y.tZ)(vi.v7,{headline:lng("SQL query"),simple:!0}),(0,y.BX)(_s.Q,{css:Wa,children:[(0,y.BX)("div",{className:"_buttons_row",children:[(0,y.tZ)(b.JO,{icon:"wizard",onClick:k,toolTip:"tidy query"}),(0,y.tZ)("div",{children:"|"}),["SELECT *\nFROM","JOIN","LEFT JOIN","|","WHERE","AND","OR","|","GROUP BY","ORDER BY","LIMIT 1","|","FROM_UNIXTIME"].map(((e,t)=>"|"===e?(0,y.tZ)("div",{children:"|"},t):(0,y.tZ)(_.l,{theme:"outlined",onClick:()=>N(e),children:e.replace(/\n/g," ")},t))),(0,y.tZ)("div",{css:c.g.classes.flex_grow}),(0,y.BX)("span",{children:[x," "]}),(0,y.tZ)(R.x,{options:T,children:(0,y.tZ)(b.JO,{icon:"download"})})]}),(0,y.BX)("div",{className:"_buttons_row",children:[(0,y.tZ)("div",{style:{position:"relative"},children:(0,y.tZ)(Ja.P,{options:Z,emptyOption:!0,value:i,onChange:r})}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>N(i),children:"Add table"}),S&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{style:{position:"relative"},children:(0,y.tZ)(Ja.P,{options:S,value:s,onChange:o,emptyOption:!0})}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>N(s),children:"Add column"}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>N(t.selectedTableCols(i).join(", ")),children:"Add all columns"})]})]}),(0,y.BX)("div",{className:"_buttons_row",children:[(0,y.tZ)("div",{style:{position:"relative"},children:(0,y.tZ)(Ja.P,{options:O,emptyOption:"- Recent queries -",value:a,onChange:l})}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>N(a),children:"Load"})]}),(0,y.BX)("div",{className:"_buttons_row",children:[(0,y.tZ)("div",{style:{position:"relative"},children:(0,y.tZ)(Ja.P,{options:B,emptyOption:"- Saved reports -",value:d,onChange:p})}),(0,y.tZ)(_.l,{theme:"contained",onClick:()=>{var e;return N(null===(e=t.getSavedReportById(d))||void 0===e?void 0:e.query)},children:"Load"}),(0,y.tZ)(_.l,{theme:"outlined",onClick:()=>{t.deletedSavedReport(d)},children:"Delete report"})]}),(0,y.BX)("form",{method:"post",action:(0,C.Q2)("SQL/query"),target:"QueryRes",ref:u,onSubmit:I,children:[(0,y.tZ)("textarea",{name:"QueryText",spellCheck:"false",onKeyUp:e=>{("F9"===e.key||"Enter"===e.code&&e.ctrlKey)&&(I(),u.current.submit())},value:w,onChange:e=>t.query=e.target.value,ref:m}),(0,y.BX)("div",{className:"_buttons_row",children:[(0,y.tZ)(_.l,{formButton:!0,name:"req",value:"exec_query",type:"submit",theme:"contained",children:"Query"}),(0,y.tZ)(_.l,{formButton:!0,name:"req",value:"exec_excel",type:"submit",theme:"outlined",children:"To Excel"}),(0,y.tZ)(_.l,{formButton:!0,name:"req",value:"exec_csv",type:"submit",theme:"outlined",children:"To CSV"}),(0,y.tZ)("div",{children:"|"}),(0,y.tZ)(_.l,{theme:"outlined",disabled:!w,onClick:()=>{(0,zt.vm)().openDialog("form",new Ga({data:{query:t.query,listSavedReports:B},sqlStore:t,onSaveSuccess:()=>{(0,zt.vm)().closeDialog(),t.fetch()}}))},options:B,children:"Save report"})]})]}),(0,y.tZ)("iframe",{name:"QueryRes"})]})]})})),Ya=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).searchStore;(0,v.Ju)("search results");const{searchCategories:t,activeCategory:i,loading:r,moreAvailable:s,loadingMore:o,getMore:a,searchTerm:l,suggestion:d}=e;return(0,y.tZ)(Et.T,{bottomPadding:!0,children:(0,y.BX)("div",{children:[(0,y.tZ)(vi.v7,{headline:lng("search results for '%s'",l),tabs:{tabs:t,activeTab:i,onSelect:t=>e.activeCategory=t},desc:d?(0,y.BX)("div",{children:[lng("did you mean:").caps()," ",(0,y.tZ)("span",{css:c.g.classes.link,onClick:()=>e.searchTerm=d,children:d})]}):void 0}),(0,y.tZ)(_s.Q,{children:(0,y.tZ)("div",{className:"_results_filters",children:(0,y.BX)(Rt.SV,{children:[(0,y.tZ)(el,{}),!r&&s&&(o?(0,y.tZ)(ge.$,{}):(0,y.tZ)(_.l,{onClick:a,style:{display:"block"},children:lng("more").caps()+"..."}))]})})})]})})})),Qa=(0,l.iv)(".search-results-link{color:",c.g.colors.dominant_main,";}>.results_and_filters{margin-top:1em;display:flex;>div:first-child{flex-grow:1;}._filters{",c.g.classes.margin_near("20px"),";flex-basis:320px;flex-shrink:0;color:",c.g.colors.text_sec,";>div{padding:10px 15px;border:1px solid ",c.g.colors.separator,";border-radius:10px;>._title{border-bottom:1px solid ",c.g.colors.separator,";padding-bottom:10px;margin-bottom:10px;font-weight:600;}}}}div._title{font-weight:600;color:",c.g.colors.text_sec,";font-size:1rem;}",""),el=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).searchStore,t=(0,Z.iP)(),{activeCategory:i,results:r,compactView:s,totalCount:o,advanceFilterShow:a,filterForm:l,allowedUserFields:d,searchContentPage:p,loading:u,searchTerm:m}=e,g=o||r.length,v=(0,y.tZ)("div",{className:"_filters",children:(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"_title",children:lng("filter").caps()}),(0,y.tZ)(Rt.SV,{children:(0,y.tZ)(tl,{filtersForm:l})})]})});let _="";const f=t.width<1e3;l&&(_=f?(0,y.tZ)(ut.y,{mobileLayoutSupport:!0,content:(0,y.tZ)("div",{style:{padding:"10px",minWidth:"320px",overflow:"auto",height:"70vh"},children:v}),children:(0,y.tZ)(b.JO,{icon:"filter"})}):(0,y.tZ)(b.JO,{icon:"filter",color:a?c.g.colors.dominant_main:void 0,onClick:()=>e.advanceFilterShow=!e.advanceFilterShow,toolTip:lng("filter")}));const w=p(i,m),x=(null==w?void 0:w.href)&&m&&(0,y.BX)("span",{children:[(0,y.tZ)("wbr",{}),"(",(0,y.tZ)(h.A,{className:"search-results-link",href:w.href,children:lng('browse for "%s" in %s page',m,w.title)}),")"]}),k=(0,y.BX)("div",{style:{whiteSpace:"nowrap"},children:[o>0?lng("%s results found",g):r.length>0?lng("showing %s results",r.length):""," ",g>0&&x]}),C=(0,y.tZ)(hi.$Q,{title:k,compactView:s,extraComponent:_,onViewSelect:["assignments","content","groups"].includes(i)?t=>e.compactView=t:void 0});return(0,y.BX)("div",{css:Qa,children:[C,(0,y.BX)("div",{className:"results_and_filters",children:[u?(0,y.tZ)(ge.$,{}):r.length>0?(0,y.tZ)((e=>{let{activeCategory:t}=e;switch(t){case"users":return(0,y.tZ)(ui.PH,{collection:r,noFilterSort:!0,sticky:70,stickyStartHeight:0,allowedUserFields:d,searchPage:!0});case"tasks":return(0,y.tZ)(At.B,{tasks:r,viewMode:!0,noFilterSort:!0,sticky:70,stickyStartHeight:0,searchPage:!0});case"assignments":case"content":return(0,y.tZ)(Cn.Mz,{assignments:r,noFilterSort:!0,compactView:s,noComments:!0});case"groups":return(0,y.tZ)(un.TY,{workspaces:r,compactView:s});case"catalog":return(0,y.tZ)(un.TY,{workspaces:r,activeTab:"self",page:"registration",compactView:s});case"mycontent":return(0,y.tZ)($n.E,{collection:r,noFilterSort:!0,sticky:70,stickyStartHeight:0,searchPage:!0});default:return r.length}}),{activeCategory:i}):(0,y.tZ)(Wr.M,{title:lng("we didn't find anything"),subTitle:`${lng("maybe it's somewhere else")}?`,icon:"island_tropic",buttons:e.searchCategories.filter((e=>e.val!==i)).map((t=>({val:t.val,label:t.label,click:()=>e.activeCategory=t.val})))}),a&&l&&!f?v:null]}),(0,y.tZ)(gi.$,{})]})})),tl=(0,p.observer)((function(e){let{filtersForm:t}=e;return(0,y.tZ)(m.q3.Provider,{value:t,children:(0,y.tZ)(u.au,{input:t.fields})})}));var il=i(423);const nl=(0,l.iv)(".MainCol{padding:20px;overflow:auto;background-color:",c.g.colors.dominant_white,";table,td,th{border-right:1px solid ",c.g.colors.separator,";vertical-align:middle;padding:2px;font-size:10px;}tr{background-color:",c.g.colors.bg_1,";color:",c.g.colors.bg_1_text,";}tr:hover{background-color:",c.g.colors.bg_2,";}}.fi_title{color:",c.g.colors.text_main,";text-align:center;display:inline-block;font-size:2rem;font-weight:600;margin-bottom:.5rem;}.save{padding:35px 15px 0;display:flex;flex-direction:column;}.warning,.declined{color:",c.g.colors.negative,";}.accepted{color:",c.g.colors.positive,";}.hidden{display:none;}.center_text{text-align:center;}.bg_color_negative{color:",(0,ea.ou)(c.g.colors.negative_bg),";background-color:",c.g.colors.negative_bg,";}.bg_color_marker{color:",(0,ea.ou)(c.g.colors.highlight),";background-color:",c.g.colors.highlight,";}",""),rl=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("import"),{error:t,ready:i,importObj:r}=e;if(t)return(0,y.tZ)(Et.T,{children:t});if(!1===i)return(0,y.tZ)(bi.h,{});const{status:s,title:o,titleExtra:a,fields:l,preview:c,previewButtonLabel:d,commit:p,confirmButtonLabel:g,result:h,events:b}=r,v="saving"===s,_=(0,y.tZ)(gn.h,{children:(0,y.BX)(m.q3.Provider,{value:r,children:[(0,y.BX)("div",{className:"fi_title",children:[o.caps(),a]}),(0,y.tZ)(u.au,{input:l}),(0,y.BX)("div",{className:"save",children:[(0,y.tZ)(he.O,{chunky:!0,primary:!0,onClick:c,disabled:v,children:d}),(0,y.tZ)(he.O,{chunky:!0,onClick:p,disabled:v,children:g})]})]})});return(0,y.tZ)(Et.T,{css:nl,internalScrolling:!0,children:(0,y.BX)(_s.Z,{side:_,children:[v?(0,y.tZ)(ge.$,{}):(0,y.tZ)("div",{dangerouslySetInnerHTML:{__html:h}}),(null==b?void 0:b.length)>0&&(0,y.tZ)(il.r,{events:b})]})})}));var sl=i(7190),ol=i(7806),al=i(247);const ll=(0,l.iv)("._filters{margin-bottom:1em;max-width:600px;}._nothing{text-align:center;width:100%;font-size:2em;color:",c.g.colors.text_sec,";font-style:italic;}.Bar{margin-bottom:1em;}",""),cl=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("dashboard");(0,v.Ju)(lng("dashboard"));const{ready:t}=e;if(!t)return(0,y.tZ)(bi.h,{});const{dashboards:i,activeDashboard:r,dashboardData:s,ous:o,activeOu:a}=e;return(0,y.tZ)(ol.fd.Provider,{value:e,children:i.length>0?(0,y.BX)(Et.T,{css:ll,contBG:!["skills",{}].includes(r),children:[(0,y.tZ)(vi.v7,{sticky:!0,headline:(0,ol.i3)(r),tabs:{tabs:i.map((e=>({val:e,label:(0,ol.i3)(e)}))),activeTab:r,onSelect:t=>e.activeDashboard=t},actions:Blsm.canAccessModule("Reports")&&(0,y.tZ)(_.l,{theme:"contained",href:"#reports",children:lng("reports").caps()})}),(0,y.BX)(_s.Q,{children:["ou"===r&&o&&(0,y.tZ)("div",{className:"_filters",children:(0,y.tZ)(Zt.I,{type:"tree_node",tree:o,value:a,onChange:t=>e.activeOu=t,wrapped:!0,label:lng("org' unit").caps()})}),["assignments","groups","skills"].includes(r)||"loading"!==s?s?(()=>{switch(r){case"recommended":case"personal":return(0,y.tZ)(al.PX,{dashboardsStore:e});case"ou":return(0,y.tZ)(mi.uP,{reports:s,group_id:a});case"assignments":return(0,y.tZ)(al.yy,{dashboardsStore:e});case"groups":return(0,y.tZ)(al.rZ,{dashboardsStore:e});case"skills":return(0,y.tZ)(al.St,{dashboardsStore:e});default:return(0,y.tZ)("div",{})}})():(0,y.tZ)("div",{className:"_nothing",children:lng("nothing to show").caps()}):(0,y.tZ)(ge.$,{})]})]}):(0,y.BX)(Ti.U,{children:[(0,y.tZ)(vi.EL,{}),(0,y.tZ)(Wr.M,{title:lng("there is nothing here"),subTitle:lng("you don't have any bookmarks, assignments, workspaces or recommended reports, check again another time!"),icon:"digging"})]})})}));var dl=i(9431),pl=i(4877),ul=i(4070),ml=i(7828),gl=i(7965);const hl=(0,l.iv)("padding:0 20px;",c.g.mQuery.mobile,"{padding:0 2px;}","");var bl={name:"1azakc",styles:"text-align:center"},vl={name:"6yeg13",styles:"font-size:3em"},_l={name:"h2kn9s",styles:"font-size:2em"};const fl=(0,p.observer)((function(e){let{portalStore:t}=e;const{widgets:i,poster:r,portal_id:s,urlParams:o}=t,a=(0,Z.iP)(),d=(0,n.useRef)();(0,n.useEffect)((()=>{if(null!=o&&o.wid){const e=d.current.querySelector(`[data-widget_id="${o.wid}"]`);e&&setTimeout((()=>e.scrollIntoView({block:"center"})),300)}}),[s]);return(0,n.useEffect)((()=>{if(r)return document.body.style.backgroundImage=`url('${c.g.func.imgUrl(r,t.domain_id)}')`,document.body.style.minHeight=`calc(100vh - ${c.g.consts.TOP_BAR_HEIGHT}px)`,()=>document.body.style.backgroundImage="none"}),[r]),(0,y.tZ)(dl._G.Provider,{value:t,children:(0,y.BX)("div",{css:hl,ref:d,children:[(0,y.tZ)(wl,{portalStore:t}),0===i.length&&(0,y.BX)("div",{css:bl,children:[(0,y.tZ)("div",{css:vl,children:(0,y.tZ)(b.JO,{icon:"portal"})}),(0,y.tZ)("div",{css:_l,children:lng("nothing to show").caps()})]}),(0,y.tZ)(vo.a5.Provider,{value:{baseWidth:!(0,v.tq)()&&c.g.consts.WIDGET_BASE_WIDTH-(a.width<1920?8:0)},children:(0,y.tZ)(vo.Hl,{sortable:t.mayEdit&&!(0,v.tq)(),onSort:e=>{let{new_order:i}=e;t.newOrder(i)},children:i.map((e=>{var t;const{widget_type:i,data:n,widget_id:r}=e;var s;if("error"===(null==n?void 0:n.res))return(0,y.tZ)(pl.wf,{icon:"sign_notification",widgetStore:e,editForm:null===(s=ul.Z[i])||void 0===s?void 0:s.form,children:(0,y.tZ)("div",{css:(0,l.iv)("._title{justify-content:center;}._content{width:",c.g.consts.WIDGET_BASE_WIDTH-c.g.consts.WIDGET_PADDING_SIDE,"px;word-wrap:break-word;font-size:.8em;font-family:monospace;}",""),children:(0,y.tZ)(wr,{title:lng("an error occurred"),content:n.error_msg||lng("unexpected error occurred"),initialState:!1})})},r);const o=null===(t=ul.Z[i])||void 0===t?void 0:t.widget,a=o?(0,y.tZ)(o,{widget:e}):(0,y.tZ)(pl.RO,{widget:e});return a?(0,y.tZ)(Rt.SV,{children:a},r):null}))})})]})})})),yl=(0,l.iv)("display:block;margin-bottom:20px;position:relative;border-radius:10px;background-color:",(0,ea.mR)(c.g.colors.separator,.1),";overflow:hidden;max-width:100vw;img{object-fit:cover;max-height:40vh;width:100%;border-radius:10px;}.banner{position:absolute;width:100%;border-radius:10px;}.ghost-banner{visibility:hidden;display:flex;border-radius:10px;width:100%;}._controls{background-color:",c.g.colors.bg_main,";display:flex;color:",c.g.colors.dominant_main,";font-size:1.2rem;font-weight:600;justify-content:space-between;align-items:center;padding:0 15px;height:40px;._ctrl{display:flex;z-index:1;.Icon{padding:10px;&:hover{cursor:pointer;}}._bullets{top:280px;padding:15px;display:flex;align-items:center;>div{margin:0 5px;transition:.3s;}}}}",""),wl=(0,p.observer)((function(e){let{portalStore:t}=e;const{style:i}=t,{portal_slider_timer:r=10,strip_img_mobile:s,strip_img_desktop:o,strip_img_link:a}=i;let{portal_slider:l}=i;const[d,p]=(0,n.useState)(0),[u,m]=(0,n.useState)(!0),g=e=>d!=e&&p(e);(0,n.useEffect)((()=>{if(u&&r>0){const e=setTimeout((()=>g((d+1)%l.length)),1e3*r);return()=>clearTimeout(e)}}),[u,d]),l||(l=[{img_desktop:o,img_mobile:s,link:a}]);const _=l[d],f=(0,v.tq)()?(null==_?void 0:_.img_mobile)||(null==_?void 0:_.img_desktop):(null==_?void 0:_.img_desktop)||(null==_?void 0:_.img_mobile),w=c.g.isRTL?-1:1,x={enter:()=>({x:w>0?"100vw":"-100vw",opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:()=>({zIndex:0,x:w<0?"100vw":"-100vw",opacity:0})},k=(0,y.tZ)("img",{src:c.g.func.imgUrl(f,t.domain_id)});return(0,y.BX)("div",{css:yl,children:[(0,y.tZ)(ml.M,{custom:w,children:(0,y.tZ)(gl.E.div,{className:"banner",variants:x,initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:95,damping:14},opacity:{duration:.5}},custom:w,children:null!=_&&_.link?(0,y.tZ)(h.A,{href:null==_?void 0:_.link,newTab:"auto",children:k}):k},f)}),l.length>0&&(0,y.tZ)("div",{className:"ghost-banner",children:l.map(((e,i)=>{const n=(0,v.tq)()?e.img_mobile||e.img_desktop:e.img_desktop||e.img_mobile;return(0,y.tZ)("img",{src:c.g.func.imgUrl(n,t.domain_id)},i)}))}),l.length>1&&(0,y.BX)("div",{className:"_controls",children:[(0,y.BX)("div",{className:"near _ctrl",children:[(0,y.tZ)("div",{className:"_arrow near",onClick:()=>g((l.length+d-1)%l.length),children:(0,y.tZ)(b.JO,{smallButtonLike:!0,icon:"arrow_near"})}),!u&&(0,y.tZ)("div",{className:"_toggle-play",onClick:()=>m(!0),children:(0,y.tZ)(b.JO,{smallButtonLike:!0,icon:"play"})}),u&&(0,y.tZ)("div",{className:"_toggle-play",onClick:()=>m(!1),children:(0,y.tZ)(b.JO,{smallButtonLike:!0,icon:"pause"})})]}),(0,y.tZ)("div",{className:"middle _ctrl",children:(0,y.tZ)("div",{className:"_bullets",children:l.map(((e,t)=>(0,y.tZ)(b.gT,{onClick:()=>g(t),color:t===d?c.g.colors.dominant_main:c.g.colors.separator,size:t===d?"25px":"15px"},t)))})}),(0,y.tZ)("div",{className:"far _ctrl",children:(0,y.tZ)("div",{className:"_arrow far",onClick:()=>g((d+1)%l.length),children:(0,y.tZ)(b.JO,{smallButtonLike:!0,icon:"arrow_far"})})})]})]})}));Blsm.Globals={...Blsm.Globals,PortalView:fl,PortalStore:dl.AX};var xl=i(5367),kl=i(8904);class Zl extends m.I{constructor(e){super(e),this.moveSubPortal=e.moveSubPortal;const{parent_id:t,portal_id:i,portal_type:n}=e.subPortal;let r=n||[dl.Bu.GROUP,dl.Bu.DOMAIN];this.title=lng("move to another portal").caps(),this._fields=[{type:"hidden",name:"portal_id",value:i},{type:"single_item",name:"parent_id",label:lng("select portal"),theme:"bright",searchData:(e,i)=>{let{term:n}=e;(0,C.SC)("search/portal",{data:{types:r,term:n,exclude:t},method:"POST"},i)}}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("portal/set_parent",Object.assign(e))}SaveSuccess(){(0,zt.vm)().closeDialog(),this.moveSubPortal({portal_id:this.values.get("portal_id"),parent_id:this.values.get("parent_id")})}}const Cl=(e,t,i)=>{let n=e.title;return i===e.portal_id&&e.portal_id!==t.portal_id&&(n=n+" - "+t.title),n},Sl=(0,l.iv)(".BasicHeader{margin-bottom:15px;background-color:rgba(255, 255, 255, 0.5);}.actions{text-align:",c.g.far,";}",""),Ol=(0,p.observer)((function(){var e,t;const i=(0,n.useContext)(zt.l9).getStore("portal");(0,v.Ju)(lng("portal"));const{ready:r}=i;if(!r)return(0,y.tZ)(bi.h,{});const{portals:s,activePortalId:o,activePortalStore:a,moveSubPortal:l,addPortalCallback:d,editMode:p}=i,u=null==a?void 0:a.portalToShow,{poster:m,mayEdit:g,showDeactivatedWidgets:f,toggleShowDeactivatedWidgets:w}=u||{},x=s.map((e=>({val:e.portal_id,label:Cl(e,u,o),notActive:!(0,v.P$)(e.portal_active),iconFar:o==e.portal_id&&e.group_id?"enter":null,iconFarLink:e.group_id&&(0,h.p4)({workspace:e.group_id})})));let k=!1;(null==a?void 0:a.subs.length)>0&&(k=[],a.subPortalId&&k.push({val:"..",label:lng("parent").caps()}),k.push(...a.subs.map((e=>({val:e.portal_id,label:e.title})))),k.push({val:"new",label:lng("new sub page")}));const Z=e=>{(0,v.B5)(e)?i.setSubPortalId(e,!0):"new"===e?(0,zt.vm)().openDialog("form",new kl.q({addPortalCallback:d,newPortalInfo:{portal_type:dl.Bu.SUB,parent_id:a.portal_id,portal_active:!0}})):".."===e&&i.setSubPortalId(null,!0)};return(0,y.tZ)(dl.rN.Provider,{value:i,children:(0,y.BX)(Et.T,{contBG:!!m,css:Sl,children:[(0,y.tZ)(vi.v7,{headline:Tl(),noGradient:!0,tabs:x.length>1||i._activeSubPortalId||p||null!=u&&u.portal_title||null!=u&&u.group_name?{tabs:x,activeTab:o,onSelect:e=>{i.activePortalId=e,i.subPortalId=null},noCaps:!0}:void 0,actions:(0,y.BX)("div",{className:"mobile_off",children:[Blsm.hasPermission("portal_manager")&&!p&&(0,y.tZ)(_.l,{theme:"contained",onClick:()=>(0,zt.vm)().openDialog("form",new kl.q({addPortalCallback:d,allowAnonymous:i.allowAnonymous,newPortalInfo:{portal_type:dl.Bu.DOMAIN}})),children:(0,v.tq)()?lng("create").caps():lng("create portal").caps()}),p&&i.activePortalStore&&(0,y.tZ)(we.zx,{href:{list:"portals",params:{type:(null===(e=i.activePortalStore)||void 0===e?void 0:e.parent_type)||(null===(t=i.activePortalStore)||void 0===t?void 0:t.portal_type)}},children:lng("manage portals").caps()}),g&&(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.JO,{icon:"trash",buttonLike:!0,toolTip:lng("delete"),onClick:()=>i.deletePortal(u)}),u.parent_id&&(0,y.tZ)(b.JO,{icon:"AssignOutsource",buttonLike:!0,toolTip:lng("move"),onClick:()=>(0,zt.vm)().openDialog("form",new Zl({subPortal:u,moveSubPortal:l}))}),u.mayAddSubPortal&&(k?(0,y.tZ)(R.x,{options:k,onSelect:Z,children:(0,y.tZ)(b.JO,{icon:"reply_all",buttonLike:!0})}):(0,y.tZ)(b.JO,{icon:"reply_all",buttonLike:!0,toolTip:lng("new sub page"),onClick:()=>Z("new")})),(0,y.tZ)(b.JO,{icon:"settings",toolTip:lng("settings"),buttonLike:!0,onClick:()=>(0,zt.vm)().openDialog("form",new xl.S({portalStore:u}))}),u.mayHideWidgets&&(0,y.tZ)(b.JO,{icon:"preview",toolTip:lng("show hidden widgets"),buttonLike:!0,color:f?c.g.colors.dominant_main:void 0,onClick:w}),(0,y.tZ)(b.JO,{icon:"new",toolTip:lng("add widget"),buttonLike:!0,onClick:()=>(0,zt.vm)().openDialog("TypeSelector",(0,ul.Y)(u))})]})]})}),a&&u&&(0,y.tZ)(Bl,{portalToShow:u})]})})})),Bl=(0,p.observer)((e=>{let{portalToShow:t}=e;return t.loaded?(0,y.tZ)(fl,{portalStore:t}):(0,y.tZ)(ge.$,{})})),Tl=()=>{const e=(0,v.v2)(Blsm.user),t=(new Date).getHours();let i;return i=t>=21||t<=4?lng("good night %s",e):t>=5&&t<=11?lng("good morning %s",e):t>=12&&t<=14?lng("good day %s",e):t>=15&&t<=17?lng("good afternoon %s",e):lng("good evening %s",e),i.caps()},Nl=(0,l.iv)("",""),Il=(0,p.observer)((function(e){var t,i;let{store:r,onClose:s}=e;const o=(0,n.useRef)(null);return(0,y.tZ)(Ft.d,{scroll:!0,onClose:s,ref:o,size:"100%",children:(0,y.tZ)("div",{css:Nl,children:(0,y.tZ)(Mt.W2,{head:(0,y.tZ)(Mt.$0,{icon:"menu_overview",title:null===(t=r.data)||void 0===t?void 0:t.assignment_name,onClose:()=>o.current.close()}),stickyHead:!0,children:r.ready?(null===(i=r.subs)||void 0===i?void 0:i.length)>0?(0,y.tZ)(Cn.Mz,{assignments:r.subs}):(0,y.tZ)(Wr.M,{title:lng("there is nothing here"),subTitle:lng("this master assignment is empty"),icon:"empty_cart"}):(0,y.tZ)(ge.$,{})})})})})),Dl=(0,l.iv)(c.g.classes.content_width,";",""),jl=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("category_tree"),t=[{val:0,label:lng("domain categories")},{val:1,label:lng("global categories")}];(0,v.Ju)("category tree"),(0,n.useEffect)((()=>{const t=document.querySelector(`.cat_${e._tree.lastSon}`);t&&t.scrollIntoView({behavior:"smooth",block:"center"})}),[e.tree]);const{ready:i}=e;if(!i)return(0,y.tZ)(bi.h,{});const r=e=>e.path.split(".").filter((e=>e)).length>1;return(0,y.BX)(Et.T,{children:[(0,y.tZ)(vi.v7,{headline:lng("category tree"),tabs:Blsm.user.isAdmin?{tabs:t,activeTab:e.tab,onSelect:t=>e.setTab(t)}:void 0,actions:(0,y.tZ)(b.JO,{icon:"new",toolTip:lng("add top level category").caps(),onClick:e.addParentCategory})}),(0,y.tZ)("div",{css:Dl,children:(0,y.tZ)(Je.hM,{tree:e.tree,sortable:!0,onNodeMove:e.moveNode,mayEdit:!0,buttons:(t,i)=>[{icon:"new",label:lng("add new sub category").caps(),onClick:t=>e.addCategory(t)},{icon:"edit",label:r(i)?lng("edit sub category").caps():lng("edit category").caps(),onClick:t=>e.editCategory(t)},{icon:"trash",label:r(i)?lng("delete sub category").caps():lng("delete category").caps(),onClick:t=>e.deleteCategory(t)}]})})]})}));const Pl=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("resourceplanning"),{ready:t,calendarRef:i,viewTypes:r,viewType:s,allUses:o,type:a,title:l,getEvents:c,eventClick:d,name:p,todayDisabled:u,updateFromFC:m,fcTitle:g,changeDate:h}=e;return t?(0,y.BX)(Et.T,{internalScrolling:!0,children:[(0,y.tZ)(vi.v7,{headline:l}),(0,y.BX)(_s.Z,{side:(0,y.tZ)(El,{allUses:o,name:p,changeDate:h,type:a}),children:[(0,y.tZ)(Ys.A,{title:(0,y.tZ)("b",{children:g}),goPrev:()=>i.current.prev(),goNext:()=>i.current.next(),goToday:!u&&(()=>i.current.today()),viewType:s,onChangeViewType:t=>(e.viewType=t,i.current[t]())}),(0,y.tZ)(Ks,{noHeader:!0,ref:i,onChange:m,initialDate:"",viewType:r[s],events:c,eventClick:d})]})]}):(0,y.tZ)(bi.h,{})})),zl={name:"umwchj",styles:"overflow-y:auto"},El=(0,p.observer)((function(e){let{type:t,allUses:i,changeDate:n,name:r}=e;return(0,y.BX)("div",{css:zl,children:[(0,y.tZ)("b",{children:r}),"resource"===t&&(0,y.tZ)(Rl,{resourceUses:i,changeDate:n}),"bundle"===t&&(0,y.tZ)(Fl,{bundleUses:i,changeDate:n})]})})),Rl=(0,p.observer)((function(e){let{resourceUses:t,changeDate:i}=e;const n=[{title:lng("name"),sortVal:"assignment_name",input:"text"},{title:lng("time"),sortVal:"start_date",input:"text"},{title:lng("amount"),sortVal:"amount_in_use",input:"text"},{title:lng("capacity"),sortVal:"resource_capacity",input:"text"}],r=(0,p.observer)((function(e){let{row:t}=e;const{assignment_name:n,start_date:r,amount_in_use:s,resource_capacity:o}=t;return(0,y.BX)("tr",{onClick:()=>i(r),children:[(0,y.tZ)(xe.U6,{children:n}),(0,y.tZ)("td",{children:(0,y.tZ)(Ce.qp,{time:r})}),(0,y.tZ)("td",{children:s}),(0,y.tZ)("td",{children:o})]})}));return(0,y.tZ)("div",{children:(0,y.tZ)(ye.iA,{cols:n,collection:t,rowIdCol:"assignment_id",loading:null===t,RowRenderer:r,compact:!0,noWindow:!0})})})),Fl=(0,p.observer)((function(e){let{bundleUses:t}=e;const i=[{title:lng("name")},{title:lng("description")},{title:lng("category")},{title:lng("email")},{title:lng("location")},{title:lng("amount")},{title:lng("capacity")},{title:""}],n=(0,p.observer)((function(e){let{row:t}=e;const{resource_name:i,group_name:n,description:r,category_name:s,resource_email:o,resource_location:a,resource_amount:l,resource_capacity:c,resource_id:d}=t;return(0,y.BX)("tr",{children:[(0,y.tZ)(xe.U6,{children:i||n}),(0,y.tZ)(xe.FS,{text:r}),(0,y.tZ)("td",{children:s}),(0,y.tZ)("td",{children:o}),(0,y.tZ)("td",{children:a}),(0,y.tZ)("td",{children:l}),(0,y.tZ)("td",{children:c}),(0,y.tZ)("td",{children:(0,y.tZ)(b.JO,{icon:"calendar",buttonLike:!0,toolTip:lng("view schedule").caps(),onClick:()=>(0,h.p4)({resourcePlanning:d,type:"resource"},!0)})})]})}));return(0,y.tZ)("div",{children:(0,y.tZ)(ye.iA,{cols:i,collection:t,rowIdCol:"resource_id",loading:null===t,RowRenderer:n,compact:!0,noWindow:!0})})}));var Ml=i(4943);const Al=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("yearly");return(0,v.Ju)(lng("yearly calendar")),(0,y.tZ)(Ml.b.Provider,{value:e,children:(0,y.tZ)(Et.T,{children:e.ready?(0,y.BX)("div",{children:[(0,y.tZ)(vi.v7,{headline:lng("yearly calendar view"),actions:(0,y.BX)(y.HY,{children:[(0,y.tZ)(_.l,{className:"mobile_off",children:(0,y.tZ)(b.JO,{icon:"arrow_near",onClick:()=>e.moveYear("down")})}),(0,y.tZ)("div",{className:"current-year",children:e.year}),(0,y.tZ)(_.l,{className:"mobile_off",children:(0,y.tZ)(b.JO,{icon:"arrow_far",onClick:()=>e.moveYear("up")})})]})}),(0,y.tZ)(_s.Q,{children:(0,y.tZ)(An.v,{curYear:e.year,eventsArray:e.eventsArray})})]}):(0,y.tZ)(ge.$,{})})})}));const ql={name:"ug2nip",styles:"padding:20px 30px 0;min-height:300px;text-align:center;white-space:nowrap;&:before{content:'';display:inline-block;height:100%;vertical-align:middle;margin-right:-0.25em;}>iframe{display:inline-block;vertical-align:middle;width:100%;height:65vh;}"},Xl=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("t2k_echo"),{url:t,post:i,ready:r}=e;(0,v.Ju)("t2k echo");let s=[];if(!r)return(0,y.tZ)(bi.h,{});for(const e in i)s.push({key:e,value:i[e]});return(0,y.tZ)(Et.T,{bottomPadding:!0,children:(0,y.BX)("div",{css:ql,children:[(0,y.tZ)(vi.v7,{headline:(0,y.BX)(y.HY,{children:[(0,y.tZ)(b.JO,{icon:"light_bulb"})," ",lng("Instructor Insights|timetoknow")]})}),(0,y.tZ)("form",{ref:e=>null==e?void 0:e.submit(),method:"post",target:"t2k_echo_iframe",action:t,children:s.map(((e,t)=>(0,y.tZ)("input",{type:"hidden",name:e.key,defaultValue:e.value},t)))}),(0,y.tZ)("iframe",{width:"100%",height:"auto",name:"t2k_echo_iframe",allowFullScreen:!0,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen"})]})})}));var Ll,$l,Vl=i(5762),Ul=i(6946);var Hl={name:"nb756s",styles:"width:200px;height:50px;font-size:1.4em;padding:10px;margin-top:2rem"},Jl={name:"1v5a6de",styles:"width:fit-content;margin:0 auto"};let Gl=(Ll=class extends m.I{constructor(e){super(e),function(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}(this,"currentTab",$l,this),(0,g.makeObservable)(this);const{playlist:t={}}=e;this.playlist=t,this.playlistId=t.id,this.onSaveSuccess=t.onSaveSuccess,this.confirmButtonLabel=!1,this.onTabsChange("explore"),this.values.set("new",!1),this.onItemSelect=e=>{const t=this.values.get("ids");if(t){const i=t.find((t=>t===e));return this.values.set("ids",i?t.filter((t=>t!==e)):[e,...t])}return this.values.set("ids",[e])},this.changeView=e=>{this.values.set("new",!e),this.title=!1===e?lng("add to").caps():lng("create new playlist").caps()},this.clearForm=()=>{this.values.set("skills",[]),["lesson_id","lesson_name","lesson_description","lesson_data","lessonfile","lessonfile_url","file_attach_type","extern_iframe"].forEach((e=>this.values.set(e,void 0))),this.onTabsChange("explore")},this.buildFields()}buildFields(){this._fields=[{type:"component",name:"sub_tabs",Render:Ql,props:{tabs:[{icon:"telescope",title:lng("explore content").caps(),name:"explore"},{icon:"sign_plus",title:lng("create new content").caps(),name:"create"}],onChange:e=>this.currentTab=e,current:()=>this.currentTab}},{type:"row_set",visible:()=>"create"===this.currentTab,fields:[{type:"component",node:(0,y.tZ)("div",{children:lng("mode").caps()+":"})},{type:"radio",name:"file_attach_type",radioValue:"upload",label:lng("upload"),value:"upload"},{type:"radio",name:"file_attach_type",radioValue:"external",label:lng("link")},{type:"radio",name:"file_attach_type",radioValue:"text",label:lng("text")}]},{type:"text",name:"lesson_name",label:lng("name"),visible:()=>"create"===this.currentTab,required:()=>"create"===this.currentTab},{type:"richtext",name:"lesson_description",label:lng("description"),toolbarOptions:{font:!0,color:!0,link:!0,list:!0,align:!0},visible:()=>"create"===this.currentTab},{type:"checkbox",name:"extern_iframe",label:`${lng("in frame")} (${lng("optional")})`,visible:()=>"external"===this.values.get("file_attach_type"),value:!0,checkboxValue:!0},{type:"text",name:"lessonfile_url",label:lng("content link"),visible:()=>"external"===this.values.get("file_attach_type")&&"create"===this.currentTab,required:()=>"external"===this.values.get("file_attach_type")},{type:"file",name:"lessonfile",label:lng("content file").caps(),maxSize:Blsm.InitialData.parameters.max_file_size.content,visible:()=>"upload"===this.values.get("file_attach_type")&&"create"===this.currentTab,required:()=>"upload"===this.values.get("file_attach_type")},{type:"richtext",name:"lesson_data",label:lng("text").caps(),toolbarOptions:{font:!0,color:!0,link:!0,media:!0,media_link:!0,list:!0,align:!0},visible:()=>"text"===this.values.get("file_attach_type")&&"create"===this.currentTab,required:()=>"text"===this.values.get("file_attach_type")},{type:"multiple_items",name:"skills",label:lng("skills"),showId:!1,theme:"bright",valueIsMap:!0,objectKeys:["id","label","skill_level"],insert:Blsm.isFeatureEnabled("skills_occupations"),visible:()=>"create"===this.currentTab,buttons:[{Render:Ul.EU}],searchData:(e,t)=>{(0,C.SC)("skills/autocomplete_skill",{data:{term:e.term||"",id:e.ids||""}},t)}},{type:"component",node:(0,y.tZ)("div",{css:Jl,children:(0,y.tZ)(_.l,{css:Hl,theme:"contained",onClick:()=>ic(this,this.clearForm),children:lng("add to playlist").caps()})}),visible:()=>"create"===this.currentTab},{type:"single_item",name:"lesson_id",label:lng("type the content name that you want to add").caps(),poster:!0,visible:()=>"explore"===this.currentTab,required:()=>"explore"===this.currentTab,searchData:(e,t)=>{let{term:i,ids:n}=e;(0,C.SC)("content",{data:{term:i,id:n}},t)}},{type:"component",Render:Kl,props:this,visible:()=>"explore"===this.currentTab}],this._prepFields(),this.ready=!0}onTabsChange(e){this.currentTab=e}},$l=function(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}(Ll.prototype,"currentTab",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ll);var Wl={name:"1rx5oht",styles:"width:200px;height:50px;font-size:1.4em;padding:10px"};const Kl=(0,p.observer)((function(e){const t=e.values.get("lesson_id");return(0,y.BX)("div",{css:Yl,children:[(0,y.tZ)(b.JO,{className:"search-icon",icon:"search"}),(0,y.tZ)("h1",{children:lng("start searching in order to add content").caps()}),(0,y.tZ)("span",{children:lng("type your desired content").caps()}),t?(0,y.tZ)(_.l,{css:Wl,theme:"contained",onClick:()=>ic(e,e.clearForm),children:lng("add to playlist").caps()}):(0,y.tZ)(_.l,{theme:"outlined",href:{catalog:!0},children:lng("or add from knowledge center").caps()})]})})),Yl=(0,l.iv)("text-align:center;>a{padding:10px;}>span{margin-bottom:50px;display:block;font-size:1.2em;color:",c.g.colors.text_sec,";}>.search-icon{color:",c.g.colors.dark_blue,";margin-top:50px;font-size:100px;}",""),Ql=(0,p.observer)((function(e){let{tabs:t,onChange:i,current:n}=e;return(0,y.tZ)("div",{css:tc,children:t.map(((e,t)=>{let{icon:r,title:s,name:o}=e;return(0,y.BX)("div",{onClick:()=>i(o),css:ec(n()===o),children:[r&&(0,y.tZ)(b.JO,{icon:r})," ",(0,y.tZ)("span",{children:s})]},t)}))})})),ec=e=>(0,l.iv)("color:",e?c.g.colors.dominant_main:c.g.colors.text_sec,";border-bottom:",e?"1px solid "+c.g.colors.dominant_main:"none",";padding:10px;>span{",c.g.classes.margin_near("10px"),";font-size:1.4em;font-weight:600;}",""),tc={name:"dhweq7",styles:"display:flex;justify-content:space-around;&:hover{cursor:pointer;}"};function ic(e,t){const i=e.playlist,n=e.currentTab;let r;if("create"===n){var s,o;if(null!==(s=e.fileList)&&void 0!==s&&s.some((e=>""===e.temp_name)))return void(0,Ze.qR)(lng("please wait for all uploads to complete.").caps());const t=null===(o=e.fileList)||void 0===o?void 0:o.map((e=>({temp_name:e.temp_name,name:e.file_name}))).filter((e=>{var t;return(null===(t=e.temp_name)||void 0===t?void 0:t.length)>0}));let i=[];const n=e.values.get("skills");n&&(0,v.Nw)(n)&&n.forEach((e=>i.push(e))),r={playlist_id:e._id||e.playlistId,lesson_id:e.values.get("lesson_id"),lesson_name:e.values.get("lesson_name"),lesson_description:e.values.get("lesson_description"),lesson_data:e.values.get("lesson_data"),skills:i,lessonfile:e.values.get("lessonfile"),lessonfile_url:e.values.get("lessonfile_url"),file_attach_type:e.values.get("file_attach_type"),extern_iframe:e.values.get("extern_iframe"),assign_to_domain:!0,dnduploadfiles:t}}"explore"===n&&(r={playlist_id:e.playlistId,lesson_id:e.values.get("lesson_id"),file_attach_type:"select"}),(0,C.SC)("channel/create_playlist_item",{method:"POST",data:r},(e=>{var n,r;return i.onAddItem(e),t(),null===(n=(0,zt.vm)().selfUserStore)||void 0===n||null===(r=n.channelStore)||void 0===r||r.invalidate(),(0,be.qV)(lng("content added successfully"))}))}var nc={name:"1w03b31",styles:"display:flex;.Button{margin:0 auto;}"};class rc extends m.I{constructor(e){super(),(0,g.makeObservable)(this);const{onSaveSuccess:t,playStore:i}=e,{playlist:n={}}=i;this.playStore=i,this.onSaveSuccess=t,this.initialValues={...n._attr,skills:[...n.skills]},this.playlist_id=this.initialValues.playlist_id,this.channel_Id=this.initialValues.channel_Id,this.title=!1,this.buildFields(),this._prepFields(this.initialValues),this.ready=!0}buildFields(){this._fields=[{type:"text",name:"playlist_name",label:lng("name"),required:!0,maxLength:200,value:this.playStore.title},{type:"checkbox",name:"status",label:lng("active"),value:this.playStore.status},{type:"component",node:(0,y.tZ)("div",{css:nc,children:(0,y.tZ)(_.l,{theme:"contained",onClick:()=>this.saveEdit(this.values),children:lng("save").caps()})})}]}saveEdit(e){const t=e.get("playlist_name"),i=e.get("status")?1:0;(0,C.SC)("channel/edit_playlist_details",{data:{playlist_name:t,status:i,channel_id:this.channel_id,playlist_id:this.playlist_id},method:"POST"},(()=>{var e,n;return this.onSaveSuccess(),this.playStore.updatePlaylist({title:t,status:i}),null===(e=(0,zt.vm)().selfUserStore)||void 0===e||null===(n=e.channelStore)||void 0===n||n.invalidate(),(0,be.qV)(lng("updated successfully"))}))}}const sc=(0,p.observer)((()=>{const e=(0,n.useContext)(zt.l9).getStore("play");(0,v.Ju)(lng("dashboard"));const{ready:t,editDetailsDrawer:i}=e;return t?(0,y.tZ)(Et.T,{children:(0,y.BX)(dt.c_,{children:[(0,y.tZ)(lc,{}),(0,y.tZ)(pc,{}),i&&(0,y.tZ)(cc,{})]})}):(0,y.tZ)(bi.h,{})})),oc=(0,l.iv)("min-width:400px;",c.g.classes.border_far(`1px solid ${c.g.colors.separator}`),";min-height:calc(100vh - ",c.g.consts.TOP_BAR_HEIGHT,"px);.content-list{height:100vh;overflow-y:scroll;}.list-header{margin:10px 20px;.back-to-btn{margin:10px 0;}.header-title{display:flex;justify-content:space-between;align-items:center;.Icon{color:",c.g.colors.text_sec,";&:hover{cursor:pointer;}}}}","");var ac={name:"u34rzg",styles:"border-radius:50px"};const lc=(0,p.observer)((()=>{var e;const t=(0,n.useContext)(zt.l9).getStore("play"),{playlist:i,listId:r,playlistTitle:s,playlistItems:o}=t;let a,l=[];return null==o||o.forEach(((e,i)=>{const{assignment_id:n,assignment_name:r,lesson_name:s,assignment_image:o}=e._attr,c={...e,key:i,id:n,poster:o,label:r||s,mayEdit:parseInt(e._attr.owner_id)===parseInt(Blsm.user.id),active:n===t.activePlayItem};n===t.activePlayItem&&(a=i+1),l.push(c)})),t.activePlayItem&&(t.nextItemId=null===(e=l[a>=l.length?0:a])||void 0===e?void 0:e.id),(0,y.BX)("div",{css:oc,children:[(0,y.BX)("div",{className:"list-header",children:[(0,y.tZ)(_.l,{className:"back-to-btn",theme:"contained",onClick:()=>{t.createMode=!1,(0,h.p4)({user:i._attr.owner_id,tab:"channel"},!0)},children:lng("go to channel").caps()}),(0,y.BX)("div",{className:"header-title",onClick:()=>t.toggleEditPlaylistDetails(),children:[(0,y.tZ)("h2",{className:"title",children:s}),(0,y.tZ)(b.JO,{icon:"settings",buttonLike:!0})]}),(0,y.tZ)("h4",{children:i._attr.owner_name.caps()}),(0,y.tZ)("div",{children:(0,y.BX)(_.l,{css:ac,theme:"contained",chunky:!0,bold:!0,onClick:()=>t.toggleCreateMode(),children:[(0,y.tZ)(b.JO,{icon:"mark_plus"})," ",lng("create new content").caps()]})})]}),(0,y.tZ)("div",{className:"content-list",children:(0,y.tZ)(kn.b,{onSort:e=>{let{new_order:i}=e;return n=i,t.setItemsOrder(n),(0,C.SC)("channel/playlist_ordering",{method:"POST",data:{ordering:n,playlist_id:r}});var n},children:l.map((e=>(0,y.tZ)(uc,{item:e,listId:r,active:e.active,playlist:i},e.id)))})})]})})),cc=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9).getStore("play"),t=(0,n.useRef)(null),i=(0,n.useRef)(new rc({playStore:e,onSaveSuccess:()=>t.current.close()})).current;return(0,y.tZ)(Ft.d,{size:"600px",from:"side",onClose:()=>e.toggleEditPlaylistDetails(),ref:t,scroll:!0,children:(0,y.tZ)(Mt.W2,{head:(0,y.tZ)(Mt.$0,{title:"edit playlist",icon:"edit",onClose:()=>t.current.close(),stickyHead:!0}),children:(0,y.tZ)(m.q3.Provider,{value:i,children:(0,y.tZ)(nt.l,{form:i,internalForm:!0,type:"inline"})})})})})),dc=(0,l.iv)("padding:20px;flex-grow:1;.new-item-form{width:800px;margin:0 auto;}.launcher-iframe{background-color:",c.g.colors.disabled_background,";vertical-align:bottom;border:0;box-shadow:0 0 3px ",c.g.colors.separator,";&.empty{text-align:center;font-size:2em;color:white;padding-top:20%;}}>.bottom{padding:25px 15px;>.description{font-size:1.1em;color:",c.g.colors.disabled_text,";font-weight:550;}>.toolbar{display:flex;justify-content:space-between;>.info{display:flex;flex-direction:column;>.title{font-size:1.8rem;font-weight:600;padding-bottom:10px;}>.time{margin:10px 0;}}>.buttons{>div{display:flex;}}}>.comments{padding-top:30px;",c.g.classes.padding_near("10px"),";}}.add-to-btn{border-radius:10px;margin:0 8px;}.next-btn{margin:0 8px;}",""),pc=(0,p.observer)((()=>{var e;const t=(0,n.useContext)(zt.l9),i=t.getStore("play"),{playlist:r,assignmentPlaying:s={}}=i,o=null==s||null===(e=s.commentsInfo)||void 0===e?void 0:e.connect,{assignment_id:a,title:l,commentsInfo:d,description:p,views:u,bookmarked:g,mayLike:w,isAssignmentCommentsLock:x,mayEditCommetns:k,mayDeleteComments:C,_attr:S}=s,O=null==S?void 0:S.skills;(0,Z.iP)();const B=(0,n.useRef)(new Gl({playlist:r})).current;return(0,y.tZ)("div",{css:dc,children:a&&!i.createMode?(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{css:c.g.classes.iframeVideoSize,children:(0,y.tZ)("iframe",{className:"launcher-iframe",src:(0,h.p4)({launcher:"assignment",id:i.activePlayItem,iframe:!0}),allowFullScreen:!0,allow:"microphone *; camera *; fullscreen *; autoplay *"})}),(0,y.BX)("div",{className:"bottom",children:[(0,y.BX)("div",{className:"toolbar",children:[(0,y.BX)("div",{className:"info",children:[(0,y.tZ)("span",{className:"title",children:l}),O&&(0,y.tZ)(pt.r$,{children:O.map((e=>(0,y.tZ)(pt.Vp,{tag:e.label,color:(0,Ts.r0)(e.skill_level).color,smaller:!0,tooltip:e.description},e.id)))}),u>0&&(0,y.BX)("span",{children:[(0,y.tZ)(b.JO,{icon:"user"})," ",(0,v.lo)(u)," ",lng("views")]}),(0,y.tZ)(Ce.qp,{className:"time",time:S.creation_time,showTime:!1})]}),(0,y.tZ)("div",{className:"buttons",children:(0,y.BX)("div",{children:[(0,y.BX)(_.l,{className:"next-btn",theme:"outlined",onClick:()=>(i.assignmentId=i.nextItemId,i.activePlayItem=i.nextItemId),children:[lng("next").caps()," ",(0,y.tZ)(b.JO,{icon:"arrow_to_right"})]}),(0,y.tZ)("div",{style:{fontSize:"1.5rem"},children:(0,v.DM)(g)&&(0,y.tZ)(ni.rp,{entity:s,onClick:()=>{var e;return null===(e=s.toggleBookmark)||void 0===e?void 0:e.call(s)}})}),(0,y.tZ)("div",{style:{fontSize:"1.5rem",margin:"0 8px"},children:w&&(0,y.tZ)(ni.dR,{entity:s,onClick:()=>{var e;return null===(e=s.toggleLike)||void 0===e?void 0:e.call(s)}})}),(0,y.tZ)("div",{style:{fontSize:"1.5rem",margin:"0 8px"},children:(0,y.tZ)(b.JO,{color:i.displayComments?c.g.colors.dominant_main:"",onClick:()=>i.toggleComments(),badge:d.count,icon:"discussion"})}),(0,y.tZ)(_.l,{className:"add-to-btn",theme:"contained",onClick:()=>r.onItemMove(s.assignment_id,r.id),children:lng("add to").caps()})]})})]}),(0,y.tZ)("div",{className:"description",children:p.isHtml?(0,y.tZ)(f.xn,{content:null==p?void 0:p.text}):(0,y.tZ)("div",{children:null==p?void 0:p.text})}),i.displayComments&&(0,y.tZ)("div",{className:"comments",children:(0,y.tZ)(J.H,{commentsStore:t.getStore("comments",o),connectTo:o,locked:x,editable:k,deletable:C})})]})]}):i.createMode?(0,y.tZ)("div",{className:"new-item-form",children:(0,y.tZ)(m.q3.Provider,{value:B,children:(0,y.tZ)(nt.l,{form:B,internalForm:!0,type:"inline"})})}):(0,y.tZ)("div",{css:c.g.classes.iframeVideoSize,children:(0,y.tZ)("div",{className:"launcher-iframe empty MediaPlayer",children:lng("nothing to show").caps()})})})})),uc=e=>(0,y.tZ)(Vl.SV,{children:(0,y.tZ)(mc,{...e})}),mc=(0,p.observer)((function(e){let{item:t,listId:i,active:r,playlist:s}=e;const o=(0,n.useContext)(kn.y),a=(0,n.useContext)(zt.l9).getStore("play"),l=t._attr,d=l.assignment_name?l.assignment_name:l.lesson_name,p="File"===l.type_title&&""===l.lesson_file_type?"Link":l.type_title,u=l.owner_full_name;return(0,y.tZ)(h.A,{href:{play:l.assignment_id,playlist:i},onClick:()=>a.toggleCreateMode(!1),children:(0,y.BX)("div",{css:gc(t.poster,r),className:"playlist-item",children:[(0,y.tZ)("div",{className:"item-state",children:o&&(0,y.tZ)("span",{...o.attributes,...o.listeners,children:(0,y.tZ)(b.JO,{iconClass:"state-icon",icon:r?"play":"equals",color:r?c.g.colors.dominant_main:c.g.colors.disabled_text})})}),(0,y.BX)("div",{className:"item-poster-type",children:[(0,y.tZ)("div",{className:"item-poster"}),(0,y.tZ)("div",{className:"item-type",children:p&&(0,y.tZ)("div",{className:"item-type-title",css:c.g.classes.content_type_style,children:p.caps()})})]}),(0,y.BX)("div",{className:"title-author",children:[(0,y.tZ)("div",{className:"item-title",children:d}),(0,y.tZ)("div",{className:"item-author",children:u})]}),(0,y.tZ)("div",{className:"item-actions invisible",children:s.menuOptions&&(0,y.tZ)(R.x,{className:"actions",options:s.menuOptions(t.id),children:(0,y.tZ)(b.JO,{color:c.g.colors.text_main,icon:"menu_h",buttonLike:!0})})})]})})})),gc=(e,t)=>(0,l.iv)("display:flex;height:115px;justify-content:space-around;overflow-y:scroll;background-color:",t?c.g.colors.background_dark:"",";padding:10px 0;margin:5px 0;.invisible{visibility:hidden;display:flex;align-items:center;}&:hover,&.item-selected{.invisible{visibility:visible;}}.item-actions{display:flex;justify-content:space-between;.actions{align-self:start;}}.item-state{align-self:center;font-size:25px;width:3%;}.item-poster-type{display:flex;flex-direction:column;.item-type{width:100%;border-radius:0;.item-type-title{width:100px;text-align:center;}}.item-poster{width:100px;height:100%;background-repeat:no-repeat;background-size:cover;background-position:center top;background-image:url(",e,");}}.title-author{text-align:",c.g.near,";width:50%;padding:10px;display:flex;flex-direction:column;justify-content:space-evenly;.item-title{font-weight:700;}}>span{align-self:center;}","");var hc=i(7787);const bc=(0,n.lazy)((()=>i.e(583).then(i.bind(i,6678)).then((e=>({default:e.TestPage}))))),vc=(0,n.lazy)((()=>i.e(263).then(i.bind(i,1774)).then((e=>({default:e.ReportsPage}))))),_c={home:sl.U,messages:ja,calendar:Ua,edit:ur,list:mr.q,sql:Ka,search:Ya,import:rl,reports:vc,dashboard:cl,cregistration:eo,catalog:_o,library:So,portal:Ol,category_tree:jl,resourceplanning:Pl,yearly:Al,challenges:ia,t2k_echo:Xl,play:sc,tasks:hc.k,test:bc},fc=(0,p.observer)((function(){return(0,y.BX)(y.HY,{children:[(0,y.tZ)(Rt.bg,{children:(0,y.tZ)(yc,{})}),(0,y.tZ)(wc,{})]})})),yc=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9),[t]=e.mainRoute,i=_c[t];if(i)return(0,y.tZ)(n.Suspense,{fallback:(0,y.tZ)(ge.$,{}),children:(0,y.tZ)(i,{})});switch(t){case"groups":return e.mainRoute[1]?(0,v.B5)(e.mainRoute[1])?(location.replace((location.href+"").replace("#groups","#workspace")),null):(0,y.tZ)(Et.T,{children:(0,y.tZ)("div",{style:{textAlign:"center",border:"1px solid red"},children:lng("invalid URL").caps()})}):(location.replace((location.href+"").replace(/#.*/,"#home")),null);case"workspace":{const t=e.mainRoute[1];if("personal"===t)return(0,y.tZ)(cr,{});if((0,v.B5)(t))return(0,y.tZ)(ir,{id:t})}break;case"user":{const t=e.mainRoute[1];if((0,v.B5)(t))return(0,y.tZ)(xa,{id:t})}}return e.overlayRoute.length>0?null:(0,y.tZ)(Et.T,{children:(0,y.BX)("div",{style:{textAlign:"center",border:"1px solid red"},children:[e.mainRoute.join("/")," - not found!"]})})})),wc=(0,p.observer)((function(){const e=(0,n.useContext)(zt.l9),[t]=e.overlayRoute;switch(t){case"edit":return(0,y.tZ)(Rt.bg,{children:(0,y.tZ)(ur,{onDialogClose:()=>e.closeOverlay()})});case"master":{const[t,i,n]=e.overlayRoute,r=()=>e.closeOverlay((0,v.B5)(n)?(0,h.p4)({workspace:n}).slice(1):null);return(0,y.tZ)(Rt.bg,{children:(0,y.tZ)(Il,{store:e.getStore(t,i),onClose:r})})}case"request":{const t=e.overlayRoute[1],i=e.overlayRoute[2];return(0,y.tZ)(Rt.bg,{children:(0,y.tZ)(Gs.G,{edit:!0,request_id:t,user_id:Blsm.user.user_id,ect_id:i,onClose:()=>e.closeOverlay()})})}}return null}));var xc=i(9714),kc=i(8152);const Zc=function(e){let{src:t,controls:i=!0,download:n=!0,autoPlay:r=!1,...s}=e;return(0,y.tZ)("video",{controls:i,autoPlay:r,onContextMenu:n?null:e=>(e.preventDefault(),!1),controlsList:n?"":"nodownload",...s,children:(0,y.tZ)("source",{type:"video/mp4",src:t})})},Cc=(0,p.observer)((function(e){let{meeting:t}=e;const i=[{title:lng("name")},{title:lng("actions")}],{zoomRecordings:n}=t;return(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"item-section-label",children:lng("zoom recordings").caps()}),(0,y.tZ)(ye.iA,{cols:i,collection:n,loading:null===n,RowRenderer:Sc,rowIdCol:"id",rowProps:{meeting:t},compact:!0,noWindow:!0})]})})),Sc=(0,p.observer)((function(e){let{row:t,rowProps:i}=e;const{id:n,count:r}=t,{meeting:s}=i,{mayDeleteZoomRecord:o,deleteZoomRecord:a}=s,l=lng("recording #%s",r).caps(),c=(0,h.p4)({file:{file_id:n}});return(0,y.BX)("tr",{children:[(0,y.tZ)("td",{children:l}),(0,y.BX)(xe.jA,{children:[(null==o?void 0:o())&&(0,y.tZ)(b.JO,{icon:"trash",buttonLike:!0,onClick:()=>a(t)}),Blsm.user.isPowerManager&&(0,y.tZ)(b.JO,{icon:"download",buttonLike:!0,toolTip:lng("download"),href:c,newTab:!0}),(0,y.tZ)(b.JO,{icon:"play",buttonLike:!0,onClick:()=>(0,Ze.qR)((0,y.tZ)(Zc,{autoPlay:!0,width:"100%",download:!1,src:c}),{title:l,width:"40vw",closeText:lng("close")})})]})]})})),Oc=(0,l.iv)("padding:0 10px 40px;._tags{margin:10px 0;}._attribute{margin-bottom:5px;._label{font-weight:600;}}._warnings{color:",c.g.colors.warning,";}._section{margin-top:40px;margin-bottom:15px;}._section_label{font-size:1.2em;font-weight:600;margin-top:30px;margin-bottom:10px;}._instructors{display:flex;>div{display:flex;align-items:center;",c.g.classes.margin_far("12px"),";>div{",c.g.classes.margin_far("6px"),";}}}._coach{display:flex;align-items:center;>span{",c.g.classes.margin_near("5px"),";}}._desc{min-height:100px;background-color:",c.g.colors.bg_2,";padding:10px;border-radius:10px;}",""),Bc=(0,p.observer)((e=>{var t,i,n,r,s,o,a,l,d,p,u,m,g;let{item:v}=e;const{dateNote:w}=v,x=null===(t=v.dependencies)||void 0===t?void 0:t.call(v);return(0,y.BX)("div",{css:Oc,children:[(v.type_title||v.category)&&(0,y.BX)(W.m,{className:"_tags",children:[v.type_title&&(0,y.tZ)("span",{css:c.g.classes.content_type_style,children:v.type_title}),v.type_title&&v.category&&(0,y.tZ)(b.An,{}),v.category&&(0,y.tZ)(kc.W,{category:v.category,category_id:v.category_id})]}),(null==w?void 0:w.date)&&(0,y.BX)("div",{className:"_attribute",children:[(0,y.BX)("span",{className:"_label",children:[(null===(i=w.toolTip)||void 0===i?void 0:i.caps())||lng("date").caps(),": "]}),(0,y.tZ)(Ce.qm,{dateNote:w})]}),v.warnings&&(0,y.tZ)("div",{className:"_attribute _warnings",children:v.warnings}),(null===(n=v._attr)||void 0===n?void 0:n.assignment_score)>0&&(0,y.BX)("div",{className:"_attribute",children:[(0,y.BX)("span",{className:"_label",children:[lng("required score").caps(),":"]})," ",v._attr.assignment_score]}),v.accumulation&&(0,y.tZ)("div",{className:"_attribute",children:v.as_coach?(0,y.BX)(y.HY,{children:[(0,y.BX)("span",{className:"_label",children:[lng("runs required").caps(),":"]})," ",v.accumulation]}):(0,y.BX)(y.HY,{children:[(0,y.BX)("span",{className:"_label",children:[lng("successful runs").caps(),":"]})," ",(0,y.BX)(ut.u,{text:lng("successful runs"),children:[" ",v.successful_runs]}),"/",(0,y.tZ)(ut.u,{text:lng("runs required"),children:v.accumulation})]})}),v.assignment_access_limit>0&&(0,y.tZ)("div",{className:"_attribute",children:(0,y.BX)(y.HY,{children:[(0,y.BX)("span",{className:"_label",children:[lng("access limit").caps(),":"]})," ",(0,y.BX)(ut.u,{text:lng("access limit"),children:[" ",v.running_times]}),"/",(0,y.tZ)(ut.u,{text:lng("access limit"),children:v.assignment_access_limit})]})}),(null==x?void 0:x.length)>0&&(0,y.BX)("div",{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("prerequisites").caps()}),x.map((e=>(0,y.BX)("div",{onClick:()=>v.setActiveComponent(e.assignment_id),children:[(0,y.tZ)(b.JO,{icon:e.satisfied?"sign_ok":"sign_notification",color:e.satisfied?c.g.colors.positive:c.g.colors.negative})," ",(0,y.tZ)(h.A,{theme:"hover",children:e.assignment_name||e.lesson_name})]},e.assignment_id)))]}),(null==v||null===(r=v.locations)||void 0===r?void 0:r.length)>0&&(0,y.tZ)("div",{className:"_section",children:v.locations.map(((e,t)=>(0,y.BX)("div",{className:"_attribute",children:[(0,y.BX)("span",{className:"_label",children:[e.label,":"]})," ",e.value]},t)))}),(null===(s=v.instructors)||void 0===s?void 0:s.length)>0&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("instructors").caps()}),(0,y.tZ)("div",{className:"_instructors",children:v.instructors.map((e=>(0,y.BX)("div",{children:[(0,y.tZ)(mt.qE,{user:e}),(0,y.tZ)("span",{children:e.full_name})]},e.resource_id)))})]}),v.coachUser&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("coach").caps()}),(0,y.BX)("div",{className:"_coach",children:[(0,y.tZ)(mt.qE,{user:v.coachUser}),(0,y.tZ)("span",{children:v.coachUser.full_name})]})]}),(null==v?void 0:v.maySeeResources)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("resources").caps()}),(0,y.tZ)("div",{children:v.resources.map((e=>(0,y.BX)("div",{className:"_attribute",children:[e.resource_name," (",(0,y.tZ)(ut.u,{text:lng("amount in use"),children:e.amount_in_use}),")"]},e.user_id)))})]}),v.maySetSelfAttendance&&(0,y.BX)("div",{children:[(0,y.BX)("div",{className:"_section_label",children:[lng("going").caps(),"?"]}),(0,y.BX)("div",{children:[(0,y.tZ)(_.l,{onClick:()=>v.setAttending("yes"),theme:"yes"===v.attending?"contained":"outlined",children:lng("yes").caps()}),(0,y.tZ)(dt.Zv,{}),(0,y.tZ)(_.l,{onClick:()=>v.setAttending("no"),theme:"no"===v.attending?"contained":"outlined",children:lng("no").caps()})]})]}),(null===(o=v.description)||void 0===o?void 0:o.text)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("description").caps()}),(0,y.tZ)("div",{className:"_desc",children:v.description.isHtml?(0,y.tZ)(f.xn,{content:null===(a=v.description)||void 0===a?void 0:a.text}):(0,y.tZ)("div",{children:null===(l=v.description)||void 0===l?void 0:l.text})})]}),(null===(d=v.gradeInfo)||void 0===d?void 0:d.displayGrade)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:null===(p=v.gradeInfo)||void 0===p?void 0:p.label}),(0,y.tZ)("div",{children:(0,y.tZ)(ut.u,{text:null===(u=v.gradeInfo)||void 0===u?void 0:u.toolTip,children:null===(m=v.gradeInfo)||void 0===m?void 0:m.displayGrade})})]}),(null===(g=v.content)||void 0===g?void 0:g.length)&&(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{className:"_section_label",children:lng("content").caps()}),(0,y.tZ)("div",{children:v.content.map((e=>(0,y.tZ)("div",{children:(0,y.BX)(h.A,{href:e.link,theme:"highlight",children:[(0,y.tZ)(b.JO,{icon:e.icon}),(0,y.tZ)(dt.Zv,{}),e.title]})},e.assignment_id)))})]}),v.onlineUrlCopy&&(0,y.BX)("div",{children:[lng("online meeting link").caps()," ",(0,y.tZ)(On.g,{copy:(0,h.p4)(v.onlineUrlCopy),success:lng("link copied to clipboard"),buttonLike:!0})]}),v.haveZoomRecordings&&(0,y.tZ)(Cc,{meeting:v})]})})),Tc=e=>{let{type:t}=e;return(0,l.iv)("height:100%;.container-children{height:calc(100% - 58px);}.side-display{display:flex;flex-direction:column;height:100%;.item-kind{color:",c.g.colors.entity[t]||c.g.colors.text_black,";}}.side-display-top-head-extra{display:flex;justify-content:space-between;}.side-display-title{display:flex;align-items:center;margin-bottom:20px;}.side-display-tabs{border-bottom:1px solid ",c.g.colors.separator,";}.item-subtitle{padding:0 10px 5px;}.side-display-bottom{margin:0 10% 30px;a{width:100%;}div{white-space:normal;}}.item-kind{font-size:30px;padding:0 10px;}.item-name{font-weight:600;font-size:1.2em;}.item-time{",c.g.classes.margin_near("5px"),";}.item-section-label{font-size:1.2em;font-weight:600;margin-top:30px;margin-bottom:10px;}.item-section{margin-top:40px;margin-bottom:15px;}.warnings{color:",c.g.colors.warning,";}.item-comments{padding:10px;}.icons{font-size:1.6em;flex-grow:1;padding:0 15px;}","")},Nc=(0,p.observer)((e=>{var t,i;let{item:r,onClose:s,tab:o}=e;const[a,l]=(0,n.useState)(o||"details"),c=(0,n.useRef)(),d=(0,n.useContext)(zt.l9),{menu:p,type:u}=r;let m,g;r.commentsInfo&&r.maySeeCommentsTab&&(m=[{val:"details",label:lng("details")},{val:"comments",label:lng("comments")}],g=r.commentsInfo.connect);const h=(0,y.BX)("div",{className:"side-display-top-head-extra",children:[(0,y.BX)(dt.c_,{className:"icons",children:[r.views>0&&(0,y.tZ)(ni.kO,{views:r.views}),(0,v.DM)(r.bookmarked)&&(0,y.tZ)(ni.rp,{entity:r,onClick:()=>{var e;return null===(e=r.toggleBookmark)||void 0===e?void 0:e.call(r)}}),r.mayLike&&(0,y.tZ)(ni.dR,{entity:r,onClick:()=>{var e;return null===(e=r.toggleLike)||void 0===e?void 0:e.call(r)}})]}),(0,y.tZ)("div",{children:(null===(t=r.status)||void 0===t?void 0:t.text)&&(0,y.tZ)(pt.Vp,{tag:r.status.text,color:null===(i=r.status)||void 0===i?void 0:i.color})})]});return(0,y.tZ)(Ft.d,{from:"side",onClose:s,ref:c,scroll:!0,addPushState:!s,children:(0,y.tZ)(Mt.W2,{css:Tc({type:u}),head:(0,y.tZ)(Mt.$0,{onClose:()=>c.current.close(),headExtra:h}),stickyHead:!0,children:(0,y.BX)("div",{className:"side-display",children:[(0,y.BX)("div",{className:"side-display-title",children:[(0,y.tZ)("div",{className:"item-kind",children:(0,y.tZ)(b.JO,{icon:r.icon})}),(0,y.tZ)("div",{children:(0,y.tZ)("div",{className:"item-name",children:r.title})}),(0,y.tZ)(dt.zh,{}),(0,y.tZ)("div",{className:"item-menu",children:(0,y.tZ)(R.x,{className:"item-menu",options:(0,v.g4)(p,r),onSelect:e=>(0,Cn.Xq)(e,r),children:(0,y.tZ)(b.JO,{icon:"menu",buttonLike:!0})})})]}),r.subTitle&&(0,y.tZ)("div",{className:"item-subtitle",children:r.subTitle}),m&&(0,y.tZ)("div",{className:"side-display-tabs",children:(0,y.tZ)(ie.m,{tabs:m,activeTab:a,onSelect:e=>l(e),className:"_tabs"})}),"details"===a&&(0,y.tZ)(Bc,{item:r}),"comments"===a&&g&&(0,y.tZ)("div",{className:"item-comments",children:(0,y.tZ)(J.H,{commentsStore:d.getStore("comments",g),connectTo:g,locked:null==r?void 0:r.isAssignmentCommentsLock,editable:null==r?void 0:r.mayEditCommetns,deletable:null==r?void 0:r.mayDeleteComments,allowFileSharing:Blsm.isFeatureEnabled("comments_attachments")})}),(0,y.tZ)(dt.zh,{}),(0,y.BX)("div",{className:"side-display-bottom",children:[r.secondaryLink&&(0,y.tZ)(_.l,{theme:"outlined",href:r.secondaryLink.link,children:r.secondaryLink.label}),r.notice&&(0,y.tZ)(_.l,{processHrefClick:!0,href:r.link,theme:"contained",chunky:!0,disabled:!r.link,children:r.notice})]})]})})})})),Ic=(0,p.observer)((function(){const e=(0,zt.vm)();return(0,y.tZ)(y.HY,{children:e.componentSideDrawer&&(0,y.tZ)(Nc,{item:e.componentSideDrawer.component,...e.componentSideDrawer.options,onClose:()=>{var t,i;return(0,v.g4)(null===(t=e.componentSideDrawer)||void 0===t||null===(i=t.options)||void 0===i?void 0:i.close),e.showSideDrawer(null)}})})}));var Dc=i(2443),jc=i(6898),Pc=i(8018);const zc=function(e){let{minutes:t}=e;const[i,r]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const e=setInterval((()=>{!i&&(new Date).getTime()-window.localStorage.getItem("last_activity")>6e4*t&&r(!0)}),1e3);return()=>clearInterval(e)}),[]),i?(0,y.tZ)(Ec,{onStay:()=>r(!1),onLogout:()=>(0,h.p4)({logout:!0},!0)}):null},Ec=function(e){let{onStay:t,onLogout:i}=e;const[r,s]=(0,n.useState)(60),o=(0,n.useRef)();o.current||(o.current=(new Date).getTime());const a=()=>{window.localStorage.setItem("last_activity_action","logout:"+(new Date).getTime()),i()};return(0,n.useEffect)((()=>{const e=setInterval((()=>{const[n,l]=(window.localStorage.getItem("last_activity_action")||"").split(":",2);"stay"===n&&l>o.current?t():"logout"===n&&l>o.current?i():r>0?s(r-1):(a(),clearInterval(e))}),1e3);return()=>clearInterval(e)}),[r]),(0,y.BX)(Ze.I4,{title:lng("inactivity logout"),onConfirm:a,onCancel:()=>{window.localStorage.setItem("last_activity_action","stay:"+(new Date).getTime()),t()},cancelText:lng("stay logged in"),confirmText:lng("logout")+" ("+r+")",zIndex:c.g.z.inactivity_alert,children:[lng("you've been inactive for a while, and will be automatically logged off shortly.").caps(),(0,y.tZ)("br",{}),(0,y.tZ)("br",{}),lng('if you wish to stay logged in please press "stay logged in" button.').caps()]})};var Rc=i(9011);var Fc=i(5951),Mc=i(5280),Ac=i(4773),qc=i(1880),Xc=i(3538);const Lc=(0,p.observer)((e=>{(0,v.Ju)(lng("player|editor"));const t=(0,Ac.EK)(!0,e);if(t.loading)return(0,y.tZ)(ge.$,{className:"center"});return(0,y.BX)(y.HY,{children:[(0,y.tZ)(V.Y,{}),(0,y.BX)(Ac.OS.Provider,{value:t,children:[(0,y.tZ)(Fc.w,{}),(0,y.tZ)(ml.M,{children:(0,y.BX)(gl.E.div,{variants:{enter:{opacity:0},open:{opacity:1,transition:{duration:.25}},exit:{opacity:0,transition:{delay:.15,duration:.15}}},initial:"enter",animate:"open",exit:"exit",children:["welcome"===t.showing&&(0,y.tZ)(Vc,{}),"content"===t.showing&&(0,y.tZ)(Mc.Z,{}),"finish"===t.showing&&(0,y.tZ)(Kc,{}),"error"===t.showing&&(0,y.tZ)(Qc,{}),"session"===t.showing&&(0,y.tZ)(ed,{})]},t.showing)})]})]})})),$c=(0,l.iv)("position:relative;background-color:",c.g.colors.bg_page_containers,";>._front{position:absolute;top:8vh;left:0;width:100%;display:flex;>._card{margin:75px auto;padding:35px 25px 45px;border-radius:15px;background-color:white;display:flex;flex-direction:column;align-items:center;font-size:2.5em;",c.g.classes.shadow_strong,">._title{font-weight:600;}>._buttons{display:flex;flex-direction:row;margin:20px;}}}",""),Vc=()=>{const e=(0,Ac.EK)();return(0,y.BX)("div",{css:[Mc.L,$c,"",""],className:"react_container",children:[(0,y.tZ)(Gc,{}),(0,y.tZ)("div",{className:"_front",children:(0,y.BX)(Xc.J3,{className:"_card",children:[(0,y.tZ)("div",{className:"_title",children:e.resume.length>0?lng("good to have you back!|editor").caps():lng("welcome|editor").caps()}),(0,y.BX)("div",{className:"_buttons",children:[(0,y.tZ)(Hc,{icon:"play",onClick:()=>e.start(),title:lng("start new performance|editor")}),e.resume.length>0&&(0,y.tZ)(Hc,{icon:"go_forward",onClick:()=>e.start(e.resume[e.resume.length-1]),title:lng("continue last performance|editor"),subtitle:lng("created at|editor")+" "+(0,ce._3)(parseInt(e.resume[e.resume.length-1].performance_date)).format(Blsm.prm.datetime_moment_format)})]})]})})]})},Uc=(0,l.iv)("flex:1;margin:10px;padding:40px;display:flex;border:1px solid ",c.g.colors.positive,";border-radius:15px;&:hover{background-color:",c.g.colors.dominant_main_shade,";}>.Icon{margin:auto 0;}>._info{display:flex;flex-direction:column;margin:auto 20px;font-size:0.666em;text-align:start;>._title{font-weight:600;}>._subtitle{font-size:0.6em;}}",""),Hc=e=>{let{onClick:t,icon:i,title:n,subtitle:r}=e;return(0,y.BX)(we.zx,{theme:Uc,onClick:t,children:[(0,y.tZ)(b.JO,{icon:i}),(0,y.BX)("div",{className:"_info",children:[n&&(0,y.tZ)("div",{className:"_title",children:n.caps()}),r&&(0,y.tZ)("div",{className:"_subtitle",children:r.caps()})]})]})},Jc=(0,l.iv)("position:relative;height:250px;width:100vw;background:",c.g.colors.purple,";",c.g.classes.shadow_strong,";",""),Gc=()=>(0,y.tZ)("div",{css:Jc}),Wc=(0,l.iv)("position:relative;background-color:",c.g.colors.bg_page_containers,";.welcome{position:absolute;top:8vh;left:0;height:84vh;width:100vw;display:flex;flex-direction:column;align-items:center;.welcome-title{font-size:2.3em;font-weight:600;color:white;margin-bottom:15px;}.welcome-start{margin:30px;>.Button{font-size:1.2em;width:140px;height:40px;padding-top:8px;}}}",""),Kc=()=>(0,y.BX)("div",{css:[Mc.L,Wc,"",""],className:"react_container",children:[(0,y.tZ)(qc.H,{image:c.g.func.imgUrl("editor:wizard_bg.jpg")}),(0,y.tZ)("div",{className:"welcome",children:(0,y.tZ)("div",{className:"welcome-title",children:lng("you finished|editor").caps()})})]}),Yc={name:"m2jcyq",styles:"display:flex;flex-direction:column;align-items:center;width:100vw;>div{margin-top:8vh;font-size:1.5em;font-weight:600;}"},Qc=()=>{const e=(0,Ac.EK)();return(0,y.tZ)("div",{css:[Mc.L,Yc,"",""],className:"react_container",children:(0,y.BX)("div",{children:[lng("error|editor").caps(),": ",e.errorMessage.caps()]})})},ed=()=>{const e=(0,Ac.EK)(),{invalid:t,resume:i,performance_session:n}=e.sessionData,r=n&&parseInt(n.split("_")[0]);return(0,y.tZ)("div",{css:[Mc.L,Yc,"",""],className:"react_container",children:t?(0,y.tZ)("div",{children:lng("the current session was cancelled!|editor").caps()}):(0,y.BX)(y.HY,{children:[(0,y.tZ)("div",{children:r!==Blsm.user.id?lng("another coach is already running this content or their session wasn't closed properly.|editor"):lng("you are already running this content or your last session wasn't closed properly.|editor").caps()}),(0,y.tZ)("div",{children:lng("you can either exit and continue the other session or create a new session here and the other one will be cancelled.|editor").caps()}),(0,y.tZ)("div",{children:(0,y.tZ)(_.l,{theme:"contained",onClick:()=>e.start(i,!0),children:lng("create new session|editor").caps()})})]})})};var td=i(8337);const id=(0,n.lazy)((()=>i.e(844).then(i.bind(i,9277)).then((e=>({default:e.EditorIndex})))));Platform.Components={LoginRouter:function(e){var t;let{form:i}=e;const[r,s]=(0,n.useState)(v.VD),o=window.location.protocol+"//"+window.location.host+Blsm.prm.relative_path;(0,Z.OR)("hashchange",(()=>{s((0,v.VD)())}));const a=(0,n.useRef)();return(0,n.useEffect)((()=>{a.current&&(0,v.w1)()&&(a.current.style.height=a.current.offsetHeight+"px")})),(0,y.BX)("div",{css:U,children:[(0,y.tZ)(V.Y,{}),(0,y.tZ)(l.xB,{styles:(0,l.iv)('body{background:#8f7fc2 url("',c.g.theme.login_bg,'") no-repeat center center fixed;background-size:cover;min-height:100vh;}',"")}),(0,y.tZ)(q,{registrationMode:"register"===i}),(0,y.tZ)(L,{}),"1"!==(null===(t=Blsm.InitialData)||void 0===t?void 0:t.dont_go_mobile)&&(0,y.tZ)($.s,{className:"qr mobile_off",value:o}),(0,y.tZ)("div",{className:"middle",ref:a,children:(0,y.BX)("div",{className:"_dialog",children:[(0,y.tZ)("div",{className:"logo"}),(0,y.tZ)("div",{className:"separator"}),(0,y.tZ)(u.p8.Provider,{value:"register"===i?"":"login",children:["changepass","passrecover"].includes(i)?(0,y.tZ)(T,{recovery:"passrecover"===i}):"register"===i?(0,y.tZ)(z,{}):"recovery"===r?(0,y.tZ)(S,{}):"sms"===r?(0,y.tZ)(N,{}):"otp"===r?(0,y.tZ)(O,{}):"activation_email"===r?(0,y.tZ)(H,{text:lng("account activation link was sent to your email.")}):"activation_sequence"===r?(0,y.tZ)(H,{text:lng("you will be notified when your account is approved.")}):(0,y.tZ)(x,{})})]})})]})},PatientComPage:Y,PrintCharts:function(e){let{graphs:t}=e;return t.map(((e,t)=>{var i;const{type:n,data:r}=e,s="pie"===n?(null==r||null===(i=r.info)||void 0===i?void 0:i.values)||Object.values(r)[0].values:r;return(0,y.BX)("div",{css:te,children:[(0,y.tZ)("div",{className:"chart-title",children:e.name}),(0,y.tZ)(Q.k,{type:n,data:s,legend:!0,height:"250px",dataLabel:!0})]},t)}))},PrintPdf:function(e){let{fileData:t,elementId:i}=e;(0,ee._)({fileData:t,elementId:i,addScroll:!1,forPrint:!0})},V5Main:function(){const e=(0,n.useMemo)((()=>new zt.Zg),[]);return(0,y.tZ)(Dc.C,{value:(0,jc.Z)({key:"main"}),children:(0,y.BX)(zt.l9.Provider,{value:e,children:[(0,y.tZ)(V.Y,{}),(0,y.tZ)(fc,{}),(0,y.tZ)(xc.R,{}),(0,y.tZ)(Ic,{}),(0,y.tZ)(jt.Du,{}),(0,y.tZ)(Rc.h.Provider,{value:e.sideMenuStore,children:(0,y.tZ)(Pt.K,{})}),(0,y.tZ)(Pc.k,{}),Blsm.prm.inactivity_logout>0&&(0,v.B5)(Blsm.user.id)?(0,y.tZ)(zc,{minutes:Blsm.prm.inactivity_logout}):null]})})},Launcher:{InitLauncher:e=>{(0,se.s)((0,v.wq)("launcher_page")).render((0,y.BX)(y.HY,{children:[(0,y.tZ)(V.Y,{}),(0,y.tZ)(bt,{...e})]}))},InitPreLauncher:e=>{(0,se.s)((0,v.wq)("prelauncher_page")).render((0,y.BX)(y.HY,{children:[(0,y.tZ)(V.Y,{}),(0,y.tZ)(Dt,{...e})]}))},LauncherCommentsExt:function(e){const[t,i]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{const e=document.querySelector(".toggle_comments, #blsm-qp-toggle-comments");e&&(e.style.display="block",e.addEventListener("click",(()=>{var e;null===(e=document.getElementById("blsm-qp-container"))||void 0===e||e.classList.toggle("comments-open"),t||i(!0)})))}),[]),(0,y.tZ)(re,{...e,opened:t})},PlayerLauncher:e=>{(0,se.s)((0,v.wq)("launcher_page")).render((0,y.tZ)(Lc,{...e}))}},Editor:()=>(0,y.tZ)(n.Suspense,{fallback:(0,y.tZ)(ge.$,{className:"center"}),children:(0,y.tZ)(id,{})}),GroupSummary:td.Eq}},2698:(e,t,i)=>{i.d(t,{Dq:()=>h,LZ:()=>p,a_:()=>m,kA:()=>u});var n=i(7363),r=i(5560),s=i(3051),o=i(6975),a=i(8318),l=i(1711),c=i(5944);const d=e=>{const t=e.onClick?t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.onClick(t))}:void 0;return{tabIndex:t?0:void 0,onKeyDown:t,...e}},p=(0,n.forwardRef)((function(e,t){return(0,c.tZ)("div",{...d(e),ref:t})})),u=(0,n.forwardRef)((function(e,t){return(0,c.tZ)("th",{...d(e),ref:t})})),m=(0,n.forwardRef)((function(e,t){return(0,c.tZ)("a",{...d(e),ref:t})}));var g={name:"1azakc",styles:"text-align:center"};const h=(0,r.observer)((function(){const{fontSize:e,mode:t}=l.i,i=[t&&{val:"",label:lng("normal mode")},...Object.entries(l.i.modes).map((e=>{let[i,n]=e;return{val:i,label:n[0],active:t===i}})),{val:"1",label:"A (100%)",active:"1"===e},{val:"1.1",label:"A (110%)",active:"1.1"===e,style:{fontSize:"1.2em"}},{val:"1.2",label:"A (120%)",active:"1.2"===e,style:{fontSize:"1.4em"}}];return(0,c.tZ)(s.x,{css:g,options:i,onSelect:e=>{(0,a.kE)(e)?l.i.fontSize=e:l.i.mode=e},children:(0,c.tZ)(o.JO,{icon:"accessibility"})})}))},1858:(e,t,i)=>{i.d(t,{u:()=>r});var n=i(5944);const r=e=>{let{text:t,ceiling:i=100,floor:r=60}=e;const s=(null==t?void 0:t.length)>i?"0.9em":(null==t?void 0:t.length)>r?"1em":"1.1em";return(0,n.tZ)("span",{style:{fontSize:s},children:t})}},8567:(e,t,i)=>{i.d(t,{BB:()=>w,I4:()=>b,NL:()=>v,bZ:()=>_,cS:()=>k,qR:()=>x,wN:()=>y});var n=i(917),r=i(745),s=i(6920),o=i(8207),a=i(7363),l=i(6421),c=i(8318),d=i(5560),p=i(7821),u=i(81),m=(i(7882),i(5944));const g=(0,n.iv)("color:",s.g.colors.text_sec,";",""),h=e=>{let{title:t="",children:i,buttons:n,width:r="400px",zIndex:s,onClose:a}=e;return(0,m.tZ)(o.T,{css:g,title:t.caps(),width:r,tailButtons:n,zIndex:s,onClose:a,hideX:!0,children:i})},b=e=>{let{onConfirm:t,onCancel:i,children:n,cancelText:r=lng("cancel"),confirmText:s=lng("confirm"),title:o=lng("confirm"),zIndex:a,width:l,noHistoryBack:c,extraTailButtons:d}=e;(0,u.IV)(i,"Confirm",{noHistoryBack:c});const p=[{label:r.caps(),action:i,keyboard:"Escape"},{label:s.caps(),action:t,keyboard:"Enter"}];return d&&p.push(...d),(0,m.tZ)(h,{title:o,buttons:p,zIndex:a,width:l,onClose:i,children:"string"==typeof n?n.caps():n})},v=e=>{var t;let{title:i=lng("prompt"),onConfirm:n,zIndex:r,onCancel:s,children:o,cancelText:c=lng("cancel"),confirmText:d=lng("confirm"),buttons:p=[],placeholder:u,startValue:g,inputType:b,selectOptions:v,inputOptions:_,inputRequired:f,multiline:y,width:w,valueValid:x=(()=>!0)}=e;const[k,Z]=(0,a.useState)(g||(null==v||null===(t=v[0])||void 0===t?void 0:t.val)||""),C=[c&&{label:c.caps(),action:s,bold:!0,keyboard:"Escape"},d&&{label:d.caps(),action:()=>x(k)&&n(k),keyboard:y?void 0:"Enter",disabled:!x(k)||f&&!k},...p].filter((e=>e));x(k);return(0,m.BX)(h,{zIndex:r,title:i,buttons:C,width:w,onClose:s,children:["string"==typeof o?o.caps():o,(0,m.tZ)(l.I,{type:b||"text",value:k,onChange:e=>Z(e),focusOnShow:!0,options:v,wrapped:!0,label:u,labelMargin:!0,..._})]})},_=e=>{let{children:t,closeText:i=lng("OK"),onCancel:n,title:r=lng("alert"),width:s}=e;(0,u.IV)(n,"Alert");const o=[{label:i.caps(),action:n,bold:!0,theme:"outlined",keyboard:"Enter"}];return(0,m.tZ)(h,{buttons:o,title:r,width:s,onClose:n,children:"string"==typeof t?t.caps():t})},f=(0,p.observable)({type:"",content:null,options:{}}),y=()=>f.type="",w=(0,p.action)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Confirm";f.type=i,f.content=()=>e,f.options={...t,onConfirm:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return y(),(0,c.g4)(t.onConfirm,null,i)},onCancel:function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return y(),(0,c.g4)(t.onCancel,null,i)}}})),x=(0,p.action)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(e,t,"Alert")})),k=(0,p.action)((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(e,t,"Prompt")})),Z=(0,d.observer)((function(){const{type:e,content:t,options:i}=f;switch(e){case"Alert":return(0,m.tZ)(_,{...(0,p.toJS)(i),children:t()});case"Confirm":return(0,m.tZ)(b,{...(0,p.toJS)(i),children:t()});case"Prompt":return(0,m.tZ)(v,{...(0,p.toJS)(i),children:t()})}return null}));(0,c.Um)((()=>{(0,r.s)((0,c.wq)("AlertOpener")).render((0,m.tZ)(Z,{}))}))},4524:(e,t,i)=>{i.d(t,{M:()=>l});var n=i(917),r=i(6920),s=i(6344),o=i(5944);const a=(0,n.iv)("@keyframes rotate-circle{0%{transform:rotate(-45deg);}5%{transform:rotate(-45deg);}12%{transform:rotate(-405deg);}100%{transform:rotate(-405deg);}}@keyframes cm-line-tip{0%{width:0;left:1px;top:19px;}54%{width:0;left:1px;top:19px;}70%{width:50px;left:-8px;top:37px;}84%{width:17px;left:21px;top:48px;}100%{width:25px;left:14px;top:45px;}}@keyframes cm-line-long{0%{width:0;right:46px;top:54px;}65%{width:0;right:46px;top:54px;}84%{width:55px;right:0px;top:35px;}100%{width:47px;right:8px;top:38px;}}width:80px;height:115px;margin:0 auto;.check-icon{width:80px;height:80px;position:relative;border-radius:50%;box-sizing:content-box;border:4px solid ",r.g.colors.green,";&::before{top:3px;left:-2px;width:30px;transform-origin:100% 50%;border-radius:100px 0 0 100px;}&::after{top:0;left:30px;width:60px;transform-origin:0 50%;border-radius:0 100px 100px 0;animation:rotate-circle 4.25s ease-in;}&::before,&::after{content:'';height:100px;position:absolute;background:",r.g.colors.bg_main,";transform:rotate(-45deg);}.cm-line{height:5px;background-color:",r.g.colors.green,";display:block;border-radius:2px;position:absolute;z-index:10;&.line-tip{top:46px;left:14px;width:25px;transform:rotate(45deg);animation:cm-line-tip 0.75s;}&.line-long{top:38px;right:8px;width:47px;transform:rotate(-45deg);animation:cm-line-long 0.75s;}}.cm-circle{top:-4px;left:-4px;z-index:10;width:80px;height:80px;border-radius:50%;position:absolute;box-sizing:content-box;border:4px solid ",(0,s.mR)(r.g.colors.green,.5),";}.cm-fix{top:8px;width:5px;left:26px;z-index:1;height:85px;position:absolute;transform:rotate(-45deg);background-color:",r.g.colors.bg_main,";}}",""),l=()=>(0,o.tZ)("div",{css:a,children:(0,o.BX)("div",{className:"check-icon",children:[(0,o.tZ)("span",{className:"cm-line line-tip"}),(0,o.tZ)("span",{className:"cm-line line-long"}),(0,o.tZ)("div",{className:"cm-circle"}),(0,o.tZ)("div",{className:"cm-fix"})]})})},1137:(e,t,i)=>{i.d(t,{d:()=>h});var n=i(917),r=i(6920),s=i(7363),o=i(81),a=(i(7882),i(4210)),l=i(7828),c=i(7965),d=i(539),p=i(5944);const u=e=>{let{size:t,scroll:i,axis:s="top"}=e;const o="side"===s?r.g.far:"top"===s?"bottom":"top",a="left"===s||"right"===s||"side"===s;return(0,n.iv)("position:fixed;z-index:",r.g.z.top_bar-1,";top:0;bottom:0;left:0;right:0;",r.g.classes.page_position,";background-color:rgba(0, 0, 0, .7);opacity:1;.inner-drawer{position:absolute;",o,":0;",a?`max-width: calc(100vw - ${r.g.consts.SIDE_BAR_WIDTH}px)`:`max-height: calc(100vh - ${r.g.consts.TOP_BAR_HEIGHT}px)`,";",a?"width":"height",":",t,";",a?"height":"width",":100%;background-color:",r.g.colors.bg_main,";border-",s,":1px solid ",r.g.colors.separator,";z-index:",r.g.z.top_bar,";",r.g.mQuery.mobile,"{",a&&"max-width: 100vw",";}",i?"overflow: auto;":""," ._children{",r.g.mQuery.mobile,"{max-height:calc(100vh - ",r.g.consts.TOP_BAR_HEIGHT+93,"px);overflow-y:auto;}.container_splitter{>*{height:calc(100vh - 126px);overflow-y:auto;}}}}","")},m=e=>"left"===e?"right":"right"===e?"left":"top"===e?"bottom":"side"===e?"side":"top";var g={name:"thhfxt",styles:"margin-top:10%"};const h=(0,s.forwardRef)((function(e,t){let{children:i,from:n="bottom",size:h,time:b=.5,scroll:v,refDrawerBody:_,onClose:f,addPushState:y=!1}=e;(0,o.Ry)();const[w,x]=(0,s.useState)(!0),[k,Z]=(0,s.useState)(!1);h||(h=["top","bottom"].includes(n)?"65%":"533px");const C=()=>{x(!1),f&&setTimeout(f,1e3*b+100)},S=(0,s.useContext)(a.q3);S&&(S.backFromDirty=()=>x(!0)),(0,s.useImperativeHandle)(t,(()=>({close:C}))),(0,o.IV)(C,"Drawer",{disable:!y});const O={enter:{opacity:0},open:{opacity:1,transition:{duration:.15}},exit:{opacity:0,transition:{delay:.1,duration:.15}}},B=(e,t)=>{switch("side"===e&&(e=r.g.far),e){case"bottom":return"enter"===t?{y:"100%"}:"open"===t?{y:0,transition:{type:"spring",bounce:.1},transitionEnd:{y:0}}:{y:"100%",transition:{type:"spring",bounce:.1}};case"left":return"enter"===t?{x:"-100%"}:"open"===t?{x:0,transition:{type:"spring",bounce:.1},transitionEnd:{x:0}}:{x:"-100%",transition:{type:"spring",bounce:.1}};case"right":return"enter"===t?{x:"100%"}:"open"===t?{x:0,transition:{type:"spring",bounce:.1},transitionEnd:{x:0}}:{x:"100%",transition:{type:"spring",bounce:.1}};case"top":return"enter"===t?{y:"-100%"}:"open"===t?{y:0,transition:{type:"spring",bounce:.1},transitionEnd:{y:0}}:{y:"-100%",transition:{type:"spring",bounce:.1}}}},T={enter:e=>B(e,"enter"),open:e=>B(e,"open"),exit:e=>B(e,"exit")};return(0,p.tZ)("div",{children:(0,p.tZ)(l.M,{children:w&&(0,p.tZ)(c.E.div,{css:u({size:h,scroll:v,axis:m(n)}),variants:O,initial:"enter",animate:"open",exit:"exit",onMouseDown:e=>e.currentTarget===e.target&&C(),children:(0,p.tZ)(c.E.div,{variants:T,initial:"enter",animate:"open",exit:"exit",custom:n,onAnimationComplete:()=>{Z(!0)},className:"inner-drawer",ref:_,children:k?(0,p.tZ)(c.E.div,{variants:O,initial:"enter",animate:"open",children:i}):(0,p.tZ)(d.$,{css:g})})})})})}))},7033:(e,t,i)=>{i.d(t,{U:()=>o});var n=i(1042),r=i(5944);const s={name:"1msxvtn",styles:"@keyframes kfFadeIn{from{opacity:0;}to{opacity:1;}}@keyframes kfFadeOut{from{opacity:1;}to{opacity:0;}}animation:kfFadeIn .5s ease-in-out;opacity:1;&.animate_open{opacity:0;pointer-events:none;}"},o=e=>{let{children:t}=e;return(0,r.tZ)(n.kD,{css:s,children:t})}},1042:(e,t,i)=>{i.d(t,{$V:()=>p,EN:()=>d,kD:()=>u});var n=i(917),r=i(6920),s=i(7363),o=i(1533),a=i(8318),l=i(5944);const c=r.g.isRTL?-1:1,d=(0,n.iv)("@keyframes io_blowIn{0%{transform:scale(0.01);}100%{transform:scale(1);}}@keyframes io_blowOut{0%{transform:scale(1);opacity:1;}100%{transform:scale(0.01);opacity:0;}}@keyframes io_blow_yIn{0%{transform:scaleY(0.01);}100%{transform:scaleY(1);}}@keyframes io_blow_yOut{0%{transform:scaleY(1);}100%{transform:scaleY(0.01);}}@keyframes io_slideIn{0%{transform:translateX(",1500*-c,"px) skewX(",5*c,"deg) scaleX(1.1);}70%{transform:translateX(",30*c,"px) skewX(2deg) scaleX(.95);}100%{transform:translateX(0px) skewX(0deg) scaleX(1);}}@keyframes io_slideOut{0%{transform:translateX(0px) skewX(0deg) scaleX(1);}30%{transform:translateX(",30*c,"px) skewX(",2*-c,"deg) scaleX(.95);}100%{transform:translateX(",1500*-c,"px) skewX(",5*-c,"deg) scaleX(1.1);}}@keyframes io_fadeIn{0%{opacity:0;}100%{opacity:1;}}@keyframes io_fadeOut{0%{opacity:1;}100%{opacity:0;}}@keyframes io_expandIn{0%{max-height:0;max-width:150px;overflow:hidden;}100%{max-height:70vh;max-width:400px;overflow:hidden;}}@keyframes io_expandOut{0%{max-height:70vh;max-width:400px;overflow:hidden;}100%{max-height:0;max-width:150px;overflow:hidden;}}",""),p=e=>{let{show:t=!0,type:i="fade",speed:n=".3s",onHide:r}=e;const[l,c]=(0,s.useState)(t);return(0,s.useEffect)((()=>{t&&c(!0)}),[t]),[l,{style:{animation:`io_${i}${t?"In":"Out"} ${n} ease-in-out`},onAnimationEnd:()=>{t||((0,o.flushSync)((()=>c(!1))),(0,a.g4)(r))}}]},u=(0,s.forwardRef)((function(e,t){let{children:i,onClose:n,className:r}=e;const[o,c]=(0,s.useState)("open");(0,s.useEffect)((()=>{c("middle")}),[]),(0,s.useImperativeHandle)(t,(()=>({close:()=>{c("close")},trigger:()=>{"middle"===o&&c("close")}})));return(0,l.tZ)("div",{className:(0,a.AK)(r,"AnimateWrap",`animate_${o}`),onAnimationEnd:e=>{e.target.classList.contains("AnimateWrap")&&("open"!==o&&"close"!==o||c("middle"),"close"===o&&n&&n())},children:i})}))},7059:(e,t,i)=>{i.d(t,{N4:()=>m,_P:()=>d});var n=i(917),r=i(6975),s=i(6920),o=i(2755),a=i(5944);const l=e=>{let{size:t,factor:i}=e;const r=t/20+5*i;return(0,n.iv)("width:",t,"px;height:",t,"px;position:relative;>svg{width:100%;height:100%;}>.icon-box{position:absolute;display:flex;justify-content:center;align-items:center;>.Icon{font-size:",r,"px;color:white;}}","")},c=500,d=function(e){let{values:t}=e;const i=250,s=3-t.length,o=[],d=[];for(const[e,n]of Object.entries(t)){const t=i-(10+5*s)-60-e*(60+15*s),r=50+15*s;o.push({percent:n.val,r:t,width:r,dotColor:n.color});const a=r/2-5;d.push({icon:n.icon,label:n.label,top:(i-t)/c*200-a/2+"px",left:`calc(50% - ${a/2}px)`,length:a+"px"})}return(0,a.BX)("div",{css:l({size:200,factor:s}),className:"Rings",children:[(0,a.BX)("svg",{viewBox:"0 0 500 500",children:[(0,a.tZ)("circle",{cx:i,cy:i,r:i,fill:"rgba(255, 255, 255, .1)"}),o.map(((e,t)=>(0,a.tZ)(p,{...e},t)))]}),d.map(((e,t)=>(0,a.tZ)("div",{className:"icon-box",css:(0,n.iv)({left:e.left,top:e.top,width:e.length,height:e.length},"",""),children:(0,a.tZ)(r.JO,{icon:e.icon,toolTip:{text:e.label,theme:"bln-tooltip-bright"}})},t)))]})},p=function(e){let{percent:t,r:i,width:n,dotColor:r}=e;const s=2*i*Math.PI,o=250,l=Math.max(.001,t/100);return(0,a.BX)(a.HY,{children:[(0,a.tZ)("circle",{r:i,fill:"none",stroke:"rgba(255, 255, 255, .2)",strokeWidth:n,transform:"translate(250, 250) rotate(-90)"}),(0,a.tZ)("circle",{r:i,fill:"none",stroke:"white",strokeWidth:n,strokeLinecap:"round",transform:"translate(250, 250) rotate(-90)",strokeDasharray:`${s} ${s}`,strokeDashoffset:(1-l)*s,children:(0,a.tZ)("animate",{repeatCount:"1",attributeName:"stroke-dashoffset",dur:"2s",from:s,to:s*(1-l)})}),r&&(0,a.tZ)("circle",{fill:r,cx:o,cy:o-i,r:n/2-5})]})},u=(0,n.iv)("margin:5px;padding:5px;display:inline-flex;border-radius:8px;background:",s.g.theme.color_1,";.info{",s.g.classes.margin_near("10px"),";color:#FFF;.label{font-weight:600;}}",""),m=e=>{var t;let{icon:i,color:n,label:r,number:s}=e;return(0,a.BX)("div",{css:u,children:[(0,a.tZ)(o.kT,{icon:i,color:n}),(0,a.BX)("div",{className:"info",children:[(0,a.tZ)("div",{className:"label",children:null===(t=r.caps)||void 0===t?void 0:t.call(r)}),(0,a.tZ)("div",{children:s})]})]})}},7477:(e,t,i)=>{i.d(t,{Q:()=>m,w:()=>g});var n=i(917),r=i(6920),s=i(7363),o=i(4902),a=i(8318),l=i(2945),c=i(501),d=i(9344),p=i(5944);const u=e=>(0,n.iv)("position:relative;display:",e?"block":"inline-block",";input{border-width:0;background-color:transparent;}>input::-ms-clear{display:none;}>._list{background-color:",r.g.colors.bg_input,";color:",r.g.colors.text_sec,";border:1px solid #a9a9a9;position:fixed;z-index:",r.g.z.context_menu,";max-height:45vh;overflow-y:auto;border-radius:8px;}&.open_up>._list{top:auto;bottom:100%;}",""),m=e=>{let{value:t="",onSelect:i,onTextChange:n,getData:r,onKeyUp:o,onFocus:m,onBlur:g,block:b,showId:v,autofocus:_,textClear:f=!0,readOnly:y,inputProps:w}=e;const[x,k]=(0,s.useState)([]),[Z,C]=(0,s.useState)(null),[S,O]=(0,s.useState)(t),B=(0,s.useRef)(0),T=(0,s.useRef)(0),N=(0,s.useRef)(),{opened:I,toggleDD:D,selectRef:j,labelRef:P,ddRef:z}=(0,l.v)({onFocus:m,onBlur:g}),E=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];D(e,t),C(null)},R=e=>{clearTimeout(T.current),O(e||""),!1===e?(E(!1,!0),n&&setTimeout((()=>n("")),100)):T.current=setTimeout((()=>{const t=e=>{k(e),E(e.length>0,!0)};N.current=t,r(e,(e=>t===N.current&&t(e)))}),100)},F=()=>R(!1),M=e=>{e&&(C(null),O(e.label),E(!1),n&&n(e.label),i&&i(e,F))},A=e=>{["ArrowUp","ArrowDown"].includes(e.key)?(clearTimeout(B.current),B.current=setTimeout((()=>B.current=null),500),"ArrowUp"===e.key?C((e=>e?e-1:x.length-1)):C((e=>null===e?0:(e+1)%x.length))):"Enter"===e.key?null!==Z&&M(x[Z]):"Escape"===e.key&&E(!1)},q=e=>{P.current=e,_&&setTimeout((()=>(0,a.Du)(e)),300)};return(0,p.BX)("div",{css:u(b),className:"auto_complete",ref:j,children:["poortext"===(null==w?void 0:w.type)?(0,p.tZ)("div",{ref:q,children:(0,p.tZ)(d.Lf,{value:S,disabled:y,onKeyDown:A,onChange:e=>(n&&n(e),R(e)),onFocus:()=>(R(S),m&&m()),onBlur:e=>(clearTimeout(T.current),f&&setTimeout((()=>R(!1)),100),g&&g(e)),toolbarOptions:{placeholders:w.placeholders,simplePlaceholder:!0},...w})}):(0,p.tZ)(c.o,{type:"text",value:S,disabled:y,onKeyDown:A,onKeyUp:e=>o&&o(e,F),onChange:e=>(n&&n(e),R(e)),onFocus:e=>(R(e.target.value),m&&m()),onBlur:e=>(clearTimeout(T.current),f&&setTimeout((()=>R(!1)),100),g&&g(e)),ref:q,...w}),!y&&x.length>0&&I&&(0,p.tZ)("div",{className:"_list",ref:z,children:x.map(((e,t)=>(0,p.tZ)(h,{...e,onSelect:()=>M(e),active:Z===t,scrollOnArrows:0!==B.current,onMouseEnter:()=>0===B.current&&C(t),showId:v},e.id||t)))})]})},g=(0,n.iv)(r.g.classes.font_reset,";color:",r.g.colors.text_main,";cursor:pointer;line-height:1.7em;padding:3px 1em 3px .4em;&.active{background-color:",r.g.colors.dominant_main_shade,";}>._avatar{vertical-align:middle;",r.g.classes.margin_far(".5em"),";}>.description{font-size:.85em;",r.g.classes.padding_near("1em"),";max-width:500px;color:",r.g.colors.text_sec,";}",""),h=e=>{let{id:t,label:i,avatar:n,active:r,description:s,onSelect:l,onMouseEnter:c,scrollOnArrows:d,showId:u}=e;return(0,p.BX)("div",{css:g,className:(0,a.AK)("auto_complete_item",{active:r}),onMouseDown:l,onMouseEnter:c,ref:e=>d&&r&&e&&(e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.parentNode.scrollTop=e.offsetTop),children:[n&&(0,p.tZ)(o.qE,{className:"_avatar",user:{user_avatar:n}}),t&&u?"[#"+t+"] ":"",i,s&&(0,p.tZ)("div",{className:"description auto_complete_item",children:s})]})}},9483:(e,t,i)=>{i.d(t,{d:()=>a,m:()=>o});var n=i(441),r=i(8318),s=i(5944);const o=e=>{let{children:t,elType:i,value:o,keepAlign:l,center:c=!1,...d}=e;const p={...d,ref:e=>e&&(e=>{let t=o||"";if(!o){const i=document.createRange().createContextualFragment(e.innerHTML);if(i.childElementCount)for(let e=0;e<i.childElementCount;e++){const n=i.children[e];t+=(0,r.F5)(n,{filterClass:["mentions_box","mention"]})}else t=e.textContent}let i=t.replace(/^[\s\-*\d.:!#_~`'"￼]+/g,"");const n=a(i),s=c||(document.documentElement.classList.contains("RTL")?"right":"left");n?(e.style.direction="rtl",e.style.textAlign=l?s:"right"):(e.style.direction="ltr",e.style.textAlign=l?s:"left")})(e),children:t};return"a"===i?(0,s.tZ)(n.A,{...p}):"span"===i?(0,s.tZ)("span",{...p}):(0,s.tZ)("div",{...p})},a=e=>/[\u0591-\u07FF]/.test(null==e?void 0:e.charAt(0))},4902:(e,t,i)=>{i.d(t,{I9:()=>b,cU:()=>u,qE:()=>p});var n=i(6920),r=i(917),s=i(7154),o=i(8318),a=(i(7882),i(5446)),l=i(5944);const c=e=>{let{size:t="29px",radius:i="50%",shadowed:n=!1}=e;return(0,r.iv)("display:inline-block;min-width:",t,";height:",t,";line-height:",t,";font-size:calc(",t," / 2.5);text-align:center;border-radius:",i,";",n?"box-shadow: 0 2px 4px rgba(0,0,0,.4)":"",";vertical-align:bottom;&._clickable{cursor:pointer;}","")},d=e=>{let{size:t,radius:i,shadowed:n}=e;return(0,r.iv)(c({size:t,radius:i,shadowed:n}),";background:transparent no-repeat top center;background-size:cover;color:white;","")},p=e=>{var t,i;let{user:r,size:c,rounded:d=!0,shadowed:p,onClick:m,className:g,balloon:h=!0}=e;const b=r||Blsm.user,v=b.user_id||b.id;let _=b.user_first_name,f=b.user_last_name,y=b.user_avatar||b.avatar;b.full_name&&!_&&([_,f]=b.full_name.split(" ")),y&&y.includes("avatar_")&&(y=void 0);const w={size:c,rounded:d,shadowed:p,className:(0,o.AK)("Avatar",g),onClick:m,img:y,bgColor:n.g.func.id2color(v),textFallBack:((null===(t=_)||void 0===t?void 0:t[0])||(null===(i=f)||void 0===i?void 0:i[0])||"").toUpperCase()};return h&&v?(0,l.tZ)(s.y,{content:(0,l.tZ)(a.O,{userId:v}),children:(0,l.tZ)(u,{...w})}):(0,l.tZ)(u,{...w})},u=e=>{let{size:t,rounded:i=!0,shadowed:n,className:r,onClick:s,img:a,bgColor:c,textFallBack:p}=e;return(0,l.tZ)("div",{css:d({size:t,radius:i?void 0:".6em",shadowed:n}),className:(0,o.AK)("_circle",r,{_clickable:s}),style:{backgroundColor:c,backgroundImage:a?`url('${a}')`:void 0},onClick:s,children:!a&&p})},m=e=>{let{size:t}=e;return(0,r.iv)(c({size:t}),";color:",n.g.colors.text_sec,";text-align:center;border:1px solid ",n.g.colors.separator,";font-size:1em;&.lowerFont{font-size:0.8em;}","")},g=e=>{let{count:t,className:i,size:n,onClick:r}=e;const s=t>=100;return(0,l.BX)("div",{css:m({size:n}),className:(0,o.AK)("_circle_more",i,{_clickable:r,lowerFont:s}),onClick:r,children:["+",(0,o.lo)(t)]})},h=(0,r.iv)(">div{",n.g.classes.margin_far("8px"),";&:last-child{",n.g.classes.margin_far(0),";}}",""),b=e=>{let{users:t,maxSlots:i=7,totalCount:n,onClick:r,className:s}=e;void 0===n&&(n=t.length);const o=i<n?t.slice(0,i-1):t,a=n-o.length;return(0,l.BX)("div",{css:h,className:s,children:[o.map((e=>(0,l.tZ)(p,{user:e,onClick:r?()=>r(e):void 0},e.user_id))),a>0&&(0,l.tZ)(g,{count:a,onClick:r?()=>r():void 0})]})}},7697:(e,t,i)=>{i.d(t,{F$:()=>g,Pp:()=>u,Vy:()=>b});var n=i(917),r=i(6975),s=i(7154),o=i(6920),a=(i(7882),i(2334)),l=i(5944);const c=100,d=(0,n.iv)("font-size:.8em;font-weight:600;margin-top:0.8em;",o.g.classes.ellipsis_lines(2),";white-space:normal;",""),p=(0,n.iv)("width:",c,"px;text-align:center;.pentagon{position:relative;height:",105,"px;width:",c,"px;.rect{height:",65,"px;border-radius:10px;border:3px solid white;box-shadow:0 -2px 5px rgba(0, 0, 0, 0.1);}.triangle{position:absolute;height:",1.1*c,"px;top:",38,"px;left:",15,"px;overflow:hidden;transform:rotate(90deg);>div{transform:rotate(45deg);width:",76,"px;height:",76,"px;top:",20,"px;left:-",38,"px;position:relative;border-radius:10px;border:3px solid white;box-shadow:5px -5px 5px rgba(0, 0, 0, 0.1);}}.Icon{color:white;position:absolute;top:42%;left:50%;transform:translate(-50%, -50%);font-size:",33,"px;}}",""),u=e=>{let{icon:t,color:i,label:n,description:o="",date:c}=e;const u=[n,o,(0,a.GG)(c)].filter((e=>!!e)).join("\n\n");return(0,l.tZ)("div",{css:p,children:(0,l.BX)(s.u,{text:u,children:[(0,l.BX)("div",{className:"pentagon",children:[(0,l.tZ)("div",{className:"rect",style:{backgroundColor:i}}),(0,l.tZ)("div",{className:"triangle",children:(0,l.tZ)("div",{style:{backgroundColor:i}})}),(0,l.tZ)(r.JO,{icon:t,balloonAnchor:!1})]}),n&&(0,l.tZ)("div",{css:d,children:n})]})})},m=e=>(0,n.iv)("width:",e||c,"px;text-align:center;margin-top:15px;.rectangle{position:relative;height:",e||c,"px;border:3px solid white;box-shadow:0 5px 5px rgba(0, 0, 0, 0.1);border-radius:10px;display:flex;justify-content:center;align-items:center;width:",e||c,"px;.Ribbon{position:absolute;top:-",.17*(e||c),"px;left:-",.18*(e||c),"px;}>.initials{color:white;opacity:0.8;font-size:",.7*(e||c),"px;font-family:monospace;font-weight:600;}}",""),g=e=>{let{color:t,size:i,ribbon:n=!1,label:r,description:o="",date:p,underLabel:u=!0}=e;const g=[r,o,(0,a.GG)(p)].filter((e=>!!e)).join("\n\n"),h=(null==r?void 0:r.trim().split(" ")[0])||"";return(0,l.tZ)("div",{css:m(i),children:(0,l.BX)(s.u,{text:g,children:[(0,l.BX)("div",{className:"rectangle",style:{backgroundColor:t},children:[n&&(0,l.tZ)(b,{circleColor:t,stripColor:t,size:(i||c)/2.5}),r&&(0,l.tZ)("span",{className:"initials",children:h[0].toUpperCase()})]}),r&&u&&(0,l.tZ)("div",{css:d,children:r})]})})},h=e=>(0,n.iv)(">div{position:relative;>.ribbon{position:absolute;top:",.88*e,"px;left:",.16*e,"px;width:",.66*e,"px;height:",.83*e,"px;}>.circle{position:relative;width:",e,"px;height:",e,"px;border-radius:50%;border:2px solid white;color:white;font-size:",.5*e,"px;display:flex;justify-content:center;padding-top:",.12*e,"px;.el_icon{top:-2px;position:relative;}}}",""),b=function(e){let{size:t=36,circleColor:i=o.g.colors.set[5],stripColor:n=o.g.colors.set[0]}=e;return(0,l.tZ)("div",{className:"Ribbon",css:h(t),children:(0,l.BX)("div",{children:[(0,l.tZ)("svg",{className:"ribbon",viewBox:"0 0 24 30",preserveAspectRatio:"none",style:{transform:"translateZ(0)"},children:(0,l.tZ)("path",{fill:n,stroke:"white",strokeWidth:"2",d:"M 0 0 L 0 30 L 12 15 L 24 30 V 0 H 0 Z"})}),(0,l.tZ)("div",{className:"circle",style:{backgroundColor:i},children:(0,l.tZ)(r.JO,{icon:"bookmark_filled",balloonAnchor:!1})})]})})}},7154:(e,t,i)=>{i.d(t,{u:()=>y,y:()=>h});var n=i(7363),r=i(917),s=i(6920),o=(i(7882),i(9483)),a=i(81),l=i(8318),c=i(6975),d=i(6344),p=i(6941),u=i(1042),m=i(5944);const g=(0,r.iv)("display:inline-block;>._btn{display:inline-block;._ddTriangle{font-size:.9em;color:",s.g.colors.text_sec,";}}",""),h=e=>{let{children:t,content:i,className:r,keepOpen:s,dropDownLike:o,theme:d,behavior:p="menu",onOpen:h,onClose:b,btnRadius:v,closeOnClick:_,trigger:y,mobileLayoutSupport:w,noPortal:x,balloonModes:k,...Z}=e;const[C,S]=(0,n.useState)(!1),O=(0,n.useRef)(null),B=(0,n.useRef)(null),T=(0,a.iP)(),N=T.width<=600&&w,I=(0,l.Fq)();(0,n.useEffect)((()=>()=>clearTimeout(E.current)),[]),(0,n.useEffect)((()=>{"trigger"===p&&(y&&!C?D():C&&j())}),[y]);const D=()=>{T.width<=600&&"tooltip"===p||(S(!0),h&&h())},j=e=>{var t;"click"===p&&(null!=e&&e.target&&B.current.contains(e.target)||null!=e&&e.target.classList.contains("auto_complete_item"))||T.width<=600&&"tooltip"===p||(S(!1),null==b||b(),null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e))},[P,z]=(0,u.$V)({show:s||C,type:"blow_y",speed:".1s"}),E=(0,n.useRef)(0);let R={};return"click"===p?R.onClick=()=>{C?C&&j():D()}:R={onMouseEnter:()=>{N||I||(clearTimeout(E.current),!P&&(E.current=setTimeout((()=>D()),200)))},onMouseLeave:()=>{clearTimeout(E.current),C&&(E.current=setTimeout((()=>j()),"tooltip"===p?0:200))},onClick:()=>{(N||I)&&D()}},(0,m.BX)("div",{className:r,css:g,..."menu"===p?R:{},...Z,ref:B,children:[(0,m.tZ)("div",{className:"_btn",ref:O,...["tooltip","click"].includes(p)?R:{},style:v?{borderRadius:v}:void 0,children:(0,m.BX)("span",{children:[t,o&&(0,m.BX)(m.HY,{children:[" ",(0,m.tZ)("span",{className:"_ddTriangle",children:(0,m.tZ)(c.JO,{icon:"triangle_down"})})]})]})}),P&&(0,m.tZ)(f,{mobileLayout:N,behavior:p,onClickClose:_?j:void 0,balloonClose:j,dropDownLike:o,content:i,theme:d,noPortal:x,aniProps:z,balloonModes:k,btnRef:O})]})};var b={name:"ol51ym",styles:"&.left{margin-right:-6px;>.triangle{right:4px;}}&.right{margin-left:-6px;>.triangle{left:4px;}}"};const v=e=>{let{theme:t,triangle:i}=e;const{bgColor:n,txtColor:o,padding:a=""}=s.g.darkMode?{bgColor:s.g.colors.bg_cont,txtColor:s.g.colors.text_main,padding:t?"padding: 5px 10px;":""}:"bln-tooltip-dark"===t?{bgColor:"#545454",txtColor:"#FFFFFF",padding:"padding: 5px 10px;"}:"bln-tooltip-bright"===t?{bgColor:"#FFFFFF",txtColor:s.g.colors.text_sec,padding:"padding: 5px 10px;"}:{bgColor:"#FFFFFF",txtColor:""},l=["bln-tooltip-dark","bln-tooltip-bright"].includes(t)?"img { max-width: 330px; }":"",c=(0,d.mR)(s.g.colors.separator,.4);return(0,r.iv)("white-space:normal;",s.g.classes.font_reset,";z-index:",s.g.z.context_menu,";position:fixed;box-shadow:0 0 3px rgba(0, 0, 0, 0.2);background-color:",n,";border-radius:5px;color:",o,";",a,";",l,";","bln-tooltip-dark"===t?"user-select: none; max-width: 550px; word-break: break-word;":"",";p{margin:0;padding:0;}img{width:100%;height:auto;}>.content{overflow-y:auto;}&.above{margin-bottom:10px;>.triangle{bottom:-16px;border-color:",c," transparent transparent;&:after{border-color:",n," transparent transparent;top:-11.5px;}}}&.below{margin-top:6px;>.triangle{top:-16px;border-color:transparent transparent ",c,";&:after{border-color:transparent transparent ",n,";top:-8.5px;}}}",i&&b,'>.triangle{pointer-events:none;position:absolute;border-width:8px;border-style:solid;z-index:-1;&:after{position:absolute;content:" ";border-width:10px;border-style:solid;left:-10px;}}@keyframes kfPop{from{bottom:-100vh;}to{bottom:0;}}&.mobileLayout{bottom:0;left:0;right:0;margin:0;border-radius:5px 5px 0 0;min-height:90px;max-height:50%;animation:kfPop .3s ease-in-out;overflow-y:auto;box-shadow:0px -4px 5px -3px ',s.g.colors.half_black,";.full-screen-top{display:flex;justify-content:flex-end;padding:5px;position:sticky;top:0;.Icon{position:absolute;margin-right:10px;font-size:1.2em;}}}","")},_=(0,r.iv)("background-color:rgba(0, 0, 0, 0);transition:background-color .2s;position:fixed;width:100vw;height:100vh;top:0;left:0;&.active{background-color:",s.g.colors.half_black,";}","");function f(e){let{behavior:t,onClickClose:i,content:r,dropDownLike:s,mobileLayout:o,balloonClose:d,theme:u,btnRef:g,noPortal:h,aniProps:b,balloonModes:f={}}=e;const y=(0,n.useRef)(null),w=(0,n.useRef)(null);(0,a.t$)(w,["trigger","click"].includes(t)?d:void 0);const x=!(s||f.noTriangle||!r),k=(0,m.BX)(m.HY,{children:[o&&(0,m.tZ)("div",{css:_,ref:e=>setTimeout((()=>null==e?void 0:e.classList.add("active")),1)}),(0,m.BX)("div",{css:v({theme:u,triangle:x}),className:(0,l.AK)({mobileLayout:o}),ref:e=>{w.current=e,e&&!o&&function(e,t,i,n){const r=t.style;n.ignoreAnchor||(e=e.getElementsByClassName("balloon-anchor")[0]||e);const s=e.getBoundingClientRect(),o=document.documentElement.clientWidth,a=document.documentElement.clientHeight,l=n.align||(s.right<=o/2?"right":"left"),c=n.vertical||(s.bottom<=a/2?"below":"above");r.left=r.right="auto","right"===l?r.left=s.left+"px":r.right=o-s.right+"px";r.top=r.bottom="auto","below"===c?(r.top=s.bottom+"px",i.style.maxHeight=a-s.bottom-50+"px"):(r.bottom=a-s.top+"px",i.style.maxHeight=s.top-50+"px");t.classList.remove("right","left","below","above"),t.classList.add(l),t.classList.toggle(c)}(g.current,w.current,y.current,f)},...b,onClick:i,children:[o?(0,m.tZ)("div",{className:"full-screen-top",children:(0,m.tZ)(c.JO,{icon:"close",onClick:d,buttonLike:!0})}):x&&(0,m.tZ)("div",{className:"triangle"}),(0,m.tZ)("div",{className:"content",ref:y,children:r})]})]});return h?k:(0,m.tZ)(p.M,{parentEl:g.current,children:k})}const y=e=>{const t=(0,l.Kn)(e.text)?Object.assign({},e,e.text):e,{children:i,text:n,html:r,btnRadius:s,minLength:a,className:c,theme:d,...p}=t;return r||n&&!(a&&n.length<a)?(0,m.tZ)(h,{content:r?"string"==typeof r?(0,m.tZ)(o.m,{dangerouslySetInnerHTML:{__html:r}}):(0,m.tZ)(o.m,{children:r}):(0,m.tZ)(o.m,{children:(0,m.tZ)("div",{children:(0,l.rj)(n.caps())})}),theme:d||"bln-tooltip-dark",behavior:r?"menu":"tooltip",className:c,btnRadius:s,...p,children:i}):i||null}},8411:(e,t,i)=>{i.d(t,{$Q:()=>C,CX:()=>x,dI:()=>k});var n=i(6975),r=i(917),s=i(6920),o=i(1092),a=i(7095),l=i(7363),c=i(5832),d=i(8318),p=(i(7882),i(3051)),u=i(5311),m=i(9159),g=i(7154),h=i(81),b=i(7392),v=i(5944);const _=(0,r.iv)("display:flex;.Icon._disabled{color:",s.g.colors.disabled_text,";}.Button{",s.g.classes.margin_near("6px"),";}",""),f=e=>{let{actions:t,buttonLike:i}=e;return t.length?(0,v.tZ)("div",{css:_,className:"bar-actions",children:t.map(((e,t)=>{const r={onClick:(0,d.Wl)(e.action)?e.action:void 0,href:(0,d.Wl)(e.action)?void 0:e.action,className:(0,d.AK)({_disabled:!e.action&&!e.menu},e.className),toolTip:e.toolTip,color:e.color},s=e.icon?(0,v.tZ)(n.JO,{icon:e.icon,buttonLike:i,...r},t):e.label?(0,v.tZ)(b.l,{theme:"outlined",...r,children:e.label},t):e.text?(0,v.tZ)("div",{style:{lineHeight:"30px"},className:r.className,children:e.text}):"";return e.menu?(0,v.tZ)(p.x,{options:e.menu,onSelect:e.onSelect,n:!0,children:s},t):s}))}):null},y=(0,r.iv)("color:",s.g.colors.text_sec,";>div{display:inline-block;border:1px solid ",s.g.colors.separator_light,";border-radius:7px;padding:0.3em;cursor:pointer;.Icon{vertical-align:bottom;}}>*+*{",s.g.classes.margin_near(".5em"),";}",""),w=e=>{let{icons:t,value:i=[],onChange:r}=e;return(0,v.tZ)("div",{css:y,children:t.map((e=>{const t=i.includes(e.val);return(0,v.BX)("div",{onClick:()=>r(t?i.filter((t=>t!==e.val)):[...i,e.val]),children:[(0,v.tZ)(n.JO,{icon:e.icon,color:t?e.color:void 0})," "+e.label.caps()]},e.val)}))})},x=e=>{let{filters:t,sorts:i,filtersVals:n={},sort:r={},onFilter:s,onSort:p,compactView:u=!1,onViewSelect:m,title:g,spreadFilters:b,actions:_,extraComponent:f,delay:y=200,checkAll:x,alwaysShow:k,collection:Z,sticky:S,zIndex:O,displayCount:B,minHeight:T=""}=e;const[N,I]=(0,l.useState)(n),D=(0,l.useRef)();(0,h.iP)(),b=!(0,d.tq)()&&b,D.current||N===n||I(n),(0,l.useEffect)((()=>()=>clearTimeout(D.current)),[]);const j=e=>{I(e),D.current=clearTimeout(D.current),s&&(D.current=setTimeout((()=>(D.current=null,s(e))),y))};let P,z;const E=(t||[]).filter((e=>!!e&&("tab"===e.type?(P=e,!1):"button_toggle"!==e.type||(z=e,!1))));let R={};return((null==Z?void 0:Z.length)>1||(null==t?void 0:t.length)>0||(null==i?void 0:i.length)>0||k)&&(R={actions:_,extraComponent:f,onViewSelect:m,compactView:u,checkAll:x,tabs:P&&(0,v.tZ)(o.m,{tabs:P.options,inContainerHead:!0,activeTab:N[P.name]&&N[P.name][0]||"",onSelect:e=>j((0,d.v7)(Object.assign({},N,{[P.name]:e?[e]:""})))}),togglers:z&&(0,v.tZ)(w,{icons:z.options,value:N[z.name],onChange:e=>j((0,d.v7)(Object.assign({},N,{[z.name]:e})))}),sorts:(null==i?void 0:i.length)>0&&(0,v.tZ)(a.P,{sorts:i,by:r.by,desc:r.desc,className:"_sort",onSort:e=>p&&p(e)}),filters:E.length>0&&(0,v.tZ)(c.wn,{spreadFilters:b,filters:E,filtersVals:N,className:"_filter",onFilter:e=>j(e)})}),(!(0,d.xb)(R)||g)&&(0,v.tZ)(C,{...R,title:g,sticky:S,spreadFilters:b,zIndex:O,displayCount:B,minHeight:T})},k=(0,l.createContext)(null),Z=(e,t,i,n)=>(0,r.iv)("display:",n?"block":"flex",";align-items:",n?"flex-start":"flex-end",";color:",s.g.colors.text_main,";",t||void 0!==e?`z-index: ${t||s.g.z.widget_bar+1}`:"",";",i?`min-height: ${i};`:""," ",s.g.mQuery.notMobile,"{",void 0!==e&&(0,r.iv)("position:sticky;top:",e,"px;background:",s.g.colors.bg_main,";padding:5px;",""),";}.extra-component{",s.g.classes.margin_far("10px"),";}&.light{color:white;}._title{font-size:1.4em;font-weight:700;}._sort{",s.g.classes.margin_near("20px"),";}._filter{",s.g.classes.margin_near(n?"0":"20px"),";display:inline-flex;}._view_button{",s.g.classes.margin_near("20px"),";cursor:pointer;}.bar-other-side{display:flex;align-items:center;}&.with-tabs{.bar-other-side{padding-bottom:7px;}}&.bright{._label{color:#d4d4d4;}._btn span{color:#FFF;}}",s.g.mQuery.mobile,"{display:block;.bar-other-side{flex-wrap:wrap;._sort{",s.g.classes.margin_near("0"),";}}}",""),C=function(e){let{title:t,tabs:i,togglers:r,actions:s,spreadFilters:o,extraComponent:a,sorts:c,filters:p,onViewSelect:h,compactView:b=!1,checkAll:_=null,sticky:y,zIndex:w,displayCount:x=[],minHeight:C=""}=e;const S=(0,l.useContext)(k);let O=o?[p,a&&(0,v.tZ)("div",{className:"extra-component",children:a}),c]:[a&&(0,v.tZ)("div",{className:"extra-component",children:a}),c,p];const B=(0,v.BX)("div",{className:"bar-other-side",children:[(null==x?void 0:x.display)&&(0,v.tZ)("div",{style:{margin:"0 20px"},children:`${lng("items").caps()}: ${x.count}`}),r,O.map(((e,t)=>(0,v.tZ)(l.Fragment,{children:e},t))),h&&(0,v.tZ)("div",{children:(0,v.tZ)(n.JO,{icon:"view_"+(b?"list":"tiles"),className:"_view_button",onClick:()=>h(!b),toolTip:lng("toggle view")})}),_&&(0,v.tZ)(g.u,{text:lng("check all"),children:(0,v.tZ)(m.XZ,{value:_.checked,onChange:_.onCheck})})]});return i?(0,v.BX)("div",{css:Z(y,w,C,o),className:(0,d.AK)("Bar","with-tabs",S),children:[i,(0,v.tZ)(u.zh,{}),s&&(0,v.tZ)(f,{actions:s.filter((e=>e)),buttonLike:!0}),B]}):(0,v.BX)("div",{css:Z(y,w,C,o),className:(0,d.AK)("Bar",S),children:[t&&(0,v.tZ)("div",{className:"_title",children:"string"==typeof t?t.caps():t}),s&&(0,v.tZ)(f,{actions:s.filter((e=>e)),buttonLike:!0}),(0,v.tZ)(u.zh,{}),B]})}},6941:(e,t,i)=>{i.d(t,{M:()=>a});var n=i(1533),r=i.n(n),s=i(7363),o=i(8318);const a=e=>{let{children:t,parentEl:i}=e;const n=(0,s.useRef)();return n.current||(n.current=(0,o.wq)((0,o.YR)("BP"))),(0,s.useEffect)((()=>()=>document.body.removeChild(n.current)),[]),n.current.classList.add("BodyPortal"),n.current.__parentEl=i,r().createPortal(t,n.current)}},5940:(e,t,i)=>{i.d(t,{AE:()=>m,jR:()=>u,zx:()=>g,zy:()=>p});var n=i(917),r=i(6920),s=i(8318),o=i(441),a=i(2698),l=i(5944);const c=(0,n.iv)("display:inline-block;transition:background-color .3s ease-out,color .3s ease-out;user-select:none;padding:calc(.4em - 1px) 1em;border-radius:6px;min-width:55px;text-align:center;white-space:nowrap;@media (max-width: 600px){white-space:normal;}&._bold{font-weight:600;}&._disabled{background-color:",r.g.colors.disabled_background,";cursor:no-drop;border-color:",r.g.colors.disabled_background,";color:#444;}&._clickable:not(._disabled){cursor:pointer;}&._chunky{margin-top:10px;padding-top:10px;padding-bottom:10px;}",""),d={name:"hkj8ri",styles:"background-color:#F6F6F6;color:#444;&._clickable:not(._disabled):hover{background-color:#f0f5ff;}"},p=(0,n.iv)("background-color:",r.g.colors.bg_cont,";color:#444;&._clickable:not(._disabled):hover{background-color:",r.g.colors.dominant_main_shade,";}",""),u=(0,n.iv)("background-color:",r.g.colors.positive,";color:white;&._clickable:not(._disabled):hover{background-image:linear-gradient(45deg, rgba(0, 0, 0, .2), rgba(0, 0, 0, .2));}",""),m=(0,n.iv)("background-color:",r.g.colors.negative,";color:white;&._clickable:not(._disabled):hover{background-image:linear-gradient(45deg, rgba(0, 0, 0, .2), rgba(0, 0, 0, .2));}",""),g=function(e){let t,i,{children:n,theme:r,bold:p,chunky:u,className:m,disabled:g,onClick:h,active:b,formButton:v,allowMultipleClicks:_,...f}=e;const y={...f,css:[c,r||d],className:(0,s.AK)("Button",m,{_clickable:h||f.href,_bold:p,_disabled:g,_active:b,_chunky:u})};return h&&(y.onClick=e=>{g||t||h(e),_||(t=!0,clearTimeout(i),i=setTimeout((()=>t=!1),350))}),f.href?(0,l.tZ)(o.A,{...y,children:n}):v?(0,l.tZ)("button",{...y,disabled:g,children:n}):(0,l.tZ)(a.LZ,{...y,children:n})}},5155:(e,t,i)=>{i.d(t,{O:()=>d});var n=i(917),r=i(6920),s=i(8318),o=i(7392),a=i(6344),l=i(5944);const c=(0,n.iv)("border-radius:",r.g.consts.BUTTON_BORDER_RADIUS,"px;border-width:2px;padding-top:5px;padding-bottom:5px;white-space:normal;&.fb_shade:not(._disabled){background-color:",r.g.colors.dominant_main_shade,";&._clickable:hover{box-shadow:0 2px 4px ",(0,a.mR)(r.g.colors.dominant_main,.5),";}}&.primary{min-width:100px;}.Icon{",r.g.classes.float,";}",""),d=e=>{let{children:t,label:i,primary:n,onClick:r,disabled:a,highlight:d,...p}=e;return(0,l.tZ)(o.l,{...p,theme:n?"contained":"outlined",css:c,bold:!0,active:d,disabled:a,onClick:r,className:(0,s.AK)({primary:n,fb_shade:!n},p.className),children:i||t})}},9793:(e,t,i)=>{i.d(t,{b:()=>a});var n=i(917),r=i(6920),s=i(5944);const o=(0,n.iv)("margin:0 5px;display:inline-block;vertical-align:bottom;.task-button{font-size:1.2em;padding:3px 5px 2px;margin:0 4px;display:inline-block;border:1px solid ",r.g.colors.separator,";border-radius:5px;cursor:pointer;&:hover{",r.g.classes.shadow_strong,";}&._filled{color:",r.g.colors.light_blue,";border:1px solid ",r.g.colors.light_blue,";}}",r.g.mQuery.mobileNarrow,"{display:inline-flex;margin-bottom:7px;}",""),a=e=>{let{children:t}=e;return(0,s.tZ)("div",{css:o,children:t})}},6364:(e,t,i)=>{i.d(t,{$:()=>d});var n=i(7363),r=i(81),s=i(6920),o=i(917),a=i(2755),l=i(5944);const c=(0,o.iv)("box-shadow:0 3px 6px rgba(0,0,0,0.16);padding:.7em;font-size:1.5rem;position:fixed;",s.g.classes.far("1em"),";bottom:1em;z-index:1;",""),d=function(){const[e,t]=(0,n.useState)(!1),i=(0,n.useCallback)((()=>t(window.pageYOffset>window.innerHeight)),[]);(0,r.OR)("scroll",i);return e?(0,l.tZ)(a.ZT,{css:c,bgColor:s.g.theme.color_1,icon:"arrow_up",onClick:()=>{window.scroll({top:0,left:0,behavior:"smooth"})}}):null}},7392:(e,t,i)=>{i.d(t,{V:()=>h,l:()=>m});var n=i(917),r=i(6920),s=i(5940),o=i(6344),a=i(5944);const l=r.g.colors.dominant_main,c=(0,n.iv)("background-color:transparent;color:",l,";&._clickable:not(._disabled):hover{background-color:",r.g.colors.dominant_main_shade,";}",""),d=(0,n.iv)("border:1px solid ",l,";color:",l,";&._clickable:not(._disabled):hover{background-color:",r.g.colors.dominant_main_shade,";}",""),p=(0,n.iv)("border:1px solid ",l,";background-color:",l,";color:white;&._active{border-color:",r.g.colors.dominant_orange,";&:not(._disabled){background-color:",r.g.colors.dominant_orange,";}}&._cancel{border-color:",r.g.colors.negative,";&:not(._disabled){background-color:",r.g.colors.negative,";}}&._clickable:not(._disabled):hover{box-shadow:0 2px 4px ",(0,o.mR)(l,.5),";background-color:",(0,o.HO)(l,-.1),";&._active{background-color:",r.g.colors.dominant_orange,";}}",""),u=(0,n.iv)("background-color:white;color:",r.g.colors.blossom,";font-weight:600;&._active,&:hover{color:white;background-color:",r.g.colors.blossom,";}",""),m=function(e){let t,{children:i,theme:n,...r}=e;switch(n){case"contained":t=p;break;case"outlined":t=d;break;case"composed":t=u;break;default:t=c}return(0,a.tZ)(s.zx,{theme:t,...r,children:i})},g=parseInt(window.innerWidth/46),h=e=>(0,a.tZ)(m,{...e,style:{fontSize:window.innerWidth>368?".8em":`.${g}em`,margin:"0 5px"}})},2755:(e,t,i)=>{i.d(t,{ZT:()=>c,bV:()=>d,kT:()=>u});var n=i(917),r=i(6920),s=i(6975),o=i(3051),a=i(5944);const l=(e,t,i,s)=>(0,n.iv)("transition:color .3s ease-out,background-color .3s ease-out;.el_icon,&.el_icon{background-color:",e||r.g.colors.dominant_main,";color:",t||"#fff",";width:",i,"px;min-width:",i,"px;height:",i,"px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;font-size:",s||i/2,"px;cursor:pointer;}",""),c=function(e){let{bgColor:t,color:i,size:n=45,iconSize:r=null,...o}=e;return(0,a.tZ)(s.JO,{css:l(t,i,n,r),...o})},d=function(e){let{icons:t=[],size:i}=e;return(0,a.tZ)("div",{className:"RoundIconBatch",children:t.filter((e=>!!e)).map((e=>{const t=(0,a.tZ)(c,{...e,size:i,menu:void 0},e.icon);return e.menu?(0,a.tZ)(o.x,{options:e.menu,children:t},e.icon):t}))})},p=(e,t)=>(0,n.iv)("background-color:#FFF;border-radius:50%;width:",t,"px;height:",t,"px;display:flex;justify-content:center;align-items:center;font-size:",t/2.5,"px;.ring{display:flex;justify-content:center;align-items:center;width:",t-4,"px;height:",t-4,"px;border-radius:50%;border:4px solid ",e,";>.Icon{line-height:0;}}",""),u=e=>{let{color:t,size:i=45,...n}=e;return(0,a.tZ)("div",{css:p(t,i),children:(0,a.tZ)("div",{className:"ring",children:(0,a.tZ)(s.JO,{color:t,...n})})})}},5898:(e,t,i)=>{i.d(t,{Cj:()=>$,dR:()=>L,jC:()=>N,kO:()=>J,rp:()=>V,xr:()=>D});var n=i(7363),r=i(917),s=i(6920),o=i(81),a=i(3755),l=i(3051),c=i(4902),d=i(5405),p=i(5007),u=i(6975),m=i(8318),g=i(9483),h=i(7154),b=i(441),v=i(2755),_=i(5562),f=i(247),y=i(1619),w=(i(2906),i(5560)),x=i(8152),k=i(1858),Z=i(5311),C=(i(7882),i(5680)),S=i(919),O=i(6597),B=i(5944);const T=(e,t,i)=>(0,r.iv)("display:inline-block;color:",i||"white",";",t?"":`box-shadow: 0 1px 3px ${i||e}`,";background-color:",e,";white-space:nowrap;padding:0 6px;line-height:1.7;vertical-align:middle;border-radius:",s.g.consts.FIELD_BORDER_RADIUS,"px;height:fit-content;",""),N=e=>{let{color:t,icon:i,children:n,title:r,text:o,className:a,noBoxShadow:l,accentColor:c}=e;const d=(0,B.BX)("div",{css:T(s.g.func.color(t),l,c),className:(0,m.AK)("_note",a),children:[i&&(0,B.tZ)(u.JO,{icon:i}),i&&(o||n)&&" ",o,o&&" ",n]});return r?(0,B.tZ)(h.u,{text:r,children:d}):d},I=(0,r.iv)(O.N,";&:hover ._fore{transform:translateY(-10px);}._fore{z-index:1;display:flex;flex-direction:column;height:210px;min-height:210px;max-height:min(100vh, 280px);transition:transform .1s ease-out;&:hover{z-index:2;}&.opened{height:auto;._top{&:after{content:none;}}}}&.short{._fore{height:180px;min-height:180px;&.opened{height:auto;}}}&.smooth-theme{._fore{width:100%;left:0;top:158px;border-radius:0 0 18px 18px;height:185px;min-height:185px;&.opened{height:auto;}}}",s.g.mQuery.mobile,"{._back ._a_play{opacity:1;}}&:hover{._fore ._top ._title{text-decoration:underline;}._back ._a_play{opacity:1;}}.card-actions{display:flex;.Icon{font-size:1.6em;&:first-of-type{",s.g.classes.margin_far("4px"),";}}}.bottom-note{display:flex;margin:3px 0;align-items:center;}",""),D=e=>(0,B.tZ)(d.aK,{children:(0,B.tZ)(j,{...e})}),j=(0,w.observer)((e=>{let{playLink:t,assignee:i,className:r,inContainer:s,onMenuSelect:a,entity:l,noComments:c,onTitleClick:d,noAction:u}=e;const[g,h]=(0,n.useState)(!1),{events:b}=(0,o.Xf)(500,(()=>h(!0)),(()=>h(!1))),v=(0,n.useContext)(p.l9);(0,m.B5)(i)&&(t.params=[],t.params.assignee=i);return(0,B.BX)("div",{css:I,className:r,children:[(0,B.tZ)(E,{entity:l,noAction:u,playLink:t}),(0,B.BX)("div",{className:(0,m.AK)("_fore",{in_container:s,opened:g}),onMouseLeave:b.onMouseLeave,children:[(0,B.tZ)(F,{entity:l,onMouseEnter:b.onMouseEnter,mouseOverFore:g,onMenuSelect:a,onTitleClick:d,playLink:t}),(0,B.tZ)(A,{entity:l,noComments:c,onCommentsClick:()=>{l.workspace?l.workspace.setActiveComponent(l.assignment_id,"comments"):v.showSideDrawer(l,{tab:"comments"})},bookmarkClick:()=>{var e;return null===(e=l.toggleBookmark)||void 0===e?void 0:e.call(l)},LikesClick:()=>{var e;return null===(e=l.toggleLike)||void 0===e?void 0:e.call(l)}})]})]})})),P=e=>(0,r.iv)("&._back{position:absolute;width:100%;height:240px;background-color:silver;background-size:cover;background-position:center;",s.g.classes.shadow_light,";.mainNote{",s.g.classes.near("7%"),";top:4%;position:absolute;}.circledImage{position:absolute;top:10px;left:10px;border:3px solid white;}.match-rate{position:absolute;top:",e?"35px":"10px",";",s.g.far,":10px;border-radius:20px;font-size:.9rem;padding:5px;background-color:",s.g.colors.warning,";color:white;}._manager{position:absolute;top:10px;",s.g.classes.far("20px"),";}.subNote{position:absolute;top:100px;",s.g.classes.far("10px"),";text-overflow:ellipsis;overflow:hidden;max-width:50%;color:",s.g.colors.blue,";background-color:",s.g.colors.blue_shade,";display:inline-block;",s.g.classes.shadow_strong,";white-space:nowrap;padding:0 6px;line-height:1.7;vertical-align:middle;border-radius:",s.g.consts.SKINNY_BORDER_RADIUS,"px;}}",""),z={name:"1imcpwn",styles:"border-radius:20px 20px 0 0;position:relative;width:100%;height:240px;overflow:hidden"},E=e=>{var t;let{entity:i,noAction:n,playLink:r}=e;const o=i.cardNote,{image:a,circledImage:l,completed:d,status:p,notice:m,isManager:g,subNote:b,type:_,assignment_access_limit:f,running_times:y,matchRate:w}=i,x=r?"workspace"===_||i instanceof S.O?"enter":"play":"lock";return(0,B.BX)("div",{css:z,children:[" ",(0,B.BX)("div",{css:P(g),className:"_back",style:{backgroundImage:`url("${a}")`},children:[l&&(0,B.tZ)(c.cU,{img:l,size:"100px",className:"circledImage",shadowed:!0}),w>0&&(0,B.tZ)("div",{className:"match-rate",children:(0,B.BX)(h.u,{text:lng("skill match percent").caps(),children:[w,"%"]})}),d?(0,B.BX)(N,{title:i.gradeInfo?i.gradeInfo.label+": "+i.gradeInfo.displayGrade:"",color:s.g.colors.positive,className:"mainNote",children:[(0,B.tZ)(u.JO,{icon:"mark_v_light"})," ",null==p||null===(t=p.text)||void 0===t?void 0:t.caps()]}):f>0?(0,B.tZ)(N,{color:y>=f?s.g.colors.negative:s.g.colors.light_blue,className:"mainNote",children:`${lng("accessed").caps()} ${y||0}/${f}`}):(null==o?void 0:o.text)&&(0,B.tZ)(N,{...o,className:"mainNote"}),!n&&(0,B.tZ)(X,{link:r,icon:x,iconTooltip:r?null:m}),g&&(0,B.tZ)(v.ZT,{className:"_manager",icon:"manager",toolTip:lng("you are a manager"),color:"#FFF",bgColor:s.g.colors.half_black,size:18,iconSize:11}),b&&(0,B.tZ)("span",{className:"subNote",children:(0,B.tZ)(h.u,{text:b.caps(),children:b.truncate(15,"...")})})]})]})},R=(0,r.iv)("&._top{overflow:hidden;position:relative;transition:max-height ",400,'ms ease-out;flex-grow:1;&:after{content:"";position:absolute;background-image:linear-gradient(to bottom, transparent, ',s.g.colors.bg_cont,");height:2em;bottom:0;left:0;right:0;}._title{display:block;margin-top:3px;max-height:4.1em;overflow:hidden;color:",s.g.colors.text_main,";font-size:1.28em;font-weight:700;cursor:pointer;}._subTitle{color:",s.g.colors.text_placeholder,";margin-bottom:5px;display:inline-block;}a._subTitle:hover{text-decoration:underline;}._tags{margin:7px 0;}._description{max-height:110px;>div{width:230px;}}._dependencies{margin-bottom:10px;span{display:inline-block;",s.g.classes.margin_far("7px"),";padding:0 3px;}.done{border-bottom:2px solid ",s.g.colors.positive,";}.not-done{border-bottom:2px solid ",s.g.colors.negative,";}}}",""),F=e=>{var t,i;let{entity:n,onMouseEnter:r,mouseOverFore:o,onMenuSelect:a,onTitleClick:c,playLink:d}=e;const{title:p,subTitle:b,category:v,category_id:f,hide_type:w,description:S,subs:O,statistics:T,activityDates:N,tags:I}=n,D=w?null:n.type_title,j=null===(t=n.menu)||void 0===t?void 0:t.call(n),P=null===(i=n.dependencies)||void 0===i?void 0:i.call(n);return(0,B.BX)("div",{css:R,className:"_top",onMouseEnter:r,children:[(0,B.BX)(Z.c_,{children:[(0,B.BX)("div",{children:[b&&(0,B.tZ)("span",{className:"_subTitle",children:b}),(0,B.tZ)(g.m,{elType:d&&!c?"a":"span",className:"_title",href:c?void 0:d,onClick:c,children:(0,B.tZ)(k.u,{text:p,floor:10,ceiling:45})})]}),(0,B.tZ)(Z.zh,{}),j&&(0,B.tZ)("div",{children:(0,B.tZ)(l.x,{className:"_menu",options:j,onSelect:a,children:(0,B.tZ)(u.JO,{icon:"menu_h",smallButtonLike:!0})})})]}),(D||v)&&(0,B.BX)(g.m,{className:"_tags",children:[D&&(0,B.tZ)("span",{css:n._attr.group_type?s.g.classes.ws_type_style:s.g.classes.content_type_style,className:(0,m.AK)({_required_course:n.qualificationRequirement&&!n._attr.optional}),children:D.caps()}),D&&v&&(0,B.tZ)(u.An,{}),v&&(0,B.tZ)(x.W,{category:v,category_id:f})]}),!T&&(null==P?void 0:P.length)>0&&(0,B.tZ)(h.u,{text:lng("prerequisites").caps(),className:"_dependencies",children:P.map((e=>(0,B.BX)("span",{className:e.satisfied?"done":"not-done",children:[(0,B.tZ)(u.An,{}),e.assignment_name||e.lesson_name]},e.assignment_id)))}),!T&&((null==S?void 0:S.text)||I)&&(0,B.BX)(g.m,{className:"_description",style:o?{overflow:"auto"}:{},children:[I&&(0,B.tZ)(C.r$,{children:I.map((e=>(0,B.tZ)(C.Vp,{tag:e,smaller:!0},`${e}_${Math.random()}`)))}),(null==S?void 0:S.text)&&(S.isHtml?(0,B.tZ)(y.xn,{content:S.text}):(0,B.tZ)("div",{children:S.text}))]}),N&&(0,B.tZ)(_.L0,{start:N.start,end:N.end}),(null==O?void 0:O.length)>0&&(0,B.BX)("div",{children:[(0,B.tZ)("div",{style:{fontWeight:"600"},children:lng("sub assignments").caps()}),O.map((e=>(0,B.BX)("div",{children:[(0,B.tZ)(u.An,{}),e.assignment_name,(0,B.tZ)(u.An,{}),(0,B.tZ)("span",{css:s.g.classes.content_type_style,children:e.type_title})]},e.assignment_id)))]})]})},M=(0,r.iv)("&._bottom{padding:7px 0;&._separator{border-top:1px solid ",s.g.colors.separator,";}._progress{margin-bottom:7px;}._meta{display:flex;justify-content:space-between;._comments{line-height:29px;cursor:pointer;.Icon-discussion{font-size:1.6em;vertical-align:sub;display:inline-block;",s.g.classes.margin_far(".5em"),";}span+span{text-decoration:underline;}}}.duration{font-size:1.1rem;vertical-align:sub;display:flex;align-items:center;.Icon{font-size:1.2rem;",s.g.classes.margin_far("4px"),";}}}",""),A=e=>{var t,i,n;let{entity:r,noComments:s,onCommentsClick:o,bookmarkClick:l,LikesClick:d}=e;const{commentsInfo:p,users:g,countUsers:b,progress:v,registerNumbers:_,statistics:y,views:w,duration:x,bottomNote:k}=r,Z=!s,C=!y&&((0,m.DM)(r.bookmarked)||(0,m.DM)(r.mayLike)||w>0),S=Z||(null==g?void 0:g.length)||C;return(0,B.BX)("div",{css:M,className:(0,m.AK)("_bottom",{_separator:!v&&S}),children:[v&&(0,B.tZ)(a.k,{numerator:v.progress[0],denominator:v.progress[1],valueInBar:null===(t=v.settings)||void 0===t?void 0:t.valueInBar,label:null===(i=v.settings)||void 0===i?void 0:i.label,color:null===(n=v.settings)||void 0===n?void 0:n.color,valueNote:r.attr("exemptions")?(0,B.BX)(h.u,{text:lng("number of exemptions"),children:["(",r.attr("exemptions"),")"]}):null,className:"_progress"}),(0,B.BX)("div",{className:"_meta",children:[!y&&Z&&r.maySeeCommentsTab&&(0,B.tZ)("div",{className:"_comments",onClick:o,children:(0,B.BX)("span",{children:[(0,B.tZ)(u.JO,{icon:"discussion"}),(0,B.tZ)("span",{children:(null==p?void 0:p.count)>0?`${null==p?void 0:p.count} ${lng("comments")}`:lng("say something").caps()})]})}),(null==g?void 0:g.length)>0&&(0,B.tZ)(c.I9,{users:g,totalCount:b||(null==g?void 0:g.length),maxSlots:3}),y&&(0,B.tZ)(f.om,{...y}),C&&(0,B.BX)("div",{className:"card-actions",children:[_&&(0,B.tZ)(H,{regNumbers:_}),(null==r?void 0:r.maySeeViews)&&w>0&&(0,B.tZ)(J,{views:w}),(0,m.DM)(r.bookmarked)&&(null==r?void 0:r.mayToggleBookmark)&&(0,B.tZ)(V,{entity:r,onClick:l}),r.mayLike&&(0,B.tZ)(L,{entity:r,onClick:d}),r.togglePin&&(0,B.tZ)(U,{onClick:()=>r.togglePin(),entity:r}),r.mayRecommend&&(0,B.tZ)($,{entity:r,onClick:()=>r.Recommend()})]}),(0,B.BX)("div",{className:"bottom-note",children:[k&&(0,B.tZ)("div",{children:k.text})," ",k&&x&&(0,B.tZ)("span",{children:"|"})," ",x&&(0,B.BX)("div",{children:[(0,B.tZ)(u.JO,{icon:"sand_clock"})," ",x]})]})]})]})},q={name:"tzlwj9",styles:"._a_play{transition:opacity .1s ease-out;width:1em;cursor:pointer;position:absolute;top:44px;left:calc(50% - 20px);&:not(._a_lock){opacity:0;}&._a_lock{cursor:initial;}.RTL &{left:auto;right:calc(50% - 20px);}.dark{top:-3px;left:-2px;position:absolute;font-size:55px;color:rgba(120, 120, 120, .15);.RTL &{left:auto;right:-3px;}}.shadow{position:absolute;font-size:55px;color:rgba(0, 0, 0, .35);.RTL &{right:-3px;}}.light{position:absolute;font-size:50px;color:rgba(255, 255, 255, .95);}}"},X=e=>{let{link:t,icon:i,iconTooltip:n}=e;return(0,B.tZ)("div",{css:q,children:(0,B.BX)(b.A,{href:t,className:(0,m.AK)("_a_play",{_a_lock:!t}),processHrefClick:!0,children:[(0,B.tZ)(u.JO,{className:"dark",icon:i}),(0,B.tZ)(u.JO,{className:"shadow",icon:i}),(0,B.tZ)(u.JO,{className:"light",icon:i,toolTip:n})]})})},L=(0,w.observer)((e=>{let{entity:t,onClick:i}=e;const{likesCount:n,likesVote:r}=t;return(0,B.tZ)(u.JO,{icon:r?"love_full":"love",toolTip:lng("loved it"),badge:n||void 0,onClick:i,color:r?s.g.colors.pink:void 0,smallButtonLike:!0})})),$=(0,w.observer)((e=>{let{onClick:t}=e;return(0,B.tZ)(u.JO,{icon:"recommend",toolTip:lng("recommend"),onClick:t,smallButtonLike:!0})})),V=(0,w.observer)((e=>{let{entity:t,onClick:i}=e;return(0,B.tZ)(u.JO,{icon:t.bookmarked?"bookmark_filled":"bookmark",toolTip:t.bookmarked?lng("remove from bookmarks"):lng("add to bookmarks"),onClick:i,color:t.bookmarked?s.g.colors.dominant_main:void 0,smallButtonLike:!0})})),U=(0,w.observer)((e=>{let{entity:t,onClick:i}=e;return(0,B.tZ)(u.JO,{icon:t.following?"pin_filled":"pin",toolTip:t.following?lng("unpin"):lng("pin"),onClick:i,color:t.following?s.g.colors.dominant_main:void 0,smallButtonLike:!0})})),H=(0,w.observer)((e=>{let{regNumbers:t}=e;const{members:i}=t;return(0,B.tZ)(u.JO,{icon:"user_empty",badge:i})})),J=e=>{let{views:t}=e;return(0,B.tZ)(u.JO,{icon:"preview",badge:t,color:s.g.colors.yellow,toolTip:lng("views"),smallButtonLike:!0})}},6597:(e,t,i)=>{i.d(t,{N:()=>s});var n=i(917),r=i(6920);const s=(0,n.iv)("display:inline-block;position:relative;width:",r.g.consts.CARD_WIDTH,"px;min-width:",r.g.consts.CARD_WIDTH,"px;height:",r.g.consts.CARD_HEIGHT,"px;color:",r.g.colors.text_sec,";._fore{position:absolute;width:93%;left:3.5%;top:133px;border-radius:18px;background-color:",r.g.colors.bg_cont,";padding:10px 15px 0;",r.g.classes.shadow_strong,";&.in_container{",r.g.classes.shadow_strong,";z-index:auto;}}","")},1991:(e,t,i)=>{i.d(t,{T:()=>h});var n=i(917),r=i(6920),s=i(7363),o=i(81),a=i(5338),l=i(8318),c=i(2755),d=i(4682),p=i(5944);const u=(0,n.iv)("position:relative;>._scroll{position:absolute;top:0;left:0;width:100%;overflow-x:hidden;pointer-events:none;>div>div._strip{pointer-events:initial;display:flex;>div{",r.g.classes.margin_near(r.g.consts.CARDS_SPACING+"px"),";&:first-of-type{",r.g.classes.margin_near("0"),";}}}}>.scroll_back,>.scroll_fore{position:absolute;top:80px;border:2px solid ",r.g.colors.dominant_main,";z-index:1;opacity:0.75;&:hover{opacity:0.9;}&.scrolling{opacity:.2;}&.scroll_back{",r.g.near,":10px;}&.scroll_fore{",r.g.far,":20px;}}",""),m=(0,n.iv)("&.inOpenPage{",r.g.classes.content_width,";}&.floatingControls{position:relative;>div{position:absolute;bottom:1em;",r.g.classes.far(0),";}}&:not(.inOpenPage){text-align:",r.g.far,";margin-bottom:10px;}>div{direction:ltr;}._go_button{font-size:0.9em;",r.g.classes.margin_near("1em"),";}.pages{display:inline-flex;}","");var g={name:"g46w8s",styles:"margin-bottom:30px"};const h=e=>{let{children:t,cardHeight:i=345,expandHeight:n=450,extraComponent:h,inOpenPage:b,floatingControls:v,showListButton:_}=e;const[f,y]=(0,s.useState)(!1),[w,x]=(0,s.useState)(!1),[k,Z]=(0,s.useState)(1),[C,S]=(0,s.useState)(0),[O,B]=(0,s.useState)(!1);(0,o.iP)();const T=(0,s.useRef)(null),N=(0,s.useRef)(null),I=(0,s.useRef)(0),D=()=>{const e=N.current,t=Math.round(Math.abs(e.scrollLeft)),i=P(),n=e.scrollWidth<=e.offsetWidth?1:Math.ceil(e.scrollWidth/i),r=Math.ceil(t/i);Z(n),S(r),y(r>0),x(r<n-1)},j=()=>{if(!b)return;const e=T.current.parentNode.offsetWidth;I.current=Math.max(0,Math.min(30,e-r.g.consts.CONTAINER_MIN_WIDTH),e-r.g.consts.PAGE_CONTENT_MAX_WIDTH)/2,N.current.style[`padding${r.g.near.caps()}`]=I.current+"px"},P=()=>{var e;const t=N.current,i=(null===(e=t.querySelector("._strip > div"))||void 0===e?void 0:e.offsetWidth)+r.g.consts.CARDS_SPACING;return Math.max(1,Math.floor((t.offsetWidth-I.current)/i))*i},z=e=>{O||(B(!0),E(C+1*(e?-1:1)))},E=e=>{if(e<0||e>=k)return;const t=e*P()*(r.g.isRTL?-1:1),i={duration:.5,ease:"easeInOut",onUpdate:e=>N.current.scrollLeft=e};setTimeout((()=>(0,d.j)(N.current.scrollLeft,t,i).then((()=>(B(!1),j(),D())))),0)};return(0,p.BX)("div",{ref:e=>{T.current=e,e&&(j(),D())},className:"CardsCarousel",css:g,children:[(h||_)&&(0,p.tZ)("div",{css:m,className:(0,l.AK)("_controls",{inOpenPage:b,floatingControls:v}),children:(0,p.tZ)("div",{children:h})}),(0,p.BX)("div",{css:u,style:{height:i+"px"},children:[f&&(0,p.tZ)(c.ZT,{icon:"arrow_near",bgColor:r.g.colors.bg_cont,color:r.g.colors.dominant_main,className:(0,l.AK)("scroll_back",{scrolling:O}),onClick:()=>z(!0)}),w&&(0,p.tZ)(c.ZT,{icon:"arrow_far",bgColor:r.g.colors.bg_cont,color:r.g.colors.dominant_main,className:(0,l.AK)("scroll_fore",{scrolling:O}),onClick:()=>z()}),(0,p.tZ)("div",{className:"_scroll",ref:N,style:{height:i+n+"px"},children:(0,p.tZ)(a.mp,{onSwipedLeft:()=>z(r.g.isRTL),onSwipedRight:()=>z(!r.g.isRTL),delta:20,children:(0,p.tZ)("div",{className:"_strip",children:t})})})]})]})}},8152:(e,t,i)=>{i.d(t,{W:()=>b});var n=i(7821),r=i(8e3),s=i(7154),o=i(5560),a=i(8318),l=i(6920),c=i(6975),d=i(917),p=(i(7882),i(5944));const u={name:"1xca2wz",styles:"font-size:1rem;display:flex;align-items:center;gap:10px"},m=(0,n.observable)(new Map),g=(e,t)=>{if(m.has(e))return m.get(e);t&&(m.set(e,!1),(0,r.SC)("domains/category_path/"+e,{},(t=>{Array.isArray(t)?m.set(e,(0,p.tZ)("div",{css:u,children:t.map(((e,t)=>(0,p.BX)(p.HY,{children:[t>0&&(0,p.tZ)("div",{children:(0,p.tZ)(c.JO,{icon:"arrow_far"})}),(0,p.tZ)("div",{children:e.caps()},e+t)]})))})):"string"!=typeof t&&1!==t.length||m.set(e,t)})))},h=(0,d.iv)("font-weight:600;",l.g.classes.ellipsis,";max-width:280px;display:inline-flex;",""),b=(0,o.observer)((e=>{let{category:t,category_id:i}=e;return(0,a.B5)(i)?(0,p.tZ)(s.y,{content:g(i)||lng("loading...").caps(),theme:"bln-tooltip-dark",children:(0,p.tZ)("span",{css:h,onMouseEnter:()=>g(i,!0),children:t})}):(0,p.tZ)("span",{style:{fontWeight:600},children:t})}))},8207:(e,t,i)=>{i.d(t,{$0:()=>x,T:()=>O,U0:()=>T,W2:()=>f,uD:()=>j});var n=i(917),r=i(6920),s=i(6975),o=i(8318),a=i(81),l=(i(539),i(5405)),c=i(7392),d=i(2755),p=i(9483),u=i(1042),m=i(7363),g=i(4210),h=i(5944);const b=(0,o.tq)()?8:20,v=(0,o.tq)()?16:20,_=(0,n.iv)("position:relative;background-color:",r.g.colors.bg_cont,";border-radius:",r.g.consts.CONT_BORDER_RADIUS,"px;&.cont-empty{background-color:",r.g.colors.bg_1,";margin-bottom:40px;}._children.padded{padding:",v,"px ",b,"px;}._tail{margin:0 20px 10px;}&.fitWidth{",r.g.classes.content_width,";}",""),f=e=>{let{children:t,head:i,tail:n,fitWidth:r,className:s,stickyHead:a,noBottomPadding:c,padded:d=!0}=e;return(0,h.BX)("div",{css:_,className:(0,o.AK)(s,{fitWidth:r}),children:[i&&(0,h.tZ)(I,{stickyHead:a,noBottomPadding:c,children:i}),(0,h.tZ)("div",{className:(0,o.AK)("_children","container-children",{padded:d}),children:(0,h.tZ)(l.SV,{children:t})}),n&&(0,h.tZ)("div",{className:"_tail",children:n})]})},y=(0,n.iv)("display:flex;align-items:center;color:",r.g.colors.text_main,";white-space:nowrap;>.Icon-close{",r.g.classes.opposite_text_align,";color:",r.g.colors.text_sec,";cursor:pointer;font-size:1.2em;&:hover{color:",r.g.colors.negative,";}}>._title{font-size:1.2rem;font-weight:600;white-space:nowrap;max-width:1050px;overflow:hidden;text-overflow:ellipsis;display:inline-flex;align-items:center;",r.g.mQuery.max(1400),"{white-space:normal;}>.Icon{",r.g.classes.margin_far("10px"),";}",r.g.mQuery.mobile,"{height:67px;}}&.limitTitle{>._title{overflow:hidden;text-overflow:ellipsis;}}","");var w={name:"18stq5z",styles:"font-size:1.4rem"};const x=function(e){let{icon:t,title:i,headTabs:n,headExtra:o,headPrefix:a,onClose:l,poster:c}=e;const u=(null==t?void 0:t.icon)||t,m=null==t?void 0:t.color;return(0,h.BX)(h.HY,{children:[(0,h.BX)("div",{css:y,className:"floating-dialog-header",children:[a,!i&&t&&(0,h.tZ)(s.JO,{icon:u,color:m,css:w}),i&&(0,h.BX)("div",{className:"_title",children:[u&&(0,h.tZ)(d.ZT,{icon:u}),(0,h.tZ)(p.m,{children:null==i?void 0:i.caps()})]}),n,(0,h.tZ)("div",{css:r.g.classes.flex_grow}),o&&(0,h.tZ)("div",{style:{padding:"0 20px"},children:o}),l&&(0,h.tZ)(s.JO,{icon:"close",onClick:()=>l(),smallButtonLike:!0})]}),(null==c?void 0:c.image)&&(0,h.tZ)("div",{className:"poster",children:c.title&&(0,h.tZ)("div",{className:"poster-title",children:c.title})})]})},k=(0,n.iv)("position:fixed;z-index:",r.g.z.dialog_overlay,";top:0;left:0;width:100vw;height:100vh;background-color:rgba(0, 0, 0, .7);",""),Z=(0,n.iv)(r.g.classes.font_reset,";white-space:normal;",k,";display:flex;flex-direction:column;justify-content:center;align-items:center;",r.g.mQuery.mobile,"{justify-content:flex-start;}>div{max-width:100%;>div._main{display:flex;flex-direction:column;&.fullHeight{height:calc(95vh - ",r.g.consts.TOP_BAR_HEIGHT,"px);top:",r.g.consts.TOP_BAR_HEIGHT/2,"px;>._children{flex-grow:1;}}>._children{max-height:calc(100vh - 150px);overflow-y:auto;",r.g.mQuery.notMobile,"{box-sizing:content-box;}",r.g.mQuery.mobile,"{max-height:calc(100vh - 170px);padding-bottom:50px;}.container_splitter>*{max-height:calc(100vh - 150px);overflow-y:auto;}}}}._tailButtons{display:flex;justify-content:flex-end;}",r.g.mQuery.max(700),"{>div>div._main{border-radius:0;>._children.padded{margin:",v/2,"px 0;}}}",""),C=e=>(0,n.iv)(">div>._main{max-height:90vh;}.container-header{display:contents;.poster{background-image:url('",r.g.func.imgUrl(e),"');background-repeat:no-repeat;background-size:cover;background-position:top;min-height:250px;.poster-title{width:100%;background-color:rgba(240, 240, 240, 0.85);font-size:1.4rem;padding:20px;font-weight:600;margin-top:15px;}}}>div .floating-dialog-header{padding:10px 15px;}",""),S="700px",O=e=>{let{children:t,title:i,onClose:n,hideX:r,icon:s,className:l,width:d=S,fullHeight:p,headTabs:b,headExtra:v,headPrefix:_,tailButtons:y,padded:w,poster:k,zIndex:O}=e;(0,a.Ry)();const[B,T]=(0,m.useState)(!0),N=r?null:()=>T(!1),[I,{style:D,...j}]=(0,u.$V)({show:B,type:"blow",onHide:n}),P=(0,m.useContext)(g.q3);if(P&&(P.backFromDirty=()=>T(!0)),!I)return null;const z=(0,h.tZ)(x,{poster:k,title:i,icon:s,headTabs:b,headPrefix:_,headExtra:v,onClose:N}),E=y&&(0,h.tZ)("div",{className:"_tailButtons",children:y.map(((e,t)=>(0,h.tZ)(c.l,{...e,action:void 0,onClick:e.action,bold:!0,theme:t===y.length-1?"contained":void 0,children:e.label.caps()},t)))}),R=null==y?void 0:y.some((e=>e.keyboard)),F={width:d,...D};return"fit-content"===d&&(F.minWidth=S),(0,h.tZ)("div",{css:[Z,k&&C(k.image),"",""],style:{zIndex:O},className:l,onMouseDown:N?e=>e.currentTarget==e.target&&(0,o.Ds)(N,1)():void 0,children:(0,h.tZ)("div",{...j,style:F,onKeyUp:e=>null==y?void 0:y.filter((t=>t.action&&t.keyboard===e.key)).map((e=>!e.disabled&&e.action())),tabIndex:R?"0":void 0,className:R?"no_outline":void 0,children:(0,h.tZ)(f,{head:z,tail:E,className:(0,o.AK)("_main",{fullHeight:p}),padded:w,children:t})})})},B=(0,n.iv)("display:flex;>div{padding:",v,"px ",b,"px;flex:1 1 ",(0,o.w1)()?"auto":0,";border-",r.g.near,":1px solid ",r.g.colors.separator,";&:first-of-type{border-",r.g.near,":0;}}",r.g.mQuery.max(640),"{display:block;>div{border-",r.g.near,":0;border-top:1px solid ",r.g.colors.separator,";&:first-of-type{border-top:0;}}}",""),T=e=>{let{children:t}=e;return(0,h.tZ)("div",{css:B,className:"container_splitter",children:t})},N=(0,n.iv)("border-bottom:1px solid ",r.g.colors.separator,";padding:15px ",b,"px 10px;min-height:49px;&.stickyHead{position:sticky;top:0;background-color:",r.g.colors.bg_main,";z-index:1;th{border-radius:0;}}&.noBottomPadding{padding-bottom:0;}",""),I=e=>{let{children:t,stickyHead:i,noBottomPadding:n}=e;return(0,h.tZ)("div",{css:N,className:(0,o.AK)("container-header",{stickyHead:i,noBottomPadding:n}),children:t})},D={name:"pireoz",styles:"font-size:1.3rem;font-weight:700;margin-bottom:15px;&:not(:first-of-type){margin-top:45px;}"},j=e=>{let{children:t}=e;return(0,h.tZ)("div",{css:D,children:(0,h.tZ)(l.SV,{children:t})})}},3051:(e,t,i)=>{i.d(t,{h:()=>f,x:()=>_});var n=i(7363),r=i(917),s=i(6920),o=i(7154),a=i(6421),l=i(6975),c=i(8318),d=i(441),p=i(1042),u=i(5311),m=i(5944);const g=(0,r.iv)("text-align:",s.g.near,";>td>*{display:block;padding:9px 20px;color:",s.g.darkMode?s.g.colors.text_sec:"#444",";}td._has_label .Icon{",s.g.classes.margin_far(".5em"),";min-width:18px;}&.active>td>*,>td._clickable:hover>*{cursor:pointer;background-color:",s.g.colors.dominant_main_shade,";color:",s.g.colors.dominant_main,";border-radius:5px;}input:not([type=checkbox]),select,.InputDropDown,textarea{width:150px;}&._input_only{width:300px;}.blsm-input:not(.blsm-input-wrapped){border:1px solid #DCDCDC;border-radius:4px;&:hover{border:1px solid #9E9E9E;}&:focus-within{border:1px solid ",s.g.colors.dominant_main,";}}>td._cb>*{padding:0 20px;.blsm-input{border:none;&:hover{border:none;}}}",s.g.mQuery.mobile,"{border-top:1px solid ",s.g.colors.dominant_main_shade,";}._menu{display:flex;align-items:center;._menu_arrow{position:relative;",s.g.far,":-20px;}}",""),h=(0,r.iv)("td{padding:3px 10px;display:flex;font-size:.8em;vertical-align:baseline;>._separator{flex-grow:1;border-top:1px solid ",s.g.colors.separator,";&:not(:only-child){margin-top:0.8em;}}}",""),b=e=>{let{data:t,onSelect:i,inputChange:r,onFocusChanged:s}=e;const[o,b]=(0,n.useState)(!1),{input:v,label:_,icon:y,color:w,href:x,newTab:k,onClick:Z,active:C,className:S,style:O,separator:B,attr:T,inputOnly:N,menu:I}=t,D="string"==typeof _?_.caps():_,[j,P]=(0,p.$V)({show:o,type:"expand",speed:".3s"});if(B)return(0,m.tZ)("tr",{css:h,children:(0,m.BX)("td",{colSpan:2,children:[D&&(0,m.BX)("div",{children:[D," "]}),(0,m.tZ)("div",{className:"_separator"})]})});const z=I?()=>b(!o):Z||i;return(0,m.BX)(m.HY,{children:[(0,m.BX)("tr",{css:g,className:(0,c.AK)(S,{active:C}),style:O,children:[!N&&D&&(0,m.tZ)("td",{className:(0,c.AK)({_clickable:x||z,_has_label:D}),children:(0,m.BX)(d.A,{onClick:z,href:x,newTab:k,style:w?{color:w}:void 0,className:(0,c.AK)({_menu:(null==I?void 0:I.length)>0}),...T,children:[y&&(0,m.tZ)(l.JO,{icon:y}),D&&(0,m.BX)("span",{children:[D,v?":":""]}),I&&(0,m.BX)(m.HY,{children:[(0,m.tZ)(u.zh,{}),(0,m.tZ)(l.JO,{className:"_menu_arrow",icon:"arrow_"+(o?"up":"down"),smallButtonLike:!0})]})]})}),v&&(0,m.tZ)("td",{className:(0,c.AK)({_cb:"checkbox"===v.type}),colSpan:N?2:1,children:(0,m.tZ)("div",{children:(0,m.tZ)(a.I,{...v,className:N?"_input_only":"",onChange:r?e=>r({[v.name]:(0,c.Dw)(e)?e:void 0}):()=>null,label:N&&_?_:"",onFocus:()=>s(!0),onBlur:()=>s(!1)})})})]}),j&&(0,m.tZ)("tr",{children:(0,m.tZ)("td",{children:(0,m.tZ)("div",{...P,children:(0,m.tZ)(f,{items:I.map((e=>({...e,icon:e.icon||"empty"}))),inForm:!0})})})})]})},v=(0,r.iv)("&.scrollable{overflow-y:auto;max-height:50vh;}.context-menu-title{padding:4px 10px;font-size:1.1em;font-weight:600;color:",s.g.colors.text_sec,";}&.width100 ._btn{&,&>span>div{width:100%;}}table{width:100%;}",""),_=e=>{var t;let{children:i,className:r,options:s=[],onSelect:a,inputChange:l,inForm:d,scrollable:p,onClear:u,dropDownLike:g,title:h,onClose:b,noPortal:_,trigger:y,behavior:w}=e;const[x,k]=(0,n.useState)(!1),Z=null==s||null===(t=s.filter)||void 0===t?void 0:t.call(s,(e=>e));if(0===(null==Z?void 0:Z.length))return null;const C=(0,m.tZ)(f,{items:Z,title:h,inputChange:l,focused:x,setFocused:k,onSelect:a,onClear:u,scrollable:p,inForm:d});return(0,m.tZ)(o.y,{className:(0,c.AK)("ContextMenu",r),css:v,keepOpen:x,content:C,onClose:b,closeOnClick:void 0===l&&"trigger"!==w,dropDownLike:g,noPortal:_,mobileLayoutSupport:!0,behavior:w,trigger:y,children:i})},f=e=>{let{items:t,title:i,inputChange:n,focused:r,setFocused:s,onSelect:o,onClear:a,scrollable:d,inForm:p}=e;null!=t&&t.some((e=>e.icon&&e.label))&&t.forEach((e=>e&&(e.icon=e.icon||"empty")));const u=(0,m.BX)(m.HY,{children:[a&&(0,m.tZ)(l.JO,{icon:"clear",toolTip:lng("clear|verb"),onClick:a,css:(0,l.Mv)(i)}),i&&(0,m.tZ)("div",{className:"context-menu-title",children:i.caps()}),(0,m.tZ)("table",{children:(0,m.tZ)("tbody",{children:null==t?void 0:t.map(((e,t)=>!e||void 0!==e.visible&&!(0,c.g4)(e.visible)?void 0:(0,m.tZ)(b,{data:e,inputChange:(null==e?void 0:e.onValueChange)||n,onFocusChanged:e=>e^r&&s(e),onSelect:o?()=>o(e.val):void 0},t)))})})]});return p?(0,m.tZ)("div",{css:v,className:d?" scrollable":"",children:u}):(0,m.tZ)("form",{css:v,className:d?" scrollable":"",autoComplete:"off",onSubmit:e=>e.preventDefault(),children:u})}},7166:(e,t,i)=>{i.d(t,{g:()=>l});var n=i(6975),r=i(7363),s=i(7154),o=i(6920),a=i(5944);const l=e=>{var t;let{copy:i,success:l,...c}=e;const[d,p]=(0,r.useState)(!1);if(null===(t=navigator)||void 0===t||!t.clipboard)return"";const u=()=>{p(!0),setTimeout((()=>p(!1)),3e3)};return(0,a.tZ)(s.y,{behavior:"trigger",trigger:d,content:(0,a.BX)("div",{style:{padding:"10px",color:o.g.colors.dominant_main},children:[(0,a.tZ)(n.JO,{icon:"radio_checked"})," ",l]}),children:(0,a.tZ)(n.JO,{icon:"copy",onClick:e=>(navigator.clipboard.writeText(i).then(u),e.preventDefault()),toolTip:d?void 0:lng("copy to clipboard"),...c})})}},6380:(e,t,i)=>{i.d(t,{T:()=>l});var n=i(917),r=i(6920),s=i(8318),o=i(5944);const a=(0,n.iv)("z-index:1;display:inline-block;min-width:1em;min-height:1em;line-height:1em;padding:0.3em 0.6em;text-align:center;font-size:.8em;border-radius:10px;vertical-align:bottom;color:white;background-color:",r.g.colors.warning,";transition:opacity .3s ease-in-out;&._empty{opacity:0;}",""),l=function(e){let{badge:t,className:i}=e;return!!t&&(0,o.tZ)("div",{css:a,className:(0,s.AK)(i,{_empty:0===parseInt(t)}),children:t})}},9180:(e,t,i)=>{i.d(t,{ij:()=>p,qm:()=>m,qp:()=>u});var n=i(7363),r=i(7821),s=i(5560),o=i(2334),a=i(7154),l=i(8318),c=i(5944);const d=(0,r.observable)({val:new Date});setInterval((()=>d.val=new Date),6e4);const p=(0,s.observer)((e=>{let{time:t,className:i}=e;return d.val,(0,c.tZ)("span",{className:i,children:(0,o.GG)(t,{relative:!0})})})),u=e=>{let{time:t,className:i,showDate:n=!0,showTime:r=!0,showYear:s=!0,hideMidnight:a=!1,relative:l=!1}=e;return(0,c.tZ)("span",{className:i,children:(0,o.GG)(t,{date:n,time:r,year:s,hideMidnight:a,relative:l})})},m=e=>{let{dateNote:t,showTime:i=!0}=e;if(!t)return null;if("auto"===i&&(i=t.start&&t.end&&t.end-t.start>l.dV&&t.end-t.start<l.s2),t.start&&(t.date=(0,o.GG)(t.start,{time:!1}),t.time=i?(0,o.GG)(t.start,{date:!1}):null),t.end&&(t.toDate=(0,o.GG)(t.end,{time:!1}),t.toTime=i?(0,o.GG)(t.end,{date:!1}):null),t.toDate&&t.date)if(t.toDate===t.date)t.toDate=null,t.toTime===t.time&&(t.toTime=null);else{var r;const e=null===(r=t.date.match(/\D?\d\d\d\d\D?/))||void 0===r?void 0:r[0];e&&(t.toDate=t.toDate.replace(e,""))}return(0,c.tZ)(a.u,{text:t.toolTip,children:[t.date,t.time,(t.toDate||t.toTime)&&lng("to|date"),t.toDate,t.toTime].filter((e=>e)).map(((e,t)=>(0,c.BX)(n.Fragment,{children:[e," "]},t)))})}},5311:(e,t,i)=>{i.d(t,{Zv:()=>u,c_:()=>a,jM:()=>p,zh:()=>c});var n=i(917),r=i(6920),s=i(6344),o=(i(7882),i(5944));const a=e=>{let{children:t,column:i,...r}=e;return(0,o.tZ)("div",{css:(0,n.iv)({display:"flex",flexDirection:i?"column":void 0},"",""),...r,children:t})};var l={name:"1ff36h2",styles:"flex-grow:1"};const c=()=>(0,o.tZ)("div",{css:l}),d=(0,n.iv)("padding:2px 10px;border-radius:6px;border:1px solid transparent;background-color:",r.g.colors.text_light_disabled,";color:",(0,s.ou)(r.g.colors.text_light_disabled),";",""),p=e=>{let{text:t,width:i,grow:n,className:r}=e;return(0,o.tZ)("input",{className:r,css:d,style:{width:i,flexGrow:n?1:void 0},type:"text",readOnly:!0,value:t})},u=e=>{let{width:t}=e;return(0,o.tZ)("span",{style:{width:t||"10px",display:"inline-block"}})}},5405:(e,t,i)=>{i.d(t,{SV:()=>c,aK:()=>m,bg:()=>p});var n=i(7363),r=i(917),s=i(6920),o=i(5944);const a="Oops! someting went wrong...",l=(0,r.iv)("background-color:",s.g.colors.bg_cont,";border:4px dashed pink;color:",s.g.colors.text_sec,";padding:5px;._sad{font-weight:bold;font-size:50px;}","");class c extends n.Component{constructor(e){super(e),this.state={}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.error?this.renderError(this.state):this.props.children}renderError(e){let{error:t}=e;return(0,o.BX)("div",{css:l,className:this.props.className,children:[(0,o.tZ)("b",{children:":("})," ",a,(0,o.tZ)("br",{}),(0,o.tZ)("br",{}),(0,o.tZ)("div",{children:t.toString()})]})}}const d=(0,r.iv)(s.g.classes.page_position,";","");class p extends c{renderError(e){let{error:t,errorInfo:i}=e;return(0,o.BX)("div",{css:[l,d,"",""],children:[(0,o.tZ)("div",{className:"_sad",children:":("}),a,(0,o.tZ)("br",{}),(0,o.tZ)("br",{}),(0,o.tZ)("div",{children:t.toString()}),"_self"in(0,n.createElement)("div")&&(0,o.tZ)("pre",{children:i.componentStack})]})}}const u=(0,r.iv)("display:inline-block;width:",s.g.consts.CARD_WIDTH,"px;min-width:",s.g.consts.CARD_WIDTH,"px;height:",s.g.consts.CARD_HEIGHT,"px;overflow:auto;display:flex;align-items:center;justify-content:center;text-align:center;","");class m extends c{renderError(e){let{error:t}=e;return(0,o.tZ)("div",{css:[l,u,"",""],children:(0,o.BX)("div",{children:[(0,o.tZ)("div",{className:"_sad",children:":("}),a,(0,o.tZ)("br",{}),(0,o.tZ)("br",{}),(0,o.tZ)("i",{children:t.toString()})]})})}}},5832:(e,t,i)=>{i.d(t,{Cy:()=>y,WB:()=>_,_V:()=>f,wn:()=>v});var n=i(5560),r=i(7821),s=i(917),o=i(6920),a=i(3051),l=i(7095),c=i(8318),d=i(6975),p=i(2906),u=i(6421),m=i(81),g=i(5944);const h=(0,s.iv)("align-items:center;._active{color:",o.g.colors.dominant_main,";}>form{",o.g.classes.margin_far("4px"),";display:flex;justify-content:space-evenly;>._field_wrapper{",o.g.classes.margin_far("15px"),";}}.blsm-input:not(.wrapped){border:1px solid #DCDCDC;border-radius:4px;&:hover{border:1px solid #9E9E9E;}&:focus-within{border:1px solid ",o.g.colors.dominant_main,";}}","");var b={name:"1r5gb7q",styles:"display:inline-block"};const v=(0,n.observer)((e=>{let{filters:t=[],filtersVals:i,onFilter:n,className:s,spreadFilters:o,iconProps:l}=e,p=t.map((e=>({...e,input:e.type?Object.assign((0,c.ei)(e,["type","name","options","tree","onSelect","onClear","nameField","checkboxValue","emptyOption","subArray","placeholder","objectType","staticLabel","emptyLabel","showSearch","searchData","showList","onChange","showId"]),{value:i[e.name]||""}):void 0})));(0,m.iP)();let v=[];p=p.filter((e=>{if(!e)return!1;if(!e.outOfMenu||(o||(0,c.Oz)())&&(!o||(0,c.tq)()))return!0;{let t={eInputLabel:e.label,eInput:e.input,eWrapped:e.wrapped};if(o)v.push(t);else{if(o||0!==v.length)return!0;v[0]=t}}}));const _=Object.keys((0,r.toJS)(i)).length>0,f=n?e=>n((0,c.v7)(Object.assign({},i,e))):void 0;return(0,g.BX)("div",{css:h,className:s,children:[v&&(0,g.tZ)("form",{autoComplete:"off",onSubmit:e=>e.preventDefault(),css:b,children:v.map(((e,t)=>{var i,n;return(0,g.tZ)(u.I,{label:null===(i=e.eInputLabel)||void 0===i?void 0:i.caps(),className:e.eWrapped?"wrapped":"",wrapped:e.eWrapped,style:{verticalAlign:"text-top"},placeholder:o||!o&&e.eWrapped&&0===t||null===(n=e.eInputLabel)||void 0===n?void 0:n.caps(),onChange:f?t=>f({[e.eInput.name]:t||void 0}):void 0,...e.eInput},t)}))}),p.length>0&&(0,g.tZ)(a.x,{className:"_dropdown",options:p,inputChange:f,onClear:n&&_?()=>n({}):void 0,children:(0,g.tZ)(d.JO,{icon:"filter",className:(0,c.AK)({_active:_}),...l})})]})})),_=function(e,t,i){let{recent:n,id_attr:s,filters:o,subName:a}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=null==e?void 0:e.slice();for(const[e,i]of Object.entries((0,r.toJS)(t)))(0!==(null==i?void 0:i.length)||a)&&(c=c.filter((t=>{if(o){const n=o.find((t=>t.name===e&&t.func));if(n)return n.func(i,t)}let n=(0,r.toJS)((0,p.Lj)(t,e));var s,a,l,c,d,u,m,g,h,b;return Array.isArray(i)?Array.isArray(n)?(n=n.map((e=>{var t;return null==e||null===(t=e.toString)||void 0===t?void 0:t.call(e)})),i.filter((e=>n.includes(e))).length>0):i.includes(null===n?n:null===(s=n)||void 0===s||null===(a=s.toString)||void 0===a?void 0:a.call(s)):"string"==typeof i?null!==(l=(o||[]).find((t=>t.name===e)))&&void 0!==l&&l.exact?""===(null===(c=n)||void 0===c?void 0:c.toString())||(null===(d=n)||void 0===d||null===(u=d.toString())||void 0===u?void 0:u.toLowerCase())===(null==i||null===(m=i.toLowerCase)||void 0===m?void 0:m.call(i)):null===(g=n)||void 0===g||null===(h=g.toString())||void 0===h?void 0:h.toLowerCase().includes((null==i||null===(b=i.toLowerCase)||void 0===b?void 0:b.call(i))||""):"boolean"==typeof i?!!i==!!n:!("number"==typeof i&&i>0)||i==n})));return i?(0,l.p)(c,i,n,s):c},f=function(e,t){let{labelFunc:i,sortFunc:n,valIsArray:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return[...new Set(t.map((t=>s?(0,p.Lj)():(0,r.toJS)((0,p.Lj)(t,e)))))].filter((e=>e)).sort(n||void 0).map((e=>({val:e,label:i?i(e):e})))},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{filter:e,sort:{by:t.by||"",desc:t.desc}}}},5293:(e,t,i)=>{i.d(t,{Q9:()=>u,n2:()=>g});var n=i(7363),r=i(8318),s=i(917),o=i(6920),a=i(6975),l=i(3346),c=i(9952),d=i(5944);const p=(0,s.iv)("width:20px;height:20px;border-radius:50%;font-size:10px;background-color:",o.g.colors.dominant_main,";color:white;display:inline-flex;justify-content:center;align-items:center;&.error{background-color:",o.g.colors.negative,";}",""),u=e=>{let{type:t,toolTip:i,className:n}=e;return(0,d.tZ)("div",{css:p,className:(0,r.AK)(n,t),children:(0,d.tZ)(a.JO,{icon:"error"===t?"sign_notification":"required",toolTip:i})})},m=e=>(0,s.iv)("position:relative;display:flex;border:1px solid ",o.g.colors.separator,";transition:border-color .2s ease-out;background-color:",o.g.colors.bg_input,";color:",o.g.colors.text_main,";border-radius:",o.g.consts.FIELD_BORDER_RADIUS,"px;align-items:center;>input,>.InputDropDown{border-radius:",o.g.consts.FIELD_BORDER_RADIUS,"px;}&._focused:not(.readOnly){border-color:",o.g.colors.dominant_main,";}&.readOnly{&,input,select,textarea{color:",o.g.colors.disabled_text,";}*:focus{outline:none;}}>.auto_complete{width:100%;}>input,>select,>textarea,>.select_date>input,>.auto_complete>input,>.image_input>input{border:0;outline:none;background:transparent;width:100%;padding:11px 13px;}>.image_input{width:100%;>input{border-radius:",o.g.consts.FIELD_BORDER_RADIUS,"px;}}>.InputDropDown{width:100%;border:0;>._label{padding:11px 13px;}}>select{padding:10px 13px;}>._placeholder{pointer-events:none;position:absolute;top:0;",o.g.near,":",e?"30px":"13px",";color:",o.g.colors.text_placeholder,";background-color:",o.g.colors.bg_input,";border-radius:",o.g.consts.FIELD_BORDER_RADIUS,"px;padding-top:11px;transition:top .2s,left .2s,font-size .2s,padding .2s,color .2s;&._has_symbol{",o.g.classes.margin_near("1ch"),";}}&._skinny{>input,>select,>textarea,>.InputDropDown>input,>.select_date>input,>.auto_complete>input{padding-top:5px;padding-bottom:5px;border-radius:",o.g.consts.SKINNY_BORDER_RADIUS,"px;}>._placeholder{padding-top:7px;}}&._minimalist{border-radius:0;border-style:none none dashed none;padding:0;>input,>select,>textarea,>.InputDropDown>input,>.select_date>input,>.auto_complete>input{padding:0 1px;}}&._inline{display:inline-flex;>input,>select,>textarea,>.InputDropDown>input,>.select_date>input,>.auto_complete>input{display:inline-block;}}&.labelMargin{margin-top:1em;}input::placeholder{color:silver;}&._focused,&._filled{>._placeholder{top:-.7em;",o.g.near,":7px;padding:0 6px;}}._flag{position:absolute;",o.g.near,":-24px;top:10px;}&._error{border-color:",o.g.colors.negative,";}&._disabled{position:relative;color:",o.g.colors.text_main,';.InputLabel{z-index:1;background-color:transparent;}&:after{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:',o.g.colors.text_light_disabled,";opacity:0.5;border-radius:",o.g.consts.FIELD_BORDER_RADIUS,"px;}}>.Icon{",o.g.classes.margin_near("10px"),";}",""),g=e=>{let{children:t,label:i,focused:s,filled:o,required:p,error:u,skinny:g,minimalist:h,labelMargin:b,inline:v,disabled:_,readOnly:f,icon:y,helpKey:w,maxWidth:x,grow:k,symbol:Z,className:C,value:S,maxLength:O}=e;const B=(0,n.useRef)(),T=(0,n.useContext)(l.p8);return(0,d.BX)("div",{css:m(y),style:{maxWidth:x,grow:k},ref:e=>{var t;(null==e?void 0:e.clientWidth)-35<(null===(t=B.current)||void 0===t?void 0:t.clientWidth)&&(e.style.minWidth=B.current.clientWidth+35+"px")},className:(0,r.AK)(C,{_field_wrapper:!0,_focused:s,_filled:o,_error:u,_skinny:g,_minimalist:h,_inline:v,_disabled:_,labelMargin:b,readOnly:f,_has_symbol:!!Z,[`theme_${T}`]:T}),children:[y&&(0,d.tZ)(a.JO,{icon:y}),t,(0,d.tZ)(c.A,{label:i,error:u,required:p,className:(0,r.AK)("_placeholder",{_has_symbol:!!Z}),ref:B,helpKey:w,focused:s,valueLength:(null==S?void 0:S.length)||0,maxLength:O})]})}},3205:(e,t,i)=>{i.d(t,{l:()=>F});var n=i(7363),r=i(917),s=i(6920),o=i(6291),a=i(3346),l=i(7033),c=i(5560),d=i(539),p=i(4524),u=i(5155),m=i(4210),g=i(5944);const h=(0,r.iv)("display:flex;flex-direction:column;text-align:center;color:",s.g.colors.text_sec,";width:min(500px, 96vw);margin:0 auto;>.fps_title{color:",s.g.colors.text_main,";font-size:2.4rem;font-weight:600;}button,.fps_next{margin-top:20px;}",""),b=(0,c.observer)((()=>{const e=(0,n.useContext)(m.q3);return(0,g.BX)("div",{css:h,children:[(0,g.tZ)(p.M,{}),(0,g.BX)("div",{className:"fps_title",children:[lng("success").caps(),"!"]}),e.successButtons.length>0&&(0,g.BX)(g.HY,{children:[(0,g.tZ)("div",{className:"fps_next",children:lng("what's next?").caps()}),e.successButtons.map((e=>(0,g.tZ)(u.O,{chunky:!0,...e},e.label)))]})]})}));var v=i(747),_=i(7203),f=i(8318),y=i(5311);const w=(0,r.iv)("background-color:",s.g.colors.bg_main,";display:flex;position:relative;",s.g.mQuery.mobile,"{flex-direction:column;}>div>._main{color:",s.g.colors.text_main,";flex-grow:1;padding-top:50px;position:relative;>div>.form_section{width:500px;max-width:96vw;margin:0 auto 20px;padding:0 20px;}&.noPanel>div>.form_section{max-width:1000px;width:auto;}}>._overlay{position:absolute;z-index:1;background-color:rgba(255, 255, 255, .5);left:0;top:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center;}",s.g.mQuery.mobile,"{>div>._main{padding-top:90px;padding-bottom:70px;@media (max-height: ",s.g.consts.MIN_FORM_HEIGHT_MOBILE,"px){padding-bottom:0;}}}",""),x=(0,c.observer)((function(){const e=(0,n.useContext)(m.q3),{fields:t,status:i,activeSection:r,savePanel:s,progress:c}=e,p=((e,t)=>{for(let i of e){if(i===t)return;for(let e of i.fields)if(e===t)return i}})(t,r),u=p?{type:"section",title:p.title,fields:[r]}:r;p&&r.sectionWidth&&(u.sectionWidth=r.sectionWidth);const h=t=>{e.status="",e.setActiveSection(t)};return(0,g.BX)(o.T,{css:w,children:[(0,g.tZ)(v.$g,{activeSection:r,onSelectSection:h}),(0,g.BX)(y.c_,{column:!0,style:{flexGrow:1},children:[(0,g.tZ)("form",{className:(0,f.AK)("_main",{noPanel:!s}),autoComplete:"off",onSubmit:e=>e.preventDefault(),children:"success"===i?(0,g.tZ)(l.U,{children:(0,g.tZ)(b,{})}):(0,g.tZ)(l.U,{children:(0,g.tZ)(a.au,{input:u})},null==r?void 0:r.title)}),s&&(0,g.tZ)(_.qn,{activeSection:r,onSelectSection:h,parentSection:p})]}),"saving"===i&&(0,g.tZ)("div",{className:"_overlay",children:(0,g.tZ)(d.$,{label:c+"%"})}),s&&(0,g.tZ)("div",{style:{width:"315px"}})]})}));i(7882);var k=i(8207),Z=i(81),C=i(5946),S=i(5007);const O=(0,r.iv)("color:",s.g.colors.text_main,";max-width:100%;display:flex;flex-direction:column;padding:0;._overlay{position:absolute;background-color:rgba(255, 255, 255, .5);left:0;top:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center;border-radius:",s.g.consts.CONT_BORDER_RADIUS,"px;}",""),B=(0,c.observer)((e=>{let{internalForm:t,noHead:i,wizard:r,enableConfirmButton:s,multiColumnThresHold:o=1400}=e;const l=(0,n.useContext)(m.q3),c=(0,Z.iP)().width>o&&l.fieldsColumns.length>1,{status:p,progress:h,FormComponent:b}=l,[v,_]=(0,n.useState)(0),f=l.fields.length;return(0,g.BX)(g.HY,{children:[!i&&l.title&&(0,g.tZ)(C.D,{children:l.title}),!i&&l.headExtra,!1===l.ready?(0,g.tZ)(d.$,{}):(0,g.BX)(T,{className:"formtag",internalForm:t,css:O,autoComplete:"off",onSubmit:e=>e.preventDefault(),children:[c?(0,g.tZ)(k.U0,{children:l.fieldsColumns.map(((e,t)=>(0,g.tZ)("div",{className:"splitter-"+t,children:(0,g.tZ)(a.au,{input:e})},t)))}):b?(0,g.tZ)(b,{fields:l.fields}):r?(0,g.tZ)(a.$0,{title:l.fields[v].title,titleSmall:l.fields[v].titleSmall,children:(0,g.tZ)(a.au,{input:l.fields[v].fields})}):(0,g.tZ)(a.au,{input:l.fields}),"saving"===p&&(0,g.tZ)("div",{className:"_overlay",children:(0,g.tZ)(d.$,{label:h+"%"})}),r?(0,g.tZ)(I,{formCtx:l,numOfSections:f,wizardIndex:v,setWizardIndex:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)_(e);else{for(const e of l.fields[v].fields)l._validateField(null,e);0===l.errors.size&&_(e)}}}):s&&l.confirmButtonLabel?(0,g.tZ)(u.O,{primary:!0,onClick:l.callSave,highlight:l.dirty,disabled:!!l.status,children:l.confirmButtonLabel}):null]})]})})),T=function(e){let{internalForm:t,...i}=e;return t?(0,g.tZ)("div",{...i}):(0,g.tZ)("form",{...i})},N={name:"1cnbn82",styles:"margin-top:40px;display:flex;justify-content:space-between;align-items:end;>div{min-width:60px;}.conclusion-buttons{text-align:center;}"},I=e=>{let{formCtx:t,numOfSections:i,wizardIndex:n,setWizardIndex:r}=e;return(0,g.BX)("div",{css:N,children:[(0,g.tZ)("div",{children:n>0&&(0,g.tZ)(u.O,{onClick:()=>r(n-1,!0),children:lng("back").caps()})}),(i-1>n||i-1==n)&&(0,g.BX)("div",{className:"conclusion-buttons",children:[i-1>n&&(0,g.tZ)("div",{children:(0,g.tZ)(u.O,{chunky:!0,primary:!0,onClick:()=>r(n+1),children:lng("next").caps()})}),i-1==n&&(0,g.tZ)("div",{children:(0,g.tZ)(u.O,{chunky:!0,primary:!0,onClick:t.callSave,highlight:t.dirty,disabled:!!t.status,children:t.confirmButtonLabel})}),t.cancelText&&(0,g.tZ)("div",{children:(0,g.tZ)(u.O,{chunky:!0,onClick:()=>(0,S.vm)().closeDialog(),children:t.cancelText.caps()})})]}),(0,g.tZ)("div",{})]})};var D=i(1137),j=i(7392);var P={name:"1fttcpj",styles:"display:flex;flex-direction:column"};const z=e=>e?"":P,E=(0,c.observer)((e=>{let{onClose:t,hideX:i,internalForm:r,dialogWidth:s,dialogTailButtons:o,options:a,fitContent:l}=e;const{wizard:c}=a||{},d=(0,n.useContext)(m.q3),p=(0,Z.iP)(),h=p.width>1400&&d.fieldsColumns.length>1,b=(0,g.BX)("div",{css:z(p.width>575),children:[d.headExtra,(0,g.tZ)(_.ON,{}),d.confirmButtonLabel&&!c&&(0,g.tZ)(u.O,{primary:!0,onClick:d.callSave,highlight:d.dirty,disabled:!!d.status,children:d.confirmButtonLabel})]}),v=l?"fit-content":s||(h?"1400px":void 0);return(0,g.tZ)(k.T,{className:"fdialog",title:d.title,onClose:t,hideX:i,headExtra:b,headPrefix:d.headPrefix,width:v,padded:!h,tailButtons:o,children:(0,g.tZ)(B,{internalForm:r,noHead:!0,wizard:c})})})),R=(0,c.observer)((e=>{let{onClose:t,hideX:i,internalForm:r,dialogWidth:s,dialogTailButtons:o,options:a,fitContent:l}=e;const{wizard:c}=a||{},d=(0,n.useContext)(m.q3),p=(0,n.useRef)(null),h=(0,Z.iP)(),b=h.width>1200&&d.fieldsColumns.length>1,v=(0,g.BX)("div",{css:z(h.width>575),children:[d.headExtra,d.confirmButtonLabel&&!c&&(0,g.tZ)(u.O,{primary:!0,onClick:d.callSave,highlight:d.dirty,disabled:!!d.status,children:d.confirmButtonLabel})]}),_=(0,g.tZ)(k.$0,{title:d.title,headExtra:v,onClose:i?null:()=>p.current.close()}),f=o&&(0,g.tZ)("div",{className:"_tailButtons",children:o.map(((e,t)=>(0,g.tZ)(j.l,{...e,action:void 0,onClick:e.action,bold:!0,theme:t===o.length-1?"contained":void 0,children:e.label.caps()},t)))}),y=l?"fit-content":s||"1600px";return(0,g.tZ)(D.d,{from:"side",onClose:t,ref:p,size:y,children:(0,g.tZ)(k.W2,{head:_,stickyHead:!0,tail:f,padded:!b,children:(0,g.tZ)(B,{internalForm:r,noHead:!0,wizard:c,multiColumnThresHold:1200})})})})),F=(0,c.observer)((e=>{let{type:t="dialog",form:i,...n}=e;return(0,g.BX)(m.q3.Provider,{value:i,children:["page"===t&&(0,g.tZ)(x,{}),"inline"===t&&(0,g.tZ)(B,{...n}),"dialog"===t&&(0,g.tZ)(E,{...n}),"drawer"===t&&(0,g.tZ)(R,{...n}),i.extra_component]})}))},3346:(e,t,i)=>{i.d(t,{$0:()=>x,VE:()=>C,au:()=>_,fM:()=>O,gN:()=>y,p8:()=>v});var n=i(7363),r=i(917),s=i(6920),o=(i(7882),i(6421)),a=i(8318),l=i(5560),c=i(4210),d=i(6975),p=i(5459),u=i(5946),m=i(9483),g=i(747),h=i(3533),b=i(5944);const v=(0,n.createContext)(null),_=(0,l.observer)((function(e){let{input:t,skinny:i,minimalist:r}=e;const s=(0,n.useContext)(c.q3);if(!s)throw new Error("FormContext in FormEl was not found, did you forgot to set FormContext.Provider?");if(!t)return null;const{values:o,updateValue:l,errors:d}=s;if(!(0,g.bh)(t,s))return null;if(Array.isArray(t)||["row_set","section","indent_set","set"].includes(t.type)){const e=(Array.isArray(t)?t:t.fields).filter((e=>e)).map(((e,n)=>(e.disable=e.disable||t.disable,(0,b.tZ)(_,{input:e,skinny:i||t.inline,minimalist:r||t.minimalist},n))));return"section"===t.type?(0,b.tZ)(x,{...t,children:e}):"row_set"===t.type&&window.innerWidth>368?(0,b.tZ)(C,{...t,children:e}):"indent_set"===t.type?(0,b.tZ)(O,{...t,children:e}):"set"===t.type||"row_set"===t.type&&window.innerWidth<=368?(0,b.tZ)(B,{...t,children:e}):e}return"title"===t.type?(0,b.tZ)(u.D,{...t.props,children:t.label.caps()}):("select"===t.type&&(0,a.Wl)(t.options)&&(t=Object.assign({},t,{options:t.options()})),(0,b.tZ)(y,{input:t,required:!0===t.required||(0,a.g4)(t.required),value:t.name?s.getValue(t.name,t.checkboxValue):o,skinny:i||t.skinny,minimalist:r||t.minimalist,onChange:t.readOnly?null:l,error:d.get(t.name),disabled:(0,a.g4)(t.disable,null,[o])}))})),f=(0,r.iv)('margin-top:1em;[direction="ltr"]{direction:ltr;}[direction="rtl"]{direction:rtl;}.Icon-radio_checked{color:',s.g.colors.dominant_main,";}textarea{height:100px;}&._skinny{margin-top:0;}.sub{font-size:0.8em;margin:2.5px 15px;}.outer_label{display:inline-block;color:",s.g.colors.text_sec,";margin-inline-end:15px;width:fit-content;flex-grow:0;}&.style-checkbox,&.style-toggle{margin-top:0;}",""),y=(0,n.memo)((function(e){let{input:t,value:i,onChange:r,error:l,disabled:c,skinny:d,minimalist:p,required:u}=e;const{grow:m,align:g,onValueChange:h,onBlur:v,..._}=t,{outer_label:y,name:w,checkboxValue:x}=_,k=(0,n.useCallback)((()=>(0,a.g4)(v)),[v]),Z=(0,n.useCallback)(((e,t)=>(null!=r&&r(e,w,x),(0,a.g4)(h,null,[e,t,w]))),[r,h,w,x]);let C;return C="component"===t.type?t.node||(0,b.tZ)(t.Render,{value:i,input:t,onChange:w?e=>r(e,w):void 0,error:l,disabled:c||_.disabled,...(0,a.g4)(t.props)||{}}):(0,b.tZ)(o.I,{..._,value:i,disabled:c||_.disabled,onChange:Z,onBlur:k,wrapped:!0,required:u,error:l,minimalist:p,skinny:d}),"hidden"===t.type?C:(0,b.BX)("div",{css:f,style:(0,a.v7)({flexGrow:m,maxWidth:g===s.g.far?"fit-content":null}),className:(0,a.AK)("style-"+t.type,"form-field",{_skinny:d,_minimalist:p}),children:[y?(0,b.tZ)("div",{className:"outer_label",children:y.caps()}):null,C,t.sub&&(0,b.tZ)("div",{className:"sub",children:t.sub})]})})),w=(e,t)=>(0,r.iv)(e?"margin-top: 2.5em;":""," ",t?"":"margin-bottom: .7rem;",">._title{display:flex;align-items:center;justify-content:space-between;&._big{justify-content:center;>._label{color:",s.g.colors.dominant_main,";text-align:center;font-size:2rem;font-weight:600;}}&._small{margin:1.2rem 0 .5rem;._label{font-weight:700;color:",s.g.colors.text_main,";.Icon{font-size:17px;",s.g.classes.margin_far("4px"),";}}}}.form_section &>._title._big>._label{margin-top:1.2rem;font-size:1.2rem;color:",s.g.colors.text_sec,";}",""),x=e=>{let{children:t,title:i,titleSmall:n,titleIcon:r,titleExtra:s,sectionWidth:o,sectionHeight:l,style:c={}}=e;return o&&(c={...c,maxWidth:o,width:"auto"}),l&&(c={...c,maxHeight:l,height:"auto",overflow:"auto"}),(0,b.BX)("div",{css:w(),className:(0,a.AK)("form_section"),style:c,children:[i&&(0,b.BX)("div",{className:(0,a.AK)("_title",n?"_small":"_big"),children:[(0,b.BX)("div",{className:"_label",children:[r&&(0,b.tZ)(d.JO,{icon:r}),(0,b.tZ)(m.m,{children:(0,b.tZ)(h.h,{children:i.caps()})})]}),s]}),t]})},k=(0,r.iv)("position:relative;.help-sign{position:absolute;top:calc(50% - 3px);color:",s.g.colors.text_placeholder,";",s.g.classes.padding_near("10px")," ",s.g.classes.near("-35px"),";}",""),Z=e=>(0,r.iv)("align-items:",e,";&:not(._inline){display:flex;justify-content:space-between;}&._inline{display:inline-flex;}&.extraTopMargin{margin-top:2.5em;}>*+*{",s.g.classes.margin_near(".5em"),";}&:not(._inline)>*{flex-grow:1;flex-basis:0;}",""),C=e=>{let{children:t,inline:i,extraTopMargin:n,className:r,helpKey:s,alignItems:o="center"}=e;const l=(0,b.tZ)("div",{css:Z(o),className:(0,a.AK)({extraTopMargin:n,_inline:i},r),children:t});return s?(0,b.BX)("div",{css:k,children:[(0,b.tZ)(p.I,{helpKey:s}),l]}):l},S=(0,r.iv)("&.extraTopMargin{margin-top:2.5em;}.toggleTitle{margin-top:2.5em;font-weight:bold;>.toggleIcon{",s.g.classes.opposite_float,";}}.indentSet{",s.g.classes.margin_near("2em"),";}.noTopMargin>div:first-child{margin-top:0;}",""),O=e=>{let{children:t,extraTopMargin:i,toggle:r,toggleTitle:s,noTopMargin:o,addMargin:l=!0}=e;const[c,p]=(0,n.useState)(!0);return(0,b.BX)("div",{css:S,className:(0,a.AK)({extraTopMargin:i}),children:[r&&(0,b.BX)("div",{className:"toggleTitle",onClick:()=>p(!c),children:[(0,b.tZ)("span",{children:null==s?void 0:s.caps()}),(0,b.tZ)(d.JO,{className:"toggleIcon",icon:c?"arrow_down":"arrow_right"})]}),c&&(0,b.tZ)("div",{className:(0,a.AK)({indentSet:l,noTopMargin:o}),children:t})]})},B=e=>{let{children:t,extraTopMargin:i,title:n,titleSmall:r,titleIcon:s,titleExtra:o,noMarginBottom:l}=e;return(0,b.BX)("div",{css:w(i,l),children:[n&&(0,b.BX)("div",{className:(0,a.AK)("_title",r?"_small":"_big"),children:[(0,b.BX)("div",{className:"_label",children:[s&&(0,b.tZ)(d.JO,{icon:s}),n.caps()]}),o]}),t]})}},7203:(e,t,i)=>{i.d(t,{ON:()=>S,_o:()=>Z,qn:()=>y});var n=i(917),r=i(6920),s=i(7363),o=i(5155),a=i(5293),l=i(4210),c=i(5560),d=i(8318),p=i(7392),u=i(6975),m=i(3051),g=i(2205),h=i(747),b=i(7154),v=i(2755),_=i(5944);const f=(0,n.iv)("background-color:",r.g.colors.dominant_main_shade,";width:315px;padding:35px 15px 0;display:flex;flex-direction:column;position:fixed;",r.g.far,":0;top:",r.g.consts.TOP_BAR_HEIGHT,"px;bottom:0;z-index:1;._preview{min-height:200px;padding-top:110px;padding-bottom:30px;}",r.g.mQuery.mobile,"{width:auto;padding:5px 22px;position:static;max-height:30vh;box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);div.base_menu{display:flex;height:50px;justify-content:space-evenly;>div{flex-basis:33%;text-align:center;}>span{position:absolute;",r.g.far,":2px;bottom:9px;}}@media (min-height: ",r.g.consts.MIN_FORM_HEIGHT_MOBILE,"px){position:sticky;top:auto;",r.g.near,":0;}}",""),y=(0,c.observer)((e=>{let{activeSection:t,onSelectSection:i,parentSection:n}=e;const r=(0,s.useContext)(l.q3);let a=null,c="";if(!r.status){if(n){const e=n.fields.indexOf(t);0<=e&&(a=O(n.fields,e+1,r))}if(!a){var h,b,v;const e=r.fields.indexOf(n||t);0<=e&&(a=O(r.fields,e+1,r)),"section"===(null===(h=a)||void 0===h||null===(b=h.fields)||void 0===b||null===(v=b[0])||void 0===v?void 0:v.type)&&(c=a.title,a=O(a.fields,0,r))}}return(0,d.tq)()?(0,_.BX)("div",{css:f,children:[(0,_.BX)("div",{className:"base_menu",children:[r.backToButton?(0,_.tZ)("div",{children:(0,_.BX)(p.l,{theme:"outlined",chunky:!0,...r.backToButton,children:[(0,_.tZ)(u.JO,{icon:"reply"})," ",lng("return").caps()]})}):(0,_.tZ)("div",{}),(0,_.tZ)("div",{children:(0,_.BX)(p.l,{theme:"outlined",chunky:!0,primary:!0,onClick:r.callSave,disabled:!!r.status,children:[" ",(0,_.tZ)(u.JO,{icon:"save"})," ",r.confirmButtonLabel]})}),a?(0,_.tZ)("div",{children:(0,_.BX)(p.l,{theme:"outlined",chunky:!0,onClick:()=>i(a),children:[" ",lng("next").caps()," ",(0,_.tZ)(u.JO,{icon:"arrow_go_far"})]})}):(0,_.tZ)("div",{}),r.savePanelExtraButtons.size>0&&(0,_.tZ)("span",{children:(0,_.tZ)(m.x,{className:"_menu",chunky:!0,icon:"menu",options:[...r.savePanelExtraButtons.values()],children:(0,_.tZ)(u.JO,{icon:"menu",buttonLike:!0})})})]}),(0,_.tZ)(Z,{})]}):(0,_.BX)("div",{css:f,children:[(0,_.tZ)("div",{className:"_preview",children:r.preview&&(r.preview.custom||(0,_.tZ)(g.d,{title:r.preview.title,poster:r.preview.poster,status:r.preview.status,isApproved:r.preview.isApproved}))}),r.backToButton&&(0,_.BX)(o.O,{chunky:!0,onClick:r.backToButton.onClick,children:[(0,_.tZ)(u.JO,{icon:r.backToButton.icon||"reply"})," ",r.backToButton.label]}),a&&(0,_.BX)(o.O,{chunky:!0,onClick:()=>i(a),children:[(0,_.tZ)(u.JO,{icon:"arrow_go_far"})," ",lng("continue to %s",c||a.title).caps()]}),(0,_.BX)(o.O,{chunky:!0,primary:!0,onClick:r.callSave,disabled:!!r.status,children:[(0,_.tZ)(u.JO,{icon:"save"})," ",r.confirmButtonLabel]}),r.savePanelMessage&&(0,_.tZ)(k,{message:r.savePanelMessage}),(0,_.tZ)("br",{}),(0,_.tZ)("br",{}),r.savePanelExtraButtons.size>0&&[...r.savePanelExtraButtons.values()].map(((e,t)=>(0,_.BX)(o.O,{chunky:!0,...e,children:[e.icon&&(0,_.tZ)(u.JO,{icon:e.icon})," ",e.label]},t))),(0,_.tZ)(Z,{})]})})),w=(0,n.iv)("margin:1.5em 1em;color:",r.g.colors.text_sec,";font-size:.9em;>div{cursor:pointer;margin-top:0.5em;}",""),x=(0,n.iv)("display:flex;margin:1.5em 1em;color:",r.g.colors.purple,";font-weight:bold;",""),k=(0,c.observer)((e=>{let{message:t}=e;return(0,_.BX)("div",{css:x,children:[(0,_.tZ)(v.ZT,{icon:"notice",bgColor:r.g.colors.dominant_main_shade,color:r.g.colors.purple,spaceAfter:!0}),(0,_.tZ)("div",{children:t})]})})),Z=(0,c.observer)((()=>{const e=(0,s.useContext)(l.q3),t=e.errors;if(!t.size)return null;return(0,_.tZ)("div",{css:w,children:t.toJSON().map((t=>{let[i,n]=t;return(0,_.BX)("div",{onClick:()=>(t=>{const i=[];(0,l.HE)(e.fields,(e=>(null==e?void 0:e.name)===t),i);const n=i.reverse().find((e=>"section"===e.type&&e.sid));n&&(e.status="",e.setActiveSection(n))})(i),children:[(0,_.tZ)(a.Q9,{type:"error"})," ",n]},i)}))})})),C={name:"33ngus",styles:"display:inline-block;margin:0 4px;.Icon{font-size:1.2em;}"},S=(0,c.observer)((()=>{const e=(0,s.useContext)(l.q3),[t,i]=(0,s.useState)(!0);return e.errors.size?(0,_.tZ)("div",{css:C,children:(0,_.tZ)(b.y,{content:(0,_.tZ)(Z,{}),behavior:"trigger",trigger:t,children:(0,_.tZ)(u.JO,{icon:"sign_notification",color:r.g.colors.negative,onClick:()=>i(!t)})})}):null})),O=(e,t,i)=>{let n=0;for(;e[t+n]&&!(0,h.bh)(e[t+n],i);)n++;return e[t+n]}},747:(e,t,i)=>{i.d(t,{$g:()=>_,bh:()=>y});var n=i(917),r=i(6920),s=i(7363),o=i(8318),a=i(4210),l=i(5560),c=i(2698),d=i(9039),p=i(101),u=i(81),m=i(6975),g=i(6421),h=i(3533),b=i(5944);const v=(0,n.iv)("width:350px;padding-top:35px;",r.g.classes.padding_near("60px"),";",r.g.classes.padding_far("30px"),";",r.g.classes.border_far("1px solid "+r.g.colors.separator),";min-height:calc(100vh - ",r.g.consts.TABLE_HEAD_HEIGHT,"px);>.fp_title{color:",r.g.colors.text_main,";font-size:2.2rem;font-weight:600;margin-bottom:1rem;}.fp_sub_title{color:",r.g.colors.text_sec,";font-size:1.4rem;font-weight:600;margin-bottom:2rem;}.fp_search_line{display:flex;align-items:center;margin-bottom:1rem;.fp_search_box{position:relative;display:flex;align-items:center;.fp_search_input{border:1px solid ",r.g.colors.border,";border-radius:5px;padding:4px 8px;}.fp_search_clear{position:absolute;",r.g.classes.far("9px"),";}}}>._entry{color:",r.g.colors.text_sec,";min-height:50px;",r.g.classes.padding_near("18px"),";",r.g.classes.border_near("2px solid #dfdfdf"),';padding-bottom:1.5em;&:last-of-type{border-color:transparent;}>div{position:relative;top:-5px;>._label:before{content:"";position:absolute;top:5px;',r.g.near,":-24px;width:11px;height:11px;border-radius:50%;background-color:",r.g.colors.text_sec,";transition:all .1s ease-in-out;}>div>._label{font-size:1em;",r.g.classes.margin_near(".5em"),";margin-top:.5em;}._label{font-size:1.1em;font-weight:600;cursor:pointer;&.disabled{color:",r.g.colors.text_light_disabled,";cursor:not-allowed;}}}}&:not(.disabled)>._entry>div ._label{&.error{color:",r.g.colors.negative,";}&:hover,&._active{color:",r.g.colors.dominant_main,";&:before{top:1px;",r.g.near,":-28px;width:19px;height:19px;background-color:",r.g.colors.dominant_main,";}}}&.disabled>._entry>div{>._label:before{background-color:",r.g.colors.text_light_disabled,";}._label{color:",r.g.colors.text_light_disabled,";cursor:not-allowed;}}",""),_=(0,l.observer)((function(e){let{activeSection:t,onSelectSection:i}=e;const n=(0,s.useContext)(a.q3),r=n.createMode&&"success"===n.status,l=[...n.errors.keys()],d=e=>l&&(0,a.HE)(e.fields,(e=>(null==e?void 0:e.name)&&l.includes(e.name))),[_,w]=(0,s.useState)(!1),{title:k,subTitle:Z,expandAndSearchSections:C,controlSearch:S,fields:O,status:B}=n;(0,u.iP)();let T=[];const N=new Map;return O.map((e=>{var t,i;if(!y(e,n))return null;const r="section"===(null===(t=e.fields)||void 0===t||null===(i=t[0])||void 0===i?void 0:i.type),s={id:e.title,name:e.title.caps(),sons:[]};N.set(e.title,e),r&&e.fields.map((e=>{if(!y(e,n))return null;s.sons.push({id:e.title,name:e.title.caps(),sons:[]}),N.set(e.title,e)})),T.push(s)})),(0,p.v0)(T),(0,o.tq)()?(0,b.tZ)(x,{activeSection:t,onSelectSection:i,sections:T,sectionIds:N}):(0,b.BX)("div",{css:v,className:(0,o.AK)({disabled:r}),children:[k&&(0,b.tZ)("div",{className:"fp_title",children:k.caps()}),Z&&(0,b.tZ)("div",{className:"fp_sub_title",children:Z.caps()}),C&&(0,b.BX)("div",{className:"fp_search_line",children:[(0,b.BX)("div",{className:"fp_search_box",children:[(0,b.tZ)(g.I,{type:"search",className:"fp_search_input",value:S,onChange:e=>n.controlSearch=e,placeholder:lng("search").caps()})," ",(0,b.tZ)(m.JO,{icon:"trash",className:"fp_search_clear",toolTip:lng("clear search"),smallButtonLike:!0,onClick:()=>n.controlSearch=""})]}),(0,b.tZ)(m.JO,{icon:_?"collapse_all":"expand_all",toolTip:_?lng("collapse all"):lng("expand all"),smallButtonLike:!0,onClick:()=>w(!_)})]}),O.map((e=>{var s,a;if(!y(e,n))return null;const l=!B&&(e===t||e.fields.includes(t)),p="section"===(null===(s=e.fields)||void 0===s||null===(a=s[0])||void 0===a?void 0:a.type);let u=new Set;const m=S.trim().toLowerCase();if(m){const t=e.title.toLowerCase().includes(m);t&&u.add(e),p?e.fields.forEach((i=>{y(i,n)&&(t?u.add(i):void 0!==(0,o.oH)(i,(e=>{var t,i,n,r;return(null==e?void 0:e.type)&&((null==e||null===(t=e.title)||void 0===t||null===(i=t.toLowerCase)||void 0===i?void 0:i.call(t).includes(m))||(null==e||null===(n=e.label)||void 0===n||null===(r=n.toLowerCase)||void 0===r?void 0:r.call(n).includes(m)))}),null,f)&&u.add(e).add(i))})):t||void 0===(0,o.oH)(e,(e=>{var t,i,n,r;return(null==e?void 0:e.type)&&((null==e||null===(t=e.title)||void 0===t||null===(i=t.toLowerCase)||void 0===i?void 0:i.call(t).includes(m))||(null==e||null===(n=e.label)||void 0===n||null===(r=n.toLowerCase)||void 0===r?void 0:r.call(n).includes(m)))}),null,f)||u.add(e)}if(m&&!u.has(e))return null;const g=e.title.caps();return(0,b.tZ)("div",{className:"_entry",children:(0,b.BX)("div",{children:[(0,b.tZ)(c.LZ,{className:(0,o.AK)("_label",{error:d(e),_active:l}),onClick:()=>!r&&i(p?e.fields.filter((e=>y(e,n)))[0]:e),children:(0,b.tZ)(h.h,{children:g})}),p&&(l||_||S)&&(0,b.tZ)("div",{children:e.fields.map((e=>{if(!y(e,n))return null;if(S&&!u.has(e))return null;const s=e.title.caps();return(0,b.tZ)(c.LZ,{className:(0,o.AK)("_label",{error:d(e),_active:e===t}),onClick:()=>!r&&i(e),children:(0,b.tZ)(h.h,{children:s})},e.title)}))})]})},e.title)}))]})})),f=e=>!!(0,o.zG)(e)||!(!e||!(0,o.yD)(e)||"insert"in e&&!e.insert||"mod"in e&&!Blsm.checkMod(e.mod)),y=(e,t)=>{const i=f(e);return i&&"section"===e.type&&!e.visible?e.fields.map((e=>y(e,t))).filter((e=>!1!==e)).length>0:!(!i||e.visible&&!e.visible(t.values,e.name))},w=(0,n.iv)("padding:10px 0;background-color:",r.g.colors.dominant_main_shade,";box-shadow:0 0 5px rgba(0,0,0,.3);position:fixed;left:0;right:0;top:",r.g.consts.TOP_BAR_HEIGHT,"px;z-index:",r.g.z.report_headers,";>.fp_title{color:",r.g.colors.text_main,";font-size:1.5rem;font-weight:600;text-align:center;}.fp_sub_title{color:",r.g.colors.text_sec,";font-size:1.2rem;font-weight:600;text-align:center;}>.fp_tree{text-align:center;}",""),x=e=>{let{activeSection:t,onSelectSection:i,sections:n,sectionIds:r}=e;const l=(0,s.useContext)(a.q3),c=l.createMode&&"success"===l.status;return(0,b.BX)("div",{css:w,className:(0,o.AK)({disabled:c}),children:[l.title&&(0,b.tZ)("div",{className:"fp_title",children:l.title.caps()}),(0,b.tZ)("div",{className:"fp_tree",children:(0,b.tZ)(d.B,{tree:n,value:t.title,onChange:e=>{var t,n;const s=r.get(e),o="section"===(null===(t=s.fields)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.type);return i(o?s.fields.filter((e=>!1!==e.insert))[0]:s)},showSearch:!1})})]})}},5459:(e,t,i)=>{i.d(t,{I:()=>d});var n=i(6975),r=i(8e3),s=i(7821),o=i(5560),a=i(5944);const l=(0,s.observable)(new Map),c=(e,t)=>{if(l.has(e))return l.get(e);t&&e&&(l.set(e,!1),(0,r.SC)("generic/help_key",{data:{key:e}},(t=>l.set(e,"string"==typeof t?t:"error loading help"))))},d=(0,o.observer)((function(e){let{helpKey:t,helpText:i}=e;return(0,a.tZ)(n.JO,{className:"help-sign",icon:"menu_info",toolTip:i||c(t)||lng("loading...").caps(),onMouseEnter:()=>c(t,!0)})}))},3533:(e,t,i)=>{i.d(t,{h:()=>l,y:()=>a});var n=i(7363),r=i(4210),s=i(5560),o=i(5944);const a=e=>{let{children:t,highlight:i}=e;const n=i.toLowerCase();if(!n||!t.toLowerCase().includes(n))return t;const r=t.split(new RegExp(`(${n})`,"gi"));return(0,o.BX)("span",{children:[" ",r.map(((e,t)=>e.toLowerCase()===n?(0,o.tZ)("mark",{children:e},t):(0,o.tZ)("span",{children:e},t)))," "]})},l=(0,s.observer)((e=>{var t;let{children:i}=e;return(0,o.tZ)(a,{highlight:(null===(t=(0,n.useContext)(r.q3))||void 0===t?void 0:t.controlSearch.trim())||"",children:i})}))},6975:(e,t,i)=>{i.d(t,{An:()=>x,JO:()=>b,Mv:()=>k,TG:()=>S,Xs:()=>O,YG:()=>g,e$:()=>v,gT:()=>f,vB:()=>w,y$:()=>Z});var n=i(917),r=i(8318),s=i(5697),o=i(7154),a=i(6920),l=(i(7882),i(441)),c=i(2698),d=i(1125),p=i(6344),u=i(2755),m=i(5944);const g=(0,n.iv)("display:inline-block;position:relative;&.buttonLike,&.smallButtonLike,&.smallerButtonLike{border-radius:50%;padding:9px;line-height:1em;&.disabled{pointer-events:none;}&.smallButtonLike{padding:5px;}&.smallerButtonLike{padding:2px;}i{width:1em;text-align:center;}&:not(.disabled){&:hover{color:",a.g.colors.blue,";background-color:",a.g.colors.blue_shade,";}}}&._clickable{cursor:pointer;}&.grab{cursor:grab;}._badge{position:absolute;top:-1em;",a.g.classes.far("-1em"),";z-index:1;",a.g.classes.circled_text,";font-size:.8rem;background-color:",a.g.colors.bg_main,";color:",a.g.colors.text_sec,";border:2px solid ",a.g.colors.text_sec,";transition:opacity .3s ease-in-out;&._red{border-color:#FC5959;color:#FC5959;}&._empty{opacity:0;}}&.Icon-empty i{width:12px;height:1em;display:inline-block;}&.strikethrough{background:linear-gradient(to right top, transparent 47%, currentColor 50%, currentColor 53%, transparent 56%);::before{opacity:.5;}}&.disabled{color:",a.g.colors.disabled_text,";}",""),h=["checkbox","checkbox_checked","radio","radio_checked"],b=function(e){let{icon:t,className:i,iconClass:n,toolTip:s,badge:p,alertBadge:u,buttonLike:b,smallButtonLike:v,smallerButtonLike:_,color:f,balloonAnchor:y=!0,strikethrough:w,disabled:x,spaceAfter:k,spaceBefore:Z,...C}=e;const S=(0,m.tZ)("i",{className:(0,r.AK)((0,d.wj)(t,a.g.isRTL),n,{"balloon-anchor":y})}),O=void 0!==p&&(0,m.tZ)("div",{className:(0,r.AK)("_badge",{_red:u,_empty:0===parseInt(p)}),children:(0,r.lo)(p)});let B;const T={css:[g,k?a.g.classes.margin_far(a.g.consts.ICON_MARGIN):void 0,Z?a.g.classes.margin_near(a.g.consts.ICON_MARGIN):void 0],className:(0,r.AK)(!s&&["Icon","Icon-"+t,i],"el_icon",{_clickable:!x&&(C.onClick||C.href||h.includes(t)),grab:!x&&"move"===t,strikethrough:w,buttonLike:b,disabled:x,smallButtonLike:v,smallerButtonLike:_}),style:f?{color:f}:void 0};return B=C.href?(0,m.BX)(l.A,{...C,...T,children:[S,O]}):(0,m.BX)(c.LZ,{...C,...T,children:[S,O]}),s?(0,m.tZ)(o.u,{text:s,className:(0,r.AK)("Icon","Icon-"+t,i),children:B}):B},v=e=>(0,m.tZ)(b,{...e,icon:"empty"}),_=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1em";return(0,n.iv)("display:inline-block;width:",t,";height:",t,";border-radius:50%;background-color:",e,";","")},f=e=>{let{color:t,size:i,onClick:n}=e;return(0,m.tZ)("div",{css:_(t,i),onClick:n})},y={name:"18mpvln",styles:"display:inline-block;font-weight:normal"},w=e=>{let{depth:t=0}=e;return(0,m.BX)("div",{css:y,children:[" ".repeat(2*t),a.g.isRTL?(0,m.tZ)(m.HY,{children:"↲"}):(0,m.tZ)(m.HY,{children:"↳"})," "]})},x=e=>{let{type:t}=e;return(0,m.tZ)(m.HY,{children:" • "})};x.propTypes={type:s.string};const k=e=>(0,n.iv)("position:absolute;top:2px;",e?a.g.far:a.g.near,":2px;color:",a.g.colors.dominant_main,";z-index:1;",""),Z=(0,n.iv)("position:absolute;top:2px;",a.g.far,":2px;color:",a.g.colors.dominant_main,";z-index:1;",""),C=(0,n.iv)("&:hover{.el_icon,&.el_icon{background-color:",(0,p.HO)(a.g.theme.color_1,.15),";color:#fff;}}&._disabled{opacity:.5;background-color:",(0,p.HO)(a.g.theme.color_1,.15),";color:white;}",""),S=e=>{let{icon:t,className:i,onClick:n,disabled:s,negativeColors:o}=e;const l=o?"white":a.g.theme.color_1,c=o?a.g.theme.color_1:"white";return(0,m.tZ)(u.ZT,{css:C,bgColor:c,color:l,icon:t,className:(0,r.AK)(i,{_disabled:s}),onClick:n,disabled:s,size:30})},O=e=>{let{icon:t,toolTip:i,value:n,onClick:r}=e;return(0,m.tZ)(b,{icon:t,toolTip:i,value:n,onClick:r,color:n?a.g.colors.light_blue:void 0,buttonLike:!0})}},2464:(e,t,i)=>{i.d(t,{VK:()=>c,XI:()=>a,kj:()=>l});var n=i(917),r=i(6920),s=i(8318),o=(i(7882),i(5944));const a=e=>{let{size:t,shadowed:i,className:a,onClick:l,img:c,bgColor:d,textFallBack:p,overlayText:u,contain:m="cover"}=e;const g=(0,n.iv)("display:inline-block;vertical-align:middle;position:relative;min-width:",t[0],";height:",t[1],";line-height:",t[1],";text-align:center;border-radius:",r.g.consts.IMG_BORDER_RADIUS,"px;",i?"box-shadow: 0 2px 4px rgba(0,0,0,.4)":"",";width:",t[0],";height:",t[1],";flex-basis:",t[0],";background-color:",d,";background-image:",c?`url('${c}')`:void 0,";background-size:",m,";background-repeat:no-repeat;background-position:center;&._clickable{cursor:pointer;}.overlayText{display:block;position:absolute;bottom:0;left:0;height:fit-content;max-height:33%;overflow-y:auto;overflow-x:hidden;width:100%;font-size:.8em;line-height:1;min-height:1.7em;padding:3px 10px;text-overflow:ellipsis;background-color:",r.g.colors.half_black,";color:",r.g.colors.dominant_white,";}","");return(0,o.BX)("div",{css:g,className:(0,s.AK)(a,{_clickable:l}),onClick:l,children:[!c&&p,u&&(0,o.tZ)("div",{className:"overlayText",children:u})]})},l=6,c=e=>{var t;let{layout:i,maxPhotos:r,height:s,width:a,children:c}=e;if(r||(r=l),!(null!==(t=c)&&void 0!==t&&t.length)>0)return null;c.length>r&&(c=c.slice(0,r));const d=c.length,p={narrow:{1:{columns:1,rows:1,nth:[]},2:{columns:1,rows:2,nth:[]},3:{columns:2,rows:3,nth:["grid-column-end: span 2;grid-row-end: span 2;"]},4:{columns:2,rows:2,nth:[]},5:{columns:2,rows:4,nth:["grid-column-end: span 2; grid-row-end: span 2;"]},6:{columns:2,rows:3,nth:[]}},wide:{1:{columns:1,rows:1,nth:[]},2:{columns:2,rows:1,nth:[]},3:{columns:2,rows:2,nth:["grid-row-end: span 2;"]},4:{columns:4,rows:2,nth:["grid-column-end: span 2; grid-row-end: span 2;","grid-column-end: span 2;"]},5:{columns:4,rows:2,nth:["grid-column-end: span 2; grid-row-end: span 2;"]},6:{columns:3,rows:2,nth:[]}},mobile:{1:{columns:1,rows:1,nth:[]},2:{columns:1,rows:2,nth:[]},3:{columns:2,rows:3,nth:["grid-column-end: span 2;grid-row-end: span 2;"]},4:{columns:2,rows:2,nth:[]},5:{columns:2,rows:6,nth:["grid-row-end: span 3;","grid-row-end: span 2;","grid-row-end: span 2;","grid-row-end: span 3;","grid-row-end: span 2;"]},6:{columns:2,rows:3,nth:[]}}}[i][d]||[];return(0,o.tZ)("div",{css:(u={height:s,width:a},(0,n.iv)("display:grid;height:",u.height||"100%",";width:",u.width||"100%",";grid-template-columns:repeat(",p.columns,", 1fr);grid-template-rows:repeat(",p.rows,", 1fr);grid-columns:repeat(",p.columns,", 1fr);grid-rows:repeat(",p.rows,", 1fr);grid-auto-flow:row;justify-items:stretch;align-items:stretch;justify-content:stretch;align-content:stretch;grid-gap:4px;",p.nth.map(((e,t)=>`> *:nth-child(${t+1}) { ${e}}`)),";","")),children:c});var u}},9159:(e,t,i)=>{i.d(t,{My:()=>_,XZ:()=>g,ZD:()=>b});var n=i(6975),r=i(7363),s=i(917),o=i(6920),a=i(8318),l=i(9952),c=i(5459),d=i(6344),p=i(5944);const u=(0,s.iv)("user-select:none;display:inline-flex;align-items:flex-start;position:relative;&.center{align-items:center;}>input{display:none;}>span{margin-top:9px;}.help-sign{color:",o.g.colors.text_placeholder,";",o.g.classes.margin_near(".5em"),";margin-top:9px;}","");var m={name:"1otlq80",styles:"font-size:1.3rem"};const g=e=>{let{value:t,label:i,onChange:s,checkboxValue:d,checkedWithGreaterValue:g,color:h,disabled:b,className:v,helpKey:_,reversed:f,selfState:y=!1,iconTrue:w="checkbox_checked",iconFalse:x="checkbox",center:k,...Z}=e;const C=(0,r.useRef)(null),[S,O]=(0,r.useState)(!1),B=y?S:t,T=d?g?d<=B:d===B:!!B&&"0"!==B;return(0,p.BX)("label",{css:u,className:(0,a.AK)(v,{center:k}),onClick:e=>e.stopPropagation(),role:"checkbox","aria-checked":T^f?"true":"false",tabIndex:0,onKeyDown:e=>{var t;return" "===e.key&&(e.preventDefault(),null===(t=C.current)||void 0===t?void 0:t.click())},children:[(0,p.tZ)(n.JO,{icon:T^f?w:x,css:m,color:b?o.g.colors.disabled_input_cb:h||o.g.colors.green,buttonLike:!0,disabled:b}),(0,p.tZ)("input",{...Z,ref:C,type:"checkbox",value:d&&!0!==d||1,checked:T,disabled:b,onChange:s?e=>{const t=e.target.checked?d||1:"";return y&&O(!0===d?!!t:t),s(!0===d?!!t:t)}:void 0}),"string"==typeof i?(0,p.tZ)(l.A,{label:i,breakLine:!0}):i,_&&(0,p.tZ)(c.I,{helpKey:_})]})},h=(0,s.iv)('user-select:none;display:flex;direction:ltr;gap:5px;>div>._slider{box-sizing:content-box;cursor:pointer;width:2em;padding:0.25em;border-radius:2.25em;display:block;background-color:#ccc;transition:.4s;min-width:2em;&:before{display:block;content:""!important;height:1em;width:1em;background-color:white;transition:.4s;border-radius:50%;}&._checked{background-color:',o.g.colors.dominant_main,";&:before{transform:translateX(1em);}}&.disabled{cursor:default;&:before{background-color:",o.g.colors.disabled_input_cb,";}}}>.InputLabel{flex-grow:1;overflow:hidden;text-overflow:ellipsis;}>input{display:none;}",""),b=e=>{let{value:t,onChange:i,checkboxValue:n,disabled:r,label:s,labelFirst:o,...c}=e;const d=n?n===t:!!t;let u="string"==typeof s?(0,p.tZ)(l.A,{label:s,breakLine:!0}):s;return(0,p.BX)("label",{css:h,children:[o&&u,(0,p.tZ)("div",{children:(0,p.tZ)("div",{className:(0,a.AK)("_slider",{_checked:d,disabled:r})})}),(0,p.tZ)("input",{...c,type:"checkbox",value:n||1,checked:d,disabled:r,onChange:i?e=>i(e.target.checked?n||1:""):void 0}),!o&&u]})},v=e=>(0,s.iv)("width:30px;height:35px;.loader{display:flex;border-radius:10px;.blob{border:2px solid ",e,";border-radius:3px;margin:10px;height:15px;min-width:10px;min-height:10px;width:15px;animation:checkbox-loader 2s infinite;}@keyframes checkbox-loader{0%{border-color:",(0,d.HO)(e,.9),";border-left-color:",e,";border-top-width:10px;border-right-width:5px;border-bottom-width:5px;border-left-width:10px;}25%{border-top-color:",e,";border-right-color:",(0,d.HO)(e,.9),";border-top-width:10px;border-right-width:10px;border-bottom-width:5px;border-left-width:5px;}50%{border-right-color:",e,";border-bottom-color:",(0,d.HO)(e,.9),";border-top-width:5px;border-right-width:10px;border-bottom-width:10px;border-left-width:5px;}75%{border-bottom-color:",e,";border-left-color:",(0,d.HO)(e,.9),";border-top-width:5px;border-right-width:5px;border-bottom-width:10px;border-left-width:10px;}100%{border-color:",(0,d.HO)(e,.9),";border-left-color:",e,";border-top-width:10px;border-right-width:5px;border-bottom-width:5px;border-left-width:10px;}}}",""),_=function(e){let{color:t=o.g.colors.dominant_main}=e;return(0,p.tZ)("div",{css:v(t),children:(0,p.tZ)("div",{className:"loader",css:v(t),children:(0,p.tZ)("div",{className:"blob"})})})}},9191:(e,t,i)=>{i.d(t,{T:()=>h,z:()=>v});var n=i(7363),r=i(917),s=i(422),o=i.n(s),a=i(6920),l=i(2945),c=i(5311),d=i(6344),p=i(6975),u=i(8318),m=i(5944);const g=(0,r.iv)("display:inline-block;position:relative;>._picker{background-color:",a.g.colors.bg_main,";border:1px solid #a9a9a9;position:fixed;z-index:1;}.random-color{position:absolute;",a.g.far,":8px;top:8px;}",""),h=e=>{let{name:t,value:i,onFocus:n,onBlur:r,placeholder:s,onChange:a,disabled:c,alpha:h,random:b}=e;const _=()=>{if((0,d.BB)(i))try{new(o().Color)(i)}catch(e){a("")}else a("");r&&r()},{opened:f,toggleDD:y,selectRef:w,labelRef:x,ddRef:k}=(0,l.v)({onFocus:n,handleBlur:_,noMinWidth:!0}),Z=i||s,C=(0,d.BB)(Z)?Z:"white",S=(0,d.ou)(C);return(0,m.BX)("div",{css:g,className:"image_input",ref:w,children:[(0,m.tZ)("input",{type:"text",name:t,value:i,disabled:c,placeholder:s,onBlur:_,ref:x,onChange:e=>a(e.target.value),onClick:()=>y(!0),style:{backgroundColor:C,color:S}}),b&&(0,m.tZ)(p.JO,{className:"random-color",icon:"shuffle",smallButtonLike:!0,onClick:()=>a((0,u.p)()),toolTip:lng("randomize")}),f&&(0,m.tZ)("div",{className:"_picker",ref:k,children:(0,m.tZ)(v,{value:Z,onSelect:a,alpha:h,format:h?"rgb":"hex"})})]})},b={name:"17ru2lz",styles:".picker_done{display:none;}.picker_sample{height:20px;}.picker_alpha .picker_selector{right:-14px;}.suggested-colors{display:flex;padding:0.4em 0.6em;.color-pick{width:1em;height:1em;cursor:pointer;margin:1px;}.color-clear{width:1em;height:1em;cursor:pointer;margin:1px;text-align:center;position:relative;&:before,&:after{position:absolute;content:' ';height:1em;width:1px;background-color:#333;}&:before{transform:rotate(45deg);}&:after{transform:rotate(-45deg);}}}"},v=e=>{let{value:t,format:i="rgb",alpha:r,onSelect:s}=e;const l=(0,n.useRef)(null),d=(0,n.useRef)(null);(0,n.useEffect)((()=>{d.current=new(o())({parent:l.current,popup:!1,alpha:r,editorFormat:i,editor:!1}),d.current.onChange=e=>{let t;t="hex"===i?r?e.hex():e.hex().slice(0,-2):r?e.rgbaString():e.rgbString(),s(t)}}),[]),(0,n.useEffect)((()=>{try{var e;null===(e=d.current)||void 0===e||e.setColor(t,!0)}catch(e){}}),[t]);const p=a.g.colors.set,u=e=>{var t;null===(t=d.current)||void 0===t||t.setColor(e,!0),s(e)};return(0,m.BX)("div",{css:b,children:[(0,m.tZ)("div",{ref:l}),(0,m.BX)("div",{className:"suggested-colors",children:[p.slice(0,11).map(((e,t)=>(0,m.tZ)("div",{className:"color-pick",style:{backgroundColor:e},onClick:()=>u(e)},t))),(0,m.tZ)(c.zh,{}),(0,m.tZ)("div",{className:"color-clear",onClick:()=>u("")})]})]})}},6633:(e,t,i)=>{i.d(t,{R:()=>y,W:()=>f});var n=i(917),r=i(6627),s=i.n(r),o=i(5690),a=i(7363),l=i(6920),c=i(2945),d=i(81),p=i(6975),u=i(961),m=i(8318),g=i(5944);const h=(0,n.iv)("background-color:",l.g.colors.bg_main,";border:1px solid #a9a9a9;position:fixed;z-index:",l.g.z.dialog_overlay,";padding:10px;display:flex;>.time-picker{",l.g.classes.margin_near("15px"),";}._hours,._minutes{width:56px;}",""),b=(0,n.iv)("width:100%;>input{width:100%;}.clear-date{position:absolute;top:12px;",l.g.classes.far("8px"),";color:",l.g.colors.disabled_text,";}",""),v=Blsm.prm.date_moment_format,_=(e,t,i)=>{let n=e.date;return e.date&&t&&(n+=" "+((0,m.kE)(e.hour)?e.hour:(null==i?void 0:i[0])||"0").toString().padStart(2,"0")+":"+((0,m.kE)(e.minute)?e.minute:(null==i?void 0:i[1])||"0").toString().padStart(2,"0")),n},f=e=>{let{onBlur:t,onFocus:i,onChange:n,value:r,withTime:l,defaultTime:f,minDate:w,maxDate:x,disabled:k,readOnly:Z,noMinWidth:C,yearsSelector:S,...O}=e;const[B,T]=(0,a.useState)(r),{opened:N,toggleDD:I,selectRef:D,labelRef:j,ddRef:P}=(0,c.v)({onFocus:i,onBlur:t,noMinWidth:C}),z=(0,d.tm)(),E=(e=>{const[t,i=""]=(e||"").split(" "),[n,r=""]=i.split(":"),s=parseInt(r),o=parseInt(n);return{date:t,hour:(0,m.kE)(o)?o:"",minute:(0,m.kE)(s)?s:""}})(B);(0,a.useMemo)((()=>document.activeElement!==j.current&&r!==B&&T(r)),[r]);const R=e=>{if(e.date||(0,m.kE)(e.hour)||(0,m.kE)(e.minute)||e.clear){e.clear&&(e={date:"",hour:"",minute:""}),e.date||E.date||(e.date="__/__/____");const t=_(Object.assign({},E,e),l,f);n(t),T(t)}},F=()=>{if(y(E.date))if(E.hour<0||E.hour>23||E.minute<0||E.minute>59)R({hour:0,minute:0});else{const e=_(E,l,f);e!==B&&n(e)}else R({date:"",hour:"",minute:""})};(0,a.useEffect)((()=>()=>!z.current&&F()));const M=moment(E.date,v);M.utcOffset(Blsm.prm.timezone_offset);const A=M.isValid()?M.startOf("day"):"",q=(0,m.kE)(E.hour)?E.hour:parseInt(null==f?void 0:f[0]),X=(0,m.kE)(E.minute)?E.minute:parseInt(null==f?void 0:f[1]);return(0,g.BX)("div",{css:b,className:"select_date",ref:D,tabIndex:k?void 0:"0",onKeyDown:e=>"Tab"===e.key&&(null!=t&&t(),I(!1)),children:[(0,g.tZ)(s(),{...O,mask:"99/99/9999"+(l?" 99:99":""),type:"text",onFocus:void 0,value:B,disabled:k,readOnly:Z,onChange:e=>{const t=e.target.value,i=t.includes("_")?"":t;T(t),i!==r&&n(i)},onBlur:F,inputRef:e=>j.current=e,onClick:()=>I(!0)}),N&&!k&&!Z&&(0,g.BX)("div",{css:h,ref:P,children:[(0,g.tZ)(o.M,{activeDate:A,onDateSelect:e=>e&&R({date:e.format(v)}),minDate:(0,m.g4)(w),maxDate:(0,m.g4)(x),yearsSelector:S,inDropDown:!0}),l&&(0,g.tZ)(u.j,{opened:N,activeTime:{hour:q,minute:X},onTimeChange:R})]}),r&&!k&&!Z&&(0,g.tZ)(p.JO,{icon:"close",className:"clear-date",onClick:()=>R({clear:!0})})]})},y=e=>{const t=moment(e,v);return!(e.includes("_")||!t.isValid()||t.year()<1970||t.year()>2037)}},6134:(e,t,i)=>{i.d(t,{S:()=>m});var n=i(917),r=i(6975),s=i(6920),o=i(9952),a=i(7363),l=i(7392),c=i(4210),d=i(8318),p=i(5944);const u=(0,n.iv)("padding-bottom:.8em;>.label_cont{color:",s.g.colors.text_placeholder,";margin-bottom:14px;>.InputLabel{font-weight:600;}}.file_warning{color:",s.g.colors.negative,";}",""),m=e=>{let{value:t,onChange:i,label:n,disabled:s,maxFileSizeStr:m,multiFile:g,readOnly:h,maxSize:b,maxFiles:v,..._}=e;const[f,y]=(0,a.useState)(null),w=(0,a.useRef)(),x=g?t:(0,c.DW)(t)?[t]:[],k=x?null==x?void 0:x.filter((e=>!e.delete)).length:0;return(0,p.BX)("div",{css:u,className:"file_input",children:[(0,p.BX)("div",{className:"label_cont",children:["string"==typeof n?(0,p.tZ)(o.A,{label:n}):n,!h&&m?` (${lng("max size").caps()}: ${m})`:b?` (${lng("max size").caps()}: ${(0,d.bQ)(b)})`:"",!h&&v?` (${lng("max number of files").caps()}: ${v})`:""]}),x.length>0&&x.filter((e=>1!==e.delete)).map(((e,n)=>(0,p.BX)("div",{children:[e.link&&(0,p.tZ)(r.JO,{icon:"download",toolTip:lng("download"),buttonLike:!0,href:e.link,download:!0}),!s&&!h&&(0,p.tZ)(r.JO,{icon:"trash",onClick:()=>(e=>{if(g){const n=[];t.forEach((t=>{t!==e?n.push(t):e.file_id&&n.push({...t,delete:1})})),i(n)}else i(c.ip)})(e),buttonLike:!0})," ",e.name||e.file_name]},n))),(!(0,c.DW)(t)||g)&&(0,p.BX)("div",{children:[!h&&(0,p.tZ)(l.l,{theme:"outlined",disabled:s||k>=v,onClick:()=>w.current.click(),children:lng("choose file").caps()}),(0,p.tZ)("input",{type:"file",..._,onChange:e=>{const n=e.currentTarget.files[0];n&&(b&&n.size>b?y(`${lng("file is too big").caps()}: ${(0,d.bQ)(n.size)} (${lng("allowed")}: ${(0,d.bQ)(b)})`):(y(""),n.id=Math.random(),e.currentTarget.value=null,i(g?[...t,n]:n)))},ref:w,style:{display:"none"}}),f&&(0,p.BX)("span",{className:"file_warning",children:[" ",(0,p.tZ)(r.JO,{icon:"sign_notification"})," ",f]})]})]})}},6919:(e,t,i)=>{i.d(t,{aG:()=>k});var n=i(7363),r=i(6920),s=i(917),o=i(6975),a=i(9160),l=i(8e3),c=i(8318),d=i(9952),p=i(8534),u=i(4210),m=i(5459),g=i(8567),h=i(7011),b=i.n(h),v=i(9218),_=i(5944);const f={name:"cwtdzg",styles:"margin:auto;.range_input{margin:0 20px;}"},y=(0,n.forwardRef)((function(e,t){let{src:i,filename:r,zoom:s,position:o}=e;const[a,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(s),[p,u]=(0,n.useState)(o),m=(0,n.useMemo)((()=>({width:250,height:250,border:50,color:[255,255,255,.6],scale:c,borderRadius:25,position:p})),[c,p]);(0,n.useImperativeHandle)(t,(()=>({getEditedImage:async()=>{const e=null==a?void 0:a.getImage().toDataURL(),t=await fetch(e),i=await t.blob();return{file:new File([i],`${r}.png`),editorState:{zoom:c,position:p}}}})));return(0,_.BX)("div",{css:f,children:[(0,_.tZ)(b(),{...m,ref:l,onPositionChange:e=>u(e),image:i}),(0,_.tZ)(v.L,{label:lng("zoom").caps(),min:10,max:20,value:10*c,onChange:e=>{d(e/10)},showValueLabel:!1})]})})),w={zoom:1,position:{x:.5,y:.5}},x=(0,s.iv)("padding-bottom:.8em;>._label{color:",r.g.colors.text_placeholder,";margin-bottom:14px;font-weight:600;}>._bg{width:240px;height:240px;margin:0 auto;background-color:",r.g.colors.bg_1,";background-size:cover;background-position:center;border-radius:10px;overflow:hidden;position:relative;>img,.replace{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);}>img{max-width:100%;max-height:100%;height:auto;width:auto;}>.replace{display:none;width:fit-content;color:",r.g.colors.dominant_main,";background:rgba(255, 255, 255, .9);padding:14px;border-radius:10px;cursor:pointer;&:hover{",r.g.classes.shadow_strong,";}}>._actions{position:absolute;top:0;",r.g.far,":0;display:flex;flex-direction:row-reverse;>.Icon{color:#FFF;}}&:hover>.replace{display:inline-block;}}.help-sign{",r.g.classes.margin_near("10px"),";}",""),k=e=>{let{value:t,onChange:i,label:r,disabled:s,replaceSrc:h="media_manager",uploadType:b,noStretch:v,recommendedSize:f=[],maxFileSize:k,removeButton:C,error:S,required:O,helpKey:B,tabs:T,editor:N}=e;const I=(0,n.useRef)(),D=(0,n.useRef)(null),[j,P]=(0,n.useState)(!1),[z,E]=(0,n.useState)(t),[R,F]=(0,n.useState)(w),[M,A]=(0,a.b)({onSelect:e=>i(null==e?void 0:e.imgtag),selectedItem:t,tabs:T}),q=e=>{if(e)if("upload_temp"===h)(0,l.SC)("generic/load_temp_file",{method:"POST",data:{file:e,type:b}},i);else if("file_object"===h){if(k&&e.size>k)return(0,p.nb)(lng("file may not exceed %s",(0,c.bQ)(k)).caps());(e=>{i(e),E(e),F(w)})(e)}},X=Z(t);let[L,$]=f;L&&void 0===$&&($=L),r&&L&&$&&(r+=` (${L}x${$})`);const V={};v||(V.backgroundImage=`url("${X}")`),$&&(V.height=Math.min(240,Math.max(60,$))+"px");return(0,_.BX)("div",{css:x,className:"image_input",children:[r&&(0,_.tZ)(d.A,{label:r,error:S,required:O}),B&&(0,_.tZ)(m.I,{helpKey:B}),(0,_.BX)("div",{className:"_bg",style:V,children:[v&&(0,_.tZ)("img",{src:X,style:{borderRadius:t.borderRadius}}),!s&&(0,_.BX)("div",{className:"replace",onClick:()=>{"media_manager"===h?A():I.current.click()},children:["media_manager"!==h&&(0,_.tZ)("input",{type:"file",onChange:e=>q(e.currentTarget.files[0]),ref:I,style:{display:"none"},accept:Blsm.prm.extensions.img.map((e=>"."+e)).join(",")}),(0,_.tZ)(o.JO,{icon:"edit"}),"  ",lng("replace image").caps()]}),!s&&(0,_.BX)("div",{className:"_actions",children:[!s&&C&&X&&(0,_.tZ)(o.JO,{icon:"trash",buttonLike:!0,onClick:()=>i("media_manager"===h?null:u.ip)}),!s&&N&&X&&(0,_.tZ)(o.JO,{icon:"crop",toolTip:lng("edit image"),buttonLike:!0,onClick:()=>P(!0)})]})]}),j&&(0,_.tZ)(g.I4,{onConfirm:()=>{D.current.getEditedImage().then((e=>{let{file:t,editorState:n}=e;i(t),F(n),P(!1)}))},onCancel:()=>P(!1),title:lng("edit image"),children:(0,_.tZ)(y,{ref:D,src:Z(z),filename:t.filename,...R})}),M]})},Z=e=>e instanceof File?URL.createObjectURL(e):(0,c.Kn)(e)?e.tmpUrl:e===u.ip?"":r.g.func.imgUrl(e)||e},6421:(e,t,i)=>{i.d(t,{I:()=>j});var n=i(7363),r=i(6627),s=i.n(r),o=i(8318),a=i(6303),l=i(9344),c=i(9159),d=i(9961),p=i(6633),u=i(8714),m=i(9218),g=i(6134),h=i(4925),b=i(6919),v=i(9191),_=i(5474),f=i(3629),y=i(7477),w=i(8e3),x=i(5944);const k=e=>{let{value:t,onChange:i,onSelect:r,onFocus:s,onBlur:a,textClear:l,disableTextChange:c,suggest:d,inline:p,showId:u,...m}=e;const[g,h]=(0,n.useState)(t),{domain:b,field:v,getData:_,table:f,filter:k}=d,Z=(0,n.useCallback)(_||(0,o.pR)(((e,t)=>{const i={name:v||m.name,table:f,domain:b||Blsm.user.domain_id,term:e,filter:k};(0,w.SC)("search/field_autocomplete",{data:i},t)})),[]);return(0,x.tZ)(y.Q,{getData:Z,onTextChange:!c&&(e=>{i(e),h(e)}),onSelect:r,onFocus:s,onBlur:a,block:!p,showId:u,value:g,textClear:!!l,inputProps:m})};var Z=i(5293),C=i(9952),S=i(9039),O=i(493),B=(i(7882),i(961)),T=i(7381),N=i(501),I=i(9595);const D=["hidden","checkbox","toggle","radio","radioset","range","file","tags","system_message","single_item","multiple_items","img","component","switcher","signpad","field_suggest_input"],j=(0,n.memo)((function(e){const{type:t,value:i,options:r,onChange:y,label:w,focusOnShow:j,mask:P,suggest:z,center:E,maxLength:R,required:F,error:M,onBlur:A,onFocus:q,checkboxValue:X,checkedWithGreaterValue:L,emptyOption:$,emptyLabel:V,wrapped:U,inline:H,skinny:J,minimalist:G,labelMargin:W,helpKey:K,maxWidth:Y,grow:Q,nameField:ee,wrapperClassName:te,noMinWidth:ie,extraButtons:ne,yearsSelector:re,staticLabel:se,outsideActions:oe}=e,[ae,le]=(0,n.useState)(!1),ce=Object.assign({},e);U&&void 0===ce.value&&(ce.value=""),ce.onFocus=e=>!ae&&(le(!0),null==q?void 0:q(e)),ce.onBlur=e=>ae&&(le(!1),null==A?void 0:A(e)),ce.className=(0,o.AK)(e.className,"blsm-input",{"blsm-input-wrapped":U}),["insert","label","visible","disable","options","required","validate","focusOnShow","remoteValidate","nameField","mod","wrapperClassName","center","suggest","mask","wrapped","required","error","inline","skinny","minimalist","labelMargin","helpKey","maxWidth","grow","checkboxValue","checkedWithGreaterValue","emptyOption"].forEach((e=>delete ce[e])),w&&["checkbox","toggle","radio","range","file","switcher","signpad"].includes(t)&&(ce.label=(0,x.tZ)(C.A,{label:w,error:M,required:F,helpKey:["toggle","range","file","switcher","signpad"].includes(t)?K:null})),"select"!==t&&ce.emptyOption&&(console.warn("emptyOption is irrelevant for input type",e),delete ce.emptyOption);const de=j?o.Du:void 0,pe=()=>{switch(t){case"richtext":return(0,x.tZ)(l.Ho,{...ce,extraButtons:ne,outsideActions:oe,focusOnShow:j,label:w,autoHideToolbar:e.autoHideToolbar});case"poortext":return z?(0,x.tZ)(k,{...ce,suggest:z,onChange:y?e=>y(e):void 0,ref:de}):(0,x.tZ)(l.Lf,{...ce,focusOnShow:j});case"textarea":return(0,x.tZ)("textarea",{...ce,onChange:y?e=>y(e.target.value):void 0,ref:de});case"select_multi":return(0,x.tZ)(a._,{...ce,options:(0,o.g4)(r,this,[e]),focusOnShow:j,staticLabel:se,emptyLabel:V});case"select":return(0,x.tZ)(_.P,{...ce,options:(0,o.wd)((0,o.g4)(r,this,[e])),emptyOption:$});case"radioset":return(0,x.tZ)(f.M,{...ce,inline:H,options:r});case"checkbox":return(0,x.tZ)(c.XZ,{...ce,helpKey:K,checkboxValue:X,checkedWithGreaterValue:L,center:E});case"polar":return(0,x.tZ)(_.P,{...ce,options:(0,o.g4)([{val:!1,label:lng("no")},{val:!0,label:lng("yes")}],this,[e])});case"toggle":return(0,x.tZ)(c.ZD,{...ce});case"radio":return(0,x.tZ)(d.Y,{...ce,helpKey:K});case"date":case"date_time":return(0,x.tZ)(p.W,{...ce,withTime:"date_time"===t,noMinWidth:ie,yearsSelector:re});case"time":return(0,x.tZ)(B.M,{...ce});case"number":return(0,x.tZ)(u.A,{...ce});case"range":return(0,x.tZ)(m.L,{...ce});case"switcher":return ce.showValueLabel=!(0,o.DM)(ce.showValueLabel)||ce.showValueLabel,(0,x.tZ)(O.T,{...ce,options:r});case"file":return(0,x.tZ)(g.S,{...ce});case"signpad":return(0,x.tZ)(T.$,{error:M,...ce});case"tags":return(0,x.tZ)(h.B7,{...ce,label:w,inline:H,helpKey:K});case"field_suggest_input":return(0,x.tZ)(h.ex,{...ce,label:w,inline:H,helpKey:K,suggest:z});case"system_message":return(0,x.tZ)(I.s2,{...ce,label:w,inline:H,error:M,required:F,helpKey:K,focusOnShow:j});case"single_item":return(0,x.tZ)(h.Dd,{...ce,label:w,inline:H,error:M,required:F,helpKey:K,focusOnShow:j});case"multiple_items":return(0,x.tZ)(h.Uz,{...ce,label:w,inline:H,error:M,required:F,helpKey:K});case"img":return(0,x.tZ)(b.aG,{...ce,error:M,required:F,label:w,helpKey:K});case"color":return(0,x.tZ)(v.T,{...ce,helpKey:K});case"tree_node":return(0,x.tZ)(S.B,{...ce,nameField:ee});case"text":if(P)return(0,x.tZ)(s(),{...ce,maxLength:void 0,mask:P,onChange:y?e=>y(e.target.value):void 0,onBlur:e=>{var t;return e.target.value.includes("_")&&y(""),null===(t=ce.onBlur)||void 0===t?void 0:t.call(ce,e)},ref:de});if(z)return(0,x.tZ)(k,{...ce,suggest:z,onChange:y?e=>y(e):void 0,ref:de});case"search":case"password":return(0,x.tZ)(N.o,{...ce,onChange:y?e=>y(e):void 0,ref:de});case"hidden":return"object"==typeof ce.value&&(ce.value=JSON.stringify(i)),(0,x.tZ)("input",{...ce});default:return console.error(`input of type ${t} is not supported`),(0,x.tZ)("div",{style:{color:"red"},children:`input of type ${t} is not supported`})}};return U&&!D.includes(t)?(0,x.tZ)(Z.n2,{label:w,filled:void 0!==i&&""!==i||void 0!==ce.placeholder||["select_multi","tree_node"].includes(t)||"select"===t&&!ce.emptyOption,focused:ae,disabled:ce.disabled&&"richtext"!==t,readOnly:ce.readOnly,className:te,required:F,error:M,inline:H,skinny:J,minimalist:G,helpKey:K,maxWidth:Y,grow:Q,icon:"search"===t?"search":void 0,labelMargin:W,value:i,maxLength:R,symbol:ce.symbol,children:pe()}):pe()}))},2945:(e,t,i)=>{i.d(t,{c:()=>h,v:()=>m});var n=i(7363),r=i(81),s=i(8318),o=i(6975),a=i(917),l=i(6920),c=i(2698),d=i(5836),p=i(1042),u=i(5944);const m=e=>{let{onFocus:t,onBlur:i,noMinWidth:s}=e;const[o,a]=(0,n.useState)(!1),[l,c]=(0,n.useState)(0),p=(0,n.useRef)();(0,r.t$)(p,(()=>u(!1))),(0,r.OR)("scroll",(0,d.x)((()=>c(l+1))),document);const u=function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=void 0!==e?e:!o;r!==o&&(a(r),r?null==t||t():n||null==i||i())},m=(0,n.useRef)(),g=(0,n.useRef)();return(0,n.useLayoutEffect)((()=>{const e=g.current;if(e){const t=document.documentElement.clientHeight,i=document.documentElement.clientWidth,n=m.current.getBoundingClientRect();n.bottom<=t/2?e.style.top=n.bottom+1+"px":e.style.bottom=t-n.top+1+"px",n.left<=i/2?e.style.left=n.x+"px":e.style.right=i-n.right+"px",s||(e.style.minWidth=n.width+"px")}}),[o,l]),{opened:o,toggleDD:u,selectRef:p,labelRef:m,ddRef:g}},g=e=>(0,a.iv)("display:inline-block;border:1px solid #a9a9a9;border-radius:",l.g.consts.FIELD_BORDER_RADIUS,"px;user-select:none;min-height:23px;background-color:",l.g.colors.bg_input,";",e&&`\n\t\twidth: ${e}; \n\t\tmax-width: min(100%, 90vw);\t\t\n\t`,">._label{padding:1px 6px;display:flex;>.label_text{",l.g.classes.ellipsis,";display:inline-block;max-width:calc(100% - 14px);flex-grow:1;}}>._modal{background-color:",l.g.colors.bg_input,";border:1px solid #a9a9a9;border-radius:",l.g.consts.FIELD_BORDER_RADIUS,"px;position:fixed;z-index:",l.g.z.context_menu,";overflow:auto;max-height:45vh;}",""),h=(0,n.forwardRef)((function(e,t){let{modal:i,label:r,disabled:a,readOnly:l,className:d,onFocus:h,onPaste:b,onBlur:v,onKeyDown:_,wantedWidth:f,caps:y=!0,extra:w}=e;const{opened:x,toggleDD:k,selectRef:Z,labelRef:C,ddRef:S}=m({onFocus:h,onBlur:v}),[O,B]=(0,p.$V)({show:x,type:"blow_y",speed:".1s"});(0,n.useImperativeHandle)(t,(()=>({toggle:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return k(e,t)},opened:x})));const T=e=>b&&x&&(e.stopPropagation(),b(e.clipboardData.getData("text")));return(0,n.useEffect)((()=>(window.addEventListener("paste",T),()=>window.removeEventListener("paste",T))),[x]),(0,u.BX)("div",{css:g(f),className:(0,s.AK)("InputDropDown",d,{disabled:a}),ref:Z,children:[(0,u.BX)(c.LZ,{className:"_label",onClick:()=>!a&&!l&&k(void 0,!0),ref:C,onKeyDown:_,children:[(0,u.tZ)("span",{className:"label_text",children:y?null==r?void 0:r.caps():r})," ",!l&&!a&&(0,u.tZ)(o.JO,{icon:"arrow_down"}),w]}),(O||x)&&(0,u.tZ)("div",{className:"_modal",ref:S,tabIndex:0,onKeyDown:_,...B,children:i})]})}))},9952:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(917),r=i(6920),s=i(6975),o=i(7363),a=i(8318),l=i(5459),c=i(3533),d=i(5944);const p=(0,n.iv)("display:inline-flex;align-items:center;gap:3px;&.no_wrap{white-space:nowrap;}>.Icon,>.help-sign{pointer-events:all;}>.required_icon{font-size:0.6em;color:",r.g.colors.blue,";}>.error_icon{color:",r.g.colors.negative,";}>.length_data{font-size:0.7em;color:",r.g.colors.positive,";&.limit{color:",r.g.colors.negative,";}}",""),u=(0,o.forwardRef)((function(e,t){let{label:i,required:n,error:r,className:o,breakLine:u,helpKey:m,focused:g,valueLength:h,maxLength:b}=e;return i||r||n?(0,d.BX)("span",{css:p,className:(0,a.AK)("InputLabel",o,{no_wrap:u}),ref:t,children:[r&&(0,d.tZ)(s.JO,{icon:"sign_notification",className:"error_icon",toolTip:r}),n&&(0,d.tZ)(s.JO,{icon:"required",className:"required_icon",toolTip:lng("required")}),i&&(0,d.tZ)(c.h,{children:i.caps()}),m&&(0,d.tZ)(l.I,{helpKey:m}),g&&b>0&&(0,d.BX)("span",{className:(0,a.AK)("length_data",{limit:h>=b}),children:["[",h,"/",b,"]"]})]}):null}))},4925:(e,t,i)=>{i.d(t,{B7:()=>C,Dd:()=>O,Uz:()=>B,ex:()=>S});var n=i(7363),r=i(8318),s=i(5293),o=i(7477),a=(i(7882),i(7999)),l=i(8e3),c=i(81),d=i(4210),p=i(9952),u=i(6975),m=i(6920),g=i(3051),h=i(7821),b=i(6380),v=i(917),_=i(1533),f=i(5944);const y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,v.iv)("position:absolute;",m.g.far,":",32*e+3,"px;","")},w=e=>{const{value:t,onChange:i,onSelect:a,label:l,getData:c,tags:d,handleKeys:h,showId:w,buttons:x,single:Z,maxItems:C,placeholder:S,showBadge:O=!0,inline:B,disabled:T,required:N,error:I,helpKey:D,addAll:j,clearAll:P=!0,addMine:z,mineMenu:E,innerFilters:R,focusOnShow:F,showRemove:M,readOnly:A,portal:q,onClear:X,...L}=e,[$,V]=(0,n.useState)(""),[U,H]=(0,n.useState)(!1),J=()=>null==E?void 0:E.find((e=>t.has(e.val))),G=e=>{const n=J();n&&t.delete(n.val);const r=e.map((e=>[e.id,e]));i(new Map([...t,...r]))},W=h?(e,t)=>h(e,t,$):null,K=Z&&(null==t?void 0:t.size)>0||C&&(null==t?void 0:t.size)>=C||!c||A;if(z&&1===(null==t?void 0:t.size)&&E){const e=J();e&&t.set(e.val,e)}const[Y,Q]=(0,n.useState)(""),ee=(0,v.iv)("white-space:nowrap;",m.g.classes.margin_near("5px"),";padding:3px 5px;background-color:",m.g.colors.background_dark,";border-radius:",m.g.consts.SKINNY_BORDER_RADIUS,"px;cursor:pointer;",""),te=!Z&&j&&!!R;Array.isArray(null==R?void 0:R.options)&&(R.options=R.options.reduce(((e,t)=>({...e,[t[0]]:t[1]})),{}));const ie=!A&&E&&z,ne=O&&!Z&&(null==t?void 0:t.size)>0,re=!A&&!Z&&(null==t?void 0:t.size)>0&&P,se=!A&&!Z&&j,oe=(0,f.tZ)(k,{value:t,onChange:i,separateLines:!B&&!d,buttons:x,disabled:T,showRemove:A?()=>!1:M,showId:w,...L});return(0,f.BX)("span",{children:[K?null:(0,f.tZ)(f.HY,{children:(0,f.BX)(s.n2,{label:l,filled:te||!!$||!!S,focused:U,inline:B,disabled:T,readOnly:A,error:I,required:N,helpKey:D,children:[te&&!K&&(0,f.tZ)("span",{css:ee,children:(0,f.BX)(g.x,{dropDownLike:!0,options:(0,r.wd)(R.options),onSelect:e=>Q(e),inForm:!0,children:[R.label&&R.label+": ",R.options[Y]]})}),!A&&(0,f.tZ)(o.Q,{getData:(e,t)=>c(e,t,Y?{[R.name]:Y}:void 0),onTextChange:V,onKeyUp:W,onSelect:(e,n)=>{t.has(e.id)||i(Z?new Map([[e.id,e]]):new Map([...t,[e.id,e]])),(0,r.g4)(a,null,[e]),n()},onFocus:()=>H(!0),onBlur:()=>H(!1),block:!B,skinny:L.skinny,autofocus:F,readOnly:L.readOnly,inputProps:{placeholder:S},showId:w}),ie&&!L.readOnly&&!Z&&(0,f.tZ)(g.x,{options:E,onSelect:e=>{i(new Map([[e,E.find((t=>t.val===e))]]))},css:y((0,r.Gs)(ne,re,se)),children:(0,f.tZ)(u.JO,{icon:"manager",buttonLike:!0})}),ne&&(0,f.tZ)(b.T,{css:y((0,r.Gs)(re,se)),badge:null!=t&&t.size?null==t?void 0:t.size:0}),re&&(0,f.tZ)(u.JO,{icon:"trash",toolTip:lng("clear|verb"),buttonLike:!0,onClick:()=>(i(new Map),null==X?void 0:X()),css:y((0,r.Gs)(se))}),se&&(0,f.tZ)(u.JO,{toolTip:lng("add all"),buttonLike:!0,onClick:()=>{const e={noLimit:!0,all:!0};Y&&(e[R.name]=Y),c($,G,e)},icon:"sign_plus",css:y(0)})]})}),K&&(0,f.tZ)(p.A,{label:l,error:I,required:N}),Z&&0===(null==t?void 0:t.size)?null:q?(0,_.createPortal)(oe,q):oe]})},x=(0,v.iv)("max-width:200px;max-height:40px;display:inline-flex;position:absolute;.minimize-button{position:absolute;",m.g.far,":-25px;top:9px;z-index:101;}.items-list{overflow:hidden;}&.reveal{position:absolute;.items-list{overflow:visible;z-index:100;box-shadow:rgba(0, 0, 0, 0.35) 0 5px 15px;background-color:white;padding-bottom:5px;}}",""),k=e=>{let{value:t,onChange:i,showRemove:s,separateLines:o,buttons:l,showId:c,disabled:d,readOnly:p,minimizedResults:m,onRemove:g,showList:b=!0,...v}=e;const[_,y]=(0,n.useState)(!1),w=!d&&!p;let k=[];if(null!=t&&t.size)for(const[e,i]of t)k.push({key:e,...i});const Z=b?(0,f.tZ)(a.o,{items:k,onRemove:w?e=>{null==g||g(e);const n=t instanceof Map?new Map([...t]):(0,h.toJS)(t);n.delete(e.key),i(n)}:void 0,showRemove:s,separateLines:o,buttons:l,updateItem:e=>{if(!1===e)return;const n=t instanceof Map?new Map([...t]):(0,h.toJS)(t);n.set(e.key,e),null==i||i(n)},showId:c,...v}):null;if(m&&k.length>0){const e=(0,f.tZ)(u.JO,{className:"minimize-button",icon:_?"arrow_up":"arrow_down",smallButtonLike:!0,onClick:()=>y(!_)}),t=_?(0,f.tZ)("div",{style:{width:"300px",display:"inline-flex"}}):"";return(0,f.BX)(f.HY,{children:[(0,f.BX)("div",{css:x,className:(0,r.AK)({reveal:_}),children:[Z,e]}),t]})}return Z},Z=e=>{let{value:t,onChange:i,helpKey:r,getData:s,...o}=e;const[a,l]=(0,n.useState)(T(t,!0));(0,n.useEffect)((()=>{l(T(t,!0))}),[t]);const c=e=>{l(e),i(N(e))};return(0,f.tZ)(w,{...o,value:a,onChange:c,getData:s,tags:!0,handleKeys:(e,t,i)=>{if("Enter"===e.key){const e=i.split(",").map((e=>e.trim())).filter((e=>e));c(new Map([...a,...T(e,!0)])),t()}},objectKeys:["label"],helpKey:r})},C=e=>{let{objectType:t,...i}=e;const s=(0,n.useCallback)((0,r.pR)(((e,i)=>(0,l.SC)("generic/tag_search",{data:{object_type:t.split(","),term:e}},i))),[]);return(0,f.tZ)(Z,{...i,getData:s})},S=e=>{let{suggest:t,...i}=e;const s=(0,n.useCallback)((null==t?void 0:t.getData)||(0,r.pR)(((e,i)=>(0,l.SC)("search/field_autocomplete",{data:{name:t.field,table:t.table,domain:t.domain||Blsm.user.domain_id,term:e}},i))),[]);return(0,f.tZ)(Z,{...i,getData:s,inline:!0,minimizedResults:!0})},O=e=>{let{value:t,onChange:i,helpKey:n,...r}=e;return(0,f.tZ)(B,{single:!0,value:t?[t]:[],onChange:e=>i(e.length?e[0]:""),helpKey:n,...r})},B=e=>{let{value:t,onChange:i,searchData:r,valueIsMap:s,single:o,maxItems:a,name:l,helpKey:p,showRemove:u,disabled:m,showId:g=!0,portal:h=null,...b}=e;const v=(0,c.tm)(),[_,y]=(0,n.useState)(null),x=(0,n.useContext)(d.q3);(0,n.useEffect)((()=>{const e=s?new Map([...t]):T(t);null==_||_.forEach(((t,i)=>{e.has(i)&&e.set(i,t)})),y(e)}),[t]),(0,n.useEffect)((()=>{_?(k(_),x&&x.meta.set(l,_)):x&&l&&x.meta.get(l)&&y(x.meta.get(l))}),[_]);const k=e=>{const t=[...e.keys()],i=null==t?void 0:t.filter((t=>{var i;return!(null!==(i=e.get(t))&&void 0!==i&&i.label)}));i.length&&r({ids:i},(e=>{v.current&&(null==e?void 0:e.length)>0&&y((t=>{const i=new Map([...t]);return e.forEach((e=>i.set(e.id.toString(),Object.assign({},i.get(e.id.toString()),e)))),o&&i.size>1?new Map([i.entries().next().value]):i}))}))},Z=r?function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r({term:e,...i},t)}:void 0;return(0,f.tZ)(w,{...b,value:_,onChange:e=>{y(e),i(s?e:N(e))},getData:Z,single:o,maxItems:a,showRemove:u,showId:g,helpKey:p,portal:h,disabled:m})},T=(e,t)=>{const i=new Map;if((0,r.zG)(e))for(const n of e)i.set(n.toString(),t?{label:n}:{});return i},N=e=>[...e.keys()]},8714:(e,t,i)=>{i.d(t,{A:()=>l,i:()=>s});i(7882);var n=i(8534),r=i(5944);const s=function(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4?arguments[4]:void 0;const o=e=>null!=e&&""!==e;if(r&&!Number.isInteger(parseFloat(e)))return s&&(0,n.nb)(lng("please type a whole number").caps()),!1;let a=r?parseInt(e):parseFloat(e);if(isNaN(a)){if(null!=e&&e.length)return s&&(0,n.nb)(lng("please type a number").caps()),!1}else{if(o(t)&&o(i)&&(a<t||a>i))return s&&(0,n.nb)(lng("number should be between %s and %s",t,i).caps()),!1;if(o(t)&&a<t)return s&&(0,n.nb)(lng("number should be %s or higher",t).caps()),!1;if(o(i)&&a>i)return s&&(0,n.nb)(lng("number should be %s or lower",i).caps()),!1}return!0};var o={name:"16fg6qb",styles:"margin-inline-start:9px"},a={name:"y3g3qk",styles:"white-space:nowrap;margin-inline-end:9px"};const l=e=>{let{value:t,onChange:i,onBlur:n,min:l,max:c,css:d,symbol:p,unit:u,integer:m,...g}=e;const h=Math.max((c||"").toString().length,(l||"").toString().length);return h&&(d=d||{},d.width=`calc(28px + ${h}ch)`),(0,r.BX)(r.HY,{children:[p&&(0,r.tZ)("span",{css:o,children:p}),(0,r.tZ)("input",{...g,css:d,type:"number",min:l,max:c,value:null==t?"":t,autoComplete:"off",onChange:i?e=>i(e.target.value):void 0,onBlur:()=>{i&&i(s(t,l,c,m,!0)?t:""),null==n||n()}}),u&&(0,r.tZ)("span",{css:a,children:u})]})}},9961:(e,t,i)=>{i.d(t,{Y:()=>u});var n=i(917),r=i(6975),s=i(6920),o=i(9952),a=i(7392),l=i(5459),c=i(5944);const d=(0,n.iv)("user-select:none;display:inline-flex;align-items:center;cursor:pointer;position:relative;>input{display:none;}.help-sign{",s.g.classes.margin_far("1ch"),";}","");var p={name:"1otlq80",styles:"font-size:1.3rem"};const u=e=>{let{value:t,label:i,radioValue:n,onChange:u,theme:m,MatButtonStyle:g,disabled:h,helpKey:b,...v}=e;const _=["outlined","contained"].includes(m),f=(0,c.BX)("label",{css:d,children:[!_&&(0,c.tZ)(r.JO,{icon:"radio"+(t===n?"_checked":""),css:p,color:h?s.g.colors.disabled_input_cb:void 0,buttonLike:!0,disabled:h}),b&&(0,c.tZ)(l.I,{helpKey:b}),(0,c.tZ)("input",{...v,type:"radio",value:n,checked:t===n,disabled:h,onChange:u?e=>(e.stopPropagation(),u(n)):void 0}),"string"==typeof i?(0,c.tZ)(o.A,{label:i}):i]});return _?(0,c.tZ)(a.l,{theme:m,style:g,bold:!0,onClick:e=>(e.stopPropagation(),u(n)),children:f}):f}},3629:(e,t,i)=>{i.d(t,{M:()=>o});var n=i(9961),r=i(917),s=(i(7882),i(5944));const o=e=>{let{value:t,onChange:i,options:o,name:a,theme:l,inline:c,disabled:d}=e;const p=(0,r.iv)(["outlined","contained"].includes(l)&&"\n\t\t> div {\n\t\t\tmargin-bottom: 8px;\n\t\t\ttext-align: center;\n\t\t\t._outlined, ._contained {\n\t\t\t\twidth: 300px;\n\t\t\t}\n\t\t}\n\t"," ",c&&"\n\t\tdisplay: flex;\n\t\tjustify-content: space-around;\n\t",";","");return(0,s.tZ)("div",{css:p,children:(o||[]).map(((e,r)=>(0,s.tZ)("div",{children:(0,s.tZ)(n.Y,{value:t,label:e.label,name:a,radioValue:e.val,onChange:i,theme:l,disabled:d})},r)))})}},9218:(e,t,i)=>{i.d(t,{L:()=>u});var n=i(7363),r=i(917),s=(i(7882),i(6920)),o=i(81),a=i(9952),l=i(8318),c=i(5944);const d=(0,r.iv)("padding-bottom:30px;>.InputLabel{color:",s.g.colors.text_placeholder,";margin-bottom:14px;font-weight:600;display:block;}._comp{position:relative;._track{position:relative;height:7px;background-color:#E2E2E2;cursor:pointer;}>._slider{position:absolute;top:-4px;width:16px;height:16px;border-radius:50%;background-color:",s.g.colors.dominant_main,";user-select:none;}>._value{cursor:default;position:absolute;top:15px;color:",s.g.colors.dominant_main,";font-size:1.15em;min-width:16px;text-align:center;white-space:nowrap;}._marker{display:inline-block;position:absolute;top:0;height:7px;width:1px;background-color:",s.g.colors.text_placeholder,";}}",""),p=(e,t,i,n)=>{const r=n.current.getBoundingClientRect(),s=Math.round(e+(i-r.left)*(t-e)/r.width);return Math.min(t,Math.max(e,s))},u=e=>{let{label:t,value:i,onChange:r,min:u=0,max:m=100,sign:g,disabled:h,states:b=[],showValueLabel:v=!0}=e;const _=null==i?void 0:i.toString();let f=i,y=_+(g||""),w=e=>e,x=null;b.length&&(u=0,m=b.length-1,f=Math.max(0,b.findIndex((e=>e.val===_))),y=b[f].label.caps(),x=b[f].color||null,w=e=>b[e].val),r&&(f<u||f>m)&&r(w(u));const[k,Z]=(0,n.useState)(!1),C=(0,n.useRef)(null),S=(0,n.useRef)(null),O=(0,n.useCallback)((()=>Z(!1)),[]),B=(0,n.useCallback)((e=>k&&r(w(p(u,m,e.clientX,C)))),[k,u,m]);(0,o.OR)("mousemove",B),(0,o.OR)("mouseup",O);const T=m-u,N=`calc(${100*(f-u)/T}% - 8px)`;return(0,c.BX)("div",{css:d,className:"range_input",onClick:()=>S.current.focus(),children:["string"==typeof t?(0,c.tZ)(a.A,{label:t}):t,(0,c.BX)("div",{className:"_comp",children:[(0,c.tZ)("div",{className:"_track",ref:C,onClick:e=>!h&&r(w(p(u,m,e.clientX,C))),children:T<10&&(0,l.w6)(T+1).map((e=>(0,c.tZ)("span",{className:"_marker",style:{left:`calc(${100*e/T}%)`}},e)))}),(0,c.tZ)("div",{className:"_slider",style:{left:N,backgroundColor:h?s.g.colors.disabled_input_cb:x},tabIndex:h?void 0:"0",onMouseDown:()=>!h&&Z(!0),onKeyDown:e=>{if(h)return;let t=f+("ArrowRight"===e.key?1:"ArrowLeft"===e.key?-1:0);t=Math.min(m,Math.max(u,t)),t!==f&&r(w(t))},ref:S}),v&&(0,c.tZ)("div",{className:"_value",style:{left:N,color:h?s.g.colors.disabled_input_cb:x},children:y})]}),(0,c.tZ)("input",{type:"hidden",value:i})]})}},9344:(e,t,i)=>{i.d(t,{Ho:()=>o,Lf:()=>c,V1:()=>l});var n=i(5293),r=i(9909),s=i(5944);const o=e=>{let{onChange:t,value:i,refreshKey:n,...o}=e;return(0,s.tZ)(r.U,{onChange:t,value:(i||"").trim(),...o},(null==n?void 0:n())||"")},a={name:"zezgal",styles:'max-width:800px;padding:15px;font-size:1.2em;[data-lexical-editor="true"]{min-height:500px;}'},l=e=>{let{...t}=e;return(0,s.tZ)("div",{css:a,className:"DocumentRichText",children:(0,s.tZ)(n.n2,{children:(0,s.tZ)(o,{...t})})})},c=e=>{let{onChange:t,value:i,...n}=e;return(0,s.tZ)(r.U,{onChange:t,value:(i||"").trim(),plainText:!0,...n})}},5474:(e,t,i)=>{i.d(t,{P:()=>u});var n=i(7363),r=(i(7882),i(8318)),s=i(2945),o=i(917),a=i(6920),l=i(4210),c=i(3533),d=i(5944);const p=(0,o.iv)("background-color:",a.g.colors.light_blue2,";padding:2px 4px;border-radius:5px;font-size:.9em;position:absolute;",a.g.far,":11px;max-width:50px;overflow:hidden;white-space:nowrap;",""),u=function(e){var t,i;let{onChange:o,onFocus:a,onBlur:c,options:u,disabled:m,readOnly:_,emptyOption:f,value:y,name:w,caps:x=!0}=e;f&&(u=[{val:"",label:"string"==typeof f?f:""},...u]),u.forEach((e=>e.label+=""));let[k,Z]=b(u);(0,n.useEffect)((()=>{[k,Z]=b(u)}),[u]);const[C,S]=(0,n.useState)(y);(0,n.useEffect)((()=>{S(y)}),[y,(0,r.SZ)(u)]);let O=null===(t=v(k,C,"val"))||void 0===t?void 0:t[0];O||(O=k.length>0?k[0]:{},O.val!==C&&S(O.val));const B=(0,n.useContext)(l.q3);B&&B.meta.set(w,k);const T=(0,n.useRef)(),[N,I]=(0,n.useState)(""),D=(0,n.useRef)([]),j=e=>{T.current.toggle(!1),S(e),o(e),I("")},P=(0,d.tZ)("div",{style:{padding:"6px"},children:(u||[]).map(((e,t)=>e.optgroup?(0,d.tZ)(h,{groupOptions:e,inputValue:C,highlight:N,onSelect:j},t):(0,d.tZ)(g,{option:e,inputValue:C,highlight:N,onSelect:j,caps:x},e.val)))});return(0,d.tZ)(s.c,{ref:T,modal:P,onFocus:a,onBlur:()=>{C!=y&&o(C),null==c||c()},label:(null===(i=O)||void 0===i?void 0:i.label)||"",disabled:m,readOnly:_,onPaste:e=>I(e),onKeyDown:e=>{if(m||_)return;let t=k,i=O.index;if(D.current.length>0&&(t=D.current,i=t.findIndex((e=>e.index==i))),1===e.key.length||"Backspace"===e.key){const t="Backspace"===e.key?N.slice(0,-1):N+e.key.toLowerCase();if(I(t),D.current=v(k,t),0===D.current.length&&(D.current=v(k,t,"val")),t){const e=D.current.reduce(((e,t)=>t.priority<(null==e?void 0:e.priority)?t:e),{priority:5});(null==e?void 0:e.priority)<5&&S(e.val)}}else switch(["Tab","F5"].includes(e.key)||e.preventDefault(),e.key){case"ArrowUp":{let e=i-1;e<0&&(e=t.length-1),S(t[e].val),T.current.opened||o(t[e].val)}break;case"ArrowDown":{let e=i+1;e>=t.length&&(e=0),S(t[e].val),T.current.opened||o(t[e].val)}break;case"Home":S(t[0].val);break;case"End":S(t[t.length-1].val);break;case"Enter":I(""),D.current=[],T.current.toggle(!1,!0),o(C);break;case"Escape":I(""),D.current=[];break;case"Tab":I(""),D.current=[],T.current.toggle(!1),o(C)}},wantedWidth:Math.min(1e3,9*Z)+"px",caps:x,extra:N&&(0,d.tZ)("span",{css:p,children:N})})},m=e=>{let{color:t,bgColor:i}=e;return(0,o.iv)("min-height:23px;border-radius:4px;padding:2px 5px;margin:4px;",t?(0,o.iv)("color:",t,";background-color:",i,";&:hover{background-color:",i+"AA",";}",""):(0,o.iv)("&.active{background-color:",a.g.colors.dominant_main,";color:white;}&:hover:not(.active){background-color:",a.g.colors.dominant_main_shade,";color:",a.g.colors.text_main,";}",""),";","")},g=e=>{var t,i;let{option:n,inputValue:r,onSelect:s,highlight:o,caps:a}=e;const{val:l}=n,p=l==r;let u=a?null===(t=n.label)||void 0===t||null===(i=t.caps)||void 0===i?void 0:i.call(t):n.label;return(0,d.tZ)("div",{css:m(n),className:p?"active":"",onClick:s?()=>s(l):void 0,ref:e=>p&&(null==e?void 0:e.scrollIntoView()),children:o?(0,d.tZ)(c.y,{highlight:o,children:u}):u},l||"null")},h=e=>{var t,i,n;let{groupOptions:s,inputValue:o,onSelect:a,highlight:l}=e;if(null===(t=s.options)||void 0===t||!t.length)return null;const c=null===(i=s.label)||void 0===i||null===(n=i.caps)||void 0===n?void 0:n.call(i),p=(0,r.wd)(s.options);return(0,d.BX)("div",{label:c,children:[(0,d.tZ)("b",{children:c}),p.map((e=>(0,d.tZ)(g,{option:e,inputValue:o,onSelect:a,highlight:l},e.val||"null")))]})},b=e=>{const t=[];let i=10;for(const s of e){var n;if(s.optgroup)for(const e of s.options){var r;t.push(e),i=Math.max(i,null==e||null===(r=e.label)||void 0===r?void 0:r.length)}else t.push(s),i=Math.max(i,null==s||null===(n=s.label)||void 0===n?void 0:n.length)}return[t,i]},v=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label";const n=[];for(const[r,s]of Object.entries(e))if("label"===i)s.label.toLowerCase().startsWith(t)?n.push({priority:1,index:parseInt(r),...s}):s.label.toLowerCase().includes(t)&&n.push({priority:2,index:parseInt(r),...s});else if(s.val==t)return[{priority:1,index:parseInt(r),...s}];return n}},6303:(e,t,i)=>{i.d(t,{_:()=>b});var n=i(917),r=i(6920),s=(i(7882),i(7363)),o=i(6975),a=i(8318),l=i(2945),c=i(5560),d=i(5680),p=i(3533),u=i(6421),m=i(5944);const g=(0,n.iv)("label{padding:3px 6px;display:block;",r.g.classes.ellipsis,";input{vertical-align:middle;display:none;}}&.contained,&.contained label{color:",r.g.colors.dominant_white,";background-color:",r.g.colors.dominant_main,";border-color:",r.g.colors.separator_light,";}&.emphasis,&.emphasis label{color:",r.g.colors.dominant_main,";background-color:",r.g.colors.blue_shade,";}","");var h={name:"e23o9g",styles:"padding:10px"};const b=(0,c.observer)((function(e){let{value:t=[],options:i,onChange:n,onFocus:r,onBlur:o,theme:c,className:p,disabled:b,readOnly:v,caps:f=!0,trim:y,maxLabelLength:w,emptyLabel:x=`${lng("select").caps()}...`,staticLabel:k=!1,showSearch:Z=!1}=e;const C=(0,s.useMemo)((()=>(i||[]).map((e=>e.optgroup?e.options:e)).flat()),[i]),[S,O]=(0,s.useState)("");if("string"==typeof t&&(t=t?t.split(","):[]),"tags"===c)return(0,m.tZ)(d.r$,{className:p,children:(i||[]).map((e=>{let{val:i,label:r,color:s}=e;return(0,m.tZ)(d.Vp,{tag:f?r.caps():r,active:t.includes(i),color:s,onClick:()=>n(t.includes(i)?t.filter((e=>e!==i)):[...t,i])},i)}))});{const e=e=>{let{label:t}=e;return y&&(t=t.trim()),f&&(t=t.caps()),t},s=(0,m.BX)(m.HY,{children:[Z&&(0,m.tZ)("div",{css:h,children:(0,m.tZ)(u.I,{type:"search",wrapped:!0,className:"wrapped",placeholder:lng("search").caps(),value:S,onChange:e=>O(e)})}),(i||[]).map(((e,i)=>{if(""===S||e.label.toLowerCase().includes(S.toLowerCase())||e.optgroup&&e.options.map((e=>{var t;return null===(t=e.val)||void 0===t?void 0:t.toLowerCase().includes(null==S?void 0:S.toLowerCase())})).length>0)return(0,m.tZ)(_,{option:e,highlight:S,values:t,onChange:n,caps:f,trim:y},i)}))]}),d=k?x:C.filter((e=>{var i,n;return null===(i=(n=t).includes)||void 0===i?void 0:i.call(n,e.val)})).map(e).join(", ")||x,B=w&&d.length>w?d.slice(0,w)+"...":d;return(0,m.tZ)(l.c,{modal:s,label:B,css:g,className:(0,a.AK)(p,c),onFocus:r,onBlur:o,disabled:b,readOnly:v,caps:f})}}));var v={name:"1pxl9ke",styles:"font-size:15px"};const _=(0,c.observer)((function e(t){var i,n,r,s;let{option:a,values:l,onChange:c,caps:d,trim:u,highlight:g}=t,{color:h,label:b,optgroup:_,options:f,val:y}=a;if(u&&(b=b.trim()),_)return(null==f?void 0:f.length)>0?(0,m.BX)(m.HY,{children:[(0,m.tZ)("label",{children:(0,m.tZ)("b",{children:b.caps()})}),(f||[]).map((t=>(""===g||t.label.toLowerCase().includes(g.toLowerCase()))&&(0,m.tZ)(e,{option:t,values:l,onChange:c,highlight:g},t.val)))]}):null;let w=d?null===(i=b)||void 0===i||null===(n=i.caps)||void 0===n?void 0:n.call(i):b;return(0,m.BX)("label",{style:{color:h},children:[(0,m.tZ)(o.JO,{icon:"checkbox"+(null!==(r=l.includes)&&void 0!==r&&r.call(l,y)?"_checked":""),css:v}),(0,m.tZ)("input",{type:"checkbox",checked:c?null===(s=l.includes)||void 0===s?void 0:s.call(l,y):void 0,onChange:c?e=>{var t;return c(e.target.checked?[...l,y]:null===(t=l.filter)||void 0===t?void 0:t.call(l,(e=>e!==y)))}:void 0})," ",g?(0,m.tZ)(p.y,{highlight:g,children:w}):w]},y)}))},7381:(e,t,i)=>{i.d(t,{$:()=>u});var n=i(917),r=i(7363),s=i(1518),o=i(9952),a=i(6975),l=i(8318),c=i(6920),d=i(4210),p=i(5944);const u=function(e){let{label:t,name:i,value:u,readOnly:m,disabled:g,onChange:h,error:b}=e;const v=(0,n.iv)(".container{display:inline-block;position:relative;background:white;._clear{position:absolute;top:0;",c.g.far,":0;}canvas,.value{display:block;border:2px dashed ",b?c.g.colors.negative:c.g.colors.border,";}}",""),_=(0,r.useRef)(),f=(0,r.useRef)(),y=!(m||g),w=(0,r.useContext)(d.q3),x=()=>{y&&(f.current.isEmpty()?(w&&w.meta.set("sigorig_"+i,void 0),h(void 0)):(w&&w.meta.set("sigorig_"+i,f.current.toDataURL()),h((0,l.pH)(_.current))))};return(0,r.useEffect)((()=>{if(y)return f.current=new s.Z(_.current),w&&f.current.fromDataURL(w.meta.get("sigorig_"+i)),()=>f.current.off()}),[]),(0,p.BX)("div",{css:v,children:[(0,p.tZ)("div",{children:"string"==typeof t?(0,p.tZ)(o.A,{label:t}):t}),(0,p.BX)("div",{className:"container",children:[y&&(0,p.tZ)(a.JO,{className:"_clear",icon:"clear",toolTip:lng("clear|verb"),onClick:()=>{f.current.clear(),h(void 0)}}),y&&(0,p.tZ)("canvas",{ref:_,tabIndex:m||g?null:0,onMouseUp:x,onTouchEnd:x}),(0,l.DM)(u)&&!y&&(0,p.tZ)("img",{className:"value",src:u})]})]})}},5946:(e,t,i)=>{i.d(t,{D:()=>a});var n=i(6920),r=i(917),s=i(5944);const o=e=>{let{large:t,color:i}=e;return(0,r.iv)(i?`color: ${i};`:""," font-weight:600;font-size:",t?1.7:1,"rem;margin:",t?1.2:.4,"rem 0 ",t?.5:.2,"rem;&::first-letter{text-transform:capitalize;}","")},a=e=>{let{children:t,large:i,color:r=n.g.colors.dominant_main,...a}=e;return(0,s.tZ)("div",{css:o({large:i,color:r}),...a,children:t})}},9595:(e,t,i)=>{i.d(t,{k4:()=>B,s2:()=>O});var n,r,s,o=i(4925),a=i(8e3),l=i(7821),c=i(8318),d=i(5560),p=i(7363),u=i(3346),m=i(9483),g=i(1619),h=i(8567),b=i(6975),v=i(917),_=i(6920),f=i(5944);function y(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function x(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const k=(0,l.observable)(new Map),Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(k.has(e))t(k.get(e));else{k.set(e,!1);let i="";i=(0,c.kE)(e)?"/id="+e:"/default="+e,(0,a.SC)("systemMessages/message_data"+i,{},(i=>{k.set(e,i),t(i)}))}};let C=(r=x((n=class{constructor(e,t){y(this,"messageTypes",r,this),y(this,"messageType",s,this),w(this,"searchData",((e,t)=>{(0,a.SC)("systemMessages/search_system_messages",{data:{id:e.ids,term:e.term,messageTypes:this.types}},t)})),(0,l.makeObservable)(this),this.messageTypes=t,this.messageType=e}get types(){var e;const t=(0,c.g4)(this.messageType),i=(0,c.g4)(this.messageTypes),n=null!==(e=null==i?void 0:i.map((e=>e[0])))&&void 0!==e?e:[];return(null==t?void 0:t.length)>1&&n.push(t),n}}).prototype,"messageTypes",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=x(n.prototype,"messageType",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x(n.prototype,"types",[l.computed],Object.getOwnPropertyDescriptor(n.prototype,"types"),n.prototype),n);const S=(0,v.iv)("display:flex;flex-grow:1;flex-shrink:0;>*+*{",_.g.classes.margin_far("1em"),";}>span{width:100%;}>.Icon-preview{flex-shrink:0;margin:auto;}",""),O=e=>{let{value:t,messageType:i,messageTypes:n,showSMS:r,getAdditionalText:s,noDefault:a=(()=>!1),...l}=e;const{types:c,searchData:p}=new C(i,n);return r&&(l.disabled=!0),l.getLabel&&(l.label=l.getLabel()),(0,f.tZ)(d.Observer,{children:()=>(0,f.BX)("div",{css:S,children:[(0,f.tZ)(o.Dd,{value:t,searchData:p,onValueChange:e=>Z(e),buttons:[{Render:N,props:{showSMS:r,getAdditionalText:s}}],...l}),!a()&&!t&&(null==c?void 0:c.length)>0&&(0,f.tZ)(N,{item:{messageType:i,messageTypes:n},showSMS:r,getAdditionalText:s})]})})},B=(0,d.observer)((e=>{var t,i,n,r,s;let{custom_message:o,isDefault:a,showSMS:l,getAdditionalText:c}=e;const[d,h]=(0,p.useState)();if(a)return(0,f.tZ)(u.$0,{title:lng("default system message"),style:{pointerEvents:"none"},children:l?(0,f.tZ)(u.$0,{title:lng("text message"),children:o.sms?(0,f.BX)(m.m,{children:[(0,f.tZ)("div",{children:o.sms}),c&&(0,f.tZ)("div",{children:c()})]}):(0,f.tZ)("div",{children:lng("not available").caps()})}):(0,f.BX)(u.$0,{title:o.title,children:[(0,f.tZ)(m.m,{children:(0,f.tZ)("h1",{children:o.h1})}),(0,f.tZ)(m.m,{children:(0,f.tZ)("h2",{children:o.h2})}),(0,f.tZ)(m.m,{children:(0,f.tZ)(g.xn,{content:o.message})}),c&&(0,f.tZ)(m.m,{children:(0,f.tZ)(g.xn,{content:c()})})]})});const b=Object.keys(o.domain_languages||{}).filter((e=>{var t,i,n,r;return!!(null!==(t=o["mail_"+e])&&void 0!==t&&t.title||null!==(i=o["mail_"+e])&&void 0!==i&&i.h1||null!==(n=o["mail_"+e])&&void 0!==n&&n.h2||null!==(r=o["mail_"+e])&&void 0!==r&&r.message)})).map((e=>({val:e,label:o.domain_languages[e]}))),v=(0,p.useMemo)((()=>(b||[]).find((e=>(null==e?void 0:e.val)===d))),[d,b]);return(0,p.useEffect)((()=>{var e;b&&!d&&h(null===(e=b[0])||void 0===e?void 0:e.val)}),[b]),(0,f.BX)(u.$0,{title:o.c_email_name,children:[b.length>1&&(0,f.tZ)(u.gN,{input:{type:"select",label:lng("language"),options:b},value:d,onChange:e=>h(e)}),d&&(l?(0,f.tZ)(u.$0,{title:lng("text message"),children:null!==(t=o["mail_"+d])&&void 0!==t&&t.sms?(0,f.BX)(m.m,{children:[(0,f.tZ)("div",{content:o["mail_"+d].sms}),c&&(0,f.tZ)("pre",{content:c()})]}):(0,f.tZ)("div",{children:lng("not available").caps()})}):(0,f.BX)(u.$0,{title:null===(i=o["mail_"+d])||void 0===i?void 0:i.title,style:{pointerEvents:"none"},children:[(0,f.tZ)(m.m,{children:(0,f.tZ)("h1",{children:null===(n=o["mail_"+d])||void 0===n?void 0:n.h1})}),(0,f.tZ)(m.m,{children:(0,f.tZ)("h2",{children:null===(r=o["mail_"+d])||void 0===r?void 0:r.h2})}),(0,f.tZ)(m.m,{children:(0,f.tZ)(g.xn,{content:null===(s=o["mail_"+d])||void 0===s?void 0:s.message})}),c&&(0,f.tZ)(m.m,{children:(0,f.tZ)(g.xn,{content:c()})})]})),1===b.length&&(0,f.tZ)(m.m,{children:(0,f.tZ)("small",{children:lng("only available in %s|language",null==v?void 0:v.label).caps()})}),0===b.length&&lng("system message is empty").caps()]})})),T=e=>{var t;let{messages:i,getMessage:n,showSMS:r,getAdditionalText:s}=e;const[o,a]=(0,p.useState)(null===(t=i[0])||void 0===t?void 0:t.val),[l,d]=(0,p.useState)(),m=(0,p.useMemo)((()=>i.map((e=>({...e,label:(0,c.g4)(e.label)})))),[]);return(0,p.useEffect)((()=>n(o,(e=>d(e)))),[o]),(0,f.BX)("div",{children:[(0,f.tZ)(u.gN,{input:{options:m,type:"select",label:lng("to|person")},value:o,onChange:a}),l&&(0,f.tZ)(B,{custom_message:l,isDefault:!0,showSMS:r,getAdditionalText:s})]})},N=(0,d.observer)((e=>{let{item:t,showSMS:i,getAdditionalText:n}=e;return(0,f.tZ)(b.JO,{icon:"preview",buttonLike:!0,onClick:()=>{if((0,c.g4)(t.messageTypes))(0,h.qR)((0,f.tZ)(T,{messages:(0,c.wd)((0,c.g4)(t.messageTypes)),getMessage:(e,t)=>Z(e,t),showSMS:i,getAdditionalText:n}),{title:lng("system message"),width:"700px"});else{const e=(0,c.kE)(t.id)?t.id:(0,c.g4)(t.messageType);Z(e,(e=>(0,h.qR)((0,f.tZ)(B,{custom_message:e,isDefault:!(0,c.kE)(t.id),showSMS:i,getAdditionalText:n}),{title:lng("system message"),width:"700px"})))}}})}))},501:(e,t,i)=>{i.d(t,{o:()=>a});var n=i(7363),r=i(9483),s=i(8318),o=i(5944);const a=(0,n.forwardRef)((function(e,t){let{value:i,onChange:a,autoDir:l,...c}=e;const[d,p]=(0,n.useState)((0,r.d)(i)),u=(0,s.v7)(c),m=document.documentElement.classList.contains("RTL")?"right":"left",g=l?{direction:d?"rtl":"ltr",textAlign:i.length>0?d?"right":"left":m}:void 0;return(0,o.tZ)("input",{style:g,value:i,onChange:e=>{l&&p((0,r.d)(e.target.value)),null==a||a(e.target.value)},...u,ref:t})}))},961:(e,t,i)=>{i.d(t,{M:()=>g,j:()=>_});var n=i(917),r=i(6920),s=i(7363),o=i(6627),a=i.n(o),l=i(81),c=i(8318),d=i(6975),p=i(2945),u=i(5944);let m;const g=function(e){if((0,c.tq)()&&function(){if((0,c.DM)(m))return m;const e=(0,c.Ux)("input",{type:"time"}),t="hello";return e.setAttribute("value",t),m=e.value!==t}()){const{onChange:t,value:i,...n}=e;return(0,u.tZ)("input",{...n,type:"time",value:i,onChange:t?e=>t(e.target.value):void 0})}return(0,u.tZ)(b,{...e})},h=(0,n.iv)("width:100%;>input{width:100%;}>._picker{background-color:",r.g.colors.bg_main,";border:1px solid #a9a9a9;position:fixed;z-index:2;display:flex;._hours,._minutes{width:50%;}}.clear-date{position:absolute;top:12px;",r.g.classes.far("8px"),";color:",r.g.colors.disabled_text,";}",""),b=function(e){let{onBlur:t,onFocus:i,onChange:n,value:r,defaultTime:o,disabled:m,...g}=e;const{opened:b,toggleDD:v,selectRef:f,labelRef:y,ddRef:w}=(0,p.v)({onFocus:i,onBlur:t}),x=(0,s.useRef)(r),k=(0,l.tm)();(0,s.useEffect)((()=>()=>!k.current&&S()));const Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const[t,i]=e.replace(/_/g,"").split(":");return{hour:t,minute:i}},C=e=>{const t=Object.assign({},Z(x.current),e),i=t.hour||t.minute?Math.min(t.hour,23).toString().padStart(2,"0")+":"+Math.min(t.minute,59).toString().padStart(2,"0"):"";x.current=i,i!==r&&n(i)},S=()=>{x.current&&C(Z(x.current))},[O,B=""]=x.current.split(":"),T=(0,c.kE)(O)?O:parseInt(null==o?void 0:o[0]),N=(0,c.kE)(B)?B:parseInt(null==o?void 0:o[1]);return(0,u.BX)("div",{css:h,className:"select_date",ref:f,tabIndex:m?void 0:"0",onKeyDown:e=>"Tab"===e.key&&(null!=t&&t(),v(!1)),children:[(0,u.tZ)(a(),{...g,mask:"99:99",type:"text",value:r,onChange:e=>{const t=e.target.value;x.current=t,n(t)},onBlur:S,disabled:m,inputRef:e=>y.current=e,onClick:()=>v(!0)}),b&&(0,u.tZ)("div",{className:"_picker",ref:w,children:(0,u.tZ)(_,{opened:b,activeTime:{hour:T,minute:N},onTimeChange:C})}),r&&(0,u.tZ)(d.JO,{icon:"close",className:"clear-date",onClick:()=>C({hour:void 0,minute:void 0})})]})},v=(0,n.iv)("display:flex;width:100%;direction:ltr;max-width:112px;>div{max-height:230px;}",r.g.classes.border_near("1px solid "+r.g.colors.separator),";._hours,._minutes{",r.g.classes.border_far("1px solid "+r.g.colors.separator),";overflow-y:hidden;&:hover{overflow-y:scroll;}>div{height:32px;line-height:32px;padding:0 12px;cursor:pointer;&:hover{background-color:",r.g.colors.dominant_main_shade,";}&._active{color:",r.g.colors.dominant_main,";}}}",""),_=e=>{let{activeTime:t,onTimeChange:i,opened:n}=e;return n?(0,u.BX)("div",{css:v,className:"time-picker",children:[(0,u.tZ)("div",{className:"_hours",children:(0,c.w6)(24).map((e=>(0,u.tZ)(f,{time:e,type:"hour",onTimeChange:i,activeTime:t},e)))}),(0,u.BX)("div",{className:"_minutes",children:[(0,c.w6)(12).map((e=>(0,u.tZ)(f,{time:5*e,type:"minute",onTimeChange:i,activeTime:t},5*e))),(0,u.tZ)(f,{time:59,type:"minute",onTimeChange:i,activeTime:t},59)]})]}):null},f=e=>{let{time:t,type:i,onTimeChange:n,activeTime:r}=e;const o=(0,s.useRef)(null),a=(0,s.useMemo)((()=>t==r[i]),[r]);return(0,s.useEffect)((()=>{a&&o.current.scrollIntoView()}),[a]),(0,u.tZ)("div",{ref:o,className:(0,c.AK)({_active:a}),onClick:()=>n({[i]:t}),children:t.toString().padStart(2,"0")})}},9039:(e,t,i)=>{i.d(t,{B:()=>p});var n=i(7363),r=i(2945),s=i(8318),o=i(101),a=i(6421),l=i(5944);var c={name:"1ksdjft",styles:"padding:0 6px"},d={name:"e23o9g",styles:"padding:10px"};const p=function(e){var t;let{tree:i,value:p,onChange:u,disabled:m,onFocus:g,onBlur:h,showSearch:b=!0,...v}=e;const _=(0,n.useRef)(),[f,y]=(0,n.useState)("");let[w,x]=(0,n.useState)("");x=(0,n.useCallback)((0,s.Ds)(x,300),[x]);const k=(0,l.BX)(l.HY,{children:[b&&(0,l.tZ)("div",{css:d,children:(0,l.tZ)(a.I,{type:"search",wrapped:!0,placeholder:lng("search").caps(),value:f,onChange:e=>{y(e),x(e)}})}),(0,l.tZ)("div",{css:c,children:(0,l.tZ)(o.mp,{...v,tree:i,filterText:w,activeId:p,onSelect:e=>(_.current.toggle(!1),u(e))})})]}),Z=v.nameField||"name";return(0,l.tZ)(r.c,{ref:_,label:(null===(t=(0,s.oH)(i,(e=>(null==e?void 0:e.id)===p)))||void 0===t?void 0:t[Z])||`${lng("select").caps()}...`,modal:k,onFocus:g,onBlur:h,disabled:m})}},2216:(e,t,i)=>{i.d(t,{S:()=>_});var n=i(745),r=i(5762),s=i(917),o=i(7821),a=i(5560),l=i(8318),c=i(6920),d=i(7392),p=i(7697),u=i(5311),m=i(441),g=i(7316),h=i(5944);const b=(0,o.observable)([]),v=(0,a.observer)((()=>b.length?(0,h.tZ)("div",{children:b.map((e=>(0,h.tZ)(y,{...e,onClose:()=>{var t;return b.remove(e),null===(t=e.onClose)||void 0===t?void 0:t.call(e)}},e.__uid)))}):null));(0,l.Um)((()=>{(0,n.s)((0,l.wq)("InteractiveNoticeQueue")).render((0,h.tZ)(v,{}))}));const _=e=>b[0]=e,f=(0,s.iv)("margin:10px auto;background-color:",c.g.colors.dominant_white,";width:70%;display:flex;background-color:",c.g.colors.white,";-webkit-box-shadow:0 10px 13px -7px #000000,5px 5px 25px -15px rgba(0,0,0,0.5);box-shadow:0 10px 13px -7px #000000,5px 5px 25px -15px rgba(0,0,0,0.5);padding:30px;justify-content:space-around;border-radius:8px;align-items:center;position:fixed;bottom:0;",c.g.far,":15%;z-index:",c.g.z.notice,";",c.g.mQuery.mobile,"{width:90vw;left:calc(100% - 95vw);flex-wrap:wrap;}",c.g.mQuery.mobileNarrow,"{.interactive-content{padding:10px 0;}}.interactive-content{",c.g.classes.margin_near("20px")," .title{font-size:18px;font-weight:700;}.msg{font-size:16px;}.title,.msg{margin-top:10px;}}.buttons{display:flex;height:50px;justify-content:flex-end;div{padding:30px;font-size:1.1em;font-weight:600;align-items:center;",c.g.classes.margin_near("10px"),";display:flex;}}",""),y=e=>{let{onClose:t,href:i,title:n,msg:s,color:o,hrefTitle:a,type:l="notice",animation:c}=e;const b=e=>{e.stopPropagation(),e.preventDefault(),t()};return(0,h.BX)(r.SV,{children:["notice"===l&&(0,h.BX)("div",{css:f,children:[(0,h.tZ)(p.F$,{label:"i",color:o,size:"65",underLabel:!1}),(0,h.BX)("div",{className:"interactive-content",children:[(0,h.tZ)("div",{className:"title",children:n.caps()}),s&&(0,h.tZ)("div",{className:"msg",children:null==s?void 0:s.caps()})]}),(0,h.tZ)(u.zh,{}),(0,h.BX)("div",{className:"buttons",children:[(0,h.tZ)(d.l,{theme:"contained",onClick:e=>{(0,m.p4)(i,!0),b(e)},children:a}),(0,h.tZ)(d.l,{className:"btn",theme:"outlined",onClick:b,children:lng("close").caps()})]})]}),"congratulations"===l&&(0,h.tZ)(g.h,{animation:c})]})}},7999:(e,t,i)=>{i.d(t,{o:()=>d});var n=i(917),r=i(6920),s=(i(7882),i(8318)),o=i(6975),a=i(5680),l=i(5944);const c=e=>{let{fitContent:t,maxHeight:i}=e;return(0,n.iv)("max-height:",t?"fit-content":i,";overflow:auto;&._inline{display:inline-flex;flex-wrap:wrap;>div{margin-inline-start:.5em;margin-top:5px;._label+*{margin-inline-start:7px;font-size:0.8em;}}}&._empty{margin-bottom:0;}>div{background-color:",r.g.colors.dominant_main,";color:white;padding:7px 10px;border-radius:1em;display:flex;align-items:center;._id{margin:0 10px;font-size:0.75rem;}._label{flex-grow:1;}}&:not(._inline){>div.list-item{margin-top:4px;}}&.bright:not(._inline){>div.list-item{padding:10px 10px 14px;border-radius:0;background-color:",r.g.colors.bg_main,";color:",r.g.colors.text_main,";border-bottom:1px solid ",r.g.colors.separator,";&:nth-last-child(1){border-bottom:0;}}}&.bright._inline{>div.list-item{background-color:",r.g.colors.bg_input,";color:",r.g.colors.text_main,";border:1px solid ",r.g.colors.separator,";}}._edit{margin-",r.g.far,":5px;}._button{padding:0 5px;white-space:nowrap;}._poster{border-radius:50%;min-width:37px;height:37px;margin:-12px 0;margin-",r.g.near,":-5px;margin-",r.g.far,":8px;text-align:center;background:transparent no-repeat top center;background-size:cover;color:white;}","")},d=e=>{let{items:t,showId:i,onRemove:n,showRemove:d,onEdit:p,separateLines:u,buttons:m,updateItem:g,theme:h,poster:b,fitContent:v,maxHeight:_="190px"}=e;return(0,l.tZ)("div",{css:c({fitContent:v,maxHeight:_}),className:(0,s.AK)("items-list",{_inline:!u,_empty:0===t.length,[h||""]:!0}),children:Array.isArray(t)&&t.map((e=>(0,l.BX)("div",{className:"list-item","data-id":e.id,"data-key":e.key,children:[b&&(0,l.tZ)("div",{className:"_poster",style:{backgroundColor:r.g.func.id2color(e.key),backgroundImage:e.poster?`url('${e.poster}')`:void 0}}),i&&e.id&&(0,l.BX)("div",{className:"_id",children:["#",e.id]}),(0,l.tZ)("div",{className:"_label",children:e.label||"..."}),e.subLabel&&(0,l.tZ)(a.Vp,{tag:e.subLabel.text,color:e.subLabel.color}),(null==m?void 0:m.length)>0&&m.map(((t,i)=>(0,l.tZ)("span",{className:"_button",children:(0,l.tZ)(t.Render,{onChange:i=>{var n;return g(t.onChange?null===(n=t.onChange)||void 0===n?void 0:n.call(t,e,i):e)},item:e,...t.props})},i))),p&&(0,l.tZ)(o.JO,{smallButtonLike:!0,icon:"edit",className:"_edit _button",onClick:()=>p(e)}),(!d||d(e))&&n&&(0,l.tZ)(o.JO,{smallButtonLike:!0,className:"_button",icon:"mark_x_light",onClick:()=>n(e)})]},e.key)))})}},1823:(e,t,i)=>{i.d(t,{G:()=>o});var n=i(5944);const r=(e,t)=>{let i=JSON.stringify(e,null,t?1:4);t&&(i=i.slice(2,-1));let n=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return n=n.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,(function(e){let t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),`<span class="${t}">${e}</span>`})),n.replace(/\\\\/g,"\\").replace(/\\"/g,'"').replace(/\\t/g," ").replace(/\\r/g," ").replace(/\\n/g,"<br/>")},s={name:"b104z1",styles:"margin:0;.key{color:#204a87;}.string{color:#4e9a06;}.number{color:#ad7fa8;}.boolean{color:#c4a000;}.null{color:#babdb6;font-style:italic;}"},o=e=>{let{jsonObj:t,className:i}=e;return(0,n.tZ)("pre",{css:s,className:i,dangerouslySetInnerHTML:{__html:r(t,!0)}})}},9909:(e,t,i)=>{i.d(t,{U:()=>vt});var n=i(7363),r=i(917),s=i(6920),o=i(8318),a=i(6975),l=i(7154),c=i(5944);const d=(0,r.iv)("display:inline-flex;align-items:center;justify-content:center;width:30px;margin:0 1px;cursor:pointer;border-radius:3px;background-color:",s.g.colors.bg_main,";color:",s.g.colors.text_main,";height:30px;position:relative;&.active{background-color:",s.g.colors.light_blue2,"!important;}&:hover{background-color:",s.g.colors.highlight,"!important;color:#FFF!important;}img{max-height:16px;max-width:16px;}&.disabled{background-color:",s.g.darkMode?s.g.colors.disabled_background:s.g.colors.bg_2,"!important;color:",s.g.darkMode?s.g.colors.text_black:s.g.colors.disabled_background,"!important;cursor:auto;}",""),p=e=>{let{active:t,icon:i,onToggle:n,tooltip:r,disabled:s,style:p,className:u}=e;return(0,c.tZ)(l.u,{text:r,children:(0,c.tZ)("div",{css:d,className:(0,o.AK)(u,{active:t,disabled:s}),onClick:()=>!s&&(null==n?void 0:n()),style:p,children:(0,c.tZ)(a.JO,{icon:i})})})},u=(0,r.iv)("margin:0 2px;border-left:1px solid ",s.g.colors.separator,";",""),m=()=>(0,c.tZ)("div",{css:u,className:"Separator"});var g=i(9191);const h={name:"16ezhqa",styles:"display:flex;padding:10px;>div:first-of-type{margin-right:15px;}>div{>div:first-of-type{font-weight:600;margin-bottom:3px;}}.picker_wrapper{font-size:6px;}.suggested-colors{font-size:10px;}"},b=e=>{let{color:t,bgColor:i,colorSelect:r,bgSelect:s,disabled:o}=e;const[a,d]=(0,n.useState)(!1),u=(0,c.BX)("div",{css:h,children:[(0,c.BX)("div",{children:[(0,c.tZ)("div",{style:{backgroundColor:i,padding:"0 7px",borderRadius:"5px",width:"150px"},children:lng("background color").caps()}),(0,c.tZ)(g.z,{value:i,onSelect:s,format:"hex"})]}),(0,c.BX)("div",{children:[(0,c.tZ)("div",{style:{color:t,padding:"0 7px",fontWeight:"bold"},children:lng("text color").caps()}),(0,c.tZ)(g.z,{value:t,onSelect:r,format:"hex"})]})]});return(0,c.tZ)(l.y,{behavior:"trigger",trigger:a,content:u,onClose:()=>d(!1),children:(0,c.tZ)(p,{disabled:o,tooltip:lng("text color"),icon:"font",onToggle:()=>d(!a),style:{color:t,backgroundColor:i}})})};var v=i(2998),_=i(9408),f=i(4783),y=i(2903),w=i(6969),x=i(4260),k=i(3435),Z=i(441),C=i(3051),S=i(8567),O=i(8714),B=i(1709),T=i(8082),N=i(6220);function I(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const D=(0,r.iv)("position:relative;>.buttons{color:",s.g.colors.text_main,";display:none;position:absolute;top:5px;left:5px;padding:5px;box-shadow:0 0 3px silver;background-color:",s.g.colors.half_white,";font-size:13px;border-radius:5px;>div{margin:0 0.5em;&:hover{color:",s.g.colors.link_blue_hover,";}}a{text-decoration:none;}}&:hover>.buttons{display:flex;}","");class j extends T.DecoratorBlockNode{static getType(){return"iframe"}static clone(e){return new j(e.__src,e.__key)}constructor(e,t){super(void 0,t),I(this,"__src",void 0),this.__src=e}updateDOM(){return!1}exportDOM(){const e=document.createElement("iframe");return e.src=this.__src,e.allowfullscreen=!0,e.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen",{element:e}}static importDOM(){return{iframe:()=>({conversion:e=>{const{src:t}=e;return{node:P({src:t})}},priority:0})}}exportJSON(){return{...super.exportJSON(),src:this.__src,type:"iframe",allowfullscreen:"",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen",version:1}}static importJSON(e){const{src:t}=e;return P({src:t})}decorate(e,t){return(0,c.tZ)(z,{src:this.__src,format:this.__format,config:t,nodeKey:this.getKey()})}isInline(){return!1}}function P(e){let{src:t,key:i}=e;return(0,v.$applyNodeReplacement)(new j(t,i))}const z=e=>{var t;let{src:i,format:n,config:r,nodeKey:o,media:l}=e;const[d]=(0,x.useLexicalComposerContext)(),p=(null===(t=r.theme)||void 0===t?void 0:t.embedBlock)||{};return(0,c.tZ)(B.BlockWithAlignableContents,{className:{base:p.base||"",focus:p.focus||""},format:n,nodeKey:o,children:(0,c.BX)("div",{css:[s.g.classes.iframeVideoSize,D,"",""],children:[l?(0,c.tZ)(N.S,{url:i}):(0,c.tZ)("iframe",{src:i,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}),(0,c.tZ)("div",{className:"buttons",children:(0,c.tZ)(a.JO,{icon:"trash",onClick:()=>d.update((()=>(0,v.$getNodeByKey)(o).remove())),toolTip:lng("remove").caps()})})]})})};function E(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class R extends v.DecoratorNode{static getType(){return"image"}static clone(e){return new R(e.__src,e.__altText,e.__maxWidth,e.__width,e.__inlineFile,e.__key)}constructor(e,t,i,n,r,s){super(s),E(this,"__src",void 0),E(this,"__altText",void 0),E(this,"__width",void 0),E(this,"__maxWidth",void 0),E(this,"__inlineFile",void 0),this.__src=e,this.__altText=t,this.__maxWidth=i,this.__width=n+"",this.__inlineFile=r}createDOM(e){var t;const i=document.createElement("span");return void 0!==(null==e||null===(t=e.theme)||void 0===t?void 0:t.image)&&i.classList.add(...e.theme.image),i}updateDOM(){return!1}exportDOM(){const e=document.createElement("img");return e.setAttribute("src",A(this.__src)),this.__altText&&e.setAttribute("alt",this.__altText),this.__width&&e.setAttribute("width",this.__width.toString()),{element:e}}static importDOM(){return{img:()=>({conversion:e=>{const{alt:t,src:i,width:n,style:r}=e;return{node:F({altText:t,src:i,width:r.width||n||""})}},priority:0})}}exportJSON(){return{altText:this.__altText,maxWidth:this.__maxWidth,src:this.__src,type:"image",version:1,width:this.__width}}static importJSON(e){const{altText:t,width:i,maxWidth:n,src:r}=e;return F({altText:t,maxWidth:n,src:r,width:i})}exportCommand(){return this.__inlineFile?{type:"image",src:this.__src,name:this.__altText,inlineFile:this.__inlineFile}:null}setWidth(e){this.getWritable().__width=e}decorate(){return(0,c.tZ)(M,{node:this,src:this.__src,width:this.__width,nodeKey:this.getKey()})}}function F(e){let{altText:t,maxWidth:i=500,src:n,width:r,inlineFile:s,key:o}=e;return(0,v.$applyNodeReplacement)(new R(n,t,i,r,s,o))}const M=e=>{let{node:t}=e;const{__src:i,__width:n}=t,[r]=(0,x.useLexicalComposerContext)(),s=e=>r.update((()=>t.setWidth(e))),o=null==n?void 0:n.endsWith("px"),l=[{label:lng("original width"),onClick:()=>s(),active:!n},{label:lng("max width"),onClick:()=>s("100%"),active:"100%"===n},{label:lng("custom width")+(o?` (${n})`:""),active:o,onClick:()=>{(0,S.cS)(lng("enter image width in pixels"),{title:lng("image size"),confirmText:lng("apply"),inputType:"number",startValue:o?parseInt(n):void 0,inputRequired:!0,inputOptions:{min:50,max:1e3},valueValid:e=>(0,O.i)(e,50,1e3),onConfirm:e=>s(e+"px")})}}];return(0,c.BX)("span",{css:D,style:{display:"inline-block",width:n},children:[(0,c.tZ)(Z.wo,{url:i,file_name:".jpg",children:(0,c.tZ)("img",{src:i,alt:"image",style:n?{width:n}:{maxHeight:"500px"}})}),(0,c.BX)("div",{className:"buttons",children:[(0,c.tZ)(C.x,{noPortal:!0,options:l,inForm:!0,children:(0,c.tZ)(a.JO,{icon:"width"})}),(0,c.tZ)(a.JO,{icon:"trash",onClick:e=>(e.preventDefault(),r.update((()=>t.remove()))),toolTip:lng("remove").caps()})]})]})},A=e=>{const t=location.origin+Blsm.prm.Mainref;return e.startsWith(t)?e.substring(t.length):e};function q(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class X extends T.DecoratorBlockNode{static getType(){return"video"}static clone(e){return new X(e.__src,e.__key)}constructor(e,t){super(void 0,t),q(this,"__src",void 0),this.__src=e}updateDOM(){return!1}exportDOM(){const e=document.createElement("video");return e.src=this.__src,{element:e}}static importDOM(){return{video:()=>({conversion:e=>{const{src:t}=e;return{node:L({src:t})}},priority:0})}}exportJSON(){return{...super.exportJSON(),src:this.__src,type:"video",version:1}}static importJSON(e){const{src:t}=e;return L({src:t})}decorate(e,t){return(0,c.tZ)(z,{src:this.__src,format:this.__format,config:t,nodeKey:this.getKey(),media:!0})}isInline(){return!1}}function L(e){let{src:t,key:i}=e;return(0,v.$applyNodeReplacement)(new X(t,i))}function $(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class V extends v.DecoratorNode{static getType(){return"file"}static clone(e){return new V(e.__src,e.__name,e.__inlineFile,e.__key)}constructor(e,t,i,n){super(n),$(this,"__name",void 0),$(this,"__src",void 0),$(this,"__inlineFile",void 0),this.__src=e,this.__name=t,this.__inlineFile=i}createDOM(e){var t;const i=document.createElement("span");return void 0!==(null==e||null===(t=e.theme)||void 0===t?void 0:t.link)&&i.classList.add(...e.theme.link),i}updateDOM(){return!1}exportDOM(){const e=document.createElement("a");return e.setAttribute("href",A(this.__src)),e.textContent=this.__name,e.className="attached-file",{element:e}}static importDOM(){return{a:e=>e instanceof HTMLElement&&e.classList.contains("attached-file")?{conversion:e=>{const{href:t}=e;return{node:U({src:t,name:e.textContent})}},priority:4}:null}}exportJSON(){return{name:this.__name,src:this.__src,type:"file",version:1}}static importJSON(e){const{src:t,name:i,inlineFile:n}=e;return U({src:t,name:i,inlineFile:n})}exportCommand(){return this.__inlineFile?{type:"file",src:this.__src,name:this.__name,inlineFile:this.__inlineFile}:null}decorate(){return(0,c.tZ)("a",{className:"attached-file",href:this.__src,rel:"noreferrer",target:"_blank",children:this.__name})}}function U(e){let{src:t,name:i,inlineFile:n,key:r}=e;return(0,v.$applyNodeReplacement)(new V(t,i,n,r))}const H=(0,v.createCommand)("INSERT_IMAGE_COMMAND"),J=(0,v.createCommand)("INSERT_VIDEO_COMMAND"),G=(0,v.createCommand)("INSERT_IFRAME_COMMAND"),W=(0,v.createCommand)("INSERT_FILE_COMMAND");function K(){const[e]=(0,x.useLexicalComposerContext)();return(0,n.useEffect)((()=>{const t=[];return e.hasNodes([R])&&(t.push(e.registerCommand(H,(e=>{const t=F(e);return(0,v.$insertNodes)([t]),(0,v.$isRootOrShadowRoot)(t.getParentOrThrow())&&(0,w.$wrapNodeInElement)(t,v.$createParagraphNode).selectEnd(),!0}),v.COMMAND_PRIORITY_EDITOR)),e.hasNodes([X])&&t.push(e.registerCommand(J,(e=>{const t=L(e);return(0,w.$insertNodeToNearestRoot)(t),!0}),v.COMMAND_PRIORITY_EDITOR)),e.hasNodes([j])&&t.push(e.registerCommand(G,(e=>{const t=P(e);return(0,w.$insertNodeToNearestRoot)(t),!0}),v.COMMAND_PRIORITY_EDITOR))),e.hasNodes([V])&&t.push(e.registerCommand(W,(e=>{const t=U(e);return(0,v.$insertNodes)([t]),(0,v.$isRootOrShadowRoot)(t.getParentOrThrow())&&(0,w.$wrapNodeInElement)(t,v.$createParagraphNode).selectEnd(),!0}),v.COMMAND_PRIORITY_EDITOR),e.registerCommand(y.DRAG_DROP_PASTE,(t=>{for(const i in t){const n=t[i],r=URL.createObjectURL(n);n.type.startsWith("image")&&e.hasNodes([R])?e.dispatchCommand(H,{altText:n.name,src:r,inlineFile:n}):e.dispatchCommand(W,{name:n.name,src:r,inlineFile:n})}return!0}),v.COMMAND_PRIORITY_LOW)),(0,w.mergeRegister)(...t)}),[e]),null}var Y=i(6421),Q=i(9159),ee=i(7392);const te=(0,r.iv)("padding:15px;display:flex;flex-direction:column;.label{font-size:.9em;margin-bottom:5px;}.url_input{display:flex;align-items:center;input[type=text]{min-width:300px;}}.disabled{color:",s.g.colors.text_light_disabled,";}.Button{align-self:flex-end;}",""),ie=e=>{let{urlValue:t,confirmLink:i,removeLink:r,label:s,iframeSupport:o,setActive:l,newTabSupport:d,newTabValue:p}=e;const[u,m]=(0,n.useState)(t||(Blsm.prm.LOCALHOST?"https://youtu.be/iwGFalTRHDA":"")),[g,h]=(0,n.useState)(!1),[b,v]=(0,n.useState)(p);(0,n.useEffect)((()=>{l(!0)}),[]);const _=ne(u),f=Z.H8.test(_||u)||Z.f3.test(_||u)||Z.Qu.test(_||u),y=()=>{f&&i({url:_||u,iframe:!!_||g,target:b?"_blank":""})};return(0,c.BX)("div",{css:te,onMouseDown:e=>e.stopPropagation(),children:[(0,c.BX)("div",{children:[(0,c.BX)("div",{className:"label",children:[s||lng("enter link url").caps(),":"]}),(0,c.BX)("div",{className:"url_input",children:[(0,c.tZ)(Y.I,{type:"text",wrapped:!0,placeholder:"https://",value:u,onKeyDown:e=>"Enter"===e.key&&y(),onChange:e=>m(e),error:!f&&(null==u?void 0:u.length)>0?lng("invalid URL"):void 0,focusOnShow:!0}),r&&(0,c.tZ)(a.JO,{icon:"trash",onClick:r,toolTip:lng("clear|verb"),buttonLike:!0})]})]}),o&&(0,c.tZ)("div",{children:(0,c.tZ)(Q.XZ,{label:lng("embed in iframe"),value:!!_||g,disabled:!!_,onChange:h})}),d&&(0,c.tZ)("div",{children:(0,c.tZ)(Q.XZ,{label:lng("open in new tab"),value:b,onChange:v})}),(0,c.tZ)(ee.l,{onClick:y,disabled:!f,theme:"contained",children:lng("confirm").caps()})]})},ne=e=>{const t=document.createRange().createContextualFragment(e).querySelector("iframe");return null==t?void 0:t.src};var re=i(2808),se=i(9160),oe=i(6746),ae=i(7828),le=i(7965),ce=i(1533),de=i(9714);const pe=e=>{let{options:t,slackMarkdown:i,setPopout:s,autoHideToolbar:a,active:d,setActive:u,extraButtons:g=[],outsideActions:h=[],disabled:Z}=e;const[S]=(0,x.useLexicalComposerContext)(),[O,B]=(0,n.useState)("paragraph"),[T,N]=(0,n.useState)(!0),[I,D]=(0,n.useState)(!1),[j,P]=(0,n.useState)(!1),[z,E]=(0,n.useState)(!1),[R,F]=(0,n.useState)(!1),[M,A]=(0,n.useState)("#000"),[q,X]=(0,n.useState)("#fff"),[L,$]=(0,n.useState)({}),V=(0,n.useCallback)((e=>S.update((()=>{const t=(0,v.$getSelection)();(0,v.$isRangeSelection)(t)&&(0,_.$patchStyleText)(t,e)}))),[S]),U=(0,n.useCallback)((()=>{const e=(0,v.$getSelection)();if((0,v.$isRangeSelection)(e)){const t=e.anchor.getNode(),i="root"===t.getKey()?t:t.getTopLevelElementOrThrow(),n=i.getKey();if(null!==S.getElementByKey(n))if((0,f.$isListNode)(i)){const e=(0,w.$getNearestNodeOfType)(t,f.ListNode),n=e?e.getTag():i.getTag();B(n)}else{const e=(0,y.$isHeadingNode)(i)?i.getTag():i.getType();B(e)}D(e.hasFormat("bold")),P(e.hasFormat("italic")),E(e.hasFormat("underline")),F(e.hasFormat("strikethrough")),A((0,_.$getSelectionStyleValueForProperty)(e,"color","#000")),X((0,_.$getSelectionStyleValueForProperty)(e,"background-color","#fff")),N(e.isCollapsed());const r=he(e),s=(0,k.$isLinkNode)(r)?r:!!(0,k.$isLinkNode)(r.getParent())&&r.getParent();if(s){const e=(0,w.$findMatchingParent)(s,k.$isAutoLinkNode);$({isLink:!e,isAutoLink:!!e,url:s.getURL(),newTab:"_blank"===s.getTarget()})}else $({})}}),[S]),H=(0,n.useRef)(null),J=(0,n.useCallback)((e=>{let{code:t,ctrlKey:i,shiftKey:n}=e;H.current=i&&"ShiftLeft"===t||n&&"ControlLeft"===t?"left":i&&"ShiftRight"===t||n&&"ControlRight"===t?"right":null}),[S]),G=(0,n.useCallback)((()=>{H.current&&(S.dispatchCommand(v.FORMAT_ELEMENT_COMMAND,H.current),H.current=null)}),[S]);(0,n.useEffect)((()=>(0,w.mergeRegister)(S.registerUpdateListener((e=>{let{editorState:t}=e;return t.read((()=>U()))})),S.registerCommand(v.SELECTION_CHANGE_COMMAND,(()=>(U(),!1)),1),S.registerRootListener(((e,t)=>{null==t||t.removeEventListener("keydown",J),null==e||e.addEventListener("keydown",J),null==t||t.removeEventListener("keyup",G),null==e||e.addEventListener("keyup",G)})))),[S,U]);const W=(0,o.tq)(),K={bold:t.font&&(0,c.tZ)(p,{icon:"bold",tooltip:lng("bold"),active:I,onToggle:()=>S.dispatchCommand(v.FORMAT_TEXT_COMMAND,"bold")},"bold"),italic:t.font&&(0,c.tZ)(p,{icon:"italic",tooltip:lng("italic"),active:j,onToggle:()=>S.dispatchCommand(v.FORMAT_TEXT_COMMAND,"italic")},"italic"),underline:t.font&&!i&&(0,c.tZ)(p,{icon:"underline",tooltip:lng("underline"),active:z,onToggle:()=>S.dispatchCommand(v.FORMAT_TEXT_COMMAND,"underline")},"underline"),strikethrough:t.font&&(0,c.tZ)(p,{icon:"strikethrough",tooltip:lng("strikethrough"),active:R,onToggle:()=>S.dispatchCommand(v.FORMAT_TEXT_COMMAND,"strikethrough")},"strikethrough"),color:t.color&&(0,c.tZ)(b,{color:M,bgColor:q,disabled:T,colorSelect:e=>V({color:e}),bgSelect:e=>V({"background-color":e})},"color"),sep1:(0,c.tZ)(m,{},"sep1"),link:t.link&&(0,c.tZ)(be,{activeLink:L,disabled:T,newTabSupport:"newTab"===t.link,onConfirm:e=>S.dispatchCommand(k.TOGGLE_LINK_COMMAND,e),setActive:u},"link"),attach:t.attach&&(0,c.tZ)(fe,{},"attach"),media:t.media&&(0,c.tZ)(_e,{},"media"),media_link:t.media_link&&(0,c.tZ)(ve,{setActive:u},"media_link"),sep2:(0,c.tZ)(m,{},"sep2"),list1:t.list&&(0,c.tZ)(p,{icon:"list",tooltip:lng("bulleted list"),onToggle:()=>S.dispatchCommand("ul"!==O?f.INSERT_UNORDERED_LIST_COMMAND:f.REMOVE_LIST_COMMAND),active:"ul"===O},"list1"),list2:t.list&&(0,c.tZ)(p,{icon:"list_ol",tooltip:lng("numbered list"),onToggle:()=>S.dispatchCommand("ol"!==O?f.INSERT_ORDERED_LIST_COMMAND:f.REMOVE_LIST_COMMAND),active:"ol"===O},"list2"),sep3:(0,c.tZ)(m,{},"sep3"),align1:t.align&&(0,c.tZ)(p,{tooltip:lng("align left"),icon:"align_left",onToggle:()=>S.dispatchCommand(v.FORMAT_ELEMENT_COMMAND,"left")},"align1"),align2:t.align&&(0,c.tZ)(p,{tooltip:lng("align center"),icon:"align_center",onToggle:()=>S.dispatchCommand(v.FORMAT_ELEMENT_COMMAND,"center")},"align2"),align3:t.align&&(0,c.tZ)(p,{tooltip:lng("align right"),icon:"align_right",onToggle:()=>S.dispatchCommand(v.FORMAT_ELEMENT_COMMAND,"right")},"align3"),placeholders:t.placeholders&&(0,c.tZ)(C.x,{options:Object.entries(t.placeholders).map((e=>{let[t,i]=e;return{val:t,label:i}})),onSelect:e=>S.dispatchCommand(oe.Py,{text:e}),children:(0,c.tZ)(p,{icon:"placeholder"})},"placeholders"),sep4:g.length>0&&Object.keys(t||{}).length>0&&(0,c.tZ)(m,{},"sep4"),...g.reduce(((e,t)=>{let{name:i,component:n}=t;return{...e,[i]:n({editor:S,key:i})}}),{})},Y=e=>{const t=[];let i=!0;for(const r in e){var n;if(null!==(n=e[r].key)&&void 0!==n&&n.startsWith("sep")){if(i||r>=e.length-1)continue;i=!0,t.push(e[r])}else i=!1,t.push(e[r])}return t};if(W){const e=Y([K.color,K.link,K.list1,K.list2,K.sep3,K.align1,K.align2,K.align3].filter((e=>e)));if(e.length>1){const t=[K.bold,K.italic,K.underline,K.strikethrough,K.sep1,K.attach,K.media,K.media_link,K.sep2,K.placeholders].filter((e=>e));return(0,c.BX)(ge,{autoHideToolbar:a,active:d,children:[t,(0,c.tZ)(l.y,{content:(0,c.tZ)(ge,{inBalloon:!0,children:e}),children:(0,c.tZ)(p,{icon:"menu"})})]})}}const Q=Y(Object.values(K).filter((e=>e))),ee=0===Q.length||1===Q.length&&"placeholders"===Q[0].key&&0===Q[0].props.options.length?0:1;return(0,c.tZ)("div",{css:(0,r.iv)({opacity:ee},"",""),children:(0,c.BX)(ge,{outside:t.popout&&(0,c.tZ)(p,{className:"popout",icon:"arrow_out_square",onToggle:()=>s(!0),tooltip:lng("pop out text")}),autoHideToolbar:a,active:d,children:[!Z&&Q,h.map((e=>{let{name:t,component:i,ref:n}=e;return(0,ce.createPortal)(i({editor:S,key:t}),n.current)}))]})})};var ue={name:"bjn8wh",styles:"position:relative"};const me=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,r.iv)(!t&&ue," ",t&&(0,r.iv)("position:absolute;background-color:#FFF;border-radius:10px;z-index:1;bottom:calc(100% + 5px);",s.g.classes.shadow_strong,";","")," .dt-buttons{display:inline-flex;padding:3px;border-radius:3px;margin:2px 3px 4px;max-width:100%;flex-flow:wrap;",!e&&!t&&(0,r.iv)("border:1px solid ",s.g.colors.separator,";",s.g.classes.shadow_light,";",""),";}.mention-autocomplete{color:",s.g.colors.text_black,";background-color:",s.g.colors.mention_bg,";}.Separator+.Separator,.Separator:first-child,.Separator:last-child{display:none;}.popout{position:absolute;",s.g.far,":0;bottom:0;}","")},ge=e=>{let{children:t,inBalloon:i,outside:n,autoHideToolbar:r,active:s}=e;return(0,c.tZ)(ae.M,{initial:r||!1,children:(s||!r)&&(0,c.BX)(le.E.div,{variants:{enter:{opacity:0,y:"-100%"},open:{opacity:1,y:0},exit:{opacity:0,y:"100%"}},initial:"enter",animate:"open",exit:"exit",css:me(i,r),children:[(0,c.tZ)("div",{className:"dt-buttons",onMouseDown:e=>e.preventDefault(),children:t}),n]})})};function he(e){const t=e.anchor,i=e.focus,n=e.anchor.getNode(),r=e.focus.getNode();if(n===r)return n;return e.isBackward()?(0,_.$isAtNodeEnd)(i)?n:r:(0,_.$isAtNodeEnd)(t)?r:n}const be=e=>{let{activeLink:t,disabled:i,onConfirm:r,setActive:s,newTabSupport:o}=e;const[a,d]=(0,n.useState)(!1),{isLink:u,isAutoLink:m,url:g,newTab:h}=t;m&&(i=!0);const b=(0,c.tZ)(ie,{urlValue:g,confirmLink:e=>(d(!1),r(e)),removeLink:()=>(d(!1),r(null)),setActive:s,newTabSupport:o,newTabValue:!1!==h});return(0,c.tZ)(l.y,{behavior:"trigger",trigger:a,content:b,onClose:()=>d(!1),children:(0,c.tZ)(p,{active:u,tooltip:lng("add link"),icon:"link",onToggle:()=>d(!a),disabled:i})})},ve=e=>{let{setActive:t}=e;const[i]=(0,x.useLexicalComposerContext)(),[r,s]=(0,n.useState)(!1),[a,d]=(0,n.useState)(Blsm.prm.LOCALHOST?"http://localhost/lms/dizzy3.mp4":""),u=(0,c.tZ)(ie,{urlValue:a,confirmLink:e=>{let{url:t,iframe:n}=e;const r=n?t:(0,o.sR)(t);r?i.dispatchCommand(G,{src:r}):t.endsWith(".mp4")||(0,o.en)(t).pathname.endsWith(".mp4")?i.dispatchCommand(J,{src:t}):i.dispatchCommand(H,{src:t}),s(!1),d("")},iframeSupport:!0,label:lng("enter url to Youtube, Vimeo, Ted, mp4 or an image, or paste iframe embed code").caps(),setActive:t});return(0,c.tZ)(l.y,{behavior:"trigger",trigger:r,content:u,onClose:()=>s(!1),children:(0,c.tZ)(p,{active:!1,tooltip:lng("add media from link"),icon:"image",onToggle:()=>s(!0)})})},_e=()=>{const[e]=(0,x.useLexicalComposerContext)(),t=(0,n.useContext)(de.G),i=(0,se.b)({onSelect:t=>{"vid"===(0,re.r5)(t.name||t.imgtag)?e.dispatchCommand(J,{src:s.g.func.imgUrl(t.imgtag)}):e.dispatchCommand(H,{src:s.g.func.imgUrl(t.imgtag)})},tabs:["images","gallery","videos"],dialog:!t});let r,o;t?[r,o]=i:o=i;const a=(0,c.tZ)(p,{active:!1,icon:"media",tooltip:lng("add media from gallery"),onToggle:o});return t?(0,c.BX)(c.HY,{children:[a,r]}):a},fe=()=>{const[e]=(0,x.useLexicalComposerContext)();return(0,c.tZ)("div",{children:(0,c.BX)("label",{children:[(0,c.tZ)(p,{active:!1,tooltip:lng("attach file (document or image)"),icon:"attachment"}),(0,c.tZ)("input",{type:"file",style:{display:"none"},onChange:t=>(t=>{if(!t)return;const i=URL.createObjectURL(t);t.type.startsWith("image")?e.dispatchCommand(H,{altText:t.name,src:i,inlineFile:t}):e.dispatchCommand(W,{name:t.name,src:i,inlineFile:t})})(t.currentTarget.files[0])})]})})};var ye=i(8957),we=i(2292),xe=i(6146),ke=i(9082),Ze=i(4506),Ce=i(7943),Se=i.n(Ce),Oe=i(9421),Be=i(2358);const Te=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/,Ne=/(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,Ie=[e=>{const t=Te.exec(e);if(null===t)return null;const i=t[0];return{index:t.index,length:i.length,text:i,url:i.startsWith("http")?i:`https://${i}`}},e=>{const t=Ne.exec(e);return t&&{index:t.index,length:t[0].length,text:t[0],url:`mailto:${t[0]}`}}],De=()=>(0,c.tZ)(Be.AutoLinkPlugin,{matchers:Ie});class je extends v.TextNode{static getType(){return"hashtask"}static clone(e){return new je(e.__text,e.__key)}constructor(e,t){super(e,t)}createDOM(e){var t;const i=super.createDOM(e);return void 0!==(null==e||null===(t=e.theme)||void 0===t?void 0:t.hashtask)&&(0,w.addClassNamesToElement)(i,e.theme.hashtask),i}exportDOM(){const e=document.createElement("span");return e.textContent=this.__text,{element:e}}exportJSON(){return{...super.exportJSON(),type:"hashtask"}}static importJSON(e){const t=Pe(e.text);return t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}canInsertTextBefore(){return!1}isTextEntity(){return!0}}function Pe(e){return(0,v.$applyNodeReplacement)(new je(e))}var ze=i(5158);const Ee=/\bT#\d+\b/;function Re(){const[e]=(0,x.useLexicalComposerContext)();(0,n.useEffect)((()=>{if(!e.hasNodes([je]))throw new Error("HashtaskPlugin: HashtaskNode not registered on editor")}),[e]);const t=(0,n.useCallback)((e=>Pe(e.getTextContent())),[]),i=(0,n.useCallback)((e=>{const t=Ee.exec(e);return null===t?null:{start:t.index,end:t.index+t[0].length}}),[]);return(0,ze.useLexicalTextEntity)(i,je,t),null}var Fe=i(8207),Me=i(1058),Ae=i(5249);function qe(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Xe extends v.TextNode{static getType(){return"mention"}static clone(e){return new Xe(e.__text,e.__id,e.__key)}constructor(e,t,i){super(e,i),qe(this,"__id",void 0),this.__id=t}createDOM(e){var t;const i=super.createDOM(e);return i.classList.add("mention"),void 0!==(null==e||null===(t=e.theme)||void 0===t?void 0:t.mention)&&i.classList.add(...e.theme.mention),i}exportDOM(){const e=document.createElement("span");return e.classList.add("mention"),e.textContent=this.__text,{element:e}}static importDOM(){return{span:e=>e instanceof HTMLElement&&e.classList.contains("mention")?{conversion:e=>({node:Le({text:e.textContent})}),priority:4}:null}}exportJSON(){return{...super.exportJSON(),text:this.__text,id:this.__id,type:"mention",version:1}}static importJSON(e){const t=Le({text:e.text,id:e.id});return t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}exportCommand(){return this.__id?{type:"mention",id:this.__id}:null}isTextEntity(){return!0}}function Le(e){let{text:t,id:i,key:n}=e;const r=new Xe(t,i,n);return r.setMode("token").toggleDirectionless(),(0,v.$applyNodeReplacement)(r)}var $e=i(185),Ve=i(81),Ue=i(5836),He=i(7477);function Je(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ge extends $e.TypeaheadOption{constructor(e,t){super(e),Je(this,"name",void 0),Je(this,"id",void 0),this.name=e,this.id=t}}const We=e=>{let{mentions:t,addMentions:i}=e;const[r]=(0,x.useLexicalComposerContext)(),[s,o]=(0,n.useState)(null),a=("string"==typeof s?t.filter((e=>{let{label:t}=e;return t.toLowerCase().includes(s.toLowerCase())})):[]).map((e=>{let{val:t,label:i}=e;return new Ge(i,t)}));let l=(0,n.useRef)(!1).current;const[d,p]=(0,n.useState)((()=>r.getRootElement()===document.activeElement));(0,n.useLayoutEffect)((()=>(p(r.getRootElement()===document.activeElement),(0,w.mergeRegister)(r.registerCommand(v.FOCUS_COMMAND,(()=>{p(!0)}),v.COMMAND_PRIORITY_EDITOR),r.registerCommand(v.BLUR_COMMAND,(()=>{setTimeout((()=>{l||p(!1)}),200)}),v.COMMAND_PRIORITY_EDITOR)))),[r]),(0,n.useEffect)((()=>{(null==i?void 0:i.length)>0&&r.update((()=>{const e=[];i.forEach((t=>{e.push(Le({text:t.name,id:t.id}),(0,v.$createTextNode)(" "))})),e.length>0&&(0,v.$insertNodes)(e)}))}),[]);const u=(0,n.useCallback)((e=>{const t=/(^|\s)([@]([\d\p{L}]*))$/u.exec(e);if(null!==t){l=!1;const e=t[1],i=t[3];return{leadOffset:t.index+e.length,matchingString:i,replaceableString:t[2]}}return null}),[r]),m=(0,n.useCallback)(((e,t,i)=>{l=!0,r.update((()=>{const n=Le({text:e.name,id:e.id});t.replace(n);const r=(0,v.$createTextNode)(" ");n.insertAfter(r),r.select(),i()}))}),[r]);return(0,c.tZ)($e.LexicalTypeaheadMenuPlugin,{triggerFn:u,onQueryChange:o,onSelectOption:m,options:d?a:[],menuRenderFn:(e,t)=>e.current?(0,c.tZ)(Ye,{options:a,...t,labelRef:e.current}):null})},Ke=(0,r.iv)("background-color:",s.g.colors.bg_input,";color:",s.g.colors.text_sec,";border:1px solid #a9a9a9;position:fixed;z-index:",s.g.z.context_menu,";max-height:45vh;overflow-y:auto;border-radius:8px;padding:0;margin:0;list-style:none;",""),Ye=e=>{let{options:t,selectedIndex:i,selectOptionAndCleanUp:r,setHighlightedIndex:s,labelRef:o}=e;const a=(0,n.useRef)(null),[l,d]=(0,n.useState)(0);return(0,Ve.OR)("scroll",(0,Ue.x)((()=>d(l+1))),document),(0,n.useLayoutEffect)((()=>{const e=a.current;if(e&&a.current){const t=document.documentElement.clientHeight,i=document.documentElement.clientWidth,n=o.getBoundingClientRect();delete e.style.top,e.style.top=e.style.bottom=e.style.left=e.style.right="",n.bottom<=t/2?e.style.top=n.bottom+1+"px":e.style.bottom=t-n.top+1+"px",n.left<=i/2?e.style.left=n.x+"px":e.style.right=i-n.right+"px"}})),t.length?(0,c.tZ)("ul",{css:Ke,ref:a,children:t.map(((e,t)=>(0,c.tZ)(Qe,{index:t,isSelected:i===t,onClick:()=>(s(t),r(e)),onMouseEnter:()=>s(t),option:e},e.key)))}):null},Qe=e=>{let{index:t,isSelected:i,onClick:n,onMouseEnter:r,option:s}=e;const{name:o,setRefElement:a}=s;return(0,c.tZ)("li",{css:He.w,tabIndex:-1,className:i?"active":void 0,ref:a,role:"option","aria-selected":i,id:"typeahead-item-"+t,onMouseEnter:r,onClick:n,children:(0,c.tZ)("span",{className:"text",children:o})})},et=e=>t=>{const i=null==e?void 0:e(t);if(!i)return null;const n=i.conversion(t);if(!n)return n;const r=t.style.backgroundColor,s=t.style.color,o="bold"===t.style.fontWeight;return{...n,forChild:(e,t)=>{var i;const a=(null!==(i=null==n?void 0:n.forChild)&&void 0!==i?i:e=>e)(e,t);if((0,v.$isTextNode)(a)){o&&a.toggleFormat("bold");const e=[r?`background-color: ${r}`:null,s?`color: ${s}`:null].filter((e=>null!==e));if(e.length)return a.setStyle(e.join(";"))}return a}}},tt=e=>t=>{const i=null==e?void 0:e(t);if(!i)return null;const n=i.conversion(t);return n?(t.style.textAlign?n.node.setFormat(t.style.textAlign):t.dir&&n.node.setFormat("rtl"===t.dir?"right":"left"),n):n};const it=(e,t)=>{const i=document.createElement(t);return i.textContent=e.textContent,e.style.cssText&&(i.style.cssText=e.style.cssText),i},nt=(e,t)=>{const i=document.createElement(t);return i.appendChild(e),i};var rt=i(660),st=i(5697);function ot(e){let{onFocus:t,onBlur:i,focusOnShow:r,setActive:s}=e;const[a]=(0,x.useLexicalComposerContext)();return(0,n.useEffect)((()=>{r?setTimeout((()=>a.getRootElement().focus()),100):(0,o.Y3)((()=>{a.getRootElement()===document.activeElement&&document.activeElement.blur(),a.dispatchCommand(v.BLUR_COMMAND)}))}),[]),(0,n.useEffect)((()=>{if(t)return(0,w.mergeRegister)(a.registerCommand(v.FOCUS_COMMAND,t,v.COMMAND_PRIORITY_EDITOR))}),[a,t]),(0,n.useEffect)((()=>{if(i)return(0,w.mergeRegister)(a.registerCommand(v.BLUR_COMMAND,i,v.COMMAND_PRIORITY_EDITOR))}),[a,i]),(0,n.useEffect)((()=>(0,w.mergeRegister)(a.registerCommand(v.FOCUS_COMMAND,(()=>s(!0)),v.COMMAND_PRIORITY_EDITOR),a.registerCommand(v.BLUR_COMMAND,(()=>s(!1)),v.COMMAND_PRIORITY_EDITOR))),[a]),null}ot.propTypes={onBlur:st.func,onFocus:st.func,setActive:st.func,focusOnShow:st.bool};i(7882);const at=()=>{const[e]=(0,x.useLexicalComposerContext)(),[t,i]=(0,n.useState)(""),[r,s]=(0,n.useState)(null);return(0,n.useEffect)((()=>(0,w.mergeRegister)(e.registerCommand(v.BLUR_COMMAND,(()=>{setTimeout((()=>(i(""),s(null))),200)}),v.COMMAND_PRIORITY_EDITOR),e.registerCommand(v.SELECTION_CHANGE_COMMAND,(()=>{const t=(0,v.$getSelection)();if((0,v.$isRangeSelection)(t)){const n=he(t),r=n.getParent();(0,k.$isLinkNode)(r)?(i(r.getURL()),s(e.getElementByKey(r.getKey()))):(0,k.$isLinkNode)(n)?(i(n.getURL()),s(e.getElementByKey(r.getKey()))):(i(""),s(null))}return!1}),v.COMMAND_PRIORITY_CRITICAL))),[e]),t?(0,c.tZ)(ct,{url:t,linkRef:r}):null},lt=(0,r.iv)("font-size:1rem;background-color:",s.g.colors.bg_input,";color:",s.g.colors.text_sec,";border:1px solid #a9a9a9;position:fixed;z-index:",s.g.z.context_menu,";overflow-y:auto;border-radius:8px;padding:7px;display:inline-block;a{color:",s.g.colors.dominant_main,";font-weight:bold;}",""),ct=e=>{let{linkRef:t,url:i}=e;const r=(0,n.useRef)(null),[s,o]=(0,n.useState)(0);return(0,Ve.OR)("scroll",(0,Ue.x)((()=>o(s+1))),document),(0,n.useLayoutEffect)((()=>{const e=r.current;if(e&&r.current){const i=document.documentElement.clientHeight,n=document.documentElement.clientWidth,r=t.getBoundingClientRect();delete e.style.top,e.style.top=e.style.bottom=e.style.left=e.style.right="",r.bottom<=i/2?e.style.top=r.bottom+1+"px":e.style.bottom=i-r.top+1+"px",r.left<=n/2?e.style.left=r.x+"px":e.style.right=n-r.right+"px"}})),(0,c.tZ)("div",{css:lt,ref:r,children:(0,c.tZ)("a",{href:i,target:"_blank",rel:"noreferrer",children:i.truncate(50,"...")})})};function dt(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class pt extends v.DecoratorNode{static getType(){return"checkbox"}static clone(e){return new pt(e.__text,e.__key)}constructor(e,t){super(t),dt(this,"__checked",void 0),this.__checked=!!e}createDOM(e){var t;const i=document.createElement("span");return void 0!==(null==e||null===(t=e.theme)||void 0===t?void 0:t.checkbox)&&i.classList.add(...e.theme.checkbox),i}updateDOM(){return!1}exportDOM(){const e=document.createTextNode(this.__checked?"[*]":"[]");return e.append=()=>!1,{element:e}}exportJSON(){return{type:"checkbox",version:1,checked:this.__checked}}static importJSON(e){return ut(e.checked)}toggleChecked(){this.getWritable().__checked=!this.__checked}decorate(){return(0,c.tZ)(mt,{node:this})}}function ut(e){return(0,v.$applyNodeReplacement)(new pt(e))}const mt=e=>{let{node:t}=e;const[i]=(0,x.useLexicalComposerContext)();return(0,c.tZ)(a.JO,{icon:"checkbox"+(t.__checked?"_checked":""),onClick:()=>i.update((()=>t.toggleChecked()))})};function gt(){const[e]=(0,x.useLexicalComposerContext)();return(0,n.useEffect)((()=>{if(!e.hasNodes([pt]))throw new Error("CheckboxPlugin: CheckboxNode not registered on editor");const t=e=>{const t=e.getFirstChild();if(!t||!(0,v.$isTextNode)(t))return;const i=t.getTextContent();if(i.startsWith("[] ")){const[e]=t.splitText(2),i=ut();e.replace(i)}else if(i.startsWith("[*] ")){const[e]=t.splitText(3),i=ut(!0);e.replace(i)}};return(0,w.mergeRegister)(e.registerNodeTransform(v.ParagraphNode,(e=>t(e))),e.registerTextContentListener((()=>{e.update((()=>{const e=(0,v.$getSelection)();if((0,v.$isRangeSelection)(e)){const i=e.anchor.getNode(),n=(0,w.$getNearestNodeOfType)(i,v.ParagraphNode);n&&t(n)}}))})))}),[e]),null}!function(){const e=v.TextNode.importDOM();v.TextNode.importDOM=function(){return{...e,span:()=>({conversion:et(null==e?void 0:e.span),priority:0}),b:()=>({conversion:et(null==e?void 0:e.b),priority:0}),i:()=>({conversion:et(null==e?void 0:e.i),priority:0}),s:()=>({conversion:et(null==e?void 0:e.s),priority:0}),u:()=>({conversion:et(null==e?void 0:e.u),priority:0})}};const t=v.ParagraphNode.importDOM();v.ParagraphNode.importDOM=function(){return{...t,p:()=>({conversion:tt(null==t?void 0:t.p),priority:0}),div:()=>({conversion:tt(null==t?void 0:t.p),priority:0})}};const i=f.ListItemNode.importDOM();f.ListItemNode.importDOM=function(){return{...i,li:()=>({conversion:tt(null==i?void 0:i.li),priority:0})}};const n=k.LinkNode.importDOM();k.LinkNode.importDOM=function(){return{...n,a:()=>({conversion:function(e){let t=null;if(e instanceof HTMLAnchorElement){const i=e.textContent;(null!==i&&""!==i||null!==e.querySelector("img"))&&(t=(0,k.$createLinkNode)(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target")}))}return{node:t}},priority:0})}},v.ParagraphNode.prototype.exportDOM=function(){const e=document.createElement("p"),t=this.getDirection();t&&(e.dir=t);const i=this.getFormatType();return!i||"rtl"===t&&"right"===i||"ltr"===t&&"left"===i||(e.style.textAlign=i),{element:e}},v.TextNode.prototype.exportDOM=function(e){var t;let i=this.createDOM(e._config,e);switch(null===(t=i)||void 0===t?void 0:t.nodeName){case"STRONG":i=it(i,"b"),this.hasFormat("italic")&&(i=nt(i,"i")),this.hasFormat("strikethrough")&&(i=nt(i,"s")),this.hasFormat("underline")&&(i=nt(i,"u"));break;case"EM":i=it(i,"i"),this.hasFormat("strikethrough")&&(i=nt(i,"s")),this.hasFormat("underline")&&(i=nt(i,"u"));break;case"SPAN":this.hasFormat("strikethrough")&&this.hasFormat("underline")?(i=it(i,"s"),i=nt(i,"u")):this.hasFormat("strikethrough")?i=it(i,"s"):this.hasFormat("underline")?i=it(i,"u"):i.style.cssText||(i=document.createTextNode(i.textContent),i.append=()=>!1)}return{element:i}},f.ListItemNode.prototype.exportDOM=function(e){const t=this.createDOM(e._config,e);t.removeAttribute("value");const i=this.getDirection();if(i)t.dir=i;else{const e=this.getFormatType();e&&(t.style.textAlign=e)}return{element:t}},k.LinkNode.prototype.exportDOM=function(e){let t;return"autolink"===this.__type?(t=document.createTextNode(this.getTextContent()),t.append=()=>!1):(t=this.createDOM(e._config,e),t.removeAttribute("class")),{element:t}},v.TextNode.prototype.exportSlackMarkdown=function(){let e=this.getTextContent();return this.hasFormat("bold")&&(e=`*${e}*`),this.hasFormat("italic")&&(e=`_${e}_`),this.hasFormat("strikethrough")&&(e=`~${e}~`),{text:e}},k.LinkNode.prototype.exportSlackMarkdown=function(){let e=this.getTextContent();return{text:`<${this.__url}|${e}>`,finalNode:!0}},v.ParagraphNode.prototype.exportSlackMarkdown=function(){return{text:"\n"}}}();const ht={hashtask:"editor-hashtask",placeholder_simple:"editor-placeholder_simple",embedBlock:{base:"editor-embedBlock",focus:"editor-embedBlockFocus"},text:{bold:"editor-textBold",italic:"editor-textItalic",strikethrough:"editor-textStrikethrough",underline:"editor-textUnderline",underlineStrikethrough:"editor-textUnderlineStrikethrough"}},bt=e=>{let{minHeight:t,fixedHeight:i,disabled:n}=e;return(0,r.iv)('position:relative;width:100%;[data-lexical-editor="true"]{padding:11px 5px;overflow:auto;width:100%;max-height:70vh;outline:none;',t?`min-height: ${t};`:""," ",i?"height: 100px;":"",";}.editor-textBold{font-weight:700;}.editor-textItalic{font-style:italic;}.editor-textUnderline{text-decoration:underline;}.editor-textStrikethrough{text-decoration:line-through;}.editor-textUnderlineStrikethrough{text-decoration:line-through underline;}.editor-hashtask{color:",s.g.colors.link_blue,";font-weight:bold;}.editor-embedBlock{user-select:none;}.editor-embedBlockFocus{outline:2px solid rgb(60, 132, 244);}.editor-placeholder_simple{background-color:",s.g.colors.yellow,";font-weight:bold;}",n?(0,r.iv)("background-color:",s.g.colors.text_light_disabled,";opacity:0.5;",""):"",";","")},vt=(0,n.memo)((0,n.forwardRef)((function(e,t){let{value:i,loadState:r,label:a,disabled:l,toolbarOptions:d={font:!0,link:!0},mentions:p,addMentions:u,onChange:m,onFocus:g,onBlur:h,keySubmit:b,placeholder:v,focusOnShow:_,plainText:y,slackMarkdown:w,theme:x,minHeight:Z,autoHideToolbar:C,extraButtons:S,outsideActions:O,skipInitChange:B=!0}=e;const[T,N]=(0,n.useState)(!1),[I,D]=(0,n.useState)(!1);let P=(0,n.useRef)(0).current;const z=e=>{clearTimeout(P),P=setTimeout((()=>D(e)),100)},E=(0,n.useRef)();(0,n.useImperativeHandle)(t,(()=>({clear:()=>E.current.clear()})));const F={editable:!l,namespace:"BlossomLexical",editorState:r?JSON.stringify(r):void 0,theme:ht,slackMarkdown:w,nodes:[d.list&&f.ListNode,d.list&&f.ListItemNode,k.LinkNode,!w&&k.AutoLinkNode,je,!w&&pt,d.placeholders&&Me.jH,d.placeholders&&Ae.mn,d.attach&&V,(d.media||d.media_link)&&R,(d.media||d.media_link)&&X,(d.media||d.media_link)&&j,!!p&&Xe].filter((e=>e)),onError:e=>{throw e}},M=(0,c.tZ)(we.LexicalComposer,{initialConfig:F,children:(0,c.tZ)("div",{css:bt({minHeight:Z,fixedHeight:"fixed"===x,disabled:l}),className:(0,o.AK)({active:I}),children:(0,c.BX)(oe.Gz.Provider,{value:d.placeholders,children:[(0,c.tZ)("div",{css:s.g.classes.wysiwyg,children:(0,c.tZ)(xe.RichTextPlugin,{contentEditable:(0,c.tZ)(ke.ContentEditable,{}),placeholder:v&&(0,c.tZ)(ft,{children:v}),ErrorBoundary:Se()})}),(0,c.tZ)(rt.w,{initialHtml:r?void 0:i,onChange:l?void 0:m,plainText:y,slackMarkdown:w,keySubmit:b,skipInitChange:B,ref:E}),(0,c.tZ)(pe,{options:{...d,popout:!T&&d.popout},setPopout:N,slackMarkdown:w,autoHideToolbar:C,active:I,setActive:z,extraButtons:S,outsideActions:O,disabled:l}),(0,c.tZ)(Ze.HistoryPlugin,{}),d.list&&(0,c.tZ)(ye.ListPlugin,{}),(0,c.tZ)(Oe.LinkPlugin,{validateUrl:e=>"https://"===e}),(0,c.tZ)(at,{}),!w&&(0,c.tZ)(De,{}),(0,c.tZ)(Re,{}),!w&&(0,c.tZ)(gt,{}),(0,c.tZ)(K,{}),d.placeholders&&(0,c.tZ)(oe.XT,{simple:d.simplePlaceholder}),p&&(0,c.tZ)(We,{mentions:p,addMentions:u}),(0,c.tZ)(ot,{onFocus:g,onBlur:h,focusOnShow:_,setActive:z})]})})});return T?(0,c.tZ)(Fe.T,{title:a,width:"max(80vw,700px)",fullHeight:!0,onClose:()=>N(!1),children:M}):M}))),_t=(0,r.iv)("padding:11px 5px;color:",s.g.colors.text_placeholder,";position:absolute;top:0;user-select:none;display:inline-block;pointer-events:none;",""),ft=e=>{let{children:t}=e;return(0,c.tZ)("div",{css:_t,children:t})}},1058:(e,t,i)=>{i.d(t,{jH:()=>c,oj:()=>d});var n=i(7363),r=i(2998),s=i(6920),o=i(6746),a=i(5944);function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class c extends r.DecoratorNode{static getType(){return"placeholder"}static clone(e){return new c(e.__text,e.__key)}constructor(e,t){super(t),l(this,"__text",void 0),this.__text=e}createDOM(e){var t;const i=document.createElement("span");return void 0!==(null==e||null===(t=e.theme)||void 0===t?void 0:t.placeHolder)&&i.classList.add(...e.theme.placeHolder),i}updateDOM(){return!1}exportDOM(){const e=document.createElement("span");return e.setAttribute("data-blsm_placeholder",this.__text),e.textContent=this.__text,{element:e}}static importDOM(){return{span:e=>e instanceof HTMLElement&&e.hasAttribute("data-blsm_placeholder")?{conversion:e=>({node:d({text:e.textContent})}),priority:4}:null}}exportJSON(){return{text:this.__text,version:1,type:"placeholder"}}static importJSON(e){return d({text:e.textContent})}decorate(){return(0,a.tZ)(p,{text:this.__text})}}function d(e){let{text:t,key:i}=e;return(0,r.$applyNodeReplacement)(new c(t,i))}const p=e=>{var t;let{text:i}=e;const r=(0,n.useContext)(o.Gz),l=null===(t=i)||void 0===t?void 0:t.replaceAll("%","");return r&&l in r&&(i=r[l]),(0,a.tZ)("span",{style:{backgroundColor:s.g.colors.yellow,fontWeight:"bold"},children:i})}},5249:(e,t,i)=>{i.d(t,{bD:()=>o,mn:()=>s});var n=i(6969),r=i(2998);class s extends r.TextNode{static getType(){return"placeholder_simple"}static clone(e){return new s(e.__text,e.__key)}constructor(e,t){super(e,t)}createDOM(e){var t;const i=super.createDOM(e);return void 0!==(null==e||null===(t=e.theme)||void 0===t?void 0:t.placeholder_simple)&&(0,n.addClassNamesToElement)(i,e.theme.placeholder_simple),i}exportDOM(){const e=document.createElement("span");return e.textContent=this.__text,{element:e}}exportJSON(){return{...super.exportJSON(),type:"placeholder_simple"}}static importJSON(e){return o(e.text)}canInsertTextBefore(){return!1}isTextEntity(){return!0}}function o(e){return(0,r.$applyNodeReplacement)(new s(e))}},660:(e,t,i)=>{i.d(t,{g:()=>m,w:()=>p});var n=i(7363),r=i(2998),s=i(6969),o=i(1954),a=i(4260),l=i(7592),c=i(5944);function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p=(0,n.forwardRef)((function(e,t){let{initialHtml:i,onChange:d,plainText:p,slackMarkdown:g,keySubmit:h,skipInitChange:b}=e;const[v]=(0,a.useLexicalComposerContext)(),_=(0,n.useRef)(b&&i);return(0,n.useImperativeHandle)(t,(()=>({clear:()=>v.update((()=>(0,r.$getRoot)().clear()))}))),(0,n.useEffect)((()=>{i&&v.update((()=>{const e=new DOMParser;i=i.nl2br();const t=e.parseFromString(i,"text/html");t.querySelectorAll("body > br").forEach((e=>e.remove())),t.querySelectorAll(".draft-br").forEach((e=>e.remove())),t.querySelector("body").childNodes.forEach((e=>{if(!["P","DIV","OL","UL"].includes(e.nodeName)){const t=document.createElement("p");e.parentNode.insertBefore(t,e),t.appendChild(e)}}));const n=(0,l.$generateNodesFromDOM)(v,t);(0,r.$insertNodes)(n),(0,r.$getRoot)().select()}))}),[]),(0,n.useEffect)((()=>{const e=[];return p&&e.push(v.registerCommand(r.KEY_ENTER_COMMAND,(e=>(null==h||h(),e.preventDefault(),!0)),r.COMMAND_PRIORITY_HIGH),v.registerCommand(r.FORMAT_TEXT_COMMAND,(()=>!0),r.COMMAND_PRIORITY_HIGH)),h&&e.push(v.registerCommand(r.KEY_ENTER_COMMAND,(e=>e.ctrlKey&&(e.preventDefault(),h(),!0)),r.COMMAND_PRIORITY_HIGH)),(0,s.mergeRegister)(...e)}),[h]),d&&(0,c.tZ)(o.OnChangePlugin,{ignoreSelectionChange:!0,onChange:(e,t)=>{if(_.current)return _.current=!1;e.read((()=>{const i=(0,r.$getRoot)(),n=[];let s="";if(i.getTextContent()||u(e)){const e=t=>{var i,r;const s=null===(i=t.exportCommand)||void 0===i?void 0:i.call(t);s&&n.push(s),null===(r=t.getChildren)||void 0===r||r.call(t).forEach((t=>e(t)))};if(e(i),g){s="";const e=t=>{var i;let n;if(t.exportSlackMarkdown){const{text:e,finalNode:i}=t.exportSlackMarkdown();s+=e,n=i}n||null===(i=t.getChildren)||void 0===i||i.call(t).forEach((t=>e(t)))};e(i),s=s.trim()}else if(s=(0,l.$generateHtmlFromNodes)(t),p){let e=document.createRange().createContextualFragment(s);s=e.textContent}}d(s,new m({html:s,commands:n,state:e}))}))}})})),u=e=>[...e._nodeMap.values()].some((e=>e instanceof r.DecoratorNode));class m{constructor(){let{html:e,state:t,commands:i=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{html:"",state:void 0,commands:[]};d(this,"html",void 0),d(this,"state",void 0),d(this,"commands",void 0),this.html=e,this.state=e?null==t?void 0:t.toJSON():void 0,this.commands=i}isEmpty(){return!this.notEmpty()}notEmpty(){return""!==this.html}}},6746:(e,t,i)=>{i.d(t,{Gz:()=>g,Py:()=>p,XT:()=>m});var n=i(7363),r=i(5697),s=i(4260),o=i(6969),a=i(2998),l=i(1058),c=i(5249),d=i(5158);const p=(0,a.createCommand)("INSERT_PLACEHOLDER_COMMAND"),u=/%([a-z_]+)%/;function m(e){let{simple:t}=e;const[i]=(0,s.useLexicalComposerContext)();(0,n.useEffect)((()=>(0,o.mergeRegister)(i.registerCommand(p,(e=>{const i=t?(0,a.$createTextNode)(`%${e.text}%`):(0,l.oj)(e);return(0,a.$insertNodes)([i,(0,a.$createTextNode)(" ")]),(0,a.$isRootOrShadowRoot)(i.getParentOrThrow())&&(0,o.$wrapNodeInElement)(i,a.$createParagraphNode).selectEnd(),!0}),a.COMMAND_PRIORITY_EDITOR))),[i]);const r=(0,n.useCallback)((e=>(0,c.bD)(e.getTextContent())),[]),m=(0,n.useContext)(g),h=(0,n.useCallback)((e=>{if(!t)return null;const i=u.exec(e);return null!==i&&Object.keys(m).includes(i[1])?{start:i.index,end:i.index+i[0].length}:null}),[]);return(0,d.useLexicalTextEntity)(h,c.mn,r),null}m.propTypes={simple:r.bool};const g=(0,n.createContext)(null)},441:(e,t,i)=>{i.d(t,{A:()=>p,H8:()=>g,N0:()=>_,Qu:()=>h,f3:()=>b,p4:()=>u,wo:()=>v});var n=i(7363),r=i(7154),s=i(2698),o=i(8318),a=i(2808),l=i(6920),c=i(917),d=i(5944);const p=(0,n.forwardRef)((function(e,t){let{href:i,target:n,children:o,newTab:a,toolTip:p,theme:m,stopPropagation:g,processHrefClick:h,...b}=e,v=null!=i&&i.onClick?null:u(i);var _;void 0===n&&(a=null!==(_=a)&&void 0!==_?_:null==i?void 0:i.newTab,"auto"===a?null!=v&&v.match(/^(\w+:)?\/\//)&&!v.startsWith(Blsm.prm.server_name)&&(n="_blank"):!0===a&&(n="_blank"));let f;"highlight"===m&&(b.css=l.g.classes.link),"hover"===m&&(b.css=(0,c.iv)("cursor:pointer;text-decoration:none;&:hover{color:",l.g.colors.link_blue_hover,";text-decoration:underline;}","")),h&&null!=i&&i.onClick?f=e=>{g&&e.stopPropagation(),i.onClick(e)}:g&&(f=e=>e.stopPropagation());const y=(0,d.tZ)(s.a_,{onClick:f,href:v,target:n,rel:n?"noopener noreferrer":void 0,...b,ref:t,children:o});return p?(0,d.tZ)(r.u,{text:p,children:y}):y})),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return e&&!0!==e?t+("object"==typeof e?(0,o.Wh)(e):e):""};let r=e.ref;null==r?r=e.newTab?"@close":encodeURIComponent(location.href):"string"==typeof r&&r&&(r=encodeURIComponent(r));let s="";return"string"==typeof e?s=e:e.url?s=e.url:e.user?s=`#user/${!0===e.user?Blsm.user.id:e.user}${e.tab?"/"+e.tab:""}`:e.workspace?s=`#workspace/${e.workspace}/${e.tab||""}${e.assignment?"//"+e.assignment:""}`:e.file?s=`GetFile?${(0,o.HD)(e.file)?e.file:e.file.temp?`temp=${e.file.file_id}`:e.assignmentId?`type=assignment_file&aid=${e.assignmentId}&fn=${e.file.file_id.split("_")[1]}`:(0,o.$t)((0,o.ei)(e.file,["file_id","token","lesson_id","photo_id","history_lesson_id","temp","type","inline_image","checkin_file","sdk","jwt","temp_file","lang","dom","id","group_id","filename","file_name","name"]))}`:e.newrow?s="newrow/?gid="+e.newrow:e.edit?s="2"===e.version&&["Test","Survey","Courseware","Evaluation","Form","Checklist"].includes(e.type)?`editor${"vendev"in(0,o.Lv)()?"?vendev":""}#edit${n(e.id)}`:["Test","Survey","Courseware","Evaluation","Form","Questionnaire"].includes(e.type)?`qeditor${e.params?n(e.params,"#"):"#q"}${n(e.id)}`:"Checklist"===e.type?`checklist${n(e.id)}`:`#edit/${e.edit}/${e.id||(0,o.$t)(e.params)}${n(e.section)}`:e.list?s=`#list/${e.list}/${(0,o.$t)(e.params)}`:e.reports?s="#reports":e.report?s=`#reports/${e.report}/${(0,o.Wh)(e.params,!1,"",!0)}/${e.tab?e.tab:""}${n(e.bookmarkId)}`:e.reportBookmark?s=`#reports/bookmark/bm_id=${e.reportBookmark}`:e.api?s="api?/"+e.api.csrf():e.launcher?s=`Launcher?${e.launcher}=${e.id}${n(e.params,"&")}${n(r,"&ref=")}${n(e.cuser,"&cuser=")}${n("vendev"in(0,o.Lv)()&&1,"&vendev=")}${e.iframe?"&iframe":""}`:e.aicc?s=`aicc${n(e.aicc,"?")}${n(r,"&ref=")}${n("vendev"in(0,o.Lv)()&&1,"&vendev=")}`:e.playlist?(s=`#play${n(e.playlist,"/list=")}`,e.play&&(s+=`${n(e.play,"&id=")}`)):e.portal?s=`#portal${n(e.portal)}${n(e.sub_id)}${n(e.wid,"/wid=")}`:e.courseCatalog?(s=`#cregistration${n(e.tab)}${n(e.params||e.id)}`,Blsm.user.id&&(Blsm.isFeatureEnabled("digital_library")||Blsm.isFeatureEnabled("online_content"))&&(s="#library/"+s.substring(1))):e.messages||e.message?s=`#messages/${e.tab||"in"}${n(e.id||e.message)}${n(e.params)}`:e.catalog?s="#catalog/"+(e.term?"term="+e.term:""):e.library?s=`#library/${e.tab?e.tab:""}`:e.categoryTree?s="#category_tree":e.resourcePlanning?s=`#resourceplanning/${e.type}/${e.resourcePlanning}`:e.calendar?s=`#calendar${n(e.params)}`:e.import?s=`#import/${e.import}${n(e.params||"")}`:e.home?s=`#home${n(e.home)}${n(e.tab)}${n(e.params)}`:e.tasks?s=`#tasks${n(e.tasks)}${n(e.tab)}${n(e.params)}`:e.master?s=`#master/${e.master}${n(e.ws)}`:e.challenges?s=`#challenges/${(0,o.HD)(e.challenges)||(0,o.kE)(e.challenges)?e.challenges:""}`:e.logout&&(s=`?logout=1${n("vendev"in(0,o.Lv)()&&1,"&vendev=")}`),_()&&/^#[a-z]/i.test(s)&&!/^#portal/i.test(s)?null:(!e.server&&!e.absolute&&"#"===s[0]||"string"==typeof e||e.url||(s=(e.server?Blsm.prm.server_name:Blsm.prm.Mainref)+s),s=s.replace(/\/+$/g,""),t&&(i?window.open(s,"_blank"):location.href=s),s)},m="(https?|ftp|file)://[-A-Z0-9+&@#/%?=~_|!:,.;[\\]]*[-A-Z0-9+&@#/%=~_|[\\]]",g=(new RegExp(`(\\b${m}\\b)`,"ig"),new RegExp(`^${m}$`,"i")),h=new RegExp("^%\\w+%$","i"),b=new RegExp("^[.]{0,2}/"),v=e=>{let{children:t,url:i,file_name:n}=e;return(0,d.tZ)(p,{href:i,newTab:!0,"data-preview":(0,a.BX)(n||i),children:t})},_=()=>!!window.bportal},5192:(e,t,i)=>{i.d(t,{T:()=>l});var n=i(917),r=i(6920),s=i(8318),o=i(5944);const a=(0,n.iv)("background:url(",r.g.theme.logo_small,") no-repeat center;height:40px;background-size:contain;&.full{background-image:url(",r.g.theme.logo_full,");height:70px;}",""),l=e=>{let{full:t}=e;return(0,o.tZ)("div",{css:a,className:(0,s.AK)({full:t})})}},6220:(e,t,i)=>{i.d(t,{S:()=>h});var n=i(7363),r=i(917),s=i(8318),o=i(81),a=i(2334),l=i(6920),c=i(6975),d=i(3051),p=i(5944);const u="#ddd",m="#20AE61",g=(0,r.iv)("position:relative;display:inline-block;min-width:250px;>video{display:block;width:100%;height:100%;max-height:calc( 100vh - ",l.g.consts.TOP_BAR_HEIGHT+22+20,"px );object-fit:scale-down;}&.stretch>video{object-fit:contain;}>.controls{background-image:linear-gradient(0, rgba(0, 0, 0, .7), transparent);position:absolute;display:flex;gap:10px;bottom:0;left:0;right:0;padding:20px;user-select:none;color:white;>.ctrl-play{position:relative;min-width:1em;&>.Icon{opacity:0;position:absolute;left:0;pointer-events:none;transition:opacity 300ms ease-in;}&.play .Icon-pause,&.paused .Icon-play,&.ended .Icon-reload{opacity:1;pointer-events:all;}}>.ctrl-track{position:relative;flex-grow:1;&:not(:hover) .ctrl-tooltip{display:none;}.ctrl-tooltip{font-size:11px;position:absolute;bottom:",27,"px;background-color:#545454;color:#FAFAFA;border-radius:3px;padding:2px 5px;margin-left:-28px;&:before{content:'';width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid #545454;position:absolute;bottom:-7px;left:19px;}}.ctrl-bar{position:absolute;left:0;top:calc((",22,"px - ",3,"px) / 2 - 1px);width:100%;height:",3,"px;background-color:",u,";}.ctrl-thumb{display:inline-block;position:absolute;top:calc((",9,"px + ",3,"px) / 2);transition:left 100ms linear;border-radius:50%;background:",m,";pointer-events:none;width:",9,"px;height:",9,"px;}}>.ctrl-time{width:70px;font-size:14px;text-align:center;}>.ctrl-vol{position:relative;input[type=range][orient=vertical]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;}.ctrl-volume-input{position:absolute;bottom:18px;left:5px;width:13px;transition:opacity 200ms ease-in,height 200ms ease-in;height:0;opacity:0;&.visible{height:120px;opacity:1;}}}.ctrl-rate{.Icon-mark_x{font-size:.7em;}}}>.Icon-go_forward,>.Icon-go_backward{position:absolute;background-color:rgba(0, 0, 0, .3)!important;color:white;top:calc(50% - 16px);left:20px;&.Icon-go_forward{left:auto;right:20px;}}.controls,.Icon-go_forward,.Icon-go_backward{opacity:0;transition:opacity .4s ease-in-out;}&.show_controls{.controls,.Icon-go_forward,.Icon-go_backward{opacity:1;}}",""),h=function(e){var t;let{url:i,isAudio:r,startSecond:l=0,endSecond:h,stretch:b=!0,autoPlay:_,allowContentMenu:f,mediaRef:y}=e,w=/#t=([\d:.]+)(?:,([\d:.]+))?/,x=null===(t=i)||void 0===t?void 0:t.match(w);Array.isArray(x)&&(l=tpl.time2seconds(x[1])||0,h=tpl.time2seconds(x[2])||void 0,i=i.replace(w,""));const k=(0,n.useRef)(),Z=(0,n.useRef)(),[C,S]=(0,n.useState)("paused"),[O,B]=(0,n.useState)(!1),[T,N]=(0,n.useState)([]),[I,D]=(0,n.useState)(0),[j,P]=(0,n.useState)(""),[z,E]=(0,n.useState)(1),[R,F]=(0,n.useState)(!1),[M,A]=(0,n.useState)(1),[q,X]=(0,n.useState)(!1),[L,$]=(0,n.useState)(null),V=!r&&!!s.Rh,[U,H]=(0,n.useState)(!1),[J,G]=(0,n.useState)(b);(0,o.OR)("fullscreenchange",(()=>H(document.fullscreenElement===k.current)),document);const W=()=>Z.current.play(),K=()=>4===Z.current.readyState&&Z.current.pause(),Y=()=>{const e=Z.current,t=e.paused;setTimeout((()=>{t===e.paused&&(t?W():K())}),50)};let Q=(0,n.useRef)();const ee=e=>{clearTimeout(Q.current),e?X(!0):Q.current=setTimeout((()=>X(!1)),500)},te=e=>e.nativeEvent.offsetX/e.currentTarget.clientWidth*ne(),ie=e=>{const t="number"==typeof e?e:l+te(e),i=Z.current;let n=!i.paused;Math.abs(i.currentTime-t)>.1&&(4===i.readyState&&i.pause(),i.currentTime=t,n&&i.play())},ne=()=>(h||Z.current.duration)-l,re=()=>{const e=Z.current;e.currentTime<l&&(e.currentTime=l),_&&4===e.readyState&&e.paused&&e.play(),E(e.volume),se()},se=()=>{const e=Z.current;let t=["to right"],i=ne();for(let n=0;n<e.buffered.length;n++){let r=Math.max(0,e.buffered.start(n)-l),s=e.buffered.end(n)-l;if(s>0){h&&(s=Math.min(h,s));let e=" "+100*r/i+"%",n=" "+100*s/i+"%";t.push(u+e,m+e,m+n,u+n)}}N(t)},oe=e=>{const t=Z.current;ie(Math.max(l,Math.min(h||t.duration,t.currentTime+e)))},ae=(0,n.useCallback)((0,s.Ds)((()=>B(!1)),3e3),[]),le=r?"audio":"video";return(0,p.BX)("div",{ref:k,css:g,tabIndex:0,onKeyUp:e=>{"Space"===e.code&&Y();const t="ArrowRight"===e.key?5:"ArrowLeft"===e.key?-5:0;0!==t&&oe(t)},onMouseMove:r?void 0:()=>{B(!0),ae()},className:(0,s.AK)("MediaPlayer",{fullscreen:U,stretch:J,muted:"0"===z,"is-audio":r,show_controls:O||r||"play"!==C}),children:[(0,p.tZ)(le,{ref:e=>(Z.current=e,y&&(y.current=e)),src:i,onClick:Y,onPlay:()=>{const e=Z.current;e.currentTime<l&&(e.currentTime=l),h&&e.currentTime>h?K():S("play")},onPause:()=>S(h&&Z.current.currentTime>=h?"ended":"paused"),onEnded:()=>S("ended"),onCanPlay:re,onCanPlayThrough:re,onTimeUpdate:()=>{const e=Z.current;let t=Math.max(0,e.currentTime-l);h&&e.currentTime>=h&&"play"===C&&K();let i=Math.min(1,Math.max(0,t/ne()));D(i),P((0,a.xt)(t))},onProgress:se,onLoadedData:se,onLoadedMetadata:se,muted:R,onContextMenu:f?void 0:e=>e.preventDefault()}),r&&(0,p.tZ)(v,{on:"play"===C,onClick:Y}),(0,p.BX)("div",{className:(0,s.AK)("controls"),children:[(0,p.BX)("div",{className:(0,s.AK)("ctrl-play",C),children:[(0,p.tZ)(c.JO,{icon:"play",onClick:W}),(0,p.tZ)(c.JO,{icon:"pause",onClick:K}),(0,p.tZ)(c.JO,{icon:"reload",onClick:()=>{Z.current.currentTime=l,W()}})]}),(0,p.tZ)("div",{className:"ctrl-time",children:j}),(0,p.BX)("div",{className:"ctrl-vol",onMouseEnter:()=>ee(!0),onMouseLeave:()=>ee(!1),onClick:()=>F(!R),children:[(0,p.tZ)(c.JO,{icon:R?"volume_mute":"volume"}),(0,p.tZ)("input",{className:(0,s.AK)("ctrl-volume-input",{visible:q}),type:"range",min:"0",max:"1",step:"0.01",orient:"vertical",onClick:e=>e.stopPropagation(),value:R?0:z,onChange:e=>(e=>{const t=Z.current;t&&(t.volume=e),E(e),F("0"===e)})(e.target.value)})]}),(0,p.tZ)("div",{className:"ctrl-rate",children:(0,p.BX)(d.x,{onSelect:e=>{const t=Z.current;t&&(t.playbackRate=e),A(e)},options:[{separator:!0,label:lng("playback rate").caps()},...[.25,.5,.75,1,1.25,1.5,1.75,2].map((e=>({val:e,label:e,active:e===M})))],children:[M,(0,p.tZ)(c.JO,{icon:"mark_x"})]})}),(0,p.BX)("div",{className:"ctrl-track",onMouseUp:e=>ie(e),onMouseMove:e=>(e=>{const t=te(e),i=e.nativeEvent.offsetX;$(t>=0&&i?{pos:i+2,label:(0,a.xt)(t)}:null)})(e),children:[(0,p.tZ)("div",{className:"ctrl-bar",style:{backgroundImage:"linear-gradient("+T.join(",")+")"}}),(0,p.tZ)("div",{className:"ctrl-thumb",style:{left:`calc(${100*I}% - ${4.5*I}px )`}}),L&&(0,p.tZ)("div",{className:"ctrl-tooltip",style:{left:L.pos},children:L.label})]}),!U&&(0,p.tZ)(p.HY,{children:(0,p.tZ)("div",{children:J?(0,p.tZ)(c.JO,{icon:"unstretch",onClick:()=>G(!1)}):(0,p.tZ)(c.JO,{icon:"stretch",onClick:()=>G(!0)})})}),V&&(0,p.tZ)(p.HY,{children:(0,p.tZ)("div",{children:U?(0,p.tZ)(c.JO,{icon:"exit_full_screen",onClick:()=>document.exitFullscreen()}):(0,p.tZ)(c.JO,{icon:"full_screen",onClick:()=>{var e;return null===(e=k.current)||void 0===e?void 0:e[s.Rh]()}})})})]}),(0,p.tZ)(c.JO,{icon:"go_forward",buttonLike:!0,onClick:()=>oe(5)}),(0,p.tZ)(c.JO,{icon:"go_backward",buttonLike:!0,onClick:()=>oe(-5)})]})},b=e=>(0,r.iv)("height:150px;width:100%;display:flex;justify-content:space-between;flex-flow:wrap-reverse;>i{animation-name:equalizer-i;animation-duration:2.2s;animation-iteration-count:infinite;animation-timing-function:ease-in-out;display:inline-block;flex-grow:1;height:9%;transition:height 100ms;&:nth-child(7n+1){animation-delay:-1s;}&:nth-child(7n+2){animation-delay:-0.5s;}&:nth-child(7n+3){animation-delay:-1.5s;}&:nth-child(7n+4){animation-delay:-0.25ms;}&:nth-child(7n+5){animation-delay:-1.25s;}&:nth-child(7n+6){animation-delay:-0.75s;}&:nth-child(7n+7){animation-delay:-1.5s;}}",!e&&"& > i {\n\t\tanimation-name: equalizer-off;\n\t\tanimation-delay: 0ms !important;\n\t\tanimation-duration: 300ms;\n\t\tanimation-iteration-count: 1;\n\t}",";@keyframes equalizer-off{0%{height:50%;}100%{height:8%;}}@keyframes equalizer-i{100%,0%{height:20%;}20%{height:50%;}40%{height:30%;}60%{height:100%;}80%{height:60%;}}",""),v=e=>{let{on:t,onClick:i}=e;return(0,p.tZ)("div",{css:b(t),className:"Equalizer",style:{columnGap:2},onClick:i,children:[...Array(10).keys()].map((e=>(0,p.tZ)("i",{style:{backgroundColor:l.g.colors.blossom}},e)))})}},8534:(e,t,i)=>{i.d(t,{EP:()=>Z,LB:()=>k,Mj:()=>O,nb:()=>S,qV:()=>C,qX:()=>_});var n=i(745),r=i(917),s=i(6975),o=i(6920),a=(i(7882),i(7821)),l=i(5560),c=i(6344),d=i(9180),p=i(8318),u=i(441),m=i(5405),g=i(8567),h=i(4524),b=i(5944);const v=e=>{let{type:t,color:i,onClick:n}=e;return(0,r.iv)("background-color:",o.g.colors.bg_main,";border-radius:6px;border:1px solid ",i,";box-shadow:0 2px 26px ",(0,c.mR)(i,.3),";padding:12px;margin:15px;display:flex;width:fit-content;>div{display:flex;max-width:min(","error"===t?"850px":"350px",", 100vw - 30px);}.main_icon{color:",i,";font-size:32px;",o.g.classes.margin_far("12px"),";}.Icon-mark_x_light{font-size:20px;cursor:pointer;}.content{flex-grow:1;}.title{font-weight:600;font-size:1.1em;flex-grow:1;color:",o.g.colors.text_main,";}.msg{margin-top:4px;overflow:auto;color:",o.g.colors.text_main,";max-width:","error"===t?"none":"270px",";max-height:300px;",n&&"cursor: pointer",";}.remark{font-size:.8em;color:",o.g.colors.text_sec,";padding-top:7px;display:flex;justify-content:flex-end;>*:not(:first-child){margin-inline-start:5px;}}",o.g.mQuery.mobile,"{margin:10px;}","")},_=e=>{var t;let{title:i,msg:n,type:r,icon:a,color:l,onClick:c,href:g,onClose:h,time:_,remark:f,htmlMsg:y,altIconComponent:w,closeOnClick:x}=e;switch(r){case"error":l=l||o.g.colors.negative,a=a||"sign_notification";break;case"warning":l=l||o.g.colors.yellow,a=a||"menu_info";break;case"notice":l=l||o.g.colors.grey;break;default:l=l||o.g.colors.positive,a=a||"sign_ok"}const k=g?u.A:"div";return(0,b.tZ)(m.SV,{children:(0,b.tZ)(k,{css:v({type:r,color:l,onClick:c||g}),href:g,onClick:()=>{null==c||c(),"error"!==r&&x&&h()},className:"blsm-notice",children:(0,b.BX)("div",{children:[w?(0,b.tZ)("div",{className:"main_icon",children:w}):a&&(0,b.tZ)(s.JO,{icon:a,className:"main_icon"}),(0,b.BX)("div",{className:"content",children:[i&&(0,b.tZ)("div",{className:"title",children:(0,p.rj)(i.caps())}),y?(0,b.tZ)("div",{className:"msg",dangerouslySetInnerHTML:y?{__html:n}:void 0}):(0,b.tZ)("div",{className:"msg",children:(0,p.rj)(null==n||null===(t=n.caps)||void 0===t?void 0:t.call(n))}),(_||f)&&(0,b.BX)("div",{className:"remark",children:[_&&(0,b.tZ)(d.qp,{time:_}),f&&(0,b.tZ)("span",{children:f})]})]}),h&&(0,b.tZ)("div",{children:(0,b.tZ)(s.JO,{icon:"mark_x_light",buttonLike:!0,onClick:e=>{e.stopPropagation(),e.preventDefault(),h()}})})]})})})},f=(0,r.iv)("position:fixed;bottom:0;",o.g.far,":0;z-index:",o.g.z.notice,";display:flex;flex-direction:column;align-items:flex-end;word-break:break-word;@keyframes in_animation{from{transform:translateX(",o.g.isRTL?"-":"","500px);}to{transform:translateX(0);}}>div{animation:in_animation .5s;}",""),y=(0,a.observable)([]),w=(0,l.observer)((()=>y.length?(0,b.tZ)("div",{css:f,children:y.map((e=>(0,b.tZ)(_,{...e,onClose:()=>{var t;return y.remove(e),null===(t=e.onClose)||void 0===t?void 0:t.call(e)}},e.__uid)))}):null));(0,p.Um)((()=>{(0,n.s)((0,p.wq)("NoticeQueue")).render((0,b.tZ)(w,{}))}));let x=0;const k=e=>{y.length>=3&&y.pop(),e.__uid=x++,y.unshift(e)},Z=e=>y.remove(y.find((t=>t.id===e))),C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lng("success"),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return k({msg:e,title:t,type:"success",...i})},S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lng("warning"),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return k({msg:e,title:t,type:"warning",...i})},O=function(e){var t,i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lng("error"),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return k(Object.assign(r,{msg:e,title:n,type:"error",time:(0,p.c7)(),remark:(null===(t=Blsm.prm.revision)||void 0===t?void 0:t.branch)&&`${Blsm.prm.revision.branch} ${null===(i=Blsm.prm.revision.hash)||void 0===i?void 0:i.substring(0,7)}`}))};Blsm.Message=Blsm.Alert=e=>C(e,lng("pay attention").caps()),Blsm.Success=e=>(0,g.qR)((0,b.tZ)(h.M,{}),{title:e,width:(0,p.tq)()?"calc(100% - 2vw)":void 0}),Blsm.Warning=e=>S(e),Blsm.Error=(e,t,i)=>O(e,t||lng("error"),i||{}),Blsm.Confirm=(e,t,i)=>(0,g.BB)(e,{...i,onConfirm:()=>setTimeout((()=>t()),1)}),window.onerror=function(e,t,i,n){var r;if(console&&console.warn({errorMsg:e,url:t,lineNumber:i,colNumber:n}),!e)return;const s=(0,p.en)(t||"");if(window.location.hostname!==s.hostname)return;if(["collaboration.js","collaboration_vendors.js","tinymce.min.js","vendors.js","jquery-ui","vendors.js","lib-jitsi-meet","external_api"].some((e=>t.includes(e))))return;["Failed to parse URL parameter value: undefined","ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications","Uncaught SyntaxError: Unexpected token <"].indexOf(e)>-1||k({title:lng("an error occurred in browser")+" :(",msg:e,type:"error",time:(0,p.c7)(),remark:`${i||n?`(${i}:${n})`:""} ${Blsm.prm.revision?`${Blsm.prm.revision.branch} ${null===(r=Blsm.prm.revision.hash)||void 0===r?void 0:r.substring(0,7)}`:""}`})}},5247:(e,t,i)=>{i.d(t,{h:()=>a});var n=i(539),r=i(6291),s=i(5944);const o={name:"1xajjm9",styles:"padding-top:150px"},a=function(){return(0,s.tZ)(r.T,{children:(0,s.tZ)("div",{css:o,children:(0,s.tZ)(n.$,{})})})}},6291:(e,t,i)=>{i.d(t,{T:()=>d,a:()=>u});var n=i(917),r=i(6920),s=i(7033),o=i(8318),a=i(7363),l=i(5944);const c=(0,n.iv)(r.g.classes.page_position,";",r.g.mQuery.notMobile,"{&.internalScrolling{display:flex;flex-direction:column;height:calc(100vh - ",r.g.consts.TOP_BAR_HEIGHT,"px);}}&.sidePadding{padding-left:20px;padding-right:20px;}&.bottomPadding{padding-bottom:20px;}",""),d=e=>{let{children:t,className:i,contBG:n,sidePadding:d,bottomPadding:p,internalScrolling:u}=e;return(0,a.useEffect)((()=>{if(n)return document.documentElement.style.backgroundColor=r.g.colors.bg_page_containers,()=>document.documentElement.style.backgroundColor=""}),[n]),(0,l.tZ)(s.U,{children:(0,l.tZ)("div",{css:c,className:(0,o.AK)(i,"react_container",{sidePadding:d,bottomPadding:p,internalScrolling:u}),children:t})})},p=(0,n.iv)("padding-top:90px;",r.g.classes.content_width,";margin:-65px auto ",r.g.consts.CONT_MARGIN,"px;color:",r.g.colors.text_sec,";display:flex;>*:nth-of-type(2){flex-grow:1;}",""),u=e=>{let{children:t}=e;return(0,l.tZ)("div",{css:p,className:"TopWidgets",children:t})}},4268:(e,t,i)=>{i.d(t,{Q:()=>p,Z:()=>m});var n=i(7363),r=i(917),s=i(6920),o=i(6975),a=i(7828),l=i(7965),c=i(5944);const d={name:"1yjx7km",styles:"padding:20px"},p=e=>{let{children:t,className:i}=e;return(0,c.tZ)("div",{css:d,className:i,children:t})},u=(0,r.iv)("display:flex;flex-grow:1;overflow:hidden;",s.g.mQuery.mobile,"{flex-direction:column;overflow:auto;}>.SideCol{position:relative;height:100%;.SideCont,.SideCont>div{height:100%;}>.Icon{background:",s.g.colors.bg_page_containers,";padding:6px;box-shadow:",s.g.isRTL?"-":"","2px 4px 3px rgba(",s.g.darkMode?"255, 255, 255, .2":"0, 0, 0, .1",");",s.g.classes.border_near(0),";border-radius:",s.g.isRTL?"0 10px 0 10px":"0 10px 10px 0",";cursor:pointer;position:absolute;top:50%;",s.g.near,":100%;z-index:",s.g.z.side_toggler,";}}>.MainCol{padding:10px;flex-grow:1;background-color:",s.g.colors.bg_page_containers,";",s.g.mQuery.notMobile,"{overflow:auto;}}",""),m=function(e){let{children:t,side:i,className:r,mainRef:s}=e;const[d,p]=(0,n.useState)(!0);return(0,c.BX)("div",{css:u,className:r,children:[(0,c.BX)("div",{className:"SideCol",children:[(0,c.tZ)(a.M,{initial:!1,children:d&&(0,c.tZ)(l.E.div,{className:"SideCont",style:{overflow:"hidden"},initial:{width:0},animate:{width:"auto"},exit:{width:0},children:i})}),(0,c.tZ)(o.JO,{icon:d?"arrow_near":"arrow_far",onClick:()=>p(!d)})]}),t&&(0,c.tZ)("div",{className:"MainCol",ref:s,children:t})]})}},2883:(e,t,i)=>{i.d(t,{EL:()=>p,Fz:()=>h,Of:()=>v,v7:()=>m});var n=i(5560),r=i(917),s=i(6920),o=i(8318),a=(i(7882),i(6344)),l=i(1092),c=i(5944);const d=(0,r.iv)("height:350px;background-image:radial-gradient(circle at 50% -135%, ",s.g.theme.color_1===s.g.colors.purple?"#ce94fc":(0,a.HO)(s.g.theme.color_1,.4)," 30%, ",(0,a.HO)(s.g.theme.color_1,-.3)," 80%);position:relative;>._head_content{",s.g.classes.content_width,";position:relative;display:flex;flex-direction:column;justify-content:center;}>._waves{position:absolute;left:0;bottom:0;width:100%;height:250px;}",""),p=(0,n.observer)((function(e){let{children:t,className:i}=e;return(0,c.tZ)("div",{css:d,className:i,children:(0,c.tZ)("div",{className:"_head_content",children:t})})})),u=e=>{let{banner:t,noGradient:i}=e;return(0,r.iv)("color:",s.g.colors.text_main,";border-bottom:1px solid ",s.g.colors.separator,";background-color:",s.g.colors.bg_main,";",t||i?"":`background-image: linear-gradient(${s.g.isRTL?"-":""}231deg, ${(0,a.mR)(s.g.theme.color_1,1)}, transparent);`," ",s.g.mQuery.ie,"{max-height:120px;}>._top{padding:20px;display:flex;align-items:center;._head_content{display:flex;justify-content:space-between;flex-grow:1;align-items:center;.actions_banner{position:absolute;",s.g.classes.margin_far("20px"),";",s.g.classes.far("10px"),";top:120px;z-index:2;display:flex;flex-direction:row;width:50px;justify-content:space-evenly;align-items:center;._btn{background-color:rgba(255, 255, 255, 0.5)!important;border-radius:50%;.buttonLike{background:transparent!important;}}}.actions{display:flex;flex-direction:row;align-items:center;&:not(:empty){padding:8px;background-color:rgba(255, 255, 255, 0.5);border-radius:13px;}}&._banner{height:270px;background-image:url(",s.g.func.imgUrl(t),");background-position:center;background-repeat:no-repeat;background-size:cover;border-radius:10px;}>.headline{>._title{font-size:1.8rem;font-weight:600;",s.g.classes.margin_near(t?"20px":0),";padding:5px 10px;color:",t?"#ffffff":s.g.colors.text_main,";z-index:",t?3:0,";position:",t?"absolute":"",";",t&&"background-color: rgba(0, 0, 0, .3) !important; border-radius: 10px;",";}>._desc{color:",s.g.colors.text_sec,";margin-top:.5rem;",t&&"background-color: rgba(0, 0, 0, .3) !important; border-radius: 10px;",";}._count{display:inline-block;background-color:",s.g.colors.dominant_main,";color:white;padding:0 0.4em;border-radius:10px;font-weight:600;font-size:.9em;}._limit{font-size:.7em;}}}}",s.g.mQuery.notMobile,"{&.sticky{position:sticky;top:",s.g.consts.TOP_BAR_HEIGHT,"px;z-index:1;}}",s.g.mQuery.mobile,"{>._top{padding:8px 8px 0;>.headline{>._title{font-size:1.3rem;}}}}&.simple{border-bottom-width:0;>._top{padding-bottom:0;text-align:center;>.headline>._title{font-size:1.4rem;}}}>._bottom{display:flex;justify-content:space-between;._view_button{",s.g.classes.margin_far("20px"),";cursor:pointer;}}","")},m=e=>{let{headline:t,desc:i,actions:n,tabs:r,sticky:a,count:d,simple:p,after_tabs:m,banner:g=!1,noGradient:h=!1,maxItems:b=null}=e;return(0,c.BX)("div",{css:u({banner:g,noGradient:h}),className:(0,o.AK)("BasicHeader",{sticky:a,simple:p}),children:[(0,c.tZ)("div",{className:"_top",children:(0,c.BX)("div",{className:"_head_content "+(g?"_banner":""),children:[(0,c.BX)("div",{className:"headline",children:[(0,c.BX)("div",{className:"_title",children:["string"==typeof t?t.caps():t," ",d>0&&(0,c.tZ)("span",{className:"_count",children:d})," ",b>0&&(0,c.BX)("span",{className:"_limit",children:["(",lng("limit"),": ",b,")"]})]}),(0,c.tZ)("div",{className:"_desc",children:"string"==typeof i?i.caps():i})]}),(0,c.tZ)("div",{className:g?"actions_banner":"actions",children:n})]})}),(0,c.BX)("div",{className:"_bottom",children:[(0,c.tZ)("div",{css:s.g.classes.flex_grow,children:r&&(0,c.tZ)(l.m,{...r,morePadding:!0})}),m]})]})},g=(0,r.iv)("height:76px;background-color:",s.g.theme.color_1,";",""),h=e=>{let{children:t}=e;return(0,c.tZ)("div",{css:g,children:t})},b=(s.g.consts.TOP_BAR_HEIGHT,s.g.theme.color_1===s.g.colors.purple||(0,a.HO)(s.g.theme.color_1,.4),(0,a.HO)(s.g.theme.color_1,-.3),e=>(0,r.iv)("display:flex;border-bottom:1px solid ",s.g.colors.separator,";margin-bottom:20px;justify-content:space-between;",e&&"padding: 20px;"," .content{display:flex;flex-direction:column;justify-content:space-between;.headlines{padding-top:40px;.headline{color:",s.g.colors.text_main,";font-size:1.7rem;font-weight:600;}.tagline{margin-top:10px;color:",s.g.colors.text_sec,";}}}>img{width:550px;",s.g.classes.margin_far("100px"),";}","")),v=e=>{let{headline:t,tagline:i,image:n,content:r,padding:s,contentStyle:o}=e;return(0,c.BX)("div",{css:b(s),children:[(0,c.BX)("div",{className:"content",css:o,children:[(t||i)&&(0,c.BX)("div",{className:"headlines",children:[t&&(0,c.tZ)("div",{className:"headline",children:null==t?void 0:t.caps()}),i&&(0,c.tZ)("div",{className:"tagline",children:i})]}),(0,c.tZ)("div",{children:r})]}),n&&(0,c.tZ)("img",{src:n,alt:""})]})}},5758:(e,t,i)=>{i.d(t,{h:()=>l});var n=i(917),r=i(6920),s=(i(7882),i(8318)),o=i(5944);const a=e=>{let{width:t}=e;return(0,n.iv)("flex-shrink:0;padding:18px 10px 10px;",r.g.classes.border_far("1px solid "+r.g.colors.separator),";overflow-y:auto;background-color:",r.g.colors.bg_cont,";",r.g.mQuery.notMobile,"{width:",t,";}","")},l=function(e){let{children:t,className:i,width:n="350px"}=e;return(0,o.tZ)("div",{css:a({width:n}),className:(0,s.AK)("SidePanel",i),children:t})}},5151:(e,t,i)=>{i.d(t,{t:()=>c});var n=i(6975),r=i(8318),s=(i(7882),i(7392)),o=i(6920),a=i(5944);const l={name:"1rmz7lu",styles:"display:flex;justify-content:center;margin:1em 0;&.spread{width:100%;justify-content:space-between;}>div{min-width:auto;margin:0 1px;}&.compact{margin:0;>div{padding:0 2px;}}"},c=e=>{let{totalItems:t,pageSize:i,curPage:c,maySeeAll:d,onChange:p,compact:u,spread:m}=e;const g=Math.ceil(t/i);if(!t||!i||g<2||isNaN(g))return null;const h=parseInt(c)+1,b=e=>()=>(e=>e!==c&&p&&p(e))(Math.min(g,Math.max(e,d?0:1))-1),v=[];let _;for(v.push((0,a.tZ)(s.l,{disabled:h<2,onClick:b(h-1),children:u?(0,a.tZ)(n.JO,{icon:o.g.isRTL?"arrow_right":"arrow_left"}):lng("previous").caps()},"prev")),_=1;_<=(h<3?5:2)&&_<=g;_++)v.push((0,a.tZ)(s.l,{theme:_===h?"contained":void 0,onClick:b(_),children:_},_));const f=h>=g-1?g-4:h-1;for(f>_+1&&(_=f,v.push((0,a.tZ)(s.l,{children:"…"},"hellip1")));_<=h+1&&_<=g;_++)v.push((0,a.tZ)(s.l,{theme:_===h?"contained":void 0,onClick:b(_),children:_},_));for(g-2>_&&(_=g-1,v.push((0,a.tZ)(s.l,{children:"…"},"hellip2")));_<=g;_++)v.push((0,a.tZ)(s.l,{theme:_===h?"contained":void 0,onClick:b(_),children:_},_));return v.push((0,a.tZ)(s.l,{disabled:h>=g||0===h,onClick:b(h+1),children:u?(0,a.tZ)(n.JO,{icon:o.g.isRTL?"arrow_left":"arrow_right"}):lng("next").caps()},"next")),d&&v.push((0,a.tZ)(s.l,{theme:0===h?"contained":void 0,onClick:b(0),children:lng("show all").caps()},"all")),(0,a.tZ)("div",{css:l,className:(0,r.AK)({compact:u,spread:m}),children:v})}},1786:(e,t,i)=>{i.d(t,{k:()=>s,x:()=>o});var n=i(3755),r=i(5944);const s=function(e){let{password:t="",username:i,oldPassword:s,requirements:a={},className:l}=e;const c=o(t,{username:i,oldPassword:s,requirements:a});return(0,r.BX)("div",{className:l,children:[c.message.caps()," ",(0,r.tZ)(n.k,{numerator:Math.max(0,c.rate),denominator:4,topLabels:!1,valueInBar:!1,showPercent:!1,colorByVal:!0})]})},o=(e,t)=>{let{username:i,oldPassword:n,requirements:r}=t;const{minlength:s=0,change_threshold:o=-1,complex:a}=r;if(!e)return{rate:-1,message:""};if(e.length<s)return{rate:0,message:lng("too short")};if(i&&e.toLowerCase().match(i.toLowerCase()))return{rate:0,message:lng("too similar to user name")};if(void 0!==n){if(!n)return{rate:0,message:lng("please enter your current password.")};if(function(e,t){let i,n,r=e.length,s=t.length,o=[];if(!r)return s;if(!s)return r;for(i=0;i<=r;i++)o[i]=[i];for(n=0;n<=s;n++)o[0][n]=n;for(n=1;n<=s;n++)for(i=1;i<=r;i++)e[i-1]==t[n-1]?o[i][n]=o[i-1][n-1]:o[i][n]=Math.min(o[i-1][n],o[i][n-1],o[i-1][n-1])+1;return o[r][s]}(e,n)<=o)return{rate:0,message:lng("similar to current password")}}const l=(e=>{let t=0;return t+=e.length,e.length>0&&e.length<=4?t+=e.length:e.length>=5&&e.length<=7?t+=6:e.length>=8&&e.length<=15?t+=12:e.length>=16&&(t+=18),e.match(/[a-z]/)&&(t+=1),e.match(/[A-Z]/)&&(t+=5),e.match(/\d/)&&(t+=5),e.match(/.*\d.*\d.*\d/)&&(t+=5),e.match(/[!,@,#,$,%,^,&,*,?,_,~]/)&&(t+=5),e.match(/.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~]/)&&(t+=5),e.match(/(?=.*[a-z])(?=.*[A-Z])/)&&(t+=2),e.match(/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])/)&&(t+=2),e.match(/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!,@,#,$,%,^,&,*,?,_,~])/)&&(t+=2),t})(e);return l>40?{rate:4,message:lng("strong")}:a?{rate:0,message:lng("stronger password is required, use capital letters signs and numbers.")}:l>30?{rate:3,message:lng("good")}:l>20?{rate:2,message:lng("weak")}:{rate:1,message:lng("very weak")}}},2205:(e,t,i)=>{i.d(t,{d:()=>a});var n=i(917),r=i(6920),s=i(5898),o=i(5944);const a=e=>{let{poster:t,title:i,status:a,isApproved:l,entity:c}=e;const d=l?r.g.colors.positive:r.g.colors.warning;return(0,o.BX)("div",{css:(p=d,(0,n.iv)("min-width:300px;max-width:300px;._poster-outline{border-radius:20px;height:164px;width:164px;margin:-102px auto 0;box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);overflow:hidden;._poster{height:164px;width:164px;background-color:",r.g.colors.bg_1,";background-size:cover;background-position:center;}}._title{margin-top:3px;text-align:center;",r.g.classes.widget_title,";}._status{text-align:center;>span{border-radius:4px;background-color:",p,";color:",r.g.colors.dominant_white,";padding:0 5px;}}.leisure-buttons{position:absolute;top:20px;",r.g.classes.near("260px"),";display:flex;font-size:1.6rem;}","")),children:[t&&(0,o.tZ)("div",{className:"_poster-outline",children:(0,o.tZ)("div",{className:"_poster",style:{backgroundImage:'url("'+t+'")'}})}),(0,o.tZ)("div",{className:"_title",children:i}),a&&(0,o.tZ)("div",{className:"_status",children:(0,o.tZ)("span",{children:a.caps()})}),c&&(0,o.BX)("div",{className:"leisure-buttons",children:[c.mayBookmark&&(0,o.tZ)(s.rp,{entity:c,onClick:()=>c.toggleBookmark()}),c.mayLike&&(0,o.tZ)(s.dR,{entity:c,onClick:()=>c.toggleLike(),badge:c.likesCount}),c.mayRecommend&&(0,o.tZ)(s.Cj,{entity:c,onClick:()=>c.Recommend()})]})]});var p}},3755:(e,t,i)=>{i.d(t,{k:()=>c});var n=i(917),r=i(6920),s=i(8318),o=(i(7882),i(7363)),a=i(5944);const l=e=>{let{width:t,color:i,textColor:s,rounded:o,padded:a}=e;return(0,n.iv)("min-width:",t,";color:",s||r.g.colors.text_sec,";>._top-progress{display:flex;>*:first-of-type{flex-grow:1;}}&.bigLabel{>._top-progress>*:first-of-type{font-size:2.5em;font-weight:lighter;}}>._top-progress>*:first-of-type{>span{color:",i||r.g.colors.green,";}}>._bar{margin-top:",a?".3em":"0",";background-color:#DEDEDE;position:relative;height:4px;border-radius:2px;>div:first-of-type{height:4px;border-radius:2px;background-color:",i||r.g.colors.green,";transition:width 1.5s;}>._p{position:absolute;top:0;width:100%;text-align:center;color:white;}}&.valueInBar{>._bar{background-color:#b5b5b5;}>._bar,>._bar>div:first-of-type{height:18px;border-radius:",!!o&&"9px",";}}._note{font-size:0.8em;margin:0 10px;}","")},c=e=>{let{numerator:t,denominator:i,padded:n=!0,valueInBar:r,note:c,bigLabel:p,className:u,topLabels:m=!0,colorByVal:g,color:h,textColor:b,label:v,showPercent:_=!0,showDenominator:f=!0,valueNote:y,width:w="150px",rounded:x=!0}=e;(0,s.HD)(t)&&(t=Number(t)),(0,s.HD)(i)&&(i=Number(i));const k=Math.min((0,s.NM)(t/i*100,2),100)||0,[Z,C]=(0,o.useState)(0);(0,o.useEffect)((()=>{k!==Z&&C(k)}),[k]);const S=""===k?"":"%";return(0,a.BX)("div",{css:l({width:w,color:h,textColor:b,rounded:x,padded:n}),className:(0,s.AK)(u,{valueInBar:r,bigLabel:p}),children:[m&&(0,a.BX)("div",{className:"_top-progress",children:[(0,a.BX)("div",{children:[v," ",(0,a.tZ)("span",{children:t||0}),f&&` / ${i}`," ",y]}),!r&&_&&(0,a.BX)("div",{className:"_p",children:[k,S]})]}),(0,a.BX)("div",{className:"_bar",children:[(0,a.tZ)("div",{style:{width:Z+"%",backgroundColor:g?d(k):h}}),r&&(0,a.tZ)("div",{className:"_p",children:_?k+S:t})]}),c&&(0,a.tZ)("div",{className:"_note",children:c})]})};function d(e){return"hsl("+(e/100*151+5)+", 65%, 54%)"}},3178:(e,t,i)=>{i.d(t,{s:()=>a});var n=i(4059),r=i(7154),s=i(5944);const o={name:"146c8ii",styles:"._btn{line-height:0;display:block;}"},a=function(e){let{value:t,size:i=80,className:a}=e;return(0,s.tZ)(r.u,{text:t,css:o,className:a,children:(0,s.tZ)(n.tv,{style:{width:i,height:i},value:t})})}},1619:(e,t,i)=>{i.d(t,{dB:()=>b,mN:()=>h,xn:()=>m});var n=i(745),r=i(7363),s=i(917),o=(i(7882),i(6920)),a=i(1125),l=i(8567),c=i(6975),d=i(6220),p=i(8318),u=i(5944);const m=(0,r.memo)((function(e){let{content:t,nl2br:i=!0,linkify:s=!0,className:a,fixTrailingSpaces:l=!0}=e;const c=(0,r.useRef)();return t&&(i&&(t=t.nl2br()),s&&(t=t.linkify(!0))),(0,r.useLayoutEffect)((()=>{g(c.current,s,l);const e=[];return[...c.current.getElementsByTagName("video")].forEach((t=>{var i;const r=(0,p.Ux)("div",{className:"video_cont"});t.insertAdjacentElement("afterend",r),t.parentNode.removeChild(t);const s=(0,n.s)(r);e.push(s),s.render((0,u.tZ)(d.S,{url:t.src||(null===(i=t.querySelector("[src]"))||void 0===i?void 0:i.src)}))})),[...c.current.getElementsByTagName("iframe")].forEach((e=>{const t=(0,p.Ux)("div",{className:"video_cont"});e.insertAdjacentElement("afterend",t),t.appendChild(e)})),()=>e.forEach((e=>e.unmount()))})),(0,u.tZ)("div",{dir:"auto",className:a,ref:c,css:o.g.classes.wysiwyg,dangerouslySetInnerHTML:{__html:h(t)}})})),g=(e,t,i)=>{if("#text"===e.nodeName){if(i&&(e.textContent=e.textContent.replace(/\s\s/g,"  ")),t){const t=e.textContent.taskify().emojify();if(t!==e.textContent){const i=document.createElement("span");i.innerHTML=t,e.parentNode.replaceChild(i,e)}}}else"A"!==e.nodeName&&e.childNodes.forEach((e=>g(e,t,i)))},h=e=>{const t=e=>`<span class="${e?(0,a.wj)("checkbox_checked"):(0,a.wj)("checkbox")}" style="display:inline-block;margin: 0 3px;"></span>`;return(e||"").replace(/(^|\n|>)(\s*)\[\*]\s/g,`$1$2${t(!0)} `).replace(/(^|\n|>)(\s*)\[]\s/g,`$1$2${t(!1)} `)},b=e=>{let{content:t,className:i,maxWidth:n="100%",maxHeight:r="200px",title:a,...d}=e;const p=(0,s.iv)("position:relative;._rich{max-width:",n,";max-height:",r,";overflow:auto;border-color:",o.g.colors.separator_light,";border-radius:",o.g.consts.FIELD_BORDER_RADIUS,"px;border-style:solid;border-width:1px;padding:5px;}._expand{font-size:1.2em;background:",o.g.colors.half_white,";color:",o.g.colors.text_black,";position:absolute;",o.g.far,":0;bottom:0;opacity:.1;}&:hover ._expand{opacity:1;}","");return(0,u.BX)("div",{css:p,children:[(0,u.tZ)(c.JO,{className:"_expand",icon:"fullscreen",onClick:()=>{(0,l.qR)((0,u.tZ)(m,{content:t,className:i,...d}),{title:a,width:"calc(100% - 2vw)"})},toolTip:lng("full screen").caps()}),(0,u.tZ)("div",{className:"_rich",children:(0,u.tZ)(m,{content:t,className:i,...d})})]})}},5702:(e,t,i)=>{i.d(t,{_:()=>L});var n,r,s,o=i(917),a=i(7363),l=i(8e3),c=i(6920),d=i(3346),p=i(6975),u=i(539),m=i(7392),g=i(8318),h=(i(6421),i(5007)),b=i(7821),v=i(4210),_=i(676),f=(i(7882),i(5560)),y=i(9637),w=i(5944);function x(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function k(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Z=(n=class extends v.I{constructor(e){super(e),x(this,"checkInfo",r,this),x(this,"checkInfoGroup",s,this),this.checkInfoGroup.max_users=parseInt(e.max_users),(0,b.makeObservable)(this),this.title=lng("check rules"),this.confirmButtonLabel="",this._fields=[{type:"single_item",name:"user_id",label:lng("select user to check rules"),poster:!0,theme:"bright",searchData:(e,t)=>{let{ids:i,term:n}=e;(0,l.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:n,id:i||""}},t)},onSelect:t=>{this.checkInfo.loading=!0,(0,l.SC)("rules/check_rules_user",{method:"POST",data:{user_id:t.id,group_id:e.object_id,...e}},(e=>{this.checkInfo.user=e.user,this.checkInfo.is_member=e.is_member,this.checkInfo.conditions=e.conditions,this.checkInfo.relations=e.relations,this.checkInfo.loading=!1}))},onValueChange:e=>{""===e&&(this.checkInfo={loading:void 0,user:void 0,is_member:void 0,conditions:void 0,relations:void 0})}},{type:"component",node:(0,w.tZ)(f.Observer,{children:()=>this.checkInfo.loading?(0,w.tZ)(u.$,{}):(0,w.tZ)(S,{...this.checkInfo})}),visible:()=>void 0!==this.checkInfo.loading},{type:"component",node:(0,w.tZ)(f.Observer,{children:()=>this.checkInfoGroup.loading?(0,w.tZ)(u.$,{}):(0,w.tZ)(S,{...this.checkInfoGroup})}),visible:()=>void 0!==this.checkInfoGroup.loading}],this._prepFields(),"check_auto_enrollment"===e.req_type&&void 0===this.checkInfoGroup.loading&&(this.checkInfoGroup.loading=!0,(0,l.SC)("rules/preview_rules_for_group",{method:"POST",data:{group_id:e.object_id,rules:e.rules,only_add:e.only_add?1:0}},(t=>{this.checkInfoGroup.group=t.group,this.checkInfoGroup.added=t.added,this.checkInfoGroup.removed=e.only_add?void 0:t.removed,this.checkInfoGroup.members=t.members,this.checkInfoGroup.loading=!1}))),this.ready=!0}get dirty(){return!1}},r=k(n.prototype,"checkInfo",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{loading:void 0,user:void 0,is_member:void 0,conditions:void 0,relations:void 0}}}),s=k(n.prototype,"checkInfoGroup",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{loading:void 0,group:void 0,added:void 0,removed:void 0,members:void 0,max_users:void 0}}}),n);const C=(0,o.iv)(".member{color:",c.g.colors.positive,";}.not_member{color:",c.g.colors.negative,";}._label{color:",c.g.colors.text_main,";font-weight:600;}",""),S=(0,f.observer)((function(e){let{is_member:t,conditions:i,relations:n,user:r,group:s,added:o,removed:a,members:l,max_users:c}=e;return(0,w.BX)("div",{css:C,children:[void 0!==t&&(0,w.BX)("div",{className:"_label "+(t?"member":"not_member"),children:[" ",t?lng("this user is a member of the workspace").caps():lng("this user is not a member of the workspace").caps()]}),(null==r?void 0:r.deleted)&&(0,w.tZ)("div",{className:"_label",children:lng("deleted user").caps()}),(null==s?void 0:s.deleted)&&(0,w.tZ)("div",{className:"_label",children:lng("deleted workspace").caps()}),n&&(0,w.BX)("div",{className:"_label",children:[lng("relation between rules").caps(),": ",n]}),(0,g.zG)(i)&&i.length>0&&(0,w.tZ)(O,{collection:i}),void 0!==o&&(0,w.tZ)("div",{className:"_label",children:o?lng("%s members will be added to the workspace",o).caps():lng("no new members will be added to the workspace").caps()}),void 0!==a&&(0,w.tZ)("div",{className:"_label",children:a?lng("%s members will be removed from the workspace",a).caps():lng("no member will be removed from the workspace").caps()}),void 0!==l&&(0,w.BX)("div",{className:"_label",children:[lng("current members"),": ",l]}),c>0&&(0,w.BX)("div",{className:"_label",children:[lng("members limit"),": ",c]})]})})),O=(0,f.observer)((function(e){let{collection:t}=e;const i=[{title:"#"},{title:lng("rule").caps()},{title:lng("sql condition").caps()},{title:lng("result").caps()}];return(0,w.tZ)("div",{children:(0,w.tZ)(_.iA,{cols:i,collection:t,RowRenderer:B,rowIdCol:"key",compact:!0})})})),B=(0,f.observer)((function(e){let{row:t}=e;const{key:i,rule:n,sql_condition:r,result:s}=t;return(0,w.BX)("tr",{children:[(0,w.tZ)("td",{children:i}),(0,w.tZ)(y.U6,{children:n}),(0,w.tZ)("td",{children:r}),(0,w.tZ)("td",{children:(0,w.tZ)(p.JO,{icon:s?"mark_v":"mark_x",color:s?c.g.colors.positive:c.g.colors.negative})})]})}));var T=i(2334),N=i(5459),I=i(8567);class D extends v.I{constructor(e){super(e),this.title=lng("import rules").caps(),this.confirmButtonLabel=lng("import"),this._fields=[{type:"single_item",name:"target_group",label:lng("select workspace"),searchData:(e,t)=>(0,l.SC)("groups/autocomplete",{method:"POST",json:!0,data:{is_owner:1,types:["Group","Course_template","Qualification","Role","Workplan"],term:e.term||"",with_rules:1,id:e.id}},t),onSelect:e=>{null!=e&&e.autoenrollment_rules&&this.updateValue(JSON.parse(e.autoenrollment_rules),"rules_autoenrollment"),null!=e&&e.reg_availability_conditions&&this.updateValue(JSON.parse(e.reg_availability_conditions),"reg_availability_conditions"),this.values.set("current_tab","auto_enrollment")}},{type:"component",name:"sub_tabs",visible:()=>this.values.get("target_group"),Render:j,props:{tabs:[{title:lng("automatic enrollment rules").caps(),name:"auto_enrollment",visible:()=>this.values.get("rules_autoenrollment")},{title:lng("entrance conditions").caps(),name:"reg_availability",visible:()=>this.values.get("reg_availability_conditions")}],onChange:e=>this.values.set("current_tab",e),current:"auto_enrollment"}},{visible:()=>"auto_enrollment"===this.values.get("current_tab")&&this.values.get("target_group"),type:"component",name:"rules_autoenrollment",Render:L,props:{object_type:"users",disabled:!0}},{visible:()=>"reg_availability"===this.values.get("current_tab")&&this.values.get("target_group"),type:"component",name:"reg_availability_conditions",Render:L,props:{object_type:"users",disabled:!0}}],this._prepFields(),this.ready=!0}save(){let e;e="auto_enrollment"===this.values.get("current_tab")?this.values.get("rules_autoenrollment"):this.values.get("reg_availability_conditions"),this.onSaveSuccess(e)}SaveSuccess(){}}const j=(0,f.observer)((function(e){let{tabs:t,onChange:i,current:n}=e;const[r,s]=(0,a.useState)(n);return(0,w.tZ)("div",{css:z,children:t.filter((e=>e.visible())).map(((e,t)=>{let{icon:n,title:o,name:a}=e;return(0,w.BX)("div",{onClick:()=>(i(a),s(a)),css:P(r===a),children:[n&&(0,w.tZ)(p.JO,{icon:n})," ",(0,w.tZ)("span",{children:o})]},t)}))})})),P=e=>(0,o.iv)("color:",e?c.g.colors.dominant_main:c.g.colors.text_sec,";border-bottom:",e?"1px solid "+c.g.colors.dominant_main:"none",";padding:10px;>span{",c.g.classes.margin_near("10px"),";font-size:1rem;font-weight:600;}",""),z={name:"dhweq7",styles:"display:flex;justify-content:space-around;&:hover{cursor:pointer;}"};var E=i(5311),R=i(1533);const F=/[()!&|∅A-Z]/,M=(0,o.iv)("padding-bottom:20px;position:relative;.add-rule-button{margin-top:15px;",c.g.classes.margin_far("10px"),";}",""),A=["ws_completion_date"],q=e=>!(A.includes(e.field)&&!e.entity_id)&&(e.field&&(e.type||e.val)),X=e=>{const t=[];for(const i of e)q(i)&&t.push(i);return t},L=e=>{var t;let{title:i,onChange:n,value:r,object_type:s,checkRules:o,checkRulesData:c,helpKey:d,for_managers:p,collisionCheck:b,disabled:v}=e;const _=(null==r||null===(t=r.rules)||void 0===t?void 0:t.map((e=>(e.key||(e.key=(0,g.zO)(6)),e))))||[],[f,y]=(0,a.useState)(_),[x,k]=(0,a.useState)({forSelect:[],map:new Map}),[Z,C]=(0,a.useState)((null==r?void 0:r.relation)||"or"),[S,O]=(0,a.useState)((null==r?void 0:r.manual_relation)||null),[B,T]=(0,a.useState)("");(0,a.useEffect)((()=>{let e={rules:X(f)};Z&&(e.relation=Z),"manual"===Z&&(e.manual_relation=S),0===e.rules.length&&(e=void 0),JSON.stringify(r)!==JSON.stringify(e)&&n(e)}),[f,Z,S]),(0,a.useEffect)((()=>{(0,l.fN)("rules/rule_fields",{data:{type:s,for_managers:p}},(e=>{var t;const i=[],n=new Map;let r={};for(const[t,o]of Object.entries(e)){var s;if("string"==typeof o)null!==(s=r.options)&&void 0!==s&&s.length&&i.push(r),r={optgroup:!0,label:o,options:[]};else n.set(t,o),r.options.push({val:t,label:o.friendly_name,type:o.type,options:o.options,entity:o.entity})}null!==(t=r.options)&&void 0!==t&&t.length&&i.push(r),k({forSelect:i,map:n})}))}),[]);const j=e=>{O(P(e,X(f).length))},P=(e,t)=>{if(!e)return T(null),e;let i=e.replaceAll(" ","").split("");i=i.map((e=>e.toUpperCase())).filter((e=>F.test(e)));const n=new Set,r=new Set;let s,o,a;i.forEach((e=>{const i=/[A-Z]/.test(e);if(i){e.charCodeAt(0)-65>=t&&n.add(e)}"∅"===e&&(a=!0),o&&(/[A-Z]/.test(o)&&i&&r.add(e),/[A-Z]/.test(o)&&/[(!]/.test(e)?r.add(e):(/[&|]/.test(o)&&/[&|]/.test(e)||")"===o&&!/[&|)]/.test(e)||"!"===o&&!/[A-Z(]/.test(e))&&(s=!0)),o=e}));const l=[];return a&&l.push(lng("handle delete rule").caps()),s&&l.push(lng("invalid input").caps()),n.size>0&&l.push(`${lng("no matching rules for the labels").caps()}: ${[...n].join(", ")}`),r.size>0&&l.push(`${lng("every two rules must have an operator between them").caps()}: ${[...r].join(", ")}`),T(l),i.join("")},z=e=>{y((t=>{const i=[...t];return i.splice(e,1),P(S,X(i).length),S&&(e=>{const t=X(f).length;let i=String.fromCharCode(65+e),n=S.replaceAll(i,"∅");for(let r=e+1;r<t;r++){const e=i;i=String.fromCharCode(65+r),n=n.replaceAll(i,e)}j(n)})(e),i}))};if(!x.forSelect.length)return(0,w.tZ)(u.$,{});let E=0;return(0,w.BX)("div",{css:M,children:[d&&(0,w.tZ)(N.I,{helpKey:d}),i&&i.caps()+":",(0,w.tZ)("div",{children:f.map(((e,t)=>(0,w.tZ)(V,{index:q(e)?E++:null,rule:e,collisionCheck:b,disabled:v,object_id:null==c?void 0:c.object_id,fields:x.forSelect,fieldMap:x.map,onChange:e=>((e,t)=>{y((i=>{let n={...e};i[t].field!==e.field&&(n.type=n.val=n.val_b=void 0);const r=[...i];return r.splice(t,1,n),r}))})(e,t),onRemove:()=>((e,t)=>{t.field?(0,I.BB)((0,w.BX)("div",{children:[lng("are you sure you want to delete the rule?").caps(),S&&(0,w.tZ)("div",{children:lng("you will need to handle the change in the manual relation.").caps()})]}),{onConfirm:()=>z(e)}):z(e)})(t,e)},e.key)))}),!v&&f.length<26&&(0,w.tZ)(m.l,{className:"add-rule-button",theme:"contained",onClick:()=>y((e=>{const t=[...e,{key:(0,g.zO)(6)}];return P(S,X(t).length),t})),children:lng("add rule").caps()}),!v&&o&&0===f.length&&(0,w.tZ)(m.l,{className:"add-rule-button",theme:"contained",onClick:()=>(0,h.vm)().openDialog("form",new D({onSaveSuccess:e=>{e&&(y((e=>null==e?void 0:e.map((e=>(e.key||(e.key=(0,g.zO)(6)),e))))(null==e?void 0:e.rules)),C((null==e?void 0:e.relation)||"or"),O((null==e?void 0:e.manual_relation)||null),n(e),(0,h.vm)().closeDialog())}})),children:lng("import rules").caps()}),!v&&o&&f.length>0&&(0,w.tZ)(ne,{rules:r,disabled:f.some((e=>!q(e))),...c}),!v&&(0,w.tZ)(W,{operators:Z,manual:S,onChange:e=>C(e),onManualChange:j,count:f.length,notice:B})]})},$={name:"1su80o",styles:"display:flex;align-items:center;.rule-row-mid{display:flex;flex-grow:9;>*:first-child{width:fit-content;flex-grow:1;}>*:not(:first-child){flex-grow:9;}}.rule-row-label{flex-grow:1;}.rule-row-remove{margin-top:1em;}.rule-values-bundle{display:flex;}"},V=e=>{var t;let{index:i,rule:n,fields:r,fieldMap:s,onRemove:l,onChange:u,object_id:m,collisionCheck:g,disabled:h}=e;const[b,v]=(0,a.useState)(),_=(0,a.useRef)(),[f,y]=(0,a.useState)(!1);let{field:x,type:k,val:Z,val_b:C,entity_id:S}=n;const O=x&&(null===(t=s.get(x))||void 0===t?void 0:t.type);(0,a.useEffect)((()=>{y(!0)}),[]);return(0,w.BX)(E.c_,{column:!0,children:[(0,w.BX)("div",{css:$,className:"rule-row",children:[(0,w.tZ)(ee,{index:i}),(0,w.tZ)("div",{className:"rule-row-label select",children:(0,w.tZ)(d.gN,{input:{type:"select",options:r,label:lng("field"),emptyOption:!0},disabled:h,value:x,onChange:e=>!h&&u({...n,field:e})})}),n.field&&O&&(0,w.BX)("div",{className:"rule-row-mid",children:[(0,w.tZ)(H,{disabled:h,fieldType:O,relation:k,onChange:e=>{var t,i;return["s_oo","n_oo"].includes(n.type)&&(n.val=null===(t=n.val)||void 0===t?void 0:t.join(",")),["s_oo","n_oo"].includes(e)&&(n.val=null===(i=n.val)||void 0===i?void 0:i.split(",")),u({...n,type:e})}}),f&&(0,w.tZ)(J,{disabled:h,fieldType:O,relation:k,value:Z,val_b:C,entity_id:S,field:s.get(x),fieldKey:x,object_id:m,setRowWarning:v,onChange:(e,t,i,r)=>u({...n,val:e,val_b:i,entity_id:r}),collisionCheck:g,rowUnder:_})]}),!h&&(0,w.BX)("div",{className:"rule-row-remove",children:[b&&(0,w.tZ)(p.JO,{css:(0,o.iv)({color:c.g.colors.negative},"",""),icon:"sign_notification",buttonLike:!0,toolTip:b}),(0,w.tZ)(p.JO,{icon:"trash",onClick:l,buttonLike:!0,toolTip:lng("delete row")})]})]}),(0,w.tZ)("div",{ref:_,css:c.g.classes.margin_near("37px")})]})},U=e=>{let{onChange:t,disabled:i,value:n,types:r=[]}=e;const s={type:"single_item",label:lng("select workspace"),theme:"bright",searchData:(e,t)=>{(0,l.SC)("groups/autocomplete",{method:"POST",json:!0,data:{term:e.term||"",id:e.ids||[],types:r,show_all:1}},t)},required:!0};return(0,w.tZ)(d.gN,{disabled:i,input:s,onChange:t,value:n})},H=e=>{let{fieldType:t,relation:i,onChange:n,disabled:r}=e;const s=(e=>{switch(e){case"number":return[{val:"n_oo",label:lng("one of").caps()},{val:"n_gt",label:lng("greater than").caps()},{val:"n_lt",label:lng("less than").caps()},{val:"n_iet",label:lng("is equal to").caps()},{val:"n_inet",label:lng("not equal to").caps()},{val:"n_ib",label:lng("is between").caps()},{val:"n_inb",label:lng("not between").caps()}];case"string":return[{val:"s_oo",label:lng("one of").caps()},{val:"s_c",label:lng("contains").caps()},{val:"s_nc",label:lng("not contains").caps()},{val:"s_tiex",label:lng("is exactly").caps()},{val:"s_tin",label:lng("is not").caps()},{val:"s_tie",label:lng("is empty").caps()},{val:"s_tine",label:lng("not empty").caps()}];case"date":return[{val:"d_i",label:lng("date is").caps()},{val:"d_ib",label:lng("is before").caps()},{val:"d_ia",label:lng("is after").caps()},{val:"d_lb",label:lng("date was at least (before)").caps()},{val:"d_mb",label:lng("date was at most (before)").caps()},{val:"d_la",label:lng("date is at least (after)").caps()},{val:"d_ma",label:lng("date is at most (after)").caps()}];case"list":return[{val:"1",label:lng("one of").caps()},{val:"0",label:lng("not one of").caps()}];case"ou":return[{val:"ou_u",label:lng("one of these units").caps()},{val:"ou_uns",label:lng("one of these units including subs").caps()},{val:"ou_s",label:lng("only sub units from one of these").caps()}];case"workspace":return[{val:"ws_u",label:lng("one of these workspace").caps()},{val:"ws_uns",label:lng("one of these workspaces including subs").caps()},{val:"ws_s",label:lng("only sub workspaces from one of these").caps()},{val:"ws_pm",label:lng("primary manager of one of these").caps()}];case"workspace_status":return Blsm.isFeatureEnabled("qualifications")?[{val:"ws_c",label:lng("completed").caps()},{val:"ws_nc",label:lng("not completed").caps()},{val:"ws_np",label:lng("failed").caps()},{val:"ws_nvc",label:lng("never completed").caps()},{val:"ws_ex",label:lng("expired").caps()},{val:"ws_rn",label:lng("renewing").caps()}]:[{val:"ws_c",label:lng("completed").caps()},{val:"ws_nc",label:lng("not completed").caps()},{val:"ws_np",label:lng("failed").caps()}];case"flag":case"not_null":case"simple":case"role":return null;default:console.error("not implemented","RuleRelation",{fieldType:e})}})(t);return null===s?null:(0,w.tZ)(d.gN,{disabled:r,input:{type:"select",options:s,label:lng("relation"),emptyOption:!i},value:i,onChange:n})},J=e=>{var t;let{fieldType:i,relation:n,value:r,val_b:s,entity_id:o,field:c,fieldKey:p,onChange:u,object_id:m,setRowWarning:h,collisionCheck:b,disabled:v,rowUnder:_}=e,f=(e,t)=>{r=e,u(r,t,s,o)},y=(e,t)=>{s=e,u(r,t,s,o)},x=(e,t)=>{o=e,u(r,t,s,o)};(0,a.useEffect)((()=>{b&&"workspace_status"===i&&r&&re(r,m,h)}),[r]);const k=e=>{var t,i;return null===(t=e||[])||void 0===t||null===(i=t.join)||void 0===i?void 0:i.call(t,",")},Z=e=>u(e.split(",")),C=()=>u([...new Set((r||[]).map((e=>e.trim())).filter((e=>!!e)))]),S=()=>u([...new Set((r||[]).map((e=>e.trim())).filter((e=>!!(0,g.kE)(e))))]);switch(i){case"string":{var O;if(["s_tie","s_tine"].includes(n))return(0,w.tZ)("div",{});const e=(c.field_autocomplete||(null===(O=c.options)||void 0===O?void 0:O.autocomplete))&&{table:c.table,field:c.field,domain:c.domain};return"s_oo"===n?e?(0,w.tZ)(d.gN,{disabled:v,input:{type:"field_suggest_input",label:lng("value"),onBlur:C,suggest:e},value:r,onChange:u},p):(0,w.tZ)(d.gN,{disabled:v,input:{type:"text",label:lng("value"),onBlur:C},value:r?k(r):void 0,onChange:Z},p):(0,w.tZ)(d.gN,{disabled:v,input:{type:"text",label:lng("value"),placeholder:"e.g. Hello",suggest:e},value:r||void 0,onChange:u},p)}case"number":return["n_ib","n_inb"].includes(n)?(0,w.BX)("div",{className:"rule-values-bundle",children:[(0,w.tZ)(d.gN,{disabled:v,input:{type:"number",label:lng("value")},value:r||void 0,onChange:f},p),(0,w.tZ)(d.gN,{disabled:v,input:{type:"number",label:lng("and")},value:s||void 0,onChange:y},p+"_b")]}):"n_oo"===n?(0,w.tZ)(d.gN,{disabled:v,input:{type:"text",label:lng("value"),onBlur:S},value:r?k(r):void 0,onChange:Z},p):(0,w.tZ)(d.gN,{disabled:v,input:{type:"number",label:lng("value")},value:r||void 0,onChange:u},p);case"date":return(0,w.BX)(w.HY,{children:[["d_lb","d_mb","d_la","d_ma"].includes(n)?(0,w.tZ)(d.gN,{disabled:v,input:{type:"number",label:lng("value"),unit:["d_lb","d_mb"].includes(n)?lng("days ago"):lng("days away")},value:r||void 0,onChange:u},p):(0,w.tZ)(d.gN,{disabled:v,input:{type:"date",label:lng("value")},value:r?(0,T._3)(r).format(Blsm.prm.date_moment_format):void 0,onChange:e=>u(e?(0,T._3)(e).format(Blsm.prm.date_input_format):void 0)},p),"ws_completion_date"===p&&(0,R.createPortal)((0,w.tZ)(U,{types:["Group","Qualification"],disabled:v,onChange:x,value:o}),_.current)]});case"list":return(0,g.xb)(null===(t=c.options)||void 0===t?void 0:t.select_values)?(0,w.tZ)("div",{}):(r&&!Array.isArray(r)&&(r=[r]),(0,w.tZ)(d.gN,{disabled:v,input:{type:"multiple_items",tags:!0,showId:!1,searchData:(e,t)=>{let{term:i,ids:n}=e;t(Object.entries(c.options.select_values).filter((e=>{let[t,r]=e;return(0,g.Kn)(r)?r.label.toLowerCase().includes(null==i?void 0:i.toLowerCase())||(null==n?void 0:n.includes(r.value)):r.toLowerCase().includes(null==i?void 0:i.toLowerCase())||(null==n?void 0:n.includes(t))})).map((e=>{let[t,i]=e;return(0,g.Kn)(i)?{id:i.value,label:i.label}:{id:t,label:i}})))},label:lng("value"),emptyOption:!0,portal:_.current},value:r,onChange:u},p));case"flag":{const e=[{val:"1",label:lng("yes").caps()},{val:"0",label:lng("no").caps()}];return(0,w.tZ)(d.gN,{disabled:v,input:{type:"select",options:e,emptyOption:!0},value:r,onChange:u},p)}case"not_null":{const e=[{val:"1",label:lng("is not empty").caps()},{val:"0",label:lng("is empty").caps()}];return(0,w.tZ)(d.gN,{disabled:v,input:{type:"select",options:e,emptyOption:!0},value:r,onChange:u},p)}case"simple":return(0,w.tZ)(d.gN,{disabled:v,input:{type:"text",label:lng("value")},value:r,onChange:u},p);case"ou":case"role":case"workspace":case"workspace_status":{const e={ou:"ou",role:"role",workspace:"group,qualification,ou",workspace_status:"group,qualification,course_template"};let t;switch(i){case"ou":t=lng("search org' units");break;case"role":t=lng("search roles");break;default:t=lng("search workspaces")}const n={type:"multiple_items",tags:!0,searchData:(t,n)=>{(0,l.SC)("groups/autocomplete",{method:"POST",json:!0,data:{term:t.term||"",id:t.ids||"",types:e[i],for_rules:1}},n)},label:t,portal:_.current},s=e=>{b&&e&&re(e,m,h),u(e)};return r&&!Array.isArray(r)&&(r=[r]),(0,w.tZ)(d.gN,{disabled:v,input:n,value:r||void 0,onChange:s},p)}default:console.error("not implemented","RuleValue",{fieldKey:p,fieldType:i,relation:n,value:r,val_b:s,field:c,onChange:u})}return(0,w.tZ)("div",{})},G=(0,o.iv)("._radio_select{display:flex;justify-content:space-between;align-items:center;}._notice{padding:8px 5px 0;color:",c.g.colors.negative,";}._manual{position:relative;padding-",c.g.far,":20px;.help-sign{position:absolute;top:10px;",c.g.classes.far(0),";}}",""),W=e=>{let{operators:t,manual:i,onChange:n,onManualChange:r,count:s,notice:o}=e,a="and";return"string"==typeof t?a=t:"object"==typeof t&&(a=Array.isArray(t)?"advanced":"manual"),"advanced"!==a||[3,4].includes(s)||n("and"),s<2?(0,w.tZ)("div",{}):(0,w.BX)("div",{css:G,children:[(0,w.BX)("div",{className:"_radio_select",children:[(0,w.BX)("div",{style:{marginTop:"1em"},children:[lng("rule operators").caps(),":"]}),(0,w.tZ)(d.gN,{value:a,onChange:n,input:{type:"radio",name:"op_type",label:lng("OR"),radioValue:"or"}}),(0,w.tZ)(d.gN,{value:a,onChange:n,input:{type:"radio",name:"op_type",label:lng("AND"),radioValue:"and"}}),(0,w.tZ)(d.gN,{value:a,onChange:n,input:{type:"radio",name:"op_type",label:lng("manual|action"),radioValue:"manual"}}),[3,4].includes(s)&&(0,w.tZ)(d.gN,{value:a,onChange:()=>n([]),input:{type:"radio",name:"op_type",label:lng("advanced"),radioValue:"advanced"}})]}),(0,w.BX)("div",{children:["manual"===a&&(0,w.BX)("div",{className:"_manual",children:[(0,w.tZ)(d.gN,{input:{type:"text",label:lng("relation between rules"),style:{direction:"ltr",letterSpacing:".3em"}},value:i||void 0,onChange:r}),(0,w.tZ)(p.JO,{className:"help-sign",icon:"menu_info",toolTip:lng("e.g.: %s","A & (B | C) & D & ! (E | F)")})]}),"advanced"===a&&(0,w.tZ)(Y,{operators:t,onChange:e=>n(e),count:s}),(0,w.tZ)("div",{className:"_notice",children:Array.isArray(o)?o.map(((e,t)=>(0,w.tZ)("p",{children:e},t))):o})]})]})},K={name:"s5xdrg",styles:"display:flex;align-items:center"},Y=e=>{let{operators:t,onChange:i,count:n}=e;const r=[{val:"a",label:lng("AND")},{val:"o",label:lng("OR")},{val:"n",label:lng("AND NOT")}];if(3===n){0===t.length&&i(["a","a"]);const e=[t[0]||"a",t[1]||"a"];return(0,w.BX)("div",{css:K,children:[(0,w.tZ)(ie,{open:!0}),(0,w.tZ)(ee,{index:0}),(0,w.tZ)(d.gN,{input:{type:"select",options:r},value:e[0],onChange:t=>i([t,e[1]])}),(0,w.tZ)(ee,{index:1}),(0,w.tZ)(ie,{}),(0,w.tZ)(d.gN,{input:{type:"select",options:r},value:e[1],onChange:t=>i([e[0],t])}),(0,w.tZ)(ee,{index:2})]})}if(4===n){const e="2n2"===t[3];0===t.length&&i(["a","a","a"]);const n=[t[0]||"a",t[1]||"a",t[2]||"a"];return(0,w.BX)("div",{css:K,children:[(0,w.tZ)(ie,{open:!0}),(0,w.tZ)(ee,{index:0}),(0,w.tZ)(d.gN,{input:{type:"select",options:r},value:n[0],onChange:e=>i([e,n[1],n[2]])}),(0,w.tZ)(ee,{index:1}),e&&(0,w.tZ)(ie,{}),(0,w.tZ)(d.gN,{input:{type:"select",options:r},value:n[1],onChange:e=>i([n[0],e,n[2]])}),e&&(0,w.tZ)(ie,{open:!0}),(0,w.tZ)(ee,{index:2}),!e&&(0,w.tZ)(ie,{}),(0,w.tZ)(d.gN,{input:{type:"select",options:r},value:n[2],onChange:e=>i([n[0],n[1],e])}),(0,w.tZ)(ee,{index:3}),e&&(0,w.tZ)(ie,{}),(0,w.tZ)(p.JO,{icon:"sync",toolTip:lng("change parentheses"),color:c.g.colors.dominant_main,onClick:()=>i(e?n.slice(0,3):[...n.slice(0,3),"2n2"])})]})}return(0,w.tZ)("div",{})},Q=(0,o.iv)("margin:.9em 4px 0;padding:5px 13px;font-size:1.3em;background-color:",c.g.colors.dominant_main,";color:white;border-radius:50%;width:37px;height:37px;font-weight:600;white-space:nowrap;",""),ee=e=>{let{index:t}=e;return(0,w.tZ)("span",{css:Q,className:"_is_rule",children:Number.isInteger(t)?String.fromCharCode(65+t):"--"})},te={name:"zwfzz3",styles:"margin-top:11px;padding:0 4px;font-size:2.2em"},ie=e=>{let{open:t}=e;return(0,w.tZ)("span",{css:te,children:t?"(":")"})},ne=e=>{let{object_id:t,domain_id:i,req_type:n,rules:r,disabled:s,getOnlyAdd:o,getMaxUsers:a}=e;if(!Blsm.canAccessModule("Groups"))return null;return(0,w.tZ)(m.l,{theme:"outlined",onClick:()=>{(0,h.vm)().openDialog("form",new Z({object_id:t,domain_id:i,req_type:n,rules:r,only_add:null==o?void 0:o(),max_users:null==a?void 0:a()}))},disabled:s,children:lng("check rules").caps()})},re=(e,t,i)=>{(0,l.SC)("rules/collision",{data:{ws_behind:e,ws_ahead:t}},(e=>{let t=null;e.behind?t=`#${e.behind.id} ${e.behind.name} ${lng("also uses workspace status rule that may create a loop")}`:e.ahead&&(t=`#${e.ahead.id} ${e.ahead.name} ${lng("also uses workspace status rule that may create a loop")}`),i(t)}))}},7137:(e,t,i)=>{i.d(t,{BD:()=>y,ET:()=>_,r0:()=>g,rX:()=>b});var n=i(917),r=(i(7882),i(6920)),s=i(6975),o=i(7697),a=i(3051),l=i(5007),c=i(5761),d=i(7154),p=i(7363),u=i(8318),m=i(5944);const g=e=>{switch(parseInt(e)){case 1:return{color:"#008cf8",label:lng("beginner|level"),icon:"skill_l1",val:"1"};case 2:return{color:"#ff347c",label:lng("intermediate|level"),icon:"skill_l2",val:"2"};case 3:return{color:"#3dd261",label:lng("advanced|level"),icon:"skill_l3",val:"3"};default:return{color:"#757575",label:lng("unranked|level"),icon:"skill_unranked",val:null}}},h=e=>(0,n.iv)("border:1px solid ",r.g.colors.separator,";width:260px;min-width:260px;border-radius:6px;overflow:hidden;>.top{position:relative;height:125px;background-image:url('data:image/svg+xml;utf8,",encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none">\n\t<rect height="100" width="100" fill="${e}"/>\n\t<ellipse cx="${r.g.isRTL?100:-10}" cy="-50" rx="70" ry="105" fill="#FFF" fill-opacity=".2"/>\n\t<ellipse cx="${r.g.isRTL?-15:115}" cy="130" rx="40" ry="70" fill="#FFF" fill-opacity=".2"/>\n</svg>`),"');&:hover{cursor:pointer;}>.level{position:absolute;bottom:10px;",r.g.near,":10px;color:#fff;background-color:rgba(255, 255, 255, .3);border-radius:8px;padding:6px 10px;}>.Icon{position:absolute;top:5px;",r.g.far,":25px;font-size:65px;color:rgba(255, 255, 255, .7);&.Icon-skill_l1{transform:",r.g.isRTL?"rotate(10deg) scaleX(-1)":"rotate(-10deg)",";}&.Icon-skill_l2,&.Icon-skill_l3,&.Icon-skill_l4{transform:",r.g.isRTL?"rotate(40deg) scaleX(-1)":"rotate(-40deg)",";}}}>.bottom{height:78px;padding:6px;>div+div{margin-top:5px;}.title-flag{display:flex;justify-content:space-between;.title{font-weight:600;font-size:1.1em;max-width:85%;text-wrap:none;>div{width:100%;}>div>div{white-space:nowrap;width:100%;overflow:hidden;text-overflow:ellipsis;}}.flag{margin:3px;border-radius:4px;background-color:transparent;color:",r.g.colors.text_sec,";padding:3px 6px;border:1px solid ",r.g.colors.text_sec,";&.followed{color:white;border:none;background-color:",r.g.colors.dominant_main,";}&:hover{cursor:pointer;}}}.Ribbon{display:inline-block;}}",""),b=function(e){let{skill:t,actions:i,onClick:n,onSetLevelClick:l,onFlagClick:c,showFlag:b}=e;const{name:v,skill_level:_,manager_level:f,sk_id:y,editable:w,rating_details:x,following:k,type:Z}=t,C="additional"===Z&&_?_:!("occupation"!==Z||!f)&&f,S=!!x&&JSON.parse(x),O=!(null==S||!S.groups)&&Object.values(S.groups).reduce(((e,t)=>e+t),0),B=!(null==S||!S.lessons)&&Object.values(S.lessons).reduce(((e,t)=>e+t),0),T=[1,2,3].map((e=>g(e)));l&&T.forEach((e=>e.onClick=()=>l(y,e.val)));const{color:N,label:I,icon:D}=T[C-1]||{color:"#757575",label:lng("unranked|level"),icon:"skill_unranked",val:null},[j,P]=(0,p.useState)(k);return(0,m.BX)("div",{css:h(N),children:[(0,m.BX)("div",{className:"top",onClick:n,children:[(0,m.tZ)(a.x,{options:i,children:(0,m.tZ)(s.JO,{color:r.g.colors.dominant_white,icon:"menu_h",buttonLike:!0})}),w&&l&&(0,m.BX)(a.x,{options:T,className:"level",children:[(0,m.tZ)("span",{children:I.caps()})," ",(0,m.tZ)("span",{children:(0,m.tZ)(s.JO,{icon:"caret_down"})})]}),(!w||!l)&&(0,m.tZ)("div",{className:"level",children:I.caps()}),(0,m.tZ)(s.JO,{icon:t.icon||D||"skill_l"+C})]}),(0,m.BX)("div",{className:"bottom",children:[(0,m.BX)("div",{className:"title-flag",children:[(0,m.tZ)("div",{className:"title",children:(0,m.tZ)(d.u,{text:v.caps(),children:v.caps()})}),b&&(0,m.tZ)(d.u,{text:lng("recommendations for this skill will be received in the digital library").caps(),children:(0,m.tZ)("div",{className:(0,u.AK)("flag",{followed:j}),onClick:()=>!!c&&void(c&&(c(j),P(!j))),children:(0,m.tZ)(s.JO,{icon:"badge-flag"})})})]}),(O>0||B>0)&&(0,m.BX)("div",{children:[(0,m.tZ)(o.Vy,{size:24}),O>0&&(0,m.BX)("span",{children:[O," ",lng("workspaces")]}),O>0&&B>0&&"&",B>0&&(0,m.BX)("span",{children:[B," ",lng("content")]})]})]})]})},v=(0,n.iv)("border:1px solid ",r.g.colors.separator,";width:260px;min-width:260px;border-radius:6px;overflow:hidden;position:relative;height:205px;text-align:center;white-space:nowrap;line-height:45px;color:",r.g.colors.text_sec,";&:hover{color:#000000;cursor:pointer;}&:before{content:'';display:inline-block;height:100%;vertical-align:middle;margin-right:-0.25em;}.card{display:inline-block;vertical-align:middle;.Icon{font-size:50px;}.title{font-weight:600;font-size:1.1em;}}",""),_=e=>{let{user_id:t,store:i}=e;return(0,m.tZ)("div",{css:v,onClick:()=>(0,l.vm)().openDialog("form",new c.ty({store:i,user_id:t,onSave:(e,t)=>i.onAddSkill(e,t)}),{wizard:!0}),children:(0,m.BX)("div",{className:"card",children:[(0,m.tZ)(s.JO,{icon:"sign_plus"}),(0,m.tZ)("div",{className:"title",children:lng("add new skill").caps()})]})})},f=(0,n.iv)("background-color:",r.g.colors.blue_shade,";color:",r.g.colors.blue,";font-weight:500;font-size:1rem;border-radius:8px;display:flex;padding:10px 5px;flex-direction:row;width:250px;align-items:center;.Icon{font-size:2rem;margin:0 10px;}.name{font-size:1.2rem;}",""),y=e=>{let{occupation:t}=e;const{name:i,alt_name:n}=t,r=n||i;return r?(0,m.BX)("div",{css:f,children:[(0,m.tZ)(s.JO,{icon:"pointer_alt"}),(0,m.BX)("div",{className:"content",children:[(0,m.BX)("div",{children:[lng("current occupation").caps(),":"]}),(0,m.tZ)("span",{className:"name",children:r.caps()})]})]}):""}},7095:(e,t,i)=>{i.d(t,{P:()=>d,p:()=>p});var n=i(917),r=i(6920),s=i(3051),o=i(6975),a=i(2906),l=i(5944);const c=(0,n.iv)("cursor:default;._dropdown{font-weight:600;display:inline-flex;table{width:100%;}}._label{color:",r.g.colors.text_sec,";display:inline-flex;white-space:nowrap;}",""),d=e=>{let{sorts:t=[],by:i,desc:n=!1,onSort:r,className:a}=e;const d=t.find((e=>e.val===i));return t.forEach((e=>e.active=e.val===i)),(0,l.BX)("div",{css:c,className:a,children:[(0,l.BX)("span",{className:"_label",children:[lng("sort by").caps(),": "]}),(0,l.tZ)(s.x,{className:"_dropdown",options:t,onSelect:e=>r&&r(e),children:(0,l.BX)("span",{style:{whiteSpace:"nowrap"},children:[d?d.label.caps():"invalid sort by"," ",(0,l.tZ)(o.JO,{icon:"arrow_"+(n?"down":"up")})]})})]})},p=(e,t,i,n)=>{if(""===t.by){if(i){const t=JSON.parse(localStorage.getItem(i)),r=[...(null==t?void 0:t.map((t=>e.find((e=>e[n]==t)))))||[],...e];return[...new Set(r)].filter((e=>!!e))}return t.desc?e.slice().reverse():e}return e.sort(((e,i)=>(t.desc?-1:1)*(((0,a.Lj)(e,t.by)||"")+"").localeCompare(((0,a.Lj)(i,t.by)||"")+"",void 0,{numeric:!0})))}},3550:(e,t,i)=>{i.d(t,{b:()=>g,y:()=>u});var n=i(5587),r=i(4285),s=i(7363),o=i(9752),a=i(2339),l=i(917),c=i(6920),d=i(6941),p=i(5944);const u=(0,s.createContext)(null),m=(0,l.iv)("opacity:.3;position:relative;background-color:white;border-radius:",c.g.consts.WIDGET_BORDER_RADIUS,'px;&:after{content:"";position:absolute;left:0;top:0;width:100%;height:100%;}',""),g=e=>{let{children:t,onSort:i,wrapperStyleFunc:r}=e;const[l,c]=(0,s.useState)(t.slice()),[u,g]=(0,s.useState)(null);(0,s.useLayoutEffect)((()=>{c(t.slice())}),[t]);const b=l.map(((e,t)=>(0,p.tZ)(h,{id:e.key,wrapperStyleFunc:r?()=>r(t):void 0,children:e},e.key))),v=l.map((e=>e.key));return(0,p.BX)(o.LB,{autoScroll:!1,onDragOver:e=>{const{active:t,over:i}=e;i&&t.id!==i.id&&c((e=>{const r=e.findIndex((e=>e.key===t.id)),s=e.findIndex((e=>e.key===i.id));return(0,n.Rp)(e,r,s)}))},onDragStart:e=>g(e.active.id),onDragEnd:()=>{null==i||i({new_order:v,moved_id:u}),g(null)},modifiers:[a.F4],children:[(0,p.tZ)(n.Fo,{items:v,strategy:()=>{},children:b}),(0,p.tZ)(d.M,{children:(0,p.tZ)(o.y9,{children:u?(0,p.tZ)("div",{css:m,children:l.find((e=>u===e.key))}):null})})]})},h=function(e){let{id:t,children:i,wrapperStyleFunc:s}=e;const o=(0,n.nB)({id:t}),{setNodeRef:a,transform:l,transition:c}=o;let d=s?s():{};return d={...d,transition:c,transform:r.ux.Translate.toString(l)},(0,p.tZ)("div",{ref:a,style:d,children:(0,p.tZ)(u.Provider,{value:o,children:i})})}},539:(e,t,i)=>{i.d(t,{$:()=>c});var n=i(917),r=i(6920),s=(i(7882),i(6344)),o=i(5944);const a=64,l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.g.theme.color_1,t=arguments.length>1?arguments[1]:void 0;return(0,n.iv)("text-align:center;>img{height:",t,";}&.center{position:fixed;top:calc(50vh - 64px);left:calc(50vw - 64px);}>._label{margin-top:1em;color:",e,";text-align:center;font-weight:600;font-size:1.2rem;}>._animation{width:",t,";height:",t,";overflow:hidden;margin:0 auto;position:relative;}","")},c=function(e){let{label:t,color:i,className:n,size:c=`${a}px`,...d}=e;const p=i?[i,(0,s.HO)(i,.2),(0,s.HO)(i,.4),(0,s.HO)(i,.6)]:r.g.theme.spinnerSet,u=p[0];return(0,o.BX)("div",{css:l(u,c),className:n,...d,children:[(0,o.tZ)("svg",{className:"_animation",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",children:(0,o.tZ)("g",{transform:"translate(50,50) scale(1) translate(-50,-50)",children:(0,o.BX)("g",{children:[(0,o.tZ)("animateTransform",{attributeName:"transform",type:"rotate",values:"0 50 50;90 50 50",times:"0;1",dur:"1s",repeatCount:"indefinite"}),Array.from(Array(12)).map(((e,t)=>(p.push(p.shift()),(0,o.tZ)("path",{d:"M44.6,20.6c2.6,4.4,7,7.1,11.7,7.7c1.9-4.4,1.7-9.5-0.8-14c-2.6-4.4-7-7.1-11.7-7.7C41.9,11,42,16.2,44.6,20.6z",fill:p[0],transform:`rotate(${30*t} 50 50)`,children:(0,o.tZ)("animate",{attributeName:"fill",repeatCount:"indefinite",dur:"1s",keyTimes:"0;0.33;0.66;1",values:p.join(";"),begin:"0s"})},t))))]})})}),t&&(0,o.tZ)("div",{className:"_label",children:t})]})}},5875:(e,t,i)=>{i.d(t,{S:()=>k,o:()=>_});var n=i(7363),r=i(917),s=i(6920),o=i(5405),a=i(6975),l=i(441),c=i(8318),d=(i(7882),i(3051)),p=i(3550),u=i(7154),m=i(2464),g=i(4902),h=i(6344),b=i(5944);const v=e=>{let{markColor:t,titleColor:i,translucent:n}=e;return(0,r.iv)("position:relative;background-color:",(0,h.pp)(s.g.colors.bg_cont,!!n&&.6),";border-radius:9px;color:",s.g.colors.text_sec,";",s.g.classes.shadow_light,";overflow:hidden;padding:0;._inner{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;justify-content:flex-start;padding:10px;._inner_content{display:inline-flex;flex-basis:100%;column-gap:20px;._title{flex-basis:180px;}}",t?`border-${s.g.near}: 7px solid ${t};`:""," ._inner_content>._titles{line-height:1.8em;}}&.shadow_strong{",s.g.classes.shadow_strong,";}&.dark{border:1px solid ",s.g.colors.border_dark,";background-color:",s.g.colors.background_dark,";box-shadow:none;}._titles{display:inline-flex;flex-grow:1;flex-wrap:wrap;white-space:normal;>div{flex-basis:100%;}}._title{display:inline-flex;flex-grow:1;overflow:hidden;color:",i||s.g.colors.text_main,";font-weight:600;font-size:1.1em;white-space:normal;}._subTitle{color:",s.g.colors.text_sec,";white-space:normal;}._tags{flex-basis:100%;white-space:normal;&.highlightFirstTag span:first-of-type{color:",s.g.colors.yellow,";font-weight:700;}}._img,.Avatar{margin-inline-end:10px;}._sort_handle{visibility:hidden;}&._clickable{&:hover{._title{text-decoration:underline;cursor:pointer;}}}&:hover{._sort_handle{visibility:visible;}}&.condensed{border-radius:7px;._inner{padding:2px 10px;._inner_content>._titles{line-height:1.7em;}}._titles{padding:2px 0;}}._actions{color:",s.g.colors.text_black,";white-space:nowrap;}","")},_=e=>(0,b.tZ)(o.SV,{children:(0,b.tZ)(w,{...e})});var f={name:"1lv1yo7",styles:"display:inline-flex"},y={name:"1u4hpl4",styles:"display:inline"};const w=e=>{const{title:t,titleColor:i,href:r,newTab:o,className:h,onClick:_,tags:w,highlightFirstTag:x=!0,subTitle:k,inContainer:Z,dark:C,translucent:S,condensed:O,markColor:B,icon:T,iconColor:N,iconTooltip:I,img:D,imgSize:j=s.g.consts.ITEM_IMG_SIZE+"px",menuOptions:P,menuOnSelect:z,toolTip:E,children:R,additionalTop:F,additionalBottom:M,avatar:A,avatarBalloon:q,avatarSize:X}=e,L=(0,n.useContext)(p.y);return(0,b.tZ)("div",{css:v({markColor:B,titleColor:i,translucent:S}),className:(0,c.AK)(h,{shadow_strong:Z,dark:C,condensed:O,_clickable:!(!_&&!r)}),children:(0,b.BX)("div",{className:"_inner",children:[D&&(0,b.tZ)(m.XI,{className:"_img",img:s.g.func.imgUrl(D),size:[j,j]}),A&&(0,b.tZ)(g.qE,{user:A,balloon:q,size:X}),(0,b.BX)("div",{className:"_inner_content",children:[(0,b.BX)("div",{className:"_titles",onClick:_,children:[F,(0,b.BX)("div",{css:f,children:[T&&(0,b.tZ)(a.JO,{icon:T,color:N,toolTip:I,spaceAfter:!0}),(0,b.tZ)(u.u,{text:E,children:t&&(0,b.tZ)(l.A,{className:"_title",href:r,processHrefClick:!0,newTab:o,css:y,children:t})})]}),k&&(0,b.tZ)("div",{className:"_subTitle",children:k}),(null==w?void 0:w.length)>0&&(0,b.tZ)("div",{className:(0,c.AK)("_tags",{highlightFirstTag:x}),children:w.map(((e,t)=>(0,b.BX)(n.Fragment,{children:[(0,b.tZ)("span",{children:e}),t<w.length-1?(0,b.tZ)(b.HY,{children:" • "}):null]},t)))}),M]}),R]}),(L||(null==P?void 0:P.length)>0)&&(0,b.BX)("span",{className:"_actions",children:[L&&(0,b.tZ)("span",{className:"_sort_handle",...L.attributes,...L.listeners,children:(0,b.tZ)(a.JO,{icon:"move",smallButtonLike:!0})}),(null==P?void 0:P.length)>0&&(0,b.tZ)(d.x,{className:"_menu",options:P,onSelect:z,children:(0,b.tZ)(a.JO,{icon:"menu",smallButtonLike:!0})})]})]})})},x=e=>{let{markColor:t,titleColor:i}=e;return(0,r.iv)("position:relative;display:flex;flex-wrap:wrap;flex-direction:row;justify-content:center;text-align:center;background-color:",s.g.colors.bg_1,";padding:5px;",s.g.classes.shadow_light,";&:hover{background-color:",s.g.colors.bg_2,";}",t?`border: 2px solid ${t};`:"",">*{flex-basis:100%;}._title{display:inline-flex;flex-grow:1;overflow:hidden;color:",i||s.g.colors.text_main,";font-weight:700;font-size:1.1em;}._clickable{cursor:pointer;}._subTitle{color:",s.g.colors.text_sec,";}._tags{flex-basis:100%;span:first-of-type{color:",s.g.colors.yellow,";font-weight:700;}}","")},k=e=>{let{title:t,href:i,newTab:r,titleColor:o,subTitle:u,tags:g,markColor:h,className:v,onClick:_,icon:f,iconTooltip:y,img:w,imgSize:k=s.g.consts.ITEM_IMG_SIZE+"px",menuOptions:Z,menuOnSelect:C,children:S}=e;const O=(0,n.useContext)(p.y);return(0,b.BX)("div",{css:x({markColor:h,titleColor:o}),className:(0,c.AK)(v,{_clickable:!(!_&&!i)}),children:[w&&(0,b.tZ)(m.XI,{img:w,size:[k,k],className:"_img",contain:"contain"}),(0,b.BX)("div",{children:[f&&(0,b.tZ)(a.JO,{icon:f,toolTip:y}),t&&(0,b.tZ)(l.A,{className:(0,c.AK)("_title",{_clickable:!(!_&&!i)}),href:i,processHrefClick:!0,newTab:r,children:t})]}),u&&(0,b.tZ)("div",{className:"_subTitle",children:u}),(null==g?void 0:g.length)>0&&(0,b.tZ)("div",{className:"_tags",children:g.map(((e,t)=>(0,b.BX)(n.Fragment,{children:[(0,b.tZ)("span",{children:e}),t<g.length-1?(0,b.tZ)(b.HY,{children:" • "}):null]},t)))}),S,(O||(null==Z?void 0:Z.length)>0)&&(0,b.BX)("span",{className:"_actions",children:[O&&(0,b.tZ)("span",{className:"_sort_handle _hover",...O.attributes,...O.listeners,children:(0,b.tZ)(a.JO,{icon:"move",smallButtonLike:!0})}),(null==Z?void 0:Z.length)>0&&(0,b.tZ)(d.x,{className:"_menu _hover",options:Z,onSelect:C,children:(0,b.tZ)(a.JO,{icon:"menu",smallButtonLike:!0})})]})]})}},493:(e,t,i)=>{i.d(t,{T:()=>u});var n=i(917),r=i(6920),s=i(6975),o=i(9952),a=i(8318),l=(i(7882),i(7363)),c=i(5311),d=i(5944);const p=(e,t,i,s)=>(0,n.iv)("display:inline-flex;align-items:center;",i?"width: 100%;":""," .label{",r.g.classes.margin_far("10px"),";}.value-label{",i?r.g.classes.margin_far("10px"):r.g.classes.margin_near("10px"),";}.control-switcher{position:relative;height:",e,"px;border-radius:9999px;background-color:",r.g.colors.bg_1,";display:inline-block;}.options{display:flex;>div{min-width:",e,"px;height:",e,"px;border-radius:",e,"px;font-size:",e/2,"px;padding:",t?"1em":0,";color:",r.g.colors.grey,";cursor:",s?"unset":"pointer",";display:flex;align-items:center;justify-content:center;}}&.show-option-dots{.options{>div{border:7px solid ",r.g.colors.bg_2,";background-color:",r.g.colors.text_placeholder,";}}}.highlighter{position:absolute;width:",e,"px;height:",e,"px;background-color:",r.g.theme.color_1,";border-radius:",e,"px;top:0;display:flex;align-items:center;justify-content:center;font-size:",e/2,"px;color:#FFF;",r.g.near,":0;cursor:",s?"unset":"pointer",";transition:transform .3s ease-in-out,transform .3s ease-in-out;}",""),u=e=>{var t,i;let{onChange:n,options:u=[],value:m,size:g=20,disabled:h,label:b,showValueLabel:v,inlineLabels:_,fullWidth:f}=e;const y=(0,l.useRef)([]),w=(0,l.useRef)(0),x=(0,l.useRef)(null),k=m?u.findIndex((e=>e.val==m)):0,Z=k+1===u.length?u[0].val:null===(t=u[k+1])||void 0===t?void 0:t.val,C=!_&&u.length>2&&!u.some((e=>e.icon)),[S,O]=(0,l.useState)(!1);(0,l.useLayoutEffect)((()=>{if(x.current)return x.current.style.width=Math.ceil(y.current[k].getBoundingClientRect().width)+"px",S?B():w.current=setTimeout((()=>(B(),O(!0))),300),()=>clearTimeout(w.current)}),[m,S]);const B=()=>{if(!x.current)return;const e=y.current.slice(0,k).reduce(((e,t)=>e+Math.ceil(t.getBoundingClientRect().width)),0)*(r.g.isRTL?-1:1);x.current.style.transform=`translateX(${e+"px"})`},T=u[k],N=v&&null!=T&&T.label?(0,d.tZ)("div",{className:"value-label",children:null===(i=T.label)||void 0===i?void 0:i.caps()}):null;return(0,d.BX)("div",{css:p(g,_,f,h),className:(0,a.AK)("switcher-input",{"show-option-dots":C}),children:[(0,d.tZ)("div",{className:"label",children:"string"==typeof b?(0,d.tZ)(o.A,{label:b}):b}),f&&(0,d.tZ)(c.zh,{}),f&&N,(0,d.BX)("div",{className:"control-switcher",children:[(0,d.tZ)("div",{className:"options",children:u.map(((e,t)=>(0,d.BX)("div",{onClick:h?void 0:()=>n(e.val),ref:e=>y.current[t]=e,children:[e.icon&&(0,d.tZ)(s.JO,{icon:e.icon}),_&&(0,d.BX)(d.HY,{children:[" ",e.label.caps()]})]},e.val||0)))}),T&&(0,d.BX)("div",{className:"highlighter",onClick:h?void 0:()=>n(Z),ref:x,style:{backgroundColor:h?r.g.colors.disabled_background:T.color},children:[T.icon&&(0,d.tZ)(s.JO,{icon:T.icon}),_&&(0,d.BX)(d.HY,{children:[" ",T.label.caps()]})]})]}),!f&&N]})}},676:(e,t,i)=>{i.d(t,{VD:()=>P,q3:()=>T,iA:()=>I,W7:()=>B,lF:()=>D});var n=i(7363),r=i(5560),s=i(917),o=i(6920),a=i(5697),l=i(5836),c=i(5405),d=i(5832),p=i(8411),u=i(8318),m=i(81),g=(i(7882),i(539)),h=i(9637),b=i(2698),v=i(7154),_=i(6975),f=i(5944);const y=(0,s.iv)("background-color:",o.g.darkMode?o.g.colors.bg_cont:"#FAFAFA",";font-size:.9em;text-align:",o.g.near,";padding:2px 10px;white-space:nowrap;z-index:",o.g.z.widget_bar,";&._clickable{cursor:pointer;}&:first-of-type{border-radius:7px 0 0 7px;}&:last-of-type{border-radius:0 7px 7px 0;}&._center{text-align:center;}&._sticky{position:sticky;border-radius:0;box-shadow:0 3px 0 rgba(113, 74, 178, 15%);}&._narrow{width:1px;white-space:normal;}>.Icon{margin:0 5px;}&:hover{z-index:",o.g.z.widget_bar+1,";}","");var w={name:"t10jb8",styles:"margin:5px"};const x=e=>{let{title:t,checkAll:i,sortVal:n,onSort:r,sort:s,collection:o,tableHeadSticky:a,stickyStartHeight:l,tooltip:c,narrow:d}=e;return a=!(0,u.tq)()&&a,(0,f.BX)(b.kA,{css:y,style:{top:(0,u.kE)(a)?a+l+"px":void 0},className:(0,u.AK)({_center:i,_clickable:n,_sticky:a,_narrow:i||d}),onClick:n?()=>r(n):void 0,children:[(0,u.rj)(null==t?void 0:t.caps()),c&&(0,f.tZ)(v.u,{css:w,text:c,children:(0,f.tZ)(_.JO,{icon:"menu_info"})}),(null==s?void 0:s.by)===n&&(0,f.tZ)(_.JO,{icon:"arrow_"+(null!=s&&s.desc?"down":"up")}),i&&(0,f.tZ)(h.bx,{collection:o})]})};var k=i(6421);const Z=(0,s.iv)("border:1px solid ",o.g.colors.border,";border-radius:7px;margin:5px 0;overflow:hidden;position:relative;font-size:.9rem;>div{display:flex;&>div{padding:3px 5px;}>div:first-child{background-color:#f5f4f5;font-size:.9em;min-width:30%;}&.main>div:nth-child(2){color:",o.g.colors.text_main,";font-weight:600;}}.checkbox{position:absolute;bottom:0;",o.g.far,":0;}",""),C=["main"],S=(0,r.observer)((function(e){let{tds:t}=e;const{cols:i}=(0,n.useContext)(B);let r=null;return(0,f.BX)("div",{css:Z,children:[t.map(((e,t)=>{var n,s;if(!1===e)return null;let o,a,l={};if((0,u.Kn)(e)){if("checkbox"===e.type)return r=(0,f.tZ)(k.I,{type:"checkbox",className:"checkbox",disabled:e.o.disabled,value:e.o._checked,onChange:t=>e.o._checked=t}),null;if("description"===e.type){let{text:t,html:i,isHtml:n}=e;n&&!i&&(i=t),o=i?(0,u.s9)(i):t}else if("icons"===e.type&&e.icons){const t=e.icons.filter((e=>e));if(!t.length)return null;o=t.map(((e,t)=>(0,f.tZ)(_.JO,{buttonLike:!0,...e},t)))}else o=e._;a=C.includes(null==e?void 0:e.type)?null==e?void 0:e.type:void 0,l={...e},delete l._,delete l.indent}else o=e;if(!o)return null;let c=i[t];return(0,u.Kn)(c)&&(c=c.title),(0,f.BX)("div",{...l,className:(0,u.AK)(a,l.className),onClick:t=>"icons"===e.type&&t.stopPropagation(),children:[(0,f.tZ)("div",{children:c?`${null===(n=(s=c).caps)||void 0===n?void 0:n.call(s)}:`:""}),(0,f.tZ)("div",{children:o})]},t)})),r]})}));var O=i(1619);const B=(0,n.createContext)(null),T=40,N=e=>{let{compact:t=!1,whiteSpace:i}=e;return(0,s.iv)("width:100%;>table{border-collapse:separate;border-spacing:0 5px;width:100%;color:",o.g.colors.text_sec,";>tbody>tr{height:",t?T:63,"px;>td{border-style:solid;border-color:",o.g.colors.border,";border-width:1px 0;padding:",t?0:""," 10px;",i?`white-space: ${i};`:""," &:first-of-type{border-",o.g.near,"-width:1px;border-top-",o.g.near,"-radius:",t?5:7,"px;border-bottom-",o.g.near,"-radius:",t?5:7,"px;}&:last-of-type{border-",o.g.far,"-width:1px;border-top-",o.g.far,"-radius:",t?5:7,"px;border-bottom-",o.g.far,"-radius:",t?5:7,"px;}&._main{color:",o.g.colors.text_main,";font-weight:600;padding-top:0;padding-bottom:0;}&._bold{font-weight:600;}&._icons{width:1px;white-space:nowrap;>.Icon,>.ContextMenu{display:inline-block;font-size:1.3em;&:not(:first-child){.el_icon:not(.buttonLike):not(.smallButtonLike){",o.g.classes.margin_near("12px"),";}}}}&._img{width:1px;padding:0 20px;line-height:0;img{width:31px;height:31px;object-fit:cover;}}&._type_icon{font-size:1.8em;}&._center{text-align:center;}}&:hover:not(._disable_hover){>td{border-color:",o.g.theme.color_1,";}}}}",o.g.mQuery.mobile,"{overflow:auto;}","")},I=(0,r.observer)((function(e){const{cols:t,collection:i,filters:r,sorts:s,actions:a,RowRenderer:h,rowIdCol:b="_key",rowProps:v,filterNsort:_,filterDelay:y,showBar:w=!0,title:k,scrollParent:Z,sticky:C,stickyStartHeight:S,noWindow:O,loading:I,compact:D,whiteSpace:j,barExtraComponent:P,tableReplacement:z,displayCount:E=!1,mobileSupport:R=!1,forceMobileView:F=!1,isSearchPage:M=!1}=e,{filtersVals:A,setFilterVals:q,sort:X,setSort:L}=(0,m.qD)(_),$=_?i:(0,d.WB)(i,A,X,{filters:r}),V=(0,m.iP)().width<1024,U=R&&V||F,H=!((0,u.xb)(r)&&(0,u.xb)(y)&&(0,u.xb)(s)&&(0,u.xb)(a)&&(0,u.xb)(P)),J=(0,f.tZ)(p.CX,{title:k,filters:r,filtersVals:A,delay:y,onFilter:q,sorts:s,sort:X,onSort:L,actions:a,extraComponent:P,alwaysShow:H,sticky:C,displayCount:{count:null==$?void 0:$.length,display:E},minHeight:"42px"});let G=0;M||(G+=42.5);const W=(0,f.tZ)("thead",{style:C&&!V?{position:"sticky",top:o.g.consts.TABLE_HEAD_HEIGHT+G+"px",zIndex:1}:null,children:(0,f.tZ)("tr",{style:t&&{height:"32px"},children:null==t?void 0:t.filter((e=>!!e||""===e)).map(((e,t)=>(0,f.tZ)(x,{..."string"==typeof e?{title:e}:e,sortVal:s?e.sortVal:void 0,sort:X,onSort:L,collection:$,tableHeadSticky:C,stickyStartHeight:S},t)))})}),K=(0,n.useCallback)(z||O||I?void 0:e=>{let{partialList:i,style:n,listRef:r}=e;return(0,f.tZ)("div",{css:N({compact:D,whiteSpace:j}),children:(0,f.BX)("table",{style:n,ref:r,children:[W,(0,f.BX)("tbody",{children:[i.map((e=>(0,f.tZ)(c.SV,{children:(0,f.tZ)(h,{row:e,rowProps:v,cols:t,rows:i})},e[b]))),(0,f.tZ)("tr",{style:{height:"auto"}})]})]})})});let Y;return Y=z||(U?I?(0,f.tZ)(g.$,{}):$.map((e=>(0,f.tZ)(c.SV,{children:(0,f.tZ)(h,{row:e,rowProps:v,rows:$})},e[b]))):O||I||U?(0,f.tZ)("div",{css:N({compact:D,whiteSpace:j}),children:(0,f.BX)("table",{children:[!U&&W,(0,f.tZ)("tbody",{children:I?(0,f.tZ)("tr",{children:(0,f.tZ)("td",{colSpan:t.length,style:{border:0},children:(0,f.tZ)(g.$,{})})}):$.map((e=>(0,f.tZ)(c.SV,{children:(0,f.tZ)(h,{row:e,rowProps:v,rows:$})},e[b])))})]})}):(0,f.tZ)(l.C,{items:$,itemHeight:5+(D?T:63),itemBuffer:15,container:Z||window,InnerComponent:K})),(0,f.BX)(B.Provider,{value:{cols:t,mobileView:U},children:[w&&J,Y]})})),D=(a.object,a.shape({rowAction:a.func}),e=>{let{tds:t,...i}=e;const{mobileView:r}=(0,n.useContext)(B);return r?(0,f.tZ)(S,{tds:t}):(0,f.tZ)("tr",{...i,children:t.filter((e=>!1!==e)).map(((e,t)=>{let i,n="td";return null!=e&&e.type&&("main"===e.type?n=h.U6:"image"===e.type?n=h.NM:"icons"===e.type?n=h.jA:"checkbox"===e.type?n=h.Fo:"description"===e.type?n=h.FS:"td"!==e.type&&console.warn(`invalid td type '${e.type}' in arrToTr`)),(0,u.Kn)(e)?(i=e.props?{...e.props}:{...e},delete i.type,i.children=i._,delete i._):i={children:e},(0,f.tZ)(n,{...i},t)}))})}),j=(0,s.iv)("tr{td{min-width:",(0,u.tq)()?"40%":"120px",";margin:15px;padding:0 5px;}td:first-child{color:",o.g.colors.text_sec,";font-size:0.9em;}td:last-child{font-weight:600;}}",""),P=e=>{let{pairs:t}=e;return(0,f.tZ)("table",{css:j,children:(0,f.tZ)("tbody",{children:t.map(((e,t)=>{var i;let[n,r,s]=e;return(0,f.BX)("tr",{children:[(0,f.tZ)("td",{children:null===(i=n.caps)||void 0===i?void 0:i.call(n)}),(0,f.BX)("td",{children:["string"==typeof r&&(0,f.tZ)(f.HY,{children:"text"===s?(0,f.tZ)(O.xn,{content:r}):r}),r.icon&&(0,f.tZ)(_.JO,{icon:r.icon})]})]},t)}))})})}},9637:(e,t,i)=>{i.d(t,{FS:()=>_,Fo:()=>u,NM:()=>b,U6:()=>g,bx:()=>m,jA:()=>h});var n=i(7363),r=i(917),s=i(5560),o=i(6421),a=(i(7882),i(6920)),l=i(7154),c=i(8318),d=i(6975),p=i(5944);const u=(0,s.observer)((e=>{let{o:t,...i}=e;return(0,p.tZ)("td",{onClick:e=>e.stopPropagation(),className:"_center",...i,children:(0,p.tZ)(o.I,{type:"checkbox",disabled:t.disabled,value:t._checked,onChange:e=>t._checked=e})})})),m=(0,s.observer)((e=>{let{collection:t}=e;const i=!t.find((e=>!e._checked||!!e.disabled)),[r,s]=(0,n.useState)(t.length>0&&i);return(0,p.tZ)(o.I,{type:"checkbox",value:r,onChange:e=>(s(e),t.forEach((t=>t._checked=t.disabled?t._checked:e)))})})),g=(0,s.observer)((e=>{let{children:t,width:i,minWidth:n,indent:r,biggerFont:s}=e;const o={};return i&&(o.width=i),n&&(o.minWidth=n),s&&(o.fontSize="1.1em"),r&&(o["padding"+(a.g.isRTL?"Right":"Left")]="30px"),(0,p.tZ)("td",{className:"_main",style:o,children:t})})),h=(0,s.observer)((e=>{let{children:t,icons:i}=e;return(0,p.tZ)("td",{className:"_icons",onClick:e=>e.stopPropagation(),children:i?i.filter((e=>e)).map(((e,t)=>(0,p.tZ)(d.JO,{buttonLike:!0,...e},t))):t})})),b=(0,s.observer)((e=>{let{src:t,alt:i}=e;return(0,p.tZ)("td",{className:"_img",children:(0,p.tZ)("img",{src:t,alt:i})})})),v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;return(0,r.iv)("max-width:",e,"px;",a.g.classes.ellipsis,";","")},_=(0,s.observer)((e=>{let{text:t,html:i,maxWidth:n=200,truncateLength:r=50,isHtml:s}=e;return s&&!i&&(i=t),(0,p.tZ)("td",{children:(0,p.tZ)(l.u,{html:i,text:t,children:(0,p.tZ)("div",{css:v(n),children:i?(0,c.s9)(i,r):null==t?void 0:t.truncate(r)})})})}))},5836:(e,t,i)=>{i.d(t,{C:()=>a,x:()=>p});var n=i(7363),r=i(5560),s=i(81),o=(i(7882),i(5944));const a=(0,r.observer)((function(e){let{items:t=[],itemHeight:i,itemBuffer:r,container:a=window,InnerComponent:c}=e;const d=(0,n.useRef)(),[u,m]=(0,n.useState)({firstItemIndex:0,lastItemIndex:-1});let g=()=>{if(!d.current)return;const e=l(d.current,a,t,i,r);!e||e.firstItemIndex>e.lastItemIndex||e.firstItemIndex===u.firstItemIndex&&e.lastItemIndex===u.lastItemIndex||m(e)};return"undefined"!=typeof window&&"requestAnimationFrame"in window&&(g=p(g)),(0,n.useEffect)(g),(0,s.OR)("scroll",g,a),(0,s.OR)("resize",g,a),(0,o.tZ)(c,{listRef:d,partialList:u.lastItemIndex>-1?t.slice(u.firstItemIndex,u.lastItemIndex+1):[],style:{height:t.length*i,paddingTop:u.firstItemIndex*i,boxSizing:"border-box"}})})),l=(e,t,i,n,r)=>{if(!t||!n||!i||0===i.length)return;const{innerHeight:s,clientHeight:o}=t,a=s||o;if(!a)return;const l=d(t),p=l+a,u=c(e)-c(t),m=n*i.length,g=Math.max(0,l-u),h=Math.max(0,Math.min(m,p-u));return{firstItemIndex:Math.max(0,Math.floor(g/n)-r),lastItemIndex:Math.min(i.length,Math.ceil(h/n)+r)-1}},c=e=>void 0!==e&&e?(e.offsetTop||0)+c(e.offsetParent):0,d=e=>e.pageYOffset?e.pageYOffset:e.document?e.document.documentElement&&e.document.documentElement.scrollTop?e.document.documentElement.scrollTop:e.document.body&&e.document.body.scrollTop?e.document.body.scrollTop:0:e.scrollY||e.scrollTop||0,p=function(e){let t=!1;return()=>{t||(t=!0,window.requestAnimationFrame((()=>{e.apply(this,arguments),t=!1})))}}},1092:(e,t,i)=>{i.d(t,{m:()=>g});var n=i(917),r=i(7363),s=i(6920),o=(i(7882),i(8318)),a=i(441),l=i(81),c=i(6975),d=i(2945),p=i(2698),u=i(6380),m=i(5944);const g=(0,r.forwardRef)((function(e,t){let{tabs:i,activeTab:a,onSelect:c,className:d,inContainerHead:p,noCaps:u,morePadding:g,subTabs:h,stickyTabs:_}=e;const[y,w]=(0,r.useState)(!1),x=(0,r.useRef)(null),k=(0,r.useRef)(0),Z=(0,l.iP)(),C=()=>{k.current=v(x.current)+10,w(x.current.clientWidth<=k.current)};return(0,r.useEffect)(C,[Z.width,i.length]),(0,r.useImperativeHandle)(t,(()=>({resize:C}))),(0,m.tZ)("div",{css:(S=_,(0,n.iv)("position:relative;width:100%;",S&&(0,n.iv)("position:sticky;top:50px;padding:10px 0;background-color:",s.g.colors.bg_main,";z-index:1;",""),";&.inContainerHead{max-width:800px;&,.TabItem{min-height:33px;max-height:33px;}}","")),className:(0,o.AK)("Tabs",d,{inContainerHead:p}),ref:x,children:y?(0,m.tZ)(f,{selectedTab:a,onSelect:c,tabs:i,noCaps:u}):i.map(((e,t)=>(0,m.tZ)(b,{tab:e,selectedTab:a,onSelect:c,noCaps:u,morePadding:g,subTabs:h,error:e.error},t)))});var S})),h=(0,n.iv)("display:inline-block;cursor:pointer;&.subTabs{padding:7px 1em;font-size:.9em;}&:not(.subTabs){font-weight:600;border-bottom:1px solid transparent;transition:border-color .2s ease-out;padding:0 20px 10px;&.morePadding{padding:0 25px 15px;font-size:1.1em;.Icon{font-size:1.1em;}}&:hover{border-color:",s.g.colors.separator,";}}&._active{color:",s.g.colors.dominant_main,";border-color:",s.g.colors.dominant_main,";white-space:nowrap;}&.error{color:",s.g.colors.negative,";}._label{position:relative;.Icon{vertical-align:bottom;}._label_text{display:inline-block;max-height:33px;max-width:40vw;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;vertical-align:middle;}&.notActive ._label_text{text-decoration:line-through;}}",""),b=function(e){let{tab:t,selectedTab:i,onSelect:n,arrowDown:r,noCaps:s,morePadding:l,subTabs:d,error:g}=e;const{label:b,active:v,val:_,href:f,badge:y,notActive:w,icon:x,iconLink:k,iconFar:Z,iconFarLink:C}=t;!s&&b&&b.match(/^[A-Z]/)&&console.warn(`Tab item capitalize label by itself, please remove .caps() from array. (${b})`);const S=(0,m.BX)("div",{className:(0,o.AK)("_label",{notActive:w}),children:[x&&(0,m.tZ)(c.JO,{icon:x,href:k,spaceAfter:!!b}),b&&(0,m.tZ)("div",{className:"_label_text",children:s?b:null==b?void 0:b.caps()})," ",y>=0&&(0,m.tZ)(u.T,{badge:y})," ",r&&(0,m.tZ)(c.JO,{icon:"arrow_down"}),Z&&(0,m.tZ)(c.JO,{icon:Z,href:C,spaceBefore:!0})]}),O={css:h,onClick:n?()=>n(_):void 0,href:f,className:(0,o.AK)("TabItem",{error:!!g,_active:v||"val"in t&&_===i,subTabs:d,morePadding:l})};return C||O.onClick?(0,m.tZ)(p.LZ,{...O,children:S}):(0,m.tZ)(a.A,{...O,children:S})},v=e=>{let t=0;for(let i=0;i<e.childElementCount;i++)t+=e.children[i].clientWidth;return t},_=(0,n.iv)("user-select:none;min-height:23px;>._label{display:inline-block;}>._list{background-color:white;border:1px solid #a9a9a9;border-radius:4px;position:fixed;z-index:60;overflow:auto;max-height:50vh;padding:7px;>a,>div{display:block;padding:8px 5px;border:none;._badge{float:",s.g.classes.opposite_side,";}}}",""),f=e=>{let{selectedTab:t,onSelect:i,tabs:n,noCaps:r}=e;const{opened:s,toggleDD:o,selectRef:a,labelRef:l,ddRef:c}=(0,d.v)({}),p=n.find((e=>e.val===t));return(0,m.BX)("div",{css:_,ref:a,children:[(0,m.tZ)("div",{className:"_label",onClick:()=>o(void 0),ref:l,children:p&&(0,m.tZ)(b,{tab:p,selectedTab:t,arrowDown:!0,noCaps:r})}),s&&(0,m.tZ)("div",{className:"_list",ref:c,children:n.map((e=>(0,m.tZ)(b,{tab:e,selectedTab:t,onSelect:i?e=>(i(e),o(!1)):void 0,noCaps:r},e.val||e.label)))})]})}},5680:(e,t,i)=>{i.d(t,{Vp:()=>v,qP:()=>h,r$:()=>f});var n=i(917),r=i(5560),s=i(8318),o=(i(7882),i(6920)),a=i(6344),l=i(6975),c=i(7154),d=i(441),p=i(7363),u=i(5944);const m=["#20c3dc","#ff560a","#E91E63","#9C27B0","#673AB7","#3D51B5","#00BCD4","#5AB963","#8BC34A","#eaaf01","#FF9800"],g={},h=(e,t)=>t?{backgroundColor:t,color:(0,a.ou)(t)}:(g[e]||(g[e]=e.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0)),{backgroundColor:m[(g[e]+2147483647)%m.length],color:"#fff"}),b=(0,n.iv)("font-size:.9em;transition:background-color .3s ease-out;background-color:#f2f2f3;color:#171625;padding:5px 9px;border-radius:14px;user-select:none;position:relative;&._clickable{cursor:pointer;}&.disabled{opacity:.3;}&.smaller{font-size:.8em;padding:2px 7px;}&.bigger{font-size:1em;padding:8px 11px;font-weight:600;}&.bright{background-color:",o.g.colors.bg_input,";border:1px solid ",o.g.colors.border,";}.remove{position:absolute;background-color:",o.g.colors.grey,";top:-5px;}",""),v=(0,r.observer)((function(e){let{tag:t,count:i,active:n,onClick:r,disabled:o,color:a,tooltip:d,smaller:p,bigger:m,bright:g,onRemove:v}=e;const _=(0,u.BX)("div",{css:b,style:void 0===n||!0===n?h(t.toLowerCase(),a):void 0,onClick:o?void 0:r,className:(0,s.AK)({_clickable:!o&&r,disabled:o,smaller:p,bigger:m,bright:g}),children:[t.caps(),i?` (${i})`:"",v&&(0,u.tZ)(l.JO,{className:"remove",smallerButtonLike:!0,icon:"close",onClick:o?void 0:v})]});return d?(0,u.tZ)(c.u,{text:d,children:_}):_})),_=e=>(0,n.iv)("position:relative;>._title{font-size:0.9em;font-weight:600;color:",o.g.colors.text_sec,';}>._tags{display:flex;flex-wrap:wrap;margin:0 -4px;&.justify{justify-content:space-between;&:after{content:"";flex:auto;}}>div{margin:4px ',e?"10px":"4px"," 4px;}a{align-self:end;}}",""),f=function(e){let{children:t,justify:i,title:n,className:r,onClear:o,removableTags:a=!1,toggleShowMore:c=!1}=e;const[m,g]=(0,p.useState)(!c),h=(null==t?void 0:t.filter((e=>!1==!e)).length)-5,b=null==t?void 0:t.filter((e=>!!e));return 0===(null==b?void 0:b.length)?null:(0,u.BX)("div",{css:_(a),className:(0,s.AK)("TagsContainer",r,{justify:i}),children:[n&&(0,u.tZ)("div",{className:"_title",children:n.caps()}),o&&(0,u.tZ)(l.JO,{icon:"clear",toolTip:lng("clear|verb"),onClick:()=>(g(!1),o()),css:l.y$}),(0,u.BX)("div",{className:"_tags",children:[m?b:b.slice(0,5),c&&!m&&h>0&&(0,u.BX)(d.A,{theme:"highlight",toolTip:lng("show more"),onClick:()=>g(!0),children:[" + ",h]}),c&&m&&h>0&&(0,u.tZ)(d.A,{theme:"highlight",onClick:()=>g(!1),children:lng("show less")})]})]})}},5690:(e,t,i)=>{i.d(t,{A:()=>x,M:()=>y});var n=i(7363),r=i(917),s=i(6920),o=i(539),a=i(6975),l=(i(7882),i(8318)),c=i(5474),d=i(3051),p=i(2334),u=i(5944);const m=[lng("january|month"),lng("february|month"),lng("march|month"),lng("april|month"),lng("may|month"),lng("june|month"),lng("july|month"),lng("august|month"),lng("september|month"),lng("october|month"),lng("november|month"),lng("december|month")],g=[lng("sun|day short"),lng("mon|day short"),lng("tue|day short"),lng("wed|day short"),lng("thu|day short"),lng("fri|day short"),lng("sat|day short")],h=e=>{if(!e.includes("-")&&!e.includes("+"))return e;const t=e.substring(0,1),i=e.substring(1).trim();return"+"===t?moment().add(Math.abs(i),"years").year():moment().subtract(Math.abs(i),"years").year()},b=e=>{let{range:t=5,min:i,max:n}=e;const r=[];let s=h(new String(i||"-"+t)),o=h(new String(n||"+"+t));o=s>o&&!n&&i?parseInt(s)+t:parseInt(o),s=o<s&&!i&&n?parseInt(o)-t:parseInt(s);for(let e=s;e<=o;e++)r.push({label:e,val:e});return r},v=e=>{let{inDropDown:t}=e;return(0,r.iv)("cursor:pointer;font-weight:600;text-align:center;padding:.25em 0;>div{width:2.7em;display:inline-block;",t?"":"height: 3.4em;padding-top: .5em;"," ._dots{font-weight:bold;font-size:1.5em;line-height:0;color:",s.g.colors.dominant_main,";}&._today{border-radius:10px;background-color:",s.g.colors.highlight,";color:",s.g.colors.text_main,";}&._active{border-radius:10px;background-color:",s.g.colors.dominant_main,";color:",s.g.colors.dominant_main_shade,";._dots{color:white;}}&._out_of_range{color:#b8b8b8;cursor:default;}}","")},_=e=>{let{date:t,today:i,active:n,eventsCount:r=0,onSelect:s,inDropDown:o,inRange:a}=e;return(0,u.tZ)("td",{css:v({inDropDown:o}),className:"day",onClick:()=>a&&s&&s(t),children:(0,u.BX)("div",{className:(0,l.AK)({_active:n,_today:i,_out_of_range:!a}),children:[t.date(),(0,u.tZ)("div",{className:"_dots",children:".".repeat(Math.min(3,r))})]})})},f=(0,r.iv)("font-size:1rem;max-width:500px;color:",s.g.colors.text_main,";._table{position:relative;>table{width:100%;th{width:14.2%;color:",s.g.colors.text_sec,";font-size:.8em;font-weight:600;padding:1em 0;text-align:center;}}._load{position:absolute;left:0;top:0;width:100%;height:100%;background:white;opacity:0.5;display:flex;align-items:center;justify-content:center;}}",""),y=e=>{let{activeDate:t,onDateSelect:i,onMonthChange:r,events:s,className:a,inDropDown:l,minDate:c,maxDate:h,monthNavigation:v=!0,yearsSelector:y={range:5}}=e;const[w,k]=(0,n.useState)(t?t.clone().startOf("month"):(0,p.WQ)().startOf("month")),Z=(e,t)=>{const i=t?w.month():moment(e,"MM").month(),n=t?moment(e,"YYYY").year():w.year();k(moment(`${n}-${i+1}`,"YYYY-MM")),null==r||r(moment(`${n}-${i+1}`,"YYYY-MM"))};(0,n.useEffect)((()=>{var e;t&&Z(null===(e=t.clone)||void 0===e?void 0:e.call(t).startOf("month"))}),[t]);const C=e=>(k(w.clone().add(e?1:-1,"months")),null==r?void 0:r(w.clone().add(e?1:-1,"months"))),S=((e,t,i)=>{const n=Array(e.day()).fill(null),r=(0,p.WQ)().startOf("day");let s=e.clone().startOf("month");const o=e.month();for(;o===s.month();)n.push({d:s.clone(),today:(0,p.KC)(r,s),active:!!t&&(0,p.KC)(t,s),events_count:(i||[]).filter((e=>!!e&&e.calRelevantForDate(s))).length}),s.add("1","days");return n})(w,t,s);return(0,u.BX)("div",{css:f,className:a,children:[(0,u.tZ)(x,{goNext:v?()=>C(!0):null,goPrev:v?()=>C(!1):null,title:(0,u.BX)(u.HY,{children:[(0,u.tZ)(d.x,{onSelect:Z,options:m.map(((e,t)=>({val:t+1,label:e}))),dropDownLike:!0,children:(0,u.tZ)("b",{children:m[w.month()].caps()})})," ",(0,u.tZ)(d.x,{onSelect:e=>{var t;return e!==w.year()&&Z(null===(t=w.clone)||void 0===t?void 0:t.call(w).year(e),!0)},dropDownLike:!0,options:b(y),children:w.year()})]})}),(0,u.BX)("div",{className:"_table",children:[(0,u.BX)("table",{children:[(0,u.tZ)("thead",{className:"headers",children:(0,u.tZ)("tr",{children:g.map(((e,t)=>(0,u.tZ)("th",{children:e.toUpperCase()},t)))})}),(0,u.tZ)("tbody",{children:[0,1,2,3,4,5].map((e=>(0,u.tZ)("tr",{children:S.slice(7*e,7*e+7).map(((e,t)=>{return e?(0,u.tZ)(_,{date:e.d,today:e.today,active:e.active,eventsCount:e.events_count,inDropDown:l,onSelect:e=>i&&i(e),inRange:(n=e.d,!(c&&moment(n).isBefore(c)||h&&moment(n).isAfter(h)))},e.d.unix()):(0,u.tZ)("td",{},t);var n}))},e)))})]}),!1===s&&(0,u.tZ)("div",{className:"_load",children:(0,u.tZ)(o.$,{})})]})]})},w=(0,r.iv)("display:flex;align-items:center;font-size:1.2em;margin-bottom:6px;flex:1;>._strike{flex-grow:1;border-top:1px solid ",s.g.colors.separator,";",s.g.classes.margin_near(".5em"),";}>._navigation{user-select:none;&:first-of-type{",s.g.classes.margin_far(".5em"),";}>*{border:1px solid ",s.g.colors.separator,";color:",s.g.colors.text_sec,";cursor:pointer;border-radius:8px;font-size:0.7em;padding:5px;&.disabled{background-color:",s.g.colors.disabled_background,";cursor:auto;}&+*{",s.g.classes.margin_near("4px"),";}}}",""),x=e=>{let{title:t,goPrev:i,goNext:n,goToday:r,viewType:s,onChangeViewType:o}=e;return(0,u.BX)("div",{css:w,className:"headers",children:[(0,u.tZ)("div",{className:"_navigation",children:s&&(0,u.tZ)(c.P,{options:[{val:"month",label:lng("month")},{val:"week",label:lng("week")},{val:"day",label:lng("day")}],value:s,onChange:o})}),(0,u.tZ)("div",{children:t}),(0,u.tZ)("div",{className:"_strike"}),(0,u.BX)("div",{className:"_navigation",children:[i&&(0,u.tZ)(a.JO,{icon:"arrow_near",onClick:i}),n&&(0,u.tZ)(a.JO,{icon:"arrow_far",onClick:n}),void 0!==r&&(0,u.tZ)("span",{onClick:(0,l.Wl)(r)?r:void 0,className:(0,l.AK)({disabled:!(0,l.Wl)(r)}),children:lng("today").caps()})]})]})}},101:(e,t,i)=>{i.d(t,{Jf:()=>g,hM:()=>v,mp:()=>b,v0:()=>m});var n=i(7363),r=i(917),s=i(6920),o=i(8318),a=(i(7882),i(9752)),l=i(6975),c=i(3051),d=i(5560),p=i(6380),u=i(5944);const m=e=>{let t=0;for(const i of e)t+=1+(i._sons_total=i.sons?m(i.sons):0);return t},g=e=>{const t={};for(const i of e)t[i.id]=i;for(const i of e)i.parent&&t[i.parent]&&(t[i.parent].sons||(t[i.parent].sons=[]),t[i.parent].sons.push(i));const i=e.filter((e=>!(e.parent&&t[e.parent])));return m(i),i},h=e=>{let{treeMargin:t}=e;return(0,r.iv)("margin:0;&,ul{list-style:none;padding:0;}ul{",s.g.classes.margin_near(t+"px"),";}","")},b=function(e){const{tree:t,innerNodeOf:i,idField:r="id",_sortable:s,_nonDroppableNodes:o,treeMargin:a=30}=e;let l=1;return(0,u.tZ)("ul",{css:i?void 0:h({treeMargin:a}),children:t.map(((a,c)=>{const d=(0,u.tZ)(f,{node:a,treeProps:e,parentDistance:l});return l+=1+(a._sons_total||0),(0,u.BX)(n.Fragment,{children:[s&&(0,u.tZ)(C,{parentId:i,position:c,_nonDroppableNodes:o}),d,s&&c===t.length-1&&(0,u.tZ)(C,{parentId:i,position:c+1,_nonDroppableNodes:o})]},a[r])}))})},v=function(e){const{tree:t,onNodeMove:i}=e,[r,s]=(0,n.useState)(null),[l,c]=(0,n.useState)(void 0);return(0,u.BX)(a.LB,{onDragEnd:e=>{let{active:t,over:n}=e;(null==n?void 0:n.id)&&(null==i||i(t.id,n.id)),s(null),c(void 0)},onDragStart:e=>{let{active:i}=e;const n=[],r=(0,o.oH)(t,(e=>(null==e?void 0:e.id)===i.id),n),a={};(0,o.oH)(r,(e=>{var t;if(null!=e&&e.id&&(a[e.id]=1,null!==(t=e.sons)&&void 0!==t&&t.length))for(let t=0;t<=e.sons.length;t++)a[`${e.id}|${t}`]=1}));const l=n.length>1?n[n.length-2]:{sons:t},d=l.sons.indexOf(r);a[`${l.id||""}|${d}`]=a[`${l.id||""}|${d+1}`]=1,s(r),c(a)},collisionDetection:(e,t)=>{const i=(0,a.Xo)(e,t);return i?i in l?null:i:null},children:[(0,u.tZ)(b,{...e,_sortable:!0,_nonDroppableNodes:l}),(0,u.tZ)(a.y9,{children:r?(0,u.tZ)("div",{css:y({shadow:!0}),children:(0,u.tZ)(w,{treeProps:e,node:r})}):null})]})},_=(0,r.iv)("li>div.trail{position:relative;>div{border:0 solid #c1c1c1;border-bottom-width:1px;border-",s.g.near,"-width:1px;border-bottom-",s.g.near,"-radius:4px;position:absolute;width:15px;",s.g.near,":-12px;bottom:-14px;display:flex;align-items:flex-end;}}",""),f=function(e){let{treeProps:t,node:i,parentDistance:n}=e;const{filterText:r="",innerNodeOf:s,onSelect:l,idField:c="id",nameField:d="name",sonsField:p="sons",_sortable:m,nodeHeight:g=29}=t,h=i[c],v=i[d],{attributes:f,listeners:x,setNodeRef:k,isDragging:Z}=(0,a.O1)({id:h,disabled:!m}),{isOver:C,setNodeRef:S}=(0,a.Zj)({id:h,disabled:!m});return(0,u.BX)("li",{css:_,children:[!r&&s&&(0,u.tZ)("div",{className:"trail",children:(0,u.tZ)("div",{style:{height:n*(g+(m?15:0))-12+"px"}})}),(null==v?void 0:v.toLowerCase().includes(r.toLowerCase()))&&(0,u.tZ)("div",{css:y({sortable:m,isDragging:Z}),className:(0,o.AK)({drag_over:C}),onClick:l?()=>l(h):void 0,...x,...f,ref:e=>(S(e),k(e)),children:(0,u.tZ)(w,{treeProps:t,node:i})}),i[p]&&(0,u.tZ)(b,{...t,tree:i[p],innerNodeOf:h})]})},y=e=>{let{sortable:t,isDragging:i,shadow:n}=e;return(0,r.iv)("border-radius:4px;padding:2px 4px;cursor:",t?"move":"pointer",";border:1px dashed transparent;opacity:",i?.3:1,";",n?s.g.classes.shadow_strong:"",";&.drag_over{border-color:silver;}&:hover{background-color:",s.g.colors.dominant_main_shade,";}","")},w=(0,d.observer)((function(e){let{treeProps:t,node:i}=e;const{activeId:n,renderNode:r,idField:s="id",nameField:a="name",buttons:l,mayEdit:c}=t,d=i[s],p=d===n;return r?r(i,p):(0,u.tZ)(k,{id:d,name:i[a],icon:i.icon,count:Number(i.count),active:p,mayEdit:c,buttons:(0,o.g4)(l,null,[d,i]),isGlobalParent:".0"===i.path})})),x=(0,r.iv)("display:flex;align-items:center;>._label{padding:2px 5px;border-radius:4px;}>.actions{white-space:nowrap;>*{",s.g.classes.margin_near("3px"),";}}&.active{>._label{background-color:",s.g.colors.dominant_main,";color:white;}}",""),k=function(e){let{id:t,name:i,icon:n,count:r,active:a,mayEdit:d=!1,buttons:m=[]}=e;return(0,u.BX)("span",{css:x,className:`${(0,o.AK)({active:a})} cat_${t}`,children:[(0,u.BX)("div",{className:"_label",children:[n&&(0,u.BX)(u.HY,{children:[(0,u.tZ)(l.JO,{icon:n})," "]}),i]}),(0,u.tZ)("div",{css:s.g.classes.flex_grow}),(0,u.tZ)(p.T,{badge:r}),(0,u.tZ)("div",{className:"actions",onPointerDown:e=>e.stopPropagation(),children:d&&(0,u.tZ)(u.HY,{children:m.map(((e,n)=>{let{label:r,onClick:s,actions:o,icon:a}=e;return(null==o?void 0:o.length)>0?(0,u.tZ)(c.x,{options:o,children:(0,u.tZ)(l.JO,{icon:a},n)}):(0,u.tZ)(l.JO,{icon:a,toolTip:r,onClick:e=>(e.stopPropagation(),s({id:t,name:i}))},n+5)}))})})]})},Z=(e,t)=>(0,r.iv)("transition:height .15s ease-in-out;height:15px;border:1px dashed ",e?"silver":t?"#eeeeee":"transparent",";",""),C=function(e){let{parentId:t,position:i,_nonDroppableNodes:n}=e;const r=`${t||""}|${i}`,s=n&&!(r in n),{isOver:o,setNodeRef:l}=(0,a.Zj)({id:r});return(0,u.tZ)("li",{css:Z(o,s),ref:l})}},5446:(e,t,i)=>{i.d(t,{O:()=>S,k:()=>w});var n=i(917),r=i(6597),s=i(6920),o=i(5405),a=i(4902),l=i(8318),c=i(8e3),d=i(6975),p=i(2334),u=i(7392),m=i(441),g=(i(7882),i(7821)),h=i(5560),b=i(539),v=i(5007),_=i(5311),f=i(5944);const y=(0,n.iv)(r.N,";display:flex;flex-direction:column;font-size:1rem;background-color:",s.g.colors.bg_cont,";border-radius:18px;padding:30px 28px;",s.g.classes.shadow_strong,";justify-content:space-between;._avatar{margin:5px auto;display:flex;justify-content:center;font-size:30px;}._username{color:",s.g.colors.text_main,";font-size:1.4em;font-weight:bold;text-align:center;}._stats{width:100%;td{width:50%;text-align:center;>div{margin-top:0.2em;font-size:1.4em;font-weight:bold;color:",s.g.colors.text_main,";}}}._filter{background-color:",s.g.theme.color_1,";color:white;border-radius:12px;text-align:center;padding:10px 0;font-size:1.1em;font-weight:600;cursor:pointer;&._active{background-color:",s.g.colors.dominant_main,";}}",""),w=e=>(0,f.tZ)(o.aK,{children:(0,f.tZ)(x,{...e})}),x=e=>{let{user:t,active:i,onButtonClick:n}=e;return(0,f.BX)("div",{css:y,children:[(0,f.tZ)("div",{className:"_avatar",children:(0,f.tZ)(a.qE,{user:t,size:"84px",shadowed:!0,balloon:!1})}),(0,f.tZ)("div",{className:"_username",children:(0,l.v2)(t)}),(0,f.tZ)("table",{className:"_stats",children:(0,f.tZ)("tbody",{children:(0,f.BX)("tr",{children:[(0,f.BX)("td",{children:[lng("assignments").caps(),(0,f.tZ)("div",{children:t.countAssignments})]}),(0,f.BX)("td",{children:[lng("overdue").caps(),(0,f.tZ)("div",{children:t.countAssignmentsOverdue})]})]})})}),(0,f.tZ)("div",{className:(0,l.AK)("_filter",{_active:i}),onClick:n,children:lng("show assignments").caps()})]})},k=(0,n.iv)("padding:10px;color:",s.g.colors.text_sec,";min-width:210px;max-width:240px;._userTitle{display:flex;position:relative;align-items:center;color:",s.g.colors.text_main,";border:1px solid ",s.g.colors.border,";border-radius:10px;padding:5px;._circledImage{",s.g.classes.margin_far("5px"),";}}.smallTitle{font-weight:600;}.small{font-size:12px;}._userContent{margin-top:8px;>div{margin:2px;div{line-height:1;}}}",""),Z=g.observable.map({},{deep:!1});var C={name:"3zy121",styles:"margin:20px"};const S=(0,h.observer)((function(e){let{userId:t}=e;const i=(Blsm.user.isPowerManager||!Blsm.isFeatureEnabled("isolate_users"))&&!(0,l.Tz)(t),n=function(e){const t=Z,i=t.get(e);return i||(t.set(e,"loading"),(0,c.SC)("users/"+e,{},(i=>t.set(e,i))),t.get(e))}(t);return"loading"===n?(0,f.tZ)(b.$,{css:C}):(0,l.xb)(n)?null:(0,f.BX)("div",{css:k,onClick:e=>e.stopPropagation(),children:[(0,f.BX)("div",{className:"_userTitle",children:[(0,f.tZ)(a.cU,{img:n.user_avatar,bgColor:s.g.func.id2color(t),className:"_circledImage"}),(0,f.tZ)(m.A,{theme:"hover",href:{user:t},children:(0,f.tZ)("b",{children:(0,l.v2)(n)})}),(0,f.tZ)(_.zh,{}),Blsm.user.isPowerManager&&!(0,l.Tz)(t)&&(0,f.tZ)(u.l,{onClick:()=>(0,v.vm)().pretend(t),children:(0,f.tZ)(d.JO,{toolTip:lng("pretend to be this user"),icon:"pretend"})})]}),(0,f.BX)("div",{className:"_userContent",children:[(0,f.tZ)("div",{className:"smallTitle small",children:n.user_company}),(0,f.tZ)("div",{className:"smallTitle small",children:n.user_department}),(0,f.tZ)("div",{className:"smallTitle small",children:n.user_job_title}),(0,f.tZ)("div",{className:"smallTitle small",children:n.user_gender}),(0,f.tZ)("div",{className:"smallTitle small",children:n.user_business_phone}),(0,f.tZ)("div",{className:"smallTitle small",children:n.user_mobile_phone}),n.user_birthdate&&(0,f.BX)("div",{className:"small",children:[(0,f.tZ)(d.JO,{icon:"cupcake",color:"#FFAC98"})," ",(0,p.GG)(n.user_birthdate,{time:!1,year:!1})]}),i&&Blsm.isFeatureEnabled("create_messages")&&(0,f.tZ)(u.l,{theme:"contained",onClick:()=>(0,m.p4)({message:"new",params:{to:t}},!0),children:lng("send message").caps()}),i&&void 0!==window.bchat&&(0,f.tZ)(u.l,{theme:"outlined",onClick:()=>window.bchat.openChat(t),children:(0,f.tZ)(d.JO,{icon:"chat"})})]})]})}))},236:(e,t,i)=>{i.d(t,{$L:()=>_,Hl:()=>b,a5:()=>g});var n=i(917),r=i(6920),s=i(7363),o=i(441),a=i(2755),l=i(5762),c=i(6975),d=i(3051),p=i(8318),u=i(3550),m=(i(7882),i(5944));const g=(0,s.createContext)(null),h=e=>(0,n.iv)("display:flex;flex-wrap:wrap;flex-direction:row;justify-content:start;margin:0 -",r.g.consts.CARDS_SPACING/2,"px;padding-bottom:",(0,p.tq)()?"50vh":0,";>div{margin:0 ",r.g.consts.CARDS_SPACING/2+"px"," ",(e||r.g.consts.CARDS_SPACING)+"px",";&._filler{width:",r.g.consts.CARD_WIDTH,"px;margin-bottom:0;}}",r.g.mQuery.mobile,"{justify-content:center;margin:0 -4px;>div{width:100%;margin:0 4px 2em;}}",""),b=e=>{let{children:t,className:i,sortable:n,onSort:r,vertSpacing:s}=e;(0,p.w1)()&&(n=!1);return(0,m.BX)("div",{css:h(s),className:(0,p.AK)("WidgetContainer",i),ref:e=>{e&&!e.style.minHeight&&(e.style.minHeight=Math.min(e.offsetHeight,1e3)+"px")},children:[n?(0,m.tZ)(u.b,{onSort:r,children:t}):t,!n&&(0,p.w6)(6).map((e=>(0,m.tZ)("div",{className:"_filler"},e)))]})},v=(0,n.iv)("border:1px solid ",r.g.colors.separator,";position:relative;background-color:",r.g.colors.bg_cont,";overflow:hidden;",r.g.mQuery.mobile,"{.widget-body{min-height:3em;}._icons{display:block;}}",r.g.mQuery.notMobile,"{height:",r.g.consts.WIDGET_BASE_HEIGHT,"px;._icons{display:none;}}border-radius:",r.g.consts.WIDGET_BORDER_RADIUS,"px;display:flex;flex-direction:column;>.widget-title{padding:7px 15px 0;min-height:35px;font-size:1.1rem;font-weight:600;line-height:1;",r.g.classes.ellipsis_lines(2),";}>.widget-subtitle{padding:3px 15px 0;min-height:25px;font-size:0.9rem;font-weight:200;line-height:1;",r.g.classes.ellipsis_lines(2),";}>.widget-body{overflow:auto;flex-grow:1;}._icons{position:absolute;top:5px;",r.g.far,":4px;white-space:nowrap;}&:hover ._icons{display:block;}",""),_=e=>{var t;let{title:i,subtitle:n,children:p,link:h,newTab:b,className:_,size:f=1,dragHandle:y=!0,menuOptions:w,newMenuOptions:x,css:k,additionalIcons:Z,widgetId:C}=e;const S=(0,s.useContext)(u.y),O=null===(t=(0,s.useContext)(g))||void 0===t?void 0:t.baseWidth,B=!1===O?O:O||r.g.consts.CARD_WIDTH;return(0,m.BX)("div",{css:[v,k,"",""],className:_,style:{width:B&&f*B+(f-1)*r.g.consts.CARDS_SPACING+"px"},"data-widget_id":C,children:[(0,m.BX)(u.y.Provider,{value:void 0,children:[i&&(0,m.tZ)("div",{className:"widget-title",children:(0,m.tZ)(o.A,{href:h,children:i.caps()})}),n&&(0,m.tZ)("div",{className:"widget-subtitle",children:(0,m.tZ)("span",{children:n.caps()})}),(0,m.tZ)("div",{className:"widget-body",children:(0,m.tZ)(l.SV,{children:p})})]}),(0,m.BX)("div",{className:"_icons",children:[Z,(null==x?void 0:x.length)>0&&(0,m.tZ)(d.x,{options:x,children:(0,m.tZ)(c.JO,{icon:"new",smallButtonLike:!0})}),h&&(0,m.tZ)(a.ZT,{className:"_link_icon",icon:b?"popout":"go_arrow",href:h,newTab:b,size:24}),y&&S&&(0,m.tZ)("span",{...S.attributes,...S.listeners,children:(0,m.tZ)(c.JO,{icon:"move",smallButtonLike:!0})}),(null==w?void 0:w.length)>0&&(0,m.tZ)(d.x,{options:w,children:(0,m.tZ)(c.JO,{icon:"menu",smallButtonLike:!0})})]})]})}},6852:(e,t,i)=>{i.d(t,{J:()=>a,k:()=>c});var n=i(7363),r=i(6920),s=i(539),o=i(5944);const a=e=>{var t;return e==parseInt(e)?r.g.colors.set[e]:null!==(t=e)&&void 0!==t&&t.startsWith("#")?e:("in_process"===e?e="progress":"no_progress"===e&&(e="waiting"),r.g.colors.chart[e]||"#2196F3")},l=(0,n.lazy)((()=>Promise.all([i.e(866),i.e(740),i.e(547)]).then(i.bind(i,8146)).then((e=>({default:e.ChartInner}))))),c=function(e){return(0,o.tZ)(n.Suspense,{fallback:(0,o.tZ)(s.$,{}),children:(0,o.tZ)(l,{...e})})}},7371:(e,t,i)=>{i.d(t,{O:()=>a});var n=i(7363),r=i(539),s=i(5944);const o=(0,n.lazy)((()=>Promise.all([i.e(340),i.e(533)]).then(i.bind(i,6013)).then((e=>({default:e.BubbleChartInner}))))),a=function(e){return(0,s.tZ)(n.Suspense,{fallback:(0,s.tZ)(r.$,{}),children:(0,s.tZ)(o,{...e})})}},5967:(e,t,i)=>{i.d(t,{Q:()=>l,t:()=>d});var n=i(917),r=i(6920),s=i(8318),o=(i(7882),i(5944));const a=(0,n.iv)("display:flex;&:not(.side){flex-wrap:wrap;justify-content:center;>div{flex-grow:1;justify-content:center;width:49%;&:nth-of-type(-n+2){border-top:1px solid ",r.g.colors.separator,";border-bottom:1px solid ",r.g.colors.separator,";}&:nth-of-type(even){border-left:1px solid ",r.g.colors.separator,";}}}&.side{width:45%;flex-direction:column;}",""),l=e=>{let{children:t,side:i}=e;return(0,o.tZ)("div",{css:a,className:(0,s.AK)("ChartLegend",{side:i}),children:t})},c=(0,n.iv)("display:flex;height:60px;>div{padding:6px 0 0 6px;}._dot{display:inline-block;height:17px;width:17px;border-radius:50%;margin-right:7px;vertical-align:bottom;}._number{font-weight:lighter;font-size:1.4em;color:",r.g.colors.text_sec,";}",""),d=e=>{let{numerator:t,denominator:i,label:n,color:r,onlyPercent:a}=e,l=t;return i&&(l=a?(0,s.aQ)(t,i,2)+"%":`${t} (${(0,s.aQ)(t,i)}%)`),(0,o.BX)("div",{css:c,children:[(0,o.tZ)("div",{children:(0,o.tZ)("span",{className:"_dot",style:{backgroundColor:r}})}),(0,o.BX)("div",{children:[(0,o.tZ)("div",{children:n.caps()}),(0,o.tZ)("div",{className:"_number",children:l})]})]})}},4525:(e,t,i)=>{i.d(t,{C:()=>l});var n=i(917),r=i(6920),s=(i(7882),i(6852)),o=i(5944);const a=e=>{let{size:t}=e;return(0,n.iv)("width:",t,";height:",t,";position:relative;>.label{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);text-align:center;.valLabel{font-weight:600;}.fractionLabel{font-size:.8em;}}","")},l=function(e){let{percent:t,numerator:i,denominator:n,size:l="100px",precision:c=2,color:d,valueSign:p=""}=e;const u=r.g.colors.chart;void 0!==n&&(t=0===n?0:100*i/n),void 0===d&&(d=t<33?u.failure:t<66?u.neutral:u.success);const m=[{color:d,number:t},{color:u.bg,number:100-t}],g=Math.pow(10,c);return(0,o.BX)("div",{css:a({size:l}),children:[(0,o.BX)("div",{className:"label",children:[(0,o.BX)("div",{className:"valLabel",children:[Math.round(t*g)/g,p]}),void 0!==n&&(0,o.BX)("div",{className:"fractionLabel",children:[i,"/",n]})]}),(0,o.tZ)(s.k,{type:"pie",data:m,height:l,width:l,toolTip:!1})]})}},6704:(e,t,i)=>{i.d(t,{G:()=>x});var n=i(5560),r=i(7363),s=i(1137),o=i(1092),a=i(8207),l=i(539),c=i(4210),d=i(3346),p=i(5155),u=i(9305),m=i(917),g=i(8318),h=i(5597),b=i(1619),v=i(7203),_=i(6975),f=i(6920),y=i(5944);const w=(0,m.iv)(".title{font-size:18px;font-weight:700;margin-bottom:10px;}.row{position:relative;display:flex;justify-content:space-between;flex-grow:1;.Button{width:100%;}.Button:nth-child(n+2){",f.g.classes.margin_near("10px"),";}}.external-description{margin-bottom:30px;.course-field-label{font-weight:700;}}.register-btn{flex-shrink:3;}._next{flex-shrink:1;}@media (max-height: ",f.g.consts.MIN_FORM_HEIGHT_MOBILE,"px){.external-description{margin-bottom:5px;}.title{font-size:15px;}}",""),x=(0,n.observer)((function(e){var t;let{onClose:i,group_id:n,user_id:m,approvalRequest:b,request_id:f,ect_id:x,performApprovalAction:Z,manager_register:C,ectName:S,edit:O=!1,createNew:B=!1}=e;const[T,N]=(0,r.useState)("external"),[I,D]=(0,r.useState)(O),j=[];C=C||"RegExtMgr"===(null==b?void 0:b.type);const P=(0,r.useRef)(null),z=(0,r.useRef)(null);z.current||(z.current=new u.En({group_id:n,user_id:m,manager_register:C,approvalRequest:b,request_id:f,ect_id:x,ectName:S,editMode:I,createNew:B,readOnly:!B&&!I,onSaveSuccess:()=>(i(),D(!1))}));const E=z.current;E.haveUncompletedRequiredGroups&&(E.disabled=!0);const R={participants:lng("participants"),external:lng("details"),additional:lng("additional details"),funding:lng("funding"),requestDetails:lng("request details")},F=[...E.errors.keys()],M=e=>F&&(0,g.oH)(e.fields,(e=>(null==e?void 0:e.name)&&F.includes(e.name)));for(const e of E._fields)if("section"===e.type)for(const t of e.fields)if(!1!==t.insert&&"title"!==t.type&&t.visible()){j.push({val:e.name,label:R[e.name]||"?",error:M(e)});break}!(null==b||!b.request_id)&&j.push({val:"requestDetails",label:lng("request details"),index:null==j?void 0:j.length}),null!=b&&null!==(t=b.buttons)&&void 0!==t&&t.history&&j.push({val:"previouslyApproved",label:lng("previously approved"),index:null==j?void 0:j.length});const A=j.filter(((e,t)=>(e.index=t,e.val===T)))[0],q=j.filter(((e,t)=>t===(null==A?void 0:A.index)+1))[0],X=!E.status&&(0,y.BX)("div",{className:"row",children:[E.confirmButtonLabel&&!!(x||n||I)&&(0,y.tZ)(p.O,{className:"register-btn",primary:!0,onClick:E.callSave,highlight:E.dirty,disabled:E.disabled,style:{whiteSpace:"nowrap"},children:E.confirmButtonLabel}),q&&(0,y.BX)(p.O,{className:"_next",onClick:()=>N(q.val),children:[lng("continue to %s",q.label).caps()," ",(0,y.tZ)(_.JO,{icon:"arrow_go_far"})]})]}),L=!E.status&&E.title;return(0,y.tZ)(s.d,{from:"side",onClose:i,ref:P,scroll:!0,children:(0,y.tZ)(c.q3.Provider,{value:E,children:(0,y.tZ)(a.W2,{head:(0,y.tZ)(a.$0,{title:L,onClose:()=>(P.current.close(),D(!1))}),stickyHead:!0,children:!E.ready||E.status?(0,y.tZ)(l.$,{}):(0,y.BX)("div",{css:w,children:[(0,y.BX)("div",{className:"row",children:[S?null:(0,y.tZ)("span",{className:"title",children:E.ectName}),f&&Blsm.user.isPowerManager&&!B&&(0,y.tZ)(_.JO,{icon:"edit",onClick:()=>(D(!I),z.current=null)})]}),(0,y.BX)("div",{children:[(0,y.tZ)(k,{text:E.ectData.ect_description,label:lng("description").caps()}),(0,y.tZ)(k,{text:E.ectData.ect_extra_info,label:lng("extra info").caps()})]}),j.length>1&&(0,y.tZ)(o.m,{stickyTabs:!0,tabs:j,onSelect:N,activeTab:T}),!["requestDetails","previouslyApproved"].includes(T)&&(0,y.tZ)(d.au,{input:E.getFieldByName(T)}),"requestDetails"===T&&(0,y.tZ)(h.rl,{approvalRequest:b,performAction:Z}),"previouslyApproved"===T&&(0,y.tZ)(h.Om,{...b,forceMobileView:!0}),(0,y.tZ)("div",{children:X}),(0,y.tZ)(v._o,{})]})})})})})),k=e=>{let{label:t,text:i}=e;return(0,y.BX)("div",{className:"external-description",children:[(0,y.tZ)("span",{className:"course-field-label",children:t}),(0,y.tZ)(b.xn,{content:i})]})}},5562:(e,t,i)=>{i.d(t,{Jx:()=>g,L0:()=>h,RN:()=>v,Td:()=>u});var n=i(9180),r=i(917),s=i(6920),o=(i(7882),i(5311)),a=i(1619),l=i(8432),c=i(441),d=i(5944);const p=e=>(0,r.iv)("position:relative;display:flex;",!e&&"margin-bottom: 23px;"," margin-top:24px;",e&&"margin: auto;"," ",e&&`border-top: 1px solid ${s.g.colors.separator};`," text-align:center;",""),u=e=>{let{regType:t,groupType:i,instances:n,members:r,remainingPlaces:s,inCard:a}=e;return(0,d.BX)("div",{css:p(a),className:"row numbers",children:["Course_template"!==i&&r>0&&(0,d.tZ)(g,{number:r,text:lng("members").caps()}),(0,d.tZ)(o.zh,{}),"Course_template"!==i&&void 0!==s&&(0,d.tZ)(g,{number:s,text:lng("remaining places").caps()}),"Course_template"===i&&"reg_to_instances"===t&&a&&(0,d.tZ)(g,{number:n.length,text:lng("instances").caps()})]})},m=(0,r.iv)("margin:0 5px;.number{font-size:16px;color:",s.g.colors.text_sec,";margin:0 8px;}.description-text{font-size:13px;}",""),g=e=>{let{number:t,text:i,inLine:n}=e;return(0,d.BX)("div",{css:m,children:[parseInt(t)>=0?(0,d.tZ)("span",{className:"number",children:t}):(0,d.tZ)("span",{className:"number",children:"∞"}),!n&&(0,d.tZ)("br",{}),(0,d.tZ)("span",{className:"description-text",children:i})]})},h=e=>{let{start:t,end:i,title:r,className:s}=e;return(0,d.BX)("div",{className:s,children:[t&&i&&(0,d.BX)("div",{children:[r&&(0,d.BX)("span",{children:[r.caps(),": "]}),(0,d.BX)("span",{className:r?"description-text":"",children:[(0,d.tZ)(n.qp,{time:t,showTime:!1})," - ",(0,d.tZ)(n.qp,{time:i,showTime:!1})]})]}),t&&!i&&(0,d.BX)("span",{children:[lng("start date").caps(),": ",(0,d.tZ)(n.qp,{time:t,showTime:!1})]}),!t&&i&&(0,d.BX)("span",{children:[lng("end date").caps(),": ",(0,d.tZ)(n.qp,{time:i,showTime:!1})]})]})},b=e=>{let{fields:t,displayTitle:i}=e;return(0,d.BX)("div",{children:[t.length>0&&i&&(0,d.tZ)("b",{children:lng("custom fields").caps()}),t.length>0&&t.map(((e,t)=>(0,d.BX)("div",{className:"course-field",children:[e.label,": ",e.isHtml?(0,d.tZ)(a.xn,{className:"description-text",content:e.value}):(0,d.tZ)("span",{className:"description-text",children:e.value})," "]},t)))]})},v=e=>{let{courseInfo:t,displayTitle:i}=e;const{description:n,extra_info:r,estimated_cost_for_member:s,activityDates:o,passing_grade:p,CustomFieldsToDisplay:u,registerDependencies:m,registrationDates:g,statusInfo:v,priceTag:_,creditOnCompletion:f}=t;return(0,d.BX)("div",{children:[n.isHtml?(0,d.tZ)(a.xn,{content:null==n?void 0:n.text}):(0,d.tZ)("div",{children:null==n?void 0:n.text}),r&&(0,d.BX)("div",{className:"course-field",children:[lng("extra information").caps(),(0,d.tZ)(a.xn,{className:"description-text",content:r})]}),o&&(0,d.tZ)(h,{title:lng("activity dates"),className:"course-field",start:o.start,end:o.end}),_&&(0,d.tZ)("div",{children:_}),"FUTURE_REGISTRATION"===(null==v?void 0:v.status)&&(0,d.tZ)(h,{title:lng("registration dates"),className:"course-field",start:g.start,end:g.end}),s&&(0,d.BX)("div",{className:"course-field",children:[lng("estimated cost").caps(),": ",(0,d.tZ)("span",{className:"description-text",children:s})]}),p&&(0,d.BX)("div",{className:"course-field",children:[lng("required score").caps(),": ",(0,d.tZ)("span",{className:"description-text",children:p})]}),f>0&&(0,d.BX)("div",{className:"course-field",children:[lng("credit units given on completion").caps(),": ",(0,d.tZ)("span",{className:"description-text",children:f})]}),(0,d.tZ)(l.bP,{ws:t._attr,className:"course-field"}),m&&(0,d.BX)("div",{children:[(0,d.BX)("div",{className:"course-dependencies",children:[lng("course dependencies").caps(),":"]}),(0,d.tZ)("ul",{children:m.map((e=>(0,d.tZ)("li",{children:(0,d.tZ)(c.A,{theme:"highlight",href:{workspace:e.id},children:e.title})},e.id)))})]}),u&&(0,d.tZ)(b,{displayTitle:i,fields:u})]})}},4065:(e,t,i)=>{i.d(t,{m:()=>l});var n=i(5560),r=i(3205),s=(i(4210),i(8567)),o=i(8018),a=i(5944);const l=(0,n.observer)((function(e){let{onClose:t,form:i,internalForm:n,inDrawer:l}=e;if(!1===i.ready)return(0,a.tZ)(o.F,{});i.rebuild;const c=e=>{!i.dirty&&!i.alertBeforeClose||e?t():(0,s.BB)(i.dirty?lng("there are unsaved changes, are you sure you want to close the dialog?").caps():i.alertBeforeClose,{title:lng("discard changes"),confirmText:lng("close without saving").caps(),onConfirm:t,onCancel:()=>i.backFromDirty()})};return i.dialogClose=c,(0,a.tZ)(r.l,{form:i,onClose:c,internalForm:n,type:l?"drawer":"dialog"})}))},1615:(e,t,i)=>{i.d(t,{O:()=>de,P:()=>ae});var n=i(917),r=i(6920),s=i(6975),o=i(8318),a=i(5560),l=i(4773),c=(i(3835),i(3538)),d=i(7965),p=i(6421),u=(i(7041),i(5944));const m=(0,a.observer)((e=>{let{item:t}=e;return(0,u.BX)("div",{children:[t.parts.map((e=>(0,u.tZ)(h,{part:e},e.id))),(0,u.tZ)(de,{item:t,label:lng("add answer|editor"),type:"answer",text:lng("answer text|editor")})]})})),g=(0,n.iv)("display:flex;margin:6px 0;position:relative;gap:5px;>.part-text{flex-grow:1;}>.sort-grip{position:absolute;",r.g.near,":-24px;top:9px;cursor:pointer;visibility:hidden;}>.remove-part{display:inline-flex;align-items:center;visibility:hidden;}&:hover:not(.deleted){>.remove-part{visibility:visible;}>.sort-grip{visibility:visible;}}&.deleted{&:after{content:'",lng("deleted|editor").caps()," (",lng("click to restore|editor"),")';position:absolute;left:0;top:0;background-color:",r.g.colors.half_gray,";color:",r.g.colors.negative,";height:100%;width:100%;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:1.2em;font-weight:600;}}",""),h=(0,a.observer)((function(e){let{part:t}=e;const i=t.Manager.Content.typeIs("test");return(0,u.BX)("div",{css:g,className:(0,o.AK)({deleted:t.data.deleted}),onClick:t.data.deleted?()=>t.change("deleted",null):void 0,children:[(0,u.tZ)(d.E.span,{whileHover:{rotate:90},className:"sort-grip",children:(0,u.tZ)(s.JO,{icon:"sort_grip",smallButtonLike:!0})}),i&&(0,u.tZ)(p.I,{type:"checkbox",value:t.data.part_value,onChange:e=>t.Item.changeAnswer(t,e),wrapped:!0,center:!0,iconTrue:"circle_dot",iconFalse:"circle",color:r.g.colors.text_main}),(0,u.tZ)(c.O3,{type:"richtext",value:t.text,onChange:e=>t.change("part_text",e),wrapped:!0,wrapperClassName:"part-text",autoHideToolbar:!0,toolbarOptions:{color:!0,font:!0,link:!0,list:!0,align:!0,media:!0,media_link:!0}}),(0,u.tZ)("div",{className:"remove-part",children:(0,u.tZ)(s.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete answer|editor")})})]})}));var b=i(1577);const v=()=>"";var _=i(2608),f=i(7363),y=i(5311);const w=(0,n.iv)(".table-container{display:flex;.table-scroll{overflow-x:auto;max-width:100%;}}table{border-collapse:separate;margin:6px 0;.table-column,.table-row,.table-cell{min-width:200px;padding:11px 13px;text-align:",r.g.near,";font-weight:normal;>div{display:flex;}input{border:none;background-color:transparent;}.remove-part{visibility:hidden;}&:hover{background-color:",r.g.colors.blue_shade,";.remove-part{visibility:visible;}}&.focus{border:1px solid ",r.g.colors.dominant_main,"!important;}}.table-column{background-color:",r.g.colors.bg_page_containers,";border:1px solid ",r.g.colors.bg_page_containers,";border-",r.g.far,":1px solid ",r.g.colors.separator,";&:nth-child(2){border-radius:7px 0 0 0;}&:last-child{border-color:",r.g.colors.bg_page_containers,";border-radius:0 7px 0 0;}}.corner-cell,.table-row{position:sticky;",r.g.near,":0;background:white;z-index:1;}.table-row{border:1px solid ",r.g.colors.separator,";border-bottom-color:white;}.table-cell{border:1px solid ",r.g.colors.separator,";border-",r.g.near,":none;border-bottom:none;text-align:center;}tr:nth-child(2) .table-row{border-radius:7px 0 0 0;border-bottom-color:white;}tr:last-child{.table-row{border-bottom:1px solid ",r.g.colors.separator,";border-radius:0 0 0 7px;}.table-cell{border-bottom:1px solid ",r.g.colors.separator,";&:last-child{border-radius:0 0 7px 0;}}}}",""),x=(0,a.observer)((function(e){let{item:t}=e;return(0,u.BX)("div",{css:w,children:[(0,u.BX)(y.c_,{children:[(0,u.tZ)(de,{item:t,label:lng("add row|editor"),type:"row",text:lng("row text|editor")}),(0,u.tZ)(y.zh,{}),(0,u.tZ)(de,{item:t,label:lng("add column|editor"),type:"column",text:lng("column text|editor")})]}),(0,u.tZ)("div",{className:"table-container",children:(0,u.tZ)("div",{className:"table-scroll",children:(0,u.tZ)("table",{children:(0,u.BX)("tbody",{children:[(0,u.BX)("tr",{children:[(0,u.tZ)("td",{className:"corner-cell"}),t.typeObject.columnParts.map((e=>(0,u.tZ)(k,{col:e},e.id)))]}),t.typeObject.rowParts.map((e=>(0,u.BX)("tr",{children:[(0,u.tZ)(Z,{row:e}),t.typeObject.columnParts.map((t=>(0,u.tZ)(C,{row:e,col:t},`${e.id} ${t.id}`)))]},e.id)))]})})})})]})})),k=(0,a.observer)((function(e){let{col:t}=e;const[i,n]=(0,f.useState)(!1),r=t.Item.typeObject.columnParts.length>1;return(0,u.tZ)("td",{className:(0,o.AK)("table-column",{focus:i}),children:(0,u.BX)("div",{children:[(0,u.tZ)(c.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),onFocus:()=>n(!0),onBlur:()=>n(!1)}),r&&(0,u.tZ)("div",{className:"remove-part",children:(0,u.tZ)(s.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete column|editor")})})]})})})),Z=(0,a.observer)((function(e){let{row:t}=e;const[i,n]=(0,f.useState)(!1),r=t.Item.typeObject.rowParts.length>1;return(0,u.tZ)("td",{className:(0,o.AK)("table-row",{focus:i}),children:(0,u.BX)("div",{children:[(0,u.tZ)(c.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),onFocus:()=>n(!0),onBlur:()=>n(!1)}),r&&(0,u.tZ)("div",{className:"remove-part",children:(0,u.tZ)(s.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete row|editor")})})]})})})),C=(0,a.observer)((function(e){var t,i,n;let s,{row:a,col:l}=e;return s=a.Item.dataByName("item_options.multiple")&&null!==(t=a.data.part_value)&&void 0!==t&&t.list?null===(i=a.data.part_value)||void 0===i?void 0:i.list.some((e=>l.matchId(e))):l.matchId(null===(n=a.data.part_value)||void 0===n?void 0:n.col),(0,u.tZ)("td",{className:(0,o.AK)("table-cell"),children:(0,u.tZ)(p.I,{type:"checkbox",value:s,onChange:e=>a.Item.changeAnswer(a,[e,l.id]),wrapped:!0,center:!0,iconTrue:"circle_dot",iconFalse:"circle",color:r.g.colors.text_main})})}));const S=(0,a.observer)((e=>{let{item:t}=e;const i=t.dataByName("item_options.phrases"),n=[{val:"0",label:lng("search for at least one of the words|editor").caps()},{val:"1",label:lng("search for all words|editor").caps()}];return(0,u.tZ)("div",{children:i&&(0,u.BX)("div",{children:[(0,u.tZ)("div",{style:{fontWeight:600,fontSize:"1.1em",marginTop:"10px"},children:lng("phrases|editor").caps()}),(0,u.tZ)("div",{children:(0,u.tZ)(p.I,{type:"checkbox",value:t.dataByName("item_options.matchCase"),onChange:e=>t.change("item_options.matchCase",e),wrapped:!0,label:lng("match case|editor")})}),(0,u.tZ)("div",{children:(0,u.tZ)(p.I,{type:"checkbox",value:t.dataByName("item_options.matchWholeWord"),onChange:e=>t.change("item_options.matchWholeWord",e),wrapped:!0,label:lng("match whole word|editor")})}),(0,u.tZ)("div",{children:(0,u.tZ)(p.I,{type:"switcher",value:t.dataByName("item_options.allWords"),options:n,onChange:e=>t.change("item_options.allWords",e),wrapped:!0,labelFirst:!0})}),t.parts.filter((e=>!e.data.deleted)).map((e=>(0,u.tZ)(B,{part:e},e.id))),(0,u.tZ)(de,{item:t,label:lng("add phrase|editor"),type:"phrase",text:lng("phrase text|editor")})]})})})),O={name:"176u5h0",styles:"display:flex;margin:6px 0;position:relative;gap:5px;>.part-text{flex-grow:1;}>.remove-part{display:inline-flex;align-items:center;visibility:hidden;}&:hover{>.remove-part{visibility:visible;}>.sort-grip{visibility:visible;}}"},B=(0,a.observer)((function(e){let{part:t}=e;return(0,u.BX)("div",{css:O,children:[(0,u.tZ)(c.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),wrapped:!0,wrapperClassName:"part-text"}),(0,u.tZ)("div",{className:"remove-part",children:(0,u.tZ)(s.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete phrase|editor")})})]})}));var T=i(2808),N=i(8567),I=i(3550);const D=(0,a.observer)((function(e){let{item:t}=e;const i=[...t.partList].sort(((e,t)=>e.data.part_order-t.data.part_order));return(0,u.BX)(u.HY,{children:[(0,u.tZ)(I.b,{onSort:t.typeObject.reorder,children:i.map((e=>(0,u.tZ)(P,{part:e,moveUp:()=>t.typeObject.moveUp(e),moveDown:()=>t.typeObject.moveDown(e)},e.id)))}),(0,u.tZ)(de,{item:t,label:lng("add answer|editor"),type:"answer",text:lng("insert answer|editor")},"add")]})})),j=(0,n.iv)("display:flex;margin:6px 0;position:relative;gap:5px;>._sort_grip{position:absolute;",r.g.near,":-24px;top:9px;cursor:pointer;visibility:hidden;}>._answer_move{display:flex;flex-direction:column;}>._part_text{flex-grow:1;}>._remove_part{display:inline-flex;align-items:center;visibility:hidden;}&:hover:not(._deleted){>._remove_part{visibility:visible;}>._sort_grip{visibility:visible;}}&._deleted{&:after{content:'",lng("deleted|editor").caps()," (",lng("click to restore|editor"),")';position:absolute;left:0;top:0;background-color:",r.g.colors.half_gray,";color:",r.g.colors.negative,";height:100%;width:100%;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:1.2em;font-weight:600;}}",""),P=(0,a.observer)((function(e){let{part:t,moveUp:i,moveDown:n}=e;const r=(0,f.useContext)(I.y),a=t.data.part_order,l=r?r.attributes:{},p=r?r.listeners:{};return(0,u.BX)("div",{css:j,className:(0,o.AK)({_deleted:t.data.deleted}),onClick:t.data.deleted?()=>t.change("deleted",null):void 0,children:[(0,u.tZ)(d.E.span,{whileHover:{rotate:90},className:"_sort_grip",...l,...p,children:(0,u.tZ)(s.JO,{icon:"sort_grip",smallButtonLike:!0})}),(0,u.BX)(d.E.div,{className:"_answer_move",initial:{opacity:0},animate:{opacity:1},children:[(0,u.tZ)(s.JO,{icon:"arrow_up",smallButtonLike:!0,disabled:1===a,onClick:i}),(0,u.tZ)(s.JO,{icon:"arrow_down",smallButtonLike:!0,disabled:a===t.Item.parts.length,onClick:n})]}),(0,u.tZ)(c.O3,{type:"richtext",value:t.text,onChange:e=>t.change("part_text",e),wrapped:!0,wrapperClassName:"_part_text",autoHideToolbar:!0,toolbarOptions:{color:!0,font:!0,link:!0,list:!0,align:!0,media:!0,media_link:!0}}),(0,u.tZ)("div",{className:"_remove_part",children:(0,u.tZ)(s.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete answer|editor")})})]})}));var z=i(2334);const E=(0,n.iv)("display:flex;flex-direction:row;._field_wrapper{flex:1;margin:5px 0;+._field_wrapper{",r.g.classes.margin_near("5px"),";}}",""),R=(0,a.observer)((function(e){let{item:t}=e;const i=t.dataByName("item_options.from")?()=>(0,z._3)(t.dataByName("item_options.from")):void 0,n=t.dataByName("item_options.to")&&t.dataByName("item_options.range")?()=>(0,z._3)(t.dataByName("item_options.to")):void 0;return(0,u.BX)("div",{css:E,children:[(0,u.tZ)(p.I,{type:t.typeObject.inputType,label:t.typeObject.startTimeLabel,value:t.dataByName("item_options.from"),onChange:e=>t.change("item_options.from",e),maxDate:n,years:t.typeObject.yearsDisplayRange,noMinWidth:!0,wrapped:!0}),t.dataByName("item_options.range")&&(0,u.tZ)(u.HY,{children:(0,u.tZ)(p.I,{type:t.typeObject.inputType,label:lng("to|editor"),value:t.dataByName("item_options.to"),onChange:e=>t.change("item_options.to",e),minDate:i,years:t.typeObject.yearsDisplayRange,noMinWidth:!0,wrapped:!0})})]})}));var F=i(1776),M=i(2998),A=i(6746),q=i(7392),X=i(5680),L=i(1137),$=i(8207);const V=/<span data-blsm_placeholder[^>]*>[^>]*<\/span>/g,U={name:"1fa08kr",styles:"._instruction{margin:10px 0;font-style:italic;}._mark_word{display:inline-block;margin:10px 0;}"},H=(0,a.observer)((function(e){let{item:t}=e;const[i,n]=(0,f.useState)(),r=(0,f.useRef)(),[s,a]=(0,f.useState)(!1),l=(0,f.useRef)();(0,f.useEffect)((()=>{c()}),[]);const c=()=>{let e=t.dataByName("item_options.answer")||"";t.partListByType("answer").sort(((e,t)=>e.data.part_order-t.data.part_order)).forEach((t=>{e=e.replace("<span></span>",Q(t.data.part_text))})),n(e)};return(0,u.BX)("div",{css:U,children:[(0,u.BX)("div",{className:"_instruction",children:[lng("write the sentence(s) you want to appear in the question.").caps()," ",lng('highlight the word you want them to complete and press the button "Mark word".').caps()]}),(0,u.tZ)("div",{className:"_mark_word",ref:r}),(0,o.HD)(i)&&(0,u.tZ)(p.I,{type:"richtext",value:i,onChange:e=>{n(e),t.change("item_options.answer",e.replace(V,"<span></span>")),t.partListByType("answer").forEach((e=>e.change("deleted",1))),[...i.matchAll(V)].forEach(((e,i)=>{t.addPart(t.createPart({part_text:ee(e[0]),part_value:i+1,part_order:i+1,item_id:t.data.item_id,item_internal:t.internalId}))}))},wrapped:!0,placeholder:lng("sentence to complete").caps(),toolbarOptions:{placeholders:{}},outsideActions:[{name:"mark_word",component:e=>(0,u.tZ)(G,{...e}),ref:r}]}),(0,u.BX)(X.r$,{children:[t.partListByType("distraction").map((e=>(0,u.tZ)(Y,{part:e},e.id))),(0,u.tZ)(de,{item:t,label:lng("add distraction"),type:"distraction",text:lng("insert distraction"),onClick:()=>{(0,N.cS)("",{title:lng("add distraction"),startValue:"",inputType:"text",inputRequired:!0,valueValid:e=>!t.parts.some((t=>t.text===e)),onConfirm:e=>t.newPart("distraction",e,{addLength:!1})})}},"add"),(0,u.tZ)(de,{item:t,label:lng("edit"),icon:"edit",onClick:()=>a(!0)})]}),s&&(0,u.tZ)(L.d,{from:"side",onClose:()=>a(!1),ref:l,scroll:!0,children:(0,u.BX)($.W2,{head:(0,u.tZ)($.$0,{title:lng("edit distractions"),onClose:()=>l.current.close()}),children:[(0,u.tZ)("div",{children:lng("you can edit, delete and add distractions").caps()}),t.partListByType("distraction").map((e=>(0,u.tZ)(K,{part:e},e.id))),(0,u.tZ)(de,{item:t,label:lng("add distraction"),type:"distraction",text:lng("insert distraction")},"add")]})})]})})),J=(0,M.createCommand)("MARK_WORD_COMMAND"),G=(0,a.observer)((function(e){let{editor:t}=e;return(0,f.useEffect)((()=>{t.registerCommand(J,(()=>{const e=(0,M.$getSelection)();(0,M.$isRangeSelection)(e)&&t.dispatchCommand(A.Py,{text:e.getTextContent()})}),M.COMMAND_PRIORITY_EDITOR)}),[]),(0,u.tZ)(q.l,{theme:"outlined",onClick:()=>t.dispatchCommand(J,{}),children:lng("mark word").caps()})})),W=(0,n.iv)("display:flex;margin:6px 0;position:relative;gap:5px;>._part_text{flex-grow:1;}>._remove_part{display:inline-flex;align-items:center;visibility:hidden;}&:hover:not(._deleted){>._remove_part{visibility:visible;}}&._deleted{&:after{content:'",lng("deleted").caps()," (",lng("click to restore"),")';position:absolute;left:0;top:0;background-color:",r.g.colors.half_gray,";color:",r.g.colors.negative,";height:100%;width:100%;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:1.2em;font-weight:600;}}",""),K=(0,a.observer)((function(e){let{part:t}=e;return(0,u.BX)("div",{css:W,className:(0,o.AK)({_deleted:t.data.deleted}),onClick:t.data.deleted?()=>t.change("deleted",null):void 0,children:[(0,u.tZ)(c.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),wrapped:!0,wrapperClassName:"_part_text"}),(0,u.tZ)("div",{className:"_remove_part",children:(0,u.tZ)(s.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete answer")})})]})})),Y=(0,a.observer)((function(e){let{part:t}=e;return(0,u.tZ)(X.Vp,{tag:t.text,color:t.data.deleted?r.g.colors.disabled_background:void 0,onRemove:e=>(e.stopPropagation(),t.change("deleted",1))})})),Q=e=>{const t=document.createElement("span");return t.setAttribute("data-blsm_placeholder",e),t.innerHTML=e,t.outerHTML},ee=e=>{const t=document.createElement("div");return t.innerHTML=e,t.textContent},te=(0,a.observer)((function(e){let{item:t}=e;return(0,u.BX)("div",{children:[t.parts.map((e=>(0,u.tZ)(ne,{part:e},e.id))),(0,u.tZ)(de,{item:t,label:lng("add check row|editor"),type:"check",text:lng("text|editor")})]})})),ie=(0,n.iv)("display:flex;margin:6px 0;position:relative;gap:5px;align-items:center;>.part-text{flex-grow:1;}>.remove-part{display:inline-flex;align-items:center;visibility:hidden;}&:hover:not(.deleted){>.remove-part{visibility:visible;}}.checker{font-size:1.8em;color:",r.g.colors.blossom,";}",""),ne=(0,a.observer)((function(e){let{part:t}=e;return(0,u.BX)("div",{css:ie,children:[(0,u.tZ)(s.JO,{icon:"checkbox_checked",className:"checker"}),(0,u.tZ)(c.O3,{type:"richtext",value:t.text,onChange:e=>t.change("part_text",e),wrapped:!0,wrapperClassName:"part-text",autoHideToolbar:!0,toolbarOptions:{color:!0,font:!0,link:!0,align:!0}}),(0,u.tZ)("div",{className:"remove-part",children:(0,u.tZ)(s.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("remove check row|editor")})})]})}));var re=i(441);const se=r.g.colors.purple,oe=(0,n.iv)("background-image:linear-gradient(180deg, ",se,", ",se," 175px, transparent 175px, transparent);padding:15px 12px;border-radius:20px 20px 0 0;>.index{color:white;font-size:2em;font-weight:700;padding:0 10px 15px;}>.main{background-color:",r.g.colors.bg_main,";box-shadow:rgba(100, 100, 111, 0.2) 0px 7px 29px 0px;border-radius:20px;>.head{height:65px;padding:0 48px;background-color:",r.g.colors.bg_page_containers,";border-radius:20px 20px 0 0;display:flex;align-items:center;>.type-display{min-width:200px;background-color:#FFF;border-radius:15px;padding:3px 18px;border:1px solid ",r.g.colors.separator,";}}>.content-top{padding:7px 48px;display:flex;flex-direction:column;gap:10px;>.actions{display:flex;justify-content:end;font-size:20px;color:",r.g.colors.text_sec,";}>.description{display:flex;margin:6px 0;gap:5px;align-items:center;>.item-description{flex-grow:1;}>.hide-description>.Icon{margin:0 0 calc(100% + 9px);}}}>.content-mid{padding:7px 48px 15px;}>.content-bottom{padding:7px 48px 25px;}}&.deleted{&:after{content:'",lng("deleted|editor").caps()," (",lng("click to restore|editor"),")';position:absolute;left:0;top:0;background-color:",r.g.colors.half_gray,";color:",r.g.colors.negative,";height:100%;width:100%;border-radius:20px;display:flex;align-items:center;justify-content:center;font-size:1.2em;font-weight:600;z-index:1;}}",""),ae=(0,a.observer)((e=>{var t;let{item:i}=e;const n=(0,l.P8)(),{globalItemOrder:a,typeIcon:d,typeName:p,showDescription:m}=i,g=i.dataByName("item_options.hide_description");return(0,u.BX)("div",{css:oe,className:(0,o.AK)({deleted:i.data.deleted}),onClick:i.data.deleted?()=>i.change("deleted",null):void 0,children:[(0,u.tZ)("div",{className:"index",children:a}),(0,u.BX)("div",{className:"main",children:[(0,u.BX)("div",{className:"head",children:[(0,u.BX)("div",{className:"type-display",children:[(0,u.tZ)(s.JO,{icon:d}),"  ",(0,u.tZ)("span",{className:"label",children:p.caps()})]}),(0,u.tZ)("div",{css:r.g.classes.flex_grow})]}),(0,u.BX)("div",{className:"content-top",children:[(0,u.tZ)("div",{className:"actions",children:null!==(t=i.typeObject.renderActions)&&void 0!==t?t:(0,u.BX)(u.HY,{children:[(0,u.tZ)(s.JO,{icon:"bookmark",buttonLike:!0}),(0,u.tZ)(s.JO,{icon:"mng_settings",buttonLike:!0,onClick:()=>n.setItemDrawer("item_settings",!0),toolTip:lng("item settings|editor")}),(0,u.tZ)(s.Xs,{icon:"info",value:m,onClick:()=>i.showDescription=!m,toolTip:lng("toggle description|editor")}),(0,u.BX)("label",{children:[(0,u.tZ)("input",{type:"file",name:"file",multiple:!0,onChange:e=>i.fileSelect(e),style:{opacity:0,width:0}}),(0,u.tZ)(s.JO,{icon:"attachment",buttonLike:!0})]}),(0,u.tZ)(s.JO,{icon:"copy",buttonLike:!0,onClick:()=>n.Content.ItemF.duplicate(),toolTip:lng("duplicate item|editor")}),(0,u.tZ)(s.JO,{icon:"trash",buttonLike:!0,onClick:()=>i.change("deleted",1),toolTip:lng("remove item|editor")})]})}),(0,u.tZ)(c.O3,{type:"text",label:c.Ql.item_text,wrapped:!0,value:i.dataByName("item_text"),onChange:e=>i.change("item_text",e)}),m&&(0,u.BX)("div",{className:"description",children:[(0,u.tZ)(c.O3,{type:"richtext",label:c.Ql.item_description,wrapped:!0,wrapperClassName:"item-description",value:i.dataByName("item_description"),onChange:e=>i.change("item_description",e),toolbarOptions:{color:!0,font:!0,link:!0,list:!0,align:!0,media:!0,media_link:!0}}),(0,u.tZ)("div",{className:"hide-description",children:(0,u.tZ)(s.JO,{icon:"preview"+(g?"-off":""),toolTip:g?lng("show description to user|editor"):lng("hide description from user|editor"),onClick:()=>i.change("item_options.hide_description",+!g),buttonLike:!0})})]})]}),(0,u.tZ)("div",{className:"content-mid",children:(0,u.tZ)(le,{item:i})}),(0,u.tZ)("div",{className:"content-bottom",children:(0,u.tZ)(ue,{item:i})})]})]})})),le=(0,a.observer)((function(e){let{item:t}=e;switch(t.type){case"multiple_choice":return(0,u.tZ)(m,{item:t});case"completion":return(0,u.tZ)(H,{item:t});case"sorting":return(0,u.tZ)(D,{item:t});case"single_textbox":return(0,u.tZ)(S,{item:t});case"rating_scale":return(0,u.tZ)(x,{item:t});case"matching":return(0,u.tZ)(b.a,{item:t});case"hotspot":return(0,u.tZ)(F.U,{item:t});case"table_question":return(0,u.tZ)(_.h,{item:t});case"date_time":return(0,u.tZ)(R,{item:t});case"paragraph":return(0,u.tZ)(v,{item:t});case"user_field":case"signature":break;case"checklist":return(0,u.tZ)(te,{item:t})}return"missing"})),ce=e=>(0,n.iv)("padding:5px;border-radius:6px;cursor:pointer;margin-top:5px;display:inline-block;border:1px solid transparent;",e?`color: ${e};border: 1px solid ${e};`:`border: 1px solid ${r.g.colors.separator_light};`,">.Icon{padding:0 3px;}>span{padding:0 5px;}&:hover{",e?`background-color: ${e};color: #FFF;`:`background-color: ${r.g.colors.dominant_main_shade}; border: 1px solid ${r.g.colors.light_blue2}; color: ${r.g.colors.light_blue};`,";}",""),de=e=>{let{item:t,label:i,color:n,type:r,onClick:o,text:a,icon:l="mark_plus"}=e;return(0,u.BX)("div",{css:ce(n),onClick:o||(()=>t.newPart(r,a)),children:[(0,u.tZ)(s.JO,{icon:l}),(0,u.tZ)("span",{children:i.caps()})]})},pe=(0,n.iv)("display:flex;gap:5px;flex-wrap:wrap;>div{padding:5px 10px;background-color:",r.g.colors.bg_page_containers,";border:1px solid ",r.g.colors.separator,";border-radius:10px;display:flex;justify-content:center;align-items:center;gap:5px;}",""),ue=(0,a.observer)((function(e){let{item:t}=e;if(!t.files.length)return;return(0,u.tZ)("div",{css:pe,children:t.files.filter((e=>!e.deleted)).map((e=>{const i=e.name||e.file_name;return(0,u.BX)("div",{children:[(0,u.tZ)(s.JO,{icon:(0,T.DW)(i,!0)}),e.link?(0,u.tZ)(re.A,{href:{file:e},"data-preview":(0,T.BX)(e.file_name),toolTip:e.file_name,children:i}):(0,u.tZ)("span",{children:i}),(0,u.tZ)(s.JO,{icon:"close_circle",onClick:()=>{return i=e,void(0,N.BB)(lng("are you sure you want to delete this file?|editor").caps(),{onConfirm:()=>t.fileDelete(i)});var i},toolTip:lng("delete file|editor")})]},e.id||e.file_id)}))})}))},1776:(e,t,i)=>{i.d(t,{U:()=>b,w:()=>w});var n=i(917),r=i(7363),s=i(5560),o=(i(3835),i(6920)),a=i(7828),l=i(7965),c=i(6975),d=i(3530),p=i(8318),u=i(81),m=i(5944);const g=(0,n.iv)(".selector{width:240px;height:240px;margin:0 auto;background-color:",o.g.colors.bg_1,";border-radius:15px;cursor:pointer;display:flex;justify-content:center;align-items:center;color:",o.g.colors.dominant_main,";font-size:1.3em;&:hover{background-color:",o.g.colors.bg_2,";}}.bg{display:flex;position:relative;>.container{display:table;>*{display:table-row;}>.area-control{margin:5px 0;display:flex;}>.image-wrapper{position:relative;overflow:hidden;display:inline-block;direction:ltr;text-align:left;>img{max-width:100%;max-height:80vh;user-select:none;border-radius:15px;}>.remove-image{position:absolute;top:5px;left:5px;}}}}",""),h={type:"",spot:null,dir:null,origin:null},b=(0,s.observer)((function(e){let{item:t}=e;const[i,n]=(0,r.useState)(h),[s,o]=(0,r.useState)(!0),[p,u]=(0,r.useState)(),b=(0,r.useRef)();let v=t.typeObject.image;return(0,m.BX)("div",{css:g,children:[(0,m.tZ)("input",{type:"file",style:{display:"none"},accept:Blsm.prm.extensions.img.map((e=>"."+e)).join(","),onChange:t.typeObject.hotSpotFile,ref:b}),(0,m.tZ)(a.M,{initial:!1,children:v?(0,m.tZ)(l.E.div,{variants:{start:{opacity:0},open:{opacity:1,transition:{duration:.5,delay:.5}},close:{opacity:0,transition:{duration:.5}}},initial:"start",animate:"open",exit:"close",children:(0,m.tZ)("div",{className:"bg",children:(0,m.BX)("div",{className:"container",children:[(0,m.BX)("div",{className:"area-control",children:[(0,m.BX)("div",{style:{flex:1,textAlign:"start"},children:[lng("number of areas|editor").caps(),": ",t.typeObject.spots.length," ",t.typeObject.spots.length>0&&(0,m.tZ)(c.JO,{icon:"clear",toolTip:lng("clear all|editor"),onClick:()=>t.typeObject.spots.forEach((e=>e.change("deleted",1)))})]}),(0,m.tZ)("div",{style:{flex:1,textAlign:"end"},children:(0,m.BX)("div",{style:{display:"inline-block",cursor:"pointer"},onClick:()=>b.current.click(),children:[(0,m.tZ)(c.JO,{icon:"edit"})," ",lng("change image|editor").caps()]})})]}),(0,m.BX)("div",{className:"image-wrapper",onMouseDown:e=>{if(0===e.button)if(e.stopPropagation(),i.type)n(h);else if(p)u(void 0);else{const{x:i,y:r}=w(e),s=t.typeObject.newSpot(new d.z(i,r));n({type:"new",spot:s,dir:null,origin:null}),u(s.id)}},onMouseMove:e=>{e.stopPropagation(),i.type&&("move"===i.type?t.typeObject.moveSpot(e,i):"resize"===i.type&&t.typeObject.resizeSpot(e,i))},onMouseUp:e=>{0===e.button&&(e.stopPropagation(),i.type&&("move"===i.type&&t.typeObject.moveSpot(e,i),n(h)))},children:[(0,m.tZ)(l.E.img,{initial:{height:240},animate:{height:s?240:"auto"},onLoad:()=>o(!1),src:v,draggable:!1,style:{cursor:p?"default":"crosshair"}}),t.typeObject.spots.map((e=>(0,m.tZ)(y,{id:e.id,spot:e,setAction:n,action:i,onDelete:()=>e.change("deleted",1),isSelected:p===e.id,onSelect:()=>u(e.id)},e.id))),(0,m.tZ)(c.JO,{icon:"trash",className:"remove-image",toolTip:lng("remove image|editor"),onClick:()=>t.typeObject.file={},onMouseDown:x,smallButtonLike:!0})]})]})})},"bg"):(0,m.tZ)(_,{item:t,fileInput:b})})]})})),v=(0,n.iv)("width:calc(100% - 30px);height:200px;margin-bottom:50px;._instruction{margin:20px 0;font-style:italic;}._input{height:100%;outline:5px dashed ",o.g.colors.bg_2,";padding-top:80px;justify-content:center;text-align:center;color:",o.g.colors.text_sec,";border-radius:10px;}",""),_=(0,s.observer)((function(e){let{fileInput:t}=e;const{dndEvents:i}=(0,u.aZ)((e=>(t.current.files=e,t.current.dispatchEvent(new Event("change",{bubbles:!0}))))),[n,s]=(0,r.useState)(!1);return(0,m.BX)("div",{css:v,children:[(0,m.tZ)("div",{className:"_instruction",children:lng("upload an image and mark the areas that you'd like the respondent to mark|editor").caps()}),(0,m.BX)("div",{className:"_input",onClick:()=>t.current.click(),...i,onDragOver:e=>((e=>{e.stopPropagation(),s(!0)})(e),i.onDragOver(e)),onDragLeave:()=>s(!1),children:[(0,m.tZ)(c.JO,{icon:"image",color:o.g.colors.text_light_disabled}),(0,m.tZ)("div",{children:n?lng("drop the image here|editor").caps():lng("drag or upload your image|editor").caps()})]})]})})),f={name:"fanoa",styles:"border:2px dashed #FFF;outline:1px dashed #432;position:absolute;background-color:rgba(255, 255, 255, .3);opacity:0.5;mix-blend-mode:difference;border-radius:12px;&._selected{border:1px solid #FFF;outline:unset;background-color:rgba(255, 255, 255, .5);cursor:move;border-radius:0;}.move-drag{position:absolute;top:calc(50% - 9px);left:calc(50% - 7px);cursor:move;}.resize-right{position:absolute;right:-2px;height:100%;width:5px;cursor:e-resize;}.resize-bottom{position:absolute;bottom:-2px;width:100%;height:5px;cursor:s-resize;}.resize-corner{position:absolute;bottom:-3px;right:-3px;height:10px;width:10px;cursor:se-resize;}._resize_point{position:absolute;height:10px;width:10px;border-radius:50%;background-color:#FFF;&._right_top{top:-5px;right:-5px;cursor:ne-resize;}&._right{top:calc(50% - 5px);right:-5px;cursor:e-resize;}&._right_bottom{bottom:-5px;right:-5px;cursor:se-resize;}&._bottom{bottom:-5px;left:calc(50% - 5px);cursor:s-resize;}&._left_bottom{bottom:-5px;left:-5px;cursor:sw-resize;}&._left{top:calc(50% - 5px);left:-5px;cursor:w-resize;}&._left_top{top:-5px;left:-5px;cursor:nw-resize;}&._top{top:-5px;left:calc(50% - 5px);cursor:n-resize;}}.remove{position:absolute;top:2px;left:2px;pointer-events:auto;}"},y=(0,s.observer)((e=>{let{spot:t,id:i,setAction:n,action:r,onDelete:s,isSelected:o,onSelect:a}=e;const l={...null==t?void 0:t.data.part_options,pointerEvents:r.type?"none":"auto"},d=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;0===e.button&&(x(e),"resize"===r.type?n(null):r.type||n({type:"resize",spot:t,id:i,origin:{point:{x:e.clientX,y:e.clientY},...t.data.part_options},dir:s}))};return(0,m.tZ)("div",{css:f,className:(0,p.AK)({_selected:o}),style:l,onMouseDown:e=>{if(o){if(0!==e.button)return;x(e),n({type:"move",spot:t,id:i,origin:{point:{x:e.clientX,y:e.clientY},...t.data.part_options}})}else e.stopPropagation(),a()},onMouseMove:x,onMouseUp:x,children:o&&(0,m.BX)(m.HY,{children:[(0,m.tZ)("div",{className:"_resize_point _right_top",onMouseDown:e=>d(e,"right_top")}),(0,m.tZ)("div",{className:"_resize_point _right",onMouseDown:e=>d(e,"right")}),(0,m.tZ)("div",{className:"_resize_point _right_bottom",onMouseDown:e=>d(e,"right_bottom")}),(0,m.tZ)("div",{className:"_resize_point _bottom",onMouseDown:e=>d(e,"bottom")}),(0,m.tZ)("div",{className:"_resize_point _left_bottom",onMouseDown:e=>d(e,"left_bottom")}),(0,m.tZ)("div",{className:"_resize_point _left",onMouseDown:e=>d(e,"left")}),(0,m.tZ)("div",{className:"_resize_point _left_top",onMouseDown:e=>d(e,"left_top")}),(0,m.tZ)("div",{className:"_resize_point _top",onMouseDown:e=>d(e,"top")}),(0,m.tZ)(c.JO,{icon:"move",className:"move-drag"}),(0,m.tZ)(c.JO,{icon:"trash",onClick:s,onMouseDown:x,smallerButtonLike:!0})]})})})),w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=e.target.closest(".image-wrapper").getBoundingClientRect(),n=e.clientX-i.left,r=e.clientY-i.top;return"h"===t?{x:n}:"v"===t?{y:r}:{x:n,y:r}},x=e=>(e.stopPropagation(),e.preventDefault())},3530:(e,t,i)=>{i.d(t,{P:()=>v,z:()=>_});var n,r,s,o,a,l,c,d,p,u=i(9841),m=i(7821),g=i(8318);function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let v=(n=m.action.bound,r=class extends u.YZ{constructor(e,t){super(e),h(this,"file",s,this),(0,m.makeObservable)(this),t.file&&(this.file=t.file)}get settingsFields(){const e=[[1,lng("any|editor")]];for(let t=1;t<this.spots.length-1;t++)e.push([t+1,t+1]);return e.push([this.spots.length,lng("all|editor")]),[this.spots.length>1&&{type:"select",name:"item_options.required_selection",options:e,label:lng("required selection|editor")},{type:"sep"}].filter((e=>e))}get image(){var e;return this.file instanceof File?URL.createObjectURL(this.file):null!==(e=this.file)&&void 0!==e&&e.link?Blsm.prm.Mainref+this.file.link:null}hotSpotFile(e){const t=e.currentTarget.files[0];t&&(t.id=(0,g.zO)(8,"f_hs"),e.currentTarget.value=null,this.file=t,t.object_type="editor_item_hotspot",t.object_id=this.Item.id,this.Item.Manager.Content.addToChanges("files",t,t.id))}newSpot(e){return this.Item.newPart("spot","",{options:e})}moveSpot(e,t){let i=Object.assign({},t.spot.data.part_options);const n=e.clientX-t.origin.point.x;i.left=t.origin.left+n;const r=e.clientY-t.origin.point.y;i.top=t.origin.top+r,t.spot.modify("part_options",i),this.Item.Manager.Content.addToChanges("parts",t.spot.data,t.spot.internalId)}resizeSpot(e,t){let i=Object.assign({},t.spot.data.part_options);const n=e.clientY-t.origin.point.y,r=e.clientX-t.origin.point.x;switch(null==t?void 0:t.dir){case"top":i.height=Math.max(t.origin.height-n,10),i.top=t.origin.top+n;break;case"right_top":i.height=Math.max(t.origin.height-n,10),i.top=t.origin.top+n,i.width=Math.max(t.origin.width+r,10);break;case"right":i.width=Math.max(t.origin.width+r,10);break;case"right_bottom":i.height=Math.max(t.origin.height+n,10),i.width=Math.max(t.origin.width+r,10);break;case"bottom":i.height=Math.max(t.origin.height+n,10);break;case"left_bottom":i.height=Math.max(t.origin.height+n,10),i.width=Math.max(t.origin.width-r,10),i.left=t.origin.left+r;break;case"left":i.width=Math.max(t.origin.width-r,10),i.left=t.origin.left+r;break;case"left_top":i.height=Math.max(t.origin.height-n,10),i.top=t.origin.top+n,i.width=Math.max(t.origin.width-r,10),i.left=t.origin.left+r}t.spot.modify("part_options",i),this.Item.Manager.Content.addToChanges("parts",t.spot.data,t.spot.internalId)}get spots(){return this.Item.partListByType("spot")}selectAnswer(e){this.Item.answerData=new u.tQ({item_id:this.Item.id,value:[...this.selected,e],duration:""}),this.Item.Manager.sync(this.Item.answerData)}removeAnswer(e){let{x:t,y:i}=e;this.Item.answerData=new u.tQ({item_id:this.Item.id,value:this.selected.filter((e=>e.x!==t||e.y!==i)),duration:""}),this.Item.Manager.sync(this.Item.answerData)}get selected(){var e;return(null===(e=this.Item.answerData)||void 0===e?void 0:e.value)||[]}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}},s=b(r.prototype,"file",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),b(r.prototype,"settingsFields",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"settingsFields"),r.prototype),b(r.prototype,"image",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"image"),r.prototype),b(r.prototype,"hotSpotFile",[n],Object.getOwnPropertyDescriptor(r.prototype,"hotSpotFile"),r.prototype),b(r.prototype,"moveSpot",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"moveSpot"),r.prototype),b(r.prototype,"resizeSpot",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"resizeSpot"),r.prototype),b(r.prototype,"spots",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"spots"),r.prototype),b(r.prototype,"selectAnswer",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"selectAnswer"),r.prototype),b(r.prototype,"removeAnswer",[m.action],Object.getOwnPropertyDescriptor(r.prototype,"removeAnswer"),r.prototype),b(r.prototype,"selected",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"selected"),r.prototype),b(r.prototype,"progress",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"progress"),r.prototype),r),_=(a=b((o=class{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64;h(this,"left",a,this),h(this,"top",l,this),h(this,"height",c,this),h(this,"width",d,this),h(this,"done",p,this),(0,m.makeObservable)(this),this.top=t-i/2,this.left=e-n/2,this.height=i,this.width=n}}).prototype,"left",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=b(o.prototype,"top",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=b(o.prototype,"height",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=b(o.prototype,"width",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=b(o.prototype,"done",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o)},1577:(e,t,i)=>{i.d(t,{P:()=>d,a:()=>p});var n=i(5560),r=i(917),s=i(1615),o=i(6975),a=(i(3835),i(6920)),l=i(3538),c=(i(7041),i(5944));const d=(0,r.iv)("display:grid;grid-template-columns:1fr 20px 1fr;column-gap:10px;.static-col{grid-column:1;}.match-middle-col{grid-column:2;place-self:center;}.dynamic-col{grid-column:3;}&.play{row-gap:10px;.match-middle-col{.Icon{color:",a.g.colors.dominant_main,";font-size:1.3em;}}}",""),p=(0,n.observer)((function(e){let{item:t}=e;return(0,c.BX)("div",{css:d,children:[t.typeObject.staticParts.map(((e,t)=>(0,c.tZ)("div",{className:"static-col",style:{gridRow:t+1},children:(0,c.tZ)(m,{part:e})},e.id))),(0,c.tZ)("div",{className:"static-col",children:(0,c.tZ)(s.O,{item:t,label:lng("add match|editor"),color:a.g.colors.green,onClick:()=>t.typeObject.newMatch()})}),t.typeObject.staticParts.map(((e,t)=>(0,c.tZ)("div",{className:"match-middle-col",style:{gridRow:t+1},children:(0,c.tZ)(o.JO,{icon:"question_matching_arrows"})},e.id))),t.typeObject.dynamicParts.map(((e,t)=>(0,c.tZ)("div",{className:"dynamic-col",style:{gridRow:t+1},children:(0,c.tZ)(g,{part:e})},e.id))),(0,c.tZ)("div",{className:"dynamic-col",children:(0,c.tZ)(s.O,{item:t,label:lng("add distraction|editor"),onClick:()=>t.typeObject.newDynamic(t.typeObject.dynamicParts.length+1)})})]})})),u={name:"q7genp",styles:"display:flex;margin:6px 0;position:relative;gap:5px;>.part-text{flex-grow:1;}>.remove-part{display:inline-flex;align-items:center;visibility:hidden;}&:hover:not(.deleted){>.remove-part{visibility:visible;}}"},m=(0,n.observer)((function(e){let{part:t}=e;return(0,c.tZ)("div",{css:u,children:(0,c.tZ)(l.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),wrapped:!0,wrapperClassName:"part-text"})})})),g=(0,n.observer)((function(e){let{part:t}=e;const i=!(2===t.Item.typeObject.staticParts.length&&t.data.part_order<=2);return(0,c.BX)("div",{css:u,children:[(0,c.tZ)(l.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),wrapped:!0,wrapperClassName:"part-text"}),(0,c.tZ)("div",{className:"remove-part",children:i&&(0,c.tZ)(o.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.Item.typeObject.removePart(t),toolTip:lng("delete match row|editor")})})]})}))},2608:(e,t,i)=>{i.d(t,{h:()=>g,j:()=>m});var n=i(5560),r=i(917),s=(i(3835),i(6920)),o=i(3538),a=i(7363),l=i(8318),c=i(1615),d=i(6975),p=(i(7041),i(5311)),u=i(5944);const m=(0,r.iv)(".table-container{display:flex;.table-scroll{overflow-x:auto;max-width:100%;}}table{border-collapse:separate;margin:6px 0;.table-column,.table-row,.table-cell{min-width:200px;padding:11px 13px;text-align:",s.g.near,";font-weight:normal;>div{display:flex;}input{border:none;background-color:transparent;}.remove-part{visibility:hidden;}&:hover{background-color:",s.g.colors.blue_shade,";.remove-part{visibility:visible;}}&.focus{border:1px solid ",s.g.colors.dominant_main,"!important;}}.table-column{background-color:",s.g.colors.bg_page_containers,";border:1px solid ",s.g.colors.bg_page_containers,";border-",s.g.far,":1px solid ",s.g.colors.separator,";&:nth-child(2){border-radius:7px 0 0 0;}&:last-child{border-color:",s.g.colors.bg_page_containers,";border-radius:0 7px 0 0;}}.corner-cell,.table-row{position:sticky;",s.g.near,":0;background:white;z-index:1;}.table-row{border:1px solid ",s.g.colors.separator,";border-bottom-color:white;}.table-cell{border:1px solid ",s.g.colors.separator,";border-",s.g.near,":none;border-bottom:none;position:relative;.table-cell-option{position:absolute;",s.g.far,":5px;top:35%;display:none;&.selected{display:block;}.option-icon{font-size:0.9em;}}&:hover{.table-cell-option{display:block;}}}tr:nth-child(2) .table-row{border-radius:7px 0 0 0;border-bottom-color:white;}tr:last-child{.table-row{border-bottom:1px solid ",s.g.colors.separator,";border-radius:0 0 0 7px;}.table-cell{border-bottom:1px solid ",s.g.colors.separator,";&:last-child{border-radius:0 0 7px 0;}}}}.add-column-button{margin:9px 10px;white-space:nowrap;}",""),g=(0,n.observer)((function(e){let{item:t}=e;return(0,u.BX)("div",{css:m,children:[(0,u.BX)(p.c_,{children:[(0,u.tZ)(c.O,{item:t,label:lng("add row|editor"),type:"row",text:lng("row text|editor")}),(0,u.tZ)(p.zh,{}),(0,u.tZ)(c.O,{item:t,label:lng("add column|editor"),type:"column",text:lng("column text|editor")})]}),(0,u.tZ)("div",{className:"table-container",children:(0,u.tZ)("div",{className:"table-scroll",children:(0,u.tZ)("table",{children:(0,u.BX)("tbody",{children:[(0,u.BX)("tr",{children:[(0,u.tZ)("td",{className:"corner-cell"}),t.typeObject.columnParts.map((e=>(0,u.tZ)(h,{col:e},e.id)))]}),t.typeObject.rowParts.map((e=>(0,u.BX)("tr",{children:[(0,u.tZ)(b,{row:e}),t.typeObject.columnParts.map((t=>(0,u.tZ)(v,{row:e,col:t},`${e.id} ${t.id}`)))]},e.id)))]})})})})]})})),h=(0,n.observer)((function(e){let{col:t}=e;const[i,n]=(0,a.useState)(!1),r=t.Item.typeObject.columnParts.length>1;return(0,u.tZ)("td",{className:(0,l.AK)("table-column",{focus:i}),children:(0,u.BX)("div",{children:[(0,u.tZ)(o.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),onFocus:()=>n(!0),onBlur:()=>n(!1)}),r&&(0,u.tZ)("div",{className:"remove-part",children:(0,u.tZ)(d.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete column|editor")})})]})})})),b=(0,n.observer)((function(e){let{row:t}=e;const[i,n]=(0,a.useState)(!1),r=t.Item.typeObject.rowParts.length>1;return(0,u.tZ)("td",{className:(0,l.AK)("table-row",{focus:i}),children:(0,u.BX)("div",{children:[(0,u.tZ)(o.O3,{type:"text",value:t.text,onChange:e=>t.change("part_text",e),onFocus:()=>n(!0),onBlur:()=>n(!1)}),r&&(0,u.tZ)("div",{className:"remove-part",children:(0,u.tZ)(d.JO,{icon:"close_circle",buttonLike:!0,onClick:()=>t.change("deleted",1),toolTip:lng("delete row|editor")})})]})})})),v=(0,n.observer)((function(e){let{row:t,col:i}=e;const[n,r]=(0,a.useState)(!1),c=t.Item.typeObject.findCellPart(t,i);return(0,u.BX)("td",{className:(0,l.AK)("table-cell",{focus:n}),children:[(0,u.tZ)(o.O3,{type:"text",value:c.text,onChange:e=>c.change("part_text",e),onFocus:()=>r(!0),onBlur:()=>r(!1)}),(0,u.tZ)("div",{className:(0,l.AK)("table-cell-option",{selected:c.dataByName("part_options.openAnswer")}),children:(0,u.tZ)(d.JO,{icon:"open_answer",className:"option-icon",smallButtonLike:!0,color:c.dataByName("part_options.openAnswer")?s.g.colors.blue:void 0,onClick:()=>c.change("part_options.openAnswer",!c.dataByName("part_options.openAnswer")),toolTip:lng("use as an open answer|editor")})})]})}))},5907:(e,t,i)=>{i.d(t,{d:()=>h});var n=i(6920),r=i(917),s=i(5560),o=i(7363),a=i(3550),l=i(8318),c=i(7965),d=i(6975),p=i(5944);const u=n.g.colors.purple,m=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none">\n\t<polygon points="0 15, 40 15, 85 50, 40 85, 0 85" fill="${u}" stroke-linejoin="round" stroke-width="30" stroke="${u}"/>\n</svg>`,g=(0,r.iv)("padding:10px;display:flex;align-items:center;gap:10px;position:relative;cursor:pointer;&.disabled{background-color:",n.g.colors.disabled_background,";cursor:not-allowed;>.index{background-color:",n.g.colors.disabled_background,";}}>.index{background-color:",n.g.colors.bg_page_containers,";border:1px solid ",n.g.colors.border,";border-radius:50%;height:25px;min-width:25px;display:flex;justify-content:center;align-items:center;}>.Icon{color:",n.g.colors.text_light_disabled,";}>.label{",n.g.classes.ellipsis,";.empty-title{color:",n.g.colors.disabled_text,";font-style:italic;}}&.required_alert{background:tomato;}&.active{background-color:",n.g.colors.purple,";color:white;>.index{background-color:",n.g.colors.purple,";}&.edit:before{position:absolute;content:'';",n.g.near,":100%;width:30px;height:100%;filter:drop-shadow(3px 3px 2px rgba(0, 0, 0, 0.3));background-color:",n.g.colors.purple,";.RTL &{filter:drop-shadow(-3px 3px 2px rgba(0, 0, 0, 0.3));}}&.edit:after{position:absolute;content:'';",n.g.near,":calc(100% + 30px);width:36px;height:100%;background-image:url('data:image/svg+xml;utf8,",encodeURIComponent(m),"');filter:drop-shadow(3px 3px 2px rgba(0, 0, 0, 0.3));",n.g.isRTL?"transform: scaleX(-1);":"",";}}&.disabled{opacity:0.5;pointer-events:none;background-color:",n.g.colors.disabled_background,";}",""),h=(0,s.observer)((function(e){let{item:t,mode:i,active:n,onClick:r}=e;const{header:s,id:u,globalItemOrder:m,typeIcon:h,alert_force_answer:b}=t,v=(0,o.useContext)(a.y);return(0,p.BX)("div",{css:g,className:(0,l.AK)(i,{active:n,required_alert:b,disabled:t.disabled}),onClick:r,children:[v?(0,p.tZ)(c.E.div,{className:"index",whileHover:{rotate:90},...v.attributes,...v.listeners,children:m}):(0,p.tZ)("div",{className:"index",children:m}),(0,p.tZ)(d.JO,{icon:h}),(0,p.tZ)("div",{className:"label",children:s||(0,p.tZ)("span",{className:"empty-title",children:lng("no title|editor").caps()})})]},u)}))},7944:(e,t,i)=>{i.d(t,{F:()=>_});var n=i(6920),r=i(917),s=i(5560),o=i(7363),a=i(3550),l=i(7965),c=i(7828),d=i(6975),p=i(8318),u=i(5907),m=i(5587),g=i(8253),h=i(3051),b=i(5944);const v=(0,r.iv)("position:relative;.sort-grip{position:absolute;",n.g.near,":-24px;top:9px;cursor:pointer;}&.disabled{.cont{background-color:",n.g.colors.disabled_background,";.head{cursor:not-allowed;&:hover{background-color:",n.g.colors.disabled_background,";}}}}.cont{background-color:",n.g.colors.bg_main,";border:1px solid ",n.g.colors.border,";border-radius:6px;.head{display:flex;gap:7px;padding:3px;font-weight:600;align-items:center;border-bottom:1px solid ",n.g.colors.border,";cursor:pointer;&:hover{background-color:",n.g.colors.white_shade,";}>.index{min-width:33px;height:33px;background-color:",n.g.colors.bg_page_containers,";border-radius:6px;display:flex;justify-content:center;align-items:center;&.active{background-color:",n.g.colors.purple,";color:#FFF;}}>.count{min-width:22px;height:22px;background-color:",n.g.colors.bg_page_containers,";border-radius:50%;display:flex;justify-content:center;align-items:center;}>.label{flex-grow:1;",n.g.classes.ellipsis,";.empty-title{color:",n.g.colors.disabled_text,";font-style:italic;}}>.actions{white-space:nowrap;}}.items-list{display:flex;flex-direction:column;overflow:hidden;&.active{overflow:unset;}>div{padding:17px 0;}}}&.required_alert{>.cont>.head{background-color:salmon;}}&.disabled{>.cont>.head{opacity:0.5;pointer-events:none;background-color:",n.g.colors.disabled_background,";}}&.deleted{>.cont>.head>.label{text-decoration:line-through;color:",n.g.colors.negative,";}}",""),_=(0,s.observer)((function(e){let{section:t,active:i,activeItemId:n,mode:r,selectSection:s,selectItem:m,openSectionSettings:g}=e;const{items:_,order:y,title:w,alert_force_answer:x,disabled:k}=t,[Z,C]=(0,o.useState)("edit"===r||i),S=(0,o.useContext)(a.y),O=[t.data.deleted?{icon:"recycle",label:lng("restore|editor"),onClick:()=>t.change("deleted",null)}:{icon:"trash",label:lng("delete|editor"),onClick:()=>t.change("deleted",1)}];return(0,o.useEffect)((()=>{"edit"!==r&&C(i)}),[i]),(0,b.BX)("div",{css:v,className:(0,p.AK)({deleted:t.data.deleted,required_alert:x,disabled:k}),children:[S&&(0,b.tZ)(l.E.span,{whileHover:{rotate:90},className:"sort-grip",...S.attributes,...S.listeners,children:(0,b.tZ)(d.JO,{icon:"sort_grip",smallButtonLike:!0})}),(0,b.BX)("div",{className:"cont",children:[(0,b.BX)("div",{className:"head",onClick:()=>!k&&s(t),children:[(0,b.tZ)("div",{className:(0,p.AK)("index",{active:i}),children:y}),(0,b.tZ)("div",{className:"label",children:w||(0,b.tZ)("span",{className:"empty-title",children:lng("no section header|editor").caps()})}),!Z&&(0,b.tZ)("div",{className:"count",children:_.length}),(0,b.BX)("div",{className:"actions",children:["edit"===r&&(0,b.tZ)(h.x,{options:O,children:(0,b.tZ)(d.JO,{icon:"menu_h",smallButtonLike:!0})}),"edit"===r&&g&&(0,b.tZ)(d.JO,{icon:"mng_settings",toolTip:lng("section settings|editor"),smallButtonLike:!0,onClick:e=>(e.stopPropagation(),g(t))}),(0,b.tZ)(d.JO,{icon:"arrow_"+(Z?"up":"down"),onClick:e=>(e.stopPropagation(),C(!Z)),smallButtonLike:!0,disabled:i})]})]}),(0,b.tZ)(c.M,{initial:!1,children:Z&&_.length>0&&(0,b.tZ)(l.E.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:(0,p.AK)("items-list",{active:i}),children:(0,b.tZ)("div",{children:(0,b.tZ)(f,{disable:null==S?void 0:S.disableInner,children:_.map((e=>(0,b.tZ)(u.d,{item:e,mode:r,active:e.matchId(n),onClick:()=>!e.disabled&&m(e)},"item"+e.id)))})})})})]})]})})),f=e=>{let{children:t,disable:i}=e;const[n,r]=(0,o.useState)(t.slice());(0,o.useLayoutEffect)((()=>{r(t.slice())}),[t]);const s=n.map((e=>(0,b.tZ)(g.q,{id:e.key,disable:i,children:e},e.key))),a=n.map((e=>e.key));return(0,b.tZ)(m.Fo,{items:a,strategy:()=>{},children:s})}},8253:(e,t,i)=>{i.d(t,{D:()=>v,q:()=>f});var n=i(7944),r=i(917),s=i(6920),o=i(4773),a=i(6975),l=i(5944);const c=(0,r.iv)("padding:10px;border:1px dashed ",s.g.colors.border,";border-radius:6px;cursor:pointer;>.Icon{padding:0 3px;}>span{padding:0 5px;}&:hover{background-color:",s.g.colors.dominant_main_shade,";border:1px solid ",s.g.colors.light_blue2,";color:",s.g.colors.light_blue,";}",""),d=()=>{const e=(0,o.P8)();return(0,l.BX)("div",{css:c,onClick:()=>e.Content.SectionF.new(),children:[(0,l.tZ)(a.JO,{icon:"mark_plus"}),(0,l.tZ)("span",{children:lng("add section|editor").caps()})]})};var p=i(7363),u=i(5587),m=i(9752),g=i(4285),h=i(3550);const b={name:"jkrkfq",styles:"padding:20px;display:flex;flex-direction:column;gap:15px;z-index:2;>.title{font-weight:700;}"},v=function(e){let{list:t,activeSectionId:i,mode:r,selectSection:s,openSectionSettings:o,activeItemId:a,selectItem:c,search:p,onSort:u,overlay:m}=e;const g=t.length>0,h={mode:r,selectSection:s,openSectionSettings:o,activeItemId:a,selectItem:c};return(0,l.BX)("div",{css:b,className:"sections",children:[(0,l.tZ)("div",{className:"title",children:lng("sections|editor").caps()}),g&&(0,l.tZ)(_,{onSort:u,overlay:m,children:t.map((e=>(0,l.tZ)(n.F,{section:e,active:e.matchId(i),...h},"section"+e.id)))}),!g&&p&&(0,l.tZ)("div",{children:lng("no results|editor").caps()}),!p&&(0,l.tZ)(d,{})]})},_=e=>{let{children:t,onSort:i,overlay:n}=e;const[r,s]=(0,p.useState)(t.slice()),[o,a]=(0,p.useState)(null),c=r.map((e=>e.key)),d=!!o&&c.includes(o);(0,p.useLayoutEffect)((()=>{s(t.slice())}),[t]);const g=r.map((e=>(0,l.tZ)(f,{id:e.key,disableInner:d,children:e},e.key)));return(0,l.BX)(m.LB,{onDragStart:e=>{let{active:t}=e;a(t.id)},onDragOver:e=>{let{active:t,over:i}=e;i&&t.id!==i.id&&d&&s((e=>{const n=e.findIndex((e=>e.key===t.id)),r=e.findIndex((e=>e.key===i.id));return(0,u.Rp)(e,n,r)}))},onDragEnd:()=>{null==i||i({new_order:c,moved_id:o}),a(null)},children:[(0,l.tZ)(u.Fo,{items:c,strategy:()=>{},children:g}),(0,l.tZ)(m.y9,{children:o&&(0,l.tZ)("div",{style:{opacity:.7,backgroundColor:"white"},children:n(o)})})]})},f=e=>{let{id:t,children:i,disable:n,disableInner:r}=e;const s=(0,u.nB)({id:t}),{setNodeRef:o,transition:a,transform:c}=s,d={transition:a,transform:g.ux.Translate.toString(c)};return s.disableInner=r,(0,l.tZ)("div",{ref:n?void 0:o,style:n?void 0:d,children:(0,l.tZ)(h.y.Provider,{value:s,children:i})})}},5280:(e,t,i)=>{i.d(t,{Z:()=>ke,L:()=>xe});var n=i(917),r=i(6920),s=i(5560),o=i(6975),a=i(7944),l=i(7363),c=i(7828),d=i(7965),p=i(5311),u=i(1619),m=i(8318),g=(i(3835),i(1577)),h=i(3550),b=i(5944);const v=(0,s.observer)((function(e){let{item:t}=e;const i=t.typeObject.selectedAnswer.order||[];let n=t.typeObject.dynamicPartsPlayer;return n=n.sort(((e,t)=>i.indexOf(e.id+"")-i.indexOf(t.id+""))),(0,b.BX)("div",{css:g.P,className:"play",children:[t.typeObject.staticParts.map(((e,t)=>(0,b.tZ)("div",{className:"static-col",style:{gridRow:t+1},children:(0,b.tZ)(f,{part:e})},e.id))),t.typeObject.staticParts.map(((e,t)=>(0,b.tZ)("div",{className:"match-middle-col",style:{gridRow:t+1},children:(0,b.tZ)(o.JO,{icon:"arrow_go_far"})},e.id))),(0,b.tZ)(h.b,{onSort:e=>{let{new_order:i}=e;t.typeObject.selectAnswer(i)},wrapperStyleFunc:e=>({gridColumn:3,gridRow:e+1}),children:n.map((e=>(0,b.tZ)("div",{children:(0,b.tZ)(y,{part:e})},e.id)))})]})})),_=(0,n.iv)("min-height:80px;border:2px solid ",r.g.colors.separator,";border-radius:10px;display:flex;justify-content:space-between;align-items:center;>.text{flex-grow:1;font-size:1.1em;font-weight:600;padding:15px;}&.selected{>.check{color:",r.g.colors.dominant_main,";}}&:hover{border:2px solid ",r.g.colors.dominant_main,";>.check{color:",r.g.colors.dominant_main,";}}",""),f=(0,s.observer)((function(e){let{part:t}=e;return(0,b.tZ)("div",{css:_,children:(0,b.tZ)("div",{className:"text",children:t.text})})})),y=(0,s.observer)((function(e){let{part:t}=e;const i=(0,l.useContext)(h.y);return(0,b.BX)("div",{css:_,children:[(0,b.tZ)("div",{className:"text",children:t.text}),i&&(0,b.tZ)("span",{...i.attributes,...i.listeners,children:(0,b.tZ)(o.JO,{icon:"move"})})]})}));i(7041);const w={name:"x6qdks",styles:"display:flex;flex-direction:column;gap:15px"},x=(0,s.observer)((function(e){let{item:t}=e;return(0,b.tZ)("div",{css:w,children:t.parts.map((e=>(0,b.tZ)(Z,{part:e},e.id)))})})),k=(0,n.iv)("min-height:80px;border:2px solid ",r.g.colors.separator,";border-radius:10px;display:flex;justify-content:space-between;align-items:center;>.check{font-size:1.7em;padding:15px;color:",r.g.colors.separator,";}>.text{flex-grow:1;font-size:1.1em;font-weight:600;}>.feedback{}&.selected{>.check{color:",r.g.colors.dominant_main,";}}&:hover{border:2px solid ",r.g.colors.dominant_main,";>.check{color:",r.g.colors.dominant_main,";}}",""),Z=(0,s.observer)((function(e){let{part:t}=e;const i=t.Item.typeObject.selectedAnswer,n=i.parts?i.parts.some((e=>t.matchId(e))):t.matchId(i.partId);return(0,b.BX)("div",{className:(0,m.AK)({selected:n}),css:k,onClick:()=>t.Item.typeObject.selectAnswer(t),children:[(0,b.tZ)("div",{className:"check",children:(0,b.tZ)(o.JO,{icon:n?"radio_checked":"radio"})}),(0,b.tZ)("div",{className:"text",children:t.text})]})}));var C=i(2608),S=i(3346),O=i(7154),B=i(7392),T=i(81),N=i(6421);const I=(0,n.iv)(C.j,";table{.table-column,.table-row,.table-cell{&:hover{background-color:unset;}}}",""),D=(0,s.observer)((function(e){let{item:t}=e;return(0,b.tZ)("div",{css:I,className:"play",children:(0,b.tZ)("div",{className:"table-container",children:(0,b.tZ)("div",{className:"table-scroll",children:(0,b.tZ)("table",{children:(0,b.BX)("tbody",{children:[(0,b.BX)("tr",{children:[(0,b.tZ)("td",{className:"corner-cell"}),t.typeObject.columnParts.map((e=>(0,b.tZ)(j,{col:e},e.id)))]}),t.typeObject.rowParts.map((e=>(0,b.BX)("tr",{children:[(0,b.tZ)(P,{row:e}),t.typeObject.columnParts.map((t=>(0,b.tZ)(z,{row:e,col:t},`${e.id} ${t.id}`)))]},e.id)))]})})})})})})),j=(0,s.observer)((function(e){let{col:t}=e;return(0,b.tZ)("td",{className:(0,m.AK)("table-column"),children:(0,b.tZ)("div",{children:(0,b.tZ)("div",{className:"text",children:t.text})})})})),P=(0,s.observer)((function(e){let{row:t}=e;return(0,b.tZ)("td",{className:(0,m.AK)("table-row"),children:(0,b.tZ)("div",{children:(0,b.tZ)("div",{className:"text",children:t.text})})})})),z=(0,s.observer)((function(e){var t;let{row:i,col:n}=e;const r=i.Item.typeObject.findCellPart(i,n),s=r.Item,o=r.dataByName("part_options.openAnswer"),a=e=>s.typeObject.setAnswer(i,n,e,o),l=(null===(t=s.typeObject.answer.find((e=>r.matchId(e[0]))))||void 0===t?void 0:t[1])||{},c=o?l.text:l.partId;return(0,b.tZ)("td",{className:(0,m.AK)("table-cell"),children:o?(0,b.tZ)(F,{cell:r,answer:(d=r.id,null===(p=s.answerData.value.multiple.find((e=>e[0]==d)))||void 0===p?void 0:p[1]),onChange:a}):(0,b.tZ)(S.gN,{input:{type:"select",options:s.typeObject.answers.map((e=>({val:e.data.part_id,label:e.data.part_text}))),emptyOption:lng("select answer|editor")},value:c||"",onChange:a})});var d,p})),E={name:"jzgv64",styles:"display:flex;flex-direction:column;padding:10px 35px;min-width:400px;*{margin:10px 0;flex:1;}._title{text-align:center;font-weight:600;}"},R=(0,n.iv)(r.g.classes.descriptionShowMore," color:unset;flex:1;",""),F=(0,s.observer)((function(e){let{cell:t,answer:i,onChange:n}=e;const[r,s]=(0,l.useState)(!1),o=(0,l.useRef)();(0,T.t$)(o,(e=>{const i=document.getElementsByClassName("_answer_balloon_"+t.id)[0];i===e.target||null!=i&&i.contains(e.target)||s(!1)}));const a=(0,b.BX)("div",{css:E,className:"_answer_balloon_"+t.id,children:[(0,b.tZ)("div",{className:"_title",children:lng("insert your answer").caps()}),(0,b.tZ)(N.I,{type:"richtext",wrapped:!0,value:(null==i?void 0:i.text)||"",onChange:n,label:lng("type your answer here"),focusOnShow:!0,toolbarOptions:{}}),(0,b.tZ)(B.l,{theme:"contained",onClick:()=>s(!1),children:lng("done").caps()})]});return(0,b.tZ)(O.y,{behavior:"trigger",trigger:r,content:a,css:R,children:(0,b.tZ)("div",{onClick:()=>s(!0),ref:o,children:(0,b.tZ)(u.xn,{content:(null==i?void 0:i.text)||lng("your answer...").caps()})})})})),M=()=>"";var A=i(3538);const q=(0,s.observer)((e=>{let{item:t}=e;return(0,b.tZ)(A.O3,{type:"text",value:t.typeObject.answer,onChange:e=>t.typeObject.setAnswer(e),wrapped:!0})}));var X=i(4773);const L={name:"1fttcpj",styles:"display:flex;flex-direction:column"},$=(0,s.observer)((function(e){var t;let{item:i}=e;const n=(null===(t=i.answerData)||void 0===t?void 0:t.value)||[...i.parts].sort((()=>Math.random()>.5?1:-1)).map((e=>e.id)),r=e=>{let{new_order:t}=e;return i.typeObject.selectOrder(t)},s=e=>{let t=[...n];[t[e-1],t[e]]=[t[e],t[e-1]],r({new_order:t})},o=e=>{let t=[...n];[t[e],t[e+1]]=[t[e+1],t[e]],r({new_order:t})},a=n.map((e=>i.parts.find((t=>t.id==e))));return(0,b.tZ)("div",{css:L,children:(0,b.tZ)(h.b,{onSort:r,children:a.map(((e,t)=>(0,b.tZ)(U,{part:e,moveUp:s,moveDown:o,isFirst:0===t,isLast:t===a.length-1,index:t},e.id)))})})})),V=(0,n.iv)("display:flex;position:relative;>._answer_move{display:flex;flex-direction:column;margin:auto 0;}>._item{flex:1;align-items:center;border:1px ",r.g.colors.separator," solid;border-radius:10px;padding:20px;margin:6px;gap:10px;justify-content:space-between;>._sort_grip{position:absolute;",r.g.classes.far("10px")," top:10px;cursor:pointer;visibility:hidden;}>._part_text{flex-grow:1;margin:auto 0;font-size:1.1em;font-weight:600;}&:hover,&._dragging{",r.g.classes.shadow_strong,">._sort_grip{visibility:visible;}}}",""),U=(0,s.observer)((function(e){let{part:t,moveUp:i,moveDown:n,index:r}=e;const s=(0,l.useContext)(h.y),a=s?s.attributes:{},c=s?s.listeners:{};return(0,b.BX)("div",{css:V,children:[(0,b.BX)(d.E.div,{className:"_answer_move",initial:{opacity:0},animate:{opacity:1},children:[(0,b.tZ)(o.JO,{icon:"arrow_up",smallButtonLike:!0,disabled:0===r,onClick:()=>i(r)}),(0,b.tZ)(o.JO,{icon:"arrow_down",smallButtonLike:!0,disabled:r===t.Item.parts.length-1,onClick:()=>n(r)})]}),(0,b.BX)("div",{className:(0,m.AK)("_item",{_dragging:(null==s?void 0:s.active)==t.id}),children:[(0,b.tZ)(u.xn,{content:t.text,className:"_part_text"}),(0,b.tZ)(d.E.span,{whileHover:{rotate:90},className:"_sort_grip",...a,...c,children:(0,b.tZ)(o.JO,{icon:"move",smallButtonLike:!0})})]})]})}));var H=i(2334);const J=(0,n.iv)("display:flex;flex-direction:row;._field_wrapper{flex:1;margin:5px 0;+._field_wrapper{",r.g.classes.margin_near("5px"),";}}",""),G=(0,s.observer)((function(e){var t;let{item:i}=e;const n=(null===(t=i.answerData)||void 0===t?void 0:t.value)||{},r=e=>{i.typeObject.selectAnswer({...n,...e})},s=n.from?()=>(0,H._3)(n.from):void 0,o=n.to&&i.dataByName("item_options.range")?()=>(0,H._3)(n.to):void 0;return(0,b.BX)("div",{css:J,children:[(0,b.tZ)(N.I,{type:i.typeObject.inputType,label:i.typeObject.startTimeLabel,value:n.from,onChange:e=>r({from:e}),maxDate:o,years:i.typeObject.yearsDisplayRange,noMinWidth:!0,wrapped:!0}),i.dataByName("item_options.range")&&(0,b.tZ)(b.HY,{children:(0,b.tZ)(N.I,{type:i.typeObject.inputType,label:lng("to|editor"),value:n.to,onChange:e=>r({to:e}),minDate:s,years:i.typeObject.yearsDisplayRange,noMinWidth:!0,wrapped:!0})})]})}));var W=i(1776);const K=(0,n.iv)(".bg{display:flex;position:relative;>.image-wrapper{position:relative;overflow:hidden;display:inline-block;direction:ltr;text-align:left;>img{cursor:crosshair;max-width:100%;max-height:80vh;user-select:none;border-radius:15px;}}.bullseye{position:absolute;font-size:20px;color:",r.g.colors.dominant_orange,";}}",""),Y=(0,s.observer)((function(e){let{item:t}=e;const[i,n]=(0,l.useState)(!0);let r=null;t.typeObject.file&&(r=Blsm.prm.Mainref+t.typeObject.file.link);const s=t.dataByName("item_options.required_selection")||1,o=t.typeObject.selected.length<s;return(0,b.tZ)("div",{css:K,children:(0,b.tZ)("div",{className:"bg",children:(0,b.BX)("div",{className:"image-wrapper",onClick:o?e=>{t.typeObject.selectAnswer((0,W.w)(e))}:void 0,children:[(0,b.tZ)(d.E.img,{initial:{opacity:1},animate:{opacity:i?0:1},onLoad:()=>n(!1),src:r,draggable:!1}),t.typeObject.selected.map(((e,i)=>(0,b.tZ)(ee,{item:t,y:e.y,x:e.x},"answer-"+i)))]})})})})),Q={name:"fpne06",styles:"position:absolute;cursor:pointer;font-size:26px;>.Icon-location{position:absolute;top:5%;left:8%;}"},ee=(0,s.observer)((function(e){let{item:t,y:i,x:n}=e;const s={top:i-33+"px",left:n-12+"px"};return(0,b.tZ)("div",{css:Q,style:s,onClick:e=>{e.stopPropagation(),t.typeObject.removeAnswer({x:n,y:i})},children:(0,b.tZ)(o.JO,{icon:"location",color:r.g.colors.light_blue})})}));var te=i(2808),ie=i(441);const ne=(0,n.iv)("display:flex;flex-direction:column;gap:15px;.files{display:flex;margin:10px;flex-wrap:wrap;.file{display:inline-block;color:",r.g.colors.text_sec,";background-color:",r.g.colors.bg_page_containers,";text-align:center;padding:5px;cursor:pointer;min-width:65px;margin:5px;&:hover{background-color:",r.g.colors.dominant_main_shade,";}.thumbnail{font-size:30px;}.file-name{display:block;}}}.explanation-box{padding:8px;border-radius:10px;background-color:",r.g.colors.bg_page_containers,";.blsm-input{width:100%;border:none;background-color:transparent;min-height:100px;}}",""),re=(0,s.observer)((function(e){let{item:t}=e;return(0,b.BX)("div",{css:ne,children:[(0,b.tZ)("div",{className:"files",children:t.files.map((e=>(0,b.tZ)(se,{...e},e.file_id)))}),t.parts.map((e=>(0,b.tZ)(ae,{part:e},e.id))),t.dataByName("item_options.explanation")&&(0,b.BX)("div",{className:"explanation-box",children:[(0,b.BX)("div",{children:[lng("explanation|editor").caps(),":"]}),(0,b.tZ)(A.O3,{type:"textarea",value:t.typeObject.explanation,onChange:e=>t.typeObject.markPart("expl",e)})]})]})})),se=e=>(0,b.tZ)(ie.A,{theme:"highlight",href:{file:e},"data-preview":(0,te.BX)(e.file_name),children:(0,b.BX)("div",{className:"file",children:[(0,b.tZ)(o.JO,{icon:(0,te.DW)(e.file_name,!0),className:"thumbnail"}),(0,b.tZ)(O.u,{text:e.file_name,className:"file-name",children:e.file_name.truncate(12,"...")})]})}),oe=(0,n.iv)("min-height:80px;border:2px solid ",r.g.colors.separator,";border-radius:10px;display:flex;justify-content:space-between;align-items:center;>.check{font-size:1.7em;padding:15px;color:",r.g.colors.separator,";}>.text{flex-grow:1;font-size:1.1em;font-weight:600;}.not-rel-button{position:absolute;",r.g.far,":65px;display:none;border:1px solid ",r.g.colors.dominant_orange,";color:",r.g.colors.dominant_orange,";&._clickable:not(._disabled):hover{background-color:",r.g.colors.white_shade,";}}>.feedback{}&.selected{>.check{color:",r.g.colors.dominant_main,";}}&.not_relevant{>.check{color:",r.g.colors.dominant_orange,";}>.text{text-decoration:line-through;}.not-rel-button{display:block;}}&:hover{border:2px solid ",r.g.colors.dominant_main,";>.check{color:",r.g.colors.dominant_main,";}&.not_relevant{border:2px solid ",r.g.colors.dominant_orange,";>.check{color:",r.g.colors.dominant_orange,";}}&:not(.selected) .not-rel-button{display:block;}}",""),ae=(0,s.observer)((function(e){var t,i,n;let{part:r}=e;const s=r.Item.typeObject,a=null===(n=((null===(t=r.Item.answerData)||void 0===t||null===(i=t.value)||void 0===i?void 0:i.multiple)||[]).find((e=>e[0]===r.id)))||void 0===n?void 0:n[1];return(0,b.BX)("div",{className:(0,m.AK)({selected:1===a,not_relevant:2===a}),css:oe,onClick:()=>s.markPart(r.id,1===a?0:1),children:[(0,b.tZ)("div",{className:"check",children:(0,b.tZ)(o.JO,{icon:1===a?"checkbox_checked":2===a?"checkbox_half":"checkbox"})}),(0,b.tZ)("div",{className:"text",children:(0,b.tZ)(u.xn,{content:r.text})}),(0,b.tZ)(p.zh,{}),r.Item.dataByName("item_options.not_relevant")&&(0,b.tZ)(B.l,{className:"not-rel-button",onClick:e=>(e.stopPropagation(),s.markPart(r.id,2===a?0:2)),children:lng("not relevant|editor").caps()})]})})),le=(0,n.iv)("display:flex;.table-scroll{overflow-x:auto;max-width:100%;}table{border-collapse:separate;margin:6px 0;.table-column,.table-row,.table-cell{min-width:200px;padding:11px 13px;text-align:",r.g.near,";font-weight:normal;>div{display:flex;}input{border:none;background-color:transparent;}.remove-part{visibility:hidden;}&:hover{background-color:",r.g.colors.blue_shade,";.remove-part{visibility:visible;}}&.focus{border:1px solid ",r.g.colors.dominant_main,"!important;}}.table-column{background-color:",r.g.colors.bg_page_containers,";border:1px solid ",r.g.colors.bg_page_containers,";border-",r.g.far,":1px solid ",r.g.colors.separator,";&:nth-child(2){border-radius:7px 0 0 0;}&:last-child{border-color:",r.g.colors.bg_page_containers,";border-radius:0 7px 0 0;}}.corner-cell,.table-row{position:sticky;",r.g.near,":0;background:white;z-index:1;}.table-row{border:1px solid ",r.g.colors.separator,";border-bottom-color:white;}.table-cell{border:1px solid ",r.g.colors.separator,";border-",r.g.near,":none;border-bottom:none;text-align:center;}tr:nth-child(2) .table-row{border-radius:7px 0 0 0;border-bottom-color:white;}tr:last-child{.table-row{border-bottom:1px solid ",r.g.colors.separator,";border-radius:0 0 0 7px;}.table-cell{border-bottom:1px solid ",r.g.colors.separator,";&:last-child{border-radius:0 0 7px 0;}}}}",""),ce=(0,s.observer)((function(e){let{item:t}=e;return(0,b.tZ)("div",{css:le,children:(0,b.tZ)("div",{className:"table-scroll",children:(0,b.tZ)("table",{children:(0,b.BX)("tbody",{children:[(0,b.BX)("tr",{children:[(0,b.tZ)("td",{className:"corner-cell"}),t.typeObject.columnParts.map((e=>(0,b.tZ)(de,{col:e},e.id)))]}),t.typeObject.rowParts.map((e=>(0,b.BX)("tr",{children:[(0,b.tZ)(pe,{row:e}),t.typeObject.columnParts.map((t=>(0,b.tZ)(ue,{row:e,col:t},`${e.id} ${t.id}`)))]},e.id)))]})})})})})),de=(0,s.observer)((function(e){let{col:t}=e;return(0,b.tZ)("td",{className:(0,m.AK)("table-column"),children:t.text})})),pe=(0,s.observer)((function(e){let{row:t}=e;return(0,b.tZ)("td",{className:"table-row",children:t.text})})),ue=(0,s.observer)((function(e){var t,i;let{row:n,col:s}=e;const o=null===(t=n.Item.answerData)||void 0===t||null===(i=t.value)||void 0===i?void 0:i[n.id];let a;return a=n.Item.dataByName("item_options.multiple")?(o||[]).includes(s.id):s.matchId(o),(0,b.tZ)("td",{className:"table-cell",children:(0,b.tZ)(N.I,{type:"checkbox",value:a,onChange:()=>n.Item.typeObject.toggleAnswer(n,s),wrapped:!0,center:!0,iconTrue:"circle_dot",iconFalse:"circle",color:r.g.colors.text_main})})}));var me=i(8567),ge=i(745);const he=(0,s.observer)((function(e){let{item:t}=e;const i=(0,l.useRef)();return(0,l.useEffect)((()=>{const e=i.current.getElementsByTagName("span");Array.from(e).forEach(((e,i)=>{(0,ge.s)(e).render((0,b.tZ)(be,{item:t,index:i},e.id))}))}),[]),(0,b.tZ)("div",{children:(0,b.tZ)("div",{ref:i,css:r.g.classes.wysiwyg,dangerouslySetInnerHTML:{__html:(0,u.mN)(t.dataByName("item_options.answer"))}})})})),be=(0,s.observer)((function(e){var t;let{item:i,index:n}=e;const r=null===(t=i.answerData)||void 0===t?void 0:t.value[n];return(0,b.tZ)(N.I,{type:"select",value:r,onChange:e=>i.typeObject.selectAnswer(e,n),emptyOption:!0,options:(0,m.wd)(i.typeObject.placeholders)})})),ve=(0,n.iv)("min-height:500px;box-shadow:0 0 5px rgba(0, 0, 0, .3);border-radius:15px;position:relative;display:flex;flex-direction:column;background-color:#FFF;margin-bottom:20px;>.header{height:66px;background-color:",r.g.colors.purple,";color:#FFF;border-radius:15px 15px 0 0;display:flex;align-items:center;padding:0 20px;>.index{color:white;font-size:2em;font-weight:700;}}>.content-top{padding:40px 75px;display:flex;flex-direction:column;gap:10px;position:relative;.item-text{font-size:1.3em;font-weight:600;}>.description{display:flex;margin:6px 0;gap:5px;align-items:center;}>.item-tip{position:absolute;background-color:",r.g.colors.purple,";color:#FFF;",r.g.far,":-2px;top:44px;height:30px;width:40px;display:flex;justify-content:center;align-items:center;border-radius:20px 0 0 20px;&:hover{cursor:pointer;box-shadow:0 0 5px rgba(0, 0, 0, .3);}}}>.content-mid{padding:7px 48px 25px;}",""),_e=(0,s.observer)((function(e){let{item:t,nav:i=!0}=e;const{globalItemOrder:n}=t;return(0,b.BX)("div",{css:ve,children:[i&&(0,b.tZ)(ye,{}),(0,b.BX)("div",{className:"header",children:[(0,b.tZ)("div",{className:"index",children:n}),(0,b.tZ)(p.zh,{})]}),(0,b.BX)("div",{className:"content-top",children:[(0,b.tZ)("div",{className:"item-text",children:t.dataByName("item_text")}),!!t.dataByName("item_description")&&!t.dataByName("item_options.hide_description")&&(0,b.tZ)("div",{className:"description desc-"+t.id,children:(0,b.tZ)(u.xn,{content:t.dataByName("item_description")})}),t.dataByName("item_tip_show")&&t.dataByName("item_tip")&&(0,b.tZ)(O.u,{className:"item-tip",text:lng("show tip|editor"),children:(0,b.tZ)("div",{onClick:()=>(0,me.qR)((0,b.tZ)(u.xn,{content:t.dataByName("item_tip")}),{title:lng("tip!|editor")}),children:(0,b.tZ)(o.JO,{icon:"light_bulb"})})})]}),(0,b.tZ)("div",{className:"content-mid",children:(0,b.tZ)(we,{item:t})})]})})),fe=(0,n.iv)(".nav-near,.nav-far{position:absolute;top:min(43vh, 50%);background-color:#FFF;border-radius:50%;box-shadow:0 0 5px rgba(0, 0, 0, .3);font-size:1.1em;&.disabled{color:",r.g.colors.disabled_text,";}}.nav-near{",r.g.near,":-15px;}.nav-far{",r.g.far,":-15px;}",""),ye=(0,s.observer)((()=>{const e=(0,X.ip)(),t=e.Content.activeElement,i=!e.Content.canGoBack;return(0,b.BX)("div",{css:fe,children:[(0,b.tZ)("div",{className:(0,m.AK)("nav-near",{disabled:0===t.globalOrder||i}),children:(0,b.tZ)(o.JO,{icon:"arrow_near",buttonLike:!0,disabled:0===t.globalOrder||i,onClick:0===t.globalOrder?void 0:()=>e.Content.previousElement()})}),(0,b.tZ)("div",{className:(0,m.AK)("nav-far",{disabled:t.globalOrder===e.Content.maxElementIndex}),children:(0,b.tZ)(o.JO,{icon:"arrow_far",buttonLike:!0,disabled:t.globalOrder===e.Content.maxElementIndex,onClick:()=>e.Content.handleSelectElement(e.Content.nextActiveElement())})})]})})),we=(0,s.observer)((function(e){let{item:t}=e;switch(t.type){case"multiple_choice":return(0,b.tZ)(x,{item:t});case"completion":return(0,b.tZ)(he,{item:t});case"sorting":return(0,b.tZ)($,{item:t});case"single_textbox":return(0,b.tZ)(q,{item:t});case"rating_scale":return(0,b.tZ)(ce,{item:t});case"matching":return(0,b.tZ)(v,{item:t});case"hotspot":return(0,b.tZ)(Y,{item:t});case"table_question":return(0,b.tZ)(D,{item:t});case"date_time":return(0,b.tZ)(G,{item:t});case"paragraph":return(0,b.tZ)(M,{item:t});case"user_field":case"signature":break;case"checklist":return(0,b.tZ)(re,{item:t})}return"missing"}));i(7187);const xe=e=>{let{direction:t}=e;return(0,n.iv)("margin-top:",r.g.consts.TOP_BAR_HEIGHT,"px;display:flex;height:calc(100vh - ",r.g.consts.TOP_BAR_HEIGHT,"px);overflow:hidden;",t&&`direction: ${t};`,";","")},ke=(0,s.observer)((()=>{const e=(0,X.ip)(),t=e.direction,i=navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)?"pagehide":"beforeunload";return(0,T.OR)(i?"pagehide":"beforeunload",(()=>e.quit())),(0,b.BX)("div",{css:xe({direction:t}),className:"react_container",children:[(0,b.tZ)(Ce,{}),(0,b.tZ)(Oe,{})]})})),Ze=e=>{let{direction:t}=e;return(0,n.iv)("max-width:342px;display:flex;height:100%;z-index:3;position:relative;>.bg{background-color:",r.g.colors.bg_page_containers,";flex-grow:1;overflow-x:hidden;overflow-y:scroll;direction:",t,";>.sections{width:320px;padding:30px;direction:",t,";display:flex;flex-direction:column;gap:15px;>.title{font-weight:700;font-size:1.1em;}}}>.extra{width:22px;transition:background-color .5s linear;direction:",t,";position:absolute;","ltr"===t?"right":"rtl"===t?"left":r.g.far,":-22px;>div{position:relative;top:40px;padding:4px;background-color:",r.g.colors.bg_page_containers,";border-radius:","rtl"===t?"16px 0 0 16px":"0 16px 16px 0",";cursor:pointer;&:hover{}.Icon{transition:rotate .2s linear;}&.close{.Icon{rotate:180deg;}}}}","")},Ce=(0,s.observer)((()=>{const e=(0,X.ip)(),[t,i]=(0,l.useState)(!0),n=e.Content.activeElement,r=e.direction,s=t=>e.Content.handleSelectElement(t);return(0,b.BX)("div",{css:Ze({direction:r}),children:[(0,b.tZ)(c.M,{initial:!1,children:t&&(0,b.tZ)(d.E.div,{className:"bg",initial:{width:0},animate:{width:"auto"},exit:{width:0},children:(0,b.BX)("div",{className:"sections",children:[(0,b.tZ)("div",{className:"title",children:lng("table of contents|editor").caps()}),e.Content.SectionF.list.map((t=>{var i;return(0,b.tZ)(a.F,{section:t,active:t.matchId(null===(i=e.Content.SectionF.getActive)||void 0===i?void 0:i.id),mode:e.mode,selectSection:()=>s(t),activeItemId:e.Content.ItemF.activeId,selectItem:e=>s(e)},"section"+t.id)}))]})})}),(0,b.tZ)("div",{className:"extra",style:Ie(n.element),children:(0,b.tZ)("div",{className:t?"open":"close",onClick:()=>i(!t),children:(0,b.tZ)(o.JO,{icon:"rtl"===r?"arrow_right":"ltr"===r?"arrow_left":"arrow_near"})})})]})})),Se={name:"8uyz2w",styles:"flex-grow:1;padding-top:40px;transition:background-color .5s linear;overflow:auto;display:flex;flex-direction:column;position:relative;.item-area{flex-grow:1;.motion-style{position:absolute;width:100%;}.inner-item-area{position:relative;width:1200px;margin:110px auto 0;}}.bottom-area{height:150px;padding-bottom:20px;}"},Oe=(0,s.observer)((()=>{const e=(0,X.ip)(),t=e.Content.activeElement,i=e.Content.SectionF.getActive,s=r.g.func.imgUrl("editor:bg/spots.jpg"),o=[Se];var a;return s&&o.push((a=s,(0,n.iv)("background-image:url(",a,");background-position:center;background-repeat:no-repeat;background-size:cover;",""))),(0,b.BX)("div",{css:o,style:Ie(t.element),children:[(0,b.BX)("div",{className:"item-area",children:[!(t.isItem&&e.Content.data.presentation_view)&&(0,b.tZ)(Me,{}),(0,b.tZ)("div",{className:"inner-item-area",children:e.Content.data.presentation_view?(0,b.tZ)(Be,{active:t}):(0,b.tZ)(Ne,{section:i},i.id)})]}),(0,b.tZ)("div",{className:"bottom-area",children:e.Content.data.presentation_view&&(0,b.tZ)(Re,{})})]})})),Be=(0,s.observer)((function(e){let{active:t}=e;const i=(0,l.useRef)(0),n=t.globalOrder-i.current;i.current=t.globalOrder;return(0,b.tZ)(c.M,{initial:!1,custom:n,children:(0,b.tZ)(d.E.div,{className:"motion-style",variants:{enter:e=>({x:e>0?"100vw":"-100vw"}),center:{zIndex:1,x:0,transitionEnd:{x:0}},exit:e=>({zIndex:0,x:e<0?"100vw":"-100vw"})},initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:100,damping:16}},custom:n,children:t.isItem?(0,b.tZ)(_e,{item:t.element},t.element.id):(0,b.tZ)(je,{section:t.element},t.element.id)},t.globalOrder)})})),Te={name:"1mzska6",styles:">div{margin-bottom:40px;}"},Ne=(0,s.observer)((function(e){let{section:t}=e;return(0,b.BX)("div",{css:Te,children:[(0,b.tZ)("div",{children:(0,b.tZ)(je,{section:t,nav:!1})}),t.items.map((e=>(0,b.tZ)("div",{children:(0,b.tZ)(_e,{item:e,nav:!1})},e.id))),(0,b.tZ)("div",{children:(0,b.tZ)(ze,{})})]})})),Ie=e=>{var t,i;const n={};return null!==(t=e.data)&&void 0!==t&&null!==(i=t.item_options)&&void 0!==i&&i.background_color&&(n.backgroundColor=e.data.item_options.background_color),n},De=e=>{let{direction:t}=e;return(0,n.iv)("display:flex;flex-direction:column;direction:",t,";.content-name{margin-bottom:5px;font-size:2.2em;font-weight:700;}.content-desc{font-size:1.1em;text-align:","rtl"===t?"right":"left",";}.headline{margin-bottom:5px;font-size:1.8em;font-weight:700;}.line-separate{height:2px;background-color:",r.g.colors.separator,";margin:30px -40px;}","")},je=e=>{let{section:t,nav:i=!0}=e;const n=(0,X.ip)(),r=n.Content.activeElement,s=n.direction;return(0,b.BX)("div",{css:De({direction:s}),children:[i&&(0,b.tZ)(ye,{}),(0,b.BX)(A.J3,{children:[0===r.globalOrder&&(0,b.BX)(b.HY,{children:[(0,b.BX)("div",{children:[(0,b.tZ)("div",{className:"content-name",children:n.Content.data.lesson_name}),n.Content.data.lesson_description&&(0,b.tZ)(u.xn,{className:"content-desc",content:n.Content.data.lesson_description})]}),(0,b.tZ)("div",{className:"line-separate"})]}),(0,b.tZ)("div",{className:"headline",children:t.title}),t.description&&(0,b.tZ)(u.xn,{content:t.description})]})]})},Pe={name:"matjqf",styles:"display:flex;font-size:1.5em;align-items:center;justify-content:space-between"},ze=()=>{var e;const t=(0,X.ip)(),i=t.Content.SectionF.getActiveIndex,n=t.Content.sectionList.length-1,r=!(null!==(e=t.Content)&&void 0!==e&&e.canGoBack);return(0,b.BX)("div",{css:Pe,children:[(0,b.tZ)("div",{className:(0,m.AK)("nav-near",{disabled:0===i||r}),children:(0,b.tZ)(B.l,{theme:"composed",disabled:0===i||r,onClick:0===i?void 0:()=>t.Content.previousSection(),children:lng("back|editor").caps()})}),(0,b.tZ)("div",{children:i===n?(0,b.tZ)(B.l,{theme:"composed",active:!0,onClick:()=>{if(!t.Content.validateRequiredQuestions())return!1;(0,me.BB)(lng("are you sure you want to submit?|editor"),{onConfirm:()=>t.submit()})},children:lng("submit|editor").caps()}):(0,b.tZ)(B.l,{theme:"composed",active:!0,onClick:()=>t.Content.handleSelectElement(t.Content.sectionList[i+1]),children:lng("next|editor").caps()})})]})},Ee={name:"1i715f",styles:"display:flex;font-size:1.5em;align-items:center;justify-content:center;height:100%"},Re=()=>{const e=(0,X.ip)(),t=e.Content.activeElement;return(0,b.tZ)("div",{css:Ee,children:t.globalOrder===e.Content.maxElementIndex?(0,b.tZ)(B.l,{theme:"composed",active:!0,onClick:()=>{if(!e.validate())return!1;(0,me.BB)(lng("are you sure you want to submit?|editor"),{onConfirm:()=>e.submit()})},children:lng("submit|editor").caps()}):(0,b.tZ)(B.l,{theme:"composed",active:!0,onClick:()=>e.Content.nextElement(),children:lng("continue|editor").caps()})})},Fe=(0,n.iv)("position:absolute;background-image:url(",r.g.func.imgUrl("editor:strip/city.jpg"),");background-repeat:repeat-x;padding:15px 12px;height:250px;width:100%;margin-top:-40px;",""),Me=()=>(0,b.tZ)("div",{css:Fe,className:"player-strip"})},5951:(e,t,i)=>{i.d(t,{w:()=>u});var n=i(917),r=i(6920),s=i(5560),o=i(4773),a=i(5192),l=i(441),c=i(6975),d=i(5944);const p=(0,n.iv)("position:fixed;z-index:",r.g.z.top_bar,";top:0;height:",r.g.consts.TOP_BAR_HEIGHT,"px;",r.g.classes.near("0"),";width:100vw;background-color:",r.g.colors.bg_main,";color:",r.g.colors.text_sec,";",r.g.classes.shadow_strong," border-bottom:1px solid ",r.g.colors.separator_light,";display:flex;align-items:center;justify-content:space-between;>.near{width:40px;",r.g.classes.margin_near("25px"),";}>.middle{flex-grow:1;display:flex;justify-content:space-between;>.title{color:",r.g.colors.text_main,";font-weight:700;font-size:1.2rem;flex-grow:1;text-align:center;padding:20px;}}>.far{width:35px;",r.g.classes.margin_near("10px"),";",r.g.classes.margin_far("20px"),";font-size:20px;color:",r.g.colors.text_sec,";display:flex;justify-content:space-between;gap:4px;}>.progress-bar{position:absolute;bottom:-5px;height:10px;background-color:",r.g.colors.blossom,";width:0;transition:width .3s;}",""),u=(0,s.observer)((()=>{const e=(0,o.ip)();return(0,d.BX)("div",{css:p,className:"react_container",children:[(0,d.tZ)("div",{className:"near",children:(0,d.tZ)(l.A,{className:"_logo",href:r.g.theme.homePage,newTab:!0,children:(0,d.tZ)(a.T,{})})}),(0,d.tZ)("div",{className:"middle",children:(0,d.tZ)("div",{className:"title",children:e.title})}),(0,d.tZ)("div",{className:"far",children:e.toEdit&&(0,d.tZ)(c.JO,{buttonLike:!0,icon:"edit",toolTip:lng("back to editor|editor"),onClick:()=>e.toEdit()})}),(0,d.tZ)("div",{className:"progress-bar",style:{width:e.Content.progress+"%"}})]})}))},4773:(e,t,i)=>{i.d(t,{ck:()=>Se,OS:()=>Te,P8:()=>Be,ip:()=>De,EK:()=>Ie});var n,r=i(7363),s=i(7821),o=i(9011);function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let l=(n=class extends o.ye{constructor(e){super(),a(this,"Manager",void 0),(0,s.makeObservable)(this),this.Manager=e,this.activeItem=this.Manager.navDrawer}get menuOptions(){return[{id:"nav",label:lng("content|editor",{phrase:!0}),icon:"content",onClick:()=>this.changeDrawer("nav")},{id:"style",label:lng("style|editor",{phrase:!0}),icon:"vendor_text",onClick:()=>this.changeDrawer("style")},{id:"settings",label:lng("settings|editor",{phrase:!0}),icon:"settings",onClick:()=>this.changeDrawer("settings")}]}changeDrawer(e){this.Manager.setNavDrawer(e),this.activeItem=this.Manager.navDrawer}},c=n.prototype,d="menuOptions",p=[s.computed],u=Object.getOwnPropertyDescriptor(n.prototype,"menuOptions"),m=n.prototype,g={},Object.keys(u).forEach((function(e){g[e]=u[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(c,d,e)||e}),g),m&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(m):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(c,d,g),g=null),n);var c,d,p,u,m,g,h,b,v,_,f=i(8318),y=i(8e3);function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function x(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function k(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Z=(h=class{constructor(e){w(this,"stage",b,this),x(this,"Editor",void 0),x(this,"nav",void 0),x(this,"paramsObject",{type:void 0,mode:void 0,lang:void 0}),x(this,"list",!1),w(this,"contentList",v,this),w(this,"listLoaded",_,this),(0,s.makeObservable)(this),this.Editor=e.editor,this.nav=e.nav,this.goBack=e.goBack;const[t,i,n]=e.route;"list"===t?this.setParams({list:!0}):this.setParams({type:t,mode:i,lang:n})}setParams(e){let{type:t,mode:i,list:n}=e;if(this.paramsObject={},this.list=n||!1,this.stage=this.list?-1:0,!this.list&&["test","survey","evaluation","form","checklist"].includes(t)){if(this.paramsObject.type=t,"checklist"===t)return void(this.stage=3);this.stage=1,["form","presentation"].includes(i)&&(this.paramsObject.mode=i,this.stage=3)}}updateRoute(){const{type:e,mode:t,lang:i}=this.paramsObject;if(this.list)this.nav(["list"]);else{const n=[e,t,null==i?void 0:i.join(",")].filter((e=>void 0!==e));this.nav(n)}}type(e){this.setParams({type:e}),this.updateRoute()}mode(e){this.setParams({type:this.paramsObject.type,mode:e}),this.updateRoute()}lang(e){this.setParams({type:this.paramsObject.type,mode:this.paramsObject.mode,lang:e}),this.updateRoute()}back(){switch(this.stage){case 0:this.goBack?this.goBack():this.Editor.toSystem();break;case 1:this.setParams({}),this.updateRoute();break;case 2:case 3:this.setParams({type:this.paramsObject.type}),this.updateRoute()}}finish(e,t){this.paramsObject.name=e,this.paramsObject.desc=t,this.Editor.create(this.paramsObject)}showList(){this.setParams({list:!0}),this.updateRoute()}getList(){if(!this.listLoaded&&!this.fetching){this.fetching=!0;const e={folder:"personal",no_limit:!0,type:["survey","test","courseware","evaluation","form"],forms:"any",cur_version:"2"};return(0,y.SC)("catalog/my",{data:e},(0,s.action)((e=>{this.contentList=e.my,this.listLoaded=!0}))),[]}return this.contentList}},b=k(h.prototype,"stage",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=k(h.prototype,"contentList",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=k(h.prototype,"listLoaded",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h);var C,S,O=i(9841),B=i(7187);function T(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function N(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let I=(C=class{constructor(e){T(this,"Content",void 0),function(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}(this,"activeId",S,this),(0,s.makeObservable)(this),this.Content=e}setActive(e){this.activeId=e,this.Content.ItemF.activeId=null,this.Content.Manager.searchTerm="",this.Content.Manager.updateUrl(),this.Content.handleDisabledContent()}get list(){return this.Content.sectionList.filter((e=>e.match(this.Content.Manager.searchTerm))).sort(((e,t)=>e.order-t.order))||[]}get getActive(){return this.activeId?this.byId(this.activeId):this.Content.ItemF.activeId?this.byItemId(this.Content.ItemF.activeId):this.list.length>0?this.list[0]:null}get getActiveIndex(){const e=this.getActive;return this.Content.sectionList.findIndex((t=>t===e))}select(e){this.setActive(e.id)}byItemId(e){if(0===this.list.length)return null;for(const t of this.list)if(t.itemById(e))return t;return null}byId(e){return 0===this.list.length?null:this.list.find((t=>t.matchId(e)))}create(e){const t=new B.I(e,this.Content.Manager);return this.Content.sectionList=[...this.Content.sectionList,t],this.Content.listByInternalId.section[t.internalId]=t,t}new(){const e=this.Content.sectionList.length+1,t=this.create({section_headline:`${lng("section|editor").caps()} ${e}`,section_order:e});return this.Content.addToChanges("sections",t.data,t.internalId),this.setActive(t.id),t}order(e){this.Content.sectionList.forEach((t=>t.order=e.findIndex((e=>e===t.id))+1))}numberOfItemsBefore(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=0;for(const n of this.Content.sectionList){if(n===e)break;i+=n.count+(t?1:0)}return i}},S=N(C.prototype,"activeId",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N(C.prototype,"list",[s.computed],Object.getOwnPropertyDescriptor(C.prototype,"list"),C.prototype),N(C.prototype,"getActive",[s.computed],Object.getOwnPropertyDescriptor(C.prototype,"getActive"),C.prototype),N(C.prototype,"getActiveIndex",[s.computed],Object.getOwnPropertyDescriptor(C.prototype,"getActiveIndex"),C.prototype),C);var D,j;function P(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let E=(D=class{constructor(e){P(this,"Content",void 0),function(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}(this,"activeId",j,this),P(this,"lastActiveId",null),(0,s.makeObservable)(this),this.Content=e}setActive(e){this.lastActiveId=this.activeId,this.activeId=e,this.Content.SectionF.activeId=null,this.Content.Manager.updateUrl(),this.Content.handleDisabledContent()}get getActive(){return this.byId(this.activeId)}byId(e){let t;for(const i of this.Content.sectionList)if(t=i.itemById(e),t)return t;return null}get list(){let e=[];for(const t of this.Content.SectionF.list)e=[...e,...t.items];return e}get activeIndex(){return this.list.findIndex((e=>e.matchId(this.activeId)))}newInCurrentSection(e){var t;const i=this.Content.SectionF.getActive;if(!i)return null;const n=i.newItem(e,(null===(t=this.getActive)||void 0===t?void 0:t.order)||0);return n&&this.setActive(n.id),n}duplicate(){var e;const t=this.Content.SectionF.getActive;if(!t)return null;const i=t.copyItem(this.getActive,(null===(e=this.getActive)||void 0===e?void 0:e.order)||0);return this.setActive(i.id),i}},j=z(D.prototype,"activeId",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z(D.prototype,"setActive",[s.action],Object.getOwnPropertyDescriptor(D.prototype,"setActive"),D.prototype),z(D.prototype,"getActive",[s.computed],Object.getOwnPropertyDescriptor(D.prototype,"getActive"),D.prototype),z(D.prototype,"list",[s.computed],Object.getOwnPropertyDescriptor(D.prototype,"list"),D.prototype),z(D.prototype,"activeIndex",[s.computed],Object.getOwnPropertyDescriptor(D.prototype,"activeIndex"),D.prototype),D);var R,F,M,A,q,X,L=i(5519),$=i(4576),V=i(8534),U=i(8567);function H(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function J(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function G(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let W=(R=class{constructor(e){J(this,"lesson_id",void 0),H(this,"data",F,this),H(this,"sectionList",M,this),J(this,"Manager",void 0),J(this,"ItemF",void 0),J(this,"SectionF",void 0),J(this,"listByInternalId",{section:{},item:{},part:{}}),H(this,"history",A,this),H(this,"historyLocation",q,this),J(this,"changes",{}),H(this,"countDirty",X,this),(0,s.makeObservable)(this),this.clearChanges(),this.Manager=e,this.data=new O.af({lesson_type:"test"}),this.ItemF=new E(this),this.SectionF=new I(this)}loadFromServer(e){var t,i,n;this.data=new O.af(e.content),this.lesson_id=e.content.lesson_id;const r="play"===this.Manager.mode;if(this.sectionList=[],(null==e||null===(t=e.sections)||void 0===t?void 0:t.length)>0){var s,o;const t=null===(s=this.data.lesson_options)||void 0===s?void 0:s.limit_sections,i=null===(o=this.data.lesson_options)||void 0===o?void 0:o.pagesShuffle;r&&(t>0||i)&&(e.sections=this.shuffleSectionsOrder(e.sections,t),e.items=e.items.filter((t=>e.sections.find((e=>e.section_id===t.section_id))))),e.sections.forEach((e=>this.SectionF.create(e)))}const a={};if((null==e||null===(i=e.items)||void 0===i?void 0:i.length)>0){var l;const t=!(null===(l=this.data.lesson_options)||void 0===l||!l.shuffle)||e.sections.some((e=>{var t,i;return(null===(t=e.section_options)||void 0===t?void 0:t.asked_questions)>0||(null===(i=e.section_options)||void 0===i?void 0:i.shuffle)}));r&&t&&(e.items=this.shuffleSectionQuestionsOrder(e)),null==e||e.items.forEach((e=>{const t=this.SectionF.byId(e.section_id);t||console.error(`section ${e.section_id} for item ${e.item_id} not found`);const i=t.loadItem(e);a[i.id]=i}))}(null==e||null===(n=e.parts)||void 0===n?void 0:n.length)>0&&(null==e||e.parts.forEach((e=>{var t;null===(t=a[e.item_id])||void 0===t||t.loadPart(e)}))),this.ItemF.activeId&&-1===this.ItemF.activeIndex&&(this.ItemF.activeId=null),this.SectionF.activeId&&!this.SectionF.byId(this.SectionF.activeId)&&(this.SectionF.activeId=null),this.SectionF.activeId||this.ItemF.activeId||this.SectionF.list[0]&&this.SectionF.setActive(this.SectionF.list[0].id)}loadFromWizard(e){const{mode:t,lang:i,type:n,name:r,desc:s}=e;this.data=new O.af({lesson_name:r,lesson_description:s,lesson_type:n,presentation_view:"presentation"===t,languages:i}),this.addToChanges("content",this.data)}get title(){var e;return null===(e=this.data)||void 0===e?void 0:e.lesson_name}get type(){var e;return null===(e=this.data)||void 0===e?void 0:e.lesson_type.toLowerCase()}typeIs(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.includes(this.type)}get activeElement(){const e=this.ItemF.getActive;if(e)return{isItem:!0,element:e,globalOrder:e.globalOrder};const t=this.SectionF.getActive;return{isItem:!1,element:t,globalOrder:t.globalOrder}}get maxElementIndex(){const e=this.SectionF.list[this.SectionF.list.length-1];return this.Manager.Content.SectionF.numberOfItemsBefore(e)+e.count}shuffleSectionQuestionsOrder(e){let{items:t,sections:i}=e;const n={};return i.forEach((e=>{var i,r;const s=null==e||null===(i=e.section_options)||void 0===i?void 0:i.asked_questions,o=null==e||null===(r=e.section_options)||void 0===r?void 0:r.shuffle,a=t.filter((t=>t.section_id===e.section_id));(o?(0,f.Sy)(a):a).forEach(((e,t)=>e.item_order=t+1)),n[e.section_id]=s?a.slice(0,s):a})),Object.values(n).flat()}shuffleSectionsOrder(e,t){var i;const n=null===(i=(0,f.Sy)(e))||void 0===i?void 0:i.map(((e,t)=>(e.section_order=t,e)));return t&&t>0?n.slice(0,t):n}checkNextElementDisabled(){var e;const t=this.SectionF.getActive,i=this.ItemF.getActive;if(!i)return null===(e=t.items[0])||void 0===e?void 0:e.disabled;{var n;const e=t.items.findIndex((e=>e===i));if(e!==t.items.length-1)return null===(n=t.items[e+1])||void 0===n?void 0:n.disabled;this.checkNextSectionDisabled()}}checkPreviousElementDisabled(){const e=this.SectionF.getActive,t=this.ItemF.getActive;if(t){const i=e.items.findIndex((e=>e===t));return 0===i?e.disabled:e.items[i-1].disabled}{const t=this.sectionList.findIndex((t=>t===e));if(t>0){const e=this.sectionList[t-1];return e.items.length>0?e.items[e.items.length-1].disabled:e.disabled}}}checkNextSectionDisabled(){const e=this.SectionF.getActiveIndex;if(e<this.sectionList.length-1)return this.sectionList[e+1].disabled}previousElement(){const e=this.SectionF.getActive,t=this.ItemF.getActive;if(t){const i=e.items.findIndex((e=>e===t));0===i?this.SectionF.setActive(e.id):this.ItemF.setActive(e.items[i-1].id)}else{const t=this.sectionList.findIndex((t=>t===e));if(t>0){const e=this.sectionList[t-1];e.items.length>0?this.ItemF.setActive(e.items[e.items.length-1].id):this.SectionF.setActive(e.id)}}}previousSection(){const e=this.SectionF.getActiveIndex;e>0&&this.SectionF.setActive(this.sectionList[e-1].id)}nextElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=e?e.Section:this.SectionF.getActive,i=e||this.ItemF.getActive;if(i){const n=t.items.findIndex((e=>e===i));n!==t.items.length-1||e?this.ItemF.setActive(t.items[e?n:n+1].id):this.nextSection()}else t.items.length>0?this.ItemF.setActive(t.items[0].id):this.nextSection()}nextSection(){const e=this.SectionF.getActiveIndex;e<this.sectionList.length-1&&this.SectionF.setActive(this.sectionList[e+1].id)}get canGoBack(){const e=this.activeElement,t=this.SectionF.getActive.data.section_options,{disable_back:i,disable_back_inner:n}=t||{};if(e.isItem)return!(i&&1===e.element.data.item_order||n);{const e=this.sectionList[this.SectionF.getActiveIndex-1],t=null==e?void 0:e.data.section_options.disable_back_inner;return!(i||n||t)}}handleDisabledContent(){const e=this.activeElement.element,t=e.globalItemOrder,i=this.SectionF.byId(e.data.section_id).order,n=this.sectionList;let r=!1;n.slice(0,i).reverse().forEach((e=>{const{disable_back:n,disable_back_inner:s}=e.data.section_options;s&&(r=!0),r&&(e.order<i&&r?(e.disabled=!0,e.items.forEach((e=>(!!s&&(r=!0),e.disabled=!0)))):e.order===i&&this.data.presentation_view&&e.items.forEach((e=>e.globalItemOrder<t&&(e.disabled=!0)))),n&&(r=!0)}))}nextActiveElement(){let e,{section:t,item:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{section:this.SectionF.getActive,item:this.ItemF.getActive};if(t.items.forEach((t=>!e&&(!i||t.globalItemOrder>i.globalItemOrder)&&t!==i&&!t.disabled&&(e=t))),e)return e;{const e=this.SectionF.getActiveIndex,t=this.sectionList[e+1];return!!t&&this.nextActiveElement({section:t})}}alertRequired(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;(arguments.length>1?arguments[1]:void 0)?e.forEach((e=>{e.alert_force_answer=!0,e.items.forEach((e=>e.alert_force_answer=!0))})):e.forEach((e=>e.alert_force_answer=!0))}handleSelectElement(e){if(console.log(e),!this.data.presentation_view&&e.globalItemOrder)return;const t=this.activeElement.element,i=t.globalItemOrder?t.Section:t,n=e.globalItemOrder?e.Section:e;let r={},s=!1;if(i===n)if(e.locker){const i=n.items.slice(t.order-1,e.order-1).filter((e=>e.required));i.length>0?r={items:i,section:!1}:s=!0}else s=!0;else if(i.order<n.order){const e=this.sectionList.slice(i.order-1,n.order-1).filter((e=>e===i&&e.required||e.globalOrder>i.globalOrder&&e.required&&e.locker));e.length>0?r={items:e,section:!0}:s=!0}else s=!e.disabled;return s?e.locker?(0,U.BB)(lng("you won't be able to go back, are you sure?").caps(),{onConfirm:()=>e.globalItemOrder?this.ItemF.setActive(e.id):this.SectionF.select(e),confirmText:lng("continue")}):e.globalItemOrder?this.ItemF.setActive(e.id):this.SectionF.select(e):(this.alertRequired(r.items,r.section),(0,V.LB)({msg:lng("you have unanswered required questions!").caps(),type:"warning",closeOnClick:!0}))}validateRequiredQuestions(){return!this.sectionList.some((e=>e.required))||(this.alertRequired(this.sectionList,!0),(0,V.LB)({msg:lng("you have unanswered required questions!").caps(),type:"warning",closeOnClick:!0}))}change(e,t){this.addToHistory("content",e,t,this.data),this.modify(e,t),this.addToChanges("content",this.data)}modify(e,t){const i={...this.data};if(e.includes(".")){const n=e.split(".");i[n[0]][n[1]]=t}else i[e]=t;this.data=new O.af(i)}dataByName(e){if(e.includes(".")){const t=e.split(".");return this.data[t[0]][t[1]]||""}return this.data[e]}addToHistory(e,t,i,n){this.history.push({key:e,name:t,value:i,data:n}),this.historyLocation++}addToChanges(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(e){case"content":this.changes.content=t;break;case"sections":this.changes.sections[i]=t;break;case"items":this.changes.items[i]=t;break;case"parts":this.changes.parts[i]=t;break;case"order":this.changes.order[i]=t;break;case"files":this.changes.files[i]=t}this.countDirty=Object.values(this.changes).reduce(((e,t)=>e+(t?Object.values(t).length:0)),0)}saveData(){return{lesson_id:this.lesson_id,...this.changes,...this.changes.files}}syncSavedChanges(e){if(this.lesson_id||(this.lesson_id=e.id),e.sections){for(const t in e.sections)this.changes.sections[t].section_id||this.listByInternalId.section[t].modify("section_id",e.sections[t]),this.changes.sections[t].lesson_id||this.listByInternalId.section[t].modify("lesson_id",e.id);this.SectionF.activeId&&this.listByInternalId.section[this.SectionF.activeId]&&(this.SectionF.activeId=this.listByInternalId.section[this.SectionF.activeId].id)}if(e.items){for(const t in e.items)this.changes.items[t].item_id||this.listByInternalId.item[t].modify("item_id",e.items[t]),this.changes.items[t].section_id||this.listByInternalId.item[t].modify("section_id",e.sections[this.changes.items[t].section_internal]);this.ItemF.activeId&&this.listByInternalId.item[this.ItemF.activeId]&&(this.ItemF.activeId=this.listByInternalId.item[this.ItemF.activeId].id)}if(e.parts)for(const t in e.parts)this.changes.parts[t].part_id||this.listByInternalId.part[t].modify("part_id",e.parts[t]),this.changes.parts[t].item_id||this.listByInternalId.part[t].modify("item_id",e.items[this.changes.parts[t].item_internal]);if(e.files)for(const t in e.files){const i=this.ItemF.list.find((i=>i.matchId(e.files[t].object_id)));if(i){const n=i.files,r=n.findIndex((e=>e.id===t));n[r]=e.files[t],n[r].id=t,i.files=[...n]}}this.clearChanges()}clearChanges(){this.countDirty=0,this.changes={content:null,sections:{},items:{},parts:{},order:{},files:{}}}get dirty(){return this.countDirty>0}get fields(){return{0:this.settingsFields,1:this.styleFields}}get settingsFields(){const e=[[1,lng("no feedback|editor").caps()],[2,lng("correct/wrong|editor").caps()],[3,lng("correct/wrong|editor").caps()+" + "+lng("added information|editor").caps()]],t=[["",lng("user settings|editor").caps()],["ltr",lng("left to right|editor").caps()],["rtl",lng("right to left|editor").caps()]],i=[...L.z9].map((e=>[e,(0,$.BP)(e).caps(!1)])),n=[];return Blsm.isFeatureEnabled("tests")&&n.push(["test",lng("test|editor")]),Blsm.isFeatureEnabled("survey")&&n.push(["survey",lng("survey|editor")]),Blsm.isFeatureEnabled("evaluation")&&n.push(["evaluation",lng("evaluation|editor")]),Blsm.isFeatureEnabled("questionnaire_forms")&&n.push(["form",lng("form|editor")]),[{type:"select",name:"lesson_type",label:lng("type|editor"),options:n},{type:"select",name:"lesson_category_id",label:lng("category|editor"),options:Blsm.InitialData.Categories},{type:"select",name:"estimated_duration",label:lng("duration|editor"),options:i},{type:"select",name:"lesson_options.feedback",label:lng("feedback|editor"),options:e},{type:"select",name:"lesson_options.direction",label:lng("direction|editor"),options:t},{type:"number",labelFirst:!0,name:"lesson_options.limit_sections",label:lng("shown sections|editor"),min:0},{type:"toggle",labelFirst:!0,name:"presentation_view",label:lng("presentation|editor")},{type:"toggle",labelFirst:!0,name:"lesson_options.shuffle",label:lng("shuffle questions from sections|editor")},{type:"toggle",labelFirst:!0,name:"lesson_options.pagesShuffle",label:lng("shuffle sections|editor")},{type:"toggle",labelFirst:!0,name:"questionnaire_dynamic",label:lng("mark as practice|editor")},{type:"toggle",labelFirst:!0,name:"lesson_options.mustAnswer",label:lng("force to answer|editor")},{type:"toggle",labelFirst:!0,name:"lesson_public",label:lng("available to all managers|editor")},{type:"toggle",labelFirst:!0,name:"survey_anonymous",label:lng("anonymous survey|editor")}]}get styleFields(){return[{type:"toggle",labelFirst:!0,name:"lesson_public",label:lng("available to all managers|editor")},{type:"toggle",labelFirst:!0,name:"survey_anonymous",label:lng("anonymous survey|editor")}]}get progress(){const e=[];return this.ItemF.list.forEach((t=>{t.typeObject.progress>=0&&e.push(t.typeObject.progress)})),e.length>0?e.reduce(((e,t)=>e+t),0)/e.length*100:0}validateCanGoBack(){const e=this.activeElement,t=this.SectionF.getActive.data.section_options,{disable_back:i,disable_back_inner:n}=t||{};return!!(e.isItem?i&&1===e.element.data.item_order||n:i||n)}},F=G(R.prototype,"data",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=G(R.prototype,"sectionList",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=G(R.prototype,"history",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),q=G(R.prototype,"historyLocation",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),X=G(R.prototype,"countDirty",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G(R.prototype,"title",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"title"),R.prototype),G(R.prototype,"type",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"type"),R.prototype),G(R.prototype,"activeElement",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"activeElement"),R.prototype),G(R.prototype,"maxElementIndex",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"maxElementIndex"),R.prototype),G(R.prototype,"canGoBack",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"canGoBack"),R.prototype),G(R.prototype,"change",[s.action],Object.getOwnPropertyDescriptor(R.prototype,"change"),R.prototype),G(R.prototype,"modify",[s.action],Object.getOwnPropertyDescriptor(R.prototype,"modify"),R.prototype),G(R.prototype,"dirty",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"dirty"),R.prototype),G(R.prototype,"fields",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"fields"),R.prototype),G(R.prototype,"settingsFields",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"settingsFields"),R.prototype),G(R.prototype,"styleFields",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"styleFields"),R.prototype),G(R.prototype,"progress",[s.computed],Object.getOwnPropertyDescriptor(R.prototype,"progress"),R.prototype),R);var K,Y,Q,ee;function te(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ie(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let ne=(K=s.observable.shallow,Q=ie((Y=class{constructor(){te(this,"Content",Q,this),te(this,"loading",ee,this),(0,s.makeObservable)(this)}}).prototype,"Content",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=ie(Y.prototype,"loading",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Y);var re,se,oe,ae,le,ce,de,pe,ue,me,ge=i(441),he=i(6920);function be(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ve(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _e(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let fe=(se=_e((re=class extends ne{constructor(){super(),ve(this,"sideMenuStore",void 0),ve(this,"curHash",void 0),ve(this,"lastEditHash",void 0),be(this,"mode",se,this),be(this,"contentId",oe,this),be(this,"itemDrawer",ae,this),be(this,"navDrawer",le,this),be(this,"sectionDrawer",ce,this),be(this,"searchTerm",de,this),be(this,"wizardId",pe,this),ve(this,"status",new ye),ve(this,"wizard",void 0),ve(this,"intervalHandle",null),ve(this,"saveTimeStamp",null),ve(this,"intervalCheck",15e3),ve(this,"minimumSaveGap",1e4),(0,s.makeObservable)(this),this.sideMenuStore=new l(this),this.Content=new W(this),this.handleNav()}handleNav(){this.curHash=(0,f.VD)(),this.loadUrl(),window.addEventListener("hashchange",(()=>this.loadNewHash()))}loadNewHash(){const e=(0,f.VD)();this.curHash!==e&&(this.curHash=e,this.loadUrl())}loadUrl(){const e=(0,f.cW)(this.curHash);switch(this.mode=e[0]||this.mode,this.contentId=null,this.searchTerm="",this.mode){case"edit":if((0,f.B5)(e[1])){this.lastEditHash=this.curHash,this.contentId=e[1];const t=(0,f.Kn)(e[2])?e[2]:{};return t.search&&(this.searchTerm=decodeURIComponent(t.search)),this.loadContent(this.contentId,"edit",t)}if("new"===e[1])return this.Content.SectionF.new();break;case"play":return(0,f.B5)(e[1])?(this.contentId=e[1],this.loadContent(this.contentId,"play")):void 0;case"wizard":return this.loadWizard(e,this.lastEditHash?()=>this.nav(this.lastEditHash):void 0);default:return this.toWizard()}}nav(e){let{trigger:t=!0,replace:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.curHash=e.trimStart(),i?location.replace("#"+this.curHash):location.href="#"+this.curHash,t&&this.loadUrl()}updateUrl(){let{trigger:e=!1,replace:t=!0,mode:i,params:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=(0,f.cW)(this.curHash);let s="";switch(i=i||r[0],i){case"edit":{const e=(null==n?void 0:n.id)||r[1],t=(null==n?void 0:n.item)||this.Content.ItemF.activeId,o=(null==n?void 0:n.section)||this.Content.SectionF.activeId,a={};s+=`${i}/${e}`,o?a.section=o:(this.searchTerm.trim()&&(a.search=encodeURIComponent(this.searchTerm.trim())),t&&(a.item=t)),s+=`/${(0,f.Wh)(a)}`;break}case"play":s+=`${i}/${(null==n?void 0:n.id)||r[1]}`;break;case"wizard":s+=i,n&&(s+="/"+n.join("/"))}this.nav(s,{trigger:e,replace:t})}toSystem(){location.href=Blsm.prm.Mainref}toWizard(){this.updateUrl({mode:"wizard",trigger:!0,replace:!1})}toPreview(){this.updateUrl({mode:"play",trigger:!0,replace:!1})}toEdit(){this.updateUrl({mode:"edit",trigger:!0,replace:!1})}toPublish(){location.href=Blsm.prm.Mainref+(0,ge.p4)({edit:"assignment",params:{content:this.contentId}})}loadContent(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.loading=!0,(0,y.SC)(`editor/${t}/${e}`,{selfErrorHandling:!0,onError:(e,t)=>t()},(0,s.action)((e=>{this.Content=new W(this),i.section?this.Content.SectionF.activeId=i.section:i.item&&(this.Content.ItemF.activeId=i.item),this.Content.loadFromServer(e),this.loading=!1})))}timestamp(){return(new Date).getTime()}saveContent(){var e;if(null===(e=this.Content.data)||void 0===e||!e.lesson_name)return(0,V.Mj)(lng("content name missing|editor"));this.status.saving=!0,(0,y.SC)("editor/save",{method:"POST",data:this.Content.saveData(),json:!0,onComplete:()=>{this.saveTimeStamp=this.timestamp()},onError:()=>{this.status.saved=!1}},(e=>{e.id?(this.contentId=e.id,this.Content.syncSavedChanges(e),this.updateUrl({mode:"edit",params:{id:e.id}}),this.status.saved=!0):this.status.saved=!1}))}autoSave(){var e;if(!(!1===this.saveTimeStamp||this.timestamp()-this.saveTimeStamp<this.minimumSaveGap)&&null!==(e=this.Content.data)&&void 0!==e&&e.lesson_name){if(this.saveTimeStamp=!1,!this.Content.dirty())return this.saveTimeStamp=this.timestamp();this.saveContent()}}loadWizard(e,t){this.wizard=new Z({editor:this,route:e.slice(1),nav:e=>this.updateUrl({mode:"wizard",params:e}),goBack:t}),this.wizardId=(0,f.YR)()}setItemDrawer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.itemDrawer=t?this.itemDrawer===e?"":e:e||""}setSectionDrawer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.sectionDrawer=t?this.sectionDrawer===e?"":e:e||""}setNavDrawer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.navDrawer=t?this.navDrawer===e?"":e:e||""}get direction(){const e=this.Content.data.lesson_options.direction,t=he.g.isRTL?"rtl":"ltr";return e||t}get title(){return this.Content.title||"Blossom Editor"}get search(){return this.searchTerm}set search(e){this.searchTerm=e,this.updateUrl()}create(e){this.Content=new W(this),this.Content.loadFromWizard(e),this.updateUrl({trigger:!0,replace:!1,mode:"edit",params:{id:"new",item:null}})}sync(){}submit(){}validate(){return!0}}).prototype,"mode",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),oe=_e(re.prototype,"contentId",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=_e(re.prototype,"itemDrawer",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),le=_e(re.prototype,"navDrawer",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"nav"}}),ce=_e(re.prototype,"sectionDrawer",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),de=_e(re.prototype,"searchTerm",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),pe=_e(re.prototype,"wizardId",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_e(re.prototype,"loadUrl",[s.action],Object.getOwnPropertyDescriptor(re.prototype,"loadUrl"),re.prototype),_e(re.prototype,"setItemDrawer",[s.action],Object.getOwnPropertyDescriptor(re.prototype,"setItemDrawer"),re.prototype),_e(re.prototype,"setSectionDrawer",[s.action],Object.getOwnPropertyDescriptor(re.prototype,"setSectionDrawer"),re.prototype),_e(re.prototype,"setNavDrawer",[s.action],Object.getOwnPropertyDescriptor(re.prototype,"setNavDrawer"),re.prototype),_e(re.prototype,"direction",[s.computed],Object.getOwnPropertyDescriptor(re.prototype,"direction"),re.prototype),_e(re.prototype,"title",[s.computed],Object.getOwnPropertyDescriptor(re.prototype,"title"),re.prototype),_e(re.prototype,"search",[s.computed],Object.getOwnPropertyDescriptor(re.prototype,"search"),re.prototype),re),ye=(me=_e((ue=class{constructor(){be(this,"cur",me,this),(0,s.makeObservable)(this)}set saving(e){this.cur=e?"saving":""}set saved(e){this.cur=!0===e?"save_success":!1===e?"save_fail":"",setTimeout((()=>this.cur=""),5e3)}get value(){return this.cur||"normal"}get title(){switch(this.cur){case"saving":return lng("saving|editor").caps();case"save_success":return lng("saved successfully|editor").caps();case"save_fail":return lng("save failed|editor").caps()}return lng("idle|editor").caps()}get color(){switch(this.cur){case"saving":return he.g.colors.yellow;case"save_success":return he.g.colors.positive;case"save_fail":return he.g.colors.negative}return he.g.colors.dominant_white}}).prototype,"cur",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_e(ue.prototype,"value",[s.computed],Object.getOwnPropertyDescriptor(ue.prototype,"value"),ue.prototype),_e(ue.prototype,"title",[s.computed],Object.getOwnPropertyDescriptor(ue.prototype,"title"),ue.prototype),_e(ue.prototype,"color",[s.computed],Object.getOwnPropertyDescriptor(ue.prototype,"color"),ue.prototype),ue);var we,xe;function ke(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ze(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Ce=(we=class extends ne{constructor(e){super(),ke(this,"params",void 0),ke(this,"assignment",void 0),ke(this,"resume",void 0),function(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}(this,"showing",xe,this),ke(this,"errorMessage",void 0),ke(this,"sessionData",void 0),ke(this,"sessionKey",void 0),ke(this,"syncQueue",[]),ke(this,"syncTimeout",0),ke(this,"lastSyncTime",0),ke(this,"mode","play"),(0,s.makeObservable)(this),this.params=e,this.loadContent(this.params.assignment_id)}updateUrl(){}loadContent(e){this.loading=!0,(0,y.SC)(`editor/launch/${e}`,{selfErrorHandling:!0,onError:(e,t)=>t()},(0,s.action)((e=>{this.Content=new W(this),this.Content.loadFromServer(e),this.assignment=e.assignment,this.resume=e.resume,this.loading=!1,this.showing="welcome"})))}get title(){return this.Content.title||"Blossom player"}start(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,f.B5)(t.performance_id);this.loading=!0;const r={assignment_id:this.assignment.assignment_id,lesson_id:null===(e=this.assignment)||void 0===e?void 0:e.lesson_id,performer:this.params.performer,...n?{performance_id:n}:{},...i?{force_session:1}:{}},s=n?"resume":"init";this.server(s,r,(e=>{if(e.active_session)return this.sessionIssue(e.active_session,t);if(!(0,f.B5)(e.performance_id))return this.error("no performance id");if(this.performance_id=e.performance_id,this.sessionKey=e.session_key,n)for(const t in e.steps){const i=e.steps[t],n=this.Content.ItemF.byId(t);n&&n.typeObject.loadAnswer(i)}this.loading=!1,this.showing="content"}))}sync(e){this.syncQueue.push(e),this._sync({},!0)}submit(){this._sync({status:"submit"})}_sync(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=Date.now()-this.lastSyncTime;if(clearTimeout(this.syncTimeout),t&&i<1e4){const n=1e4-i;return void(this.syncTimeout=setTimeout((()=>this._sync(e,t)),n))}this.lastSyncTime=Date.now();const n={options:{},data:{},raw_data:{items:this.Content.ItemF.list.map((e=>e.id))}};"submit"===e.status&&(this.loading=!0),this.server("sync",{performance_id:this.performance_id,session_key:this.sessionKey,performance:n,options:e,queue:this.syncQueue},(t=>{!0===t.result?(this.syncQueue=[],"submit"===e.status&&"done"===t.submit&&(this.showing="finish",this.loading=!1)):(console.error("player sync error",t),this.syncTimeout=setTimeout((()=>this._sync(e)),15e3))}),(t=>{if("invalid session"===t.responseJSON.error_msg)return this.sessionIssue(!1);console.error("player sync error",t),this.syncTimeout=setTimeout((()=>this._sync(e)),15e3)}))}quit(){Blsm.beacon(Blsm.prm.Mainref+"api?/editor/quit",{performance_id:this.performance_id,session_key:this.sessionKey})}error(e){this.showing="error",this.errorMessage=e,this.loading=!1}sessionIssue(e,t){this.showing="session",this.sessionData=e?{...e,resume:t}:{invalid:!0},this.loading=!1}get direction(){const e=this.Content.data.lesson_options.direction,t=he.g.isRTL?"rtl":"ltr";return e||t}validate(){return this.Content.validateRequiredQuestions()}server(e,t,i,n){(0,y.SC)(`editor/${e}`,{method:"post",json:!0,data:t,selfErrorHandling:!!n,onError:n},(0,s.action)(i))}},xe=Ze(we.prototype,"showing",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ze(we.prototype,"title",[s.computed],Object.getOwnPropertyDescriptor(we.prototype,"title"),we.prototype),Ze(we.prototype,"start",[s.action],Object.getOwnPropertyDescriptor(we.prototype,"start"),we.prototype),Ze(we.prototype,"direction",[s.computed],Object.getOwnPropertyDescriptor(we.prototype,"direction"),we.prototype),we);const Se=(0,r.createContext)(null);let Oe=null;const Be=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Oe=Oe||e&&new fe},Te=(0,r.createContext)(null);let Ne=null;const Ie=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ne=Ne||e&&new Ce(t)},De=()=>Ie()||Be()},9841:(e,t,i)=>{i.d(t,{A2:()=>a,Jr:()=>l,O6:()=>c,Ve:()=>s,YZ:()=>p,af:()=>o,tQ:()=>d});var n=i(8318);function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const s={multiple_choice:{label:lng("multiple choice|editor"),icon:"question_multiple_choice"},completion:{label:lng("sentence completion|editor"),icon:"question_completion"},sorting:{label:lng("sorting|editor"),icon:"question_sorting"},single_textbox:{label:lng("text question|editor"),icon:"question_single_textbox"},rating_scale:{label:lng("rating scale|editor"),icon:"question_rating_scale"},matching:{label:lng("matching|editor"),icon:"question_matching"},hotspot:{label:lng("hotspot|editor"),icon:"question_hotspot"},table_question:{label:lng("table question|editor"),icon:"question_table_question"},date_time:{label:lng("date & time|editor"),icon:"question_date_time"},paragraph:{label:lng("media item|editor"),icon:"question_media"},user_field:{label:lng("user field|editor"),icon:"question_user_field"},signature:{label:lng("signature|editor"),icon:"question_signature"},checklist:{label:lng("checklist|editor"),icon:"question_checklist"}};class o{constructor(e){r(this,"lesson_name",""),r(this,"lesson_description",void 0),r(this,"lesson_category_id",void 0),r(this,"creation_time",void 0),r(this,"lesson_public",void 0),r(this,"lesson_deleted",void 0),r(this,"modification_time",void 0),r(this,"lesson_type",void 0),r(this,"modified_by",void 0),r(this,"lesson_options",{}),r(this,"estimated_duration",void 0),r(this,"questionnaire_dynamic",void 0),r(this,"lesson_data",{}),r(this,"survey_anonymous",void 0),r(this,"status",void 0),r(this,"domain_id",void 0),r(this,"original_lesson",void 0),r(this,"presentation_view",void 0),r(this,"poster",void 0),r(this,"created_by",void 0),r(this,"lesson_author",void 0),r(this,"primary_lesson",void 0),r(this,"language_code",void 0),(0,n.Pz)(this,e)}}class a{constructor(e){r(this,"section_id",void 0),r(this,"section_headline",void 0),r(this,"lesson_id",void 0),r(this,"section_order",void 0),r(this,"section_description",void 0),r(this,"section_options",{}),r(this,"section_rules",{}),r(this,"deleted",void 0),(0,n.Pz)(this,e)}}class l{constructor(e){r(this,"item_id",void 0),r(this,"item_type",void 0),r(this,"item_text",void 0),r(this,"item_description",void 0),r(this,"item_tip",void 0),r(this,"item_added_information",void 0),r(this,"section_id",void 0),r(this,"section_internal",void 0),r(this,"item_order",void 0),r(this,"item_options",{}),r(this,"item_weight",void 0),r(this,"item_tip_show",void 0),r(this,"item_pin_top",void 0),r(this,"item_force_answer",void 0),r(this,"addition_time",void 0),r(this,"deleted",void 0),(0,n.Pz)(this,e)}}class c{constructor(e){r(this,"part_id",void 0),r(this,"part_type",void 0),r(this,"item_id",void 0),r(this,"item_internal",void 0),r(this,"part_text",void 0),r(this,"part_value",void 0),r(this,"part_order",void 0),r(this,"part_options",{}),r(this,"deleted",void 0),(0,n.Pz)(this,e)}}class d{constructor(e){r(this,"item_id",void 0),r(this,"value",void 0),r(this,"duration",void 0),r(this,"part_id",void 0),r(this,"multiple",!1),r(this,"type",void 0),(0,n.Pz)(this,e)}}class p{constructor(e){r(this,"Item",void 0),this.Item=e}get settingsFields(){return[]}get renderActions(){return null}get styleFields(){return[]}initNew(){}changeAnswer(){}loadAnswer(){}get shuffle(){return!1}get progress(){return null}}},3835:(e,t,i)=>{i.d(t,{m:()=>Q});var n,r=i(7821),s=i(8318),o=i(9841),a=i(7041);function l(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let c=(l((n=class extends o.YZ{get settingsFields(){return[{type:"select",name:"item_options.mode",label:lng("mode|editor"),options:[{val:"",label:lng("single correct answer, single selection|editor").caps()},{val:"multiple",label:lng("multiple correct answers, multiple selection|editor").caps()},{val:"one_of",label:lng("multiple correct answers, single selection|editor").caps()}]},{type:"toggle",labelFirst:!0,name:"item_options.display_drop_down",label:lng("display as drop down|editor"),visible:()=>!this.Item.dataByName("item_options.mode")},{type:"toggle",labelFirst:!0,name:"item_options.shuffle",label:lng("shuffle answers|editor")},{type:"toggle",labelFirst:!0,name:"item_options.relative_grade",label:lng("relative grade|editor"),visible:()=>"multiple"===this.Item.dataByName("item_options.mode")},{type:"sep"}]}initNew(){this.Item.newPart("answer",lng("answer text|editor")),this.Item.newPart("answer",lng("answer text|editor"))}changeAnswer(e,t){if(["multiple","one_of"].includes(this.Item.dataByName("item_options.mode")))e.modify("part_value",t),this.Item.Manager.Content.addToChanges("parts",e.data,e.internalId);else{t&&(e.modify("part_value",1),this.Item.Manager.Content.addToChanges("parts",e.data,e.internalId));for(const t of this.Item.partList)e!==t&&t.data.part_value&&(t.modify("part_value",""),this.Item.Manager.Content.addToChanges("parts",t.data,t.internalId))}}selectAnswer(e){var t,i;const n="multiple"===this.Item.dataByName("item_options.mode")?{parts:(0,s.rO)((null===(t=this.Item.answerData)||void 0===t||null===(i=t.value)||void 0===i?void 0:i.parts)||[],e.id)}:{partId:e.id};this.Item.answerData=new o.tQ({item_id:this.Item.id,value:n,duration:""}),this.Item.Manager.sync(this.Item.answerData)}loadAnswer(e){this.Item.answerData=new o.tQ({item_id:this.Item.id,value:e[0].value,duration:e[0].duration})}get selectedAnswer(){var e;return(null===(e=this.Item.answerData)||void 0===e?void 0:e.value)||{}}get correctAnswers(){return this.Item.partList.filter((e=>1===e.data.part_value)).map((e=>e.id))}get shuffle(){return!!this.Item.dataByName("item_options.shuffle")}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}}).prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(n.prototype,"settingsFields"),n.prototype),l(n.prototype,"selectAnswer",[r.action],Object.getOwnPropertyDescriptor(n.prototype,"selectAnswer"),n.prototype),l(n.prototype,"selectedAnswer",[r.computed],Object.getOwnPropertyDescriptor(n.prototype,"selectedAnswer"),n.prototype),l(n.prototype,"correctAnswers",[r.computed],Object.getOwnPropertyDescriptor(n.prototype,"correctAnswers"),n.prototype),l(n.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(n.prototype,"progress"),n.prototype),n);class d extends o.YZ{constructor(){super(),this.showDescription=!0}}var p;function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let g=(m((p=class extends o.YZ{constructor(){super(...arguments),u(this,"shuffledDynamicParts",!1)}get settingsFields(){return[{type:"sep"}]}initNew(){this.newMatch(),this.newMatch()}get staticParts(){return this.Item.partListByType("static").sort(((e,t)=>e.data.part_order-t.data.part_order))}get dynamicParts(){return this.Item.partListByType("dynamic").sort(((e,t)=>e.data.part_order-t.data.part_order))}get dynamicPartsPlayer(){const e=this.Item.partListByType("dynamic");return!this.shuffledDynamicParts&&e.length>0&&(this.shuffledDynamicParts=(0,s.Sy)(e)),this.shuffledDynamicParts||e}removePart(e){const t=this.staticParts.find((t=>t.data.part_order===e.data.part_order));if(t){if(2===this.staticParts.length)return;t.change("deleted",1),e.change("deleted",1),this.staticParts.forEach(((e,t)=>{e.modify("part_order",t+1),this.Item.Manager.Content.addToChanges("parts",e.data,e.internalId)}))}else e.change("deleted",1);this.dynamicParts.forEach(((e,t)=>{e.modify("part_order",t+1),this.Item.Manager.Content.addToChanges("parts",e.data,e.internalId)}))}newMatch(){const e=this.Item.newPart("static",lng("static text|editor"));this.newDynamic(e.data.part_order)}newDynamic(e){return this.dynamicParts.forEach((t=>{t.data.part_order>=e&&(t.modify("part_order",t.data.part_order+1),this.Item.Manager.Content.addToChanges("parts",t.data,t.internalId))})),this.Item.newPart("dynamic",lng("dynamic text|editor"),{order:e})}selectAnswer(e){const t=this.staticParts.map(((t,i)=>[t.id,{partId:parseInt(e[i])}]));this.Item.answerData=new o.tQ({item_id:this.Item.id,value:{multiple:t,order:e},duration:"",multiple:!0}),this.Item.Manager.sync(this.Item.answerData)}get selectedAnswer(){var e;return(null===(e=this.Item.answerData)||void 0===e?void 0:e.value)||{}}loadAnswer(e){const t=[],i={};for(const n of e)i[n.part_id]=n.value,t.push([n.part_id,n.value]);const n=[];let r=this.dynamicParts.map((e=>e.id));this.staticParts.forEach((e=>{n.push(i[e.id].partId+""),r=(0,s.rO)(r,i[e.id].partId)})),r.forEach((e=>n.push(e+""))),this.Item.answerData=new o.tQ({item_id:this.Item.id,value:{multiple:t,order:n},duration:e.duration,multiple:!0})}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}}).prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(p.prototype,"settingsFields"),p.prototype),m(p.prototype,"staticParts",[r.computed],Object.getOwnPropertyDescriptor(p.prototype,"staticParts"),p.prototype),m(p.prototype,"dynamicParts",[r.computed],Object.getOwnPropertyDescriptor(p.prototype,"dynamicParts"),p.prototype),m(p.prototype,"dynamicPartsPlayer",[r.computed],Object.getOwnPropertyDescriptor(p.prototype,"dynamicPartsPlayer"),p.prototype),m(p.prototype,"selectAnswer",[r.action],Object.getOwnPropertyDescriptor(p.prototype,"selectAnswer"),p.prototype),m(p.prototype,"selectedAnswer",[r.computed],Object.getOwnPropertyDescriptor(p.prototype,"selectedAnswer"),p.prototype),m(p.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(p.prototype,"progress"),p.prototype),p);var h;function b(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let v=(b((h=class extends o.YZ{get settingsFields(){return[{type:"sep"}]}initNew(){this.newColumn(),this.newColumn(),this.newRow(),this.newRow()}loadAnswer(e){const t=[],i={};for(const n of e)i[n.part_id]=n.value,t.push([n.part_id,n.value]);this.Item.answerData=new o.tQ({item_id:this.Item.id,value:{multiple:t},duration:e.duration,multiple:!0})}get answers(){const e=(e,t)=>this.Item.partListByType("row").find((t=>t.data.part_id===e))&&this.Item.partListByType("column").find((e=>e.data.part_id===t));return Array.from(new Set(this.Item.partListByType("cell").filter((t=>{var i;return!(null!==(i=t.data.part_options)&&void 0!==i&&i.openAnswer)&&!t.data.deleted&&e(t.data.part_value.row,t.data.part_value.col)}))))}newColumn(){return this.Item.newPart("column",lng("column text|editor"))}newRow(){return this.Item.newPart("row",lng("row text|editor"))}get columnParts(){return this.Item.partListByType("column")}get cellParts(){return this.Item.partListByType("cell")}get rowParts(){return this.Item.partListByType("row")}findCellPart(e,t){let i=this.Item.partListByType("cell").find((i=>{var n,r;return e.matchId(null===(n=i.data.part_value)||void 0===n?void 0:n.row)&&t.matchId(null===(r=i.data.part_value)||void 0===r?void 0:r.col)}));return i||this.Item.newPart("cell",void 0,{value:{typeId:!0,row:e.id,col:t.id}})}setAnswer(e,t,i,n){const r=this.findCellPart(e,t);i=n?{text:i}:{partId:i};const s=this.cellParts.map((e=>e.matchId(r.id)?[e.id,i]:this.answer.find((t=>e.matchId(t[0])))||[e.id,null]));this.Item.answerData=new o.tQ({item_id:this.Item.id,value:{multiple:s},duration:"",multiple:!0}),this.Item.Manager.sync(this.Item.answerData)}get answer(){var e;return(null===(e=this.Item.answerData)||void 0===e?void 0:e.value.multiple)||[]}get progress(){const e=this.cellParts.map((e=>{var t;return null!==(t=e.Item.answerData)&&void 0!==t&&t.value?1:0}));return e.length?e.reduce(((e,t)=>e+t),0)/e.length:0}}).prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(h.prototype,"settingsFields"),h.prototype),b(h.prototype,"answers",[r.computed],Object.getOwnPropertyDescriptor(h.prototype,"answers"),h.prototype),b(h.prototype,"columnParts",[r.computed],Object.getOwnPropertyDescriptor(h.prototype,"columnParts"),h.prototype),b(h.prototype,"cellParts",[r.computed],Object.getOwnPropertyDescriptor(h.prototype,"cellParts"),h.prototype),b(h.prototype,"rowParts",[r.computed],Object.getOwnPropertyDescriptor(h.prototype,"rowParts"),h.prototype),b(h.prototype,"setAnswer",[r.action],Object.getOwnPropertyDescriptor(h.prototype,"setAnswer"),h.prototype),b(h.prototype,"answer",[r.computed],Object.getOwnPropertyDescriptor(h.prototype,"answer"),h.prototype),b(h.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(h.prototype,"progress"),h.prototype),h);var _;function f(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let y=(f((_=class extends o.YZ{get settingsFields(){return[{type:"toggle",labelFirst:!0,name:"item_options.multiple",label:lng("allow multiple choice for each line|editor")},{type:"toggle",labelFirst:!0,name:"item_options.relativeGrade",label:lng("relative grade|editor"),visible:()=>this.Item.dataByName("item_options.multiple")},{type:"sep"}]}initNew(){this.newColumn(),this.newColumn(),this.newRow(),this.newRow()}newColumn(){return this.Item.newPart("column",lng("column text|editor"))}newRow(){return this.Item.newPart("row",lng("row text|editor"))}get columnParts(){return this.Item.partListByType("column")}get rowParts(){return this.Item.partListByType("row")}changeAnswer(e,t){let[i,n]=t;if(this.Item.dataByName("item_options.multiple")){var r,s;let t;const o=(null===(r=e.data.part_value)||void 0===r?void 0:r.list)||(null!==(s=e.data.part_value)&&void 0!==s&&s.col?[e.data.part_value.col]:[]);t=i?{typeId:!0,list:[...o,n]}:{typeId:!0,list:o.filter((e=>e!==n))},0===t.length&&(t=""),e.modify("part_value",t)}else e.modify("part_value",i?{typeId:!0,col:n}:"");this.Item.Manager.Content.addToChanges("parts",e.data,e.internalId)}toggleAnswer(e,t){var i;const n=(null===(i=this.Item.answerData)||void 0===i?void 0:i.value)||{};if(this.Item.dataByName("item_options.multiple")){const i=new Set(n[e.id]||[]);i.has(t.id)?i.delete(t.id):i.add(t.id),n[e.id]=Array.from(i)}else n[e.id]=t.id;this.Item.answerData=new o.tQ({item_id:this.Item.id,part_id:e.id,value:n,duration:""}),this.Item.Manager.sync(this.Item.answerData)}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}}).prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(_.prototype,"settingsFields"),_.prototype),f(_.prototype,"columnParts",[r.computed],Object.getOwnPropertyDescriptor(_.prototype,"columnParts"),_.prototype),f(_.prototype,"rowParts",[r.computed],Object.getOwnPropertyDescriptor(_.prototype,"rowParts"),_.prototype),f(_.prototype,"toggleAnswer",[r.action],Object.getOwnPropertyDescriptor(_.prototype,"toggleAnswer"),_.prototype),f(_.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(_.prototype,"progress"),_.prototype),_);var w;function x(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let k=(x((w=class extends o.YZ{get settingsFields(){return[{type:"toggle",labelFirst:!0,name:"item_options.allow_attach_file",label:lng("attach a file|editor")},{type:"toggle",labelFirst:!0,name:"item_options.multi_line",label:lng("display multiple lines for answer|editor")},{type:"toggle",labelFirst:!0,name:"item_options.formula",label:lng("display formula option for answer|editor")},{type:"toggle",labelFirst:!0,name:"item_options.allow_placeholder",label:lng("show placeholder option|editor")},{type:"toggle",labelFirst:!0,name:"item_options.phrases",label:lng("allow phrase matching|editor")},{type:"sep"}]}setAnswer(e){this.Item.answerData=new o.tQ({item_id:this.Item.id,value:e,duration:"",multiple:!1,type:this.Item.dataByName("item_options.phrases")?"auto":"manual"}),this.Item.Manager.sync(this.Item.answerData)}get answer(){var e;return(null===(e=this.Item.answerData)||void 0===e?void 0:e.value)||""}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}}).prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(w.prototype,"settingsFields"),w.prototype),x(w.prototype,"setAnswer",[r.action],Object.getOwnPropertyDescriptor(w.prototype,"setAnswer"),w.prototype),x(w.prototype,"answer",[r.computed],Object.getOwnPropertyDescriptor(w.prototype,"answer"),w.prototype),x(w.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(w.prototype,"progress"),w.prototype),w);var Z,C;function S(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let O=(Z=r.action.bound,S((C=class extends o.YZ{initNew(){this.Item.newPart("answer",lng("insert answer|editor")),this.Item.newPart("answer",lng("insert answer|editor"))}reorder(e){let{new_order:t}=e;for(const[e,i]of t.entries()){const t=this.Item.partList.find((e=>e.id==i));t.modify("part_order",e+1),this.Item.Manager.Content.addToChanges("parts",t.data,t.internalId)}}moveDown(e){const t=this.Item.parts.find((t=>t.data.part_order===e.data.part_order+1));t.modify("part_order",e.data.part_order),e.modify("part_order",e.data.part_order+1),this.Item.Manager.Content.addToChanges("parts",e.data,e.internalId),this.Item.Manager.Content.addToChanges("parts",t.data,t.internalId)}moveUp(e){const t=this.Item.parts.find((t=>t.data.part_order===e.data.part_order-1));t.modify("part_order",e.data.part_order),e.modify("part_order",e.data.part_order-1),this.Item.Manager.Content.addToChanges("parts",e.data,e.internalId),this.Item.Manager.Content.addToChanges("parts",t.data,t.internalId)}loadAnswer(e){this.Item.answerData=new o.tQ({item_id:this.Item.id,value:e[0].value,duration:e[0].duration})}selectOrder(e){this.Item.answerData=new o.tQ({item_id:this.Item.id,value:e,duration:""}),this.Item.Manager.sync(this.Item.answerData)}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}}).prototype,"moveDown",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"moveDown"),C.prototype),S(C.prototype,"moveUp",[r.action],Object.getOwnPropertyDescriptor(C.prototype,"moveUp"),C.prototype),S(C.prototype,"selectOrder",[Z],Object.getOwnPropertyDescriptor(C.prototype,"selectOrder"),C.prototype),S(C.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(C.prototype,"progress"),C.prototype),C);var B,T;function N(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let I=(B=r.action.bound,N((T=class extends o.YZ{get settingsFields(){return[{type:"toggle",labelFirst:!0,name:"item_options.range",label:lng("select range of dates|editor")},{type:"toggle",labelFirst:!0,name:"item_options.include_time",label:lng("include time|editor")},{type:"sep"},{type:"toggle",labelFirst:!0,name:"item_options.configure_display_years",label:lng("configure display years|editor")},{type:"number",labelFirst:!0,name:"item_options.min_display_year",label:lng("minimum year (display)|editor"),max:this.Item.dataByName("item_options.max_display_year"),visible:()=>this.Item.dataByName("item_options.configure_display_years"),required:!!this.Item.dataByName("item_options.max_display_year")},{type:"number",labelFirst:!0,name:"item_options.max_display_year",label:lng("maximum year (display)|editor"),min:this.Item.dataByName("item_options.min_display_year"),visible:()=>this.Item.dataByName("item_options.configure_display_years"),required:!!this.Item.dataByName("item_options.min_display_year")},{type:"sep"}]}get yearsDisplayRange(){return this.Item.dataByName("item_options.configure_display_years")?{min:this.Item.dataByName("item_options.min_display_year"),max:this.Item.dataByName("item_options.max_display_year")}:{range:100}}loadAnswer(e){this.Item.answerData=new o.tQ({item_id:this.Item.id,value:e[0].value,duration:e[0].duration})}selectAnswer(e){this.Item.answerData=new o.tQ({item_id:this.Item.id,value:e,duration:""}),this.Item.Manager.sync(this.Item.answerData)}get inputType(){return this.Item.dataByName("item_options.include_time")?"date_time":"date"}get startTimeLabel(){return this.Item.dataByName("item_options.range")?lng("from|editor"):this.Item.dataByName("item_options.include_time")?lng("select date & time|editor"):lng("select date|editor")}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}}).prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(T.prototype,"settingsFields"),T.prototype),N(T.prototype,"yearsDisplayRange",[r.computed],Object.getOwnPropertyDescriptor(T.prototype,"yearsDisplayRange"),T.prototype),N(T.prototype,"selectAnswer",[B],Object.getOwnPropertyDescriptor(T.prototype,"selectAnswer"),T.prototype),N(T.prototype,"inputType",[r.computed],Object.getOwnPropertyDescriptor(T.prototype,"inputType"),T.prototype),N(T.prototype,"startTimeLabel",[r.computed],Object.getOwnPropertyDescriptor(T.prototype,"startTimeLabel"),T.prototype),N(T.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(T.prototype,"progress"),T.prototype),T);var D,j=i(3530);function P(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let z=(P((D=class extends o.YZ{get placeholders(){return this.Item.parts.reduce(((e,t)=>({...e,[t.text]:t.text})),{})}loadAnswer(e){this.Item.answerData=new o.tQ({item_id:this.Item.id,value:e[0].value,duration:e[0].duration})}selectAnswer(e,t){var i,n;let r;r=Array.isArray(null===(i=this.Item.answerData)||void 0===i?void 0:i.value)?null===(n=this.Item.answerData)||void 0===n?void 0:n.value:[],r[t]=e,this.Item.answerData=new o.tQ({item_id:this.Item.id,value:r,duration:""}),this.Item.Manager.sync(this.Item.answerData)}get settingsFields(){return[]}}).prototype,"placeholders",[r.computed],Object.getOwnPropertyDescriptor(D.prototype,"placeholders"),D.prototype),P(D.prototype,"selectAnswer",[r.action],Object.getOwnPropertyDescriptor(D.prototype,"selectAnswer"),D.prototype),D);var E,R=i(6975),F=i(5944);function M(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let A=(M((E=class extends o.YZ{get settingsFields(){return[{type:"toggle",labelFirst:!0,name:"item_options.not_relevant",label:lng("add not relevant option|editor")},{type:"toggle",labelFirst:!0,name:"item_options.explanation",label:lng("add explanation box|editor")}]}get renderActions(){return(0,F.BX)(F.HY,{children:[(0,F.BX)("label",{children:[(0,F.tZ)("input",{type:"file",name:"file",multiple:!0,onChange:e=>this.Item.fileSelect(e),style:{opacity:0,width:0}}),(0,F.tZ)(R.JO,{icon:"attachment",buttonLike:!0})]}),(0,F.tZ)(R.Xs,{icon:"explanation_box",toolTip:lng("add explanation box|editor"),value:this.Item.dataByName("item_options.explanation"),onClick:()=>this.Item.change("item_options.explanation",!+this.Item.dataByName("item_options.explanation"))}),(0,F.tZ)(R.Xs,{icon:"checkbox_half",toolTip:lng("add not relevant option|editor"),value:this.Item.dataByName("item_options.not_relevant"),onClick:()=>this.Item.change("item_options.not_relevant",!+this.Item.dataByName("item_options.not_relevant"))}),(0,F.tZ)(R.Xs,{icon:"required",toolTip:lng("force to answer|editor"),value:this.Item.dataByName("item_force_answer"),onClick:()=>this.Item.change("item_force_answer",!+this.Item.dataByName("item_force_answer"))}),(0,F.tZ)(R.JO,{icon:"copy",buttonLike:!0,onClick:()=>this.Item.Manager.Content.ItemF.duplicate(),toolTip:lng("duplicate item|editor")}),(0,F.tZ)(R.JO,{icon:"trash",buttonLike:!0,onClick:()=>this.Item.change("deleted",1),toolTip:lng("remove item|editor")})]})}initNew(){this.newCheck()}newCheck(){return this.Item.newPart("check",lng("text|editor"))}get checkParts(){return this.Item.partListByType("check").sort(((e,t)=>e.data.part_order-t.data.part_order))}markPart(e,t){var i,n;const r=(null===(i=this.Item.answerData)||void 0===i||null===(n=i.value)||void 0===n?void 0:n.multiple)||[],s=r.findIndex((t=>t[0]===e));s>=0?r[s][1]=t:r.push([e,t]);const a=r.filter((e=>!!e[1]));this.Item.answerData=new o.tQ({item_id:this.Item.id,value:{multiple:a},duration:"",multiple:!0,type:"checked"}),this.Item.Manager.sync(this.Item.answerData)}get explanation(){var e,t;const i=((null===(e=this.Item.answerData)||void 0===e||null===(t=e.value)||void 0===t?void 0:t.multiple)||[]).find((e=>"expl"===e[0]));return i?i[1]:""}loadAnswer(e){const t=[];for(const i of e)t.push([parseInt(i.part_id),i.value]);this.Item.answerData=new o.tQ({item_id:this.Item.id,value:{multiple:t},duration:e.duration,multiple:!0})}get progress(){var e;return null!==(e=this.Item.answerData)&&void 0!==e&&e.value?1:0}}).prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(E.prototype,"settingsFields"),E.prototype),M(E.prototype,"renderActions",[r.computed],Object.getOwnPropertyDescriptor(E.prototype,"renderActions"),E.prototype),M(E.prototype,"checkParts",[r.computed],Object.getOwnPropertyDescriptor(E.prototype,"checkParts"),E.prototype),M(E.prototype,"explanation",[r.computed],Object.getOwnPropertyDescriptor(E.prototype,"explanation"),E.prototype),M(E.prototype,"progress",[r.computed],Object.getOwnPropertyDescriptor(E.prototype,"progress"),E.prototype),E);var q,X,L,$,V,U,H,J,G;function W(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function K(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Y(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Q=(q=r.observable.shallow,L=Y((X=class{constructor(e,t,i){W(this,"data",L,this),W(this,"partList",$,this),K(this,"internalId",void 0),K(this,"Manager",void 0),K(this,"Section",void 0),K(this,"typeObject",void 0),W(this,"showDescription",V,this),W(this,"disabled",U,this),W(this,"answerData",H,this),W(this,"files",J,this),W(this,"alert_force_answer",G,this),K(this,"shuffledParts",!1),(0,r.makeObservable)(this),this.Manager=t,this.Section=i,this.internalId=(0,s.zO)(8,"ei"),this.data=new o.Jr(e),this.typeObject=this.getTypeObject(e),e.files&&(this.files=e.files.map((e=>(e.object_type="editor_item",e.object_id=this.id,e)))),this.showDescription="paragraph"===this.dataByName("item_type")||!!this.dataByName("item_description")}duplicate(){const e={...this.data};e.item_id=void 0;const t=this.Section.createItem(e);for(const e of this.partList){const i={...e.data};i.part_id=void 0,i.item_id=void 0,i.item_internal=t.internalId,t.addPart(t.createPart(i))}return t}get header(){var e;return null!==(e=this.data.item_text)&&void 0!==e?e:""}get id(){return this.data.item_id||this.internalId}matchId(e){return this.data.item_id===parseInt(e)||this.internalId===e}get order(){return parseInt(this.data.item_order)}get globalOrder(){return this.order+this.Manager.Content.SectionF.numberOfItemsBefore(this.Section)}get globalItemOrder(){return this.order+this.Manager.Content.SectionF.numberOfItemsBefore(this.Section,!1)}get required(){return!(!(this.data.item_force_answer||this.Section.data.section_options.force_answer||this.Manager.Content.data.lesson_options.mustAnswer)||this.answerData)}get locker(){const{disable_back:e,disable_back_inner:t}=this.Section.data.section_options;return!!(this.Section===this.Manager.Content.SectionF.getActive?t&&this.order>1:e)}set order(e){this.modify("item_order",e),this.Manager.Content.addToChanges("order",{order:e,id:this.id,type:"item"},this.internalId)}get type(){return this.data.item_type}get typeName(){var e;return(null===(e=o.Ve[this.type])||void 0===e?void 0:e.label)||"missing"}get typeIcon(){var e;return(null===(e=o.Ve[this.type])||void 0===e?void 0:e.icon)||"bug"}dataByName(e){if(e.includes(".")){const t=e.split(".");return this.data[t[0]][t[1]]||""}return this.data[e]}match(e){return!e||this.data.item_text.toLowerCase().includes(e.toLowerCase())}change(e,t){this.Manager.Content.addToHistory("items",e,t,this.data),this.modify(e,t),this.Manager.Content.addToChanges("items",this.data,this.internalId)}modify(e,t){const i={...this.data};if(e.includes(".")){const n=e.split(".");i[n[0]][n[1]]=t}else i[e]=t;this.data=new o.Jr(i)}initNew(){this.typeObject.initNew()}changeAnswer(e,t){this.typeObject.changeAnswer(e,t)}get parts(){const e=[...this.partList];return!this.shuffledParts&&"play"===this.Manager.mode&&this.typeObject.shuffle&&e.length>0&&(this.shuffledParts=(0,s.Sy)(e)),this.shuffledParts||e}partListByType(e){return this.partList.filter((t=>t.data.part_type===e&&!t.data.deleted))}newPart(e,t){let{order:i=null,value:n=null,options:r=null,addLength:s=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=i||this.partListByType(e).length+1,a={part_text:t?t+(s?" "+o:""):"",part_type:e,part_options:r,item_id:this.data.item_id,item_internal:this.internalId,part_order:o};n&&(a.part_value=n);const l=this.createPart(a);return this.addPart(l)}addPart(e){return this.partList.push(e),this.Manager.Content.addToChanges("parts",e.data,e.internalId),e}createPart(e){const t=new a.o(e,this.Manager,this);return this.Manager.Content.listByInternalId.part[t.internalId]=t,t}loadPart(e){const t=this.createPart(e);return this.partList.push(t),t}get fields(){return{0:this.settingsFields,1:this.styleFields}}get settingsFields(){const e=[{val:"",label:lng("without weights|editor")},{val:"asc_num",label:`${lng("ascending|editor")}: 1, 2, 3 ...`},{val:"asc_nr_num",label:`${lng("ascending|editor")}: ${lng("not relevant|editor")}, 1, 2, 3 ...`},{val:"asc_num_nr",label:`${lng("ascending|editor")}: 1, 2, 3 ...,  ${lng("not relevant|editor")}`},{val:"desc_num",label:`${lng("descending|editor")}: ... 3, 2, 1`},{val:"desc_nr_num",label:`${lng("descending|editor")}: ${lng("not relevant|editor")}, ... 3, 2, 1`},{val:"desc_num_nr",label:`${lng("descending|editor")}: ... 3, 2, 1, ${lng("not relevant|editor")}`}],t=this.Manager.Content.typeIs("survey"),i=this.Manager.Content.typeIs("test");return[...this.typeObject.settingsFields,{type:"select",name:"item_options.question_difficulty",label:lng("difficulty|editor"),options:[{val:"",label:"-"},{val:1,label:lng("easy|editor")},{val:5,label:lng("medium|editor")},{val:9,label:lng("hard|editor")}],visible:()=>i},{type:"select",name:"item_options.feedback",label:lng("feedback|editor"),options:[{val:"",label:lng("section default|editor")},{val:1,label:lng("no feedback|editor")},{val:2,label:lng("correct/wrong|editor")},{val:3,label:`${lng("correct/wrong|editor").caps()} + ${lng("feedback text or|editor")} ${lng("added information|editor")}`}],visible:()=>i},{type:"select",name:"item_options.answersWeightType",label:lng("answers weight type|editor"),options:e,visible:()=>t&&["multiple_choice","rating_scale"].includes(this.type)},{type:"toggle",labelFirst:!0,name:"item_options.question_disabled",label:lng("disable question|editor")},{type:"toggle",labelFirst:!0,name:"item_force_answer",label:lng("force to answer|editor")},{type:"toggle",labelFirst:!0,name:"item_options.addExplanation",label:lng("add explanation box|editor"),visible:()=>t},{type:"toggle",labelFirst:!0,name:"item_tip_show",label:lng("show tip|editor")},{type:"richtext",name:"item_tip",label:lng("write text for a tip|editor")},{type:"richtext",name:"item_added_information",label:lng("added information|editor")},{type:"toggle",labelFirst:!0,name:"item_pin_top",label:lng("pin item to top|editor")},{type:"number",name:"item_weight",label:lng("weight|editor"),min:0},{type:"date",name:"item_options.item_expiration",label:lng("expiration date|editor")},{type:"hidden",name:"item_options.hide_description",reverse:!0,label:lng("show description|editor")}].filter((e=>!(e.visible&&!e.visible())))}get styleFields(){return[...this.typeObject.styleFields,{type:"color",name:"item_options.background_color",label:lng("background color|editor")},{type:"select",name:"item_options.img_position",label:lng("position|editor"),options:[{val:"",label:lng("bottom|editor").caps()},{val:"top",label:lng("top|editor").caps()}]},{type:"select",name:"item_options.text_color",label:lng("text color|editor"),options:[{val:"",label:lng("auto|editor")},{val:"white",label:lng("white|editor")},{val:"black",label:lng("black|editor")}]}].filter((e=>!(e.visible&&!e.visible())))}getTypeObject(e){switch(this.data.item_type){case"multiple_choice":return new c(this);case"completion":return new z(this);case"sorting":return new O(this);case"single_textbox":return new k(this);case"rating_scale":return new y(this);case"matching":return new g(this);case"hotspot":return new j.P(this,e);case"table_question":return new v(this);case"date_time":return new I(this);case"paragraph":return new d(this);case"user_field":case"signature":break;case"checklist":return new A(this)}return new o.YZ(this)}fileSelect(e){const t=e.currentTarget.files[0];t&&(t.id=(0,s.zO)(8,"f_ei"),e.currentTarget.value=null,this.files.push(t),t.object_type="editor_item",t.object_id=this.id,this.Manager.Content.addToChanges("files",t,t.id))}fileDelete(e){e.file_id?(e.deleted=!0,this.files=[...this.files],this.Manager.Content.addToChanges("files",e,e.file_id)):(this.files=this.files.filter((t=>t!==e)),delete this.Manager.Content.changes.files[e.id])}}).prototype,"data",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=Y(X.prototype,"partList",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=Y(X.prototype,"showDescription",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=Y(X.prototype,"disabled",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=Y(X.prototype,"answerData",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Y(X.prototype,"files",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),G=Y(X.prototype,"alert_force_answer",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Y(X.prototype,"header",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"header"),X.prototype),Y(X.prototype,"id",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"id"),X.prototype),Y(X.prototype,"order",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"order"),X.prototype),Y(X.prototype,"globalOrder",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"globalOrder"),X.prototype),Y(X.prototype,"globalItemOrder",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"globalItemOrder"),X.prototype),Y(X.prototype,"required",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"required"),X.prototype),Y(X.prototype,"locker",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"locker"),X.prototype),Y(X.prototype,"change",[r.action],Object.getOwnPropertyDescriptor(X.prototype,"change"),X.prototype),Y(X.prototype,"modify",[r.action],Object.getOwnPropertyDescriptor(X.prototype,"modify"),X.prototype),Y(X.prototype,"parts",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"parts"),X.prototype),Y(X.prototype,"fields",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"fields"),X.prototype),Y(X.prototype,"settingsFields",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"settingsFields"),X.prototype),Y(X.prototype,"styleFields",[r.computed],Object.getOwnPropertyDescriptor(X.prototype,"styleFields"),X.prototype),X)},7041:(e,t,i)=>{i.d(t,{o:()=>d});var n,r,s=i(7821),o=i(8318),a=i(9841);function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let d=(r=c((n=class{constructor(e,t,i){var n,c,d,p;n=this,c="data",p=this,(d=r)&&Object.defineProperty(n,c,{enumerable:d.enumerable,configurable:d.configurable,writable:d.writable,value:d.initializer?d.initializer.call(p):void 0}),l(this,"internalId",void 0),l(this,"Manager",void 0),l(this,"Item",void 0),(0,s.makeObservable)(this),this.Manager=t,this.Item=i,this.internalId=(0,o.zO)(8,"eip"),this.data=new a.O6({part_text:lng("part text|editor"),part_type:"answer",...e})}get id(){return this.data.part_id||this.internalId}matchId(e){return this.data.part_id===parseInt(e)||this.internalId===e}get text(){return this.data.part_text||""}change(e,t){this.Manager.Content.addToHistory("parts",e,t,this.data),this.modify(e,t),this.Manager.Content.addToChanges("parts",this.data,this.internalId)}modify(e,t){const i={...this.data};if(e.includes(".")){const n=e.split(".");i[n[0]][n[1]]=t}else i[e]=t;this.data=new a.O6(i)}dataByName(e){if(e.includes(".")){const t=e.split(".");return this.data[t[0]][t[1]]||""}return this.data[e]}}).prototype,"data",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c(n.prototype,"id",[s.computed],Object.getOwnPropertyDescriptor(n.prototype,"id"),n.prototype),c(n.prototype,"text",[s.computed],Object.getOwnPropertyDescriptor(n.prototype,"text"),n.prototype),c(n.prototype,"change",[s.action],Object.getOwnPropertyDescriptor(n.prototype,"change"),n.prototype),c(n.prototype,"modify",[s.action],Object.getOwnPropertyDescriptor(n.prototype,"modify"),n.prototype),n)},7187:(e,t,i)=>{i.d(t,{I:()=>y});var n,r,s,o,a,l,c,d=i(7821),p=i(3835),u=i(8318),m=i(9841),g=i(5519),h=i(4576),b=i(3538);function v(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function f(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let y=(n=d.observable.shallow,s=f((r=class{constructor(e,t){var i;v(this,"data",s,this),v(this,"itemList",o,this),v(this,"searchTerm",a,this),_(this,"internalId",void 0),_(this,"Manager",void 0),v(this,"alert_force_answer",l,this),v(this,"disabled",c,this),(0,d.makeObservable)(this),this.Manager=t,this.internalId=(0,u.zO)(8,"es"),this.data=new m.A2(e),(null===(i=e.questions)||void 0===i?void 0:i.length)>0&&(this.itemList=e.questions.map((e=>this.createItem(e))))}get id(){return this.data.section_id||this.internalId}matchId(e){return this.data.section_id===parseInt(e)||this.internalId===e}get order(){return this.data.section_order}set order(e){this.modify("section_order",e),this.Manager.Content.addToChanges("order",{order:e,id:this.id,type:"section"},this.internalId)}get globalOrder(){return this.Manager.Content.SectionF.numberOfItemsBefore(this)}get title(){return this.data.section_headline}get description(){return this.data.section_description}get count(){return this.itemList.length}get items(){return this.itemList.filter((e=>e.match(this.searchTerm))).sort(((e,t)=>e.order-t.order))||[]}itemById(e){return this.itemList.find((t=>t.matchId(e)))}match(e){return this.searchTerm=e,!e||this.items.length>0}newItem(e,t){const i=this.createItem({item_text:lng("new question|editor"),item_type:e,section_id:this.data.section_id,section_internal:this.internalId});return i.initNew(),this.addItem(i,t)}copyItem(e,t){const i=e.duplicate();return this.addItem(i,t)}addItem(e,t){const i=this.itemList.sort(((e,t)=>e.order-t.order)),n=[...i.slice(0,t),e,...i.slice(t)];let r=1;return n.forEach((e=>e.order=r++)),this.itemList=n,this.Manager.Content.addToChanges("items",e.data,e.internalId),e}createItem(e){const t=new p.m(e,this.Manager,this);return this.Manager.Content.listByInternalId.item[t.internalId]=t,t}dataByName(e){if(e.includes(".")){const t=e.split(".");return this.data[t[0]][t[1]]||""}return this.data[e]}change(e,t){this.Manager.Content.addToHistory("sections",e,t,this.data),this.modify(e,t),this.Manager.Content.addToChanges("sections",this.data,this.internalId)}modify(e,t){const i={...this.data};if(e.includes(".")){const n=e.split(".");i[n[0]][n[1]]=t}else i[e]=t;this.data=new m.A2(i)}loadItem(e){const t=this.createItem(e);return this.itemList.push(t),t}get required(){return this.itemList.some((e=>e.required))}get locker(){const{disable_back:e,disable_back_inner:t}=this.data.section_options;return this.Manager.Content.SectionF.getActive.id===this.id?t:e||t}get fields(){return{0:this.settingsFields,1:this.styleFields,2:this.rulesFields}}get settingsFields(){const e=[...g.z9].map((e=>[e,(0,h.BP)(e).caps(!1)])),t=[lng("content default|editor").caps(),lng("no feedback|editor").caps(),lng("correct/wrong|editor").caps(),`${lng("correct/wrong|editor").caps()} + ${lng("added information|editor").caps()}`].map(((e,t)=>[t,e]));return[{type:"toggle",labelFirst:!0,name:"section_options.shuffle",label:lng("shuffle items|editor")},{type:"number",name:"section_options.asked_questions",label:lng("shown items|editor"),min:0},{type:"select",name:"section_options.time",label:lng("allocation time|editor"),options:e},{type:"toggle",labelFirst:!0,name:"section_options.disable_back",label:lng("cannot go back|editor").caps()},{type:"toggle",labelFirst:!0,name:"section_options.separate_questions",label:lng("show each item separately|editor").caps()},{type:"toggle",labelFirst:!0,name:"section_options.force_answer",label:lng("force to answer|editor").caps()},{type:"toggle",labelFirst:!0,name:"section_options.disable_back_inner",label:lng("cannot go back an item|editor").caps()},{type:"select",name:"section_options.feedback",label:lng("feedback type|editor"),options:t}]}get styleFields(){return[{type:"toggle",labelFirst:!0,name:"section_options.background_contain",label:lng("contain background image|editor")},{type:"toggle",labelFirst:!0,name:"section_options.background_no_dim",label:lng("keep background image colors|editor")},{type:"color",name:"section_options.background_color",label:lng("color|editor")}]}get rulesFields(){const e=this.dataByName("section_rules");return[{type:"component",name:"section_rules",Render:b.n$,props:{object_type:"users",collisionCheck:!0,value:(0,u.xb)(e)?void 0:e,onChange:e=>{e?this.change("section_rules",e):(0,u.xb)(this.data.section_rules)||this.change("section_rules",{})}}}]}}).prototype,"data",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=f(r.prototype,"itemList",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a=f(r.prototype,"searchTerm",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=f(r.prototype,"alert_force_answer",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=f(r.prototype,"disabled",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f(r.prototype,"id",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"id"),r.prototype),f(r.prototype,"order",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"order"),r.prototype),f(r.prototype,"globalOrder",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"globalOrder"),r.prototype),f(r.prototype,"title",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"title"),r.prototype),f(r.prototype,"description",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"description"),r.prototype),f(r.prototype,"count",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"count"),r.prototype),f(r.prototype,"items",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"items"),r.prototype),f(r.prototype,"match",[d.action],Object.getOwnPropertyDescriptor(r.prototype,"match"),r.prototype),f(r.prototype,"change",[d.action],Object.getOwnPropertyDescriptor(r.prototype,"change"),r.prototype),f(r.prototype,"modify",[d.action],Object.getOwnPropertyDescriptor(r.prototype,"modify"),r.prototype),f(r.prototype,"required",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"required"),r.prototype),f(r.prototype,"locker",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"locker"),r.prototype),f(r.prototype,"fields",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"fields"),r.prototype),f(r.prototype,"settingsFields",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"settingsFields"),r.prototype),f(r.prototype,"styleFields",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"styleFields"),r.prototype),f(r.prototype,"rulesFields",[d.computed],Object.getOwnPropertyDescriptor(r.prototype,"rulesFields"),r.prototype),r)},1880:(e,t,i)=>{i.d(t,{c:()=>N,H:()=>D});var n=i(917),r=i(5560),s=i(6920),o=i(6975),a=i(4773),l=i(5192),c=i(7965),d=i(7828),p=i(5944);const u=(0,n.iv)("position:relative;cursor:pointer;>.back{background-color:",s.g.colors.blossom,";height:240px;width:250px;border-radius:22px 22px 0 0;>.icon{height:130px;display:flex;justify-content:center;align-items:center;>*{font-size:5em;color:white;}}}>.front{background-color:white;height:200px;width:230px;position:absolute;top:130px;left:10px;border-radius:22px;",s.g.classes.shadow_light,";padding:10px;display:flex;flex-direction:column;align-items:center;>.title{font-weight:700;font-size:1.1em;padding:10px 0;}}",""),m=e=>{let{icon:t,text:i,title:n,onClick:r}=e;return(0,p.BX)(c.E.div,{initial:{rotateY:90,transformPerspective:"15cm"},animate:{rotateY:0,transition:{duration:.5}},css:u,onClick:r,whileHover:{rotateY:[0,10,-10,0]},children:[(0,p.tZ)("div",{className:"back",children:(0,p.tZ)("div",{className:"icon",children:(0,p.tZ)(o.JO,{icon:t})})}),(0,p.BX)("div",{className:"front",children:[(0,p.tZ)("div",{className:"title",children:n.caps()}),(0,p.tZ)("div",{className:"text",children:i.caps()})]})]})};var g=i(7392);const h=e=>{let{children:t}=e;return(0,p.tZ)(c.E.div,{variants:{hidden:{opacity:0},show:{opacity:1,transition:{duration:.4,staggerChildren:.1}}},initial:"hidden",animate:"show",exit:"hidden",className:"stage",children:t})},b=()=>{const e=(0,a.P8)(),t=[{name:"test",title:lng("test|editor"),icon:"vendor_test",text:lng("used to test knowledge. each question has at least one correct answer (or more). a score will be given between 0 to 100.")},{name:"survey",title:lng("survey|editor"),icon:"vendor_survey",text:lng("used for data collection, statistical analysis and drawing conclusions about certain population.")},{name:"evaluation",title:lng("evaluation|editor"),icon:"vendor_evaluation",text:lng("used for assessment and to review the worker/employee performance.")},{name:"form",title:lng("form|editor"),icon:"vendor_form",text:lng("used for recording and approving various processes.")},{name:"checklist",title:lng("checklist|editor"),icon:"vendor_checklist",text:lng("used to track and verify completion of specific tasks, items, or criteria.")}];return(0,p.BX)(h,{children:[(0,p.BX)("div",{className:"titles",children:[(0,p.tZ)("div",{className:"headline",children:lng("create a new questionnaire|editor").caps()}),(0,p.tZ)("div",{className:"tagline",children:lng("select the questionnaire type that best suits your needs|editor").caps()})]}),(0,p.tZ)("div",{className:"type-select",children:t.map((t=>(0,p.tZ)(m,{...t,onClick:()=>e.wizard.type(t.name)},t.name)))}),(0,p.BX)("div",{className:"alt-option",children:[(0,p.tZ)("div",{className:"text",children:lng("you can also choose from existing questionnaires|editor").caps()}),(0,p.tZ)(g.l,{theme:"contained",onClick:()=>e.wizard.showList(),children:lng("to your questionnaires|editor").caps()})]})]})},v=()=>{const e=(0,a.P8)(),t=[{name:"form",title:lng("form style|editor"),icon:"vendor_test",text:lng("normal display. questions will appear according to their pages and page settings.")},{name:"presentation",title:lng("presentation style|editor"),icon:"vendor_survey",text:lng("presentation display. each question will appear individually regardless of page settings.")}];return(0,p.BX)(h,{children:[(0,p.BX)("div",{className:"titles",children:[(0,p.tZ)("div",{className:"headline",children:lng("which mode of display do you prefer?|editor").caps()}),(0,p.tZ)("div",{className:"tagline",children:lng("you can always change it later|editor").caps()})]}),(0,p.tZ)("div",{className:"type-select",children:t.map((t=>(0,p.tZ)(m,{...t,onClick:()=>e.wizard.mode(t.name)},t.name)))}),(0,p.tZ)("div",{className:"alt-option"})]})};var _=i(7363),f=i(6421);const y=()=>{const e=(0,a.P8)(),[t,i]=(0,_.useState)(""),[n,r]=(0,_.useState)("");return(0,p.BX)(h,{children:[(0,p.tZ)("div",{className:"titles",children:(0,p.tZ)("div",{className:"headline",children:lng("last step before getting started|editor").caps()})}),(0,p.BX)("div",{className:"details",children:[(0,p.tZ)("div",{className:"title",children:lng("questionnaire name|editor").caps()}),(0,p.tZ)("div",{className:"name",children:(0,p.tZ)(f.I,{type:"text",value:t,onChange:e=>i(e)})}),(0,p.tZ)("div",{className:"title",children:lng("description|editor").caps()}),(0,p.BX)("div",{style:{maxWidth:"500px",fontSize:"0.9em"},children:[lng("adding a description to the questionnaire at this point will allow us to offer you questions during the creation process.|editor").caps()," ",lng("it can also be added and edited later")]}),(0,p.tZ)("div",{className:"desc",children:(0,p.tZ)(f.I,{type:"textarea",value:n,onChange:e=>r(e)})})]}),(0,p.tZ)("div",{className:"next-phase",children:(0,p.tZ)(g.l,{theme:"contained",onClick:()=>e.wizard.finish(t,n),children:lng("let's go|editor").caps()})})]})};var w=i(676),x=i(8318),k=i(8152),Z=i(9180),C=i(441);const S={name:"1w55c2e",styles:"background-color:#FFF;padding:30px;margin:20px;border-radius:10px;min-height:300px;>.title{font-size:1.3em;font-weight:600;margin:10px 0;}"},O=(0,r.observer)((()=>{const e=(0,a.P8)(),t=e.wizard.getList(),i=[{title:"#",sortVal:"lesson_id"},{title:lng("type|editor")},{title:lng("name|editor"),sortVal:"name",input:"text"},{title:lng("description|editor"),sortVal:"lesson_description",input:"text"},{title:lng("category|editor")},{title:lng("modified|editor")}];return(0,p.BX)("div",{css:S,children:[(0,p.tZ)("div",{className:"title",children:lng("choose from existing questionnaires|editor").caps()}),(0,p.tZ)(w.iA,{cols:i,collection:t,RowRenderer:B,rowIdCol:"lesson_id",loading:!e.wizard.listLoaded,noWindow:!0,compact:!0})]})})),B=e=>{let{row:t}=e;const{lesson_id:i,author:n,type_title:r,name:o,lesson_type:a,cur_version:l,descriptionIsHtml:c,lesson_description:d,category_name:u,modification_time:m,category_id:g,can_edit:h,publicEdit:b}=t,v=()=>{(h||b)&&(0,C.p4)({edit:"content",id:i,type:a,version:l},!0)},_=["#"+i,{_:(0,p.tZ)("span",{css:s.g.classes.content_type_style,children:r})},{type:"main",_:`${o}`},{type:"description",text:d,isHtml:(0,x.P$)(c)},{_:(0,p.tZ)(k.W,{category:u,category_id:g})},{_:(0,p.BX)(p.HY,{children:[(0,p.tZ)(Z.qp,{time:m,showTime:!1})," ",((null==n?void 0:n.first_name)||(null==n?void 0:n.last_name))&&` ${lng("by|person|editor")} ${(0,x.v2)(n)}`]})}];return(0,p.tZ)(w.lF,{tds:_,onClick:()=>null==v?void 0:v()})},T=(0,n.iv)("position:relative;background-color:",s.g.colors.bg_page_containers,";height:100vh;>.top-bar{height:70px;background:white;display:flex;justify-content:space-evenly;align-items:center;>.wizard-back{border:1px solid transparent;padding:10px;height:fit-content;cursor:pointer;color:",s.g.colors.blossom,";font-weight:600;font-size:1.1em;&:hover{border:1px solid ",s.g.colors.blossom,";border-radius:8px;}}>.wizard-logo{width:70px;}}>.front{position:absolute;top:8vh;left:0;height:84vh;width:100vw;>.stage{display:flex;flex-direction:column;align-items:center;margin-top:100px;>.titles{display:flex;flex-direction:column;align-items:center;.headline{font-size:2.3em;font-weight:600;color:white;margin-bottom:15px;}.tagline{font-size:1.5em;font-weight:600;color:white;}.buttons{display:flex;justify-content:space-evenly;width:400px;>.Button{font-size:1.2em;width:140px;height:40px;padding-top:8px;}}}>.type-select{display:flex;gap:30px;margin-top:140px;.card{height:300px;width:250px;background-color:",s.g.colors.blossom,";}}>.alt-option{display:flex;flex-direction:column;align-items:center;margin-top:140px;font-size:1.2em;>.text{margin-bottom:15px;}}>.lang-select{padding:50px;border-radius:15px;background-color:white;display:flex;flex-direction:column;align-items:center;width:1300px;height:440px;margin-top:55px;>.title{font-size:1.1em;font-weight:bold;}>.search{margin-top:15px;",s.g.classes.editorInputWrap," input{border:none;width:250px;}}>.lang-list{margin-top:50px;display:flex;flex-wrap:wrap;gap:20px 30px;overflow:auto;max-height:215px;}}>.next-phase{margin-top:30px;>.Button{font-size:1.2em;width:140px;height:40px;padding-top:8px;}}>.details{padding:50px;border-radius:15px;background-color:white;display:flex;flex-direction:column;align-items:center;width:1300px;height:390px;margin-top:55px;>.title{font-size:1.1em;font-weight:bold;}>.name{margin-top:15px;",s.g.classes.editorInputWrap," margin-bottom:30px;input{border:none;width:550px;}}>.desc{margin-top:15px;",s.g.classes.editorInputWrap," textarea{border:none;width:550px;height:100px;}}}}}",""),N=(0,r.observer)((()=>{const e=(0,a.P8)(),t=e.wizard.stage;return(0,p.BX)(c.E.div,{css:T,initial:{opacity:0},animate:{opacity:1},children:[(0,p.BX)("div",{className:"top-bar",children:[(0,p.BX)("div",{className:"wizard-back",onClick:()=>e.wizard.back(),children:[(0,p.tZ)(o.JO,{icon:"arrow_near"})," ",lng("back|editor").caps()]}),(0,p.tZ)("div",{className:"wizard-logo",children:(0,p.tZ)(l.T,{})}),(0,p.tZ)("div",{style:{width:"90px"}})]}),(0,p.tZ)(D,{image:s.g.func.imgUrl("editor:wizard_bg.jpg")}),(0,p.tZ)("div",{className:"front",children:(0,p.BX)(d.M,{children:[e.wizard.list&&(0,p.tZ)(O,{}),0===t&&(0,p.tZ)(b,{}),1===t&&(0,p.tZ)(v,{}),3===t&&(0,p.tZ)(y,{})]})})]})})),I=e=>(0,n.iv)("position:relative;height:50vh;width:100vw;background-image:url(",e,');background-position:center;background-repeat:no-repeat;background-size:cover;:before{content:"";position:absolute;left:0;right:0;top:0;bottom:0;opacity:0.8;background:',s.g.colors.purple,";}",""),D=e=>{let{image:t}=e;return(0,p.tZ)("div",{css:I(t)})}},3538:(e,t,i)=>{i.d(t,{J3:()=>m,O3:()=>d,Ql:()=>c,n$:()=>p});var n=i(917),r=i(6421),s=i(81),o=i(5702),a=i(6920),l=i(5944);const c={lesson_name:lng("content name|editor"),item_text:lng("text|editor"),item_description:lng("description|editor")},d=e=>{let{value:t,onChange:i,onBlur:n,...o}=e;const{value:a,change:c,update:d}=(0,s.Qu)(t,(e=>i(e)));return(0,l.tZ)(r.I,{value:a,onChange:c,onBlur:()=>(d(),null==n?void 0:n()),...o})},p=e=>{let{value:t,onChange:i,...n}=e;const{value:r,change:a}=(0,s.Qu)(t,(e=>i(e)),2e3);return(0,l.tZ)(o._,{value:r,onChange:a,...n})},u=(0,n.iv)("background-color:",a.g.colors.bg_main,";box-shadow:rgba(100, 100, 111, 0.2) 0 7px 29px 0;border-radius:15px;padding:40px;",""),m=e=>{let{children:t,className:i}=e;return(0,l.tZ)("div",{css:u,className:i,children:t})}},7327:(e,t,i)=>{i.d(t,{o:()=>C,S:()=>Z});var n,r,s,o=i(6920),a=i(8318),l=i(441),c=i(6054),d=i(2334),p=i(8e3),u=i(8567),m=i(8534),g=i(7821),h=i(5007),b=i(4210),v=i(6975),_=i(5311),f=i(5944);class y extends b.I{constructor(e){super(e),this.group_id=e.group_id,this.assignment_id=e.assignment_id,this.title=lng("import grades from excel").caps()+": "+e.title,this.onSuccess=e.onSaveSuccess,this.confirmButtonLabel=lng("import"),this.saveUrl="reports/form/import_manual_assignment_excel",this.successMessage=lng("grades imported successfully"),this._fields=[{type:"component",node:(0,f.BX)("div",{children:[(0,f.tZ)("div",{children:lng("template download").caps()}),(0,f.BX)(l.A,{href:(0,p.Q2)("assignment/manual_assignment_excel_template/excel_template=user_name&group="+this.group_id),children:[(0,f.tZ)(v.JO,{icon:"vendor_file"})," ",lng("user name").caps()]}),(0,f.tZ)(_.zh,{}),(0,f.BX)(l.A,{href:(0,p.Q2)("assignment/manual_assignment_excel_template/excel_template=user_identity_num&group="+this.group_id),children:[(0,f.tZ)(v.JO,{icon:"vendor_file"})," ",lng("identity number").caps()]})]})},{type:"file",name:"manual_assignment_excel",label:lng("data upload")},{type:"checkbox",name:"send_manual_message",label:lng("send message to users")}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,Object.assign({group_id:this.group_id,assignment_id:this.assignment_id},e)),(0,h.vm)().closeDialog()}}function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function x(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function k(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const Z=e=>"1"===e.lesson_extern_file&&!e.extern_iframe||"1"===e.target_new_window||Blsm.isGuiFeatureEnabled("scorm_in_new_window")&&("Lti"===e.lesson_type||"File"===e.lesson_type&&["zip.scorm","zip.tincan"].includes(e.lesson_file_type));let C=(n=class extends c.M{constructor(e,t){super(e,t),x(this,"display",void 0),x(this,"showNew",void 0),w(this,"likesCount",r,this),w(this,"likesVote",s,this),x(this,"_dateNote",void 0),(0,g.makeObservable)(this),this.display=null==t?void 0:t.display,this.showNew=null==t?void 0:t.showNew,this._attr.likes&&(this.likesCount=parseInt(this._attr.likes.likes),this.likesVote=!!this._attr.likes.user_vote)}get running_times(){return this._attr.running_times||0}get assignment_access_limit(){return this._attr.assignment_access_limit}get assignment_dashboard_id(){return this._attr.group_id+"_"+this.assignment_id}get title(){return this._attr.title||this._attr.name||this._attr.assignment_name}get type(){return"assignment"}get icon(){return"entity_assignment"}get iconTooltip(){return lng("assignment")}get completed(){var e;return null===(e=this._attr.status)||void 0===e?void 0:e.completed}get approval_waiting(){var e;return(0,a.P$)(null===(e=this._attr.status)||void 0===e?void 0:e.approval_waiting)}get gradeInfo(){var e,t,i,n,r;if(null===(e=this._attr.status)||void 0===e||!e.grade)return null;const s=!(null===(t=this._attr.status)||void 0===t||!t.alt_score);return{label:s?lng("grade").caps():lng("score").caps(),toolTip:s?lng("real score:")+" "+(null===(i=this._attr.status)||void 0===i?void 0:i.grade):"",displayGrade:s?null===(n=this._attr.status)||void 0===n?void 0:n.alt_score:null===(r=this._attr.status)||void 0===r?void 0:r.grade}}get matchRate(){return this._attr.match_rate}get accumulation(){var e;return null===(e=this._attr)||void 0===e?void 0:e.accumulation}get successful_runs(){var e;return(null===(e=this._attr.status)||void 0===e?void 0:e.successful_runs)||0}get as_coach(){return this._attr.as_coach}get notice(){let e;var t;this._attr.can_play?e=lng("click to start").caps():e=this._attr.starts_at?lng("starts at %s",this._attr.starts_at).caps():this._attr.ended_at?lng("ended at %s",this._attr.ended_at).caps():this._attr.access_limit_reached?lng("access limit reached").caps():"manual"===this._attr.assignment_type?lng("manual assignment").caps():null!==(t=this._attr.dependencies)&&void 0!==t&&t.completed?"2"!==this._attr.managerun||this._attr.as_coach?lng("disabled").caps():lng("will be activated by the coach").caps():lng("prerequisites not completed").caps();return e}get coachUser(){return"2"!==this._attr.managerun||this._attr.as_coach?null:this._attr.coach_user}get status(){var e,t,i;return null!==(e=this._attr.status)&&void 0!==e&&e.completed?{text:lng("completed|single assignment"),color:o.g.colors.green,tooltip:this.gradeInfo?(null===(t=this.gradeInfo)||void 0===t?void 0:t.label)+": "+(null===(i=this.gradeInfo)||void 0===i?void 0:i.displayGrade):""}:{text:lng("to do"),color:o.g.colors.yellow}}get link(){if(this._attr.can_play){var e,t,i;if("master"===this._attr.assignment_type)return{master:this._attr.assignment_id,ws:null===(e=this.workspace)||void 0===e?void 0:e.group_id};const n={launcher:"assignment",id:this._attr.assignment_id};return(0,a.B5)(null===(t=this.workspace)||void 0===t?void 0:t.group_id)&&(n.params={group:null===(i=this.workspace)||void 0===i?void 0:i.group_id}),n.newTab=Z(this._attr),n}}get color(){return o.g.colors.green}isForCoach(){return"2"===this._attr.managerun}isToDO(){var e;return!(null!==(e=this._attr.status)&&void 0!==e&&e.completed)}dependencies(){var e,t,i;return null!==(e=this._attr.dependencies)&&void 0!==e&&e.completed||null===(t=this._attr.dependencies)||void 0===t||!t.output?[]:Object.values(null===(i=this._attr.dependencies)||void 0===i?void 0:i.output)}setActiveComponent(e){var t;null===(t=this.workspace)||void 0===t||t.setActiveComponent(e)}get isLate(){var e;if(this._attr.due_date&&(null===(e=this._attr.status)||void 0===e||!e.completed)){return(0,d._3)(this._attr.due_date).diff(new Date,"days")<0}return!1}get cardNote(){return this.dateNote}get sortTime(){return this.end_time}get date(){return this.dateNote.toDateTime}get dateNote(){if(this._dateNote)return this._dateNote;if(this._attr.due_date&&!this._attr.personal_dates){const e=(0,d._3)(this._attr.due_date),t=e.diff(new Date,"days"),i={icon:"clock",color:t<0?"negative":t<5?"warning":"positive",title:(0,d.k6)(e),toolTip:lng("due date")};return i.toDate=(0,d.k6)(e,{time:!1}),i.toTime=(0,d.k6)(e,{date:!1}),i.toDateTime=(0,d.k6)(e),this.completed||(i.text=t<0?lng("late").caps():t<5?lng("%s days left",t):i.toDate),this._dateNote=i}return{}}get subNote(){return"dashboard"===this.display?(0,a.v2)(this._attr.manager):null}get type_title(){return"dashboard"===this.display?"":this._attr.type_title}get category(){return"general"===this._attr.category_name?lng("general").caps():this._attr.category_name}get image(){return this._attr.assignment_image}get subTitle(){const e=this._attr.group_id||this._attr.origin_group_id,t=this._attr.condition_component?(0,f.BX)(f.HY,{children:[(0,f.tZ)(v.JO,{icon:"tree",color:o.g.colors.dominant_main})," ",this._attr.origin_group_name]}):this._attr.origin_group_name;return(0,a.B5)(e)||"personal"===e?(0,f.tZ)(l.A,{href:{workspace:e},newTab:!0,children:t}):t}get description(){return{text:this._attr.lesson_description||this._attr.text,isHtml:!this._attr.lesson_description||this._attr.descriptionIsHtml}}get users(){return this._attr.coached_users}get countUsers(){return this._attr.count_users}get commentsInfo(){var e;return"master"!==this._attr.assignment_type&&{count:parseInt(this._attr.comment_count)||0,connect:{type:"assignment",object_id:this._attr.assignment_id,group_id:null===(e=this.workspace)||void 0===e?void 0:e.group_id}}}get markColor(){return this.approval_waiting||parseInt(this.successful_runs)>0&&!this.completed?o.g.colors.chart.progress:this.isLate?o.g.colors.chart.failure:o.g.colors.chart.waiting}get markNew(){if(this.showNew){const e=this._attr.modification_time&&(0,d._3)(this._attr.modification_time).unix();return(0,d._3)((0,a.c7)()-this.showNew*a.s2).unix()<e}return!1}get progress(){if(!this._attr.statistics)return null;const e=parseInt(this._attr.statistics.users_count||0)-parseInt(this._attr.exemptions||0);return{progress:[parseInt(this._attr.statistics.complete_count||0),e],settings:{color:o.g.colors.set[this._attr.color_num],label:lng("completion").caps(),valueInBar:!0}}}get statistics(){var e;return null!==(e=this._attr.statistics)&&void 0!==e&&e.assignment_id?{scores:[{label:lng("highest score").caps(),val:this._attr.statistics.score_max,color:o.g.colors.positive,icon:"arrow_up"},{label:lng("lowest score").caps(),val:this._attr.statistics.score_min,color:o.g.colors.warning,icon:"arrow_down"},{label:lng("average score").caps(),val:this._attr.statistics.score_avg,color:o.g.colors.blue,icon:"poll",sub:{label:lng("standard deviation").caps(),val:this._attr.statistics.score_dev}}],last:{label:lng("failed users").caps(),val:this._attr.statistics.fail_count,color:o.g.colors.negative,icon:"close"}}:null}get hasCoach(){var e;return"coach"===this._attr.completion_requirement||"2"===this._attr.managerun||(null===(e=this._attr.assignment_options)||void 0===e?void 0:e.test_coach_review)}get isAssignmentCommentsLock(){return this._attr.lock_assignment_comments}get mayDeleteComments(){var e,t,i;return(null===(e=this.workspace)||void 0===e?void 0:e.is_owner)||(null===(t=this.workspace)||void 0===t||null===(i=t.isGeneralManager)||void 0===i?void 0:i.call(t))||this.isAssignmentOwner}get isAssignmentOwner(){var e,t;return!(null===(e=this._attr)||void 0===e||null===(t=e.lesson_owners)||void 0===t||!t.find((e=>(0,a.Tz)(e))))}get mayEditCommetns(){return"model"!==this._attr.assignment_type&&!this.isAssignmentCommentsLock&&!this._attr.hide_comments}toggleLockAssignmentComments(){this._attr.lock_assignment_comments=!this._attr.lock_assignment_comments,this._attr.lock_assignment_comments?(0,m.qV)(lng("comments are now disabled.")):(0,m.qV)(lng("comments are now enabled."))}get maySeeCommentsTab(){var e;return Blsm.isFeatureEnabled("assignments_comments")&&((null===(e=this.commentsInfo)||void 0===e?void 0:e.count)>0||!this.isAssignmentCommentsLock)}get mayLike(){return!!Blsm.isFeatureEnabled("assignments_ratings")&&(0,a.DM)(this.likesCount)}toggleLike(){var e;this.likesVote=!this.likesVote,this.likesCount=this.likesVote?this.likesCount+1:Math.max(this.likesCount-1,0);const t={req:"vote",type:"assignment",object_id:this._attr.assignment_id,user_action:"like",group_id:this._attr.group_id||(null===(e=this.master)||void 0===e?void 0:e.ws)};(0,p.SC)("likes",{data:t,method:"POST"})}menu(){var e,t,i,n,r,s,o,c,d,m,g;const{assignment_type:b,lesson_type:v,assignment_id_org:_,assignment_id:f,permissions:w,allow_manager_edit:x,assignment_owner:k,lesson_owners:Z,survey_anonymous:C,personal_dates:S,lesson_id:O,feedback_assignment:B,can_view_performance:T}=this._attr,N=(0,a.B5)(this._attr.group_id)||(0,a.B5)(null===(e=this.master)||void 0===e||null===(t=e.ws)||void 0===t?void 0:t.id)||(0,a.B5)(null===(i=this.master)||void 0===i||null===(n=i.data)||void 0===n||null===(r=n.groups)||void 0===r?void 0:r[0])||(0,a.B5)(this._attr.origin_group_id)||null,I="master"===b,D="lesson"===b&&"Checklist"===v,j=_||f,P=w||(null===(s=this.workspace)||void 0===s?void 0:s.permissions)||(null===(o=this.master)||void 0===o||null===(c=o.data)||void 0===c?void 0:c.permissions)||{},z=P[Blsm.ManagerPermissions.VIEW],E=P[Blsm.ManagerPermissions.GENERAL_CONFIG],R=P[Blsm.ManagerPermissions.CREATE_ASSIGNMENTS],F=(0,a.Tz)(k)||R&&x||Blsm.user.power_user_assignment_permissions,M=Z&&Z.find((e=>(0,a.Tz)(e))),A=null===(d=this.master)||void 0===d?void 0:d.id,q=["Survey","Evaluation","Test","Courseware"].includes(v),X=!I&&E&&Blsm.isFeatureEnabled("assignments_comments")&&N,L=this.hasCoach,$=L,V="manual"===b,U="form"===b,H="task"===b,J=C;let G=!1;E&&($||S)&&($&&S?G={label:lng("member options").caps(),val:"assignment_options",icon:"coach"}:$?G={label:lng("set coach").caps(),val:"assignment_options",icon:"coach"}:S&&(G={label:lng("set personal dates").caps(),val:"assignment_options",icon:"coach"}));const W=[T&&!U&&!V&&{label:lng("assignment log").caps(),href:(0,l.p4)({report:"ReportUserPerformances",params:{assignment:j,user:Blsm.user.id}}),icon:"report"},B&&{label:lng("feedback log").caps(),href:(0,l.p4)({report:"ReportQuestionDistribution",params:{assignment:B,user_mode:1}}),icon:"report"},U&&{label:lng("forms performances report").caps(),href:(0,l.p4)({report:"FormsPerformancesReport",params:{assignment:j,user:Blsm.user.id}}),icon:"report"},L&&{label:lng("assignment coach log").caps(),href:(0,l.p4)({report:"ReportCoachPerformances",params:{assignment:j,user:Blsm.user.id}}),icon:"report"},z&&"Survey"===v&&{label:lng("survey report").caps(),icon:"report",href:(0,l.p4)({report:"SurveyReport",params:{assignment:j,group:N}})},z&&!H&&!V&&"Survey"!==v&&{label:lng("success report").caps(),icon:"report",href:(0,l.p4)({report:"ReportSuccess",params:{assignment:j,group:N}})},!J&&z&&{label:lng("completion report").caps(),icon:"report",href:(0,l.p4)({report:"ReportCompletion",params:{assignment:j,group:N,subs:1}})},!J&&z&&!H&&!V&&{label:lng("league report").caps(),icon:"report",href:(0,l.p4)({report:"Report_League",params:{assignment:j,group:N}})},z&&(q||D)&&{label:lng("questions distribution report"),icon:"report",href:(0,l.p4)({report:"ReportQuestionDistribution",params:{assignment:j,group:N}})}],K=e=>{(0,p.SC)("assignment/lock_assignment_comments",{data:{lock:e,assignment_id:this._attr.assignment_id,group_id:N,master_id:A},method:"POST"},(()=>this.toggleLockAssignmentComments()))},Y=()=>{let e=A?lng("remove this assignment from the master assignment?").caps():lng("remove this assignment from the workspace?").caps();(0,u.BB)(e,{onConfirm:()=>(0,p.SC)("assignment/remove_assignment",{data:{assignment_id:j,group_id:N,master_id:A},method:"POST"},(()=>{var e,t;return null!==(e=this.master)&&void 0!==e&&e.removeSub(j),null===(t=this.workspace)||void 0===t?void 0:t.removeAssignment(this)}))})},Q=()=>{(0,u.BB)(lng("are you sure you wish to delete this assignment?").caps(),{onConfirm:()=>(0,p.SC)("assignment/delete_assignments",{data:{assignment_id:j,group_id:N,master_id:A},method:"POST"},(()=>{var e,t;return null!==(e=this.master)&&void 0!==e&&e.removeSub(j),null===(t=this.workspace)||void 0===t?void 0:t.removeAssignment(this)}))})};return[F&&{label:lng("edit").caps(),href:(0,l.p4)({edit:"assignment",id:j}),icon:"edit"},M&&{label:lng("edit content").caps(),href:(0,l.p4)({edit:"content",id:O,type:v}),icon:"edit"},G,(this.workspace&&R||F&&(null===(m=this.master)||void 0===m?void 0:m.ws))&&!V&&{label:lng("detach").caps(),icon:"trash",onClick:()=>Y()},(this.workspace&&R||F&&(null===(g=this.master)||void 0===g?void 0:g.ws))&&V&&{label:lng("delete").caps(),icon:"trash",onClick:()=>Q()},X&&(this.isAssignmentCommentsLock?{label:lng("unlock comments").caps(),val:"lock_assignment_comments",attr:{lock:1},icon:"lock_open",onClick:()=>K(0)}:{label:lng("lock comments").caps(),val:"lock_assignment_comments",attr:{lock:0},icon:"lock",onClick:()=>K(1)}),...W,F&&V&&{label:lng("import grades from excel").caps(),val:"import_manual_assignment_from_excel",icon:"import",onClick:()=>(0,h.vm)().openDialog("form",new y({assignment_id:j,group_id:N,title:this.title}))}]}get is_waiting(){return this._attr.is_waiting?1:0}calcStartTime(){return this._attr.start_date}calcEndTime(){return this._attr.due_date}calRelevantForDate(e){return(0,d.KC)(e,this.end_time)}canPlay(){return"can_play"in this._attr?this._attr.can_play:!(this._attr.completed||this.start_time&&!(0,d.CR)(this.start_time)||this.end_time&&(0,d.CR)(this.end_time))&&void 0}},r=k(n.prototype,"likesCount",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=k(n.prototype,"likesVote",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},8595:(e,t,i)=>{i.d(t,{n:()=>h});var n,r,s=i(2906),o=i(8567),a=i(8e3),l=i(5007),c=i(7821),d=i(5946),p=i(441),u=i(8116),m=i(5944);function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let h=(n=class extends s.yY{constructor(e,t){var i,n,s,o;super(e),g(this,"workspace",void 0),i=this,n="selected",o=this,(s=r)&&Object.defineProperty(i,n,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(o):void 0}),g(this,"displayWorkspace",!1),g(this,"onClick",void 0),(0,c.makeObservable)(this),this.workspace=null==t?void 0:t.workspace,this.displayWorkspace=null==t?void 0:t.displayWorkspace,this.onClick=null==t?void 0:t.onClick}get title(){return this._attr.title}get subTitle(){if(this.displayWorkspace){const e=this.attr("workspace")||{},t=e.title||this.attr("group_name"),i=e.group_id||this.attr("group_id");if(i&&t)return(0,m.tZ)(d.D,{large:!0,children:(0,m.tZ)(p.A,{href:{workspace:i,tab:"schedule"},children:t})})}return null}get type(){return"event"}get id(){return parseInt(this._attr.event_id)}get dateNote(){return(0,u.D6)(this)}select(e){this.selected=!!e}calcStartTime(){return this._attr.start_date||this._attr.start_time}calcEndTime(){return this._attr.due_date||this._attr.end_time}get icon(){return"entity_event"}get iconTooltip(){return lng("event")}remove(){this.workspace.deleteEvent(this)}deleteEvent(){(0,o.BB)(lng("are you sure you want to delete the selected items?"),{title:lng("delete").caps(),onConfirm:()=>(0,a.SC)("calendarevent/"+this.id,{method:"DELETE"},(()=>((0,l.vm)().closeDialog(),this.remove())))})}menu(){var e,t,i,n;const r=[],s=null===(e=this.workspace)||void 0===e||null===(t=e.mayCreateMeetings)||void 0===t?void 0:t.call(e),o=null===(i=this.workspace)||void 0===i||null===(n=i.mayEditMeetings)||void 0===n?void 0:n.call(i);return s&&r.push({label:lng("duplicate|verb"),icon:"copy",onClick:()=>{var e;return null===(e=this.workspace)||void 0===e?void 0:e.duplicateMeetings([this])}}),o&&r.unshift({label:lng("edit"),icon:"edit",onClick:()=>{var e;return null===(e=this.workspace)||void 0===e?void 0:e.openEventForm(this)}},{label:lng("delete"),icon:"trash",onClick:()=>this.deleteEvent()}),r}},b=n.prototype,v="selected",_=[c.observable],f={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}},w={},Object.keys(f).forEach((function(e){w[e]=f[e]})),w.enumerable=!!w.enumerable,w.configurable=!!w.configurable,("value"in w||w.initializer)&&(w.writable=!0),w=_.slice().reverse().reduce((function(e,t){return t(b,v,e)||e}),w),y&&void 0!==w.initializer&&(w.value=w.initializer?w.initializer.call(y):void 0,w.initializer=void 0),void 0===w.initializer&&(Object.defineProperty(b,v,w),w=null),r=w,n);var b,v,_,f,y,w},4821:(e,t,i)=>{i.d(t,{$:()=>C,Z:()=>S});var n=i(2906),r=i(7821),s=i(5560),o=i(5673),a=i(676),l=i(4902),c=i(9637),d=i(6005),p=i(5007),u=i(4210);class m extends u.I{constructor(e){super(),(0,r.makeObservable)(this);const{data:t={}}=e;this.onSaveSuccess=e.onSaveSuccess,this.channel=t.channel,this.buildFields(this.channel),this.title=lng("channel about")}buildFields(e){this._fields=[{name:"title",type:"text",label:lng("channel name")},{type:"richtext",name:"description",label:lng("description"),toolbarOptions:{font:!0,color:!0,link:!0,list:!0,align:!0}}],this._prepFields(e),this.ready=!0}save(e){this.saveToUrl("channel/edit_channel_details",Object.assign({...e,id:this.channel.id}))}}var g,h,b,v,_=i(6920),f=i(2755),y=i(2334),w=i(5944);function x(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Z(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let C=(g=class extends n.JH{constructor(e,t){super(e),k(this,"store",void 0),k(this,"playlists",[]),k(this,"subsData",void 0),x(this,"channel_name",h,this),x(this,"channel_description",b,this),x(this,"creation_time",v,this),(0,r.makeObservable)(this);const{playlists:i}=e;this.store=t,this.playlists=null==i?void 0:i.map((e=>new o.g(e))),this.channel_name=e.channel_name,this.channel_description=e.channel_about,this.creation_time=e.creation_time}editChannel(){(0,p.vm)().openDialog("form",new m({data:this.store,onSaveSuccess:e=>{this.channel_name=null==e?void 0:e.title,this.id=null==e?void 0:e.channel_id,this.channel_description=null==e?void 0:e.description,this.creation_time||(this.creation_time=(0,y.GG)(new Date,{time:!1})),(0,p.vm)().closeDialog()}}),{width:"800px"})}set id(e){this._attr.channel_id=e}get id(){return this._attr.channel_id}get ownerId(){return this._attr.user_id||this._attr.owner_id}get playlistsNum(){return this._attr.playlists_num}get title(){return this.channel_name}get subscribed(){return this._attr.subscribed}get ownerName(){return this._attr.full_name||`${this._attr.user_first_name} ${this._attr.user_last_name}`}get ownerAvatar(){return this._attr.user_avatar}get description(){return this.channel_description}get following(){return this._attr.following}get followers(){return this._attr.followers}get followersNum(){return this._attr.followers_num}},h=Z(g.prototype,"channel_name",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Z(g.prototype,"channel_description",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Z(g.prototype,"creation_time",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g);const S=(0,s.observer)((function(e){let{collection:t,scrollParent:i}=e;const n=[{title:lng("name").caps(),sortVal:"full_name"},{title:lng("followers").caps(),sortVal:"followers"},{title:lng("channel").caps()}],r=[{name:"user_id",label:"#",type:"text"},{name:"user_name",label:lng("name"),type:"text"}],s=[{val:"",label:lng("default")},{val:"full_name",label:lng("name")},{val:"followers",label:lng("followers")}];return(0,w.tZ)(a.iA,{cols:n,loading:null==t,collection:t,filters:r,sorts:s,scrollParent:i,RowRenderer:O,displayCount:!0})})),O=e=>{let{row:t}=e;const{user_id:i,followers:n}=t;return(0,w.BX)("tr",{css:B,children:[(0,w.tZ)(c.U6,{width:"300px",children:(0,w.BX)("div",{className:"user",children:[(0,w.tZ)(l.qE,{user:t})," ",(0,w.tZ)(d.D,{user:t})]})}),(0,w.tZ)("td",{children:n}),(0,w.tZ)("td",{children:(0,w.tZ)(f.ZT,{icon:"enter",color:"white",size:30,bgColor:_.g.colors.dominant_main,href:{user:i,tab:"channel"}})})]})},B={name:"mmfhuj",styles:"td{.user{display:flex;align-items:center;gap:10px;}&:nth-child(n+2){text-align:center;}}"}},8116:(e,t,i)=>{i.d(t,{Ag:()=>T,D6:()=>P,aZ:()=>j});var n,r,s,o,a,l=i(6920),c=i(6054),d=i(441),p=i(8318),u=i(2334),m=i(8e3),g=i(7821),h=i(7659),b=i(8567),v=i(3178),_=i(7363),f=i(539),y=(i(7882),i(8595)),w=i(8246),x=i(5946),k=i(7327),Z=i(81),C=i(5944);function S(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function O(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function B(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let T=(n=g.action.bound,r=g.action.bound,s=class extends c.M{constructor(e,t){var i,n,r,s,l;super(e,t),S(this,"attending",o,this),S(this,"zoomRecordings",a,this),O(this,"displayWorkspace",!1),O(this,"onClick",void 0),(0,g.makeObservable)(this),this.attending=null===(i=e.user_attending)||void 0===i?void 0:i.toLowerCase(),this.content=null===(n=e.content)||void 0===n?void 0:n.map((e=>new h.m(e))),this.zoomRecordings=null===(r=this._attr)||void 0===r||null===(s=r.zoom_rec_file_ids)||void 0===s||null===(l=s.split(","))||void 0===l?void 0:l.map(((e,t)=>({id:e,count:1+t}))),this.displayWorkspace=null==t?void 0:t.displayWorkspace,this.onClick=null==t?void 0:t.onClick}get title(){return this._attr.assignment_name||this._attr.title}get subTitle(){if(this.displayWorkspace){var e,t;const i=(null===(e=this.workspace)||void 0===e?void 0:e.title)||this._attr.group_name,n=(null===(t=this.workspace)||void 0===t?void 0:t.group_id)||this._attr.group_id;if(n&&i)return(0,C.tZ)(x.D,{large:!0,children:(0,C.tZ)(d.A,{href:{workspace:n,tab:"schedule"},children:i})})}return null}get type(){return"meeting"}get id(){return parseInt(this._attr.assignment_id)}get icon(){return"entity_meeting"}get iconTooltip(){return lng("meeting")}get completed(){var e;return null===(e=this._attr.status)||void 0===e?void 0:e.completed}get instructorNames(){var e;return null===(e=this._attr.instructors)||void 0===e?void 0:e.map((e=>e.full_name)).join()}get icalUid(){return this._attr.ical_uid}get dateNote(){return P(this)}get date(){return(0,u.k6)(this.start_time,{date:!0,time:!1})}get notice(){const e=(0,u.CR)(this.end_time),t=this.generateMeetingUrl();let i;return this.canPlay()&&t&&(i=this.isZoom()&&this.is_manager?lng("join as host").caps():lng("join online meeting").caps()),!t||this.canPlay()||e||(i=lng("online meeting link will be available 5 minutes before the meeting").caps()),i}get onlineUrlCopy(){const e=this.generateMeetingUrl(!1,Blsm.prm.server_name+"/");return null!=e&&e.url?e:null}get status(){const{status:e}=this._attr,t=(0,u.CR)(this.end_time),i=!t&&(0,u.CR)(this.start_time);return null!=e&&e.completed?{text:lng("completed"),color:l.g.colors.green}:t?{text:lng("finished"),color:l.g.colors.light_blue2}:i?{text:lng("started"),color:l.g.colors.blue}:"yes"===this.attending?{text:lng("going"),color:l.g.colors.light_blue}:"no"===this.attending?{text:lng("not going"),color:l.g.colors.grey}:{text:lng("upcoming"),color:l.g.colors.yellow}}get link(){if(this.canPlay()){const e=this.generateMeetingUrl();if(e)return e}return!1}canPlay(){const e=(0,u.CR)(this.end_time),t=(0,u._3)(this.start_time.unix()-300);return!e&&(0,u.CR)(t)}get secondaryLink(){return this.canPlay()&&this.is_manager&&this.isZoom()?{link:this.generateMeetingUrl(!1),label:lng("join as participant")}:null}get linkToolTip(){return!!this.link&&(this.isZoom()&&this.is_manager?lng("join as host").caps():lng("join online meeting").caps())}get newTab(){return!!this.link}get warnings(){var e,t;const i=[];if(null!==(e=this._attr.warnings)&&void 0!==e&&e.resources_conflicts&&i.push(lng("resources conflicts: ")+this._attr.warnings.resources_conflicts),(null===(t=this._attr.warnings)||void 0===t?void 0:t.blocking_events.length)>0){let e=0;const t=this._attr.warnings.blocking_events.map((t=>(!Blsm.user.isPowerManager&&t.manager_only&&e++,t.event_name)));1===e&&t.push(lng("another event")),e>1&&t.push(lng("%s other events",e)),t.length&&i.push(` ${lng("overlaps with:").caps()} ${t.join(", ")}`)}return i.join("\n")}get haveZoomRecordings(){var e;return!(null===(e=this._attr)||void 0===e||!e.zoom_rec_file_ids)}deleteZoomRecord(e){(0,b.BB)(lng("are you sure you want to delete this file?").caps(),{title:lng("delete file"),confirmText:lng("delete").caps(),onConfirm:()=>(0,m.SC)("file/zoom_rec/"+e.id,{method:"DELETE"},(()=>this.zoomRecordings.remove(e)))})}mayDeleteZoomRecord(){return Blsm.user.isPowerManager}get is_manager(){var e;return(null===(e=this.workspace)||void 0===e?void 0:e.is_manager)||this._attr.is_manager}get is_member(){return this._attr.is_member}get is_instructor(){var e;return(null===(e=this.instructors)||void 0===e?void 0:e.findIndex((e=>(0,p.Tz)(e.user_id))))>=0}mayCreateMeetings(){var e,t,i;return this._attr.group_id&&(null===(e=this._attr)||void 0===e||null===(t=e.permissions)||void 0===t?void 0:t[Blsm.ManagerPermissions.CREATE_MEETINGS])&&parseInt(null===(i=this._attr.group_options)||void 0===i?void 0:i.meetings)>0}mayEditMeetings(){var e,t;return this._attr.group_id&&Blsm.user.isManager&&(null===(e=this._attr)||void 0===e||null===(t=e.permissions)||void 0===t?void 0:t[Blsm.ManagerPermissions.EDIT_MEETINGS])}maySetAttendance(){var e,t;return this._attr.group_id&&Blsm.user.isManager&&(null===(e=this._attr)||void 0===e||null===(t=e.permissions)||void 0===t?void 0:t[Blsm.ManagerPermissions.SET_ATTENDANCE])}mayInviteGuest(){return this.is_manager&&this.isLiveClass()&&Blsm.InitialData.parameters.anonymous_assignments}isLiveClass(){return"prv://watchittoo"===this._attr.assignment_url}isZoom(){return"prv://zoom"===this._attr.assignment_url}menu(){var e,t,i,n,r,s,o,a,l;const c=[],{assignment_id:m,assignment_url:g}=this._attr,h=(null===(e=this.workspace)||void 0===e?void 0:e.group_id)||this._attr.group_id;if(h&&!this.workspace&&c.push({label:lng("go to the workspace"),icon:"enter",href:{workspace:h,tab:"schedule"}}),null!==(t=this.workspace)&&void 0!==t&&null!==(i=t.mayEditMeetings)&&void 0!==i&&i.call(t)||this.mayEditMeetings()){c.push({label:lng("edit"),icon:"edit",href:(0,d.p4)({edit:"meeting",id:m})}),this.workspace&&c.push({label:lng("delete"),icon:"trash",onClick:()=>this.workspace.deleteMeeting(this)});const e=this.generateMeetingUrl(!0);e&&c.push({label:this.isZoom()?lng("join as host").caps():lng("join online meeting").caps(),icon:"popout",href:e})}if(this.workspace&&(null!==(n=(r=this.workspace).mayCreateMeetings)&&void 0!==n&&n.call(r)||this.mayCreateMeetings())&&c.push({label:lng("duplicate|verb"),icon:"copy",href:(0,d.p4)({edit:"meeting",params:{ws:h,dup_from:m}})}),(null===(s=this.workspace)||void 0===s?void 0:s.users_count)>0&&"Course_template"!==(null===(o=this.workspace)||void 0===o?void 0:o.group_type)&&(null!==(a=this.workspace)&&void 0!==a&&null!==(l=a.maySetAttendance)&&void 0!==l&&l.call(a)||this.maySetAttendance())){var v,_,f;const e=5,t=10;this.workspace&&(null===(v=this.start_time)||void 0===v?void 0:v.isBefore(Date.now()+e*u.Mx))&&c.push({label:lng("set attendance").caps(),icon:"create",onClick:()=>this.workspace.setAttendance({assignmentId:m,groupId:h})}),c.push({label:lng("meeting report").caps(),icon:"report",href:(0,d.p4)({report:"ReportGroupMeetings",params:{assignment:m,group:h}})}),Blsm.isFeatureEnabled("qr_mark_attendance")&&null!==(_=this.start_time)&&void 0!==_&&_.isBefore(Date.now()+t*u.Mx)&&null!==(f=this.end_time)&&void 0!==f&&f.isAfter(Date.now()-t*u.Mx)&&c.push({label:lng("mark attendance via qr code"),icon:"qrcode",onClick:()=>(0,b.qR)((0,C.tZ)(I,{meeting_id:this.id}),{title:this.title})})}return this.workspace&&(this.workspace.mayInviteGuest(g)||this.mayInviteGuest())&&c.push({label:lng("invite guest"),icon:"export",onClick:()=>this.workspace.setMeetingUrl((0,p.qL)()+"Launcher?assignment="+m+"&anonymous=1")}),c}get instructors(){return this._attr.instructors}get resources(){return this._attr.resources}get maySeeResources(){var e,t,i;return((null===(e=this.workspace)||void 0===e||null===(t=e.mayEditMeetings)||void 0===t?void 0:t.call(e))||this._attr.group_id&&Blsm.user.isManager&&this._attr.hasEditPermission)&&(null===(i=this.resources)||void 0===i?void 0:i.length)>0}get locations(){const e=[];return this._attr.location&&e.push({label:lng("location").caps(),value:this._attr.location}),this._attr.meeting_gathering_area&&e.push({label:lng("gathering area").caps(),value:this._attr.meeting_gathering_area}),this._attr.meeting_audience&&e.push({label:lng("audience").caps(),value:this._attr.meeting_audience}),e}get description(){return{text:this._attr.text,isHtml:!0}}get descriptionText(){return(0,p.s9)(this._attr.text)}get didMeetingStart(){return(0,u.CR)(this.start_time)}get maySetSelfAttendance(){return"meeting"===this.type&&this.setAttending&&(this.is_member&&!this.is_manager&&!this.is_instructor||!this.is_member&&this.is_manager&&this.is_instructor)&&!this.didMeetingStart}setAttending(e){(0,m.SC)("meetings/attending",{data:{meeting:this._attr.assignment_id,decision:e}},(()=>this.attending=e))}get is_waiting(){return this.completed||(0,u.CR)(this.end_time)?0:1}generateMeetingUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;const{assignment_url:i,group_id:n,assignment_id:r}=this._attr;return void 0===e&&(e=this.is_manager),D(i,n,r,e,t)}},o=B(s.prototype,"attending",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a=B(s.prototype,"zoomRecordings",[g.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B(s.prototype,"status",[g.computed],Object.getOwnPropertyDescriptor(s.prototype,"status"),s.prototype),B(s.prototype,"deleteZoomRecord",[n],Object.getOwnPropertyDescriptor(s.prototype,"deleteZoomRecord"),s.prototype),B(s.prototype,"mayDeleteZoomRecord",[r],Object.getOwnPropertyDescriptor(s.prototype,"mayDeleteZoomRecord"),s.prototype),s);const N={name:"thew2f",styles:"justify-content:center;text-align:center;*{margin:2.5px;}._title{font-weight:600;font-size:1.2rem;}"},I=e=>{let{meeting_id:t}=e;const[i,n]=(0,_.useState)(),{width:r}=(0,Z.iP)();(0,_.useEffect)((()=>{s();const e=setInterval((()=>s()),6e4);return()=>clearInterval(e)}),[t]);const s=()=>{(0,m.SC)("meetings/mark_attendance_token/meeting="+t,{},n)},o=window.location.protocol+"//"+window.location.host+Blsm.prm.Mainref+"qr_attendance?token="+i,a=r>300?300:.5*r;return i?(0,C.BX)("div",{css:N,children:[(0,C.tZ)("div",{className:"_title",children:lng("scan qr code to mark your attendance").caps()}),(0,C.tZ)(v.s,{value:o,size:a})]}):(0,C.tZ)(f.$,{})},D=function(e,t,i,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Blsm.prm.Mainref,s="&ref="+encodeURIComponent(location.href);switch(e){case"prv://chat":return{onClick:()=>Blsm.chat_with_group(t,i),clickOnly:!0};case"prv://watchittoo":return`${r}Launcher?assignment=${i}${s}&is_manager=${n?"1":"0"}`;case"prv://conferencing":return`${r}conference?gid=${t}`;case"prv://zoom":return{url:`${r}redirect.php?target=zoom&meeting=${i}&manager=${n?"1":"0"}`,newTab:!0}}if(e)return{url:`${r}redirect.php?target=online_meeting&meeting=${i}`,newTab:!0}},j=(e,t)=>e.isEntity?(console.warn("newMeetingOrEvent: double entity",e),e):"event"===e.type?new y.n(e,t):"meeting"===e.type||!e.type&&e.assignment_id?new T(e,t):"group"===e.type?new w.j(e,t):"assignment"===e.type?new k.o(e,t):(console.warn("newMeetingOrEvent: unknown data.type",e.type,e),null),P=e=>{const{end_time:t,start_time:i}=e,n={icon:"clock",title:(0,u.k6)(i)},r=(0,u.zk)(i),s=(0,u.KC)(i,t),o=!s&&(0,u.f1)(i,t);return r&&!e._attr.whole_day||(n.date=(0,u.k6)(i,{time:!1})),e._attr.whole_day||(n.time=(0,u.k6)(i,{date:!1}),n.toTime=(0,u.k6)(t,{date:!1}),o&&(n.note=lng("of the following day"))),!t||o||s||(n.toDate=(0,u.k6)(t,{time:!1,year:!(0,u.FT)(i,t)})),n}},919:(e,t,i)=>{i.d(t,{O:()=>g,V:()=>m});var n,r,s,o,a=i(7821),l=i(2906),c=i(8e3),d=i(6920);function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const m=e=>{switch(e){case"opensesame":return"OpenSesame";case"linkedin":return"LinkedIn"}return e.caps()};let g=(n=class extends l.JH{constructor(e,t){super(e),p(this,"likesCount",r,this),p(this,"likesVote",s,this),p(this,"following",o,this),(0,a.makeObservable)(this),this.onlineContentStore=t,this.likesCount=e.likes,this.likesVote=e.user_vote,this.following=!!e.following,this.score=e.score}get completed(){return["passed","complete"].includes(this.status.text)}get duration(){const e=this._attr.estimated_duration;if(!e)return!1;if(e.includes("w")){const t=e.split("w");return`${t[0]} ${t[0]>1?lng("weeks").caps():lng("week").caps()}`}{let t=Math.floor(e/60),i=e-60*t;return`${t<10?"0"+t:t}:${i<10?"0"+i:i}`}}get gradeInfo(){return this.score?{label:lng("score").caps(),displayGrade:this.score}:null}get id(){return this._attr.external_id}get group_id(){return this._attr.group_id}get title(){return this._attr.group_name}get type(){return this._attr.type}get icon(){return"content"}get link(){return this._attr.group_options.aicc_url?{aicc:{oc_id:this.oc_id}}:{url:this._attr.group_options.url,newTab:!0}}get image(){return this._attr.poster}get type_title(){return this._attr.difficulty_label}get category(){return this._attr.group_options.category}get tags(){return this._attr.group_options.skills}get description(){return{text:this._attr.group_description,isHtml:!1}}get bottomNote(){return{text:this.provider,color:d.g.colors.dominant_main}}get status(){return{text:this._attr.status}}get provider(){return m(this._attr.group_options.provider)}get mayLike(){return!0}toggleLike(){this.likesVote=!this.likesVote,this.likesCount=this.likesVote?this.likesCount+1:Math.max(this.likesCount-1,0),(0,c.SC)("likes",{data:{req:"vote",type:"group",object_id:this._attr.group_id,user_action:"like"},method:"POST"})}togglePin(){(0,c.SC)("library/follow_content",{data:{id:this.group_id,leave:this.following?1:0}},(()=>this.onlineContentStore?this.onlineContentStore.follow(this):this.following=!this.following))}},r=u(n.prototype,"likesCount",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=u(n.prototype,"likesVote",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=u(n.prototype,"following",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},5673:(e,t,i)=>{i.d(t,{g:()=>m});var n,r,s=i(2906),o=i(7821),a=i(7659),l=i(8e3),c=i(441),d=i(5007),p=i(1750);function u(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let m=(n=class extends s.JH{constructor(e){var t,i,n,s,l,c;super(e),n=this,s="items",c=this,(l=r)&&Object.defineProperty(n,s,{enumerable:l.enumerable,configurable:l.configurable,writable:l.writable,value:l.initializer?l.initializer.call(c):void 0}),this.items=null===(t=e.items)||void 0===t?void 0:t.map((e=>new a.m(e))),null===(i=this.items)||void 0===i||i.sort(((e,t)=>parseInt(e._attr.item_order)-parseInt(t._attr.item_order))),(0,o.makeObservable)(this)}get id(){return this._attr.playlist_id}get title(){return this._attr.playlist_name}get status(){return this._attr.status}get playlistItems(){return this.items}get skills(){var e;let t={};return null===(e=this.items)||void 0===e||e.forEach((e=>{let{skills:i}=e;"string"!=typeof i&&(null==i||i.forEach((e=>{t[e.id]||(t[e.id]=e)})))})),Object.values(t)}menuOptions(e){const t=this.items.find((t=>t.assignment_id===e)),i=null==t?void 0:t.lesson_id;let n=[{label:lng("add to another playlist"),onClick:()=>this.onItemMove(e,this._attr.playlist_id),icon:"list_music"}];return parseInt(null==t?void 0:t._attr.owner_id)===parseInt(Blsm.user.id)&&(n.push({label:lng("edit"),icon:"edit",onClick:()=>this.onItemEdit(i)}),n.push({label:lng("remove from list"),icon:"trash",onClick:()=>this.onItemRemove(e)})),n}onItemRemove(e){const t=this.id;return(0,l.SC)(`channel/remove_from_playlist/&playlist_id=${t}&item_id=${e}&`,{method:"DELETE"},(()=>{var t,i;this.items=this.items.filter((t=>t.assignment_id!==e)),null===(t=(0,d.vm)().selfUserStore)||void 0===t||null===(i=t.channelStore)||void 0===i||i.invalidate()}))}onItemEdit(e){return(0,c.p4)({edit:"content",id:e},!0)}onItemMove(e){return(0,d.vm)().openDialog("form",new p.L({item:e}))}onAddItem(e){let{item:t}=e;this.items.push(new a.m(t))}updatePlaylist(e){let{title:t,status:i}=e;0!==i&&1!==i||(this._attr.status=i),t&&(this._attr.playlist_name=t)}},r=u(n.prototype,"items",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),u(n.prototype,"title",[o.computed],Object.getOwnPropertyDescriptor(n.prototype,"title"),n.prototype),u(n.prototype,"updatePlaylist",[o.action],Object.getOwnPropertyDescriptor(n.prototype,"updatePlaylist"),n.prototype),n)},8918:(e,t,i)=>{i.d(t,{N:()=>m});var n=i(409),r=i(441),s=i(2645),o=i(8246),a=i(8e3),l=i(5007),c=i(7675),d=i(2334),p=i(8318);function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class m extends o.j{constructor(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;var o;(i.anonymous&&("Course_template"===e.group_type?e.template_status="OPEN":e.status="OPEN"),e.status&&(e.statusInfo=(0,s.cW)(e.status)),"Course_template"===e.group_type)&&(e.statusInfo=e.template_status?(0,s.cW)(e.template_status):void 0,"reg_to_template"===e.registration_type?delete e.instances:null===(o=e.instances)||void 0===o||o.forEach((t=>{t.statusInfo="manager_register"!==e.group_access?(0,s.cW)(t.status):(0,s.cW)("ADD_MEMBERS"),t.typeName=(0,n.p)(t.group_type,t.is_course)})));e.sorting_date=parseInt(e.group_open_date_unix)||Number.MAX_SAFE_INTEGER,i.custom_fields&&(e.custom_fields=i.custom_fields),super(e,i),u(this,"instances",[]),u(this,"tab",void 0),this.tab=r,e.instances&&(this.instances=null===(t=e.instances)||void 0===t?void 0:t.map((e=>{var t;return new m(e,{anonymous:i.anonymous,display:"registration",custom_fields:null===(t=this._attr)||void 0===t?void 0:t.custom_fields})})))}get group_id(){return this._attr.group_id}get ect_id(){return this._attr.ect_id}get manager_register(){return this._attr.manager_register}get url_id(){return this._attr.ect_id?"e"+this._attr.ect_id:this._attr.group_id}get duration(){return!!Blsm.isFeatureEnabled("digital_library")&&(!!(this._attr.estimated_duration&&(0,p.B5)(this._attr.estimated_duration.val)&&this._attr.estimated_duration.unit)&&`${this._attr.estimated_duration.val} ${this._attr.estimated_duration.unit.caps()}`)}get isExternal(){return"external"===this._attr.course_status}get group_name(){return this._attr.group_name}get mayBookmark(){return this._attr.is_member||this._attr.is_manager}get bookmarked(){return this._attr.bookmark_id}toggleBookmark(){this._attr.bookmark_id=!this._attr.bookmark_id;const e={type:"group",id:this._attr.group_id,delete:this.bookmarked?"0":"1"};(0,a.SC)("bookmarks",{data:e,method:"POST"})}get likesVote(){return this._attr.user_vote}get likesCount(){return this._attr.likes}get mayLike(){return this._attr.is_member||this._attr.is_manager}get mayRecommend(){return this.isEnterprise&&(this._attr.is_member||this._attr.is_manager)&&this._attr.available_to_all_users}toggleLike(){this._attr.user_vote=!this._attr.user_vote,this._attr.likes=this._attr.user_vote?this._attr.likes+1:Math.max(this._attr.likes-1,0);const e={req:"vote",type:"group",object_id:this._attr.group_id,user_action:"like"};(0,a.SC)("likes",{data:e,method:"POST"})}get approver_data(){return this._attr.approver_data}get description(){return{text:this._attr.group_description,isHtml:!0}}get isAvailable(){if(this.isManager)return!0;const e=moment();return e>(0,d._3)(this.activityDates.start)&&e<(0,d._3)(this.activityDates.end)&&!this._attr.group_invisible}get matchRate(){return this._attr.match_rate}get extra_info(){return this._attr.registration_extra_info}get passing_grade(){return parseInt(this._attr.passing_grade)>0&&this._attr.passing_grade}get category(){return this._attr.classification_name}get CustomFieldsToDisplay(){var e,t,i;return null===(e=Object.values)||void 0===e||null===(t=e.call(Object,this._attr.custom_fields||{}))||void 0===t||null===(i=t.filter)||void 0===i?void 0:i.call(t,(e=>this._attr[e.field_column])).map((e=>({isHtml:"TEXT"===e.field_type,label:e.field_name,value:this._attr[e.field_column]})))}get activityDates(){return{start:this._attr.group_open_date,end:this._attr.group_close_date}}get registrationDates(){return{start:this._attr.registration_start_date,end:this._attr.registration_end_date}}get isTemplate(){var e;return"course_template"===(null===(e=this._attr.group_type)||void 0===e?void 0:e.toLowerCase())}get typeName(){return this.type_title}get type_title(){return Blsm.isFeatureEnabled("hide_group_types")?void 0:(0,n.p)(this.isTemplate?"course":this._attr.group_type,this._attr.is_course)}get link(){return{courseCatalog:!0,tab:this.tab,id:this.url_id||this.group_id}}get statusInfo(){return this._attr.statusInfo}menu(){return this._attr.is_owner?[{label:lng("edit").caps(),onClick:()=>(0,r.p4)({edit:"workspace",id:this.group_id},!0)}]:[]}get cardNote(){var e,t;return{text:null===(e=this._attr.statusInfo)||void 0===e?void 0:e.selfText,color:null===(t=this._attr.statusInfo)||void 0===t?void 0:t.cardColor}}get registerNumbers(){return{regType:this._attr.registration_type,groupType:this._attr.group_type,instances:this.instances,members:this._attr.num_of_members,remainingPlaces:!0===this._attr.remaining_places?-1:this._attr.remaining_places}}get displayCourseFieldsBtn(){return this.description.length>=70||this.extra_info||null!==this.activityDates.start||null!==this.activityDates.end||this.passing_grade||this.syllabus_file||this.syllabus_text||this.syllabus_url||this.CustomFieldsToDisplay.length>0||this.estimated_cost_for_member||this._attr.dependencies}get haveInstances(){var e;return(null===(e=this._attr.instances)||void 0===e?void 0:e.length)>0}get estimated_cost_for_member(){return this._attr.estimated_cost_for_member}get registerDependencies(){return this._attr.dependencies?Object.keys(this._attr.dependencies).map((e=>({id:e,title:this._attr.dependencies[e]}))):null}get subNote(){return this._attr.credit_on_completion?`${lng("credits").caps()}: ${this._attr.credit_on_completion}`:null}get priceTag(){var e;return"PRICE"===(null===(e=this._attr.statusInfo)||void 0===e?void 0:e.status)?this._attr.price_tag:""}get creditOnCompletion(){return this._attr.credit_on_completion?this._attr.credit_on_completion:0}get tags(){return this._attr.tags}Recommend(){(0,l.vm)().openDialog("form",new c.O({object_id:this.group_id,object_type:"workspace",onSaveSuccess:()=>(0,l.vm)().closeDialog()}))}}},7659:(e,t,i)=>{i.d(t,{m:()=>x});var n,r,s,o,a=i(6920),l=i(6054),c=i(4061),d=i(8e3),p=i(7821),u=i(5007),m=i(8534),g=i(2334),h=i(7327),b=i(441),v=i(8318),_=i(7675);function f(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function w(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let x=(n=class extends l.M{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),y(this,"deleteContent",void 0),y(this,"refLink",void 0),f(this,"likesCount",r,this),f(this,"likesVote",s,this),f(this,"bookmarked",o,this),(0,p.makeObservable)(this),this.deleteContent=t.deleteContent,this.refLink=t.refLink,e.likes&&(this.likesCount=parseInt(e.likes),this.likesVote=!!e.user_vote),this.bookmarked=!!this._attr.bookmark_id}get title(){return this._attr.name||this._attr.assignment_name||this._attr.lesson_name}get type(){return"share"}get icon(){return"entity_share"}get iconTooltip(){return lng("content")}get completed(){return this._attr.completed}get skills(){return this._attr.skills}get notice(){return lng("click to start").caps()}get matchRate(){return this._attr.match_rate}get status(){return this._attr.completed?{text:lng("viewed"),color:a.g.colors.green}:{}}get link(){const e={launcher:"assignment",id:this._attr.assignment_id};return this.refLink&&(e.ref=this.refLink),"Text"!==this.attr("lesson_type")||this.attr("has_placeholders")||(0,b.N0)()?e.newTab=(0,h.S)(this._attr):e.onClick=e=>{e.preventDefault(),(0,u.vm)().openDialog("Launcher",this),(0,d.SC)(`assignment/create_catalog_performance/${this.attr("assignment_id")}`)},e}get color(){return a.g.colors.light_blue}get image(){return this._attr.assignment_image}get type_title(){return"File"===this._attr.type_title&&""===this._attr.lesson_file_type?"Link":this._attr.type_title}get category(){return this._attr.category_name}get description(){return{text:this._attr.lesson_description,isHtml:this._attr.descriptionIsHtml}}get cardNote(){return this.expired?{text:lng("expired at").caps()+": "+(0,g.GG)(this._attr.due_date,{time:!1}),icon:"clock",color:"negative"}:null}get duration(){if(!Blsm.isFeatureEnabled("digital_library"))return!1;const e=this._attr.estimated_duration;if(!e||0===parseInt(e))return!1;let t=Math.floor(e/60),i=e-60*t;return`${t<10?"0"+t:t}:${i<10?"0"+i:i}`}get expired(){return this._attr.due_date&&(0,g.CR)((0,g._3)(this._attr.due_date))}menu(){var e,t,i,n;return(0,c.hk)({content:this._attr,actions:{deleteContent:this.deleteContent?()=>this.deleteContent(this):void 0,recommend:()=>this.Recommend(this)},mayLockComments:null===(e=this.workspace)||void 0===e||null===(t=e.isGeneralManager)||void 0===t?void 0:t.call(e),viewReports:(null===(i=this.workspace)||void 0===i?void 0:i.is_owner)||(null===(n=this.workspace)||void 0===n?void 0:n.is_manager)})}get commentsInfo(){return{count:parseInt(this._attr.comment_count)||0,connect:{type:"assignment",object_id:this._attr.assignment_id}}}toggleLockAssignmentComments(){this._attr.lock_assignment_comments=!this._attr.lock_assignment_comments,this._attr.lock_assignment_comments?(0,m.qV)(lng("comments are now disabled.")):(0,m.qV)(lng("comments are now enabled."))}get isAssignmentCommentsLock(){return this._attr.lock_assignment_comments}get maySeeCommentsTab(){var e,t;return Blsm.isFeatureEnabled("assignments_comments")&&((null===(e=this.commentsInfo)||void 0===e?void 0:e.count)>0||!this.isAssignmentCommentsLock)&&!this.statistics&&(null===(t=this.workspace)||void 0===t?void 0:t.group_id)}get mayDeleteComments(){var e,t,i;return(null===(e=this.workspace)||void 0===e?void 0:e.is_owner)||(null===(t=this.workspace)||void 0===t||null===(i=t.isGeneralManager)||void 0===i?void 0:i.call(t))}toggleLike(){this.likesVote=!this.likesVote,this.likesCount=this.likesVote?this.likesCount+1:Math.max(this.likesCount-1,0);const e={req:"vote",type:"assignment",object_id:this._attr.assignment_id,user_action:"like"};(0,d.SC)("likes",{data:e,method:"POST"})}toggleBookmark(){this.bookmarked=!this.bookmarked;const e={type:"assignment",id:this._attr.assignment_id,delete:this.bookmarked?"0":"1"};(0,d.SC)("bookmarks",{data:e,method:"POST"})}get mayToggleBookmark(){return this.isEnterprise}get mayLike(){return!(!super.mayLike||!this.isEnterprise)&&(0,v.DM)(this.likesCount)}get mayRecommend(){return this.isEnterprise&&this._attr.assign_to_domain&&Blsm.isFeatureEnabled("online_content")}get views(){return this._attr.view_count}get maySeeViews(){return this.isEnterprise}get is_waiting(){return this.completed?0:1}get lesson_id(){return this._attr.lesson_id}Recommend(){(0,u.vm)().openDialog("form",new _.O({object_id:this.lesson_id,object_type:"lesson",onSaveSuccess:()=>(0,u.vm)().closeDialog()}))}},r=w(n.prototype,"likesCount",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=w(n.prototype,"likesVote",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=w(n.prototype,"bookmarked",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},8246:(e,t,i)=>{i.d(t,{j:()=>d});var n=i(2906),r=i(409),s=i(8318),o=i(6920),a=i(441),l=i(2334);function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d extends n.yY{constructor(e,t){e.sorting_open_date=parseInt(null==e?void 0:e.group_open_date)||Number.MAX_SAFE_INTEGER,e.sorting_close_date=parseInt(null==e?void 0:e.group_close_date)||Number.MAX_SAFE_INTEGER,super(e.is_course?{...e,group_type:"Course"}:e),c(this,"display",void 0),c(this,"qualificationRequirement",void 0),this.display=null==t?void 0:t.display,this.qualificationRequirement=null==t?void 0:t.qualificationRequirement,this.hide_type=Blsm.isFeatureEnabled("hide_group_types")}get type(){return"workspace"}get group_id(){return this._attr.group_id}get image(){return this._attr.group_image}get circledImage(){return this._attr.patient_photo}get duration(){if(!this._attr.group_open_date_unix||!this._attr.group_close_date_unix)return!1;const e=this._attr.group_close_date_unix-this._attr.group_open_date_unix,t=e/60;if(t<1)return`${Math.floor(e)} ${Math.floor(e)>1?lng("seconds|time"):lng("second|time")}`;const i=t/60;if(i<1)return`${Math.floor(t)} ${Math.floor(t)>1?lng("minutes"):lng("minute")}`;const n=i/24;if(n<1)return`${Math.floor(i)} ${Math.floor(i)>1?lng("hours"):lng("hour")}`;const r=n/30;if(r<1){const e=n/7;return e<1?`${Math.floor(n)} ${Math.floor(n)>1?lng("days"):lng("day")}`:`${Math.floor(e)} ${Math.floor(e)>1?lng("weeks"):lng("week")}`}return`${Math.floor(r)} ${Math.floor(r)>1?lng("months"):lng("month")}`}get title(){return this._attr.group_name}get type_title(){return Blsm.isFeatureEnabled("hide_group_types")?void 0:(0,r.p)(this._attr.group_type,this._attr.is_course,!1,this.qualificationRequirement,this._attr.optional)}get description(){return{text:this._attr.group_description,isHtml:!0}}get category(){return this._attr.classification_name||this._attr.patient_name}get users(){return this._attr.users}get countUsers(){return this._attr.count_users}get progress(){return this._attr.progress}get isManager(){return this._attr.is_manager}get subNote(){return this.qualificationRequirement&&this._attr.credit_on_completion?`${lng("credits").caps()}: ${this._attr.credit_on_completion}`:(0,s.v2)(this._attr.manager)}get matchRate(){return this._attr.match_rate}get groupAccess(){return this._attr.group_access}get link(){return this.qualificationRequirement&&!this._attr.in_group&&!this._attr.is_manager_of_group&&["register","public"].includes(this._attr.group_access)?{courseCatalog:!0,tab:"self",id:this.group_id}:this._attr.workspace_locked?void 0:{workspace:this.group_id}}get bookmarked(){return this._attr.bookmarked||this._attr.bookmark_id}get activityDates(){var e,t;return{start:null===(e=this._attr)||void 0===e?void 0:e.group_open_date,end:null===(t=this._attr)||void 0===t?void 0:t.group_close_date}}get dateNote(){var e,t;if(null!==(e=this._attr)&&void 0!==e&&e.group_close_date||null!==(t=this._attr)&&void 0!==t&&t.group_open_date){var i,n;const e=(0,l._3)(this._attr.group_close_date),t=(0,l._3)(this._attr.group_open_date),r={toolTip:lng("activity dates")};return null!==(i=this._attr)&&void 0!==i&&i.group_open_date&&(r.date=(0,l.k6)(t,{time:!1})),null!==(n=this._attr)&&void 0!==n&&n.group_close_date&&(r.toDate=(0,l.k6)(e,{time:!1})),r}return{}}onClick(){(0,a.p4)(this.link,!0)}get completed(){var e;return null===(e=this._attr.status)||void 0===e?void 0:e.completed}get gradeInfo(){var e,t;return null!==(e=this._attr.status)&&void 0!==e&&e.score?{label:lng("score").caps(),displayGrade:null===(t=this._attr.status)||void 0===t?void 0:t.score}:null}get notice(){let e;return this._attr.workspace_locked&&(e=this._attr.workspace_locked_reason),e}menu(){return"dashboard"===this.display?[{label:lng("grades report"),href:(0,a.p4)({report:"CourseGradesReport",params:{group:this.group_id}})},{label:lng("status report"),href:(0,a.p4)({report:"ReportGroupStatus",params:{group:this.group_id}})},{label:lng("instructors report"),href:(0,a.p4)({report:"ReportCoursesinstructors",params:{group:this.group_id}})},{label:lng("social report"),href:(0,a.p4)({report:"SocialReport",params:{group:this.group_id}})},{label:lng("meetings report"),href:(0,a.p4)({report:"meetings",params:{group:this.group_id}})},this._attr.is_course&&Blsm.isFeatureEnabled("course_monitoring")&&Blsm.user.isPowerManager&&{label:lng("course monitoring"),href:(0,a.p4)({report:"ReportCourseMonitoring",params:{group:this.group_id}})}]:[]}get statistics(){return this._attr.statistics?{scores:[{label:lng("opened tasks").caps(),val:this._attr.statistics.tasks_open,color:o.g.colors.positive,icon:"arrow_up"},{label:lng("in progress").caps(),val:this._attr.statistics.tasks_in_progress,color:o.g.colors.warning,icon:"arrow_down"},{label:lng("on hold").caps(),val:this._attr.statistics.tasks_on_hold,color:o.g.colors.dominant_main,icon:"poll"}],last:{label:lng("completed tasks").caps(),val:this._attr.statistics.tasks_closed,color:o.g.colors.negative,icon:"close"}}:null}calcStartTime(){return this._attr.start_time||this._attr.group_open_date}calcEndTime(){return this._attr.end_time||this._attr.group_close_date}get linkToolTip(){return!!this.link&&lng("go to the workspace").caps()}get icon(){switch(this._attr.group_type){case"Course":case"Course_template":return"entity_course";case"Group":return"entity_group";case"Qualification":return"entity_qualification";case"Workplan":return"entity_workplan";case"Ou":return"entity_org_unit"}return this.isExternal?"entity_external":""}get iconTooltip(){const e=this.isExternal?"course_external":this._attr.group_type;return(0,r.p)(e,this._attr.is_course)}}},6054:(e,t,i)=>{i.d(t,{M:()=>m});var n,r,s,o,a=i(2906),l=i(7821),c=i(8318);function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let m=(n=class extends a.yY{constructor(e,t){super(e),p(this,"workspace",void 0),d(this,"order",r,this),d(this,"selected",s,this),d(this,"unitId",o,this),(0,l.makeObservable)(this),this.workspace=null==t?void 0:t.workspace,this.master=null==t?void 0:t.master,this.order=this._attr.assignment_order,this.unitId=this._attr.learning_unit_id,this.hide_type=Blsm.isFeatureEnabled("hide_component_types")}get assignment_id(){return this._attr.assignment_id}get linkToolTip(){return!!this.link&&lng("start|verb").caps()}get category_id(){var e;return(null===(e=this._attr)||void 0===e?void 0:e.lesson_category_id)||this._attr.category_id}get mayLike(){return!!Blsm.isFeatureEnabled("assignments_ratings")&&(0,c.DM)(this.likesCount)}get maySeeCommentsTab(){return Blsm.isFeatureEnabled("assignments_comments")&&!this.statistics}select(e){this.selected=!!e}calcStartTime(){return this._attr.start_date||this._attr.start_time}calcEndTime(){return this._attr.due_date||this._attr.end_time}},r=u(n.prototype,"order",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),s=u(n.prototype,"selected",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=u(n.prototype,"unitId",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},4210:(e,t,i)=>{i.d(t,{DW:()=>V,HE:()=>J,I:()=>H,ip:()=>$,q3:()=>L});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_,f,y,w,x,k,Z,C,S,O,B,T,N,I=i(7821),D=i(8e3),j=i(8318),P=i(7363),z=i(8534),E=i(4576),R=i(2334),F=i(4470),M=i.n(F);function A(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function q(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function X(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const L=(0,P.createContext)(null),$="--delete--",V=e=>!(!e||e===$),U=(e,t)=>{if(t)for(let i of e.filter((e=>!!e))){if("section"===i.type&&i.sid===t)return i;if(i.fields){const e=U(i.fields,t);if(e)return e}}};let H=(n=I.observable.shallow,r=I.observable.shallow,s=I.observable.shallow,o=I.action.bound,a=I.action.bound,l=I.action.bound,c=I.action.bound,d=I.action.bound,p=I.action.bound,u=I.action.bound,g=X((m=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};q(this,"isEnterprise",Blsm.checkMod(["","ENT"])),A(this,"ready",g,this),A(this,"rebuild",h,this),A(this,"error",b,this),A(this,"status",v,this),A(this,"progress",_,this),A(this,"createMode",f,this),A(this,"values",y,this),A(this,"errors",w,this),A(this,"_initialValues",x,this),q(this,"fieldNames",new Set),q(this,"fieldsByName",new Map),A(this,"title",k,this),A(this,"headExtra",Z,this),A(this,"_windowTitle",C,this),A(this,"confirmButtonLabel",S,this),A(this,"_activeSection",O,this),q(this,"_fields",[]),q(this,"_fieldToValidate",[]),q(this,"_defaultSaveValues",{}),q(this,"_successButtons",[]),q(this,"onSaveSuccess",void 0),q(this,"successMessage",void 0),q(this,"saveAsJson",!1),q(this,"sendEmpty",!1),q(this,"validateOnChange",!1),q(this,"savePanel",!0),q(this,"onClose",null),q(this,"onValueChange",null),q(this,"params",{}),q(this,"FormComponent",null),A(this,"meta",B,this),q(this,"fieldObjectKeys",new Map),A(this,"extra_component",T,this),A(this,"controlSearch",N,this),q(this,"backFromDirty",(()=>null));const{onSaveSuccess:t,onValueChange:i,...n}=e;(0,I.makeObservable)(this),this.onSaveSuccess=t,this.onValueChange=i,this.params=n}updateValue(e,t){var i;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t){if(t.endsWith("[]")&&n){t=t.substr(0,t.length-2);let i=(0,I.get)(this.values,t)||[];i=i.filter((e=>e!==n)),e&&i.push(e),e=i}!this.sendEmpty&&""===e&&"checkbox"===(null===(i=this.getFieldByName(t))||void 0===i?void 0:i.type)||null==e||Array.isArray(e)&&!e.length?(0,I.remove)(this.values,t):(0,I.set)(this.values,t,e),r||(this.onValueChange&&this.onValueChange(t,e),this.validateOnChange&&this._validateField(t))}}setExtraComponent(e){this.extra_component=e}getValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(e.endsWith("[]")&&t){e=e.substr(0,e.length-2);return((0,I.get)(this.values,e)||[]).includes(t)?t:void 0}return this.values.get(e)}setValues(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{clear:!1}).clear&&this.values.clear();for(const[t,i]of this.fieldsByName.entries()){let n=this.getValueByName(t,e);this._prepAndUpdateValue(t,n,i)}}pickValues(e){return Object.assign({},...e.map((e=>({[e]:this.values.get(e)}))))}get fields(){return this._fields.filter((e=>!!e))}get fieldsColumns(){return this.fields.reduce(((e,t)=>{const i=t.column||0;return e[i]||(e[i]=[]),e[i].push(t),e}),[]).filter((e=>!!e))}get successButtons(){return this._successButtons.filter((e=>!!e))}setActiveSection(e){this._activeSection=(null==e?void 0:e.sid)||null}setActiveSectionById(e){this._activeSection=e||null}get activeSection(){let e=U(this._fields,this._activeSection);var t,i;e||(e=this._fields[0],"section"===(null===(t=e)||void 0===t||null===(i=t.fields)||void 0===i?void 0:i[0].type)&&(e=e.fields[0]));return e}get windowTitle(){return this._windowTitle||this.title}ValidateSaveResponse(e){return!(e.error_msg||e.error)}SaveFail(e){(0,z.Mj)(e.error_msg||e.error||e||lng("unknown error"))}saveToUrl(e,t){this.status="saving",this.progress=0,(0,D.SC)(e,{data:t,method:"POST",json:this.saveAsJson,onProgressUp:(0,I.action)(((e,t)=>this.progress=(0,j.NM)(100*e/t))),onError:()=>{this.progress=null,this.status=null}},(0,I.action)((e=>{this.ValidateSaveResponse(e)?(this.setActiveSection(null),this.progress=null,this.status="success",this.resetDirtyValues(),this.successMessage&&(0,z.qV)(this.successMessage),this.onSaveSuccess?this.onSaveSuccess(e):this.SaveSuccess(e)):(this.status=null,this.SaveFail(e))})))}resetDirtyValues(){this._initialValues.replace(this.values,{deep:!1})}validate(){return new Promise((e=>{Promise.all(this._fieldToValidate.map((e=>this._validateField(null,e)))).then((()=>{e(0===this.errors.size)}))}))}_setFieldError(e,t){"string"==typeof t&&t?(0,I.set)(this.errors,e,t):(0,I.remove)(this.errors,e)}_validateField(e,t){if(!(t=t||this._fieldToValidate.find((t=>t.name===e))))return;if(e=t.name,t.visible&&!t.visible(this.values,t.name))return this._setFieldError(e);const i=(0,I.get)(this.values,t.name),n=void 0!==i&&(!(0,j.HD)(i)||""!==i.trim()&&i!==$);if(!n&&(!0===t.required||(0,j.g4)(t.required)))return this._setFieldError(e,lng("%s is required",t.label).caps());let r=null;if(n&&(0,j.Kn)(r=(0,j.g4)(t.validate,null,[i])))return this._setFieldError(e,r.error.caps());if(i&&t.remoteValidate&&(!t.mask||!i.includes("_"))){const{url:e,method:n="GET",parseResult:r}=t.remoteValidate;return new Promise((s=>{(0,D.SC)(e,{method:n,data:{[t.name]:i}},(e=>{this._setFieldError(t.name,r?r(e):e),s()}))}))}this._setFieldError(e)}allFilled(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((e,t)=>e&&(0,I.get)(this.values,t)),!0)}callSave(){this.validate().then((e=>!0===e&&this.save(this.buildFinalValues())))}save(e){throw new Error("BaseForm:save abstract function not implemented")}SaveSuccess(){throw new Error("BaseForm:SaveSuccess abstract function not implemented")}buildFinalValues(){const e={};for(const[t,i]of this.values.entries()){const n=this.fieldsByName.get(t);if(n&&(0,j.g4)(n.disable,null,[this.values]))continue;let r=i;if(r instanceof Map){if(this.fieldObjectKeys.get(t)){const e=r;r=new Map;for(const[i,n]of e.entries())r.set(i,(0,j.ei)(n,this.fieldObjectKeys.get(t)))}r=Object.fromEntries(r)}let s=this._parseName(t);for(let t=s.length-1;t>=0;t--)0===t?e[s[t]]?M()(!0,e[s[t]],r):e[s[t]]=r:r={[s[t]]:r}}return Object.assign({},this._defaultSaveValues,e)}_prepFields(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;t=t||this._fields;for(let i of t.filter((e=>!!e)))if((!("insert"in i)||i.insert)&&(!("mod"in i)||Blsm.checkMod(i.mod)))if(i.fields)this._prepFields(e,i.fields,!0);else{const{searchData:t,searchDataCacheFunc:c,type:d,options:p,name:u,required:m,validate:g,remoteValidate:h,value:b,emptyOption:v,objectKeys:_}=i;if(t&&(i.searchData=(0,j.pR)(t,{hashFn:c})),"select"===d&&p&&!(0,j.Wl)(p)&&(i.options=(0,j.wd)(p)),u){var n,r,s,o,a,l;_&&this.fieldObjectKeys.set(u,_),this.fieldNames.add(u),this.fieldsByName.set(u,i),(m||g||h)&&this._fieldToValidate.push(i);let t=this.getValueByName(u,e)||b||("select"!==d||v?void 0:(null===(n=i.options)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.val)||(null===(s=i.options)||void 0===s||null===(o=s[0])||void 0===o||null===(a=o.options)||void 0===a||null===(l=a[0])||void 0===l?void 0:l.val))||(this.sendEmpty?"":void 0);this._prepAndUpdateValue(u,t,i)}}i||this.resetDirtyValues()}_prepAndUpdateValue(e,t,i){const{type:n,valueIsMap:r,checkboxValue:s}=i;null!=t&&("checkbox"!==n||0!==t&&"0"!==t)&&("tags"===n&&""!==t&&"function"==typeof t.split&&(t=t.split(",").map((e=>e.trim()))),["date","date_time"].includes(n)&&(t=(0,R.GG)(t,{time:"date_time"===n})),r&&(t=new Map(Object.entries(t))),"checkbox"!==n||!0!==t||s||(t=1),this.updateValue(t,e,s,!0))}_parseName(e){const t=e.split("[");let i,n=[];for(const e in t){i=t[e];const r=i.indexOf("]");-1!==r&&(i=i.substring(0,r)),n.push(i)}return n}getValueByName(e,t){const i=this._parseName(e);for(let e=0;e<i.length&&t;e++)i[e]&&(t=t[i[e]]);return t}get dirty(){return(0,j.SZ)(this.values.toJSON())!==(0,j.SZ)(this._initialValues.toJSON())||this.customDirty}get alertBeforeClose(){return!1}_customFieldsPrep(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{columns:t=1,visible:i,disable:n,neverRequired:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.length)return[];const s=e.map((t=>{const{field_column:s,field_name:o,field_type:a,field_key:l,field_data:c,table:d,must_fill:p}=t,u=(e=>{switch(e){case"INT":return"number";case"VARCHAR":return"text";case"TEXT":return"richtext";default:return e.toLowerCase()}})(a),{dependency_field_id:m,values:g,autocomplete:h}=c||{},b=()=>{const t=e.find((e=>e.field_id===m));return this.values.get(null==t?void 0:t.field_column)};return this._defaultSaveValues[s]="",(0,j.v7)({type:u,name:s,field_key:l,label:o,maxLength:"text"===u?255:void 0,disable:n,options:["select","select_multi"].includes(u)?()=>Object.entries(g).filter((e=>{let[t,i]=e;return!0===i||i.includes(b())})).map((e=>{let[t]=e;return{val:t,label:t}})):void 0,emptyOption:"select"===u||void 0,required:!r&&p?!m||(()=>!!b):void 0,suggest:h?{table:d}:void 0,visible:m?b:i},(e=>void 0!==e))}));if(t>=2){return((e,t)=>Array(Math.ceil(e.length/t)).fill().map(((e,i)=>i*t)).map((i=>e.slice(i,i+t))))(s,t).map((e=>({type:"row_set",fields:e})))}return s}_fieldMask(e,t){const i=t[e.name];i&&(e.mask="brazil_cpf"===i?"999.999.999-99":"israel_id"===i?"999999999":i,"brazil_cpf"===i?e.validate=()=>{const t=(0,I.get)(this.values,e.name);return!(!t.includes("_")&&!(0,E.pM)(t))||{error:lng("CPF is invalid")}}:"israel_id"===i&&(e.validate=()=>!(!(0,I.get)(this.values,e.name).includes("_")&&!(0,E.wQ)((0,I.get)(this.values,e.name)))||{error:lng("identity number is invalid").caps()}))}setOnClose(e){this.onClose=e}getFieldByName(e){return J(this._fields,(t=>(null==t?void 0:t.name)===e))}getFieldById(e){return J(this._fields,(t=>(null==t?void 0:t.id)===e))}}).prototype,"ready",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=X(m.prototype,"rebuild",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=X(m.prototype,"error",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),v=X(m.prototype,"status",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_=X(m.prototype,"progress",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=X(m.prototype,"createMode",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),y=X(m.prototype,"values",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),w=X(m.prototype,"errors",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),x=X(m.prototype,"_initialValues",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),k=X(m.prototype,"title",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Z=X(m.prototype,"headExtra",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=X(m.prototype,"_windowTitle",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=X(m.prototype,"confirmButtonLabel",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return lng("save").caps()}}),O=X(m.prototype,"_activeSection",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=X(m.prototype,"meta",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),T=X(m.prototype,"extra_component",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=X(m.prototype,"controlSearch",[I.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),X(m.prototype,"updateValue",[o],Object.getOwnPropertyDescriptor(m.prototype,"updateValue"),m.prototype),X(m.prototype,"setExtraComponent",[a],Object.getOwnPropertyDescriptor(m.prototype,"setExtraComponent"),m.prototype),X(m.prototype,"setValues",[I.action],Object.getOwnPropertyDescriptor(m.prototype,"setValues"),m.prototype),X(m.prototype,"fieldsColumns",[I.computed],Object.getOwnPropertyDescriptor(m.prototype,"fieldsColumns"),m.prototype),X(m.prototype,"setActiveSection",[l],Object.getOwnPropertyDescriptor(m.prototype,"setActiveSection"),m.prototype),X(m.prototype,"setActiveSectionById",[c],Object.getOwnPropertyDescriptor(m.prototype,"setActiveSectionById"),m.prototype),X(m.prototype,"activeSection",[I.computed],Object.getOwnPropertyDescriptor(m.prototype,"activeSection"),m.prototype),X(m.prototype,"windowTitle",[I.computed],Object.getOwnPropertyDescriptor(m.prototype,"windowTitle"),m.prototype),X(m.prototype,"SaveFail",[d],Object.getOwnPropertyDescriptor(m.prototype,"SaveFail"),m.prototype),X(m.prototype,"saveToUrl",[p],Object.getOwnPropertyDescriptor(m.prototype,"saveToUrl"),m.prototype),X(m.prototype,"validate",[I.action],Object.getOwnPropertyDescriptor(m.prototype,"validate"),m.prototype),X(m.prototype,"_setFieldError",[I.action],Object.getOwnPropertyDescriptor(m.prototype,"_setFieldError"),m.prototype),X(m.prototype,"callSave",[u],Object.getOwnPropertyDescriptor(m.prototype,"callSave"),m.prototype),X(m.prototype,"dirty",[I.computed],Object.getOwnPropertyDescriptor(m.prototype,"dirty"),m.prototype),X(m.prototype,"alertBeforeClose",[I.computed],Object.getOwnPropertyDescriptor(m.prototype,"alertBeforeClose"),m.prototype),m);const J=(e,t,i)=>(0,j.oH)(e,(e=>!("insert"in e&&!e.insert)&&t(e)),i,(e=>Array.isArray(e)||(0,j.Kn)(e)&&e.type))},7073:(e,t,i)=>{i.d(t,{Z:()=>d});var n,r,s=i(8e3),o=i(4210),a=i(8318),l=i(7821);function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let d=(n=class extends o.I{static matchForm(){return!1}updateFormRoute(){return!1}defaultUpdateFormRoute(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const[n,...r]=e;let s,o;if(i?[s,o]=r:[o]=r,t===n&&(!i||(0,a.SZ)(this.route[0]||"")===(0,a.SZ)(s||"")))return this.route=r,this._activeSection=o,!0}constructor(e){let{route:t,nav:i}=e;var n,s,o,a;super(),c(this,"nav",null),c(this,"route",null),c(this,"fetchUrl",null),c(this,"saveUrl",null),c(this,"backToButton",null),c(this,"expandAndSearchSections",!0),n=this,s="savePanelExtraButtons",a=this,(o=r)&&Object.defineProperty(n,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(a):void 0}),this.nav=i,this.route=t}fetch(){if(!this.fetchUrl||!this._acceptDataFromServer)throw new Error("fetchUrl or _acceptDataFromServer are missing");(0,s.SC)(this.fetchUrl,{},(e=>{this.serverResponse=e,this._acceptDataFromServer(e)}))}save(e){this.saveToUrl(this.saveUrl,e)}_acceptDataFromServer(){throw new Error("BaseForm:_acceptDataFromServer abstract function not implemented")}},p=n.prototype,u="savePanelExtraButtons",m=[l.observable],g={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}},b={},Object.keys(g).forEach((function(e){b[e]=g[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=m.slice().reverse().reduce((function(e,t){return t(p,u,e)||e}),b),h&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(h):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(p,u,b),b=null),r=b,n);var p,u,m,g,h,b},3522:(e,t,i)=>{i.d(t,{m:()=>B,z:()=>y});var n,r=i(7073),s=i(7821),o=i(5007),a=i(6920),l=i(6975),c=i(5560),d=i(8318),p=i(8e3),u=i(5702),m=i(7697),g=i(441),h=i(2247),b=i(5519),v=i(5944);const _="challenge";var f={name:"vvfcxc",styles:"display:flex;justify-content:center;margin-top:-50px;margin-bottom:60px;.pentagon{transform:scale(1.8);}"};let y=(n=class e extends r.Z{static matchForm(t,i){let{nav:n}=i;const[r,...s]=t;if(r===_)return new e({route:s,nav:n})}updateFormRoute(e){return this.defaultUpdateFormRoute(e,_)}constructor(e){let{route:t,nav:i}=e;super({route:t,nav:i}),(0,s.makeObservable)(this);const[n,r]=t;this._activeSection=r,this.params=n,this._id=(0,d.B5)(n)?parseInt(n):0,this.createMode=!this._id,this._id?(this.fetchUrl=`gamification/load_badge/${this._id}`,this.saveUrl=`gamification/save_badge/${this._id}`):(this.fetchUrl="gamification/load_badge/",this.saveUrl="gamification/save_badge/"),this.successMessage=lng("challenge saved"),this.backToButton={label:lng("back to %s|back to some page",lng("challenges")).caps(),onClick:()=>(0,g.p4)({list:"challenges"},!0)},this.fetch()}setActiveSection(e){this.nav([_,this.route[0],null==e?void 0:e.sid],{replace:!0})}_acceptDataFromServer(e){var t;if(this.initialValues=e,this.type=e.badge_type||(null===(t=this.params)||void 0===t?void 0:t.type),!this.type)return(0,o.vm)().openDialog("TypeSelector",O(this.params,this.type),{onClose:e=>(e(),history.back()),noState:!0});if(e.badge_notify_custom&&this.values.set("badge_notify",1),this._windowTitle=this.createMode?lng("new challenge"):lng("edit %s",e.badge_name),this.title=this.createMode?lng("new challenge"):lng("edit challenge"),e.notifications){const t=new Map;for(const[i,n]of Object.entries(e.notifications))t.set(i,n);this.initialValues.notifications=t}this.initialValues.color||(this.initialValues.color=(0,d.p)()),this.initialValues.icon||(this.initialValues.icon=N[Math.floor(Math.random()*N.length)]),this.initialValues.badge_access||(this.initialValues.badge_access="self"),this.initialValues.badge_time_frame||(this.initialValues.badge_time_frame=4),(this.initialValues.badge_due_date||this.initialValues.badge_time_frame)&&0!==this._id||(this.initialValues.badge_due_date=moment().add(4,"weeks")),this.buildFields(),this._prepFields(this.initialValues),this.ready=!0}get preview(){const e=f;return{custom:(0,v.tZ)("div",{css:e,children:(0,v.tZ)(m.Pp,{icon:this.values.get("icon"),color:this.values.get("color")})})}}buildFields(){const e={challenge_due_date:{message:!0,sms:!0,opr:"-"}},t=()=>({user_lng:lng("the performer"),role_settings:!1,targetFieldsOptions:["user"],target_preselect:"user",due_date:this.values.get("badge_due_date")}),i=[{val:4,label:lng("%s weeks",4)},{val:3,label:lng("%s weeks",3)},{val:2,label:lng("%s weeks",2)},{val:1,label:lng("1 week")},{val:0,label:lng("no limit")}];this._fields=[{type:"section",sid:"details",title:lng("details"),fields:[{type:"component",node:(0,v.tZ)("div",{style:{fontSize:"1.3em",fontWeight:"600",textAlign:"center"},children:(0,v.tZ)("span",{css:a.g.classes.content_type_style,children:B[this.type].caps()})})},{type:"hidden",name:"badge_type",value:this.type},{type:"text",name:"badge_name",label:lng("name"),required:!0,maxLength:200},{type:"textarea",name:"badge_description",label:lng("description")},{type:"color",name:"color",label:lng("color"),random:!0},{type:"component",name:"icon",Render:T,props:{color:()=>this.values.get("color")||this.initialValues.color}}]},{type:"section",sid:"conditions",title:lng("conditions"),fields:[{type:"single_item",name:"badge_conditions[ids]",required:!0,label:"score_assignment"===this.type?lng("select assignment"):"score_workspace"===this.type?lng("select workspace"):lng("select course"),insert:["score_assignment","score_workspace","action_enroll"].includes(this.type),searchData:(e,t)=>"score_workspace"===this.type?(0,p.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",show_all:1,types:["group","qualification"],term:e.term,id:e.ids||""}},t):"score_assignment"===this.type?(0,p.SC)("assignment/search_owned",{data:{type:["lesson","task","master"],managerun:0,term:e.term,id:e.ids,show_all:1}},t):"action_enroll"===this.type?(0,p.SC)("groups/autocomplete",{method:"POST",json:!0,data:{req:"AutoComplete",show_all:1,course:1,types:["Group","Course_template"],term:e.term,id:e.ids||""}},t):void 0},{type:"multiple_items",name:"badge_conditions[ids]",label:lng("select content"),insert:["action_view_content"].includes(this.type),searchData:(e,t)=>{if("action_view_content"===this.type)return(0,p.SC)("assignment/search_owned",{data:{type:["catalog"],managerun:0,term:e.term,id:e.ids,show_all:1}},t)}},{type:"number",name:"badge_conditions[req_score]",label:lng("required score"),insert:["score_assignment","score_workspace"].includes(this.type),required:!0},{type:"number",name:"badge_conditions[amount]",label:lng("amount"),insert:["social_like","social_comment","social_discussion","social_join_challenge","points"].includes(this.type),required:!0},{type:"section",title:lng("reward|noun"),fields:[{type:"number",name:"points",label:lng("points"),min:1,max:100,required:!0,value:1}]}]},{type:"section",sid:"timing",title:lng("timing"),fields:[{type:"select",name:"badge_time_frame",label:lng("time frame"),options:i,onValueChange:e=>this.updateValue(""===e||0===e?null:moment().add(e,"weeks").format(Blsm.prm.date_moment_format),"badge_due_date")},{type:"date",name:"badge_due_date",label:lng("current due date")},{type:"checkbox",name:"badge_repeat",label:lng("repeat each time after due date"),visible:e=>e.get("badge_due_date")&&0!==e.get("badge_time_frame")}]},{type:"section",sid:"customNotifications",title:lng("notifications"),fields:[{type:"component",name:"notifications",Render:h.oS,props:{notificationsTypes:e,options:t,objectId:this._id,form:"challenge_due_date"}},{type:"component",name:"notifications",Render:h.oQ,props:{notificationsTypes:e,options:t}}]},{type:"section",sid:"access",sectionWidth:"700px",title:lng("access|noun"),fields:[{type:"set",fields:[{type:"row_set",fields:[{type:"component",Render:b.R9,label:lng("user access").caps()},{type:"radioset",name:"badge_access",value:"auto",inline:!0,onValueChange:e=>"self"===e&&this.values.set("badge_notify",null).set("badge_notify_custom",null),options:[{val:"auto",label:lng("automatic")},{val:"self",label:lng("users join independently")}]}]}]},{type:"component",name:"badge_enrollment_rules",Render:u._,props:{object_type:"users",checkRules:!0,checkRulesData:{object_id:this._id,req_type:"badge_enrollment_rules",domain_id:this.domain_id}}},{type:"checkbox",name:"badge_archived",label:lng("archive|verb")},{type:"checkbox",name:"badge_notify",label:lng("send notification"),visible:()=>"auto"===this.values.get("badge_access"),onValueChange:()=>this.values.set("badge_notify_custom",null)},{type:"single_item",name:"badge_notify_custom",label:lng("send notification"),searchData:(e,t)=>(0,p.SC)("ajax/requests.php?req=SearchSystemMessages",{data:{id:e.ids,term:e.term}},t),visible:()=>this.values.get("badge_notify")&&"auto"===this.values.get("badge_access"),mod:["","ENT"],message:!0}]}],this._successButtons=[this.createMode&&{label:lng("create another").caps(),onClick:()=>this.nav(null,{reload:!0})},{label:lng("continue editing").caps(),onClick:()=>this.createMode?this.nav([_,this._newId]):this.status=null}]}ValidateSaveResponse(e){return!!super.ValidateSaveResponse(e)&&(0,d.B5)(e.badge_id)}SaveSuccess(e){this._newId=e.badge_id}},w=n.prototype,x="preview",k=[s.computed],Z=Object.getOwnPropertyDescriptor(n.prototype,"preview"),C=n.prototype,S={},Object.keys(Z).forEach((function(e){S[e]=Z[e]})),S.enumerable=!!S.enumerable,S.configurable=!!S.configurable,("value"in S||S.initializer)&&(S.writable=!0),S=k.slice().reverse().reduce((function(e,t){return t(w,x,e)||e}),S),C&&void 0!==S.initializer&&(S.value=S.initializer?S.initializer.call(C):void 0,S.initializer=void 0),void 0===S.initializer&&(Object.defineProperty(w,x,S),S=null),n);var w,x,k,Z,C,S;const O=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[{topic:"score",type:"score_assignment",text:lng("complete the challenge by getting a certain score on an assignment").caps(),check:Blsm.isFeatureEnabled("assignments")},{topic:"score",type:"score_workspace",text:lng("complete the challenge by getting a certain score on a workspace").caps(),check:!0},{topic:"social",type:"social_like",text:lng("complete the challenge by getting likes on contents you uploaded").caps(),check:!0},{topic:"social",type:"social_comment",text:lng("complete the challenge by writing comments in discussions/assignments etc").caps(),check:!0},{topic:"social",type:"social_discussion",text:lng("complete the challenge by starting new discussions").caps(),check:!0},{topic:"social",type:"social_join_challenge",text:lng("complete the challenge by joining more challenges").caps(),check:!0},{topic:"action",type:"action_enroll",text:lng("complete the challenge by self-registering for a specific course in the catalog").caps(),check:!0},{topic:"action",type:"action_view_content",text:lng("complete the challenge by reading the contents").caps(),check:!0},{topic:"points",type:"points",text:lng("complete the challenge by earning points for completing other challenges").caps(),check:!0}];i=i.filter((e=>!!e.check&&(0===t.length||t.includes(e.type)))),i.forEach((t=>{t.typeLabel=B[t.type],t.action={edit:"challenge",params:{...e,type:t.type}}}));const n={score:{label:lng("score"),color:a.g.colors.set[1]},action:{label:lng("action"),color:a.g.colors.set[2]},social:{label:lng("social"),color:a.g.colors.set[6]},points:{label:lng("points"),color:a.g.colors.set[10]}};return{types:i,topics:n,title:lng("create challenge")}},B={score_assignment:lng("assignment score"),score_workspace:lng("workspace score"),social_like:lng("get likes"),social_comment:lng("write a comment"),social_discussion:lng("create a discussion"),social_join_challenge:lng("join a challenge"),action_enroll:lng("enroll in a course"),action_view_content:lng("view content"),points:lng("accumulate points")},T=(0,c.observer)((function(e){let{color:t,value:i,onChange:n}=e;return(0,v.tZ)("div",{style:{width:"400px",fontSize:"2em"},children:N.map((e=>(0,v.tZ)(l.JO,{icon:e,buttonLike:!0,color:e===i?"":t(),onClick:()=>n(e)},e)))})})),N="airplane,ambulance,badge,bananas,beer,bicycle,branch,bulb,bus,cake,car,cherries,chilis,clapper,fire,flag,flower,globe,good-mood,graduation,ice-crystal,juice,leaf,lifting,lightning,line-chart,love,medal,mobile-phone,money-bag,moon,old-phone,open-book,rain,rising-graph,running,shield,ski,strech,sun,swimming,target,taxi,tea-cup,traffic-light,train,tree,trophy,video-camera,wine-glasses,wrench-screw".split(",").map((e=>"badge-"+e))},6654:(e,t,i)=>{i.d(t,{S:()=>h,m:()=>b});var n,r,s=i(7073),o=i(7821),a=i(441),l=i(5560),c=i(8318),d=i(5007),p=i(5944);function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const m="courses_management",g=(e,t)=>{let i="";if((0,c.B5)(t)&&e[t])for(let n=0;n<e[t].length;n++)i+=e[t][n],n<e[t].length-1&&(i+="➞");return i},h=(0,l.observer)((function(e){let{value:t,sequencesDataNames:i}=e;return(0,p.tZ)("div",{children:g(i,t)})}));let b=(n=o.action.bound,r=class e extends s.Z{static matchForm(t,i){let{nav:n}=i;const[r,...s]=t;if(r===m)return new e({route:s,nav:n})}constructor(e){let{route:t,nav:i}=e;super({route:t,nav:i}),u(this,"registrationPeriodList",[]),(0,o.makeObservable)(this),this.registrationPeriodList=[["",lng("none").caps()],["quarter",lng("quarter").caps()],["year",lng("year").caps()]],this.saveUrl="groups/managecourse",this.fetchUrl="groups/managecourse",this.fetch()}_acceptDataFromServer(e){this.title=lng("courses management").caps(),this.successMessage=lng("configuration saved"),this.buildFields(e),this._prepFields(e),this.ready=!0}buildFields(e){const t=e.sequences_data.names;this._fields=[{type:"section",sid:"general",title:lng("course default registration dates").caps(),fields:[{type:"date",name:"default_reg_start",label:lng("from date")},{type:"date",name:"default_reg_end",label:lng("to date")}]},Blsm.isFeatureEnabled("course_registartion")&&{type:"section",sid:"catalog_settings",title:lng("catalog page settings"),fields:[{type:"img",name:"catalog_page_poster",value:e.catalog_page_poster,removeButton:!0},{type:"checkbox",name:"random_order",label:lng("courses will appear in a random order").caps()},{type:"checkbox",name:"disable_req_text",label:lng("disable request text").caps()},{type:"select",name:"registration_period",label:lng("set registration period"),options:this.registrationPeriodList}]},{type:"section",sid:"authorize_groups_courses",title:lng("authorize groups and courses"),fields:[{type:"select",name:"authorize_group_seq",label:lng("approval sequence"),options:e.sequences_data.options,emptyOption:lng("none")},{type:"component",name:"authorize_group_seq",Render:h,props:{sequencesDataNames:t}}]}],this._successButtons=[{label:lng("continue editing").caps(),onClick:()=>this.createMode?this.nav([m,this._newId]):this.status=null},{label:lng("back to %s|back to some page",lng("courses")).caps(),onClick:()=>(0,a.p4)({list:"courses"},!0),primary:!0}]}SaveSuccess(){(0,d.vm)().invalidateStore("cregistration")}},v=r.prototype,_="SaveSuccess",f=[n],y=Object.getOwnPropertyDescriptor(r.prototype,"SaveSuccess"),w=r.prototype,x={},Object.keys(y).forEach((function(e){x[e]=y[e]})),x.enumerable=!!x.enumerable,x.configurable=!!x.configurable,("value"in x||x.initializer)&&(x.writable=!0),x=f.slice().reverse().reduce((function(e,t){return t(v,_,e)||e}),x),w&&void 0!==x.initializer&&(x.value=x.initializer?x.initializer.call(w):void 0,x.initializer=void 0),void 0===x.initializer&&(Object.defineProperty(v,_,x),x=null),r);var v,_,f,y,w,x},1855:(e,t,i)=>{i.d(t,{J:()=>a});var n=i(4210),r=i(8e3),s=i(8318);function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a extends n.I{constructor(e){super(e),o(this,"group_id",void 0),o(this,"group_type",void 0),this.group_id=e.data.group_id,this.group_type=e.data.group_type,this.saveAsJson=!0,this.title=lng("add owners").caps(),this.successMessage=lng("owners successfully added"),this._fields=[{type:"multiple_items",name:"users",label:lng("select users"),poster:!0,theme:"bright",required:!0,searchData:(e,t)=>{let{term:i}=e;(0,r.SC)("users/search_owners",{data:{group_type:this.group_type,cross_domain:1,term:i,exclude:this.values.get("users")||[]},method:"POST"},t)},searchDataCacheFunc:e=>(0,s.SZ)(Object.assign({ids:this.values.get("ids")||[]},e))}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("users/add_owners_to_groups",Object.assign({group_id:this.group_id},e))}}},4454:(e,t,i)=>{i.d(t,{C3:()=>h,UQ:()=>g,xI:()=>b});var n=i(4210),r=i(8e3),s=i(8318),o=i(6920),a=i(6975),l=i(8071),c=i(5560),d=i(676),p=i(9637),u=i(5944);function m(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class g extends n.I{constructor(e){var t,i,n,s;super(e),m(this,"group_id",void 0),m(this,"manager_ids",void 0),m(this,"edit_mode",void 0);const{data:o={}}=e;this.group_id=o.group_id,this.manager_ids=null!==(t=o.managers)&&void 0!==t&&t.length?null===(i=o.managers)||void 0===i?void 0:i.map((e=>e.manager&&e.user_id)).filter((e=>e)):o.managers_ids,this.edit_mode=(null===(n=o.managers)||void 0===n?void 0:n.length)&&o.group_id,this.saveAsJson=!0;const a=b(this,{data:o});this.title=this.edit_mode?lng("edit permissions").caps():lng("add managers").caps(),this._fields=[{type:"multiple_items",name:"groups",label:lng("select workspaces"),theme:"bright",insert:!this.group_id,searchData:(e,t)=>{let{ids:i,term:n}=e;(0,r.SC)("ajax/GroupsAjax.class.php?req=AutoComplete&catalog=1&",{data:{req:"AutoComplete",catalog:1,types:"change_ou"===o.action?["Ou"]:["Group","Qualification","Workplan"],term:n||"",id:i||""}},t)}},{type:"multiple_items",name:"users",label:this.group_id?lng("select new managers"):lng("selected users"),poster:!0,theme:"bright",readOnly:!this.group_id||this.edit_mode,insert:!this.edit_mode,searchData:(e,t)=>{let{term:i,ids:n}=e;(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:i,id:n||""}},t)}},{type:"checkbox",name:"main_manager",label:lng("primary manager").caps(),visible:()=>{var e,t;return 1===(null===(e=this.values.get("users"))||void 0===e?void 0:e.length)||1===(null===(t=this.manager_ids)||void 0===t?void 0:t.length)}},...a];let l={users:this.manager_ids};1===(null===(s=o.managers)||void 0===s?void 0:s.length)&&(l={...o.managers[0]}),this._prepFields(l),this.ready=!0}save(e){this.edit_mode?this.saveToUrl("users/set_manager_permissions",Object.assign({group_id:this.group_id,users:this.manager_ids},e)):(this.group_id&&(e.groups=Array.isArray(this.group_id)?this.group_id:[this.group_id]),this.saveToUrl("users/add_managers_to_groups",e))}}class h extends n.I{constructor(e){super(e),m(this,"group_id",void 0);const{data:t={}}=e;this.group_id=t.group_id,this.title=lng("add role members").caps(),this.saveAsJson=!0,this._fields=[{type:"multiple_items",name:"users",label:lng("select users"),poster:!0,theme:"bright",searchData:(e,t)=>{let{term:i,ids:n}=e;(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:i,id:n||""}},t)}}];let i={users:this.manager_ids};this._prepFields(i),this.ready=!0}save(e){this.group_id&&(e.groups=Array.isArray(this.group_id)?this.group_id:[this.group_id]),this.saveToUrl("users/add_managers_to_groups",e)}}const b=(e,t)=>{var i;let{data:n,initialValue:r={},prefix:c="",permissionSelectFieldName:d="mpt_id",preview:p=!1}=t;const m=[{optgroup:!0,label:lng("custom").caps(),options:[{val:"none",label:lng("none").caps()},{val:"all",label:lng("all").caps()}]}],g=new Map((null===(i=n.manager_permission_types)||void 0===i?void 0:i.map((e=>[e.id,e])))||[]);if(n.manager_permission_types){const e=n.manager_permission_types.map((e=>({val:e.id,label:e.name})));m.push({optgroup:!0,label:lng("manager type").caps(),options:e})}const h=e=>(0,s.B5)(e)?g.get(e)||{}:"all"===e?{perm_assignments:1,perm_meetings:1,perm_content:1,perm_evaluation:1,perm_grades_management:1,perm_portal:1,perm_config:1}:{},b=e=>c?c+"_"+e:e,_={perm_assignments:lng("assignments"),perm_meetings:lng("meetings"),perm_content:lng("content"),perm_evaluation:lng("evaluation"),perm_grades_management:lng("grades management"),perm_portal:lng("portal"),perm_config:lng("general")},f={perm_assignments:[{val:"0",label:lng("none"),color:o.g.colors.text_placeholder},{val:"2",label:lng("set weights"),color:o.g.colors.warning},{val:"1",label:lng("create"),color:o.g.colors.dominant_main}],perm_meetings:[{val:"0",label:lng("none"),color:o.g.colors.text_placeholder},{val:"3",label:lng("set attendance"),color:o.g.colors.warning},{val:"2",label:lng("edit"),color:o.g.colors.positive},{val:"1",label:lng("create"),color:o.g.colors.dominant_main}],perm_content:[{val:"0",label:lng("none"),color:o.g.colors.text_placeholder},{val:"1",label:lng("share"),color:o.g.colors.dominant_main}],perm_evaluation:[{val:"0",label:lng("none"),color:o.g.colors.text_placeholder},{val:"1",label:lng("view"),color:o.g.colors.dominant_main}],perm_grades_management:[{val:"0",label:lng("none"),color:o.g.colors.text_placeholder},{val:"1",label:lng("create"),color:o.g.colors.dominant_main}],perm_portal:[{val:"0",label:lng("none"),color:o.g.colors.text_placeholder},{val:"1",label:lng("create"),color:o.g.colors.dominant_main}],perm_config:[{val:"0",label:lng("none"),color:o.g.colors.text_placeholder},{val:"1",label:lng("configure"),color:o.g.colors.dominant_main}]},y={perm_config:(0,u.tZ)(a.JO,{icon:"menu_info",toolTip:(0,l.u)()})};return(0,s.B5)(r)&&(r=h(r)),[{type:"select",name:d,label:lng("permission type")+" - "+lng("autoenrolled managers"),options:m,onValueChange:t=>{const i=h(t);e.updateValue(i.perm_assignments||"0",b("perm_assignments")),e.updateValue(i.perm_meetings||"0",b("perm_meetings")),e.updateValue(i.perm_content||"0",b("perm_content")),e.updateValue(i.perm_grades_management||"0",b("perm_grades_management")),e.updateValue(i.perm_config||"0",b("perm_config")),e.updateValue(i.perm_portal||"0",b("perm_portal")),Blsm.isFeatureEnabled("evaluation")&&e.updateValue(i.perm_evaluation||"0",b("perm_evaluation"))}},p?{type:"component",Render:v,props:{getPermissions:()=>h(e.values.get(d))}}:{type:"section",title:lng("permissions preview"),titleSmall:!0,fields:Object.keys(f).map((t=>y[t]?{type:"row_set",fields:[{type:"switcher",name:b(t),value:r[t]||"0",label:_[t],options:f[t],onValueChange:()=>e.updateValue("none","mpt_id")},{type:"component",node:y[t]}]}:{type:"switcher",name:b(t),value:r[t]||"0",label:_[t],options:f[t],onValueChange:()=>e.updateValue("none","mpt_id")}))}]},v=(0,c.observer)((e=>{let{getPermissions:t}=e;const i=t(),n=[{title:lng("permission type preview")},{}],r=[{label:lng("create assignments").caps(),val:"1"==i.perm_assignments},{label:lng("set assignments weights").caps(),val:i.perm_assignments>0},{label:lng("create meetings").caps(),val:"1"==i.perm_meetings},{label:lng("edit meetings").caps(),val:"1"==i.perm_meetings||"2"==i.perm_meetings},{label:lng("set meetings attendance").caps(),val:i.perm_meetings>0},{label:lng("share content").caps(),val:i.perm_content>0},Blsm.isFeatureEnabled("evaluation")&&{label:lng("view evaluations").caps(),val:i.perm_evaluation>0},{label:lng("grades management").caps(),val:i.perm_grades_management>0},{label:lng("create portal").caps(),val:i.perm_portal>0},{label:lng("general").caps(),val:i.perm_config,tooltip:(0,l.u)()}];return(0,u.tZ)(d.iA,{cols:n,collection:r,RowRenderer:_,compact:!0})})),_=(0,c.observer)((e=>{let{row:{label:t,val:i,tooltip:n}}=e;return(0,u.BX)("tr",{className:"_disable_hover",children:[(0,u.BX)(p.U6,{children:[t," ",n&&(0,u.tZ)(a.JO,{icon:"menu_info",color:o.g.colors.text_placeholder,toolTip:n})]}),(0,u.tZ)("td",{children:i&&(0,u.tZ)(a.JO,{icon:"mark_v_strong"})})]})}))},1010:(e,t,i)=>{i.d(t,{l:()=>o});var n=i(4210),r=i(8e3),s=i(8318);class o extends n.I{constructor(e){var t;super(e);const{data:i={}}=e;this.group_id=i.group_id,this.title=this.group_id?lng("add members").caps():"change_ou"===i.action?lng("change users org unit").caps():lng("add selected users to workspace"),this._fields=[{type:"change_ou"===i.action?"single_item":"multiple_items",name:"groups",label:"change_ou"===i.action?lng("select org unit"):lng("select workspaces"),theme:"bright",insert:!this.group_id&&i.action,searchData:(e,t)=>{let{ids:n,term:s}=e;(0,r.SC)("ajax/GroupsAjax.class.php?req=AutoComplete&catalog=1&",{data:{req:"AutoComplete",catalog:1,types:"change_ou"===i.action?["Ou"]:["Group","Qualification","Workplan"],term:s||"",id:n||""}},t)}},{type:"multiple_items",name:"users",label:i.action?lng("selected users"):lng("select new members"),poster:!0,theme:"bright",readOnly:i.action,searchData:(e,t)=>{let{ids:i,term:n}=e;(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:n||"",id:i||"",ou:1,job:1}},t)}},{type:"checkbox",name:"send_joining_notification",label:lng('send "joined workspace" notification'),insert:this.group_id},{type:"checkbox",name:"start_sequence",label:lng("start approval sequence"),insert:(0,s.B5)(i.sequence_id)},{type:"checkbox",name:"add_to_sub_qualifications",label:lng("add users to the required qualifications"),insert:"Qualification"===i.group_type},{type:"checkbox",name:"add_users_to_courses",label:lng("add users to courses and template instances"),value:null===(t=i.owner_options)||void 0===t?void 0:t.add_users_to_courses,insert:"Qualification"===i.group_type,helpKey:"@add_member/add_users_to_courses"},{type:"checkbox",name:"ignore_workspace_restrictions",label:lng("ignore workspace restrictions"),insert:i.is_owner}],this._prepFields(i),this.ready=!0}save(e){this.saveToUrl("users/add_users_to_groups",Object.assign({groups:[this.group_id]},e))}}},8904:(e,t,i)=>{i.d(t,{q:()=>a});var n=i(4210),r=i(5007),s=i(9431);function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a extends n.I{constructor(e){super(e),o(this,"portalInfo",void 0),this.portalInfo=e.newPortalInfo,this.portalInfo.portal_active=this.portalInfo.portal_active?1:0,this.addPortalCallback=e.addPortalCallback;const t=(null==e?void 0:e.allowAnonymous)||!1;switch(this.portalInfo.portal_type){case s.Bu.APP:this.title=lng("create app page");break;case s.Bu.SUB:this.title=lng("create sub page");break;case s.Bu.DOMAIN:this.title=lng("create portal");break;case s.Bu.GROUP:this.title=lng("create portal for %s",this.portalInfo.portal_title);break;default:this.title=lng("create portal").caps()}this._fields=[{type:"hidden",name:"portal_type"},{type:"hidden",name:"parent_id"},{type:"hidden",name:"portal_active"},{type:"hidden",name:"group_id"},{type:"text",name:"portal_title",label:lng("name"),required:!0,maxLength:500},{type:"row_set",insert:t,fields:[{type:"checkbox",name:"toggle_anonymous",label:s.rc[s.Bu.ANONYMOUS],onValueChange:e=>this.updateValue(e?s.Bu.ANONYMOUS:this.portalInfo.portal_type,"portal_type"),value:this.portalInfo.portal_type===s.Bu.ANONYMOUS}]}],this._prepFields(this.portalInfo),this.ready=!0}save(e){delete e.toggle_anonymous,this.saveToUrl("portal/portal",Object.assign(e))}SaveSuccess(e){var t;(0,r.vm)().closeDialog(),null!=e&&e.portal_id&&(null===(t=this.addPortalCallback)||void 0===t||t.call(this,e,null==e?void 0:e.portal_id))}}},5761:(e,t,i)=>{i.d(t,{ty:()=>g,xY:()=>x});var n=i(4210),r=i(8e3),s=i(7821),o=i(5560),a=i(917),l=i(7363),c=i(6975),d=i(6920),p=i(5007),u=i(7137),m=(i(7882),i(5944));class g extends n.I{constructor(e){super(e),(0,s.makeObservable)(this),this.boarding=e.boarding,this.cancelText=!!this.boarding&&lng("maybe next time"),this.onSave=e.onSave,this.userStore=e.store,this.buildFields(e)}buildFields(e){let{user_id:t}=e;this._fields=[{type:"section",titleSmall:!0,title:lng("what skills you own or interests you?"),sid:"basic",fields:[{type:"multiple_items",name:"skills",label:lng("select skill"),showId:!1,valueIsMap:!0,objectKeys:["id","label","skill_level"],required:!0,searchData:(e,t)=>{(0,r.SC)("skills/autocomplete_skill",{data:{term:e.term||"",id:e.ids||"",exclude_owned:Blsm.user.id}},t)}}]},{type:"section",sid:"advanced",titleSmall:!0,title:lng("what is your level?"),fields:[{type:"component",name:"skills",Render:b},{type:"hidden",name:"user_id",value:t}]}],this.boarding&&(this._fields.unshift({type:"section",sid:"onBoardingFirst",fields:[{type:"component",node:(0,m.tZ)(v,{})}]}),this._fields.push({type:"section",sid:"onBoardingLast",fields:[{type:"component",node:(0,m.tZ)(_,{})}]})),this._prepFields({skills:this.skills}),this.ready=!0}save(e){Blsm.InitialData.skills_exist=!0,this.onSave(e,(()=>(0,p.vm)().closeDialog()))}}const h={name:"1bsvh0g",styles:"width:100%;>div{width:100%;display:flex;justify-content:space-between;margin:20px 0;.name{font-weight:600;display:flex;align-items:center;width:34%;}.skills{display:flex;justify-content:space-evenly;width:65%;}}"},b=(0,o.observer)((function(e){let{value:t,onChange:i}=e;const n=t||new Map;return(0,m.tZ)("div",{css:h,children:Array.from(n.values()).map((e=>(0,m.tZ)(y,{skill:e,onChange:()=>i(n)},e.id)))})})),v=()=>(0,m.BX)("div",{css:f,children:[(0,m.tZ)("div",{className:"onboarding-header",children:(0,m.tZ)("img",{src:`${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/astronaut.svg`,alt:""})}),(0,m.BX)("div",{className:"bottom",children:[(0,m.tZ)("h1",{children:lng("meet your skills").caps()}),(0,m.tZ)("span",{children:lng("introducing new experience learning like never before").caps()})]})]}),_=()=>(0,m.BX)("div",{css:f,children:[(0,m.tZ)("div",{className:"onboarding-header",children:(0,m.tZ)("img",{src:`${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/group.svg`,alt:""})}),(0,m.BX)("div",{className:"bottom",children:[(0,m.BX)("h1",{children:[lng("great job!").caps()," ",lng("you have completed the onboarding process").caps()]}),(0,m.tZ)("span",{children:lng("we highly recommend you to set your weekly goals").caps()})]})]}),f={name:"8xk9cc",styles:">.onboarding-header{img{width:650px;}}.bottom{text-align:center;>h1{font-size:3rem;font-weight:600;}>span{font-size:1.4rem;}}"},y=(0,o.observer)((function(e){let{skill:t,onChange:i}=e;const[n,r]=(0,l.useState)(t.skill_level||0),s=[1,2,3].map((e=>(0,u.r0)(e))),o=e=>{r(e),t.skill_level=e,i(t)};return(0,m.BX)("div",{children:[(0,m.tZ)("div",{className:"name",children:t.label}),(0,m.tZ)("div",{className:"skills",children:s.map((e=>(0,m.tZ)("div",{children:(0,m.tZ)(x,{skillTag:e,selected:e.val===n,onSelect:o})},e.val)))})]},t.id)})),w=e=>(0,a.iv)("border:1px solid ",d.g.colors.text_sec,";padding:5px 10px;border-radius:15px;&:hover{cursor:pointer;}&.active{border:1px solid ",e,";background:",e,";color:white;}",""),x=e=>{let{skillTag:t,selected:i,onSelect:n}=e;const{val:r,label:s,color:o,icon:a}=t;return(0,m.BX)("div",{css:w(o),onClick:()=>n(r),className:i?"active":"",children:[(0,m.tZ)(c.JO,{icon:a}),"  ",s]})}},1750:(e,t,i)=>{i.d(t,{L:()=>h});var n=i(4210),r=i(7821),s=i(8e3),o=i(5560),a=i(7363),l=i(917),c=i(6975),d=i(5007),p=i(6920),u=i(8318),m=i(7659),g=i(5944);class h extends n.I{constructor(e){super(e),(0,r.makeObservable)(this),this.values.set("new",!1),this.item=e.item,this.excludes=[],this.title=lng("add to").caps(),this.list=[],this.confirmButtonLabel=lng("add to playlist"),this.onItemSelect=e=>{const t=this.values.get("ids");if(t){const i=t.find((t=>t===e));return this.values.set("ids",i?t.filter((t=>t!==e)):[e,...t])}return this.values.set("ids",[e])},this.changeView=e=>{this.values.set("new",!e),this.title=!1===e?lng("add to").caps():lng("create new playlist").caps()},this.fetch()}fetch(){(0,s.SC)("channel/list_playlists",{data:{new:!0,item:this.item}},(e=>{this.list=e,e.forEach((e=>this.excludes.push(e.playlist_id))),this.buildFields()}))}buildFields(){const e=(0,l.iv)("margin-top:-1rem;width:100%;height:50px;display:flex;justify-content:start;align-items:center;border-left:0;border-right:0;border-top:1px solid ",p.g.colors.separator,";color:",p.g.colors.text_sec,";.Icon{",p.g.classes.margin_far("10px"),";color:",p.g.colors.dominant_main,";font-size:1.3rem;}&:hover{cursor:pointer;}","");this._fields=[{type:"hidden",value:this.item,name:"item_to_add"},{type:"multiple_items",name:"playlist_id",label:lng("search playlists"),theme:"bright",objectKeys:["playlist_id","playlist_name","channel_id"],buttons:[{Render:_}],searchData:(e,t)=>{const i=(this.values.get("ids")||[]).concat(this.excludes);(0,s.SC)("channel/autocomplete_playlist",{data:{term:e.term||"",id:e.ids||"",exclude:i,exclude_item:this.item,active:!0}},t)}},{type:"component",name:"ids",Render:b,props:{items:this.list,onSelect:e=>this.onItemSelect(e)}},{type:"component",node:(0,g.BX)("div",{css:e,onClick:()=>this.changeView(this.values.get("new")),children:[(0,g.tZ)(c.JO,{icon:"mark_plus"})," ",lng("create new playlist").caps()]}),visible:()=>!1===this.values.get("new")},{type:"text",name:"playlist_name",label:lng("new playlist name"),visible:()=>!0===this.values.get("new")}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("channel/add_to_playlist",e)}SaveSuccess(e){var t;const{ids:i,item:n}=e,r=new m.m(n),s=(0,d.vm)().getStore("user",Blsm.user.user_id);null!=s&&null!==(t=s.channelStore)&&void 0!==t&&t._playlists&&i.forEach((e=>{var t;const i=s.channelStore._playlists.find((t=>parseInt(t.id)===parseInt(e)));null==i||null===(t=i.items)||void 0===t||t.push(r)})),(0,d.vm)().closeDialog()}}const b=(0,o.observer)((function(e){let{items:t,onSelect:i}=e;return(0,g.BX)("div",{css:v,children:[(0,g.BX)("div",{className:"title",children:[lng("recent playlists").caps(),":"]}),(0,g.tZ)("div",{className:"playlist-items",children:t.map((e=>(0,g.tZ)(_,{checkbox:!0,onSelect:i,item:e},e.playlist_id)))})]})})),v=(0,l.iv)("padding:10px 0 0;.playlist-items{margin:5px;.playlist-item{text-align:center;display:flex;justify-content:space-between;padding:10px;margin:5px 0;border-radius:10px;border:1px solid transparent;&.selected,&:hover{background-color:",p.g.colors.dominant_main_shade,";color:",p.g.colors.dominant_main,";cursor:pointer;}}}",""),_=(0,o.observer)((function(e){let{item:t,onSelect:i}=e;const[n,r]=(0,a.useState)(!1),s=t.playlist_id||t.id;return(0,g.tZ)("div",{className:(0,u.AK)("playlist-item",{selected:n}),onClick:()=>(i(s),r(!n)),children:t.playlist_name})}))},3718:(e,t,i)=>{i.d(t,{Q:()=>w,_:()=>f});var n=i(4210),r=i(6920),s=i(5898),o=i(6975),a=i(1619),l=i(2334),c=i(8318),d=i(8e3),p=i(9180),u=i(5946),m=i(5519),g=i(9305),h=i(8337),b=i(9793),v=i(5944);function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class f extends n.I{constructor(e){var t,i,n,f,x,k,Z,C,S,O,B,T,N,I,D;switch(super(e),_(this,"action",""),_(this,"approval_request",[]),_(this,"decisionsFields",[]),_(this,"validateOnChange",!0),this.action=e.action,this.approval_request=e.approval_request,this.action){case"approve":this.title=lng("approve request").caps(),this.confirmButtonLabel=(0,v.BX)("span",{children:[(0,v.tZ)(o.JO,{icon:"like"})," ",lng("approve").caps()]}),this.setDecisionFields();break;case"reject":this.title=lng("reject request").caps(),this.confirmButtonLabel=(0,v.BX)("span",{children:[(0,v.tZ)(o.JO,{icon:"dislike"})," ",lng("reject").caps()]});break;case"back":this.title=lng("return request to previous approver").caps(),this.confirmButtonLabel=lng("return to previous").caps();break;case"waiting_list":this.title=lng("waiting list").caps(),this.confirmButtonLabel=lng("add to waiting list").caps();break;case"cancel_decision":this.title=lng("cancel decision").caps(),this.confirmButtonLabel=lng("cancel decision").caps()}["approve","reject"].includes(this.action)&&this.approval_request.summary_exists&&(this.headExtra=(0,v.tZ)(b.b,{children:(0,v.tZ)(h.Tt,{groupId:this.approval_request.group_id})}));let j=[];var P;this.approval_request.scoring_criteria&&(null===(P=this.approval_request.scoring_criteria.criterias)||void 0===P||P.map(((e,t)=>{let i=this.approval_request.scoring_criteria.rows[t]-1,n=0;this.approval_request.scoring_criteria.rows.map((e=>n+=e-1)),j.push({type:"range",name:`scoring_criteria[${t}]`,label:e,max:i,onValueChange:()=>this.setScore()})})));const z=this.approval_request.target_data||{},E=this.approval_request.sequence_user_options||{},R=!this.approval_request.sequence_id||!(null==E||!E.allow_file_upload),F=["RegExt","RegExtMgr"].includes(this.approval_request.type),M="RegExtMgr"===this.approval_request.type,A="Reg"===this.approval_request.type,q=F&&!!E.weekly_hours,X=F&&!!E.decide_supplier,L=F&&!!E.decide_importance,$=F&&!!this.approval_request.decide_funding,V=F&&!!E.decide_name,U=A&&"reg_to_template"===this.approval_request.registration_type&&!!this.approval_request.can_choose_template_instance,H=F&&!!E.decide_hours,J=F&&!!E.time_commitment,G=M&&!!E.decide_participants;this.decideParticipants=G;const W=null===(t=this.approval_request.instances)||void 0===t?void 0:t.map((e=>({key:e.group_id,id:e.group_id,label:e.group_name+(e.group_open_date?" - "+(0,l.GG)(e.group_open_date,{time:!1}):"")}))),K="text",Y=e=>(0,c.mE)(e,{min:0}),Q=F?[{type:K,name:"target_data[paid_leave]",label:lng("paid leave days").caps(),value:null!==(i=z.paid_leave)&&void 0!==i?i:z.r_paid_leave,validate:Y},{type:K,name:"target_data[price]",label:lng("tuition").caps(),value:null!==(n=z.price)&&void 0!==n?n:z.r_price,validate:Y},{type:K,name:"target_data[travel]",label:lng("travel price").caps(),value:null!==(f=z.travel)&&void 0!==f?f:z.r_travel,validate:Y},{type:K,name:"target_data[expenses]",label:lng("expenses").caps(),value:null!==(x=z.expenses)&&void 0!==x?x:z.r_expenses,validate:Y},{type:K,name:"target_data[funding]",label:lng("total funding").caps(),value:null!==(k=z.funding)&&void 0!==k?k:z.r_funding,validate:Y}]:[],ee=(new Date).getFullYear(),te=(0,l._3)(`${ee}-01-01`).format(Blsm.prm.date_moment_format),ie=(0,l._3)(`${ee}-12-31`).format(Blsm.prm.date_moment_format);this._fields=[{type:"component",node:(0,v.tZ)((()=>{let e=`${lng("member limit reached").caps()} ( ${this.approval_request.users_in_group} / ${this.approval_request.max_users})`;return(0,v.tZ)("div",{children:(0,v.tZ)(s.jC,{color:r.g.colors.warning,children:e})})}),{}),visible:()=>this.approval_request.max_users&&parseInt(this.approval_request.users_in_group)>=parseInt(this.approval_request.max_users)},{type:"component",node:(0,v.tZ)((()=>{const e=this.approval_request.custom_messages.added_to_approve_dialog;return(0,v.BX)(v.HY,{children:[e.title&&(0,v.tZ)(u.D,{large:!0,children:e.title}),e.h1&&(0,v.tZ)(u.D,{children:e.h1}),e.h2&&(0,v.tZ)(u.D,{children:e.h2}),e.message&&(0,v.tZ)(a.xn,{content:e.message}),(0,v.tZ)("hr",{})]})}),{}),visible:()=>{var e,t,i;return null===(e=this.approval_request)||void 0===e||null===(t=e.custom_messages)||void 0===t||null===(i=t.added_to_approve_dialog)||void 0===i?void 0:i.message}},{type:"component",node:(0,v.tZ)((()=>{const e=this.approval_request.target_data||{};return(0,v.BX)("div",{children:[(0,v.BX)("div",{children:[(0,v.BX)("span",{className:"title",children:[lng("name").caps(),": "]}),e.ext_course_name||this.approval_request.group_name]}),this.approval_request.group_description&&(0,v.BX)("div",{children:[(0,v.BX)("span",{className:"title",children:[lng("group description").caps(),": "]})," ",(0,v.tZ)(a.xn,{content:this.approval_request.group_description})]}),e.group_open_date&&(0,v.BX)("div",{children:[(0,v.BX)("span",{className:"title",children:[lng("dates").caps(),": "]}),(0,v.tZ)(p.qm,{dateNote:{start:e.group_open_date,end:e.group_close_date}})]}),this.approval_request.description&&(0,v.BX)("div",{children:[(0,v.BX)("span",{className:"title",children:[lng("step description").caps(),": "]})," ",(0,v.tZ)(a.xn,{content:this.approval_request.description})]})]})}),{})},{type:"component",node:(0,v.BX)("div",{children:[lng("estimated cost for member").caps()," : ",this.approval_request.estimated_cost_for_member_currency," ",(0,v.tZ)(o.JO,{icon:"report",href:{report:"RegisterCostForOu",params:{range:"dates",from:te,to:ie,group:this.approval_request.origin_group||this.approval_request.group_id}}})]}),insert:this.approval_request.estimated_cost_for_member>0},{type:"textarea",name:"approver_text",label:lng("explanation and additional information").caps(),required:!!E[{approve:"require_info_approval",reject:"require_info_rejection",back:"require_info_back"}[this.action]]},{type:"text",name:"target_data[ext_course_name]",label:lng("event name"),value:null===(Z=this.approval_request)||void 0===Z||null===(C=Z.target_data)||void 0===C?void 0:C.ext_course_name,insert:V},{type:"select",name:"target_data[importance]",label:lng("degree of importance"),insert:L||!!z.importance,value:z.importance,emptyOption:!0,options:(0,c.wd)(w),readOnly:!L},{type:"single_item",name:"target_data[supplier_id]",label:lng("organizing institution"),insert:X||!!z.supplier_id,value:z.supplier_id,readOnly:!X,searchData:(e,t)=>{let{term:i,ids:n}=e;(0,d.SC)("suppliers/autocomplete",{data:{term:i,id:n,limit:20,type:"RegExt"}},t)}},{type:"component",Render:m.R9,label:`${lng("requested").caps()}: ${z.r_institution}`,insert:X&&!!z.r_institution},{type:"number",name:"score",label:lng("set score").caps(),insert:!!this.approval_request.can_edit_grade,disable:j.length>0,required:!(j.length>0)},{type:"section",fields:j,insert:this.approval_request.scoring_criteria},{type:"single_item",name:"wanted_instance",label:lng("select course instance"),insert:W&&U,required:!0,value:z.wanted_instance,searchData:(e,t)=>{let{term:i,ids:n}=e;return t(W.filter((e=>i?e.label.includes(i)||e.id==i:!n||n.includes(e.id))))}},{type:"number",name:"time_commitment",label:lng("set time commitment").caps(),value:null===(S=this.approval_request)||void 0===S||null===(O=S.target_data)||void 0===O?void 0:O.time_commitment,unit:lng("months").caps(),insert:J},{type:"number",name:"target_data[weekly_hours]",label:lng("set weekly hours").caps(),value:null===(B=this.approval_request)||void 0===B||null===(T=B.target_data)||void 0===T?void 0:T.weekly_hours,insert:q},{type:"file",name:"file",label:lng("attach a file"),insert:R},{type:"date",name:"submissionDate",label:lng("edit submission date"),insert:!(null===(N=this.approval_request)||void 0===N||!N.edit_submission_date)},{type:K,name:"target_data[hours]",label:lng("academic hours"),insert:H,value:null!==(I=z.hours)&&void 0!==I?I:z.r_hours,emptyOption:!0,readOnly:!H,validate:Y},{type:K,name:"target_data[days_off]",label:lng("days off").caps(),value:null!==(D=z.days_off)&&void 0!==D?D:z.r_days_off,insert:$,validate:Y},{type:"section",fields:Q,title:lng("funding"),titleSmall:!0,insert:$},{type:"section",fields:this.decisionsFields,insert:this.decisionsFields.length>0},{type:"password",name:"password",label:lng("enter your password to confirm").caps(),insert:!!E.password_required,required:!0},{type:"component",node:(0,v.tZ)(y,{action:this.action,approval_request:this.approval_request})}],M&&(this._fields.push({type:"title",label:lng("participants")}),this._fields.push(...(0,g.TP)({approvalRequest:this.approval_request,form:this,allowParticipantsApproval:G&&"approve"===this.action,allowParticipantsEdit:G}))),this._prepFields(),this.ready=!0}setScore(){let e=0,t=0;this.approval_request.scoring_criteria.rows.map(((i,n)=>{let r=this.values.get(`scoring_criteria[${n}]`);r&&(t+=r),e+=i-1})),this.values.set("score",Math.round(100*t/e))}setDecisionFields(){var e,t;const i=null===(e=this.approval_request.sequence_user_options)||void 0===e?void 0:e.decision_options;let n=this.approval_request.next_approver.approver_options?lng("please choose below"):this.approval_request.next_approver.approver_name,r=null!==(t=this.approval_request.next_approver)&&void 0!==t&&t.approver_id?`${lng("go to next approver").caps()} - ${n}`:lng("finish sequence").caps(),s={type:"radio",name:"decision",radioValue:"default",value:"default",label:`${lng("default").caps()}: ${r}`},o=[];if(i&&i["default-decision"]&&o.push(s),null!=i&&i.decisions)for(const[e]of Object.entries(i.decisions)){var a,l,c,d;const t=null!==(a=i.decisions[e])&&void 0!==a&&null!==(l=a.approver)&&void 0!==l&&l.approver_name?`(${null===(c=i.decisions[e])||void 0===c||null===(d=c.approver)||void 0===d?void 0:d.approver_name})`:"";o.push({type:"radio",name:"decision",radioValue:i.decisions[e].target,label:`${i.decisions[e].label} ${t}`})}if(o.length>1)this.decisionsFields=o;else{var p,u;let e=1===o.length?o[0]:s;this.decisionsFields.push({type:"component",node:(0,v.tZ)("div",{children:e.label}),name:"decision",value:e.checkboxValue}),this.decisionsFields.push({type:"select",name:"chosen_approver_id",insert:!(null===(p=this.approval_request.next_approver)||void 0===p||!p.approver_options),options:null===(u=this.approval_request.next_approver)||void 0===u?void 0:u.approver_options,value:this.approval_request.next_approver.approver_id,label:lng("you may choose the approver").caps()})}}save(e){const t=Object.assign({action:this.action,request_id:this.approval_request.request_id},e);delete t.participants_ids,this.decideParticipants||delete t.participants,this.saveToUrl("approval",t)}}const y=e=>{let{action:t,approval_request:i}=e,n="";return"Reg"!==i.type&&"RegExt"!==i.type||"back"===t||"cancel_decision"===t||(n=i.auto_approval_date>0?lng("you can change your decision later").caps():lng("your decision here is final").caps()),n&&(0,v.tZ)(s.jC,{color:r.g.colors.warning,children:n})},w=[[1,"1 - "+lng("low")],[2,"2"],[3,"3"],[4,"4"],[5,"5 - "+lng("high")]]},6945:(e,t,i)=>{i.d(t,{T:()=>c});var n=i(4210),r=i(8e3),s=i(8318),o=i(5560),a=i(5944);function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class c extends n.I{constructor(e){super(e),l(this,"bookmarkId",void 0),l(this,"activeReport",void 0),l(this,"parameters",void 0),this.bookmarkId=e.bookmarkId||this.bookmarkId,this.activeReport=e.activeReport||this.activeReport,this.parameters=e.parameters||this.parameters,this.title=lng("bookmark report").caps(),this.successMessage=lng("bookmark saved"),this.saveUrl=this.bookmarkId?"reports/action/save_bookmark_name":"reports/action/bookmark",this.bookmarkId?(0,r.SC)("reports/action/edit_bookmark_name",{data:{bm_id:this.bookmarkId},method:"POST"},(e=>{const t=JSON.parse(e.widget_options),i="all"!==e.share_mode?{recommended_dashboard_target:e.share_mode,["target_"+e.share_mode]:e.share_to}:{};this.initialValues={bookmark_id:e.bookmark_id,bookmark_name:e.bookmark_name,bookmark_desc:e.bookmark_description,personal_dashboard:e.widget_order,share_with_all:e.share_with_all,widget_size:t.widget_size,widget_view:t.widget_view,share_report_extra_fields:!!e.share_report_extra_fields,tags:e.tags,...i},this.getMetadata()})):this.getMetadata()}getMetadata(){(0,r.SC)("bookmarks/report_bookmark_metadata",{method:"POST",data:{report_name:this.activeReport,parameters:this.parameters}},(e=>{var t,i,n;null==e||null===(t=e.metadata)||void 0===t||null===(i=t.size)||void 0===i||null===(n=i.forEach)||void 0===n||n.call(i,(e=>e.val=e.value)),this.buildFields(null==e?void 0:e.metadata.size,null==e?void 0:e.metadata.view)}))}buildFields(e,t){const i={all:lng("all").caps(),other_user:lng("other user").caps(),group:lng("workspace manager").caps(),role:lng("role").caps()},n=["all","other_user","group","role"].map((e=>({val:e,label:i[e]})));this._fields=[{type:"hidden",name:"bookmark_url",value:JSON.stringify({report_name:this.activeReport,parameters:this.parameters})},{type:"hidden",name:"bookmark_id",value:this.bookmarkId},{type:"hidden",name:"modification_time",value:(0,s.c7)()},{type:"text",name:"bookmark_name",placeholder:lng("bookmark name"),label:lng("bookmark name"),required:!0},{type:"textarea",name:"bookmark_desc",label:lng("description"),maxLength:550},{type:"component",node:(0,a.tZ)(o.Observer,{children:()=>lng("description length").caps()+": "+this.values.get("bookmark_desc").trim().length+"/550"}),visible:e=>{var t;return(null===(t=e.get("bookmark_desc"))||void 0===t?void 0:t.trim().length)>0}},{type:"checkbox",name:"personal_dashboard",label:lng("add to personal dashboard")},{type:"checkbox",name:"share_with_all",label:lng("recommend report"),insert:Blsm.user.isPowerManager},{type:"checkbox",name:"share_report_extra_fields",label:lng("save report with the selected fields"),insert:Blsm.user.isPowerManager},{type:"tags",name:"tags",label:lng("tags"),objectType:"Bookmark",mod:["","ENT"],visible:e=>e.get("share_with_all")||e.get("personal_dashboard"),placeholder:lng("enter relevant tags that will help filter the report in the dashboards").caps()},{type:"row_set",visible:e=>e.get("share_with_all"),fields:[{type:"select",name:"recommended_dashboard_target",label:lng("mode"),options:n,visible:e=>e.get("share_with_all")},{type:"single_item",name:"target_other_user",label:lng("select user"),visible:e=>"other_user"===e.get("recommended_dashboard_target"),required:!0,searchData:(e,t)=>{(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||""}},t)},onSelect:e=>this.values.set("target_name",e.name)},{type:"single_item",name:"target_group",label:lng("select workspace"),visible:e=>"group"===e.get("recommended_dashboard_target"),required:!0,searchData:(e,t)=>{(0,r.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",show_all:1,types:["Ou","Group","Qualification"],term:e.term||"",id:e.ids||""}},t)},onSelect:e=>this.values.set("target_name",e.name)},{type:"single_item",name:"target_role",label:lng("select role"),visible:e=>"role"===e.get("recommended_dashboard_target"),required:!0,searchData:(e,t)=>{(0,r.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",show_all:1,types:["Role"],term:e.term||"",id:e.ids||""}},t)},onSelect:e=>this.values.set("target_name",e.name)}]},{type:"select",name:"widget_view",label:lng("view"),options:t,visible:()=>this.values.get("personal_dashboard")||this.values.get("share_with_all"),insert:!!t},{type:"select",name:"widget_size",label:lng("size"),options:e,visible:()=>this.values.get("personal_dashboard")||this.values.get("share_with_all"),insert:!!e}],this._prepFields(this.initialValues),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,e)}}},4401:(e,t,i)=>{i.d(t,{Z:()=>g});var n=i(4210),r=i(5560),s=i(8e3),o=i(6975),a=i(8567),l=i(5007),c=i(7821),d=i(9793),p=i(2334),u=i(5944);function m(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class g extends n.I{getRelevantDates(){let e={};return this.values.get("whole_day")?(e.start=this.values.get("start_time_without_hours"),e.end=this.values.get("end_time_without_hours")):(e.start=this.values.get("start_time_with_hours"),e.end=this.values.get("end_time_with_hours")),e}constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),m(this,"event_id",null),m(this,"group_id",null),m(this,"calendars",{}),m(this,"calendarOptions",{}),m(this,"eventInfo",{whole_day:"1"}),m(this,"repeatOptions",{none:lng("none").caps(),daily:lng("daily").caps(),weekly:lng("weekly").caps(),monthly:lng("monthly").caps(),yearly:lng("yearly").caps()}),(0,c.makeObservable)(this),this.event_id=(null===(e=t.event)||void 0===e?void 0:e.id)||this.event_id,this.group_id=t.group_id||this.group_id,this.store=t.store,t.selectionInfo&&(this.eventInfo.start_time=t.selectionInfo.startStr,this.eventInfo.end_time=t.selectionInfo.endStr,this.eventInfo.whole_day=t.selectionInfo.allDay?"1":"0");const i=(0,r.observer)((function(e){let{value:t}=e;const i={daily:lng("days"),weekly:lng("weeks"),monthly:lng("months"),yearly:lng("years")};if(t&&"none"!==t)return(0,u.tZ)("div",{children:i[t]})}));let n=this.event_id?{id:this.event_id}:{calview:"month",group_id:this.group_id};(0,s.SC)("calendarevent",{data:n},(e=>{var t,n,r,s,o;this.calendarOptions=[],this.calendars=(null===(t=e.calendars)||void 0===t?void 0:t.mine)||this.calendars,null===(n=(r=this.calendars).map)||void 0===n||n.call(r,(e=>this.calendarOptions.push({val:e.id,label:e.name+(e.user_id||e.goup_id?"":"🌏")}))),this.eventInfo=(null==e?void 0:e.event)||this.eventInfo,this.eventInfo.calendar_id=(null===(s=e.event)||void 0===s?void 0:s.calendar_id)||e.calendar_id,this.group_id=(null===(o=this.eventInfo)||void 0===o?void 0:o.group_id)||this.group_id,this._buildFields({RepeatTypeChanged:i})})),this.event_id&&(this.headExtra=(0,u.tZ)(d.b,{children:(0,u.tZ)(o.JO,{icon:"trash",className:"task-button",onClick:()=>this.deleteEvent(t)})}))}_buildFields(e){var t,i,n,r;let{RepeatTypeChanged:s}=e;const o=e=>{var t,i;let{target:n,value:r}=e;n.includes("_with_hours")?r+=" "+(null===(t=this.values.get(n))||void 0===t?void 0:t.split(" ")[1]):r=null===(i=r)||void 0===i?void 0:i.split(" ")[0],this.values.set(n,r)},a=()=>{if("none"===this.values.get("repeat_type"))return!0;let e=this.getRelevantDates();return(0,p._3)(this.values.get("end_repeat")).isAfter((0,p._3)(e.start))},l=()=>{let e,t=this.values.get("whole_day"),i=this.getRelevantDates();return e=t?(0,p._3)(i.end).isAfter((0,p._3)(i.start))||i.start===i.end:(0,p._3)(i.end).isAfter((0,p._3)(i.start)),e},c=()=>{let e,t=this.values.get("nth_day"),i=this.values.get("repeat_type");switch(i){case"none":return!0;case"daily":e=86400;break;case"weekly":e=604800;break;case"monthly":e=2419200;break;case"yearly":e=31536e3}if(i){"0"!==t&&t||this.values.set("nth_day",1);let i=parseInt(t)*e,n=this.getRelevantDates();return(0,p._3)(n.end).diff((0,p._3)(n.start))/1e3<=i}return!0},d=e=>this.calendars.find((t=>t.id===e))||{},u=e=>this.group_id||Blsm.user.isPowerManager&&null===d(e.get("calendar_id")).user_id,m=!this.group_id||this.eventInfo.repeat_type&&"none"!==this.eventInfo.repeat_type;this.title=this.event_id?`${lng("edit").caps()}: ${this.eventInfo.event_name}`:lng("new event").caps(),this._fields=[{type:"text",name:"event_name",label:lng("event name"),required:!0,maxLength:50,placeholder:lng("event name").caps()},{type:"date_time",name:"start_time_with_hours",label:lng("start time"),value:null===(t=this.eventInfo)||void 0===t?void 0:t.start_time,required:!0,visible:e=>!e.get("whole_day"),onValueChange:e=>o({target:"start_time_without_hours",value:e}),validate:()=>!!l()||{error:lng("invalid dates")}},{type:"date_time",name:"end_time_with_hours",label:lng("end time"),value:null===(i=this.eventInfo)||void 0===i?void 0:i.end_time,required:!0,visible:e=>!e.get("whole_day"),onValueChange:e=>o({target:"end_time_without_hours",value:e}),validate:()=>!!l()||{error:lng("invalid dates")}},{type:"date",name:"start_time_without_hours",label:lng("start time"),value:null===(n=this.eventInfo)||void 0===n?void 0:n.start_time,required:!0,visible:e=>e.get("whole_day"),onValueChange:e=>o({target:"start_time_with_hours",value:e})},{type:"date",name:"end_time_without_hours",label:lng("end time"),value:null===(r=this.eventInfo)||void 0===r?void 0:r.end_time,required:!0,visible:e=>e.get("whole_day"),onValueChange:e=>o({target:"end_time_with_hours",value:e}),validate:()=>!!l()||{error:lng("invalid dates")}},{type:"checkbox",name:"whole_day",label:lng("whole day").caps()},{type:"select",name:"calendar_id",label:lng("calendar").caps(),required:!0,options:this.calendarOptions,emptyOption:!0,visible:()=>!this.group_id},{type:"checkbox",name:"blocking_event",label:lng("blocking event"),visible:u},{type:"checkbox",name:"manager_only",label:lng("visible by power managers only"),visible:e=>Blsm.user.isPowerManager&&u(e)},{type:"select",name:"repeat_type",label:lng("repeat type"),options:this.repeatOptions,insert:m},{type:"indent_set",insert:m,visible:e=>"none"!==e.get("repeat_type"),fields:[{type:"row_set",fields:[{type:"number",name:"nth_day",label:lng("repeat every"),min:1,max:30,value:1,validate:()=>!!c()||{error:lng("repeat duration must be longer than event duration")}},{type:"component",Render:s,name:"repeat_type"}]},{type:"date",name:"end_repeat",label:lng("ends at date"),validate:()=>!!a()||{error:lng("invalid repeat date")}}]}],this._prepFields(this.eventInfo),this.ready=!0}deleteEvent(e){(0,a.BB)(lng("are you sure you want to delete the event?"),{title:lng("delete").caps(),onConfirm:()=>(0,s.SC)("calendarevent/"+this.event_id,{method:"DELETE"},(()=>{if((0,l.vm)().closeDialog(),this.store){const t=this.store.calendarRef.current.api().getEvents();for(const i of t)e.event.id==i.id&&i.remove()}}))})}SaveSuccess(e){(0,l.vm)().closeDialog(),this.store&&this.store.calendarRef.current.refresh(),this.onSaveSuccess&&this.onSaveSuccess(e)}save(e){let t=this.getRelevantDates(),i=(0,p.GG)(t.start,{time:!0,obj:!0,utc:!0,offset:!0}),n=(0,p.GG)(t.end,{time:!0,obj:!0,utc:!0,offset:!0});this.saveToUrl("calendarevent/"+this.event_id,Object.assign({group_id:this.group_id,event_id:this.event_id,start_time:i,end_time:n},e))}}},9305:(e,t,i)=>{i.d(t,{En:()=>Z,TP:()=>P});var n=i(4210),r=i(8e3),s=i(8318),o=i(7821),a=i(5560),l=i(6975),c=i(441),d=i(5007),p=i(5944);function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class m extends n.I{constructor(e){super(e),u(this,"value",{}),this._fields=(0,o.observable)([]),this.value=(null==e?void 0:e.value)||{},this.title=null==e?void 0:e.title;for(let e in Blsm.lang.weekDays){this._fields.push({type:"row_set",fields:[{type:"checkbox",name:e,value:(0,s.xb)(this.value[e])?0:1,label:Blsm.lang.weekDays[e],onValueChange:t=>t?this.addTimeFieldsRow(e):this.removeTimeFieldsRow(e)},{type:"component",visible:()=>this.values.get(e),node:(0,p.tZ)(l.JO,{icon:"new",buttonLike:!0,onClick:()=>this.addTimeFieldsRow(e)})}]});const t=[];if(this.value[e])for(let i=0;i<this.value[e].length;i+=2)t.push(this.hourPair(e,i));this._fields.push({type:"indent_set",visible:()=>this.values.get(e),name:`indent_set_${e}`,fields:t})}this._prepFields(),this.ready=!0}hourPair(e,t){var i,n;return{type:"row_set",fields:[{type:"time",label:lng("from|date"),name:`times[${e}][${t}]`,value:null===(i=this.value[e])||void 0===i?void 0:i[t]},{type:"time",label:lng("to|date"),name:`times[${e}][${t+1}]`,value:null===(n=this.value[e])||void 0===n?void 0:n[t+1]},{type:"component",node:(0,p.tZ)(l.JO,{icon:"trash",buttonLike:!0,onClick:()=>this.removeTimeFieldsRow(e,t)})}]}}addTimeFieldsRow(e){this._fields.map((t=>{if(t.name===`indent_set_${e}`){const i=t.fields,n=2*t.fields.length;i.push(this.hourPair(e,n)),t.fields.replace(i)}}))}removeTimeFieldsRow(e,t){this._fields.map((i=>{i.name===`indent_set_${e}`&&(void 0!==t?(i.fields.map((n=>{n.fields[0].name===`times[${e}][${t}]`&&(n.fields.map((e=>this.values.delete(e.name))),i.fields.remove(n))})),0===i.fields.length&&this.values.set(e,!1)):(i.fields.map((e=>e.fields.map((e=>this.values.delete(e.name))))),i.fields.clear()))}))}save(e){const t=e.times,i={};for(const[e,n]of Object.entries(t)){const t=[];for(const[e,i]of Object.entries(n))parseInt(e)%2==0&&i&&n[parseInt(e)+1]&&t.push(i,n[parseInt(e)+1]);t.length&&(i[e]=t)}this.onSaveSuccess(i)}}var g,h,b=i(917),v=i(6920),_=i(5898),f=i(1619),y=i(3718),w=i(2755),x=i(7363);function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let Z=(g=o.action.bound,h=class extends n.I{get approvalType(){return this.manager_register?"RegExtMgr":"RegExt"}constructor(e){var t;let i,{group_id:n,user_id:a,manager_register:l,approvalRequest:c,request_id:d,ect_id:p,readOnly:u,editMode:m,createNew:g,ectName:h,...b}=e;var v,_;(super(b),k(this,"group_id",void 0),k(this,"ect_id",void 0),k(this,"user_id",void 0),k(this,"manager_register",void 0),k(this,"diploma_only",void 0),k(this,"ectData",{}),k(this,"haveUncompletedRequiredGroups",!1),k(this,"readOnly",!1),k(this,"validateOnChange",!0),k(this,"ectName",""),k(this,"approvalRequest",void 0),(0,o.makeObservable)(this),c)&&(i=null===(v=c)||void 0===v?void 0:v.target_data,n=n||c.target_id,a=a||c.user_id,d=d||c.request_id,p=p||c.ect_id||(null===(_=i)||void 0===_?void 0:_.ect_id));this.group_id=n,this.user_id=a,this.diploma_only=!!this.user_id&&!!this.group_id&&u&&!m,this.confirmButtonLabel=this.diploma_only?lng("upload diploma").caps():g||m?lng("submit|request").caps():u?null:lng("save").caps(),this.editMode=m,this.createNew=g,this.approvalRequest=c,d=d||null,this.request_id=d,this.ect_id=p,this.manager_register=l||"RegExtMgr"===(null===(t=c)||void 0===t?void 0:t.type),this.title=i?lng("view external event").caps():this.user_id?this.group_id||m?lng("edit external event"):lng("new external event"):h?lng("apply for %s|course",h).caps():lng("apply for an external event").caps(),this.fetchUrl="groups/external_course",(0,r.SC)(this.fetchUrl,{data:{id:this.group_id,user_id:this.user_id,ect_id:this.ect_id,request_id:d,approval:i||d?1:0,edit_mode:m?1:0}},(e=>{var t,n,r,a,l,d;const p=e;p.data=p.data||{},this.manager_register=this.manager_register||"RegExtMgr"===p.data.type;const m=null===(t=p.ect_data)||void 0===t?void 0:t.ect_fields_description;if(this.haveUncompletedRequiredGroups=!!p.uncompletedRequiredGroupsIds&&void 0===c,this.readOnly=!!u||this.haveUncompletedRequiredGroups,this.disabled=this.haveUncompletedRequiredGroups,this.ectName=null===(n=p.ect_data)||void 0===n?void 0:n.ect_name,this.ectOptions=(null===(r=p.ect_data)||void 0===r?void 0:r.ect_options)||{},i||(i=p.data.target_data||{}),this.manager_register){var g;const e=null!==(g=c)&&void 0!==g&&g.participants?(0,o.toJS)(c.participants):[];this.values.set("participants",e),this.values.set("participants_ids",(0,s.jg)(e,"user_id"))}this.request_id&&(c=p.data,i.request_files=p.data.request_files),i.r_event_hours=i.r_event_hours||{},i.working_hours=i.working_hours||p.user_working_hours||{};const h=this.getDisplaySettings(p.ect_data),b=null!==(a=p.approver_data)&&void 0!==a&&a.user_selection?null===(l=p.approver_data)||void 0===l||null===(d=l.approver_options)||void 0===d?void 0:d.map((e=>({val:e.id,label:`[#${e.id}] ${e.label}`}))):[];this.buildFields({resData:p,approvalRequest:c,targetData:i,readOnly:u,displayObj:h,approverOptions:b,ectDescriptions:m})}))}getDisplaySettings(e){if(!e)return{};const t=e.display_settings,i={},n=Object.keys(t||{});for(const e in n)n.includes(e)&&"mandatory"===t[n[e]]&&!this.readOnly&&(i[n[e]]="required");return{display_settings:t,rules:i}}buildFields(e){let{resData:t,approvalRequest:i,targetData:n,readOnly:o,displayObj:a,approverOptions:d,ectDescriptions:u}=e;const m=this.editMode&&i.performer_id==Blsm.user.id;this.successMessage=this.editMode?`${lng("external event saved")}. ${m?"":lng("refresh to update.")}`:this.diploma_only?lng("diploma saved"):this.createNew?lng("application received"):lng("success"),this.sendEmpty=!0,this.saveUrl=this.editMode?`groups/update_external_course/${(0,s.$t)({ect_id:this.ect_id,request_id:this.request_id,type:this.approvalType})}`:this.diploma_only?`groups/save_external_course_diploma/${(0,s.$t)({id:this.group_id,user_id:this.user_id,type:this.approvalType})}`:this.createNew?`groups/apply_for_external_course/${(0,s.$t)({ect_id:this.ect_id})}`:void 0;const g=()=>!0;this.ectData=(null==t?void 0:t.ect_data)||(null==t?void 0:t.data)||{};const h=j.some((e=>(0,s.Dw)(n[e]))),b=(0,s.DM)(null==a?void 0:a.display_settings),w=e=>!o&&b?["visible","mandatory"].includes(a.display_settings[e]):(0,s.Dw)(this.values.get(e)),x=e=>!o&&b&&"mandatory"===a.display_settings[e],k=!!this.ectData.origin_id,Z=this.editMode||o||Blsm.user.isPowerManager?"text":"number",C="number"===Z?void 0:e=>(0,s.mE)(e,{min:0}),S=e=>{let{min:t,max:i}=e;return e=>(0,s.mE)(e,{min:t,max:i})},O=this.manager_register&&i&&(!o||this.editMode)||!this.request_id,B={type:"section",name:"external",fields:[{type:"component",node:(0,p.tZ)(_.jC,{color:v.g.colors.warning,children:lng("you have uncompleted required courses").caps()}),visible:()=>this.haveUncompletedRequiredGroups},{type:"single_item",name:"origin_request_id",label:lng("original request"),readOnly:o,searchData:(e,t)=>{let{term:i,ids:n}=e;(0,r.SC)("registration/get_requests",{data:{term:i,id:n,limit:20,type:this.approvalType,status:n?null:"approved",ect_id:n?null:this.ectData.origin_id,user_id:n?null:Blsm.user.id}},t)},required:!o,insert:k,visible:g},{type:"indent_set",visible:g,insert:n.origin_request_id&&o,fields:[{type:"component",node:(0,p.BX)(c.A,{href:{report:"Report_Approvals_Status_"+this.approvalType,params:{request_id:n.origin_request_id}},newTab:!0,children:[(0,p.tZ)(l.JO,{icon:"report"})," ",lng("request details").caps()]}),visible:g}]},{type:"text",name:"ext_course_name",label:lng("event name"),required:!o,visible:g,readOnly:o,placeholder:lng("write a title for your request"),suggest:this.manager_register?{table:"groups",field:"group_name",filter:{group_type:"Course_external"}}:void 0},{type:"select",name:"importance",label:lng("degree of importance"),emptyOption:!0,options:(0,s.wd)(y.Q),readOnly:o},{type:"textarea",name:"request_msg",label:lng("explanation").caps(),visible:g,readOnly:o,insert:!(null!=i&&i.steps)},{type:"date_time",name:"group_open_date",label:lng("start date"),maxDate:()=>moment(this.values.get("group_close_date"),Blsm.prm.date_moment_format)},{type:"date_time",name:"group_close_date",label:lng("end date"),minDate:()=>moment(this.values.get("group_open_date"),Blsm.prm.date_moment_format)},{type:"text",name:"group_location",label:lng("location")},{type:"single_item",name:"supplier_id",label:lng("organizing institution"),readOnly:o,searchData:(e,t)=>{let{term:i,ids:n}=e;(0,r.SC)("suppliers/autocomplete",{data:{term:i,id:n,limit:20,type:"RegExt"}},t)}},{type:"text",name:"r_institution",label:lng("organizing institution")+(w("supplier_id")?` (${lng("other")})`:"")},{type:"title",label:this.ectData.ect_terms_title||lng("terms and conditions"),visible:()=>g,insert:!!this.ectData.ect_terms},{type:"component",node:(0,p.tZ)(f.dB,{content:n.ect_terms||this.ectData.ect_terms,title:this.ectData.ect_terms_title||lng("terms and conditions")}),visible:g,insert:!!this.ectData.ect_terms},{type:"hidden",name:"ect_terms",value:this.ectData.ect_terms,insert:!!this.ectData.ect_terms&&w("signature")},{type:"signpad",name:"signature",label:lng("signature"),insert:!this.editMode&&w("signature")},{type:"file",name:"diploma_file",label:lng("diploma").caps(),insert:!!this.user_id&&!!this.diploma_only,visible:g,readOnly:!1},{type:"select",name:"chosen_approver_id",label:lng("you may choose the approver"),visible:g,options:d,insert:d.length>0}]},T={type:"section",name:"additional",fields:[{type:"date",name:"r_absence_start_date",label:lng("start of absence")},{type:"date",name:"r_absence_end_date",label:lng("end of absence")},{type:Z,name:"r_days_off",label:lng("days off")+(void 0!==n.days_off?` (${lng("requested")})`:""),validate:C},{type:Z,name:"days_off",label:`${lng("days off")} (${lng("approved")})`,readOnly:!this.editMode,visible:()=>void 0!==n.days_off,validate:C},{type:Z,name:"r_hours",label:lng("academic hours")+(void 0!==n.hours?` (${lng("requested")})`:""),validate:C},{type:Z,name:"hours",label:`${lng("academic hours")} (${lng("approved")})`,readOnly:!this.editMode,visible:()=>void 0!==n.hours,validate:C},{type:"checkbox",name:"r_professional_development",label:lng("professional development")},{type:"checkbox",name:"r_active",label:lng("presenting")},{type:"component",name:"working_hours",Render:D,props:{label:lng("working hours").caps(),readOnly:o},label:lng("working hours").caps()},{type:"component",name:"r_event_hours",Render:D,props:{label:lng("event hours").caps(),readOnly:o}},{type:"file",multiFile:!0,name:"request_files",label:lng("attachments"),readOnly:o,required:()=>x("attachments"),visible:()=>{var e;return w("attachments")||(null===(e=this.values.get("request_files"))||void 0===e?void 0:e.length)>0}}]},N=this._customFieldsPrep(null==t?void 0:t.custom_fields);T.fields.push(...N);const I={type:"section",name:"funding",fields:[{type:"title",label:lng("requested funding"),visible:g},{type:Z,name:"r_paid_leave",label:lng("paid leave days"),validate:C},{type:Z,name:"r_price",label:lng("tuition"),validate:C},{type:Z,name:"r_travel",label:lng("travel price"),validate:C},{type:Z,name:"r_expenses",label:lng("expenses"),validate:C},{type:Z,name:"r_funding",label:lng("total required funding"),validate:S({min:this.ectOptions.funding_min||0,max:this.ectOptions.funding_max})}]};h&&I.fields.push({type:"title",label:lng("approved funding"),visible:g},{type:Z,name:"paid_leave",label:lng("paid leave days"),readOnly:!this.editMode,visible:()=>void 0!==n.paid_leave,validate:C},{type:Z,name:"price",label:lng("tuition"),readOnly:!this.editMode,visible:()=>void 0!==n.price,validate:C},{type:Z,name:"travel",label:lng("travel price"),readOnly:!this.editMode,visible:()=>void 0!==n.travel,validate:C},{type:Z,name:"expenses",label:lng("expenses"),readOnly:!this.editMode,visible:()=>void 0!==n.expenses,validate:C},{type:Z,name:"funding",label:lng("total funding"),readOnly:!this.editMode,visible:()=>void 0!==n.funding,validate:S({min:this.ectOptions.funding_min||0,max:this.ectOptions.funding_max})});const z={type:"section",name:"participants",insert:this.manager_register,sectionHeight:innerHeight>v.g.consts.MIN_FORM_HEIGHT_MOBILE?"calc(100vh - 425px)":null,fields:P({approvalRequest:i,form:this,allowParticipantsApproval:this.editMode,allowParticipantsEdit:O})};this._fields=[B,z,T,I].filter((e=>e.fields.length&&e.insert||void 0===e.insert)),this._fields.forEach((e=>e.fields.forEach((function(e){void 0===e.visible&&(e.visible=()=>w(e.name)),void 0===e.required&&(e.required=()=>x(e.name)),void 0===e.readOnly&&(e.readOnly=o),e.name&&u&&u[e.name]&&(e.placeholder=u[e.name])})))),this._prepFields(n),this.ready=!0}save(e){e=(0,s.v7)(e,((e,t)=>(0,s.Dw)(e)&&!/^cb_/.test(t)));const t={group_id:this.group_id,ect_id:this.ect_id,request_id:this.request_id};e=Object.assign({},e,t);const i=this.diploma_only?{diploma_file:e.diploma_file}:e;this.saveToUrl(this.saveUrl,i)}},C=h.prototype,S="save",O=[g],B=Object.getOwnPropertyDescriptor(h.prototype,"save"),T=h.prototype,N={},Object.keys(B).forEach((function(e){N[e]=B[e]})),N.enumerable=!!N.enumerable,N.configurable=!!N.configurable,("value"in N||N.initializer)&&(N.writable=!0),N=O.slice().reverse().reduce((function(e,t){return t(C,S,e)||e}),N),T&&void 0!==N.initializer&&(N.value=N.initializer?N.initializer.call(T):void 0,N.initializer=void 0),void 0===N.initializer&&(Object.defineProperty(C,S,N),N=null),h);var C,S,O,B,T,N;const I={name:"zgqd7l",styles:".field-error{border-radius:7px;border:1px solid #DEDEDE;border-color:#E64D40;padding:5px;}ul{margin:0;}"},D=(0,a.observer)((function(e){let{error:t,value:i,onChange:n,label:r,menu_info:s,readOnly:o}=e;return(0,p.BX)("div",{css:I,children:[(0,p.BX)("div",{className:t?"field-error":"",children:[(0,p.tZ)("b",{children:r}),s&&(0,p.tZ)(l.JO,{icon:"menu_info",toolTip:s}),!o&&(0,p.tZ)(l.JO,{icon:"edit",buttonLike:!0,onClick:()=>(0,d.vm)().openDialog("form",new m({title:r,value:i,onSaveSuccess:e=>{n(e),(0,d.vm)().closeDialog()}}))})]}),i&&(0,p.tZ)("div",{children:Object.entries(i).filter((e=>{var t;return(null===(t=e[1])||void 0===t?void 0:t.length)>0})).map((e=>(0,p.BX)("div",{children:[(0,p.tZ)("span",{children:Blsm.lang.weekDays[e[0]]}),(0,p.tZ)("ul",{children:e[1].map(((t,i)=>i%2==1?null:(0,p.BX)("li",{children:[t," - ",e[1][i+1]]},i)))})]},e[0])))})]})})),j=["paid_leave","price","travel","expenses","funding"],P=e=>{let{approvalRequest:t,form:i,allowParticipantsApproval:n,allowParticipantsEdit:a}=e;null!=t&&t.participants&&!i.values.get("participants_ids")&&(i.values.set("participants",i.values.get("participants")||(0,o.toJS)(t.participants)),i.values.set("participants_ids",(0,s.jg)(t.participants,"user_id")));return[{type:"multiple_items",name:"participants_ids",poster:!0,fitContent:!0,theme:"bright",addAll:!t,clearAll:!t,value:i.values.get("participants_ids"),showRemove:e=>{if(a){var t;const n=null===(t=i.values.get("participants"))||void 0===t?void 0:t.find((t=>t.user_id==(e.id||e.key)));return null==n?void 0:n.isNew}return!1},readOnly:!a,disabled:!1,visible:()=>!0,searchData:(e,t)=>{let{term:n,ids:s,noLimit:o}=e;const a={term:n,id:s,limit:s||o?null:10,ou:1,job:1};s||(a.managed_groups=1,a.managed_groups_types="Ou",a.exclude=i.values.get("participants_ids")),(0,r.SC)("users/autocomplete",{method:"POST",json:!0,data:a},t)},buttons:[{Render:function(e){let{item:r}=e;const s={accepted:{icon:"like",color:v.g.colors.positive,toolTip:n?lng("approve"):lng("approved")},declined:{icon:"dislike",color:v.g.colors.negative,toolTip:n?lng("decline"):lng("declined")}},a=r.id||r.key,l=i.values.get("participants").find((e=>e.user_id==a)),[c,d]=(0,x.useState)(null==l?void 0:l.status),u=(0,b.iv)(">*:not(:first-child-of-type){",v.g.classes.margin_near("1em"),";}",""),m=e=>{let{status:t,value:r}=e;if((null!=l&&l.isNew||!n)&&t!==r)return null;const o=s[t];return(0,p.tZ)(w.ZT,{color:r===t?o.color:r?v.g.colors.disabled_text:v.g.colors.text_black,onClick:n?()=>(e=>{if(g){for(const t of g)t.user_id==a&&(t.status=e);i.updateValue(g,"participants"),d(e)}})(t):null,bgColor:"transparent",size:30,toolTip:o.toolTip,icon:o.icon})},g=i.values.get("participants")||(0,o.toJS)(null==t?void 0:t.participants);return(0,p.BX)("div",{css:u,children:[(0,p.tZ)(m,{status:"accepted",value:(0,o.toJS)(c)}),(0,p.tZ)(m,{status:"declined",value:(0,o.toJS)(c)})]})}}],onValueChange:e=>{const t=(i.values.get("participants")||[]).filter((t=>e.includes(t.user_id))),r=(0,s.jg)(t,"user_id");e.forEach((e=>{r.includes(e)||t.push({user_id:e,isNew:!0,status:n?"accepted":null,created_by:Blsm.user.id})})),i.updateValue(t,"participants")},validate:e=>{if(n){const t=i.values.get("participants").filter((t=>e.includes(t.user_id)));if(null!=t&&t.some((e=>!e.status)))return{error:lng("there are still participants that were not approved/rejected").caps()}}return!0}}]}},9489:(e,t,i)=>{i.d(t,{_:()=>O,y:()=>f});var n,r=i(7363),s=i(7821),o=i(5560),a=i(4210),l=i(6920),c=i(2620),d=i(6975),p=i(2808),u=i(8e3),m=i(8318),g=i(8567),h=i(5024),b=i(5007),v=i(5944);function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let f=(n=class extends a.I{constructor(e){var t,i;super(e),_(this,"files",[]),_(this,"myContentInGroup",""),this.files=[...e.files].map((e=>{const t=(0,s.observable)({file_name:e.name,file_size:e.size,temp_name:"",progress:0,xhr:(0,u.Wi)("content/upload_content_files",e,(e=>t.temp_name=e.temp_name),((e,i)=>t.progress=(0,m.NM)(100*e/i)),(()=>t.temp_name=!1))});return t})),this.title=lng("create multiple file content"),this.successMessage=lng("content saved successfully"),this.myContentInGroup=e.my_content_in_group,this._fields=[{name:"share",type:"hidden",value:null==e?void 0:e.share},{name:"unit_id",type:"hidden",value:null==e?void 0:e.unit_id},{name:"folder_id",label:lng("folder"),type:"component",Render:h.p,props:{folderTree:e.folderOptions},insert:(null===(t=e.folderOptions)||void 0===t?void 0:t.length)>0},{name:"category_id",label:lng("category"),type:"select",options:(0,m.wd)(e.categoriesOptions),insert:(null===(i=e.categoriesOptions)||void 0===i?void 0:i.length)>0},{type:"component",node:(0,v.tZ)(O,{files:this.files})}],this._prepFields(),this.ready=!0}get customDirty(){return!0}save(e){this.files.some((e=>""===e.temp_name))?(0,g.qR)(lng("please wait for all uploads to complete.").caps()):((0,b.vm)().closeDialog(),this.saveToUrl("content/save_content_files",Object.assign(e,{dnduploadfiles:this.files.map((e=>({temp_name:e.temp_name,name:e.file_name}))).filter((e=>{var t;return(null===(t=e.temp_name)||void 0===t?void 0:t.length)>0})),my_content_in_group:this.myContentInGroup})))}},y=n.prototype,w="customDirty",x=[s.computed],k=Object.getOwnPropertyDescriptor(n.prototype,"customDirty"),Z=n.prototype,C={},Object.keys(k).forEach((function(e){C[e]=k[e]})),C.enumerable=!!C.enumerable,C.configurable=!!C.configurable,("value"in C||C.initializer)&&(C.writable=!0),C=x.slice().reverse().reduce((function(e,t){return t(y,w,e)||e}),C),Z&&void 0!==C.initializer&&(C.value=C.initializer?C.initializer.call(Z):void 0,C.initializer=void 0),void 0===C.initializer&&(Object.defineProperty(y,w,C),C=null),n);var y,w,x,k,Z,C;const S={name:"qxh9u6",styles:">div{margin-top:1em;}"},O=(0,o.observer)((function(e){let{files:t}=e;return(0,r.useEffect)((()=>()=>t.forEach((e=>e.xhr.abortFetch()))),[]),(0,v.tZ)("div",{css:S,children:t.map(((e,t)=>(0,v.tZ)(B,{file:e},t)))})})),B=(0,o.observer)((function(e){let{file:t}=e;const{file_name:i,progress:n,temp_name:r}=t;return(0,v.BX)("div",{css:c.a,style:l.g.styles.progressBG(n),children:[(0,v.BX)("div",{className:"meta",children:[(0,v.tZ)(d.JO,{icon:(0,p.DW)(i,!0)}),(0,v.tZ)("div",{css:l.g.classes.flex_grow}),!1===r&&(0,v.tZ)(d.JO,{icon:"sign_notification",color:l.g.colors.negative,toolTip:lng("upload failed").caps()})]}),(0,v.tZ)("span",{className:"name",children:i})]})}))},8297:(e,t,i)=>{i.d(t,{M:()=>l});var n,r,s=i(4210),o=i(5007),a=i(7821);let l=(n=a.action.bound,r=class extends s.I{constructor(e){super(e);const{data:t={}}=e;this.data=t,this.isNew=!t.message,this.title=t.message?lng("edit message"):lng("add a new message"),this.url=t.message?"groups/update_message":"groups/message",this.buildFields()}initialValues(){return this.isNew?{}:{text:this.data.message.text}}buildFields(){this._fields=[{name:"text",type:"richtext",label:lng("message"),toolbarOptions:{font:!0,color:!0,link:!0,media:!0}},{name:"inherited",type:"checkbox",label:lng("show message in sub workspaces")}],this._prepFields(this.initialValues()),this.ready=!0}save(e){var t;this.saveToUrl(this.url,{...e,group_id:this.data.ws,id:null===(t=this.data.message)||void 0===t?void 0:t.id})}update(e){const t=(0,o.vm)().getStore("workspace",this.data.ws);this.isNew?t.addGroupMessageLocally(e,this.getValue("text")):t.updateGroupMessageLocally(e,{text:this.getValue("text"),inherited:this.getValue("inherited")})}SaveSuccess(e){var t;this.update((null===(t=this.data.message)||void 0===t?void 0:t.id)||e),(0,o.vm)().closeDialog()}},c=r.prototype,d="SaveSuccess",p=[n],u=Object.getOwnPropertyDescriptor(r.prototype,"SaveSuccess"),m=r.prototype,g={},Object.keys(u).forEach((function(e){g[e]=u[e]})),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=p.slice().reverse().reduce((function(e,t){return t(c,d,e)||e}),g),m&&void 0!==g.initializer&&(g.value=g.initializer?g.initializer.call(m):void 0,g.initializer=void 0),void 0===g.initializer&&(Object.defineProperty(c,d,g),g=null),r);var c,d,p,u,m,g},7191:(e,t,i)=>{i.d(t,{m:()=>a,v:()=>l});var n=i(4210),r=i(7392),s=i(8e3),o=i(5944);class a extends n.I{constructor(e){super(e),this.params=e,this.title=lng("import from a workspace").caps(),this._fields=[{type:"single_item",name:"import_id",label:lng("import data from an existing workspace"),required:!0,searchData:(t,i)=>{(0,s.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:this.params.groupTypes,term:t.term||"",id:t.ids||"",exclude:e.group_id}},(n=>{var r,s;1===(null===(r=t.ids)||void 0===r?void 0:r.length)&&1===n.length&&(null===(s=e.onSelect)||void 0===s||s.call(e,n[0])),i(n)}))},onSelect:e.onSelect},...l(this,this.params),{type:"component",node:(0,o.tZ)(r.l,{onClick:()=>this.save({}),theme:"outlined",children:lng("don't import").caps()})}];const t=e.data||{settings:this.params.canImportSettings?1:0,poster:!this._id,assignments:1,catalog:1,meetings:1,units:1,blog:1};e.import_id&&(t.import_id=e.import_id),this._prepFields(t),this.ready=!0}save(e){this.params.onSave(e)}}const l=(e,t)=>{let{prefix:i="",suffix:n="",canImportSettings:r=!0}=t;return[r&&{type:"checkbox",name:i+"settings"+n,label:`${lng("import settings")} (${lng("applies only to new workspaces")})`},{type:"checkbox",name:i+"poster"+n,label:lng("poster")},{type:"checkbox",name:i+"assignments"+n,label:lng("assignments")},{type:"indent_set",fields:[{type:"checkbox",name:i+"duplicate_assignments"+n,label:lng("duplicate assignments"),value:window.Branch.checkboxOn(),disable:()=>!e.values.get(i+"assignments"+n)}]},{type:"checkbox",name:i+"catalog"+n,label:lng("shared content")},{type:"checkbox",name:i+"meetings"+n,label:lng("meetings")},{type:"indent_set",fields:[{type:"checkbox",name:i+"duplicate_resources"+n,label:lng("resources"),disable:()=>!e.values.get(i+"meetings"+n)}]},Blsm.isFeatureEnabled("learning_units")&&{type:"checkbox",name:i+"units"+n,label:lng("learning units")},Blsm.isFeatureEnabled("blog")&&{type:"checkbox",name:i+"blog"+n,label:lng("blog")},{type:"checkbox",name:i+"managers"+n,label:lng("managers")}].filter((e=>e))}},484:(e,t,i)=>{i.d(t,{H:()=>d});var n=i(4210),r=i(8e3),s=i(8318),o=i(5474),a=i(8534),l=i(5944);function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d extends n.I{constructor(e){super(e),c(this,"lessonId",null),c(this,"permissionType",(e=>{let{onChange:t,item:i}=e;const n=[{val:"read",label:lng("read").caps()},{val:"write",label:lng("write")}];return(0,l.tZ)(o.P,{options:n,value:i.permission_name,onChange:e=>t({value:e})})})),this.lessonId=(null==e?void 0:e.lessonId)||this.lessonId,this.title=(0,s.B5)(this.lessonId)?`${lng("edit permissions").caps()}: ${this.params.lessonName}`:lng("add owners").caps(),this.successMessage=lng("content permissions saved"),this.saveAsJson=!0,(0,r.SC)("content/get_owners",{method:"POST",data:{lesson_id:this.lessonId}},(e=>{const t=[];t.user_permissions=e.owners.users,t.group_permissions=e.owners.groups,this.buildFields(t)}))}buildFields(e){this._fields=[{type:"component",node:(0,l.BX)("div",{children:[(0,l.BX)("span",{style:{fontWeight:600},children:[lng("add owners for").caps(),":"]})," ",this.params.lessonId.length>5?lng("%s selected content",this.params.lessonId.length):this.params.lessonName]}),insert:!(0,s.B5)(this.lessonId)},{type:"multiple_items",name:"user_permissions",label:lng("select users"),poster:!0,theme:"bright",value:e.user_permissions,valueIsMap:!0,objectKeys:["id","permission_name"],searchData:(e,t)=>{let{term:i,ids:n}=e;(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:i,id:n||"",exclude:this.values.get("user_permissions")||[]}},t)},buttons:[{Render:this.permissionType,onChange:(e,t)=>{let{value:i}=t;return e.permission_name=i,e}}],searchDataCacheFunc:e=>(0,s.SZ)(Object.assign({ids:(this.values.get("ids")||[]).concat(this.inList)},e))},{type:"multiple_items",name:"group_permissions",label:lng("select workspaces"),poster:!0,theme:"bright",value:e.group_permissions,valueIsMap:!0,objectKeys:["id","permission_name"],mod:["","ENT"],searchData:(e,t)=>{let{term:i,ids:n}=e;(0,r.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",is_owner:1,term:i,id:n||"",exclude:this.values.get("group_permissions")||[]}},t)},buttons:[{Render:this.permissionType,onChange:(e,t)=>{let{value:i}=t;return e.permission_name=i,e}}],searchDataCacheFunc:e=>(0,s.SZ)(Object.assign({ids:(this.values.get("ids")||[]).concat(this.inList)},e))}],this._prepFields(),this.ready=!0}save(e){const t=Object.values(e.user_permissions||{});if(0!==t.length&&t.some((e=>"write"===e.permission_name))){for(const[t]of Object.entries(e.user_permissions))e.user_permissions[t].permission_name=e.user_permissions[t].permission_name||"read";for(const[t]of Object.entries(e.group_permissions))e.group_permissions[t].permission_name=e.group_permissions[t].permission_name||"read";this.saveToUrl("content/save_permissions",Object.assign({lesson_id:this.lessonId},e))}else(0,a.nb)(lng("content must have at least one user with write permission").caps())}}},2307:(e,t,i)=>{i.d(t,{s:()=>l});var n=i(7138),r=i(4576),s=i(5024),o=i(5519),a=i(8318);class l extends n.U{constructor(e){super({...e,baseRoute:"content"}),this.id=e.id}createAttributes(e){const t=o.z9.map((e=>[e,(0,r.BP)(e).caps(!1)]));this.folderOptions=(null==e?void 0:e.folders)||[],this.attributes=[{name:"lesson_category_id",label:lng("category"),type:"select",grow:10,options:e.categories_options},{type:"select_multi",name:"lesson_sub_categories",label:lng("additional relevant categories"),options:(0,a.wd)(e.categories_options),trim:!0,helpKey:"@content/general/advanced/lesson_sub_categories"},{name:"estimated_duration",label:lng("estimated duration"),type:"select",grow:10,options:t},{name:"folder_id",label:lng("folder"),type:"component",grow:10,Render:s.p,props:{folderTree:this.folderOptions}},{name:"lesson_author",label:lng("author"),type:"text",grow:10},{name:"lesson_tags",label:lng("tags"),type:"tags",objectType:"Lesson",grow:10}]}save(e){this.extraUrlData.ws&&(e.group_id=this.extraUrlData.ws),super.save(e)}}},5584:(e,t,i)=>{i.d(t,{d:()=>m});var n,r,s=i(7138),o=i(8e3),a=i(5702),l=i(5519),c=i(8567),d=i(7821),p=i(8318);function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let m=(n=d.action.bound,r=class extends s.U{constructor(e){super({...e,baseRoute:"groups",extraUrlData:{type:e.objName,is_course:e.is_course}}),u(this,"params",void 0),this.params=e}createAttributes(){this._fields=[{insert:(0,p.B5)(this.params.originGroup),type:"checkbox",name:"origin_group",label:lng("apply values from the template on the selected fields"),checkboxValue:this.params.originGroup}];const e=[{val:"0",label:lng("visible in home").caps()},{val:"1",label:lng("visible only to managers").caps()},{val:"2",label:lng("not visible").caps()}],t=[{optgroup:!0,label:lng("controlled by managers").caps(),options:[{val:"private",label:lng("private").caps()+" - "+lng("owner only").caps()},{val:"manager_register",label:lng("departmental").caps()+" - "+lng("org' unit managers add their own users").caps()}]},Blsm.isFeatureEnabled("course_registartion")&&{optgroup:!0,label:lng("user registration").caps(),options:[{val:"public",label:lng("public").caps()+" - "+lng("anyone can join").caps()},{val:"register",label:lng("requested").caps()+" - "+lng("requires an approval sequence").caps()}]}];let i=[{val:"",label:lng("off").caps()},{val:1,label:lng("user completes the last %s",lng("assignment")+" / "+lng("meeting")).caps()},{val:2,label:lng("user completes the last %s",lng("assignment")).caps()},{val:3,label:lng("user completes the last %s",lng("meeting")).caps()}];this.attributes=[{type:"tags",name:"tags",label:lng("tags"),objectType:"Group",mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification","workplan"])},{type:"select",name:"status",label:lng("mode").caps(),insert:this.params.showStatusSelection&&this.typeCheck(["group","course"])&&this.serverResponse.authorize_group_seq,options:[{val:"draft",label:lng("draft").caps()},{val:"approval",label:lng("approval").caps()},{val:"",label:lng("approved").caps()}]},{name:"group_invisible",label:lng("status").caps(),type:"select",insert:this.typeCheck(["qualification","group","course","budget","course_template","workplan","patientcase"]),options:e},{name:"classification_id",label:lng("classification").caps(),type:"select",insert:this.typeCheck(["group","course","course_template","qualification","workplan"]),options:this.serverResponse.data.classifications||[],emptyOption:!0},{name:"group_location",label:lng("location").caps(),type:"text",insert:this.typeCheck(["group","course","course_template"]),suggest:{table:"groups"}},{name:"group_gathering_area",label:lng("gathering area").caps(),type:"text",insert:this.typeCheck(["group","course","course_template"]),suggest:{table:"groups"}},{type:"single_item",name:"workplan_id",label:lng("attach to workplan").caps(),theme:"bright",poster:!0,insert:this.typeCheck(["course"])&&Blsm.isFeatureEnabled("workplan"),searchData:(e,t)=>{(0,o.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:["Workplan"],term:e.term,id:e.ids}},t)}},{name:"group_audience",label:lng("audience").caps(),type:"text",insert:this.typeCheck(["group","course","course_template"]),suggest:{table:"groups"}},{name:"estimated_budget",label:lng("estimated budget").caps(),type:"number",insert:Blsm.isFeatureEnabled("resources")&&this.typeCheck(["group","course","course_template"])},{name:"estimated_cost_for_member",label:lng("estimated cost for member").caps(),type:"number",insert:Blsm.isFeatureEnabled("resources")&&this.typeCheck(["group","course","course_template"])},{name:"compliance",label:lng("mark as compliance").caps(),type:"checkbox",insert:Blsm.isFeatureEnabled("compliance_module")&&this.typeCheck(["group","course","course_template","qualification"])},{name:"group_access",label:lng("workspace accessibility").caps(),type:"select",insert:this.typeCheck(["group","course","course_template","qualification"]),options:t},{type:"component",label:lng("automatic enrollment").caps(),name:"autoenrollment_rules",insert:this.typeCheck(["group","course","course_template","qualification","role","workplan"]),Render:a._,value:null,props:{object_type:"users",title:lng("automatic enrollment rules")}},{type:"multiple_items",name:"ou_allocations",poster:!0,theme:"bright",valueIsMap:!0,label:lng("restrict allocations for org' units").caps(),objectKeys:["id","allocation","use_sub_groups"],insert:this.typeCheck(["group","course","course_template","qualification"]),searchData:(e,t)=>{(0,o.SC)("ajax/GroupsAjax.class.php?",{data:{req:"AutoComplete",owned:1,types:["Ou"],term:e.term,id:e.ids}},t)},buttons:[{Render:l.xE,onChange:(e,t)=>{let{value:i}=t;return e.allocation=i,e}},{Render:l.Kz,onChange:e=>(e.use_sub_groups=!e.use_sub_groups,e)}]},{type:"component",label:lng("registration availability conditions").caps(),name:"reg_availability_conditions",insert:this.typeCheck(["group","course","course_template","qualification"]),Render:a._,value:null,props:{object_type:"users",title:lng("registration availability conditions")}},{name:"poster",label:lng("image").caps(),type:"img",insert:!0,value:Blsm.InitialData.random_poster},{name:"hide_in_workspaces",label:lng("hide from users in workspaces").caps(),type:"checkbox",insert:!0},{name:"special_qualification",label:lng("mark these as qualification roles").caps(),type:"checkbox",insert:this.typeCheck(["qualification"])},{name:"hide_score",label:lng("hide score").caps(),type:"checkbox",insert:this.typeCheck(["group","course","course_template","qualification"])},{name:"auto_complete_course",label:lng("publish grades when").caps(),type:"select",insert:this.typeCheck(["group","course","course_template","qualification"]),sub:this.typeCheck(["qualification"])?lng("the grade will be published after completing all the qualifications dependencies").caps():void 0,options:i},{name:"publish_score_when_added",label:lng("publish user score when adding a new user and the user dependencies are completed").caps(),type:"checkbox",insert:this.typeCheck(["qualification"])},{name:"authorization_qualification",label:lng("mark these as authorization qualifications").caps(),type:"checkbox",insert:this.typeCheck(["qualification"])&&Blsm.isFeatureEnabled("authorization_qualification")}].map((e=>({...e,visible:e=>!e.get("origin_group")}))).filter((e=>!!e.insert))}createCustomFields(){super.createCustomFields(),this.custom_fields=this.custom_fields.map((e=>({...e,visible:e=>!e.get("origin_group")})))}applyChangesFromCourseTemplate(){(0,c.BB)(lng("are you sure that you want to apply the changes from the course template on the selected fields?").caps(),{onConfirm:()=>{this.callSave()}})}typeCheck(e){const t=this.serverResponse.data.is_course?"course":this.params.objName;return e.indexOf(t.toLowerCase())>-1}SaveSuccess(){}},g=r.prototype,h="applyChangesFromCourseTemplate",b=[n],v=Object.getOwnPropertyDescriptor(r.prototype,"applyChangesFromCourseTemplate"),_=r.prototype,f={},Object.keys(v).forEach((function(e){f[e]=v[e]})),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,("value"in f||f.initializer)&&(f.writable=!0),f=b.slice().reverse().reduce((function(e,t){return t(g,h,e)||e}),f),_&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(_):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(g,h,f),f=null),r);var g,h,b,v,_,f},2247:(e,t,i)=>{i.d(t,{Ap:()=>v,YP:()=>x,nV:()=>O,oQ:()=>C,oS:()=>Z});var n=i(4210),r=i(7363),s=i(8e3),o=i(6975),a=i(7392),l=i(8318),c=i(4065),d=i(7999),p=i(4576),u=(i(7882),i(5560)),m=i(2334),g=i(8534),h=i(5944);function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const v="---TARGET---";class _ extends n.I{constructor(e){var t;super(e),b(this,"notifications",[]),b(this,"options",{}),b(this,"onSave",void 0),this.params=e,this.notifications=e.notifications,this.options=(0,l.g4)(e.options)||{},this.onSave=e.onSave,this.title=e.sendNow?lng("send notification").caps():lng("create notification").caps(),this.id=null===(t=e.data)||void 0===t?void 0:t.id,this.opr=e.opr,this.confirmButtonLabel=e.confirmButtonLabel||lng("save").caps(),this.sendNow=e.sendNow,this._buildFields(),this._prepFields(e.data||{}),this.ready=!0}save(e){var t;null===(t=this.onSave)||void 0===t||t.call(this,e)}notification(){return this.notifications[this.values.get("notification_name")]||{}}_buildFields(){this.status=this.id?"":"first step";const e=[];for(const[t,i]of Object.entries(this.notifications))e.push({radioValue:t,name:"notification_name",type:"radio",theme:"outlined",MatButtonStyle:{width:"100%"},label:O[t],insert:i.insert||void 0===i.insert,mod:i.mod,disable:i.disable,helpKey:i.helpKey,visible:()=>void 0===i.visible||i.visible(),onValueChange:e=>this.status=e?"":"first step"});this._fields=[{type:"section",title:lng("select notification"),visible:e=>!e.get("notification_name"),fields:e},{type:"hidden",name:"notification_name",required:!0},{type:"section",title:lng("notification settings"),visible:e=>!!e.get("notification_name"),fields:[{type:"component",Render:e=>{let{value:t}=e;return t.get("notification_name")?(0,h.tZ)("div",{style:{textAlign:"center"},children:(0,h.tZ)(a.l,{onClick:()=>(this.updateValue(null,"notification_name"),this.status="first step"),children:O[t.get("notification_name")].caps()})}):""}},{type:"checkbox",name:"repeat",label:lng("repeat according to span")+".",visible:()=>this.notification().repeat,disable:()=>!this.notification().repeat},{type:"row_set",visible:()=>!1!==this.notification().time,fields:[{type:"number",name:"reminder_span",label:lng("amount"),min:0,value:"0"},{type:"select",name:"reminder_type",label:lng("span"),options:[{val:"days",label:lng("days").caps()},{val:"weeks",label:lng("weeks").caps()},{val:"months",label:lng("months").caps()}]}]},{type:"row_set",visible:()=>this.notification().dates,fields:[{type:"date",name:"from",label:lng("from date")},{type:"date",name:"to",label:lng("to date"),disable:()=>this.values.get("to_infinite")},{type:"checkbox",name:"to_infinite",label:lng("infinite"),onValueChange:e=>e&&this.values.set("to","")}]},{type:"row_set",visible:()=>!this.notification().noTarget,fields:x(this,this.options.user_lng,{targetFields:this.options.targetFieldsOptions,targetAuthorities:this.options.targetAuthoritiesOptions,coach:this.options.coach,role_settings:this.options.role_settings})},{type:"checkbox",name:"send_to_all",label:lng("send to all managers"),visible:e=>["role","group"].includes(e.get("target_preselect"))},{type:"system_message",name:"message",getLabel:()=>{var e,t;return lng("select custom message")+(null!==(e=(t=this.notification()).noDefault)&&void 0!==e&&e.call(t)?"":" ("+lng("leave empty for default message")+")")},placeholder:lng("default message").caps(),messageType:()=>(0,l.g4)(this.notifications[this.values.get("notification_name")].messageType,{},["user"===this.values.get("target_preselect")]),messageTypes:()=>{const e=w(this.options.user_lng||lng("the member")),t=(0,l.g4)(this.notifications[this.values.get("notification_name")].messageTypes,{},["user"===this.values.get("target_preselect")]);for(let i in t)t[i][1]===v&&(t[i][1]=()=>e[this.values.get("target_preselect")]);return t},visible:()=>!(!this.notification().message||!this.notification().messageTypes&&!this.notification().messageType),noDefault:()=>{var e,t;return null===(e=(t=this.notification()).noDefault)||void 0===e?void 0:e.call(t)},required:()=>{var e;return!(null===(e=this.notification().validate)||void 0===e||!e.message)},mod:["","ENT"]},{type:"checkbox",name:"sms",label:lng("also send as an SMS message").caps()+(this.options.message?`(${lng("custom message will not be used")})`:""),visible:()=>this.notification().sms,insert:Blsm.InitialData.special.sms,helpKey:"@notification/sms"},{type:"checkbox",name:"limit_to_active_courses",label:lng("limit to members of active courses").caps(),visible:()=>this.notification().limitToActiveCourses},{type:"component",node:(0,h.tZ)(y,{...this}),visible:()=>{var e;return!this.sendNow&&(null===(e=(0,l.g4)(this.params.options))||void 0===e?void 0:e.due_date)}}]}]}}const f={name:"na6dwk",styles:".next-repeat{font-weight:600;}"},y=(0,u.observer)((e=>{let{values:t,params:i,notifications:n}=e;return(0,h.BX)("div",{css:f,children:[(0,h.BX)("div",{className:"next-repeat",children:[lng("next notification:").caps()," ",(()=>{var e,r,s;const o=t.get("repeat")&&parseInt(t.get("reminder_span"))>0,a=(0,m._3)(null===(e=i.options)||void 0===e?void 0:e.call(i).due_date),{opr:l}=n[t.get("notification_name")],c="-"===l&&null!==(r=i.options)&&void 0!==r&&r.call(i).start_date?(0,m._3)(null===(s=i.options)||void 0===s?void 0:s.call(i).start_date):(0,m.WQ)();return(0,m.ER)(t.get("reminder_type"),t.get("reminder_span"),a,l,{repeat:o,stopDate:c,stopAfter:"+"===l})})()||lng("never").caps()]}),t.get("repeat")&&n[t.get("notification_name")].repeat&&(0,h.BX)("span",{children:[lng("repeat every")," ",t.get("reminder_span")," ",t.get("reminder_type")]})]})})),w=e=>({user:e.caps(),authority:lng("authority").caps(),other_user:lng("other user").caps(),group:lng("workspace manager").caps(),role:lng("role").caps(),applicant:lng("applicant").caps()}),x=(e,t,i)=>{const n=(null==i?void 0:i.targetFields)||["user","authority","other_user","group","role"],r=t||lng("the member"),a=w(r),c=Array.isArray(n)?n.map((e=>({val:e,label:a[e]}))):(0,l.wd)(n);let d=(0,p.Gu)(r);const u=(null==i?void 0:i.targetAuthorities)||["manager","users_indirect_manager","users_managers_manager","user_professional_manager","user_hr_manager","personal_coach"],m={manager:d.manager,users_indirect_manager:d.users_indirect_manager,users_managers_manager:d.users_managers_manager,user_professional_manager:d.user_professional_manager,user_hr_manager:d.user_hr_manager,personal_coach:d.personal_coach},g=u.map((e=>({val:e,label:m[e]})));return Blsm.isFeatureEnabled("authorization_qualification")&&g.push({val:"user_auth_supervisor_id",label:d.user_auth_supervisor_id}),null!=i&&i.coach&&g.push({val:"coach",label:lng("%s's assigned coach",r).caps()}),[{type:"text",name:"target_name",visible:()=>!1},{type:"select",name:"target_preselect",label:lng("mode"),options:c},{type:"select",name:"target_authorities",label:lng("select authority"),options:g,visible:e=>"authority"===e.get("target_preselect")},{type:"single_item",name:"target_other_user",label:lng("select user"),required:!0,mod:["","ENT"],visible:e=>"other_user"===e.get("target_preselect"),searchData:(e,t)=>{(0,s.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||""}},t)},onSelect:t=>e.values.set("target_name",t.name)},{type:"single_item",name:"target_group",label:lng("select workspace"),required:!0,visible:e=>"group"===e.get("target_preselect"),searchData:(e,t)=>{(0,s.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",show_all:1,types:["Ou","Group","Qualification"],term:e.term||"",id:e.ids||""}},t)},onSelect:t=>e.values.set("target_name",t.name)},{type:"single_item",name:"target_role",label:lng("select role"),required:!0,mod:["","ENT"],visible:e=>"role"===e.get("target_preselect"),searchData:(e,t)=>{(0,s.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",show_all:1,types:["Role"],term:e.term||"",id:e.ids||""}},t)},onSelect:t=>e.values.set("target_name",t.name)},{type:"indent_set",mod:["","ENT"],insert:!!i.role_settings,fields:[{type:"checkbox",name:"relative_role",label:lng("relative role"),visible:()=>"role"===e.values.get("target_preselect")},{type:"checkbox",name:"manual_approver",label:lng("manual approver for the first step"),visible:()=>"group"===e.values.get("target_preselect")||"role"===e.values.get("target_preselect")},{type:"row_set",visible:()=>"group"===e.values.get("target_preselect")||"role"===e.values.get("target_preselect"),fields:[{type:"checkbox",name:"user_selection",label:lng("allow user selection")},{type:"component",node:(0,h.tZ)(o.JO,{icon:"menu_info",toolTip:lng("when on the first stage, currently only supported in the course catalog")})}]}]}]},k={name:"m3odur",styles:"._buttons{display:flex;flex-direction:column;text-align:center;font-size:1.2rem;*{margin:5px;}}"},Z=e=>{let{value:t,onChange:i,notificationsTypes:n,objectId:o,form:d,options:p={}}=e;const[u,m]=(0,r.useState)(!1),[b,v]=(0,r.useState)(!1),f=(0,l.xh)((0,l.VP)(n,(e=>{return(0,l.g4)(e.sendNow)&&(void 0===(t=e).visible||t.visible());var t})),(e=>({...e,time:!1,repeat:!1})));return(0,h.BX)("div",{css:k,children:[(0,h.BX)("div",{className:"_buttons",children:[(0,h.tZ)(a.l,{onClick:()=>m(!0),theme:"contained",bold:!0,children:lng("add a notification").caps()}),Blsm.checkMod(["","ENT"])&&Object.keys(f).length>0&&(0,h.tZ)(a.l,{theme:"outlined",onClick:()=>v(!0),children:lng("send the notification now").caps()})]}),u&&(0,h.tZ)(c.m,{form:new _({notifications:n,options:p,onSave:e=>{const n=new Map([...t||[]]);n.set((0,l.YR)("notification"),e),i(n),m(!1)}}),onClose:()=>m(!1),internalForm:!0}),b&&(0,h.tZ)(c.m,{form:new _({notifications:f,options:p,onSave:e=>{(0,s.SC)("notifications/send_now",{method:"POST",data:{...e,target_mode:e.target_preselect,form:d,object_id:o},json:!0},(e=>{let{got_message:t,messages_sent_count:i}=e;t>0?(0,g.qV)(i+" "+lng("notifications sent to %s users",t),lng("notifications sent successfully")):(0,g.nb)(lng("no users found matching the criteria"),lng("notifications weren't sent")),v(!1)}))},confirmButtonLabel:lng("send").caps(),sendNow:!0}),onClose:()=>v(!1),internalForm:!0})]})},C=e=>{let{value:t,onChange:i,notificationsTypes:n,options:s={}}=e;const[o,a]=(0,r.useState)(null),p={};if(null!=t&&t.size)for(const[e,i]of t){const t=void 0===n[i.notification_name].visible||n[i.notification_name].visible(),r=void 0===n[i.notification_name].time||n[i.notification_name].time;t&&(p[i.notification_name]||(p[i.notification_name]={list:[],type:i.notification_name}),p[i.notification_name].list.push({key:e,label:(0,h.tZ)(S,{...i,...(0,l.g4)(s),showTime:r})}))}const u=e=>{const n=new Map([...t||[]]);n.delete(e.key),i(n)},m=null!=o&&o.key&&t.has(o.key)?new _({notifications:n,data:{...t.get(o.key),id:o.key},options:s,onSave:e=>{const n=new Map([...t||[]]);n.set(o.key,e),i(n),a(!1)}}):null;return(0,h.BX)(h.HY,{children:[o&&(0,h.tZ)(c.m,{form:m,onClose:()=>a(!1),internalForm:!0}),Object.values(p).map((e=>{var t,i;return(0,h.BX)("div",{style:{marginBottom:"30px"},children:[(0,h.tZ)("div",{style:{fontSize:"1.1em",fontWeight:"600"},children:null===(t=O[e.type])||void 0===t?void 0:t.caps()}),(0,h.tZ)("div",{style:{fontSize:".9em"},children:null===(i=n[e.type].helptip)||void 0===i?void 0:i.caps()}),(0,h.tZ)(d.o,{items:e.list,onRemove:u,onEdit:e=>a(e),separateLines:!0})]},e.type)}))]})},S=e=>{const{reminder_span:t,reminder_type:i,sms:n,showTime:r}=e,s=(e=>{let{target_preselect:t,user_lng:i,target_authorities:n,target_name:r,send_to_all:s,targetFieldsOptions:o}=e;if(o&&(0,l.HD)(o[t]))return o[t];switch(t){case"user":return i||lng("the member").caps();case"authority":return(0,p.Gu)(lng("the member"),!0,"coach"===n)[n];case"other_user":return r||lng("other user");case"group":return(s?lng("workspace managers"):lng("workspace manager"))+": "+r;case"role":return(s?lng("role users"):lng("role"))+": "+r;case"applicant":return lng("applicant");default:return t}})(e);return(0,h.BX)("div",{children:[r&&(0,h.BX)(h.HY,{children:[(0,h.BX)("b",{children:[t," ",lng(i)]}),","]})," ",lng("send to")," ",(0,h.tZ)("b",{children:s})," ",n&&" --sms"]})},O={late_group_completion:lng("reminder for late completion"),before_group_start:lng("reminder before workspace starting date"),after_close_date_reminder:lng("reminder after workspace closing date"),required_period_reminder:lng("reminder for the required period"),after_required_period_reminder:lng("reminder after the required period"),expire_qualification_reminder:lng("reminder for qualification that is about to expire"),expire_qualification_after_reminder:lng("reminder for a qualification that expired"),meeting_absence_reminder:lng("notify about members absent from meetings"),waiting_list_notification:lng("notify about users added to waiting list"),members_added_notification:lng("notify when users are added to workspace"),member_left_notification:lng("notify when a user leaves the workspace"),member_remove_notification:lng("notify when users are removed from the workspace"),feedback_notifications:lng("feedback reminder"),notification:lng("reminder before due date"),after_due_date_notification:lng("reminder after due date"),finish_notifications:lng("notification on assignment success"),failed_notifications:lng("notification on assignment failure"),coach_notifications:lng("reminder after assigning coach"),new_users:lng("new user notification"),returning_users:lng("returning user notifications"),birthdays:lng("birthday message"),away_from_course:lng("course last visit reminders"),sequence_step:lng("reminder for your waiting requests"),approver_changes:lng("approver had changed the request details"),sequence_complete_other_user:lng("approval sequence completed - message to related user"),bookmark:lng("bookmark notification"),challenge_due_date:lng("reminder before due date"),training_needs_after_open:lng("training needs survey has started"),training_needs_before_submit:lng("training needs survey is due"),training_needs_after_review_start:lng("training needs reviewing has start"),training_needs_before_review_end:lng("training needs reviewing is due")}},8621:(e,t,i)=>{i.d(t,{Z:()=>m});var n=i(4210),r=i(8e3),s=i(6975),o=i(7821),a=i(5560),l=i(6920),c=i(2334),d=i(8534),p=i(5944);function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class m extends n.I{constructor(e){super(e),u(this,"group_id",void 0),u(this,"user_id",void 0),u(this,"getNewParticipationPlanningRow",(e=>{const t=(0,a.observer)((function(e){let{value:t}=e;return t?(0,p.tZ)(s.JO,{icon:"menu_info",color:l.g.colors.negative,toolTip:t}):""}));return{type:"row_set",name:e,fields:[{type:"date",name:`participation_planning[${e}][date_from]`,label:lng("from|date"),onBlur:()=>this.checkDates(e),maxDate:()=>moment(this.values.get(`participation_planning[${e}][date_to]`),Blsm.prm.date_moment_format)},{type:"date",name:`participation_planning[${e}][date_to]`,label:lng("to|date"),onBlur:()=>this.checkDates(e),minDate:()=>moment(this.values.get(`participation_planning[${e}][date_from]`),Blsm.prm.date_moment_format)},{type:"component",node:(0,p.tZ)(s.JO,{icon:"trash",buttonLike:!0,onClick:()=>this.removeParticipationPlanningRow(e)})},{type:"component",name:`participation_planning_msg[${e}]`,value:"",Render:t}]}})),u(this,"checkDates",(e=>{const t=this.values.get(`participation_planning[${e}][date_from]`),i=this.values.get(`participation_planning[${e}][date_to]`);if(t&&i){let n="";(0,c._3)(t)<=(0,c._3)(i)?(0,r.SC)("groups/check_participation_planning_dates",{data:{date_from:t,date_to:i,user_id:this.userMode?this.user_id:this.values.get("user_id"),exclude_group:this.group_id||this.values.get("group_id")},method:"POST"},(t=>{if(t.length>0){const i=t.map((e=>e.group_name)),r=i.filter(((e,t)=>i.indexOf(e)===t));n=lng("the user is already occupied on these dates").caps()+` (${r.join()})`,this.values.set(`participation_planning_msg[${e}]`,n)}})):n=lng("the end date %s is before the start date %s",i,t),this.values.set(`participation_planning_msg[${e}]`,n)}})),this._fields=(0,o.observable)([]),this.group_id=e.group_id,this.user_id=e.user_id,this.userMode=!!e.userMode,this.title=lng("edit participation planning"),this.successMessage=lng("participation planning saved"),(0,r.SC)("groups/edit_participation_planning",{data:{user_id:this.user_id,group_id:this.group_id}},(e=>this._buildFields(e)))}_buildFields(e){const t=[];e.participation_planning.forEach(((e,i)=>t.push(this.getNewParticipationPlanningRow(i)))),this._fields.push(this.userMode?{type:"single_item",name:"group_id",label:lng("qualification"),poster:!0,theme:"bright",required:!0,disabled:!!this.group_id,searchData:(e,t)=>{(0,r.SC)("groups/autocomplete",{method:"POST",json:!0,data:{show_all:1,owned:1,types:"Qualification",term:e.term,id:e.ids||""}},t)}}:{type:"single_item",name:"user_id",label:lng("select user"),poster:!0,theme:"bright",required:!0,disabled:!!this.user_id,searchData:(e,t)=>{(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term,id:e.ids||""}},t)}},{type:"number",name:"required_days",label:lng("required days")},{type:"component",node:(0,p.BX)(p.HY,{children:[(0,p.tZ)("b",{children:lng("participation planning").caps()})," ",(0,p.tZ)(s.JO,{icon:"new",buttonLike:!0,onClick:()=>this.addParticipationPlanningRow()})]})},{type:"section",name:"participation_planning",fields:t}),this._prepFields(e),this.ready=!0}addParticipationPlanningRow(){this._fields.map((e=>{"section"===e.type&&"participation_planning"===e.name&&e.fields.push(this.getNewParticipationPlanningRow(Math.random()))}))}removeParticipationPlanningRow(e){this._fields.map((t=>{"section"===t.type&&"participation_planning"===t.name&&t.fields.map((i=>{i.name===e&&(t.fields.remove(i),this.values.delete(`participation_planning[${e}][date_from]`),this.values.delete(`participation_planning[${e}][date_to]`),this.values.delete(`participation_planning_msg[${e}]`))}))}))}save(e){var t,i;let n=!!e&&Object.values((null==e?void 0:e.participation_planning)||{}).filter((e=>!!e));n&&null!=n&&null!==(t=n[0])&&void 0!==t&&t.date_from&&null!=n&&null!==(i=n[0])&&void 0!==i&&i.date_to?this.saveToUrl(`groups/save_participation_planning/group_id=${e.group_id||this.group_id}`,{...e,user_id:this.userMode?this.user_id:e.user_id}):(0,d.Mj)(lng("please add planned dates"))}}},6401:(e,t,i)=>{i.d(t,{y:()=>o});var n=i(4210),r=i(7821);function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class o extends n.I{constructor(e){super(e),s(this,"groupId",null),s(this,"poll",{});const{data:t}=e;this.poll=t.poll,this.groupId=t.groupId,this.title=this.poll.assignment_id?lng("edit poll").caps():lng("new poll").caps();const i=[[3,lng("all results").caps()],[1,lng("nothing").caps()]];this._fields=[{type:"text",name:"question",label:lng("question"),required:!0},{type:"text",name:"choices[0]",label:lng("answer")+" 1",required:!0},{type:"text",name:"choices[1]",label:lng("answer")+" 2",required:!0},{type:"text",name:"choices[2]",label:lng("answer")+" 3"},{type:"text",name:"choices[3]",label:lng("answer")+" 4"},{type:"select",name:"assignment_options[after_test]",label:lng("after submitting answers show"),options:i},{type:"date",name:"due_date",label:lng("due date"),cls:"unlimited-date"},{type:"select",name:"assignment_options[when_expires]",label:lng("after due date show"),options:i}];const{question:n,choices:o,due_date:a,assignment_options:l}=this.poll;this._prepFields({due_date:a,question:n,choices:(0,r.toJS)(o),assignment_options:(0,r.toJS)(l)}),this.ready=!0}save(e){this.poll.save(Object.assign({group_id:this.groupId},e),this.onSaveSuccess)}}},5367:(e,t,i)=>{i.d(t,{S:()=>f});var n=i(4210),r=i(6975),s=i(5007),o=i(9523),a=i(8e3),l=i(9431),c=i(6421),d=i(7363),p=i(6920),u=i(917),m=i(8318),g=i(8567),h=i(9793),b=i(8555),v=i(5944);function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class f extends n.I{constructor(e){let{portalStore:t,...i}=e;super(i),_(this,"portals",null),this.title=lng("portal settings"),this.portalStore=t;const{portal_type:n,parent_type:s,portal_id:c}=t;this.saveUrl=`portal/portal/${c}`,this.successMessage=lng("settings saved");const d=Object.assign({},t);d.style=JSON.parse(JSON.stringify(d.style)),this._fields=[{type:"hidden",name:"portal_id"},{type:"hidden",name:"portal_type"},{type:"hidden",name:"group_id"},{type:"hidden",name:"parent_id"},{type:"component",node:(0,v.BX)(v.HY,{children:[lng("set background image")," ",(0,v.tZ)(r.JO,{icon:"menu_info",toolTip:lng("an abstract photo of size %s or more is recommended as the image may be cropped differently on different devices",(0,o.j4)()+"1280×720"+(0,o.Rh)()).caps()})]})},{type:"img",tabs:["portal","images","gallery"],removeButton:!0,name:"poster"},{type:"text",name:"portal_title",label:lng("name"),required:!0,maxLength:500},{type:"number",name:"portal_order",label:lng("priority"),insert:[l.Bu.DOMAIN,l.Bu.GROUP,l.Bu.APP,l.Bu.ANONYMOUS].includes(n)},{type:"checkbox",name:"sub_groups",label:lng("include sub workspaces").caps(),insert:n===l.Bu.GROUP},{type:"checkbox",name:"portal_active",label:n===l.Bu.ANONYMOUS?lng("activate for anonymous users").caps():lng("activate for users").caps()},{insert:[l.Bu.DOMAIN,l.Bu.APP].includes(n)||[l.Bu.DOMAIN,l.Bu.APP].includes(s),type:"multiple_items",name:"group_ids",label:lng("available to members of"),placeholder:lng("all"),poster:!0,theme:"bright",searchData:(e,t)=>{(0,a.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",catalog:1,term:e.term||"",id:e.ids||""}},t)}},{insert:[l.Bu.DOMAIN,l.Bu.APP].includes(n)||[l.Bu.DOMAIN,l.Bu.APP].includes(s),type:"checkbox",name:"sub_groups",label:lng("include sub workspaces").caps(),visible:e=>{var t;return(null===(t=e.get("group_ids"))||void 0===t?void 0:t.length)>0}},{insert:[l.Bu.DOMAIN,l.Bu.APP].includes(n)||[l.Bu.DOMAIN,l.Bu.APP].includes(s),type:"checkbox",name:"available_to_managers",label:lng("include managers").caps(),visible:e=>{var t;return(null===(t=e.get("group_ids"))||void 0===t?void 0:t.length)>0}},{type:"color",clear_button:!0,cls:"input_short",name:"style[widgets_title_color]",label:lng("widget title color")},{type:"color",alpha:!0,clear_button:!0,name:"style[widgets_title_bgc]",label:lng("widget title background color")},{type:"color",clear_button:!0,name:"style[widgets_fgc]",label:lng("widget text color")},{type:"color",alpha:!0,clear_button:!0,name:"style[widgets_bgc]",label:lng("widget background color")},{type:"title",label:lng("strip image"),props:{large:!0}},{type:"component",name:"style[portal_slider]",Render:y,props:{styleData:d.style}},{type:"number",name:"style[portal_slider_timer]",min:0,label:lng("banner timer").caps(),unit:"seconds"}],this._prepFields(d),Blsm.user.isPowerManager&&c&&(this.headExtra=(0,v.tZ)(h.b,{children:(0,v.tZ)(r.JO,{icon:"history",className:"task-button",href:(0,b.TK)("portals",c),newTab:!0,toolTip:lng("activity log").caps()})})),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,e)}SaveSuccess(e){(0,s.vm)().closeDialog(),this.portalStore.parent_style.portal_slider=this.values.get("style[portal_slider]"),null!=e&&e.portal_id&&this.portalStore.updateVals(Object.fromEntries(this.values))}}const y=e=>{let{onChange:t,styleData:i}=e,n=[];const{portal_slider:s,strip_img_mobile:a,strip_img_desktop:l,strip_img_link:p}=i;(s||[{img_mobile:a||"",img_desktop:l||"",link:p||""}]).forEach(((e,t)=>n[t]=e));const[u,h]=(0,d.useState)(n),[b,_]=(0,d.useState)(0),[f,y]=(0,d.useState)(""),[x,k]=(0,d.useState)(""),[Z,C]=(0,d.useState)("");s||t(u),(0,d.useEffect)((()=>{const e=u[b];C(e.link),y(e.img_desktop),k(e.img_mobile)}),[b]);const S=(e,i)=>{const n=u[b];"img_desktop"===i&&(n.img_desktop=e),"img_mobile"===i&&(n.img_mobile=e),"link"===i&&(n.link=e),u[b]=n,t(u)};return(0,v.BX)("div",{css:w,children:[(0,v.BX)("div",{className:"banner-tabs",children:[u.map(((e,t)=>(0,v.tZ)("div",{onClick:()=>_(t),className:(0,m.AK)("tab",t,{selected:t===b}),children:`${lng("image").caps()} ${t+1}`},t))),(0,v.tZ)("div",{className:"add-tab-btn",onClick:()=>(h([...u,{img_mobile:"",img_desktop:"",link:""}]),n=[...u,{img:"",link:""}]),children:(0,v.tZ)(r.JO,{icon:"mark_plus"})})]}),(0,v.BX)("div",{className:"banner-content",children:[(0,v.BX)("div",{className:"media",children:[u.length>1&&(0,v.tZ)("div",{className:"trash-image",children:(0,v.tZ)(r.JO,{buttonLike:!0,icon:"trash",onClick:()=>(0,g.BB)(lng("are you sure you want to delete this item"),{onConfirm:()=>(()=>{const e=u.filter(((e,t)=>t!==b));h(e),t(e),_(Math.min(b,e.length-1));const i=e[b];C(null==i?void 0:i.link),y(null==i?void 0:i.img_desktop),k(null==i?void 0:i.img_mobile)})(),confirmText:lng("delete")})})}),(0,v.BX)("div",{children:[(0,v.tZ)("div",{className:"strip-title",children:`${lng("desktop").caps()} ${(0,o.j4)()}(1300×200-1900×300)`}),(0,v.tZ)(c.I,{type:"img",name:"img_desktop",value:f,removeButton:!0,onChange:e=>(y(e),S(e,"img_desktop"))})]},f),(0,v.BX)("div",{children:[(0,v.tZ)("div",{className:"strip-title",children:`${lng("mobile").caps()} ${(0,o.j4)()}(320×200)`}),(0,v.tZ)(c.I,{type:"img",name:"img_mobile",value:x,removeButton:!0,onChange:e=>(k(e),S(e,"img_mobile"))},x)]})]}),(0,v.tZ)(c.I,{type:"text",label:lng("link"),wrapped:!0,value:Z,onChange:e=>(C(e),S(e,"link"))})]})]})},w=(0,u.iv)(".banner-tabs{display:flex;margin-bottom:15px;flex-flow:wrap;border-bottom:1px solid ",p.g.colors.separator,";padding-bottom:10px;.add-tab-btn{display:flex;width:30px;height:30px;justify-content:center;align-items:center;border-radius:8px;color:",p.g.colors.dominant_main,";border:1px solid ",p.g.colors.dominant_main,";&:hover{cursor:pointer;}}.tab{color:",p.g.colors.dominant_main,";margin:5px;&:hover{cursor:pointer;}&.selected{border-bottom:1px solid ",p.g.colors.dominant_main,";}}}.banner-content{.media{position:relative;display:flex;justify-content:space-around;.trash-image{position:absolute;top:10px;",p.g.classes.far("10px"),";}.strip-title{text-align:center;}}}","")},7675:(e,t,i)=>{i.d(t,{O:()=>o});var n=i(4210),r=i(8e3);function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class o extends n.I{constructor(e){super(e),s(this,"objectType",void 0);const{title:t,object_type:i,object_id:n,confirmButtonLabel:o}=e;this.objectId=n,this.objectType=i,this.title=t||lng("recommend").caps(),this.confirmButtonLabel=o||lng("send recommendations").caps(),this.saveUrl="social/recommend",this._fields=[{type:"multiple_items",name:"ids",label:lng("select users"),poster:!0,theme:"bright",searchData:(e,t)=>{let{term:i,ids:n}=e;(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",exclude:this.values.get("ids"),term:i,id:n||"",exclude_self:1}},t)}},{type:"richtext",name:"custom_message",label:`${lng("add message")} (${lng("optional")})`,toolbarOptions:{font:!0,color:!0,link:!0,list:!0,align:!0}}],this.ready=!0}save(e){this.saveToUrl(this.saveUrl,{object_id:this.objectId,object_type:this.objectType,...e})}}},2267:(e,t,i)=>{i.d(t,{sS:()=>we,A_:()=>ve,tG:()=>ue,Sj:()=>ge});var n,r,s=i(7363),o=i(917),a=i(8318),l=i(7821),c=i(5560),d=i(3051),p=i(5898),u=(i(7882),i(6920)),m=i(9180),g=i(441),h=i(7154),b=i(6975),v=i(4238),_=i(2213),f=i(7073),y=i(4902),w=i(6421),x=i(8e3),k=i(5007),Z=i(7376),C=i(5405),S=i(9483),O=i(8567),B=i(6633),T=i(7392),N=i(2755),I=i(9793),D=i(8989),j=i(2808),P=i(2334),z=i(4210);let E=(n=l.action.bound,r=class extends z.I{constructor(e){super(e),(0,l.makeObservable)(this),this.params=e,this.title=lng("add existing task as sub task").caps(),this._build_fields(e)}_build_fields(e){this._fields=[{type:"single_item",name:"task",label:lng("task",{phrase:!0}),required:!0,searchData:(t,i)=>{var n;const r=[e.pid].concat(null===(n=e.exclude)||void 0===n?void 0:n.map((e=>e.task_id)));(0,x.SC)("search/tasks",{data:{req:"AutoComplete",term:t.term||"",id:t.ids,no_parents:1,exclude:r,group:e.ws},method:"POST"},i)}}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("tasks/set_parent",{task:e.task,parent:this.params.pid})}SaveSuccess(e){(0,k.vm)().closeDialog(),this.params.add(e)}},R=r.prototype,F="SaveSuccess",M=[n],A=Object.getOwnPropertyDescriptor(r.prototype,"SaveSuccess"),q=r.prototype,X={},Object.keys(A).forEach((function(e){X[e]=A[e]})),X.enumerable=!!X.enumerable,X.configurable=!!X.configurable,("value"in X||X.initializer)&&(X.writable=!0),X=M.slice().reverse().reduce((function(e,t){return t(R,F,e)||e}),X),q&&void 0!==X.initializer&&(X.value=X.initializer?X.initializer.call(q):void 0,X.initializer=void 0),void 0===X.initializer&&(Object.defineProperty(R,F,X),X=null),r);var R,F,M,A,q,X,L=i(5944);const $=(0,o.iv)(">img{max-width:100%;max-height:100%;}>._ext{font-weight:700;text-align:center;.Icon{font-size:1.5rem;}}>._label{",u.g.classes.ellipsis,";position:absolute;bottom:0;left:0;width:100%;background:rgba(255, 255, 255, .7);padding:2px;font-size:.7em;div{display:block;}._btn{",u.g.classes.ellipsis,";}}",""),V=e=>{let{file:t,assignmentId:i}=e;const{file_name:n,creation_time:r,file_size:s}=t,o=(0,j.BX)(n);return(0,L.BX)("div",{css:$,className:"FileThumbnail",ref:e=>null!=e&&e.dataset?e.dataset.thumbnail=JSON.stringify(t):void 0,children:[Blsm.prm.extensions.img.includes(o)?(0,L.tZ)("img",{src:(0,g.p4)({file:t,assignmentId:i})}):(0,L.BX)("div",{className:"_ext",children:[(0,L.tZ)(b.JO,{icon:(0,j.DW)(o)}),(0,L.tZ)("br",{}),o.toUpperCase()]}),(0,L.tZ)("div",{className:"_label",children:(0,L.BX)(h.u,{html:(0,L.BX)(L.HY,{children:[(0,L.tZ)("div",{children:n}),(0,L.tZ)(m.qp,{time:r}),(0,L.tZ)("div",{children:s})]}),children:[n,", ",(0,L.tZ)(m.ij,{time:r}),s?", "+s:""]})})]})};var U,H,J,G,W,K,Y,Q,ee,te,ie,ne=i(8534),re=i(5680),se=i(7166),oe=i(9159),ae=i(8555);function le(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ce(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function de(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const pe="task";let ue=(U=l.action.bound,H=l.action.bound,J=l.action.bound,G=class e extends f.Z{constructor(e){let{route:t,nav:i}=e;super({route:t,nav:i}),ce(this,"drawer",!0),ce(this,"commentsStore",null),ce(this,"managersCommentsStore",null),le(this,"showManagersComments",W,this),le(this,"moreFields",K,this),ce(this,"group_id",null),ce(this,"flags",{}),le(this,"bookmark",Y,this),le(this,"notification",Q,this),le(this,"subTasks",ee,this),ce(this,"notification_change",!1),le(this,"task_status",te,this),le(this,"richTextRefreshKey",ie,this),(0,l.makeObservable)(this);const[n,r]=t;if(this.params=n,(0,a.B5)(null==r?void 0:r.c)&&(this.gotoComment=parseInt(r.c)),this._id=(0,a.B5)(n)?n:0,!this._id&&(this.createMode=!0,!n.ws))return this.error="workspace missing";this.fetchUrl=`tasks/edit/${(0,a.$t)({id:this._id,ws:n.ws})}`,this.saveUrl=`tasks/save/${(0,a.$t)({id:this._id,ws:n.ws})}`,this.saveAsJson=!0,this.fetch()}get alertBeforeClose(){var e,t;return!!(null!==(e=this.commentsStore)&&void 0!==e&&e.dirty||null!==(t=this.managersCommentsStore)&&void 0!==t&&t.dirty)&&lng("you have written a comment, do you want to discard it?")}static matchForm(t,i){let{nav:n}=i;const[r,...s]=t;if(r===pe)return new e({route:s,nav:n})}_acceptDataFromServer(e){var t;const{task:i,is_group_manager:n,group_id:r,members_can_set_status:s,progress_percent:o}=e;this.bookmark=i.bookmarked,this.subTasks=(null===(t=i.sub_tasks)||void 0===t?void 0:t.map((e=>(e.task_type_color=(0,a.Mo)(e.task_type_colors,[])[0],e))))||{},Object.assign(this.notification,i.notification),Object.assign(this.subTasks,i.sub_tasks),this.show_progress=parseInt(o)>0&&(Blsm.user.isManager||1===parseInt(o)),this.group_id=r,this.flags.is_group_manager=!0===n,this.flags.can_update=i.may_edit||!i.task_id,this.flags.may_edit=i.may_edit,this.flags.taskLocked=i.task_locked&&!this.flags.can_update,this.flags.can_change_status=this.flags.can_update||s||(0,a.Tz)(i.allocated_to),this.flags.can_change_status||(this.confirmButtonLabel=!1);const l=D.X.get("create_task_from_comment");if((0,a.Dw)(l)&&(i.task_description=l.task_description,i.parent_task=l.parent_task_id,i.parent_title=l.parent_title,window.localStorage.removeItem("create_task_from_comment")),this.loadTaskData(i),this.buildFields(),this._prepFields(i),this.ready=!0,this._id){const e=new CustomEvent("TaskFormReady",{detail:{task_id:this._id}});document.body.dispatchEvent(e)}}loadTaskData(e){if(this._windowTitle=this.title=this.createMode?lng("new task").caps():e.task_title.caps(),this._id){if(this.commentsStore=this.commentsStore||new _.pE({type:"task",object_id:this._id}),this.flags.is_group_manager&&(this.managersCommentsStore=this.managersCommentsStore||new _.pE({type:"task_manager",object_id:this._id})),this.gotoComment){const e=(e,t)=>{this.gotoComment&&("task_manager"!==e.type&&"task_manager"!==(null==t?void 0:t.type)||(this.showManagersComments=!0),e.scrollTo=!0,this.gotoComment=null)};this.commentsStore.findComment(this.gotoComment,e),this.flags.is_group_manager&&this.managersCommentsStore.findComment(this.gotoComment,e)}this.headExtra=(0,L.tZ)(Ze,{form:this});let t=D.X.get("recent_tasks_"+Blsm.user.id)||[];Array.isArray(t)||(t=[]),t=t.filter((e=>e!=this._id)),t.unshift(+this._id),t=t.slice(0,50),D.X.set("recent_tasks_"+Blsm.user.id,t);const i=(0,k.vm)();if(i.hasStore("tasks")){const t=i.getStore("tasks",void 0,{onlyIfExists:!0});null==t||t.addToRecentTasks(e)}setTimeout((()=>this.listenToNotifications()),1e3)}}listenToNotifications(){const e=k.Nd.once("FetchNotifications",(e=>{e.forEach((e=>{e.data.task_id===this._id&&"update"===e.data.action&&"conflict"!==this.status&&!1!==this.ready&&(console.warn("outdated task from notifications",e.data),this.confirmButtonLabel=lng("outdated").caps(),this.status="conflict",(0,ne.LB)({msg:lng("this task was changed by someone else and is outdated.")+" "+lng("refresh to update.").caps(),type:"warning",closeOnClick:!0}))}))}));(0,l.autorun)((()=>{!1===this.ready&&(null==e||e())}))}buildFields(){var e,t,i;const n=(e,t)=>(e.get(t)&&this.moreFields.set(t,!0),this.moreFields.get(t)),r=(0,c.observer)((()=>{let e=[{val:"condition_task",label:lng("condition"),attr:{"data-val":"condition_task"}},{val:"parent_task",label:lng("parent"),attr:{"data-val":"parent_task"}},{val:"duplicate_task",label:lng("duplicated task"),attr:{"data-val":"duplicate_task"}}].concat(this.serverResponse.custom_fields.map((e=>({val:e.field_column,label:e.field_name,attr:{"data-val":e.field_column}}))));return e=e.filter((e=>!this.moreFields.has(e.val))),this.subTasks.length>0&&(e=e.filter((e=>"parent_task"!=e.val))),e.length?this.flags.can_update?(0,L.tZ)(d.x,{options:e,onSelect:e=>this.moreFields.set(e,!0),inForm:!0,children:(0,L.BX)(T.V,{theme:"contained",onClick:()=>null,className:"addfield",children:[(0,L.tZ)(b.JO,{icon:"mark_plus_light"})," ",lng("add field").caps()]})}):(0,L.BX)(T.V,{theme:"contained",disabled:!0,onClick:()=>null,className:"addfield",children:[(0,L.tZ)(b.JO,{icon:"mark_plus_light"})," ",lng("add field").caps()]}):null})),s=(0,l.observable)(this.serverResponse.task.files||[]),o=e=>{Array.prototype.forEach.call(e.target.files,(e=>{this._id?(0,x.SC)("file/"+(0,a.$t)({task_id:this._id}),{method:"POST",data:{file:e}},(e=>{s.push(e)})):(0,x.SC)("ajax/requests.php?req=LoadTempFile",{method:"POST",data:{file:e,key:"file",options:{type:"attachment"}}},(e=>{if((0,a.P$)(e.res)){const{full:t,name:i,size:n}=e;s.push({file_name:i,file_id:t,temp:!0,creation_time:(0,a.c7)(),file_size:n});let r=this.values.get("tmp_files")||[];r.push(e),this.updateValue(r,"tmp_files")}}))}))},p=(0,l.observable)(this.serverResponse.task.mailing_list||[]),m=e=>{const t=p.map((e=>parseInt(e.user_id)));e.length===t.length&&e.filter((e=>t.includes(e))).length===t.length||(0,x.SC)("mailinglist/sync",{data:{task_id:this._id,list:e}},(e=>{p.replace(e)}))},h=(0,c.observer)((()=>{const e=(0,l.observable)(new Set(p.map((e=>parseInt(e.user_id)))||[])),t=(0,c.observer)((e=>{var t;let{checked:i}=e;return(0,L.tZ)("div",{children:null===(t=this.serverResponse.users)||void 0===t?void 0:t.map((e=>{let{full_name:t,user_id:n}=e;return(0,L.BX)("div",{children:[(0,L.tZ)(w.I,{type:"checkbox",value:i.has(n),onChange:e=>{e?i.add(n):i.delete(n)}}),t]},n)}))})}));return(0,L.tZ)(L.HY,{children:(0,L.BX)("span",{children:[e.has(Blsm.user.id)&&(0,L.BX)(T.V,{theme:"contained",style:{fontSize:".8em"},onClick:()=>{(0,O.BB)(lng("are you sure that you want to remove yourself from the mailing list?").caps(),{onConfirm:()=>{e.delete(Blsm.user.id),m([...e])}})},children:[(0,L.tZ)(b.JO,{icon:"inactive_user"})," ",lng("remove myself").caps()]}),(0,L.BX)(T.V,{theme:"contained",style:{fontSize:".8em"},onClick:()=>(0,k.vm)().openDialog("Component",{title:lng("add/remove users from mailing list"),width:"400px",child:(0,L.tZ)(t,{checked:e})},{onClose:t=>{m([...e]),t()}}),children:[(0,L.tZ)(b.JO,{icon:"group"})," ",lng("add/remove users").caps()]})]})})})),_=this.subTasks,f={font:!0,color:!0,link:!0,attach:!0,list:!0,media_link:!0};this._fields=[{type:"text",name:"task_title",label:lng("title"),required:!0,maxLength:Math.max(110,(null===(e=this.serverResponse)||void 0===e||null===(t=e.task)||void 0===t||null===(i=t.task_title)||void 0===i?void 0:i.length)||0),autoDir:!0,disable:!this.flags.can_update},this.typeRow(),{type:"component",Render:ve,name:"status_id",props:{tasks_status:this.serverResponse.tasks_status,disable:!(this.flags.can_change_status||this.flags.can_update)}},{type:"richtext",name:"task_description",label:lng("description"),disable:!this.flags.can_update,refreshKey:()=>this.richTextRefreshKey+"",onValueChange:(e,t)=>{var i;return this.updateValue((null===(i=t.commands)||void 0===i?void 0:i.length)>0?t.commands:void 0,"task_description_commands")},toolbarOptions:{font:!0,color:!0,link:!0,attach:!0,list:!0,media_link:!0,upload:"task",popout:!0}},{type:"tags",name:"tags",label:lng("tags"),objectType:"Task",disable:!this.flags.can_update},{type:"component",Render:De,name:"task_checklist",props:{canUpdate:this.flags.can_update,updateProgress:e=>this.updateValue(e,"progress_percent")}},{type:"section",title:lng("settings"),titleSmall:!0,titleIcon:"settings",titleExtra:(0,L.tZ)(r,{}),fields:[this.assigneeRow(),this.datesRow(),this.checkboxRow(),this.connectRow(n)].concat(this._customFieldsPrep(this.serverResponse.custom_fields,{columns:3,visible:n,disable:!this.flags.can_update}))},{type:"section",column:1,title:lng("attachments"),titleSmall:!0,titleIcon:"attachment",titleExtra:this.flags.can_update&&(0,L.tZ)("label",{children:(0,L.BX)(T.V,{theme:"contained",style:{fontSize:".8em"},onClick:()=>null,children:[(0,L.tZ)(b.JO,{icon:"mark_plus_light"})," ",lng("add file").caps(),(0,L.tZ)("input",{type:"file",name:"file",multiple:!0,onChange:e=>o(e),style:{opacity:0,width:0}})]})}),fields:[{type:"component",Render:we,props:{files:s}},{type:"range",name:"progress_percent",label:lng("task progress"),sign:"%",min:0,insert:this.show_progress,value:this.progress_percent?this.progress_percent:"0",onValueChange:e=>this.values.set("progress_percent",e)}]},{type:"section",title:lng("mailing list"),insert:!!this._id,titleSmall:!0,titleIcon:"notifications",titleExtra:this.flags.may_edit&&(0,L.tZ)(h,{}),fields:[{type:"component",node:(0,L.tZ)(c.Observer,{children:()=>p.length?(0,L.tZ)(y.I9,{users:p,totalCount:p.length,maxSlots:10}):lng("no one else will know!").caps()})}]},{type:"section",title:lng("sub tasks"),insert:!!this._id,visible:()=>!this.values.get("parent_task"),titleSmall:!0,titleIcon:"checkbox_checked",titleExtra:this.flags.can_update&&(0,L.tZ)(L.HY,{children:(0,L.BX)("span",{children:[(0,L.BX)(T.V,{theme:"contained",onClick:()=>(0,k.vm)().openDialog("form",new E({ws:this.group_id,pid:this._id,exclude:this.subTasks,add:e=>_.push(e)})),children:[(0,L.tZ)(b.JO,{icon:"mark_plus_light"})," ",lng("add sub task").caps()]}),(0,L.BX)(T.V,{theme:"contained",style:{fontSize:window.innerWidth>370?".8em":".6em"},onClick:()=>this.dirty?Blsm.Alert(lng("please save changes")):(0,g.p4)({edit:"task",params:{ws:this.group_id,pid:this._id}},!0),children:[(0,L.tZ)(b.JO,{icon:"mark_plus_light"})," ",lng("new sub task").caps()]})]})}),fields:[{type:"component",node:(0,L.tZ)(Se,{tasks:this.subTasks,manager:this.flags.is_group_manager,onDelete:e=>_.splice(_.indexOf(e),1)})}]},{type:"section",column:1,title:lng("comments"),insert:!!this._id,titleSmall:!0,titleIcon:"discussion",titleExtra:this.flags.is_group_manager&&!(0,a.tq)()&&(0,L.tZ)(c.Observer,{children:()=>{var e;return(0,L.BX)(T.V,{theme:"contained",style:{fontSize:".8em"},onClick:()=>this.showManagersComments=!this.showManagersComments,active:this.showManagersComments,children:[(0,L.tZ)(b.JO,{icon:"manager"})," ",lng("manager comments").caps()," (",null===(e=this.managersCommentsStore)||void 0===e?void 0:e.size,")"]})}}),fields:[{type:"component",Render:Be,form:this},{type:"component",node:(0,L.tZ)(c.Observer,{children:()=>(0,L.tZ)(v.H,{locked:this.flags.taskLocked,richTextOptions:f,commentsStore:this.commentsStore,connectTo:{type:"task",object_id:this._id},titles:{parent_title:this.serverResponse.task.parent_title,title:this.title},refresh:!0,labels:this.flags.is_group_manager,createTask:Blsm.user.isManager,createSubTask:!this.values.get("parent_task"),createSiblingTask:this.values.get("parent_task"),onChangeType:()=>this.managersCommentsStore.fullRefresh()})}),visible:()=>!this.showManagersComments},{type:"component",node:(0,L.tZ)(c.Observer,{children:()=>(0,L.tZ)(v.Y.Provider,{value:{bgColor:u.g.darkMode?"#4a3c27":"#fdf1de"},children:(0,L.tZ)(v.H,{richTextOptions:f,commentsStore:this.managersCommentsStore,connectTo:{type:"task_manager",object_id:this._id},titles:{parent_title:this.serverResponse.task.parent_title,title:this.title},refresh:!0,labels:this.flags.is_group_manager,createTask:Blsm.user.isManager,createSubTask:!this.values.get("parent_task"),createSiblingTask:this.values.get("parent_task"),onChangeType:()=>this.commentsStore.fullRefresh()})})}),visible:()=>this.showManagersComments,insert:this.flags.is_group_manager},{type:"component",node:(0,L.tZ)("div",{children:lng("the task has been locked for new comments. if necessary, you can open a new task.").caps()}),insert:this.flags.taskLocked}]},{type:"component",node:(0,L.tZ)(Ne,{form:this}),insert:!!this._id}]}connectRow(e){return{type:"row_set",fields:[{type:"single_item",name:"condition_task",disable:!this.flags.can_update,label:lng("condition"),visible:e,searchData:(e,t)=>{(0,x.SC)("tasks/search",{data:{ws:this.group_id,exclude:this._id,term:e.term,id:e.ids}},t)},buttons:[{Render:this.taskLink}]},{type:"single_item",name:"parent_task",disable:!this.flags.can_update,label:lng("parent"),value:this.params.pid,visible:e,searchData:(e,t)=>{(0,x.SC)("tasks/search",{data:{ws:this.group_id,parent:1,exclude:this._id,term:e.term,id:e.ids}},t)},buttons:[{insert:!1,Render:this.newSiblingTask,props:{group_id:this.group_id,visible:!!this._id}},{Render:this.taskLink}]},{type:"single_item",name:"duplicate_task",disable:!this.flags.can_update,label:lng("duplicated task"),visible:e,searchData:(e,t)=>{(0,x.SC)("tasks/search",{data:{exclude:this._id,term:e.term,id:e.ids}},t)},buttons:[{Render:this.taskLink}]}]}}checkboxRow(){return{type:"row_set",insert:this.flags.is_group_manager,skinny:!0,fields:[{type:"checkbox",name:"manager_only",label:lng("manager only"),disable:!this.flags.can_update},{type:"checkbox",name:"task_locked",label:lng("lock for members"),disable:!this.flags.can_update},{type:"checkbox",name:"archive",label:lng("archive|verb"),disable:!this.flags.can_update},{type:"checkbox",name:"skip_notifications",label:lng("notify"),insert:this.flags.is_group_manager,reversed:!0}]}}datesRow(){return{type:"row_set",fields:[{type:"date_time",name:"start_date",label:lng("start date"),disable:!this.flags.can_update},{type:"date_time",name:"due_date",label:lng("due date"),disable:!this.flags.can_update}]}}taskLink(e){let{item:t}=e;return(0,L.tZ)(b.JO,{icon:"enter",onClick:()=>this.dirty?Blsm.Alert(lng("please save changes")):(0,g.p4)({edit:"task",id:t.id},!0)})}newSiblingTask(e){let{item:t,group_id:i,visible:n}=e;return n&&(0,L.tZ)(b.JO,{icon:"new",toolTip:lng("new sibling task"),onClick:()=>this.dirty?Blsm.Alert(lng("please save changes")):(0,g.p4)({edit:"task",params:{ws:i,pid:t.id}},!0)})}assigneeRow(){return{type:"row_set",fields:[{type:"select",name:"allocated_to",label:lng("assignee"),disable:!(this.flags.can_change_status||this.flags.can_update),emptyOption:!0,options:[{optgroup:!0,label:lng("managers").caps(),options:this.serverResponse.users.filter((e=>e.is_manager)).map((e=>({val:e.user_id,label:e.full_name})))},{optgroup:!0,label:lng("members").caps(),options:this.serverResponse.users.filter((e=>!e.is_manager)).map((e=>({val:e.user_id,label:e.full_name})))}],value:this._id?void 0:this.serverResponse.default_assignee,required:!0},{type:"select",name:"priority",label:lng("priority"),insert:this.flags.is_group_manager,options:(0,a.wd)(Blsm.InitialData.parameters.priority),emptyOption:!0},{type:"select",name:"severity",label:lng("severity"),options:(0,a.wd)(Blsm.InitialData.parameters.severity),emptyOption:!0,disable:!this.flags.can_update}]}}typeRow(){return{type:"row_set",fields:[{type:"component",Render:fe,grow:3,props:{...this.serverResponse,reload:()=>this.nav([pe,this._id],{replace:!0,trigger:!0}),can_edit:this.flags.is_group_manager&&!!this._id&&(this.flags.can_change_status||this.flags.can_update),isDirty:()=>this.dirty}},{type:"component",Render:ge,name:"task_type_id",props:{tasks_types:this.serverResponse.tasks_types,task_id:this.serverResponse.task.task_id,disable:!this.flags.can_update},grow:1,align:u.g.far,label:lng("task type"),required:!0}]}}SaveSuccess(e){let{task:t,id:i}=e;this.status=null,this._id?(this.nav([pe,i],{replace:!0,trigger:!1}),this.loadTaskData(t),this.rebuild=this.rebuild+1,this.richTextRefreshKey=this.richTextRefreshKey+1,this.buildFields(),this._prepFields(t)):this.nav([pe,i]),k.Nd.trigger("TaskUpdate",{id:i,task:t})}toggleBookmark(){let e={type:"task",id:this._id,delete:this.bookmark?"1":"0"};(0,x.SC)("bookmarks",{method:"POST",data:e}),this.bookmark=!this.bookmark}deleteTask(){(0,O.BB)(lng("are you sure you want to delete this task?").caps(),{title:lng("delete task"),confirmText:lng("delete"),onConfirm:()=>(0,x.SC)("tasks/delete",{data:{id:this._id}},(()=>{var e;k.Nd.trigger("TaskDelete",{id:this._id}),null===(e=this.onClose)||void 0===e||e.call(this)}))})}saveNotification(){this.notification_change&&(0,x.SC)("tasks/save_notification",{method:"POST",data:{id:this._id,notification:(0,l.toJS)(this.notification)}},(0,l.action)((e=>{this.notification_change=!1,this.notification.notification_id=e.notification_id})))}get allCommentsLabels(){let e=this.commentsStore.comments;return this.showManagersComments&&(e=this.managersCommentsStore.comments),e.filter((e=>e.data.label)).map((e=>({label:e.data.label,val:e.id,color:(0,re.qP)(e.data.label.toLowerCase()).backgroundColor})))}get commentsLabels(){const e={};return this.allCommentsLabels.forEach((t=>{e[t.label.toLowerCase()]||(e[t.label.toLowerCase()]=t)})),Object.values(e)}},W=de(G.prototype,"showManagersComments",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),K=de(G.prototype,"moreFields",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Y=de(G.prototype,"bookmark",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Q=de(G.prototype,"notification",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{notification_id:null,notification_text:"",notification_date:""}}}),ee=de(G.prototype,"subTasks",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),te=de(G.prototype,"task_status",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=de(G.prototype,"richTextRefreshKey",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),de(G.prototype,"alertBeforeClose",[l.override],Object.getOwnPropertyDescriptor(G.prototype,"alertBeforeClose"),G.prototype),de(G.prototype,"_acceptDataFromServer",[l.action],Object.getOwnPropertyDescriptor(G.prototype,"_acceptDataFromServer"),G.prototype),de(G.prototype,"taskLink",[U],Object.getOwnPropertyDescriptor(G.prototype,"taskLink"),G.prototype),de(G.prototype,"newSiblingTask",[H],Object.getOwnPropertyDescriptor(G.prototype,"newSiblingTask"),G.prototype),de(G.prototype,"SaveSuccess",[J],Object.getOwnPropertyDescriptor(G.prototype,"SaveSuccess"),G.prototype),G);const me=(0,o.iv)("color:",u.g.colors.negative,";font-weight:bold;>.link{font-weight:normal;text-decoration:underline;}",""),ge=(0,c.observer)((function(e){var t;let{value:i,onChange:n,tasks_types:r,task_id:s,error:o,disable:a}=e,l=!!i&&(null==r?void 0:r.find((e=>e.id==i)));l?l.color=null===(t=l)||void 0===t?void 0:t.colors[0]:l={name:lng("select type").caps(),color:"#000"};const c=null==r?void 0:r.filter((e=>e.enabled)).map((e=>({val:e.id,label:e.name,color:e.colors[0]})));let m=(0,L.BX)(p.jC,{color:o?"white":l.color,accentColor:o?u.g.colors.negative:void 0,children:[(0,L.tZ)("span",{className:"_text",children:l.name})," ",a?"":"▼"]});return(0,L.BX)("div",{className:"TypeSelector",children:[s&&(0,L.BX)("div",{style:{marginBottom:"3px",fontSize:"0.8em",textAlign:u.g.far},children:["#",s," ",(0,L.tZ)(se.g,{copy:""+s,success:lng("task id copied to clipboard").caps(),smallButtonLike:!0})]}),0===(c||[]).length?(0,L.BX)("div",{css:me,children:[lng("no task types").caps(),(0,L.tZ)("br",{}),Blsm.user.isPowerManager&&(0,L.tZ)("div",{className:"link",children:(0,L.tZ)(g.A,{href:{list:"task_types"},children:lng("create one now").caps()})})]}):a?m:(0,L.tZ)(d.x,{options:c,onSelect:n,inForm:!0,children:m})]})})),he=(e,t)=>`\n\t> ._status > div:nth-of-type(-n+${e}){\n\t\tcolor: white;\n\t}\n\t> ._status > div:nth-of-type(-n+${e-1}){\n\t\t._status_label {\n\t\t\topacity: .7;\n\t\t\tfont-weight: lighter;\n\t\t}\n\t}\n\t> ._bg{\n\t\tbackground-color: ${t};\n\t\twidth: ${25*e}%;\n\t}\n`,be=(0,o.iv)("position:relative;background-color:",u.g.darkMode?u.g.colors.bg_main:"#E2E2E2",";border-radius:4px;&.disable{pointer-events:none;}>._status{position:relative;display:flex;>div{width:25%;padding:7px;&:nth-of-type(1){border-top-",u.g.near,"-radius:4px;border-bottom-",u.g.near,"-radius:4px;}&.active{border-top-",u.g.far,"-radius:4px;border-bottom-",u.g.far,"-radius:4px;}>._btn{width:100%;div._status_label{display:flex;>div:nth-of-type(1){flex-grow:1;",u.g.classes.ellipsis,";}}}&:hover{background-color:rgba(255, 255, 255, .1);}}}._bg{position:absolute;border-radius:4px;width:100%;height:100%;transition:all .4s;}&.open{",he(1,(0,Z.Pp)("open")),";}&.in_progress{",he(2,(0,Z.Pp)("in_progress")),";}&.closed{",he(3,(0,Z.Pp)("closed")),";}&.on_hold{",he(4,(0,Z.Pp)("on_hold")),";}",""),ve=(0,c.observer)((function(e){let{value:t,onChange:i,tasks_status:n,disable:r}=e,s={open:[],in_progress:[],closed:[],on_hold:[]};for(const e of n||[])s[e.task_resolution||e.resolve].push(e);let{status_name:o,task_resolution:l}=n.find((e=>e.status_id==t))||{status_name:null,task_resolution:"open"};const c=e=>{const t=new CustomEvent("StatusBarChange",{detail:{status_id:e}});return document.body.dispatchEvent(t),i(e)};return(0,L.BX)("div",{css:be,className:(0,a.AK)(l,{disable:r}),"data-task_resolution":l,children:[(0,L.tZ)("div",{className:"_bg"}),(0,L.tZ)("div",{className:"_status",children:["open","in_progress","closed","on_hold"].map((e=>{const t=s[e].filter((e=>e.enabled)).map((e=>({val:e.status_id,label:e.status_name,attr:{"data-status_id":e.status_id}})));return(0,L.tZ)(d.x,{className:(0,a.AK)({active:e===l}),options:t,onSelect:c,inForm:!0,children:(0,L.BX)("div",{className:"_status_label",children:[(0,L.tZ)("div",{children:l===e?(0,Z.HR)(o,l).caps(!1):(0,Z.Ey)(e).caps(!1)}),t.length>0&&(0,L.tZ)("div",{children:"▼"})]})},e)}))})]})})),_e={name:"16mxzjp",styles:"font-size:.9em;>div *{display:inline-block;}a{text-decoration:underline;}[data-duplicates] a{display:inline;}"},fe=(0,c.observer)((function(e){let{task:t,group_id:i,group_name:n,can_edit:r,reload:o,isDirty:a}=e;const{task_id:l,creator_id:c,creator_name:d,creation_time:p,modified_by:u,modifier_name:h,modified_time:v,parent_task:_,parent_title:f,duplicates:y}=t;return(0,L.BX)("div",{css:_e,"data-task_id":l,children:[i&&n&&(0,L.BX)("div",{"data-group_id":i,children:[lng("workspace").caps(),": ",(0,L.tZ)(g.A,{href:{workspace:i,tab:"tasks"},children:n}),r&&(0,L.tZ)(b.JO,{icon:"AssignOutsource",smallButtonLike:!0,onClick:()=>{a()?(0,O.qR)(lng("please save changes first")):(0,k.vm)().getStore("workspace",i).moveTasks([t],o)}})]}),_&&(0,L.BX)("div",{"data-parent_id":_,children:[lng("parent").caps(),": ",(0,L.tZ)(g.A,{href:{edit:"task",id:_},children:f})]}),c&&(0,L.BX)("div",{"data-creator_id":c,"data-creation_time":p,children:[lng("created by").caps()," ",(0,L.tZ)(g.A,{href:{user:c},newTab:!0,children:d}),", ",(0,L.tZ)(m.ij,{time:p})]}),u&&(0,L.BX)("div",{"data-modified_by":u,"data-modified_time":v,children:[lng("modified by").caps()," ",(0,L.tZ)(g.A,{href:{user:u},newTab:!0,children:h}),", ",(0,L.tZ)(m.ij,{time:v})]}),(null==y?void 0:y.length)>0&&(0,L.BX)("div",{"data-duplicates":y.map((e=>e.task_id)).join(","),children:[lng("duplicates").caps(),": ",y.map(((e,t)=>(0,L.BX)(s.Fragment,{children:[(0,L.tZ)(g.A,{href:{edit:"task",id:e.task_id},newTab:!0,children:e.task_title}),t<y.length-1&&", "]},t)))]})]})})),ye=(0,o.iv)("display:flex;>*+*{",u.g.classes.margin_near("10px"),";}",""),we=(0,c.observer)((function(e){let{files:t,assignmentId:i}=e;return(0,L.tZ)("div",{css:ye,children:null==t?void 0:t.map((e=>(0,L.tZ)(ke,{file:e,remove:e=>t.remove(e),assignmentId:i},e.file_id)))})})),xe=(0,o.iv)("position:relative;width:120px;background-color:",u.g.colors.bg_1,";height:100px;border-radius:5px;overflow:hidden;",u.g.classes.shadow_strong,";display:flex;justify-content:center;align-items:center;.right-top{position:absolute;display:block;right:5px;top:5px;}",""),ke=(0,c.observer)((function(e){let{file:t,remove:i,assignmentId:n}=e;const{file_name:r,file_id:s,temp:o}=t;let l=[{val:"download",label:lng("download")},{val:"delete",label:lng("delete")}];const c=(0,j.BX)(r);return(0,L.BX)(g.A,{href:{file:t,assignmentId:n},"data-preview":c,newTab:!0,css:xe,children:[(0,L.tZ)(d.x,{className:"menu",options:l,onSelect:e=>{switch(e){case"delete":(0,O.BB)(lng("are you sure you want to delete this file?"),{onConfirm:()=>{!0===o?i(t):(0,x.SC)("file/"+(n>0?`activity=${n}/${s}`:(0,a.$t)({file_id:s})),{method:"DELETE"},(()=>i(t)))}});break;case"download":(0,g.p4)({file:{file_id:s}},!0,!0)}},children:(0,L.tZ)(b.JO,{className:"right-top",icon:"menu"})}),(0,L.tZ)(V,{file:t,assignmentId:n})]})})),Ze=(0,c.observer)((function(e){var t,i,n;let{form:r}=e;const s=[{input:{type:"date_time",value:(0,P.GG)(null===(t=r.notification)||void 0===t?void 0:t.notification_date)||"",name:"notification_date",yearsSelector:{range:0,max:"+100"}},label:lng("date")},{input:{type:"textarea",value:(null===(i=r.notification)||void 0===i?void 0:i.notification_text)||"",name:"notification_text"},label:lng("text")}],o=e=>{e.notification_date&&!(0,B.R)(e.notification_date)||(r.notification=e?Object.assign((0,l.toJS)(r.notification),e):{},r.notification_change=!0)};return(0,L.BX)(I.b,{children:[r._id&&Blsm.user.isPowerManager&&(0,L.tZ)(b.JO,{icon:"history",className:"task-button",href:(0,ae.TK)("tasks",r._id),newTab:!0,toolTip:lng("activity log").caps()}),(0,L.tZ)(b.JO,{icon:"arrow_out_square",className:"task-button",toolTip:lng("open in new tab"),onClick:()=>(0,g.p4)({edit:"task",id:r._id},!0,!0)}),r._id&&r.flags.can_update&&(0,L.tZ)(b.JO,{icon:"trash",className:"task-button",onClick:()=>r.deleteTask()}),(0,L.tZ)(b.JO,{icon:"bookmark",className:(0,a.AK)("task-button",{_filled:r.bookmark}),onClick:()=>r.toggleBookmark()}),(0,L.tZ)(d.x,{title:lng("task notification"),options:s,inputChange:o,onClear:()=>o(!1),onClose:()=>r.saveNotification(),inForm:!0,children:(0,L.tZ)(b.JO,{icon:"notifications",className:(0,a.AK)("task-button",{_filled:null===(n=r.notification)||void 0===n?void 0:n.notification_id})})})]})})),Ce=(0,o.iv)("table{width:100%;td{padding:10px;}}._task-title{color:",u.g.colors.text_main,";font-weight:600;}._task-id{font-size:.7em;}tr td ._goto{font-size:.9em;}",""),Se=(0,c.observer)((function(e){let{tasks:t,manager:i,onDelete:n}=e;return(0,L.tZ)("div",{css:Ce,children:(0,L.tZ)("table",{children:(0,L.tZ)("tbody",{children:(null==t?void 0:t.length)>0&&t.map((e=>(0,L.tZ)(Oe,{task:e,manager:i,onDelete:n},e.task_id)))})})})})),Oe=e=>{let{task:t,manager:i,onDelete:n}=e;return(0,L.BX)("tr",{children:[(0,L.tZ)("td",{children:(0,L.tZ)(b.JO,{icon:"close",buttonLike:!0,onClick:()=>{(0,O.BB)(lng("are you sure that you want to detach this sub task?").caps(),{onConfirm:()=>(0,x.SC)("tasks/delete_parent",{method:"POST",data:{task:t.task_id}},(()=>{n(t)}))})}})}),(0,L.tZ)("td",{children:(0,L.tZ)(h.u,{text:(0,Z.HR)(t.status_name,t.task_resolution).caps(!1),children:(0,L.tZ)(b.gT,{color:(0,Z.Pp)(t.task_resolution),size:"1.2em"})})}),(0,L.BX)("td",{children:[(0,L.tZ)(S.m,{children:(0,L.tZ)("div",{className:"_task-title",children:t.task_title})}),(0,L.BX)("div",{className:"_task-id",children:["#",t.task_id]})]}),(0,L.tZ)("td",{children:t.task_type&&(0,L.tZ)(p.jC,{color:t.task_type_color,children:t.task_type})}),(0,L.tZ)("td",{children:t.allocated_to&&(0,L.tZ)(C.SV,{children:(0,L.tZ)(y.qE,{user:{user_id:t.allocated_to,full_name:t.assignee_name,user_avatar:t.assignee_avatar}})})}),i&&(0,L.tZ)("td",{children:(0,Z.aS)(t.priority)}),(0,L.tZ)("td",{children:(0,L.tZ)(g.A,{href:{edit:"task",id:t.task_id},children:(0,L.tZ)(N.ZT,{icon:"go_arrow",bgColor:u.g.colors.light_blue,className:"_goto",size:29})})})]})},Be=(0,c.observer)((e=>{let{input:{form:t}}=e;return(0,L.tZ)(re.r$,{children:t.commentsLabels.map((e=>{let{label:t,val:i}=e;return(0,L.tZ)(re.Vp,{tag:t,onClick:()=>Ie(i),tooltip:lng("jump to label")},"comment-label-"+i)}))})})),Te=(0,o.iv)("position:absolute;bottom:5px;",u.g.far,":5px;display:flex;flex-direction:column;z-index:1;.nav-icon .Icon{font-size:10px;}.nav-icon+.nav-icon{margin-top:1px;}",""),Ne=(0,c.observer)((e=>{let{form:t}=e;const i=e=>{const t=e.currentTarget.closest(".container-children"),i=t.getElementsByClassName("splitter-1");return i.length?i[0]:t};return(0,L.BX)("div",{css:Te,children:[t.allCommentsLabels.length>0&&(0,L.tZ)(d.x,{options:[{separator:!0,label:lng("jump to label")},...t.allCommentsLabels],onSelect:Ie,children:(0,L.tZ)(N.ZT,{icon:"label",size:20})}),t.flags.is_group_manager&&(0,L.tZ)(h.u,{text:lng("toggle manager comments").caps(),className:"nav-icon",children:(0,L.tZ)(N.ZT,{icon:"manager",onClick:()=>{t.showManagersComments=!t.showManagersComments},size:20,bgColor:t.showManagersComments?u.g.colors.dominant_orange:void 0})}),(0,L.tZ)(h.u,{text:lng("scroll to the top").caps(),className:"nav-icon",children:(0,L.tZ)(N.ZT,{icon:"arrow_up",onClick:e=>{i(e).scrollTo({top:0,behavior:"smooth"})},size:20})}),(0,L.tZ)(h.u,{text:lng("scroll to the bottom").caps(),className:"nav-icon",children:(0,L.tZ)(N.ZT,{icon:"arrow_down",onClick:e=>{const t=i(e);t.scrollTo({top:t.scrollHeight,behavior:"smooth"})},size:20})})]})})),Ie=e=>{document.querySelector(`[data-comment_id="${e}"]`).scrollIntoView({behavior:"smooth"})},De=(0,c.observer)((function(e){let{value:t,onChange:i,canUpdate:n,updateProgress:r}=e;void 0===t&&(t=[]);return(0,L.BX)("div",{css:je,children:[(0,L.BX)(T.V,{theme:"contained",disabled:!n,onClick:()=>(()=>{if(!t.some((e=>1!==e.deleted&&(0,a.xb)(e.text)))){const e={cb_id:"new_"+(t.length+1),checked:!1,text:"",deleted:0};t.push(e),i([...t])}})(),children:[(0,L.tZ)(b.JO,{icon:"mark_plus_light"})," ",lng("add check item").caps()]}),t.map(((e,s)=>(0,L.tZ)(Pe,{index:s,item:e,updateItem:(e,n,s)=>((e,n,s)=>{const o=[...t];o[e]={...o[e],[n]:s},i(o);const a=[0,0];for(const{checked:e}of o)a[0]++,e&&a[1]++;r(a[0]?Math.round(a[1]/a[0]*100):0)})(e,n,s),disabled:!n},e.cb_id)))]})})),je={name:"vomngf",styles:".container{display:flex;justify-content:space-between;margin-top:10px;}.checkListItemInputs{flex-grow:1;display:flex;align-items:baseline;}.grow{flex-grow:1;}.deleted{display:none;}.strikeThrough{text-decoration:line-through;}"},Pe=(0,c.observer)((function(e){let{item:t,index:i,updateItem:n,disabled:r}=e;const[o,l]=(0,s.useState)(1==t.deleted),[c,d]=(0,s.useState)(2==t.deleted),[p,u]=(0,s.useState)(!!t.checked),[m,g]=(0,s.useState)(t.text);return(0,L.BX)("div",{className:(0,a.AK)("container",o?"deleted":""),children:[(0,L.BX)("div",{className:"checkListItemInputs",children:[(0,L.tZ)(oe.XZ,{value:p,disabled:c||r,onChange:()=>(u(!p),n(i,"checked",!p))}),!c&&(0,L.tZ)(w.I,{type:"text",wrapped:!0,disabled:r,wrapperClassName:"grow",inline:!0,value:m,onChange:e=>g(e),onBlur:()=>n(i,"text",m)}),c&&(0,L.tZ)("span",{className:c?"strikeThrough":"",children:m})]}),(0,L.BX)("div",{children:[(0,L.tZ)(b.JO,{icon:"strikethrough",disabled:r,onClick:()=>(d(!c),n(i,"deleted",c?null:2)),buttonLike:!0}),(0,L.tZ)(b.JO,{icon:"trash",disabled:r,onClick:()=>(l(1),n(i,"deleted",1)),buttonLike:!0})]})]})}))},5519:(e,t,i)=>{i.d(t,{HA:()=>T,Kz:()=>w,Pl:()=>x,R9:()=>f,V_:()=>Z,hy:()=>v,qx:()=>S,xE:()=>y,yP:()=>O,z9:()=>_});var n=i(7363),r=i(5459),s=i(917),o=i(6920),a=i(7154),l=i(6421),c=i(493),d=i(8318),p=i(8e3),u=i(6975),m=i(8567),g=(i(7882),i(5560)),h=i(3533),b=i(5944);const v="2",_=[0,1,5,10,15,20,30,40,45,60,75,90,120,150,180],f=e=>{let{input:{bg:t,helpKey:i,skinny:n,label:o,wrap:a,bold:l,direction:c}}=e;const d=(0,s.iv)("padding:11px 13px;",a?"":"white-space: nowrap;"," ",n&&"padding-top: 5px; padding-bottom: 5px;"," ",t&&`background-color: ${t}; color: white; border-radius: 8px;`," ",i&&".help-sign {\n\t\t\tmargin: 0 13px\n\t\t}"," ",l&&"font-weight: 600;"," ",c&&`direction: ${c};`,";","");return(0,b.BX)("div",{css:d,children:[i&&(0,b.tZ)(r.I,{helpKey:i}),(0,b.tZ)(h.h,{children:o})]})},y=e=>{let{onChange:t,item:i}=e;const n=(0,s.iv)("input{width:40px;border:0;background-color:transparent;border-bottom:2px solid ",o.g.colors.separator,";}","");return(0,b.tZ)("div",{css:n,children:(0,b.tZ)(a.u,{text:lng("allocation amount").caps(),children:(0,b.tZ)(l.I,{type:"number",onChange:e=>t({value:e}),value:i.allocation,style:{textAlign:"right"},min:"0",step:"1"})})})},w=e=>{let{onChange:t,item:i}=e;return(0,b.tZ)("div",{children:(0,b.tZ)(a.u,{text:lng("include sub units").caps(),children:(0,b.tZ)(c.T,{value:!!i.use_sub_groups,size:18,onChange:t,options:[{val:!1,color:o.g.colors.dominant_main,icon:"mark_x_light"},{val:!0,color:o.g.colors.dominant_main,icon:"mark_v_light"}]})})})},x=e=>{let{onChange:t,item:i}=e;const n=(0,s.iv)("input{width:40px;border:0;background-color:transparent;border-bottom:2px solid ",o.g.colors.separator,";}","");return(0,b.tZ)("div",{css:n,children:(0,b.tZ)(a.u,{text:lng("order").caps(),children:(0,b.tZ)(l.I,{type:"number",onChange:e=>t({value:e}),value:i.order,style:{textAlign:"right"}})})})},k={name:"1kgxk17",styles:".input{text-align:right;}.resource_amount{min-width:2ch;display:inline-block;margin:0 2px;text-align:center;&.infinite{font-size:120%;line-height:1;vertical-align:middle;}}.warning{margin:0 5px;}"},Z=e=>{let{onChange:t,item:i,period:r,assignmentId:s,groupId:a}=e;const{note:c,resource_name:g,resource_amount:h,resource_category:v,resource_id:_}=i,f=(0,d.DM)(i.amount_in_use)?i.amount_in_use:1,y=null===h,[w,x]=(0,n.useState)(""),Z=parseInt(v)===Blsm.prm.INSTRUCTOR_CATEGORY;let C="";const S=()=>{const e=r();e&&(0,p.SC)("meetings/check_time",{data:{start:e[0],end:e[1],id:s,group:a,resource_id:_,amount_in_use:f,onlyConflicts:!0}},(e=>{let t=e.resources_conflicts?`${lng("conflict")}: ${e.resources_conflicts}`:"";x(t)}))};return w||S(),!y&&f>h&&(C=`${lng("resource amount is").caps()} ${h}`),(0,b.BX)("div",{css:k,children:[(w||C)&&(0,b.tZ)(u.JO,{className:"warning",icon:"sign_notification",color:o.g.colors.negative,toolTip:[w,C].filter((e=>e)).join("\n")}),!Z&&(0,b.BX)("span",{children:[(0,b.tZ)(l.I,{inline:!0,minimalist:!0,skinny:!0,wrapped:!0,className:"input",type:"number",min:"1",max:Math.max(99,2*h||0),value:f,onChange:e=>(t({amount_in_use:e}),S())}),"/",(0,b.tZ)("span",{className:(0,d.AK)("resource_amount",{infinite:y}),children:y?"∞":h})]}),!Z&&(0,b.tZ)(u.JO,{icon:"chat",color:c&&o.g.colors.blossom,toolTip:c||lng("add note"),buttonLike:!0,onClick:()=>{(0,m.cS)("",{title:`${lng("note for").caps()} ${g}`,confirmText:lng("confirm"),inputType:"textarea",limit:150,startValue:c,onConfirm:e=>t({note:e})})}})]})},C=(0,s.iv)("input{width:40px;border:0;background-color:transparent;border-bottom:2px solid ",o.g.colors.separator,";}.InputDropDown{width:110px;}",""),S=e=>{let{item:t,onChange:i,values:n}=e;const r=[["start_and_repeat",lng("every time")],["finish",lng("first time")],["repeat",lng("refresh")]];return"none"!==n.get("repeat_type")?(0,b.tZ)("div",{css:C,children:(0,b.tZ)(l.I,{type:"select",value:t.dependency_type,label:lng("repeat type"),onChange:e=>i({value:e}),options:(0,d.wd)(r)})}):null},O=(0,g.observer)((e=>{let{item:t,onChange:i,disable:n}=e;return(0,b.tZ)("div",{css:C,children:(0,b.tZ)(l.I,{type:"checkbox",onChange:e=>i({value:e}),disabled:n(),value:t.optional,label:lng("optional"),style:{textAlign:"right"}})})})),B=(0,s.iv)("display:flex;justify-content:flex-start;border-bottom:1px solid ",o.g.colors.separator,";&:hover{cursor:pointer;}._tab{color:",o.g.colors.text_sec,";padding:10px;text-align:center;&._selected{color:",o.g.colors.text_sec,";border-bottom:1px solid ",o.g.colors.dominant_main,";}>._title{margin:0 10px;font-size:1rem;font-weight:600;}}",""),T=(0,g.observer)((e=>{var t;let{tabs:i,onChange:r}=e;const[s,o]=(0,n.useState)(null===(t=i[0])||void 0===t?void 0:t.name);return(0,b.tZ)("div",{css:B,children:i.map((e=>{let{icon:t,title:i,name:n}=e;return(0,b.BX)("div",{onClick:()=>(r(n),o(n)),className:(0,d.AK)({_tab:!0,_selected:s===n}),children:[t&&(0,b.tZ)(u.JO,{...t}),(0,b.tZ)("div",{className:"_title",children:i.caps()})]},"tab_"+n)}))})}))},4576:(e,t,i)=>{i.d(t,{BP:()=>c,Gu:()=>r,h1:()=>d,i1:()=>l,i6:()=>s,pM:()=>o,wQ:()=>a});var n=i(8318);const r=(e,t,i)=>({user:(e||lng("user")).caps(),manager:lng("%s's direct manager",e).caps(),users_indirect_manager:lng("%s's indirect manager",e).caps(),users_managers_manager:lng("%s's manager's manager",e).caps(),user_professional_manager:lng("%s's professional manager",e).caps(),user_hr_manager:lng("%s's human resources coordinator",e).caps(),personal_coach:lng("%s's personal coach",e).caps(),...Blsm.isFeatureEnabled("authorization_qualification")&&{user_auth_supervisor_id:lng("%s's job authorization supervisor",e).caps()},...i&&{coach:lng("%s's assigned coach",e).caps()},...(void 0===t||t)&&{other:lng("users, roles, workspaces").caps(!1)}}),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.folders=t.folders||[],t.indent_char=t.indent_char||" ",t.all&&t.folders.unshift(["all",lng("all").caps()]);const i=(e,r)=>{for(let s of e)s.id&&(t.include_non_numeric||(0,n.kE)(s.id)&&"repo"!==s.icon)&&(s.count&&null!=t&&t.display_count&&(s.label+=` (${s.count})`),t.folders.push([s.id,r+s.label])),s.sons&&s.sons.length&&i(s.sons,r+t.indent_char)};return i(e,""),t.folders},o=e=>{if(11!==(e=e.replace(/[^\d]+/g,"")).length)return!1;let t;for(t=1;t<e.length&&e[0]===e[t];t++);if(t===e.length)return!1;const i=t=>{let i=0;for(let n=0;n<t;n++)i+=parseInt(e.charAt(n))*(t+1-n);let n=11-i%11;return 10!==n&&11!==n||(n=0),n===parseInt(e.charAt(t))};return i(9)&&i(10)},a=e=>{let t=0,i=e.length;for(let n=0;n<i;n++){let r=parseInt(e[i-n-1]);n%2==1&&(r*=2),t+=r>9?r-9:r}return t%10==0},l=e=>/^(user_identity_num|employee_id)$/.test(e)?40:/^user_(name|first_name|last_name|business_phone|home_phone|mobile_phone|fax_number|city|state|postal_code|country)$/.test(e)?50:/^user_(email|company|job_title|address)/.test(e)?100:void 0,c=e=>{if(!(e*=1))return"";if(e<0)return lng("other");let t=Math.floor(e/60);return e-=60*t,e=Math.round(e),t?1===t?e?lng("1 hour %s minutes",e):lng("1 hour"):e?lng("%s hours %s minutes",t,e):lng("%s hours",t):1===e?lng("1 minute"):lng("%s minutes",e)},d=e=>null!=e&&e.level_value?e.level_name||lng("level %s",e.level_value).caps():""},7138:(e,t,i)=>{i.d(t,{U:()=>a});var n=i(4210),r=i(8e3),s=i(5944);function o(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a extends n.I{constructor(e){super(e),o(this,"names",void 0),o(this,"ids",void 0),o(this,"objName",void 0),o(this,"baseRoute",void 0),o(this,"extraUrlData",{}),o(this,"serverResponse",void 0),o(this,"handleFieldSelect",(e=>{[...this.values.keys()].forEach((t=>{t.startsWith("cb_")&&(e.includes(t)?this.values.set(t,!0):this.values.set(t,!1))}))})),this.names=e.names||this.names,this.ids=e.ids||this.ids,this.baseRoute=e.baseRoute||this.baseRoute,this.objName=e.objName||this.baseRoute,this.extraUrlData=e.extraUrlData||this.extraUrlData,this.sendEmpty=!0,this.title=lng("edit multiple items").caps()+` (${this.ids.length})`,this.saveUrl=`${this.baseRoute}/save_multi/`,this.saveAsJson=!0,(0,r.SC)(`${this.baseRoute}/edit_multi`,{method:"POST",json:!0,data:{multi:1,ids:this.ids,...this.extraUrlData}},(e=>{this.serverResponse=e,this.createAttributes(e),this.createCustomFields(e),this.buildFields()}))}createAttributes(){throw new Error("MultiRowSetterForm:createAttributes abstract function not implemented")}createCustomFields(){this.custom_fields=this._customFieldsPrep(this.serverResponse.custom_fields)}buildFields(){let e=[{optgroup:!0,label:lng("fields"),options:this.attributes.filter((e=>e.name)).map((e=>{let{name:t,label:i}=e;return{val:"cb_"+t,label:i}}))},{optgroup:!0,label:lng("custom fields"),options:this.custom_fields.filter((e=>e.name)).map((e=>{let{name:t,label:i}=e;return{val:"cb_"+t,label:i}}))}];this._fields=[...this._fields,{type:"component",node:(0,s.tZ)("b",{text:this.names.join(),children:lng("updating %s items|number",this.ids.length).caps()})},{type:"select_multi",name:"fields_select",theme:"bright",options:e,label:lng("select fields to update"),value:this.params.fieldsSelectInitialValue,onValueChange:e=>this.handleFieldSelect(e)},...[...this.attributes,...this.custom_fields].map((e=>({type:"row_set",visible:t=>e.name?this.values.get("cb_"+e.name):e.visible(t),fields:[{type:"hidden",name:"cb_"+e.name},{...e,required:()=>!!this.getValue("cb_"+e.name)&&e.required,placeholder:e.required?lng("cannot be empty").caps():lng("leave empty to clear").caps()}]})))],this._prepFields(),this.ready=!0,this.params.fieldsSelectInitialValue&&this.handleFieldSelect(this.params.fieldsSelectInitialValue)}save(e){var t;if((null===(t=e.fields_select)||void 0===t?void 0:t.length)>0){delete e.fields_select;for(let t in e)t.startsWith("cb_")&&(t.startsWith("cb_")&&e[t]&&!e[t.split("cb_")[1]]&&delete e[t.split("cb_")[1]],e[t]=e[t]?1:0);this.saveToUrl(this.saveUrl,{...e,ids:this.ids,...this.extraUrlData})}}}},2297:(e,t,i)=>{i.d(t,{I:()=>y,h:()=>I});var n,r,s=i(7073),o=i(8318),a=i(7821),l=i(441),c=i(6975),d=i(7363),p=i(3346),u=i(917),m=i(6920),g=i(5680),h=i(5311),b=i(8e3),v=i(7392),_=i(5944);const f="rating";let y=(n=a.action.bound,r=class e extends s.Z{static matchForm(t,i){let{nav:n}=i;const[r,...s]=t;if(r===f)return new e({route:s,nav:n})}updateFormRoute(e){return this.defaultUpdateFormRoute(e,f)}setActiveSection(e){this.nav([f,this.route[0],null==e?void 0:e.sid],{replace:!0})}constructor(e){let{route:t,nav:i}=e;super({route:t,nav:i}),(0,a.makeObservable)(this);const[n,r]=t;this._activeSection=r,this.params=(0,o.B5)(n)?{}:n,this._id=(0,o.B5)(n)?parseInt(n):0,this.placeholders={},this._id||(this.createMode=!0),this.saveUrl=`ratings/${this._id}/`,this.fetchUrl=`ratings/${this._id}/${(0,o.$t)({type:"form"})}`,this.fetch()}buildQuestionsSections(){const e={meeting:lng("meeting"),instructor:lng("instructor"),workspace:lng("workspace")};return["workspace","meeting","instructor"].map((t=>({type:"section",title:`${e[t]} ${lng("rating").caps()}`,sid:`q_${t}`,sectionWidth:"800px",fields:[{type:"component",Render:B,name:`questions[${t}]`,props:{type:t,values:this.values,placeholders:this.placeholders}}]})))}_acceptDataFromServer(e){this.title=this._id?lng("edit rating"):lng("add new rating"),e.placeholders.forEach((e=>this.placeholders[e]=e.replaceAll("_"," ")));for(const t in e.questions)e.questions[t].sort(((e,t)=>e.question_order-t.question_order));this.buildFields({initialValues:e})}buildFields(e){let{initialValues:t}=e;this._fields=[{type:"section",sid:"general",sectionWidth:"1000px",title:lng("general"),fields:[{type:"text",name:"name",label:lng("rating name"),placeholder:lng("enter rating name"),required:!0},{type:"richtext",name:"opening_text",label:lng("default opening text"),toolbarOptions:{font:!0,color:!0,media:!0,list:!0,align:!0}},{type:"richtext",name:"closing_text",label:lng("default closing text"),toolbarOptions:{font:!0,color:!0,media:!0,list:!0,align:!0}}]},...this.buildQuestionsSections()],this._successButtons=[{label:lng("back to %s|back to some page",lng("ratings")).caps(),onClick:()=>(0,l.p4)({list:"rating_tool"},!0),primary:!0},{label:lng("continue editing").caps(),onClick:()=>this._id?this.nav([f,this._id]):this.status=null}],this._prepFields(t),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,Object.assign({},e))}SaveSuccess(e){this._id||(this._id=e.rating_id)}},w=r.prototype,x="SaveSuccess",k=[n],Z=Object.getOwnPropertyDescriptor(r.prototype,"SaveSuccess"),C=r.prototype,S={},Object.keys(Z).forEach((function(e){S[e]=Z[e]})),S.enumerable=!!S.enumerable,S.configurable=!!S.configurable,("value"in S||S.initializer)&&(S.writable=!0),S=k.slice().reverse().reduce((function(e,t){return t(w,x,e)||e}),S),C&&void 0!==S.initializer&&(S.value=S.initializer?S.initializer.call(C):void 0,S.initializer=void 0),void 0===S.initializer&&(Object.defineProperty(w,x,S),S=null),r);var w,x,k,Z,C,S;const O=(0,u.iv)(".new-question-container{display:flex;justify-content:space-between;align-items:center;}.new-question{width:87%;",m.g.classes.margin_near("25px"),";}.actions{display:flex;justify-content:space-around;flex-grow:1;width:30px;}.empty-icon{min-width:34.8px;}",""),B=e=>{let{value:t,type:i,values:n,placeholders:r}=e;const[s,a]=(0,d.useState)(t||[]),[l,u]=(0,d.useState)(""),[m,g]=(0,d.useState)(!1),[h,f]=(0,d.useState)(!0);(0,d.useEffect)((()=>{n.set(`questions[${i}]`,s)}),[s]);const y=e=>{var t;const i=s.findIndex((t=>t.rq_id===e.rq_id));s[i].status="new"===(null===(t=s[i])||void 0===t?void 0:t.status)?"new":"edited",s[i].text=e.text,a([...s])},w=e=>{if("new"===e.status)return a(s.filter((t=>t.rq_id!==e.rq_id)));s.find((t=>t.rq_id===e.rq_id)).status="deleted",a([...s])},x=e=>{s.find((t=>t.rq_id===e.rq_id)).status="edited",a([...s])},k=e=>{const{currentIndex:t,newIndex:i}=e;s[t].question_order=i,s[i].question_order=t,a([...s.sort(((e,t)=>e.question_order-t.question_order))])},Z=()=>{if(l.trim().length>0){f(!1);const e=Math.floor(1e5*Math.random());a([...s,{rq_id:`t_${e}`,text:l,key:`t_${e}`,type:i,status:"new",question_order:s.length}]),u("")}},C=s.map((e=>"new"!==(null==e?void 0:e.status)&&e.rq_id)).filter((e=>e));return(0,_.BX)("div",{css:O,children:[s.sort(((e,t)=>e.question_order-t.question_order)).map(((e,t)=>(0,_.tZ)(N,{onChange:y,onEditClick:()=>g(m!==e.rq_id&&e.rq_id),editMode:"new"===e.status||m===e.rq_id,onReorder:k,onDelete:w,onRedo:x,question:e,placeholders:r,last:t===s.length-1},e.rq_id))),h?(0,_.BX)("div",{className:"new-question-container",children:[(0,_.tZ)("div",{className:"new-question",children:(0,_.tZ)(p.gN,{value:l,onChange:e=>u(e),input:{type:"poortext",keySubmit:Z,placeholders:r,onSelect:e=>(e=>{a([...s,{rq_id:e.id,text:e.value,key:e.id,type:i,status:"reused",question_order:s.length}]),u("")})(e),onChange:e=>u(e),placeholder:`${lng("e.g.")} ${I[i][Math.round(.5+3*Math.random())].text}`,label:lng("add question"),name:lng("question"),showId:!0,suggest:{getData:(0,o.pR)(((e,t)=>{var n;return(0,b.SC)("ratings/rating_question_autocomplete",{data:{term:e||"",exclude:C,type:i,show_domain:Blsm.user.isAdmin||null!==(n=Blsm.user.real_data)&&void 0!==n&&n.isAdmin?1:0}},t)}))}}},(null==s?void 0:s.length)||0)}),(0,_.BX)("div",{className:"actions",children:[l.length>0?(0,_.tZ)(c.JO,{icon:"save",buttonLike:!0,onClick:Z}):(0,_.tZ)("div",{className:"empty-icon"}),(0,_.tZ)(c.JO,{icon:"trash",buttonLike:!0,onClick:()=>(f(!1),u(""))})]})]}):(0,_.BX)(v.l,{theme:"outlined",onClick:()=>f(!0),children:[lng("add question").caps()," ",(0,_.tZ)(c.JO,{icon:"new"})," "]})]},i)},T=(0,u.iv)("width:100%;margin:10px auto;.question-cont{display:flex;justify-content:space-between;align-items:center;>.question{flex-grow:10;margin:5px 0;border-radius:6px;>.form-field{margin-top:0;}&.deleted{>input{text-decoration:line-through;}}>input{&.readonly{padding:11px 13px;}&.editmode{margin-top:5px;background-color:",m.g.colors.light_blue2,";}}}.order-btns{display:flex;justify-content:space-around;}.order-btns{flex-direction:column;font-size:1em;}}.warning{color:",m.g.colors.warning,";margin:0 auto;width:80%;}",""),N=e=>{let{question:t,onChange:i,onDelete:n,onEditClick:r,editMode:s,onReorder:a,onRedo:l,last:d,placeholders:u}=e;const{rq_id:b,type:v,text:f,used_in:y,status:w,question_order:x}=t,k=e=>i({rq_id:b,type:v,text:e});return(0,_.BX)("div",{css:T,children:[(0,_.BX)("div",{className:"question-cont",children:[(0,_.BX)("div",{className:"order-btns",children:[(0,_.tZ)(c.JO,{icon:"arrow_up",color:0===x?m.g.colors.disabled_text:m.g.colors.text_main,disabled:0===x,smallButtonLike:!0,onClick:()=>a({currentIndex:x,newIndex:x-1})}),(0,_.tZ)(c.JO,{icon:"arrow_down",color:d?m.g.colors.disabled_text:m.g.colors.text_main,disabled:d,smallButtonLike:!0,onClick:()=>a({currentIndex:x,newIndex:x+1})})]}),(0,_.BX)("div",{className:(0,o.AK)("question",w),children:[s&&(0,_.tZ)(p.gN,{value:f,onChange:k,className:"editmode",input:{type:"poortext",toolbarOptions:{placeholders:u,simplePlaceholder:!0},name:`questions[${v}][${b}]`,onChange:k}}),!s&&(0,_.tZ)(h.jM,{text:f,grow:!0,width:"100%",className:"readonly"})]}),(0,_.BX)("div",{className:"actions",children:[w&&"new"===w?(0,_.tZ)("div",{className:"empty-icon"}):(0,_.tZ)(c.JO,{icon:s?"save":"edit",buttonLike:!0,onClick:r}),(0,_.tZ)(c.JO,{icon:"deleted"===w?"reload":"trash",buttonLike:!0,onClick:()=>"deleted"===w?l(t):n(t)})]})]}),s&&y&&(0,_.BX)("div",{className:"warning",children:[(0,_.BX)("div",{children:[lng("editing this question will affect similar questions in other ratings"),":"]}),(0,_.tZ)(g.r$,{children:y.split(",").map((e=>(0,_.tZ)(g.Vp,{tag:e},e)))})]})]})},I={workspace:[{text:"How satisfied are you with the overall organization of the group?",rq_id:"q_101",question_order:1},{text:"How effective do you feel the group's communication is?",rq_id:"q_102",question_order:2},{text:"How satisfied are you with the level of support provided within the group?",rq_id:"q_103",question_order:3},{text:"How effective do you feel the group's problem solving is?",rq_id:"q_104",question_order:4},{text:"How well do you feel the group's goals are aligned?",rq_id:"q_105",question_order:5}],instructor:[{text:"How well do you feel the instructor communicates the material?",rq_id:"q_201",question_order:1},{text:"How satisfied are you with the instructor's ability to answer questions?",rq_id:"q_202",question_order:2},{text:"How well do you feel the instructor manages classroom dynamics?",rq_id:"q_203",question_order:3},{text:"How satisfied are you with the instructor's availability outside of class?",rq_id:"q_204",question_order:4},{text:"How satisfied are you with the instructor's level of professionalism?",rq_id:"q_205",question_order:5}],meeting:[{text:"How satisfied are you with the organization of the meetings?",rq_id:"q_301",question_order:1},{text:"How satisfied are you with the level of participation in the meetings?",rq_id:"q_302",question_order:2},{text:"How satisfied are you with the outcomes of the meetings?",rq_id:"q_303",question_order:3},{text:"How effective do you feel the meeting's agenda is?",rq_id:"q_304",question_order:4},{text:"How satisfied are you with the level of engagement in the meetings?",rq_id:"q_305",question_order:5}]}},9829:(e,t,i)=>{i.d(t,{g:()=>s,l:()=>a});var n=i(4210),r=i(793);class s extends n.I{constructor(e){let{onValueChange:t,advanced:i,type:n}=e;if(super({onValueChange:t}),"mycontent"!==n&&this._fields.push({type:"select",name:"sort",label:lng("sort by").caps(),options:o(n)}),"content"===n||"mycontent"==n){let e=null==i?void 0:i.categories;e&&this._fields.push({type:"select",name:"cat",label:lng("category").caps(),options:e,emptyOption:!0}),"content"==n&&this._fields.push({type:"checkbox",name:"archive",label:lng("search in archive").caps()},{type:"checkbox",name:"official",label:lng("show official").caps()})}let s=null==i?void 0:i.tag_categories;s&&s.map((e=>{const t=e.tags.map((e=>({type:"checkbox",name:`tags[${e.tag_id}]`,label:e.tag_name,checkboxValue:e.tag_id})));this._fields.push({type:"indent_set",toggle:!0,toggleTitle:e.tag_category_name,fields:t})}));let l=null==i?void 0:i.types;if(l){let e=[];for(const[t,n]of Object.entries(l))if("text"===t){let r=[];for(const[e,t]of Object.entries(i.text_sub_types))r.push({type:"checkbox",name:`textsub[${e}]`,checkboxValue:e,label:t});let s=[{type:"checkbox",name:"content_types[text]",checkboxValue:t,label:n},{type:"indent_set",fields:r}];e.push(...s)}else e.push({type:"checkbox",name:`content_types[${t}]`,checkboxValue:t,label:n});this._fields.push({type:"indent_set",toggle:!0,toggleTitle:lng("content type").caps(),fields:e})}const c=a.map((e=>({type:"checkbox",name:`duration[${e[0]}]`,checkboxValue:e[0],label:e[1]})));this._fields.push({type:"indent_set",toggle:!0,toggleTitle:lng("estimated duration").caps(),fields:c}),"mycontent"!=n&&this._fields.push({type:"select",name:"period",emptyOption:!0,label:lng("last modified").caps(),options:r.l}),this._prepFields()}}const o=e=>{let t=[{val:"relevance",label:lng("relevance").caps()},{val:"date",label:lng("date").caps()}];return"catalogs"===e&&t.push({val:"views",label:lng("popularity").caps()}),t},a=[["0_30",lng("under %s min",30)],["30_60",lng("%s min to 1 hour",30)],["60_120",lng("1 hour to %s hours",2)],["120_",lng("over %s hours",2)]]},793:(e,t,i)=>{i.d(t,{h:()=>s,l:()=>o});var n=i(4210),r=i(8e3);class s extends n.I{constructor(e){let{onValueChange:t,advanced:i}=e;super({onValueChange:t});let n=[{val:"0",label:lng("show regular")},{val:"1",label:lng("show archive")}];this._fields=[{type:"select",name:"archive",emptyOption:lng("show all"),label:lng("archived").caps(),options:n}];let s=null==i?void 0:i.types_data;if(s){let e=[];for(const[t,i]of Object.entries(s))e.push({type:"checkbox",name:`tasktypes[${t}]`,label:lng(i.name),checkboxValue:t,color:i.colors.bg,skinny:!0});this._fields.push({type:"indent_set",toggle:!0,toggleTitle:lng("task type").caps(),fields:e})}let a=null==i?void 0:i.resolution;if(a){let e=[];for(const[t,i]of Object.entries(a))e.push({type:"checkbox",name:`resolution[${t}]`,label:lng(i.label),checkboxValue:t,color:i.color,skinny:!0});this._fields.push({type:"indent_set",toggle:!0,toggleTitle:lng("resolution").caps(),fields:e})}let l=null==i?void 0:i.severities;if(l){let e=[];for(const[t,i]of Object.entries(l))e.push({type:"checkbox",name:`severities[${t}]`,label:lng(i),checkboxValue:t,skinny:!0});this._fields.push({type:"indent_set",toggle:!0,toggleTitle:lng("severity").caps(),fields:e})}let c=null==i?void 0:i.priorities;if(c){let e=[];for(const[t,i]of Object.entries(c))e.push({type:"checkbox",name:`priorities[${t}]`,label:lng(i),checkboxValue:t,skinny:!0});this._fields.push({type:"indent_set",toggle:!0,toggleTitle:lng("priority").caps(),fields:e})}this._fields.push({type:"multiple_items",name:"involved",label:lng("user involved"),searchData:(e,t)=>{(0,r.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||""}},t)}}),this._fields.push({type:"select",name:"period",emptyOption:!0,label:lng("last modified").caps(),options:o}),this._prepFields()}}const o=[{val:"all",label:lng("any time")},{val:"week",label:lng("past week")},{val:"month",label:lng("past month")},{val:"year",label:lng("past year").caps()}]},5024:(e,t,i)=>{i.d(t,{p:()=>f});var n=i(7363),r=i(8567),s=i(8e3),o=i(5007),a=i(4210),l=i(7821),c=i(4576);function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const p=(e,t)=>{for(const n of e){var i;if(n.id===t)return n;if(null!==(i=n.sons)&&void 0!==i&&i.length){const e=p(n.sons,t);if(e)return e}}};class u extends a.I{constructor(e){super(e),d(this,"folderId",void 0),this.successMessage=lng("folder saved");const{folderTree:t,value:i,mode:n}=e,r=((e,t)=>p(e,t))(t,i),s="edit"===n?null==r?void 0:r.parent:null==r?void 0:r.id,o="edit"===n?null==r?void 0:r.label:"",a="edit"===n?i:null;this.folderId=a,this.title=a?lng("edit folder").caps():lng("new folder").caps();const u={folder_name:o,folder_parent_id:s};this._fields=[{type:"text",name:"folder_name",label:lng("folder name"),required:!0},{type:"select",name:"folder_parent_id",label:lng("parent folder").caps(),options:(0,c.i6)((0,l.toJS)(t),{all:!0})}],this._prepFields(u),this.ready=!0}save(e){this.saveToUrl("catalog/update_folder",Object.assign({folder_id:this.folderId},e))}}var m=i(8318),g=i(6975),h=i(3205),b=i(3346),v=(i(7882),i(5560)),_=i(5944);const f=(0,v.observer)((function(e){let{value:t,onChange:i,folderTree:a}=e;const[d,p]=(0,n.useState)(!1),u={type:"row_set",fields:[{type:"select",options:(0,c.i6)((0,l.toJS)(a),{all:!0}),emptyOption:!1,value:t,name:"folder_id",label:lng("folder").caps(),onValueChange:e=>{i(e)},grow:10},{type:"component",node:(0,_.tZ)(g.JO,{icon:"edit",toolTip:lng("update").caps(),buttonLike:!0,onClick:()=>p("edit")}),visible:()=>(0,m.B5)(t)},{type:"component",node:(0,_.tZ)(g.JO,{icon:"new",toolTip:lng("new folder").caps(),buttonLike:!0,onClick:()=>p("new")})},{type:"component",node:(0,_.tZ)(g.JO,{icon:"trash",toolTip:lng("delete folder").caps(),buttonLike:!0,onClick:()=>{(0,r.BB)(lng("are you sure you want to delete this folder?").caps(),{title:lng("delete folder").caps(),onConfirm:()=>{(0,s.SC)("catalog/delete_folder",{data:{folder_id:t},method:"DELETE"},(e=>(null==e?void 0:e.folder_tree)&&o.Nd.trigger("FolderTree",e.folder_tree)))}})}}),visible:()=>(0,m.B5)(t)}]};return(0,_.BX)("div",{children:[d&&(0,_.tZ)(y,{onClose:()=>p(!1),folderTree:a,value:t,mode:d,onChange:i}),(0,_.tZ)(b.au,{input:u})]})})),y=(0,v.observer)((function(e){let{onClose:t,folderTree:i,value:r,mode:s,onChange:a}=e;const l=(0,n.useRef)(new u({folderTree:i,value:r,mode:s,onSaveSuccess:e=>{e.folder_tree&&o.Nd.trigger("FolderTree",e.folder_tree),t(),a(e.folder_id.toString())}})).current;return(0,_.tZ)(h.l,{form:l,onClose:t,internalForm:!0})}))},6946:(e,t,i)=>{i.d(t,{EU:()=>W,p_:()=>G});var n=i(5560),r=i(8318),s=i(7073),o=i(6975),a=i(6920),l=i(5702),c=i(7821),d=i(2247),p=i(8567),u=i(441),m=i(8e3),g=i(5007),h=i(409),b=i(4576),v=i(2334),_=i(7363),f=i(1137),y=i(8207),w=i(7938),x=(i(7882),i(5944));const k=(0,n.observer)((e=>{let{workspace_id:t}=e;const i=(0,_.useContext)(g.l9).getStore("workspace",t),n=(0,_.useRef)(null),[r,s]=(0,_.useState)(null),o=(0,x.tZ)(y.$0,{icon:"user",title:lng("role members").caps(),onClose:()=>{var e;return null===(e=n.current)||void 0===e?void 0:e.close()}});return i.show_members_drawer&&(0,x.tZ)(f.d,{scroll:!0,ref:n,refDrawerBody:s,onClose:()=>i.hideMembersDrawer(),children:i.managers&&(0,x.tZ)(y.W2,{head:o,stickyHead:!0,children:(0,x.tZ)(w.J,{collection:i.managers,scrollParent:r,reload:()=>i.fetchManagers(),workspace:i,roleWorkspace:!0})})})}));var Z,C,S,O,B=i(7191),T=i(7392),N=i(5519),I=i(5761),D=i(7154),j=i(7137),P=i(5459),z=i(4454),E=i(5311),R=i(7166),F=i(6654),M=i(2297),A=i(3634),q=i(435),X=i(4925),L=i(917),$=i(8555);function V(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function U(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function H(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const J="workspace";let G=(Z=c.action.bound,C=class e extends s.Z{static matchForm(t,i){let{nav:n}=i;const[r,...s]=t;if(r===J)return new e({route:s,nav:n})}updateFormRoute(e){return this.defaultUpdateFormRoute(e,J)}constructor(e){let{route:t,nav:i}=e;super({route:t,nav:i}),U(this,"_id",null),U(this,"_newId",null),U(this,"domain_id",null),U(this,"params",{}),U(this,"is_course",!1),U(this,"isRole",!1),U(this,"activityDaysDiff",void 0),U(this,"lastOpenMoment",void 0),V(this,"refreshRichText",S,this),U(this,"importSelectedItem",void 0),U(this,"importedSettings",void 0),U(this,"formStatus",void 0),V(this,"savePanelMessage",O,this),U(this,"workspace_approval_sequence",void 0),U(this,"sequencesOptions",[]),(0,c.makeObservable)(this);const[n,s]=t;if(this._activeSection=s,this.params=(0,r.B5)(n)?{}:n,this.saveAsJson=!0,this.validateOnChange=!0,this.expandAndSearchSections=!0,"role_members"===s&&(0,r.B5)(n)&&(0,g.vm)().getStore("workspace",n).showMembersDrawer(),this._id=(0,r.B5)(n)?parseInt(n):0,!this._id&&(this.createMode=!0,!n.type))return this.error="type missing";const o={};this._id||(o.type=n.type,o.patient=n.patient),this.saveUrl=`groups/${this._id}/${(0,r.$t)(o)}`,o.edit=1,(0,r.B5)(this.params.template)&&(o.template=this.params.template),this.fetchUrl=`groups/${this._id}/${(0,r.$t)(o)}`,this._id&&(this.backToButton={label:lng("go to the workspace").caps(),onClick:()=>(0,u.p4)({workspace:this._id},!0),icon:"enter"}),this.workspace_approval_sequence=Blsm.InitialData.general_options.authorize_group_seq,this.fetch()}get preview(){return{title:this.values.get("group_name"),poster:a.g.func.imgUrl(this.values.get("poster")),status:this.formStatus,isApproved:!this.serverResponse.data.status&&!!this._id}}linksDialog(){let e=(0,r.qL)()+(0,u.p4)({courseCatalog:!0,tab:"self",id:this._id});const t=[];t.push((0,x.BX)("div",{children:[(0,x.BX)("div",{children:[lng("direct link to the course in the registration page").caps(),":"]}),(0,x.BX)(E.c_,{children:[(0,x.tZ)(E.jM,{text:e,width:"435px"}),(0,x.tZ)(E.zh,{}),(0,x.tZ)(R.g,{copy:e,success:lng("link copied to clipboard"),smallButtonLike:!0})]})]})),(0,p.qR)(t,{title:lng("course link"),width:"500px",closeText:lng("close")})}_acceptDataFromServer(e){var t,i,n,s,o,a,l,c;const d=this.params.type||this.serverResponse.data.group_type;if(this.workspace_approval_sequence)if(this._id)switch(e.data.status){case"draft":this.formStatus=lng("draft");break;case"approval":this.formStatus=lng("pending");break;default:this.formStatus=lng("approved"),this.values.set("isApproved",!0)}else this.formStatus=lng("draft");var p,m,b;(this.sequencesOptions=(0,r.wd)(null===(t=this.serverResponse.data)||void 0===t||null===(i=t.sequences_data)||void 0===i?void 0:i.options),"role"===d.toLowerCase()&&this._id)?(this.isRole=!0,this.backToButton={label:lng("back to %s|back to some page",lng("roles")).caps(),onClick:()=>(0,u.p4)({list:"roles"},!0)},this.setExtraComponent((0,x.tZ)(k,{workspace_id:this._id})),this.savePanelExtraButtons.set("role_members",{label:lng("role members").caps()+" ("+e.data.managers_count+")",onClick:()=>(0,g.vm)().getStore("workspace",this._id).showMembersDrawer()}),Blsm.user.isPowerManager&&this._id&&this.savePanelExtraButtons.set("activity_log",{label:lng("activity log").caps(),href:{list:"activity_log",params:`filters[discipline]=roles,groups&filters[predicate_id]=${this._id}&filters[changelog]=1&sort=time`,newTab:!0}})):(Blsm.user.perm.isGroupOwner&&this.typeCheck(["group","course","course_template","qualification","workplan"])&&this.savePanelExtraButtons.set("",{label:lng("import").caps(),onClick:()=>this.loadImportDialog()}),"course_template"===d.toLowerCase()&&this._id&&this.savePanelExtraButtons.set("show_instances",{label:lng("instances").caps(),onClick:()=>(0,u.p4)({list:"courses",params:`origin_group=${this._id}`},!0)}),this.typeCheck("course")&&null!==(p=e.data)&&void 0!==p&&null!==(m=p.group_options)&&void 0!==m&&m.hide_with_link&&this.savePanelExtraButtons.set("links",{icon:"link",label:lng("course links").caps(),onClick:()=>this.linksDialog()}),Blsm.user.perm.isGroupOwner&&this.typeCheck(["qualification"])&&this._id&&"none"!==e.data.repeat_type&&null!==(b=e.data)&&void 0!==b&&b.repeat_issues_exist&&this.savePanelExtraButtons.set("repeat",{label:lng("resolve repetition issues").caps(),onClick:()=>ee(this._id)}),Blsm.user.isPowerManager&&this._id&&this.savePanelExtraButtons.set("activity_log",{label:lng("activity log").caps(),href:(0,$.TK)("groups",this._id)}));this.is_course=e.data.is_course;const v=(0,h.p)(d.caps(),this.is_course)||lng("workspace");this.title=this.createMode?lng("new %s",v):lng("edit %s",v),this._windowTitle=this.createMode?lng("new %s",v):lng("edit %s",this.serverResponse.data.group_name),this.domain_id=e.data.domain_id,this.initialValues=this.setupCalculatedFields(e.data),this.initialValues.required_seniority=null===(n=this.initialValues)||void 0===n||null===(s=n.required_seniority)||void 0===s?void 0:s.split(":"),this.initialValues.resource_bundles=(null===(o=this.initialValues)||void 0===o||null===(a=o.resource_bundles)||void 0===a?void 0:a.length)>0?this.initialValues.resource_bundles.split(","):[],this.initialValues.late_finish_message_cb=null!==(l=this.initialValues)&&void 0!==l&&null!==(c=l.owner_options)&&void 0!==c&&c.late_finish_message?1:0,(this.initialValues.syllabus_file||this.initialValues.syllabus_url||this.initialValues.syllabus_text)&&(this.initialValues.syllabus_type=this.initialValues.syllabus_file?"file":this.initialValues.syllabus_url?"url":"text"),this.buildFields(),this._prepFields(this.initialValues),this.ready=!0,window.formFields=this.fieldNames,(this.params.template||this.params.import)&&this.loadImportDialog(this.params.template||this.params.import)}setupCalculatedFields(e){var t,i,n,s,o,a,l;if(this.params.parent_id&&(e.parent_id=this.params.parent_id),this.params.template&&(e.origin_group=this.params.template),"course"===this.params.type&&null!==(t=this.params)&&void 0!==t&&t.start&&null!==(i=this.params)&&void 0!==i&&i.end&&(e.group_open_date=this.params.start,e.group_close_date=this.params.end),e.group_reg_dates=!!e.registration_end_date,e.notifications){const t=new Map;for(const[i,n]of Object.entries(e.notifications))t.set(i,n);e.notifications=t}e.activity_dates=e.group_open_date||e.group_close_date||e.inherit_dates_from_meetings,e.repeat_ends=e.repeat_end_date?"1":"0",e.add_syllabus=!!(e.syllabus_file||e.syllabus_text||e.syllabus_url),e.summary_data_use_custom_fields=!(null===(n=e.summary_data)||void 0===n||!n.custom_fields),e.view_pre_days_always=null===e.view_pre_days,e.view_post_days_always=null===e.view_post_days,e.reminder_due_date_cb=e.reminder_due_date>0,e.no_attendance_reminder_enabled=e.no_attendance_reminder,e.unpublished_grades_cb=e.unpublished_grades,e.required_period=null==e||null===(s=e.required_period)||void 0===s||null===(o=s.split)||void 0===o?void 0:o.call(s,":"),e.limit_reminder_cb=(0,r.DM)(null==e?void 0:e.limit_reminder);if(e.group_open_date||e.group_close_date||e.inherit_dates_from_meetings||(null===(a=this.params)||void 0===a?void 0:a.start)||(null===(l=this.params)||void 0===l?void 0:l.end)){const t=e.group_open_date,i=(0,v._3)(t),n=e.group_close_date,r=(0,v._3)(n);t&&n&&void 0===this.activityDaysDiff&&(this.activityDaysDiff=r.diff(i,"days")),t&&void 0===this.lastOpenMoment&&(this.lastOpenMoment=i)}return e}loadImportDialog(e){const t=this.getValue("import_data"),i=!this._id&&!this.importedSettings,n=new B.m({canImportSettings:i,groupTypes:this.typeCheck(["qualification","workplan"])?this.type():"group,course_template",onSelect:e=>{this.importSelectedItem=e,this.importedSettings=!1},onSave:t=>{t.poster&&this.importSelectedItem.poster_raw&&this.updateValue(this.importSelectedItem.poster_raw,"poster"),t.settings&&i?(0,p.BB)(lng("do you want to load this workspace info?"),{onConfirm:()=>{this.refreshRichText=!1,(0,m.SC)("groups/import_info",{data:{import_id:e||t.import_id}},(i=>{(0,g.vm)().closeDialog();const r=Object.assign({},Object.fromEntries(this.values.toJSON()),i);delete r.poster,this.setValues(this.setupCalculatedFields(r),{clear:!0}),"Course_template"===i.group_type&&(this.updateValue(e,"origin_group"),this.updateValue(1,"add_user_manager")),this.refreshRichText=!0,n.updateValue("","settings"),delete t.settings,this.updateValue(t,"import_data"),this.importedSettings=!0}))},text:lng("load info")}):(this.updateValue(t,"import_data"),(0,g.vm)().closeDialog())},data:t,import_id:e});(0,g.vm)().openDialog("form",n)}buildFields(){"Subset"===this.initialValues.group_type?this.serverResponse.is_owner?this._fields=[this.generalSection(),this.displaySection()]:this._fields=[this.displaySection()]:this.createMode||this.serverResponse.is_owner?this._fields=[this.generalSection(),this.enrollmentSection(),this.notificationSection(),this.completionSection(),this.skillsSection(),this.ratingSection(),this.authorizationSection(),this.advancedSection(),this.customFieldsSection(),this.displaySection()]:this.serverResponse.is_config_manager&&(this._fields=[this.displaySection()]);let e=this.isRole||this.createMode&&this.typeCheck(["role"]);this._successButtons=[this.createMode&&{label:lng("create another").caps(),onClick:()=>this.nav(null,{reload:!0})},{label:lng("continue editing").caps(),onClick:()=>this.createMode?this.nav([J,this._newId]):this.status=null},e&&this.createMode&&{label:lng("add members").caps(),onClick:()=>(0,u.p4)({edit:"workspace",id:this._newId,section:"role_members"},!0)},e?{label:lng("go to %s",lng("roles")).caps(),onClick:()=>(0,u.p4)({list:"roles"},!0),primary:!0}:{label:lng("go to the workspace").caps(),onClick:()=>(0,u.p4)({workspace:this._id||this._newId},!0),primary:!0}]}setActiveSection(e){this.nav([J,this.route[0],null==e?void 0:e.sid],{replace:!0})}SaveSuccess(e){if(this._newId=e.id,this._id&&(0,g.vm)().invalidateStore("qualification_issues",{group_id:this._id}),e.repeat_issues_exist&&!this._successButtons.find((e=>"repeat_issues_exist"===e.key))&&this._successButtons.push({key:"repeat_issues_exist",label:lng("resolve repetition issues").caps(),onClick:()=>ee(this._id)}),!this.isRole){(0,g.vm)().invalidateStore("workspace",e.id)}}type(){return this.params.type||(this.serverResponse.data.is_course?"course":this.serverResponse.data.group_type)}typeCheck(e){return e.indexOf(this.type().toLowerCase())>-1}sendMessageToUsersCheck(){this.savePanelMessage="";let e=!1;const t=this.values.get("auto_send_schedule")||2==this.values.get("auto_send_invites")||this.values.get("auto_send_message");if(!t&&this.values.get("notifications")&&this.values.get("notifications").forEach((t=>{"members_added_notification"==t.notification_name&&"user"===t.target_preselect&&(e=!0)})),t||e){const e=this.values.get("autoenrollment_rules");void 0!==e&&(0,m.SC)("rules/preview_rules_for_group",{method:"POST",data:{group_id:this._id,rules:e,only_add:1}},(e=>{parseInt(e.added)>0&&(this.savePanelMessage=lng("saving will send messages to new members").caps())}))}}generalSection(){return{type:"section",title:lng("general"),fields:[this.basicSection(),this.informationSection(),this.timingSection(),this.definitionsSection(),this.rolePermissionsSection(),this.fundSection()]}}enrollmentSection(){return{type:"section",title:lng("enrollment"),insert:this.typeCheck(["group","course","course_template","qualification","role","workplan"]),fields:[this.generalEnrollmentSection(),this.rulesEnrollmentSection(),this.enrollmentConditionsSection(),this.memberLimitsSection(),this.rulesManagersEnrollmentSection()]}}notificationSection(){return{type:"section",title:lng("notifications"),insert:this.typeCheck(["group","course","course_template","qualification"]),fields:[this.basicNotificationsSection(),this.customNotificationsSection()]}}completionSection(){return{type:"section",title:lng("completion"),sectionWidth:"800px",insert:this.typeCheck(["group","course","course_template","qualification"]),fields:[this.generalCompletionSection(),this.completionConditionsSection(),this.requiredQualificationsSection(),this.requiredCoursesSection()]}}authorizationSection(){var e,t,i,n;return{type:"section",title:lng("authorization"),sid:"authorization",insert:this.typeCheck(["qualification"]),visible:()=>this.values.get("authorization_qualification"),fields:[{type:"select",name:"group_options[authorization_duration_type]",label:lng("authorization duration"),options:[["",lng("none").caps()],["monthly",lng("monthly").caps()],["yearly",lng("yearly").caps()]]},{visible:e=>!!e.get("group_options[authorization_duration_type]"),type:"row_set",fields:[{type:"component",Render:N.R9,label:lng("authorize qualification for|duration").caps()},{type:"number",name:"group_options[authorization_duration_span]",min:1,required:()=>!!this.values.get("group_options[authorization_duration_type]"),label:lng("duration")},{type:"component",Render:N.R9,label:lng("months"),visible:e=>"monthly"===e.get("group_options[authorization_duration_type]")},{type:"component",Render:N.R9,label:lng("years"),visible:e=>"yearly"===e.get("group_options[authorization_duration_type]")}]},{type:"row_set",fields:[{type:"select",name:"group_options[auth_sequence]",label:lng("approval sequence for authorization").caps(),options:this.sequencesOptions,emptyOption:lng("off"),disable:e=>!e.get("autoenrollment_rules"),grow:99},{type:"component",node:(0,x.tZ)(P.I,{helpText:`${lng("depends on")} ${lng("automatic enrollment rules")}`})}]},{type:"component",name:"group_options[auth_sequence]",Render:F.S,props:{sequencesDataNames:null===(e=this.serverResponse.data)||void 0===e||null===(t=e.sequences_data)||void 0===t?void 0:t.names}},{type:"row_set",fields:[{type:"select",name:"group_options[auth_sequence_exceptional]",label:lng("approval sequence for exceptional authorization").caps(),options:this.sequencesOptions,emptyOption:lng("off"),disable:e=>!e.get("reg_availability_conditions"),grow:99},{type:"component",node:(0,x.tZ)(P.I,{helpText:`${lng("depends on")} ${lng("entrance conditions")}`})}]},{type:"component",name:"group_options[auth_sequence_exceptional]",Render:F.S,props:{sequencesDataNames:null===(i=this.serverResponse.data)||void 0===i||null===(n=i.sequences_data)||void 0===n?void 0:n.names}}]}}advancedSection(){return{type:"section",title:lng("advanced"),insert:this.typeCheck(["group","course","course_template","qualification","workplan","ou"]),mod:this.typeCheck(["qualification","course"])?["","ENT"]:null,fields:[this.additionalSection()]}}displaySection(){return{type:"section",sid:"display",title:lng("display"),insert:this.typeCheck(["group","course","course_template","qualification","workplan","campus","ou","patientcase","subset"]),fields:[this.innerDisplaySection(),this.welcomeMessageSection()]}}innerDisplaySection(){const e=this.typeCheck(["campus"]),t=[];(Blsm.isFeatureEnabled("assignments")||Blsm.isFeatureEnabled("meetings")||Blsm.isFeatureEnabled("catalog"))&&!e&&t.push({val:"components",label:lng("components",{phrase:!0}).caps()}),Blsm.isFeatureEnabled("meetings")&&!e&&t.push({val:"schedule",label:lng("schedule",{phrase:!0}).caps()}),Blsm.isFeatureEnabled("group_tasks")&&!e&&t.push({val:"tasks",label:lng("tasks",{phrase:!0}).caps()}),!Blsm.isFeatureEnabled("catalog")&&!Blsm.isFeatureEnabled("discussions")||e||t.push({val:"social",label:lng("social",{phrase:!0}).caps()}),this.serverResponse.data.welcome_message&&t.push({val:"welcome",label:lng("welcome",{phrase:!0}).caps()});const i=[{val:"0",label:lng("off").caps(),color:a.g.colors.text_placeholder},{val:"2",label:lng("managers only").caps(),color:a.g.colors.warning},{val:"1",label:lng("on").caps(),color:a.g.colors.dominant_main}],n=[{val:"0",label:lng("off").caps(),color:a.g.colors.text_placeholder},{val:"1",label:lng("on").caps(),color:a.g.colors.dominant_main}],r=()=>!(this.getValue("group_options[managers_primary]")||this.getValue("group_options[managers_managers]")||this.getValue("group_options[managers_viewers]")||this.getValue("group_options[managers_inherited]")||this.getValue("group_options[show_members]")),s=()=>{r()&&this.updateValue("0","group_options[users]")};return{type:"section",sid:"inner_display",title:lng("display"),insert:this.typeCheck(["group","course","course_template","qualification","workplan","campus","ou","patientcase","subset"]),fields:[{type:"select",name:"group_options[default_tab]",label:lng("default tab"),options:t,mod:["","ENT"],helpKey:"@group/display/default_tab"},{type:"checkbox",name:"apply_to_sub",label:lng("apply to sub workspaces"),mod:["","ENT"],insert:this.typeCheck(["group","course","qualification","ou"]),helpKey:"@group/display/default_tab/apply_to_sub_workspaces"},{type:"checkbox",name:"group_options[hide_all_learning_unit]",reversed:!0,label:lng('show "%s" learning unit',lng("all"))},{type:"set",insert:Blsm.isFeatureEnabled("assignments")&&!e,fields:[{type:"switcher",name:"group_options[assignments]",label:lng("assignments"),options:i}]},{type:"set",insert:Blsm.isFeatureEnabled("meetings")&&!e,fields:[{type:"switcher",name:"group_options[meetings]",label:lng("schedule",{phrase:!0}),options:i},{type:"indent_set",fields:[{type:"checkbox",name:"enable_food",label:lng("includes lunch"),insert:Blsm.isFeatureEnabled("food")},{type:"checkbox",name:"group_options[show_unattended_message]",mod:["","ENT"],label:lng('show "absent members message" button')}]}]},{type:"set",insert:Blsm.isFeatureEnabled("catalog")&&!e,fields:[{type:"switcher",name:"group_options[catalog]",label:lng("content"),options:i},{type:"indent_set",fields:[{type:"checkbox",name:"group_options[show_official_only]",label:lng("show only official content"),mod:["catalog","ENT"]},{type:"checkbox",name:"group_options[blog]",label:lng("blog",{phrase:!0})}]}]},{type:"set",insert:Blsm.isFeatureEnabled("time_table"),fields:[{type:"switcher",name:"group_options[time_table]",label:lng("time table"),options:i}]},{type:"set",fields:[{type:"switcher",name:"group_options[users]",label:lng("users"),options:i,onValueChange:e=>r()&&e>0&&this.updateValue(!0,"group_options[show_members]")},{type:"indent_set",fields:[{type:"checkbox",name:"group_options[show_members]",label:lng("members"),onValueChange:s},{type:"checkbox",name:"group_options[managers_primary]",label:lng("primary manager"),onValueChange:s},{type:"checkbox",name:"group_options[managers_managers]",label:lng("managers with permissions"),onValueChange:s,mod:["","ENT"]},{type:"checkbox",name:"group_options[managers_viewers]",label:lng("view only managers"),onValueChange:s,mod:["","ENT"]},{type:"checkbox",name:"group_options[managers_inherited]",label:lng("inherited managers"),onValueChange:s,mod:["","ENT"]}]}]},{type:"set",mod:["discussions","ENT"],insert:Blsm.isFeatureEnabled("discussions"),fields:[{type:"switcher",name:"group_options[discussions]",label:lng("discussions",{phrase:!0}),options:i},{type:"indent_set",fields:[{type:"checkbox",name:"group_options[new_discussions]",label:lng("allow new discussions")},{type:"checkbox",name:"group_options[lock_all_discussions]",label:lng("lock all discussions")}]}]},{type:"set",insert:Blsm.isFeatureEnabled("group_tasks")&&!e,fields:[{type:"switcher",name:"group_options[group_tasks]",label:lng("tasks",{phrase:!0}),options:i}]},{type:"number",mod:["","ENT"],label:lng("auto lock closed and on hold tasks for members after"),name:"group_options[auto_lock_tasks]",unit:lng("days")},{type:"set",insert:!e,fields:[{type:"switcher",name:"group_options[ou_report]",label:lng("reports"),options:n}]},{type:"set",mod:["","ENT"],insert:!e,fields:[{type:"switcher",name:"group_options[polls]",label:lng("polls"),options:n}]},{name:"group_options[notice_board]",type:"switcher",label:lng("message board"),options:i,mod:["","ENT"]},{name:"group_options[qualification_path_default]",type:"switcher",label:lng("qualification path default view"),insert:this.typeCheck(["qualification"]),options:[{val:"cards",icon:"view_tiles",label:lng("card view")},{val:"chart",icon:"tree",label:lng("flow chart")},{val:"conditions",icon:"hierarchy",label:lng("conditions tree")}]}]}}basicSection(){const e=[{val:"0",label:lng("visible in home").caps(),helpKey:"@group/general/basic/visibility/visible_in_home"},{val:"1",label:lng("visible only to managers").caps(),helpKey:"@group/general/basic/visibility/visible_only_to_managers"},{val:"2",label:lng("not visible").caps(),helpKey:"@group/general/basic/visibility/not_visible"}],t=(0,n.observer)((function(e){let{value:t}=e;return(0,x.tZ)(o.gT,{color:[a.g.colors.positive,a.g.colors.warning,a.g.colors.negative][t],size:"2.8em"})}));return{type:"section",sid:"basic",title:lng("basic"),fields:[{type:"img",name:"poster",value:Blsm.InitialData.random_poster},{type:"text",name:"group_name",label:lng("name"),required:!0,autoDir:!0},{type:"hidden",name:"import_data"},{type:"richtext",name:"group_description",helpKey:"@group/general/basic/description",label:lng("description"),theme:"fixed",visible:()=>this.refreshRichText},{type:"select",name:"status",label:lng("mode"),mod:["","ENT"],insert:this.typeCheck(["group","course"])&&this.workspace_approval_sequence&&(["draft","approval"].includes(this.serverResponse.data.status)||!this._id),options:[{val:"draft",label:lng("draft").caps()},{val:"approval",label:lng("approval").caps()}]},{type:"row_set",insert:this.typeCheck(["qualification","group","course","budget","course_template","workplan","patientcase"]),mod:["","ENT"],fields:[{type:"select",name:"group_invisible",label:lng("visibility"),options:e,grow:"1",helpKey:"@group/general/basic/visibility"},{type:"component",name:"group_invisible",Render:t,grow:"0"}]},{type:"select",name:"group_theme_id",label:lng("theme"),options:this.serverResponse.data.themes,mod:["","ENT"],insert:this.typeCheck(["ou"]),extra:lng("this theme will apply to all users in this org' unit and it's sub org' units.").caps()},{type:"select",name:"classification_id",label:lng("classification"),required:()=>this.typeCheck(["course_template","course"])&&Blsm.isFeatureEnabled("mandatory_course_classification"),options:this.serverResponse.data.classifications||[],emptyOption:!0,insert:this.typeCheck(["group","course","course_template","qualification","workplan"]),helpKey:"@group/general/basic/classification"},{type:"tags",name:"tags",label:lng("tags"),objectType:"Group",mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification","workplan"]),helpKey:"@group/general/basic/tags"},{type:"checkbox",name:"add_user_manager",label:lng("add myself as manager"),value:!0,mod:["","ENT"],insert:!this._id&&!this.typeCheck(["resourcebundle","role","ou"])},{type:"single_item",name:"parent_id",label:lng("select parent"),theme:"bright",poster:!0,mod:["","ENT"],insert:this.typeCheck(["ou"]),helpKey:"@ou/general/basic/parent",searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:["Ou"],term:e.term,id:e.ids}},t)}}]}}welcomeMessageSection(){return{type:"section",sid:"welcome",mod:["","ENT"],title:lng("welcome message"),fields:[{type:"component",node:(0,x.tZ)("div",{style:{textAlign:"center",color:a.g.colors.text_sec},children:lng("this will appear in the %s tab",lng("welcome",{phrase:!0})).caps()})},{type:"richtext",name:"welcome_message",style:{lineHeight:"1.8em"},toolbarOptions:{font:!0,color:!0,link:!0,media:!0,media_link:!0,list:!0,align:!0}},{type:"checkbox",name:"show_welcome_on_first_visit",label:lng("show on first visit"),disable:e=>!e.get("welcome_message")}]}}timingSection(){var e=this;const t=function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!0;if(e.values.get("group_close_date")&&e.values.get("group_open_date")){if(i=(0,v._3)(e.values.get("group_close_date")).isAfter((0,v._3)(e.values.get("group_open_date"))),!i&&t)return{error:lng("open date cannot be later than close date.")};const n=(0,v._3)(e.values.get("group_close_date")).diff((0,v._3)(e.values.get("group_open_date")).endOf("day"),"months",!0);if(e.typeCheck(["course"])&&Blsm.isFeatureEnabled("courses_limit_dates_range")&&n>18&&(i=!1,t))return{error:window.Branch.lng("close date cannot be more than 18 months after open date")}}return i||e.updateValue(0,"move_meetings"),i},i=()=>{const e=this.values.get("group_open_date"),t=(0,v._3)(e),i=this.values.get("group_close_date");if(e){var n;if(this.activityDaysDiff>=0&&0!==(null===(n=this.lastOpenMoment)||void 0===n?void 0:n.diff(t,"days"))&&i){const e=i.split(" ")[1],n=t.clone().add(this.activityDaysDiff,"days"),r=(0,v.k6)(n,{time:!1});this.updateValue(r+" "+e,"group_close_date"),this._id&&!this.values.get("move_meetings")&&this.isEnterprise&&(0,p.BB)(lng("do you want to move all events, meetings and assignments dates accordingly?"),{onConfirm:()=>this.values.set("move_meetings",1)})}this.lastOpenMoment=t}if(e&&i){const e=(0,v._3)(this.values.get("group_close_date"));this.activityDaysDiff=Math.max(0,e.diff(t,"days"))}},n=this.typeCheck(["course"])&&this.serverResponse.data.required_course_dates;return{type:"section",sid:"timing",title:lng("timing"),insert:this.typeCheck(["group","course","course_template","qualification","workplan"]),fields:[{type:"checkbox",name:"activity_dates",label:lng("activity dates"),helpKey:"@group/general/timing/activity_dates",disable:e=>void 0!==e.get("repeat_type")&&"none"!==e.get("repeat_type"),onValueChange:()=>this.displayInCatalogCheck(),required:n},{type:"indent_set",visible:e=>!!e.get("activity_dates"),fields:[{type:"row_set",disable:e=>!!e.get("inherit_dates_from_meetings"),fields:[{type:"date_time",name:"group_open_date",label:lng("open date"),defaultTime:["00","00"],onBlur:()=>i(),required:n},{type:"date_time",name:"group_close_date",label:lng("close date"),defaultTime:["23","59"],onBlur:()=>i(),validate:()=>t(),required:n}]},{type:"checkbox",name:"move_meetings",label:lng("move meetings"),disable:()=>!t(!1),mod:["","ENT"]},{type:"checkbox",name:"inherit_dates_from_meetings",label:lng("derive from meetings"),mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification"]),helpKey:"@group/general/timing/activity_dates/derive_from_meetings",onValueChange:e=>{e&&this._id?(0,m.SC)("groups/derive_from_meetings",{data:{group_id:this._id}},(e=>{this.updateValue(e.start,"group_open_date"),this.updateValue(e.end,"group_close_date")})):(this.updateValue("","group_open_date"),this.updateValue("","group_close_date"))}},{type:"row_set",insert:Blsm.isFeatureEnabled("digital_library"),fields:[{type:"component",Render:N.R9,label:lng("estimated duration").caps()+":"},{type:"number",name:"estimated_duration[val]",min:0},{type:"select",name:"estimated_duration[unit]",options:{hours:lng("hours"),days:lng("days"),weeks:lng("weeks")},value:lng("weeks")}]},{type:"set",insert:this.typeCheck(["group","course","course_template","qualification"]),mod:["","ENT"],fields:[{type:"row_set",fields:[{type:"component",Render:N.R9,label:lng("available to members").caps()+":"}]},{type:"row_set",fields:[{type:"number",name:"view_pre_days",placeholder:"0",disable:e=>!!e.get("view_pre_days_always"),min:0,helpKey:"@group/general/timing/activity_dates/available_days_before_open"},{type:"checkbox",name:"view_pre_days_always",label:lng("infinite")},{type:"component",Render:N.R9,label:lng("days before open date"),grow:2}]},{type:"row_set",fields:[{type:"number",name:"view_post_days",placeholder:"0",disable:e=>!!e.get("view_post_days_always"),min:0,helpKey:"@group/general/timing/activity_dates/available_days_before_close"},{type:"checkbox",name:"view_post_days_always",label:lng("infinite")},{type:"component",Render:N.R9,label:lng("days after close date"),grow:2}]}]},{type:"row_set",visible:e=>!!e.get("group_close_date")||!!e.get("inherit_dates_from_meetings"),mod:["","ENT"],fields:[{type:"checkbox",name:"cancel_grade_at_close",label:lng("publish grades"),reversed:!0,helpKey:"@group/general/timing/publish_grades_on_close_date"},{type:"number",name:"days_after_close_to_publish_grades",disable:e=>!!e.get("cancel_grade_at_close"),min:0},{type:"component",Render:N.R9,label:lng("days after close date")}]}]},{type:"row_set",mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification"]),helpKey:"@group/general/timing/expired_period_for_members",fields:[{type:"component",Render:N.R9,label:lng("disable for members").caps()},{type:"number",name:"member_expire",min:0},{type:"component",Render:N.R9,label:lng("days after joining")}]},{type:"indent_set",visible:e=>!!e.get("member_expire"),mod:["","ENT"],fields:[{type:"checkbox",label:lng("apply to current members"),name:"retroactive_member_expire",helpKey:"@group/general/timing/apply_to_current_members"}]},{type:"row_set",mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification"]),helpKey:"@group/general/timing/required_period_for_members",fields:[{type:"component",Render:N.R9,label:lng("required period for members").caps()+":"},{type:"number",name:"required_period[0]",min:0,label:lng("years")},{type:"number",name:"required_period[1]",min:0,label:lng("months")},{type:"number",name:"required_period[2]",min:0,label:lng("days")}]},{type:"row_set",fields:[{type:"select",name:"repeat_type",label:lng("repeats"),insert:Blsm.isFeatureEnabled("repetition")&&this.typeCheck(["qualification"]),options:[["none",lng("does not repeat").caps()],["daily",lng("daily").caps()],["weekly",lng("weekly").caps()],["monthly",lng("monthly").caps()],["yearly",lng("yearly").caps()],["doy",lng("day of year").caps()],["from_required_qualifications",lng("according to required qualifications").caps()],["manual","API"]],onValueChange:e=>e&&this.updateValue("","activity_dates")},{type:"component",Render:N.R9,label:lng("this qualification is cyclic").caps(),bg:a.g.colors.dominant_orange,visible:e=>"none"!==e.get("repeat_type"),insert:Blsm.isFeatureEnabled("repetition")&&this.typeCheck(["qualification"])}]},{type:"set",insert:Blsm.isFeatureEnabled("repetition")&&this.typeCheck(["qualification"]),visible:e=>!["none","manual"].includes(e.get("repeat_type")),fields:[{visible:e=>te.includes(e.get("repeat_type")),type:"row_set",helpKey:"@qualification/general/timing/repeat_type",fields:[{type:"component",Render:N.R9,label:lng("repeat every").caps()},{type:"number",name:"repeat_span",min:1,max:30},{type:"component",Render:N.R9,label:lng("days"),visible:e=>"daily"===e.get("repeat_type")},{type:"component",Render:N.R9,label:lng("weeks"),visible:e=>"weekly"===e.get("repeat_type")},{type:"component",Render:N.R9,label:lng("months"),visible:e=>"monthly"===e.get("repeat_type")},{type:"component",Render:N.R9,label:lng("years"),visible:e=>"yearly"===e.get("repeat_type")}]},{mod:["repetition","ENT"],visible:e=>"doy"===e.get("repeat_type"),type:"row_set",helpKey:"@qualification/general/timing/repeat_doy_month",fields:[{type:"select",name:"repeat_doy_month",options:(0,r.w6)(12).map((e=>[e+1,moment().month(e).format("MMMM")])),onValueChange:e=>this.fieldsByName.get("repeat_doy_day").max=moment(`1970-${e.toString().padStart(2,"0")}`).daysInMonth()},{type:"number",name:"repeat_doy_day",min:1,max:31}]},{mod:["repetition","ENT"],visible:()=>te.includes(this.values.get("repeat_type")),type:"select",name:"repeat_mode",options:[["first_success",lng("after first successful performance")],["from_last",lng("from the last successful performance")],["each_success",lng("for each successful performance")]]},{mod:["repetition","ENT"],visible:()=>["doy",...te].includes(this.values.get("repeat_type")),type:"row_set",fields:[{type:"component",Render:N.R9,label:lng("reopen %s days before expiration date").caps().split("%s")[0]},{type:"number",name:"repeat_period",min:0},{type:"component",Render:N.R9,label:lng("reopen %s days before expiration date").caps().split("%s")[1]}]},{mod:["repetition","ENT"],visible:()=>te.includes(this.values.get("repeat_type")),type:"row_set",fields:[{type:"component",Render:N.R9,label:lng("ends").caps()+":"},{type:"radio",name:"repeat_ends",radioValue:"0",label:lng("never")},{type:"radio",name:"repeat_ends",radioValue:"1",label:lng("on")},{type:"date_time",name:"repeat_end_date",disable:e=>"0"===e.get("repeat_ends"),grow:2}]}]}]}}informationSection(){var e,t;const i=this.typeCheck(["group","course","course_template"])?["Group","Workplan"]:this.typeCheck(["qualification"])?["Qualification"]:["Ou"];return{type:"section",sid:"info",title:lng("information"),insert:this.typeCheck(["group","course","course_template","qualification"]),mod:this.typeCheck(["group"])?["","ENT"]:null,fields:[{type:"single_item",name:"origin_group",label:lng("instance of template"),mod:["","ENT"],insert:this.typeCheck(["course"]),helpKey:"@course/general/information/template",searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:["Course_template"],term:e.term||"",id:e.ids||""}},t)},onSelect:e=>{this._id||this.loadImportDialog(e.id)}},{type:"single_item",name:"parent_id",label:lng("select parent"),theme:"bright",poster:!0,mod:["","ENT"],insert:this.typeCheck(["group","course","qualification","course_template"]),helpKey:"@group/general/information/select_parent",searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:i,term:e.term,id:e.ids}},t)}},{type:"single_item",name:"workplan_id",label:lng("attach to workplan"),theme:"bright",poster:!0,mod:["","ENT"],insert:this.typeCheck(["course"])&&Blsm.isFeatureEnabled("workplan"),searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:["Workplan"],term:e.term,id:e.ids}},t)}},{type:"text",suggest:{table:"groups"},name:"group_audience",label:lng("audience"),mod:["","ENT"],autoDir:!0,insert:this.typeCheck(["group","course","course_template"])},{type:"text",suggest:{table:"groups"},name:"group_location",label:lng("location"),mod:["","ENT"],autoDir:!0,insert:this.typeCheck(["group","course","course_template"]),helpKey:"@group/general/information/location"},{type:"text",suggest:{table:"groups"},name:"group_gathering_area",label:lng("gathering area"),mod:["","ENT"],autoDir:!0,insert:this.typeCheck(["group","course","course_template"])},{type:"text",name:"slack_webhook",label:"Slack webhook",mod:["slack","ENT"],insert:Blsm.isFeatureEnabled("slack"),onValueChange:e=>{e.startsWith("https://hooks.slack.com/services/")&&this.values.set("slack_webhook",e.split("https://hooks.slack.com/services/")[1])}},{type:"checkbox",label:lng("add syllabus"),name:"add_syllabus",mod:["","ENT"],insert:this.typeCheck(["group","course","course_template"]),helpKey:"@group/general/information/add_syllabus"},{type:"set",visible:()=>this.values.get("add_syllabus"),fields:[{type:"component",visible:()=>this.values.get("add_syllabus"),node:(0,x.tZ)("h3",{children:lng("syllabus").caps()})},{type:"row_set",fields:[{type:"radio",name:"syllabus_type",radioValue:"file",label:lng("upload file").caps()},{type:"radio",name:"syllabus_type",radioValue:"text",label:lng("text").caps()},{type:"radio",name:"syllabus_type",radioValue:"url",label:lng("link").caps()}]},{type:"file",name:"syllabus_file",label:lng("syllabus file"),visible:e=>"file"===e.get("syllabus_type"),maxSize:Blsm.InitialData.parameters.max_file_size.default},{type:"text",name:"syllabus_url",label:lng("syllabus link"),visible:e=>"url"===e.get("syllabus_type")},{type:"textarea",name:"syllabus_text",label:lng("syllabus text"),visible:e=>"text"===e.get("syllabus_type")}]},{type:"checkbox",label:lng('display "%s" button',lng("meetings and more details").caps()),name:"summary_data[on]",mod:["","ENT"],insert:this.typeCheck(["group","course","course_template"]),helpKey:"@group/general/information/add_summary"},{type:"indent_set",visible:e=>e.get("summary_data[on]"),fields:[{type:"title",label:lng("select the information to be displayed").caps(),props:{color:a.g.colors.text_main}},{type:"checkbox",value:1,label:lng("name").caps(),disabled:!0},{type:"checkbox",value:1,label:lng("image").caps(),disabled:!0},{type:"checkbox",value:1,label:lng("description").caps(),disabled:!0},{type:"checkbox",value:1,label:lng("activity dates").caps(),disabled:!0},{type:"checkbox",value:1,label:lng("location").caps(),disabled:!0},{type:"checkbox",name:"summary_data[audience]",label:lng("audience").caps()},{type:"checkbox",name:"summary_data[passing_grade]",label:lng("passing score").caps()},{type:"checkbox",name:"summary_data[percentage]",label:lng("required percentage of attendance & assignments").caps()},{type:"checkbox",name:"summary_data[meetings_list]",label:lng("meetings").caps()},{type:"checkbox",name:"summary_data[sum_hours]",label:lng("total hours").caps()},{type:"checkbox",name:"summary_data_use_custom_fields",label:lng("custom fields").caps(),insert:(null===(e=this.serverResponse.data.custom_fields)||void 0===e?void 0:e.length)>0},(null===(t=this.serverResponse.data.custom_fields)||void 0===t?void 0:t.length)>0&&this.groupSummaryCustomFields()]}]}}definitionsSection(){return{type:"section",sid:"definitions",title:lng("definitions"),mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification"]),fields:[{type:"checkbox",name:"compliance",label:lng("mark this workspace as compliance"),insert:Blsm.isFeatureEnabled("compliance_module")&&this.typeCheck(["group","course","course_template","qualification"]),helpKey:"@group/general/definitions/make_workspace_compliance"},{type:"checkbox",name:"competency_relevant",label:lng("relevant to competency"),insert:this.typeCheck(["group","course","course_template","qualification"])&&Blsm.isFeatureEnabled("competency"),helpKey:"@group/general/definitions/relevant_to_competency"},{type:"checkbox",name:"special_qualification",label:lng("mark this as qualification role"),insert:this.typeCheck(["qualification"]),helpKey:"@qualification/general/definitions/mark_qualification_role"},{type:"checkbox",name:"certification",label:lng("mark this as certification"),insert:this.typeCheck(["qualification"]),helpKey:"@qualification/general/definitions/mark_certification"},{type:"checkbox",name:"authorization_qualification",label:lng("mark this as authorization"),insert:this.typeCheck(["qualification"])&&Blsm.isFeatureEnabled("authorization_qualification")},{type:"checkbox",name:"profession",label:lng("mark this as a profession"),insert:this.typeCheck(["qualification"])&&Blsm.isFeatureEnabled("professions"),helpKey:"@qualification/general/definitions/mark_profession"},{type:"select",name:"level_value",options:(this.serverResponse.data.levels||[]).map((e=>[e.level_value,(0,b.h1)(e)])),emptyOption:!0,label:lng("professional level"),insert:this.typeCheck(["qualification"])&&Blsm.isFeatureEnabled("professions"),helpKey:"@qualification/general/definitions/professional_level"}]}}rolePermissionsSection(){return{type:"section",sid:"rolePermissions",title:lng("role permissions"),insert:this.typeCheck(["role"]),fields:[{type:"checkbox",name:"role_permissions[catalog_manager]",label:lng("knowledge manager")},{type:"checkbox",name:"role_permissions[portal_manager]",label:lng("portal manager"),mod:["","ENT"]},{type:"checkbox",name:"role_permissions[resources]",label:lng("resource manager"),mod:["","ENT"]},{type:"checkbox",name:"role_permissions[group_admin]",label:lng("group admin")},{type:"indent_set",mod:["","ENT"],fields:[{type:"checkbox",name:"role_permissions[group_admin]",label:lng("can only create template instances"),checkboxValue:"2"}]},{type:"checkbox",name:"role_permissions[ous_admin]",label:lng("org' unit admin"),mod:["","ENT"]},{type:"checkbox",name:"role_permissions[qualifications]",label:lng("qualification admin"),mod:["","ENT"]},{type:"checkbox",name:"role_permissions[users_admin]",label:lng("user admin")},{type:"indent_set",mod:["","ENT"],fields:[{type:"checkbox",name:"role_permissions[users_admin]",label:lng("relative to the org' unit of the user"),checkboxValue:"2"}]},{type:"checkbox",name:"role_permissions[blogs]",label:lng("blogger"),mod:["","ENT"]},{type:"checkbox",name:"role_permissions[case_manager]",label:lng("case manager"),mod:["","ENT"]}]}}fundSection(){return{type:"section",sid:"fund",title:lng("fund"),mod:["course_funding","ENT"],insert:this.typeCheck(["role"])&&Blsm.isFeatureEnabled("course_funding"),fields:[{type:"checkbox",name:"is_fund",label:lng("fund"),onValueChange:e=>{e||this.updateValue("","funding_pct")}},{type:"indent_set",visible:()=>!!this.values.get("is_fund"),fields:[{type:"number",name:"funding_pct",label:lng("funding percent"),min:1,max:100,required:()=>!!this.values.get("is_fund")}]}]}}generalEnrollmentSection(){var e,t;const i=[{val:"private",label:lng("private").caps()+" - "+lng("owner only").caps()}];!this.isEnterprise&&this.typeCheck(["course","course_template","qualification","group"])||i.push({val:"manager_register",label:lng("departmental").caps()+" - "+lng("org' unit managers add their own users").caps()});const n=[{optgroup:!0,label:lng("controlled by managers").caps(),options:i}];if(Blsm.isFeatureEnabled("course_registartion")&&(Blsm.checkMod(["course_registartion","ENT"])||!this.typeCheck(["group"]))){const e=[{val:"register",label:lng("requested").caps()+" - "+lng("requires an approval sequence").caps()},{val:"public",label:lng("public").caps()+" - "+lng("anyone can join").caps()}];n.push({optgroup:!0,label:lng("user registration").caps(),options:e})}return{type:"section",sid:"enrollment",title:lng("general"),insert:this.typeCheck(["group","course","course_template","qualification"]),fields:[{type:"select",name:"group_access",label:lng("workspace accessibility"),options:n,onValueChange:()=>this.displayInCatalogCheck()},{type:"checkbox",name:"group_options[display_in_catalog]",label:lng("display in the catalog"),mod:["course_registartion","ENT"],insert:Blsm.isFeatureEnabled("course_registartion")&&this.typeCheck(["course","course_template","qualification"]),disable:e=>!e.get("activity_dates"),visible:e=>["private","manager_register"].includes(e.get("group_access")),helpKey:"@group/enrollment/general/display_in_catalog"},{type:"checkbox",name:"group_reg_dates",label:lng("registration dates"),disable:e=>"private"===e.get("group_access"),mod:["","ENT"],helpKey:"@group/enrollment/general/registration_dates"},{type:"checkbox",name:"group_options[hide_with_link]",label:lng("hide from catalog with link"),visible:e=>["public","register"].includes(e.get("group_access")),mod:["","ENT"],insert:this.typeCheck(["course","course_template"]),helpKey:"@group/enrollment/general/hide_with_link"},{type:"indent_set",visible:e=>!!e.get("group_reg_dates")&&"private"!==e.get("group_access"),fields:[{type:"row_set",fields:[{type:"date_time",name:"registration_start_date",label:lng("registration open"),mod:["","ENT"],defaultTime:["00","00"],maxDate:()=>moment(this.values.get("registration_end_date"),Blsm.prm.date_moment_format)},{type:"date_time",name:"registration_end_date",label:lng("registration close"),mod:["","ENT"],defaultTime:["23","59"],minDate:()=>moment(this.values.get("registration_start_date"),Blsm.prm.date_moment_format)}]}]},{type:"row_set",helpKey:"@group/enrollment/general/approval_sequence",mod:this.typeCheck(["group"])?["","ENT"]:null,fields:[{type:"select",name:"sequence_id",label:lng("approval sequence").caps(),options:this.sequencesOptions,emptyOption:lng("off"),disable:e=>"public"===e.get("group_access")||!this.isEnterprise&&"register"!==e.get("group_access"),required:()=>"register"===this.values.get("group_access")},{type:"date_time",name:"sequence_start_date",label:`${lng("starts at")} (${lng("optional")})`,mod:["","ENT"]}]},{type:"component",name:"sequence_id",Render:F.S,props:{sequencesDataNames:null===(e=this.serverResponse.data)||void 0===e||null===(t=e.sequences_data)||void 0===t?void 0:t.names}},{type:"checkbox",name:"allow_multiple_instances",label:lng("after completing an instance the user can register to another one"),mod:["","ENT"],insert:this.typeCheck(["course_template"])},{type:"indent_set",visible:e=>!!e.get("allow_multiple_instances"),fields:[{type:"checkbox",name:"multiple_only_when_failed",label:lng("only when failed"),mod:["","ENT"]}]},{type:"textarea",name:"registration_extra_info",label:lng("extra information for the course catalog"),mod:["","ENT"],helpKey:"@group/enrollment/general/extra_information"},{type:"select",name:"registration_type",label:lng("registration type"),insert:this.typeCheck(["course_template"]),options:[{val:"reg_to_instances",label:lng("instance selection by the user").caps()},{val:"reg_to_template",label:lng("register to template").caps()}]},{type:"checkbox",name:"show_to_anonymous",label:lng("show in anonymous catalog"),mod:["","ENT"],insert:this.typeCheck(["group","course","course_template"]),helpKey:"@group/enrollment/general/show_in_annonymous_catalog"}]}}displayInCatalogCheck(){const e=this.values.get("group_access"),t=this.values.get("activity_dates");["private","manager_register"].includes(e)&&t||this.updateValue(0,"group_options[display_in_catalog]")}rulesEnrollmentSection(){var e;const t=(0,r.Ds)((()=>this.sendMessageToUsersCheck()),2e3);return{type:"section",sid:"autoEnrollment",title:lng("automatic enrollment rules"),sectionWidth:"800px",insert:this.typeCheck(["group","course","course_template","qualification","role","workplan"]),mod:this.typeCheck(["role"])?["","ENT"]:null,fields:[{type:"component",name:"autoenrollment_rules",Render:l._,value:this.serverResponse.data.autoenrollment_rules,visible:e=>!e.get("clear_rules_and_keep_users"),props:{object_type:"users",checkRules:!0,checkRulesData:{object_id:this._id,req_type:"check_auto_enrollment",domain_id:this.domain_id,getOnlyAdd:()=>this.values.get("only_add"),getMaxUsers:()=>this.values.get("max_users")},collisionCheck:!0,onChange:e=>(this.values.set("autoenrollment_rules",e),t())}},{type:"indent_set",mod:["","ENT"],fields:[{type:"checkbox",name:"clear_rules_and_keep_users",label:lng("delete the rules and preserve current members"),helpKey:"@group/enrollment/autoenrollment/clear_rules_and_preserve_current_users"},{type:"checkbox",name:"only_add",label:lng("only add users"),value:null===(e=this.initialValues.autoenrollment_rules)||void 0===e?void 0:e.only_add,helpKey:"@group/enrollment/autoenrollment/only_add_users"}]}]}}rulesManagersEnrollmentSection(){var e,t;const i=(0,z.xI)(this,{data:this.serverResponse.data,prefix:"managers_autoenrollment",initialValue:null===(e=this.serverResponse.data.managers_autoenrollment_rules)||void 0===e?void 0:e.mpt_id,permissionSelectFieldName:"managers_autoenrollment_rules[mpt_id]",preview:!0});return{type:"section",sid:"managersAutoEnrollment",title:lng("automatic manager assigning rules"),sectionWidth:"800px",mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification","workplan"]),fields:[{type:"component",name:"managers_autoenrollment_rules",Render:l._,value:this.serverResponse.data.managers_autoenrollment_rules,visible:e=>!e.get("clear_rules_and_keep_managers"),props:{object_type:"users",checkRules:!0,checkRulesData:{object_id:this._id,req_type:"check_auto_enrollment",domain_id:this.domain_id,getOnlyAdd:()=>this.values.get("only_add"),getMaxUsers:()=>this.values.get("max_users")},for_managers:!0}},{type:"indent_set",mod:["","ENT"],fields:[{type:"checkbox",name:"clear_rules_and_keep_managers",label:lng("delete the rules and preserve current managers"),helpKey:"@group/enrollment/autoenrollment/clear_rules_and_preserve_current_users"},{type:"checkbox",name:"only_add_managers",label:lng("only add managers"),value:null===(t=this.initialValues.autoenrollment_rules)||void 0===t?void 0:t.only_add_managers,helpKey:"@group/enrollment/autoenrollment/only_add_users"},...i]}]}}enrollmentConditionsSection(){var e,t;return{type:"section",sid:"enrollmentConditions",title:lng("entrance conditions"),sectionWidth:"800px",mod:this.typeCheck(["group"])?["","ENT"]:null,insert:this.typeCheck(["group","course","course_template","qualification"]),fields:[{type:"component",Render:N.R9,skinny:!0,mod:["","ENT"],label:lng("registration availability conditions").caps(),helpKey:"@group/enrollment/conditions/reg_availability_conditions"},{mod:["","ENT"],type:"component",name:"reg_availability_conditions",Render:l._,value:this.serverResponse.data.reg_availability_conditions,props:{object_type:"users",checkRules:!0,checkRulesData:{object_id:this._id,req_type:"check_reg_availability",domain_id:this.domain_id}}},{type:"row_set",insert:this.typeCheck(["qualification"]),fields:[{type:"component",Render:N.R9,label:lng("required seniority").caps()+":"},{type:"number",name:"required_seniority[0]",min:0,label:lng("years")},{type:"number",name:"required_seniority[1]",min:0,label:lng("months")},{type:"number",name:"required_seniority[2]",min:0,label:lng("days")}]},{type:"set",visible:e=>"manager_register"===e.get("group_access"),fields:[{type:"component",Render:N.R9,label:lng("handling registration conditions exceptions").caps()},{type:"indent_set",mod:["","ENT"],fields:[{type:"component",Render:N.R9,label:lng("sequence for approving users that don't meet conditions").caps()+":",skinny:!0},{type:"select",name:"exceptions_approval_sequence",options:this.sequencesOptions,emptyOption:lng("off")},{type:"component",name:"exceptions_approval_sequence",Render:F.S,props:{sequencesDataNames:null===(e=this.serverResponse.data)||void 0===e||null===(t=e.sequences_data)||void 0===t?void 0:t.names}}]}]},{type:"checkbox",name:"complete_sub_qualifications",label:lng("complete required qualifications to enter"),insert:this.typeCheck(["qualification"])},{type:"multiple_items",name:"reg_condition_courses",label:lng("prerequisite courses & qualifications"),poster:!0,theme:"bright",maxItems:this.isEnterprise?0:1,searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php?",{data:{req:"AutoComplete",owned:1,types:["Group","Course_template","Qualification"],term:e.term,id:e.ids}},t)}}]}}memberLimitsSection(){return{type:"section",sid:"memberLimits",title:lng("member limits"),insert:this.typeCheck(["group","course","course_template","qualification"]),mod:this.typeCheck(["qualification"])?["","ENT"]:null,fields:[{type:"row_set",helpKey:"@group/enrollment/member_limits/setter",fields:[{type:"number",name:"min_users",label:lng("minimum")},{type:"number",name:"max_users",label:lng("maximum")}]},{type:"checkbox",name:"limit_reminder_cb",label:lng("minimum limit alert"),mod:["","ENT"]},{type:"indent_set",mod:["","ENT"],visible:e=>!!e.get("limit_reminder_cb"),fields:[{type:"row_set",fields:[{type:"component",Render:N.R9,label:lng("send minimum limit alert").caps()},{type:"number",name:"limit_reminder",max:30},{type:"component",Render:N.R9,label:lng("days before start")}]}]},Q({type:"number",name:"expected_participants",label:lng("expected number of participants"),mod:["","ENT"]}),{type:"checkbox",name:"cancel_leave_on_public",label:lng("prevent members from leaving"),mod:["","ENT"],visible:e=>"public"===e.get("group_access")},{type:"checkbox",name:"waiting_list_active",label:lng("enable waiting list")},{type:"indent_set",mod:["","ENT"],fields:[{type:"checkbox",name:"waiting_list_active",checkboxValue:"2",label:lng("auto reject all users in the waiting list on the opening date")},{type:"system_message",name:"group_options[auto_reject_message]",label:lng("select custom message (leave empty for default message)"),visible:e=>2==e.get("waiting_list_active"),messageType:"waiting_list_auto_reject"}]},this.orgUnitAllocationSection()]}}orgUnitAllocationSection(){return{type:"section",sid:"ouAllocation",title:lng("org' unit allocations"),mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification"]),fields:[{type:"multiple_items",name:"ou_allocations",poster:!0,theme:"bright",valueIsMap:!0,label:lng("restrict allocations for org' units"),objectKeys:["id","allocation","use_sub_groups"],helpKey:"@group/enrollment/member_limits/restrict_allocations/amount",searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php?",{data:{req:"AutoComplete",owned:1,types:["Ou"],term:e.term,id:e.ids}},t)},buttons:[{Render:N.xE,onChange:(e,t)=>{let{value:i}=t;return e.allocation=i,e}},{Render:N.Kz,onChange:e=>(e.use_sub_groups=!e.use_sub_groups,e)}]}]}}basicNotificationsSection(){const e=lng("send members a reminder about meetings %s days before").split("%s"),t=lng("send manager a reminder about meetings with no attendance every %s days after it ended").split("%s"),i=lng("send manager a reminder about unpublished grades every %s days after the course closed").split("%s");return{type:"section",sid:"basicNotifications",title:lng("basic notifications"),fields:[{type:"set",insert:this.typeCheck(["qualification"]),visible:e=>!!e.get("group_close_date"),fields:[{type:"checkbox",name:"late_finish_message_cb",label:lng("immediate message for users that complete after the closing date"),onValueChange:e=>!e&&this.values.set("owner_options[late_finish_message]",e),mod:["","ENT"]},{type:"indent_set",visible:e=>e.get("late_finish_message_cb"),fields:[{type:"system_message",name:"owner_options[late_finish_message]",label:lng("select message"),mod:["","ENT"],messageType:"late_group_completion",insert:this.typeCheck(["qualification"])}]}]},{type:"checkbox",name:"auto_send_schedule",label:lng("send members the schedule and the assignment list when they join or are added"),mod:["","ENT"],onValueChange:()=>this.sendMessageToUsersCheck(),insert:this.typeCheck(["course","group","qualification","course_template"]),helpKey:"@group/notifications/basic/send_schedule_and_assignment"},{type:"set",fields:[{type:"checkbox",name:"auto_send_invites",checkboxValue:"1",checkedWithGreaterValue:!0,label:lng("send members the invites for the schedule when they join or are added (an email per meeting)"),insert:this.typeCheck(["course","group","qualification","course_template"]),helpKey:"@group/notifications/basic/send_invites"},{type:"indent_set",fields:[{type:"checkbox",name:"auto_send_invites",checkboxValue:"2",label:lng("include members added by automatic enrollment rules"),onValueChange:()=>this.sendMessageToUsersCheck()}]}]},{type:"set",insert:this.typeCheck(["course","group","qualification","course_template"]),fields:[{type:"checkbox",name:"auto_send_message",label:lng("send members a message when they join or are added"),helpKey:"@group/notifications/basic/send_message_when_joined",onValueChange:()=>this.sendMessageToUsersCheck()},{type:"indent_set",mod:["","ENT"],visible:e=>e.get("auto_send_message"),fields:[{type:"checkbox",name:"owner_options[auto_send_message_sms]",label:lng("send an SMS if possible"),helpKey:"@notification/sms"},{type:"system_message",name:"auto_message_id",label:lng("select custom message")+" ("+lng("leave empty for default message")+")",placeholder:lng("default message").caps(),helpKey:"@group/notifications/basic/select_message",messageType:"member_join_group",mod:["","ENT"]}]}]},{type:"checkbox",name:"auto_send_message_direct_manager",label:lng("send members direct manager group schedule when members join or are added"),mod:["","ENT"],insert:this.typeCheck(["course","group","qualification","course_template"]),helpKey:"@group/notifications/basic/send_schedule_to_members_direct_manager"},{type:"set",mod:["","ENT"],insert:this.typeCheck(["course","group","course_template"]),fields:[{type:"checkbox",name:"reminder_due_date_cb",label:e[0]},{type:"indent_set",fields:[{type:"row_set",inline:!0,fields:[{type:"number",name:"reminder_due_date",min:0,max:14,disable:e=>!e.get("reminder_due_date_cb")},{type:"component",Render:N.R9,skinny:!0,label:e[1]}]}]}]},{type:"set",mod:["","ENT"],insert:this.typeCheck(["course","group","course_template"]),fields:[{type:"checkbox",name:"no_attendance_reminder_enabled",label:t[0]},{type:"indent_set",fields:[{type:"row_set",inline:!0,fields:[{type:"number",name:"no_attendance_reminder",min:1,max:7,disable:e=>!e.get("no_attendance_reminder_enabled"),helpKey:"@group/notifications/basic/no_attendance_reminder"},{type:"component",Render:N.R9,skinny:!0,label:t[1]}]}]}]},{type:"set",mod:["","ENT"],insert:this.typeCheck(["course","group","course_template"]),fields:[{type:"checkbox",name:"unpublished_grades_cb",label:i[0]},{type:"indent_set",fields:[{type:"row_set",inline:!0,fields:[{type:"number",name:"unpublished_grades",min:0,max:14,disable:e=>!e.get("unpublished_grades_cb")},{type:"component",Render:N.R9,skinny:!0,label:i[1]}]}]}]}]}}customNotificationsSection(){const e={late_group_completion:{message:!0,validate:{message:"required"},mod:["","ENT"],insert:this.typeCheck(["qualification"]),disable:()=>!this.values.get("group_close_date")},before_group_start:{helpKey:"@group/notifications/custom/add/reminder_before_starting",sms:!0,disable:()=>!this.values.get("group_open_date"),mod:this.typeCheck(["qualification"])?["","ENT"]:null,message:!0,time:!0,messageType:e=>e?"reminder_course_start":"reminder_course_start_other",sendNow:!0},after_close_date_reminder:{helpKey:"@group/notifications/custom/add/reminder_after_closing",message:!0,sms:!0,messageType:e=>e?"after_close_date_reminder":"after_close_date_reminder_other",disable:()=>!this.values.get("group_close_date"),mod:this.typeCheck(["qualification","course","course_template"])?["","ENT"]:null},required_period_reminder:{helpKey:"@group/notifications/custom/add/reminder_for_required_period",message:!0,sms:!0,messageType:e=>e?"required_period":"required_period_other",mod:["","ENT"],disable:()=>{var e,t,i;return!(null!==(e=this.values.get("required_period"))&&void 0!==e&&e[0]||null!==(t=this.values.get("required_period"))&&void 0!==t&&t[1]||null!==(i=this.values.get("required_period"))&&void 0!==i&&i[2])},sendNow:!0},after_required_period_reminder:{helpKey:"@group/notifications/custom/add/reminder_after_required_period",message:!0,sms:!0,repeat:!0,messageType:e=>e?"after_required_period":"after_required_period_other",mod:["","ENT"],disable:()=>{var e,t,i;return!(null!==(e=this.values.get("required_period"))&&void 0!==e&&e[0]||null!==(t=this.values.get("required_period"))&&void 0!==t&&t[1]||null!==(i=this.values.get("required_period"))&&void 0!==i&&i[2])}},expire_qualification_reminder:{message:!0,sms:!0,insert:this.typeCheck(["qualification"]),messageType:e=>e?"expire_qualification_reminder":"expire_qualification_reminder_members",disable:()=>"none"===this.values.get("repeat_type")},expire_qualification_after_reminder:{message:!0,sms:!0,insert:this.typeCheck(["qualification"]),messageType:e=>e?"expire_qualification_after_reminder":"expire_qualification_after_reminder_members",mod:this.typeCheck(["qualification"])?["","ENT"]:null,disable:()=>"none"===this.values.get("repeat_type"),repeat:!0},meeting_absence_reminder:{helpKey:"@group/notifications/custom/add/notify_about_absence",sms:!0,time:!1,mod:this.typeCheck(["qualification","course","course_template"])?["","ENT"]:null},waiting_list_notification:{message:!0,sms:!0,time:!1,mod:this.typeCheck(["qualification"])?["","ENT"]:null,insert:this.typeCheck(["course","group","qualification","course_template"]),disable:()=>!this.values.get("waiting_list_active"),messageType:e=>e?"waiting_list_enter":"waiting_list_enter_other"},members_added_notification:{sms:!0,message:!0,time:!1,messageType:e=>e?"member_join_group":"member_join_group_other",name:"member_join_group",mod:this.typeCheck(["qualification"])?["","ENT"]:null,insert:this.typeCheck(["course","group","qualification","course_template"])},member_left_notification:{sms:!0,message:!0,time:!1,messageType:"member_left",mod:["","ENT"],insert:this.typeCheck(["course","group","qualification","course_template"])},member_remove_notification:{helpKey:"@group/notifications/custom/add/member_remove_notification",sms:!0,message:!0,time:!1,messageType:"members_removed",mod:["","ENT"],insert:this.typeCheck(["course","group","qualification","course_template"])}},t=()=>({targetFieldsOptions:!this.isEnterprise&&["user","authority"],targetAuthoritiesOptions:!this.isEnterprise&&["manager"]});return{type:"section",sid:"customNotifications",title:lng("custom notifications"),mod:this.typeCheck(["qualification","course"])?null:["","ENT"],fields:[{type:"component",name:"notifications",Render:d.oS,props:{notificationsTypes:e,options:t,objectId:this._id,form:"workspace",onChange:e=>(this.values.set("notifications",e),this.sendMessageToUsersCheck())}},{type:"component",name:"notifications",Render:d.oQ,props:{notificationsTypes:e,options:t,onChange:e=>(this.values.set("notifications",e),this.sendMessageToUsersCheck())}}]}}generalCompletionSection(){let e=[{val:"",label:lng("off").caps()},{val:1,label:lng("user completed all of the %s",lng("assignments")+"/"+lng("meetings")).caps()}];return this.isEnterprise&&e.push({val:2,label:lng("user completed all of the %s",lng("assignments")).caps()},{val:3,label:lng("user attended all meetings").caps()}),{type:"section",sid:"generalCompletion",title:lng("general"),fields:[{type:"checkbox",name:"hide_score",label:lng("hide score"),mod:["","ENT"]},{type:"select",name:"auto_complete_course",label:lng("publish grades when").caps(),options:e,sub:this.typeCheck(["qualification"])?lng("the grade will be published after completing all the qualifications dependencies").caps():void 0},{type:"checkbox",name:"owner_options[ignore_no_weight_assignments]",label:lng("assignments with no weight are ignored in score calculations"),mod:["","ENT"]},Q({type:"number",name:"credit_on_completion",label:lng("credit units given on completion"),min:0,mod:["","ENT"]}),{type:"select",name:"course_certificate",label:lng("diploma"),options:this.serverResponse.data.diplomas,emptyOption:!0,helpKey:"@course/completion/diploma"},{type:"section",title:lng("messages to members on publish"),fields:[{type:"checkbox",name:"auto_message_on_publish[no_success]",label:lng("send message to members that passed when publishing grades automatically"),mod:["","ENT"],reversed:!0},{type:"system_message",name:"auto_message_on_publish[success_message]",label:lng("select custom message for successful users")+" ("+lng("leave empty for default message")+")",mod:["","ENT"],messageType:this.typeCheck(["qualification"])?"qualification_completed":"course_completed"},{type:"checkbox",name:"auto_message_on_publish[no_fail]",label:lng("send message to members that failed when publishing grades automatically"),mod:["","ENT"],reversed:!0},{type:"system_message",name:"auto_message_on_publish[fail_message]",label:lng("select custom message for failed users")+" ("+lng("leave empty for default message")+")",mod:["","ENT"],messageType:"failed_course_notification"}]},{type:"checkbox",name:"publish_score_when_added",label:lng("publish user score when adding a new user and the user dependencies are completed"),mod:["","ENT"],insert:this.typeCheck(["qualification"])},{type:"checkbox",name:"optional_completion",label:lng("set as optional qualification (completion not necessary for parent qualification completion)"),mod:["","ENT"],insert:this.typeCheck(["qualification"])},{type:"set",fields:[{type:"component",Render:N.R9,label:lng("managers can publish grades for").caps()},{type:"radioset",name:"publish_score_only_when_completed",options:[{val:"",label:lng("everyone").caps()},{val:"1",label:lng("members who completed all completion conditions").caps()}]}]}]}}completionConditionsSection(){return{type:"section",sid:"completionConditions",title:lng("completion conditions"),fields:[{type:"range",name:"passing_grade",label:lng("passing score"),value:"0"},{type:"range",name:"required_assignments_completion",label:lng("required assignments completion"),value:"0",sign:"%"},{type:"range",name:"required_meetings_attendance",label:lng("required meetings attendance"),value:"0",sign:"%"},Q({type:"number",name:"teacher_score_weight",label:lng("manager evaluation weight"),mod:["","ENT"]}),Q({type:"number",name:"credit_required",label:lng("credit units required"),mod:["","ENT"],insert:this.typeCheck(["qualification"])})]}}ratingSection(){return{type:"section",sid:"ratingSection",sectionWidth:"1000px",title:lng("rating"),insert:Blsm.isFeatureEnabled("rating_tool")&&Blsm.user.isManager&&this.typeCheck(["qualification","group","course","course_template"]),fields:[{type:"component",Render:Y,props:{onChange:e=>this.values.set("rating[id]",e),id:this._id,values:()=>this.buildFinalValues()}},{type:"set",visible:()=>{var e;return(null===(e=this.values.get("rating"))||void 0===e?void 0:e.id)||this.values.get("rating[id]")},fields:[{type:"component",Render:q.Z,name:"rating",props:{onChange:(e,t)=>this.values.set(e,t),preview:!0}},{type:"richtext",name:"rating[opening_text]",label:lng("opening text").caps(),placeholder:lng("leave empty for default message").caps(),toolbarOptions:{font:!0,color:!0,media:!0,list:!0,align:!0}},{type:"richtext",name:"rating[closing_text]",label:lng("closing text").caps(),placeholder:lng("leave empty for default message").caps(),toolbarOptions:{font:!0,color:!0,media:!0,list:!0,align:!0}},{type:"checkbox",name:"rating[apply_to_managers]",label:lng("rate managers too")},{type:"checkbox",name:"rating[rate_meetings_after_attendance]",label:lng("allow rate meetings on completion")},{type:"set",insert:this.typeCheck(["course","group"]),fields:[{type:"checkbox",name:"rating[enable_rating_activity_dates]",label:lng("set rating survey activity dates"),disable:()=>!this.values.get("group_close_date"),onValueChange:()=>this.updateValue("","rating[lock_rating_span]")},{type:"indent_set",fields:[{label:lng("open the rating survey %s days before close date").split("%s")[0],unit:lng("open the rating survey %s days before close date").split("%s")[1].trim().caps(),type:"number",name:"rating[unlock_rating_span]",min:0,inline:!0,integer:!0,disable:e=>!e.get("rating[enable_rating_activity_dates]")||!e.get("group_close_date")}]},{type:"component",Render:N.R9,wrap:!0,label:lng("send reminder").caps()+":"},{type:"row_set",fields:[{type:"radio",name:"rating[rating_reminder]",radioValue:"dates",label:lng("when survey starts")},{type:"radio",name:"rating[rating_reminder]",radioValue:"publish",label:lng("when grades are published")},{type:"radio",name:"rating[rating_reminder]",radioValue:"",label:lng("never")}]},{type:"system_message",name:"rating[system_message]",label:lng("select custom message (leave empty for default message)"),visible:e=>"publish"===e.get("rating[rating_reminder]")||"dates"===e.get("rating[rating_reminder]")},{type:"checkbox",name:"rating[send_now]",label:lng("send message now")}]}]}]}}skillsSection(){return{type:"section",sid:"skillsSection",sectionWidth:"800px",title:lng("skills"),insert:Blsm.isFeatureEnabled("skills_occupations")&&!this.typeCheck("role"),fields:[{type:"multiple_items",name:"skills",label:lng("skills"),showId:!1,valueIsMap:!0,theme:"bright",objectKeys:["sk_id","skill_level"],buttons:[{Render:W}],searchData:(e,t)=>{(0,m.SC)("skills/autocomplete_skill",{data:{term:e.term||"",id:e.ids||""}},t)}}]}}requiredQualificationsSection(){return{type:"section",sid:"requiredQualifications",insert:this.typeCheck(["qualification"]),title:lng("required qualifications"),fields:[{type:"set",fields:[{type:"component",Render:N.R9,wrap:!0,label:lng("choose other qualifications that are required to complete this qualification").caps()},{type:"multiple_items",name:"required_qualifications",label:lng("select required qualifications"),poster:!0,theme:"bright",valueIsMap:!0,objectKeys:["id","order"],maxItems:this.isEnterprise?0:1,searchData:(e,t)=>{const i={req:"AutoComplete",exclude:null==this?void 0:this._id,owned:1,types:["Qualification"],term:e.term||"",id:e.ids||""};(0,m.SC)("ajax/GroupsAjax.class.php",{data:i},t)},buttons:this.isEnterprise?[{Render:N.Pl,onChange:(e,t)=>{let{value:i}=t;return e.order=i,e}}]:[]},{type:"checkbox",name:"display_condition_components",label:lng("display required qualification components"),mod:["","ENT"]}]},{type:"section",title:lng("equivalent qualifications"),mod:["","ENT"],fields:[{type:"component",Render:N.R9,wrap:!0,label:lng("choose qualifications that trigger automatic completion for this qualification").caps()},{type:"multiple_items",name:"equivalent_qualifications",label:lng("select equivalent qualifications"),poster:!0,theme:"bright",searchData:(e,t)=>{const i={req:"AutoComplete",exclude:null==this?void 0:this._id,owned:1,types:["Qualification"],term:e.term||"",id:e.ids||""};(0,m.SC)("ajax/GroupsAjax.class.php",{data:i},t)}}]}]}}requiredCoursesSection(){const e=[{Render:N.qx,props:{values:this.values},onChange:(e,t)=>{let{value:i}=t;return e.dependency_type=i,e}}];return this.isEnterprise&&e.push({Render:N.yP,props:{disable:()=>this.values.get("minimum_required_courses")>0},onChange:(e,t)=>{let{value:i}=t;return e.optional=i,e}}),{type:"section",sid:"requiredCourses",sectionWidth:"800px",insert:this.typeCheck(["qualification"]),title:lng("required courses"),fields:[{type:"set",fields:[{type:"component",Render:N.R9,wrap:!0,label:lng("choose courses or course templates for the users to complete in order to complete this qualification").caps()},{type:"multiple_items",name:"required_courses",label:lng("select courses and course templates"),poster:!0,theme:"bright",valueIsMap:!0,objectKeys:["id","optional","dependency_type"],maxItems:this.isEnterprise?0:2,searchData:(e,t)=>{let i={req:"AutoComplete",owned:1,types:["Group","Course_template"],term:e.term||"",id:e.ids||""};(0,m.SC)("ajax/GroupsAjax.class.php",{data:i},t)},buttons:e},{type:"row_set",mod:["","ENT"],fields:[{type:"component",Render:N.R9,label:lng("minimum required courses").caps()+":"},{type:"number",name:"minimum_required_courses",min:"0",integer:!0,disable:e=>{var t;return Array.from((null===(t=e.get("required_courses"))||void 0===t?void 0:t.values())||[]).some((e=>!!parseInt(e.optional)))}}]},{type:"checkbox",name:"owner_options[add_users_to_courses]",label:lng("new members will be added to the courses listed above"),mod:["","ENT"],helpKey:"@add_member/add_users_to_courses"},{type:"checkbox",name:"owner_options[publish_non_member_on_condition_complete]",label:lng("publish grades for users that are not members and finished the requirements"),mod:["","ENT"]}]},{type:"checkbox",name:"owner_options[add_users_to_repeat_courses]",label:lng("add users to repeated courses from the list above when needed"),helpKey:"@qualification/completions/required/add_from_the_list",mod:["repetition","ENT"],insert:Blsm.isFeatureEnabled("repetition"),visible:e=>"none"!==e.get("repeat_type")}]}}customFieldsSection(){let e=this._customFieldsPrep(this.serverResponse.data.custom_fields);return{type:"section",sid:"customFields",insert:e.length>0,title:lng("custom fields"),fields:e}}groupSummaryCustomFields(){var e;let t=this.serverResponse.data.custom_fields;return t=t.map((e=>({type:"checkbox",name:`summary_data[custom_fields][${e.field_column}]`,label:e.field_name}))),{type:"indent_set",insert:(null===(e=t)||void 0===e?void 0:e.length)>0,visible:()=>this.values.get("summary_data_use_custom_fields"),title:lng("custom fields"),fields:t}}mailingListSection(){return{type:"section",sid:"mailingList",mod:["","ENT"],insert:this.typeCheck(["group","course","qualification","workplan"]),title:lng("mailing list"),fields:[{type:"multiple_items",name:"mailing_list_groups",label:lng("workspaces"),poster:!0,theme:"bright",helpKey:"@group/advanced/mailing/workspaces",searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:["Group"],term:e.term||"",id:e.ids||""}},t)}},{type:"multiple_items",name:"mailing_list_users",label:lng("users"),poster:!0,theme:"bright",helpKey:"@group/advanced/mailing/users",searchData:(e,t)=>{(0,m.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||""}},t)}}]}}additionalSection(){return{type:"section",sid:"additional",title:lng("additional"),fields:[{type:"checkbox",name:"hide_in_workspaces",label:lng("hide from members"),mod:["","ENT"],helpKey:"@qualification/advanced/additional/hide_in_workspaces"},{type:"checkbox",name:"group_public",label:lng("share ownership"),mod:["","ENT"],insert:this.typeCheck(["group","course","course_template","qualification","workplan"])},{type:"checkbox",name:"manager_cross_report_permission",label:lng("manager cross report permission"),mod:["","ENT"],insert:this.typeCheck(["group"])&&Blsm.user.isPowerManager,helpKey:"@group/advanced/additional/manager_cross_report_permission"},{type:"checkbox",name:"owner_options[watchittoo]",label:lng("group liveclass room"),insert:this.typeCheck(["group","course","workplan"])&&Blsm.InitialData.special.watchittoo},{type:"checkbox",name:"template_guard",label:lng("guard template (limit instance manager permissions)"),mod:["","ENT"],insert:this.typeCheck(["course_template"])},Q({type:"number",name:"estimated_budget",label:lng("estimated budget"),mod:["resources","ENT"],insert:Blsm.isFeatureEnabled("resources")&&this.typeCheck(["group","course","course_template"])}),{type:"row_set",mod:["resources","ENT"],insert:Blsm.isFeatureEnabled("resources")&&this.typeCheck(["group","course","course_template"]),fields:[{type:"component",Render:N.R9,label:lng("estimated cost for member").caps()+":"},{type:"number",name:"estimated_cost_for_member"},{type:"component",node:(0,x.tZ)(T.l,{theme:"contained",onClick:()=>{const e=this.values.get("estimated_budget");if(!e||e<1)return Blsm.Warning(lng("missing estimated budget"));const t=this.values.get("min_users");if(!t||t<1)return Blsm.Warning(lng("missing minimum users"));this.updateValue(Math.round(e/t),"estimated_cost_for_member")},children:lng("calculate").caps()}),grow:0}]},{type:"multiple_items",name:"resource_bundles",label:lng("restrict resources to resource bundles"),mod:["resources","ENT"],insert:Blsm.isFeatureEnabled("resources")&&this.typeCheck(["group","course","course_template"]),searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",show_all:1,owned:1,member:1,member_active:1,types:"ResourceBundle",term:e.term||"",id:e.ids||""}},t)}},{type:"indent_set",mod:["resources","ENT"],insert:Blsm.isFeatureEnabled("resources")&&this.typeCheck(["group","course","course_template"]),fields:[{type:"checkbox",name:"clear_incompatible",label:lng("clear incompatible resources")}]},{type:"select",name:"default_assignee",label:lng("default assignee"),options:this.serverResponse.data.default_assignee_options,emptyOption:!0,mod:["","ENT"],insert:this.typeCheck(["workplan"])},{type:"checkbox",name:"members_can_set_status",label:lng("members can set status and assignee"),mod:["","ENT"],insert:this.typeCheck(["workplan"])},{type:"multiple_items",name:"designations",mod:["designation","ENT"],insert:this.typeCheck(["qualification"])&&Blsm.isFeatureEnabled("designation"),label:lng("start typing %s code or description",lng("designation",{phrase:!0})).caps(),theme:"bright",searchData:(e,t)=>{(0,m.SC)("designation/autocomplete/",{method:"POST",data:{term:e.term,id:e.ids,limit:e.ids?"no":""}},t)}},{type:"text",name:"external_id",readOnly:!Blsm.user.isPowerManager,label:lng("external id"),insert:Blsm.user.isPowerManager||!!this.serverResponse.data.external_id}]}}},S=H(C.prototype,"refreshRichText",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),O=H(C.prototype,"savePanelMessage",[c.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),H(C.prototype,"preview",[c.computed],Object.getOwnPropertyDescriptor(C.prototype,"preview"),C.prototype),H(C.prototype,"SaveSuccess",[Z],Object.getOwnPropertyDescriptor(C.prototype,"SaveSuccess"),C.prototype),C);const W=e=>{let{onChange:t,item:i}=e;const[n,r]=(0,_.useState)(i.skill_level||1),s=[1,2,3].map((e=>(0,j.r0)(e)));return(0,x.tZ)(D.u,{text:lng("select skill level"),children:(0,x.tZ)("div",{style:{display:"flex"},children:s.map(((e,s)=>(0,x.tZ)(I.xY,{skillTag:e,selected:parseInt(e.val)===parseInt(n),onSelect:e=>((e,i)=>{e.skill_level=i,r(i),null==t||t(e)})(i,e)},s)))})})},K=(0,L.iv)("display:flex;flex-grow:1;flex-shrink:0;>*+*{",a.g.classes.margin_far("1em"),";}>span{width:100%;}.Icon-preview{flex-shrink:0;margin:auto;}",""),Y=e=>{var t,i;let{onChange:n,values:r,id:s}=e;const a=r();return(0,x.tZ)("div",{css:K,children:(0,x.tZ)(X.Dd,{disabled:!(null===(t=a.rating)||void 0===t||!t.id||!a.origin_group),value:(null===(i=a.rating)||void 0===i?void 0:i.id)||"",label:lng("select rating").caps(),searchData:(e,t)=>{let{term:i,ids:n}=e;return(0,m.SC)("ratings/rating_tool_autocomplete",{data:{term:i,id:n,limit:n?null:10}},t)},buttons:[{Render:()=>(0,x.tZ)(o.JO,{icon:"preview",toolTip:lng("show rating preview"),onClick:()=>(()=>{const e=r(),t=null==e?void 0:e.rating;if(!t.id)return;const i={r_id:0,questions:M.h},n={rating:t,group_id:s,group_name:`${lng("workspace questions")} (${lng("example").caps()})`,group_type:lng("workspace").caps(),previewRating:i,meetings:[{_attr:{completed:!0},id:123123123,title:`${lng("meeting questions")} (${lng("example").caps()})`,instructors:[{full_name:`${lng("instructor questions")} (${lng("example").caps()})`,resource_id:123}]}]};return(0,g.vm)().openDialog("Component",{title:lng("example rating survey"),child:(0,x.tZ)(A.S,{onClose:()=>(0,g.vm)().closeDialog(),preview:!0,ws:n}),padded:!1,width:"1200px"})})()})}],onChange:n})})},Q=e=>{let{type:t,name:i,label:n,insert:s,visible:o,helpKey:a,mod:l}=e;return{type:"row_set",insert:!(0,r.DM)(s)||s,mod:l,visible:o,helpKey:a,fields:[{type:"component",Render:N.R9,label:n.caps()+":"},{type:t,name:i}]}},ee=e=>{const t=(0,g.vm)();t.openDialog("QualificationRepeatIssues",{store:t.getStore("qualification_issues",{group_id:e})})},te=["daily","weekly","monthly","yearly"]},7693:(e,t,i)=>{i.d(t,{m:()=>T,M:()=>P});var n=i(6920),r=i(5560),s=i(7363),o=i(5007),a=i(7033),l=i(5405),c=i(4902),d=i(5944);const p={name:"1x0fep6",styles:">._title{white-space:nowrap;color:white;font-size:1.4rem;font-weight:lighter;margin-bottom:0.7em;cursor:pointer;&:hover{text-decoration:underline;}}._circle,._circle_more{box-sizing:content-box;border:2px solid white;}._circle_more{background-color:rgba(255, 255, 255, 0.3);color:white;}"},u=e=>(0,d.tZ)(l.SV,{children:(0,d.tZ)(m,{...e})}),m=(0,r.observer)((function(e){var t;let{users:i,className:n}=e;const r=(0,s.useContext)(o.l9).getStore("home").getOverviewStore();return!(!Blsm.isFeatureEnabled("coached_assignments")||Blsm.isGuiFeatureEnabled("hide_assignments_from_desktop"))&&(0,d.BX)("div",{css:p,className:n,children:[parseInt(null==r||null===(t=r.coach_completion)||void 0===t?void 0:t.total)>0&&(0,d.tZ)("div",{className:"_title",onClick:()=>r.nav(["coaching"]),children:lng("my trainees").caps()}),i.length>0&&(0,d.tZ)(c.I9,{className:"_trainees-list",users:i,maxSlots:4,onClick:e=>r.nav(["coaching",null==e?void 0:e.user_id])})]})}));var g=i(1991),h=i(5033),b=i(619),v=i(9234),_=i(7190),f=i(2883),y=i(5311),w=i(7059),x=i(8318),k=i(917),Z=i(7392),C=i(441),S=i(6975),O=i(7154),B=i(6344);const T=(0,r.observer)((function(){var e;const t=(0,s.useContext)(o.l9).getStore("home").getOverviewStore(),{assignment_completion:i,qualification_completion:r,course_completion:c,trainees:p,showOnlyAssignments:m,todoAssignments:b,listAssignments:k,workspaces:Z,groupsCompactView:B}=t,T=[],I=(!Blsm.prm.workspaces_only_for_managers||Blsm.user.isManager)&&(null==Z?void 0:Z.length)>0,j=(null==i?void 0:i.total)>0,z=(null==i?void 0:i.completed)>0&&(null==i?void 0:i.total)===(null==i?void 0:i.completed);return(null==i?void 0:i.total)>0&&T.push({val:(0,x.e9)(i.completed,i.total,{add_sign:!1}),color:n.g.colors.entity.assignment,icon:"menu_overview",label:lng("assignments completion")+`: ${(0,x.e9)(i.completed,i.total,{verbose:!0})}`}),(null==c?void 0:c.total)>0&&T.push({val:(0,x.e9)(c.completed,c.total,{add_sign:!1}),color:n.g.colors.entity.course,icon:"mng_courses",label:lng("courses completion")+`: ${(0,x.e9)(c.completed,c.total,{verbose:!0})}`}),(null==r?void 0:r.total)>0&&T.push({val:(0,x.e9)(r.completed,r.total,{add_sign:!1}),color:n.g.colors.entity.qualification,icon:"mng_qualifications",label:lng("qualifications completion")+`: ${(0,x.e9)(r.completed,r.total,{verbose:!0})}`}),(0,d.BX)(a.U,{children:[(0,d.BX)(f.EL,{children:[(0,d.tZ)(_.K,{}),(0,d.BX)("div",{children:[(0,d.BX)("div",{className:"_home_banner",children:[T.length>0&&(0,d.tZ)("div",{className:"_rings",children:(0,d.tZ)(w._P,{values:T})}),(0,d.BX)("div",{className:"_titles",children:[(0,d.BX)("div",{className:"h1",children:[lng("hello %s",Blsm.user.user_first_name).toUpperCase(),","]}),(0,d.tZ)("div",{className:"h2",children:lng("let's get started!").caps()})]})]}),(0,d.tZ)(y.zh,{}),(0,d.tZ)(u,{className:"_mytrainees",users:p}),j&&(0,d.tZ)(O.u,{className:"_home_tasks_display",text:t.showOnlyAssignments?lng("see assignment cards"):lng("see current and past assignments list"),children:(0,d.tZ)(S.TG,{icon:t.showOnlyAssignments?"view_tiles":"menu_overview",className:"_go_button",onClick:()=>t.showOnlyAssignments=!t.showOnlyAssignments})})]})]}),(0,d.BX)("div",{className:"_main_op",children:[m&&!Blsm.isGuiFeatureEnabled("hide_assignments_from_desktop")?(0,d.BX)(d.HY,{children:[(0,d.tZ)(v.PQ,{title:lng("assignments"),mainTitle:!0,className:"_assignments_title"}),(0,d.tZ)("div",{className:"_main_narrow",children:(0,d.tZ)(l.SV,{children:(0,d.tZ)(a.U,{children:(0,d.tZ)(h.Mz,{showCompleted:t.showCompleted,setShowCompleted:()=>t.setShowCompleted(!t.showCompleted),assignments:k,initCompactView:!0,filtersAbove:!0,filtersTheme:"bright"})})})})]}):j&&!Blsm.isGuiFeatureEnabled("hide_assignments_from_desktop")?(0,d.BX)(a.U,{children:[(0,d.tZ)(v.PQ,{title:lng("assignments"),mainTitle:!0,className:"_assignments_title"}),b.length>0?(0,d.tZ)(g.T,{inOpenPage:!0,floatingControls:!0,showListButton:()=>t.showOnlyAssignments=!t.showOnlyAssignments,children:b.map((e=>(0,d.tZ)(h.Al,{assignment:e},e.assignment_id)))}):(0,d.tZ)("div",{className:"_main_narrow",style:{marginBottom:"30px"},children:p.length>0?(0,d.tZ)(D,{}):(0,d.tZ)(P,{title:lng("you did it!"),subTitle:(0,d.BX)(d.HY,{children:[(0,d.tZ)("div",{children:lng("you finished all your assignments!").caps()}),z&&(0,d.tZ)("div",{children:(0,d.tZ)(C.A,{href:{home:"overview/alist=1/show_completed=1"},style:{textDecoration:"underline"},children:lng("see your completed assignments").caps()})})]}),icon:"cheers"})})]}):(0,d.tZ)("div",{style:{marginTop:"120px"}}),!Blsm.isGuiFeatureEnabled("hide_calendar_desktop")&&I&&!m&&(0,d.tZ)("div",{className:"_main_narrow",children:(0,d.tZ)(a.U,{children:(0,d.tZ)(l.SV,{children:(0,d.tZ)(N,{minimizeOnEmpty:!0,overviewStore:t})})})}),I&&!m&&(0,d.tZ)("div",{style:{backgroundColor:n.g.colors.bg_main,paddingTop:"10px"},children:(0,d.tZ)("div",{className:"_main_narrow",children:(0,d.BX)(a.U,{children:[(0,d.tZ)(v.PQ,{title:lng("workspaces"),mainTitle:!0}),(0,d.tZ)(l.SV,{children:(0,d.tZ)(v.uO,{workspaces:Z,compactView:B,onViewSelect:e=>t.groupsCompactView=e,recent:"recent_groups",setShowOld:t.setShowOld,displayCount:!0})})]})})}),!j&&!I&&(0,d.tZ)("div",{className:"_main_narrow",children:(0,d.tZ)(P,{title:lng("there is nothing here"),subTitle:lng("you don't have any assignments or workspaces, let's bring life to this page!"),icon:"digging",buttons:null!==(e=Blsm.InitialData.main_menu)&&void 0!==e&&e.coursecatalog?[{click:()=>(0,C.p4)("#cregistration",!0),label:lng("go to %s",lng("course catalog"))}]:null})})]})]})})),N=(0,r.observer)((function(e){let{overviewStore:t,minimizeOnEmpty:i}=e;const{activeCalendarDate:n,monthEvents:r}=t;return(0,d.tZ)(l.SV,{children:(0,d.tZ)(b.V,{minimizeOnEmpty:i,className:"_marginBottom",activeDate:n,onDateSelect:e=>t.activeCalendarDate=e,onMonthChange:e=>t.activeCalendarMonth=e,events:r,onStripClick:e=>t.setActiveComponent(e)})})})),I=(0,k.iv)("height:100%;width:100%;position:relative;background-color:",n.g.colors.bg_cont,";border-radius:20px;padding:20px;text-align:center;>.info{display:flex;justify-content:space-evenly;margin-top:20px;padding:15px;>div{margin:10px;border-radius:20px;padding:20px;font-size:1.3em;color:white;&.personal{border:1px solid ",n.g.theme.color_1,";background-color:",(0,B.mR)(n.g.theme.color_1,.1),";color:",n.g.theme.color_1,";}&.coaching{border:1px solid ",n.g.colors.dominant_main,";background-color:",(0,B.mR)(n.g.colors.dominant_main,.1),";color:",n.g.colors.dominant_main,";}.Icon{display:flex;flex-direction:row;font-size:1.8em;text-align:center;justify-content:space-evenly;}.message{padding:10px 0;font-size:1.2em;}}}",""),D=(0,r.observer)((()=>(0,d.tZ)("div",{css:I,children:(0,d.BX)("div",{className:"info",children:[(0,d.BX)("div",{className:"personal",children:[(0,d.tZ)("div",{className:"status",children:(0,d.tZ)(S.JO,{icon:"cheers"})}),(0,d.tZ)("div",{className:"message",children:lng("you finished all your personal assignments").caps()}),(0,d.tZ)("div",{children:(0,d.tZ)(C.A,{href:{home:"overview/alist=1/show_completed=1"},style:{textDecoration:"underline"},children:lng("see your completed assignments").caps()})})]}),(0,d.BX)("div",{className:"coaching",children:[(0,d.tZ)("div",{className:"status",children:(0,d.tZ)(S.JO,{icon:"menu_overview"})}),(0,d.tZ)("div",{className:"message",children:lng("you still have coaching assignments remaining").caps()}),(0,d.tZ)("div",{children:(0,d.tZ)(C.A,{href:{home:"overview/coaching"},style:{textDecoration:"underline"},children:lng("go to %s",lng("coaching assignments")).caps()})})]})]})}))),j=(0,k.iv)("height:100%;width:100%;position:relative;background-color:",n.g.colors.bg_cont,";border-radius:20px;padding:15px;*{margin:auto;text-align:center;}>.idol{font-size:60px;}>.title{font-size:2.3em;}>.paragraph{margin-top:10px;font-size:1.3em;}>.button-container{margin:18px auto;.Button{",n.g.classes.margin_far("10px"),";}}.empty-search{.Icon{color:tomato;transform:rotate('90deg');}}",""),P=(0,r.observer)((e=>{let{title:t,subTitle:i,buttons:r=null,icon:s}=e;return(0,d.BX)("div",{css:j,className:"EmptyMessage",children:[(0,d.tZ)("div",{className:"idol",children:(0,d.tZ)(S.JO,{icon:s,color:n.g.theme.color_1})}),(0,d.tZ)("div",{className:"title",children:t.caps()}),i&&(0,d.tZ)("div",{className:"paragraph",children:"string"==typeof i?i.caps():i}),r&&(0,d.tZ)("div",{className:"button-container",children:r.map(((e,t)=>(0,d.tZ)(Z.l,{theme:"contained",onClick:e.click,children:e.label.caps()},t)))})]})}))},7190:(e,t,i)=>{i.d(t,{K:()=>R,U:()=>z});var n=i(5560),r=i(7363),s=i(5007),o=i(8318),a=i(6291),l=i(917),c=i(6920),d=i(6421),p=i(7033),u=i(1991),m=i(5446),g=i(5405),h=i(5033),b=i(2883),v=i(5311),_=i(7059),f=i(7154),y=i(6975),w=i(9159),x=i(5944);var k={name:"iaf3p8",styles:"bottom:-35px"};const Z=(0,n.observer)((function(){var e;const t=(0,r.useContext)(s.l9).getStore("home").getOverviewStore();let i=t.coachingAssignments;t.coachingUserId&&(i=i.filter((e=>e.attr("coached_users").some((e=>e.user_id===t.coachingUserId)))));const n=[];if((null===(e=t.coach_completion)||void 0===e?void 0:e.total)>0){const e=t.coach_completion;n.push({val:(0,o.e9)(e.completed,e.total,{add_sign:!1}),color:c.g.colors.entity.coach,icon:"manager",label:lng("coach completion")+`: ${(0,o.e9)(e.completed,e.total,{verbose:!0})}`})}const a=e=>t.coachingUserId=t.coachingUserId===e?"":e,Z=(0,x.BX)("div",{children:[lng("user").caps()+": ",(0,x.tZ)(d.I,{type:"select",value:t.coachingUserId||"",options:[{val:"",label:""}].concat(t.trainees.map((e=>({val:e.user_id,label:(0,o.v2)(e)})))),onChange:e=>a(e)}),(0,x.tZ)("div",{style:{display:"inline-flex",alignItems:"center"},children:t.showOldLoading?(0,x.BX)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[(0,x.tZ)(w.My,{color:"green"})," ",(0,x.tZ)("label",{children:lng("show completed assignments").caps()})]}):(0,x.tZ)(w.XZ,{label:lng("show completed assignments"),color:"green",value:t.showCompleted,onChange:e=>t.setShowCompleted(e)})})]});return(0,x.BX)(p.U,{children:[(0,x.BX)(b.EL,{children:[(0,x.tZ)(R,{}),(0,x.BX)("div",{children:[(0,x.BX)("div",{className:"_home_banner",children:[n.length>0&&(0,x.tZ)("div",{className:"_rings",children:(0,x.tZ)(_._P,{values:n})}),(0,x.BX)("div",{className:"_titles",children:[(0,x.BX)("div",{className:"h1",children:[lng("my trainees").caps(),","]}),(0,x.tZ)("div",{className:"h2",children:lng("you have %s coaching assignments",t.coachingAssignments.length).caps()})]})]}),(0,x.tZ)(v.zh,{}),(0,x.tZ)(f.u,{className:"_home_tasks_display",text:lng("back to %s|back to some page",lng("overview",{phrase:!0})).caps(),css:k,children:(0,x.tZ)(y.TG,{icon:"home",className:"_home_tasks_display",css:(0,l.iv)({bottom:(0,o.tq)()?"-35px":"35px"},"",""),onClick:()=>t.nav([])})})]})]}),(0,x.BX)("div",{className:"_main_op",children:[t.trainees.length>0&&(0,x.tZ)(u.T,{inOpenPage:!0,floatingControls:!0,children:t.trainees.map((e=>(0,x.tZ)(m.k,{user:e,active:t.coachingUserId===e.user_id,onButtonClick:()=>a(e.user_id)},e.user_id)))}),(0,x.tZ)("div",{className:"_main_narrow",children:(0,x.tZ)(g.SV,{children:(0,x.tZ)(h.Mz,{assignments:i,assignee:t.coachingUserId,inContainer:!0,title:lng("assignments").caps(),filtersAbove:!0,mayChangeView:!0,className:"_marginBottom",barExtraComponent:Z,extraFilters:[{name:"not_blocked",label:lng("hide blocked assignments"),type:"checkbox",func:(e,t)=>t._attr.coached_users.some((e=>e.dependencies_satisfied))}]})})})]})]})}));var C=i(7693),S=i(5247);const O=(0,n.observer)((function(){const e=(0,r.useContext)(s.l9).getStore("home").getOverviewStore();return(0,o.Ju)(lng("home")),e.ready?(0,x.tZ)(x.HY,{children:e.coachingMode?(0,x.tZ)(Z,{}):(0,x.tZ)(C.m,{})}):(0,x.tZ)(S.h,{})}));var B=i(441),T=i(8207),N=i(3016);const I=(0,n.observer)((function(){const e=(0,r.useContext)(s.l9).getStore("home").getDiscussionsStore(),t=(0,r.useRef)(0);return(0,r.useEffect)((()=>(e.ready&&(t.current=setInterval((()=>e.fetch()),3e4)),()=>clearInterval(t.current))),[e.ready]),e.ready?(0,x.BX)(p.U,{children:[(0,x.BX)(b.EL,{children:[(0,x.tZ)(R,{}),(0,x.tZ)("div",{children:(0,x.BX)("div",{className:"_titles",children:[(0,x.BX)("div",{className:"h1",children:[lng("hello %s",Blsm.user.user_first_name).toUpperCase(),","]}),(0,x.tZ)("div",{className:"h2",children:lng("let's get started!").caps()})]})})]}),(0,x.tZ)("div",{className:"_main_op",children:(0,x.tZ)(T.W2,{fitWidth:!0,noBottomPadding:!0,children:(0,x.tZ)(N.O,{filteredItems:e.filteredDiscussions,items:e.discussions,filterNsort:e.filterSort,showWorkspace:!0})})})]}):(0,x.tZ)(S.h,{})}));var D=i(6364),j=i(493);const P=(0,l.iv)("._head_content>div{display:flex;flex-wrap:wrap;align-items:center;margin-top:15px;height:100%;._home_banner{display:flex;flex-direction:row;width:auto;align-items:center;justify-content:space-around;}._rings{flex-shrink:0;width:210px;height:210px;>.Rings{transform-origin:top ",c.g.isRTL?"right":"left",";}}._titles{color:white;margin:0 10px;",c.g.classes.margin_near("30px")," .h1{font-weight:700;font-size:2.5rem;}.h2{font-size:2rem;}}._mytrainees{",c.g.classes.margin_far("10px"),";._trainees-list{display:flex;}}._home_tasks_display{",c.g.classes.margin_far("12px"),";position:absolute;bottom:30px;",c.g.far,":0;}",c.g.mQuery.max(850),"{._home_tasks_display{bottom:0;}._rings{width:180px;height:180px;font-size:35px;>.Rings{transform:scale(",180/220,");}}._titles{.h1{font-size:1.45rem;}.h2{font-size:1.2rem;}}}",c.g.mQuery.max(600),"{._mytrainees{width:100%;}._rings{width:120px;height:120px;font-size:25px;margin:0 10px;>.Rings{transform:scale(",120/220,");}}}}._main_op{position:relative;margin-top:-84px;._main_narrow{",c.g.classes.content_width,";._marginBottom{margin-bottom:",c.g.consts.CONT_MARGIN,"px;}}}._assignments_title{color:",c.g.colors.dominant_white,";",c.g.classes.content_width,";}",""),z=(0,n.observer)((function(){const e=(0,r.useContext)(s.l9).getStore("home");(0,o.Ju)(lng("home"));return(0,x.BX)(a.T,{css:P,bottomPadding:!0,contBG:!0,children:[(()=>{switch(e.mode){case"overview":return(0,x.tZ)(O,{});case"discussions":return(0,x.tZ)(I,{})}return(0,x.tZ)("div",{children:"mode doesn't exists"})})(),(0,x.tZ)(D.$,{})]})})),E=(0,l.iv)("margin:22px auto 0;",c.g.mQuery.mobile,"{margin:11px auto 0;}",""),R=(0,n.observer)((function(){const e=(0,r.useContext)(s.l9).getStore("home");let t=e.show_nav&&[{val:"overview",label:lng("overview",{phrase:!0})},e.show_discussions&&{val:"discussions",label:lng("discussions",{phrase:!0})}].filter((e=>e));return(0,x.BX)("div",{css:E,children:[t&&(0,x.tZ)(j.T,{value:e.mode,size:30,onChange:e=>{let t;["overview","discussions"].includes(e)&&(t={home:e}),t&&(0,B.p4)(t,!0)},options:t,inlineLabels:!0}),(0,x.tZ)("div",{style:{height:"25px"}})]})}))},7787:(e,t,i)=>{i.d(t,{k:()=>we,l:()=>Be});var n=i(7363),r=i(917),s=i(5007),o=i(5560),a=i(5405),l=i(6920),c=i(441),d=i(6975),p=i(8318),u=i(8567),m=i(5474),g=i(539),h=i(3051),b=i(4065),v=i(4210);class _ extends v.I{constructor(e){super(e),this.options=e.options||{},this.onSave=e.onSave,this.title=lng("create note").caps(),this._fields=[{type:"richtext",name:"note_content",label:lng("content"),style:{minHeight:"100px"}}],this._prepFields(e.data||{}),this.ready=!0}save(e){var t;null===(t=this.onSave)||void 0===t||t.call(this,e)}}var f=i(5898),y=i(7376),w=i(7154),x=i(493),k=i(8e3),Z=i(5944);class C extends v.I{constructor(e){super(e),this.options=e.options||{},this.onSave=e.onSave,this.title=lng("edit board").caps(),this._buildFields(),this._prepFields(e.data||{}),this.ready=!0}save(e){var t;null===(t=this.onSave)||void 0===t||t.call(this,e)}_buildFields(){this._fields=[{type:"text",name:"board_name",label:lng("name"),required:!0},{type:"multiple_items",name:"board_users",label:lng("users"),poster:!0,theme:"bright",searchData:(e,t)=>{(0,k.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||""}},t)},valueIsMap:!0,objectKeys:["id","write_permission"],showRemove:e=>!(0,p.Tz)(e.id),buttons:[{Render:e=>{let{onChange:t,item:i}=e;return(0,p.Tz)(i.id)?null:(0,Z.tZ)("div",{children:(0,Z.tZ)(w.u,{text:lng("full control").caps(),children:(0,Z.tZ)(x.T,{value:!!i.write_permission,size:18,onChange:t,options:[{val:!1,color:l.g.colors.dominant_main,icon:"mark_x_light"},{val:!0,color:l.g.colors.dominant_main,icon:"mark_v_light"}]})})})},onChange:e=>(e.write_permission=e.write_permission?0:1,e)}]}]}}class S extends v.I{constructor(e){super(e),this.options=e.options||{},this.onSave=e.onSave,this.title=lng("create column").caps(),this._buildFields(),this._prepFields(e.data||{}),this.ready=!0}save(e){var t;null===(t=this.onSave)||void 0===t||t.call(this,e)}_buildFields(){this._fields=[{type:"text",name:"column_name",label:lng("name")},{type:"color",name:"column_color",label:lng("background color"),placeholder:"#FFFFFF"}]}}var O=i(6421),B=i(5832),T=i(1619),N=i(7392),I=i(5311),D=i(6344);const j=(0,n.lazy)((()=>Promise.all([i.e(866),i.e(218)]).then(i.bind(i,4213)).then((e=>({default:e.DragDropContext}))))),P=(0,n.lazy)((()=>Promise.all([i.e(866),i.e(218)]).then(i.bind(i,4213)).then((e=>({default:e.Draggable}))))),z=(0,n.lazy)((()=>Promise.all([i.e(866),i.e(218)]).then(i.bind(i,4213)).then((e=>({default:e.Droppable})))));var E={name:"icns00",styles:"padding-top:10px"};const R=(0,o.observer)((function(){return(0,n.useContext)(s.l9).getStore("tasks").boardStore.ready?(0,Z.BX)("div",{css:E,children:[(0,Z.tZ)(K,{}),(0,Z.tZ)(M,{})]}):(0,Z.tZ)(g.$,{})})),F=(0,r.iv)(".columns-list{padding:20px 0;display:flex;overflow-x:auto;&.dragOver{background-color:",l.g.colors.highlight,";}}",""),M=(0,o.observer)((function(){const e=(0,n.useRef)(0),t=(0,n.useContext)(s.l9).getStore("tasks").boardStore;if((0,n.useEffect)((()=>(t.current_board&&(e.current=setInterval((()=>t.refresh()),5e3)),()=>clearInterval(e.current))),[t.current_board]),!t.current_board)return(0,Z.tZ)("div",{});return(0,Z.tZ)(n.Suspense,{fallback:(0,Z.tZ)(g.$,{}),children:(0,Z.tZ)(j,{onDragEnd:e=>{const{destination:i,source:n,type:r,draggableId:s}=e;i&&(i.droppableId===n.droppableId&&i.index===n.index||("search"===n.droppableId?t.board.addTaskFromSearch(s,i.droppableId,i.index):"NOTE"===r?t.board.swapNotes(n.droppableId,n.index,i.droppableId,i.index):t.board.swapColumns(n.index,i.index)))},children:(0,Z.tZ)("div",{css:F,children:(0,Z.tZ)(n.Suspense,{fallback:(0,Z.tZ)(g.$,{}),children:(0,Z.tZ)(z,{droppableId:"board",type:"COLUMN",direction:"horizontal",children:(e,t)=>(0,Z.tZ)(A,{provided:e,snapshot:t})})})})})})})),A=(0,o.observer)((function(e){var t;let{provided:i,snapshot:r}=e;const o=(0,n.useContext)(s.l9).getStore("tasks").boardStore;return(0,Z.BX)("div",{...i.droppableProps,ref:i.innerRef,className:(0,p.AK)("columns-list",{dragOver:r.isDraggingOver}),children:[o.showSearch&&(0,Z.tZ)(Y,{}),null===(t=o.board)||void 0===t?void 0:t.columns.map(((e,t)=>(0,Z.tZ)(X,{column:e,index:t},e.column_id))),i.placeholder]})})),q=(0,r.iv)("margin:0 5px;border:1px solid ",l.g.colors.separator,";border-radius:8px;padding:5px 2px;min-width:335px;max-width:335px;background-color:",l.g.colors.bg_1,";",l.g.classes.shadow_light,";.column-name{font-size:1.1em;font-weight:600;text-align:center;}.column-top{display:flex;justify-content:space-between;display:flex;gap:10px;margin:0 5px;}.note-list{min-height:calc(100% - 30px);border-radius:8px;padding:0 2px;}.inner-notes-scroll{min-height:600px;overflow:auto;height:calc(100vh - 205px);}.dragOver{background-color:rgba(255, 255, 255, 0.6);}&.dragging{background-color:",l.g.colors.dominant_main_shade,";}.search-box{display:flex;position:relative;.search-term{border:1px solid ",l.g.colors.dominant_main,";color:",l.g.colors.dominant_main,";padding:10px 8px;border-radius:8px;flex-grow:1;}.search-filter{padding:10px 0 0 6px;}.search-reload{position:absolute;top:10px;left:240px;cursor:pointer;}}",""),X=(0,o.observer)((function(e){let{column:t,index:i}=e;return(0,Z.tZ)(P,{draggableId:"col_"+t.column_id,type:"COLUMN",index:i,children:(e,i)=>(0,Z.tZ)(L,{provided:e,snapshot:i,column:t})})})),L=(0,o.observer)((function(e){let{column:t,provided:i,snapshot:r}=e;const[s,o]=(0,n.useState)(!1),[a,l]=(0,n.useState)(!1),c=[{val:"edit",label:lng("edit column")},{val:"delete",label:lng("delete column")},{val:"empty",label:lng("empty column")}],m={...i.draggableProps.style};return t.column_color&&(m.backgroundColor=t.column_color,m.color=(0,D.ou)(t.column_color)),(0,Z.BX)("div",{css:q,...i.draggableProps,ref:i.innerRef,style:m,className:(0,p.AK)({dragging:r.isDragging}),children:[(0,Z.BX)("div",{className:"column-top",children:[t.canWrite?(0,Z.tZ)(d.JO,{icon:"move",className:"_drag",...i.dragHandleProps,smallButtonLike:!0}):(0,Z.tZ)("span",{}),(0,Z.BX)("div",{className:"column-name",children:[t.column_name," ",t.notes.length>0?`(${t.notes.length})`:""]}),t.canWrite&&(0,Z.BX)("div",{className:"_menu",children:[(0,Z.tZ)(w.u,{text:lng("add note"),children:(0,Z.tZ)(d.JO,{icon:"discussion",onClick:()=>o(!0),smallButtonLike:!0})}),(0,Z.tZ)(h.x,{options:c,onSelect:e=>{switch(e){case"edit":l(!0);break;case"delete":(0,u.BB)(lng("are you sure you want to delete this column?").caps(),{text:lng("delete").caps(),onConfirm:()=>t.delete(),confirmText:lng("delete")});break;case"empty":(0,u.BB)(lng("are you sure you want to empty this column?").caps(),{text:lng("empty").caps(),onConfirm:()=>t.empty(),confirmText:lng("empty")})}},children:(0,Z.tZ)(d.JO,{icon:"menu",smallButtonLike:!0})})]})]}),(0,Z.tZ)(z,{droppableId:t.column_id+"",type:"NOTE",children:(e,i)=>(0,Z.tZ)($,{provided:e,column:t,snapshot:i})}),s&&(0,Z.tZ)(se,{onSave:e=>{t.addNote(e),o(!1)},onClose:()=>o(!1)}),a&&(0,Z.tZ)(ne,{onSave:e=>(t.save(e),l(!1)),data:t.data(),onClose:()=>l(!1)})]})})),$=(0,o.observer)((function(e){let{column:t,provided:i,snapshot:r}=e;const o=(0,n.useContext)(s.l9).getStore("tasks").boardStore,a=o.searchInBoard.toLowerCase(),l=o.searchInBoard?t.notes.filter((e=>{const{note_content:t,task_title:i}=e.data;return(null==t?void 0:t.toLowerCase().includes(a))||(null==i?void 0:i.toLowerCase().includes(a))})):t.notes;return(0,Z.tZ)("div",{...i.droppableProps,ref:i.innerRef,className:(0,p.AK)("note-list",{dragOver:r.isDraggingOver}),children:(0,Z.BX)("div",{className:"inner-notes-scroll",children:[l.map(((e,i)=>(0,Z.tZ)(U,{note:e,index:i,columnId:t.column_id,notesLength:t.notes.length},e.data.note_id))),i.placeholder]})})})),V={name:"u628aj",styles:"._drag{cursor:grab;}"},U=(0,o.observer)((function(e){let{note:t,index:i,columnId:n,notesLength:r}=e;return(0,Z.tZ)(P,{draggableId:t.data.loading?null:t.data.note_id+"",index:i,type:"NOTE",children:(e,s)=>(0,Z.tZ)(H,{provided:e,snapshot:s,note:t,columnId:n,noteIndex:i,notesLength:r})})})),H=(0,o.observer)((function(e){let{provided:t,snapshot:i,note:o,columnId:a,noteIndex:c,notesLength:u}=e;const[m,g]=(0,n.useState)(!1),h=(0,n.useContext)(s.l9).getStore("tasks").boardStore,b=o.canWrite?(0,Z.BX)(I.c_,{children:[o.data.task_id&&(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)(d.JO,{icon:"discussion",toolTip:lng("edit note"),css:(0,r.iv)({fontSize:".8em",color:o.data.note_content?l.g.colors.dominant_orange:void 0},"",""),onClick:e=>(g(!0),e.preventDefault(),e.stopPropagation())})," "]}),c!==u-1&&(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)(d.JO,{css:(0,r.iv)({fontSize:".8em",color:l.g.colors.blue},"",""),icon:"arrow_down_double",toolTip:lng("move to bottom"),onClick:e=>(h.board.swapNotes(a,c,a,u-1),e.preventDefault(),e.stopPropagation())})," "]}),0!==c&&(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)(d.JO,{css:(0,r.iv)({fontSize:".8em",color:l.g.colors.blue},"",""),icon:"arrow_up_double",toolTip:lng("move to top"),onClick:e=>(h.board.swapNotes(a,c,a,0),e.preventDefault(),e.stopPropagation())})," "]}),(0,Z.tZ)(d.JO,{icon:"move",className:"_drag",...t.dragHandleProps,toolTip:lng("drag to move")})]}):(0,Z.tZ)("span",{});return(0,Z.BX)("div",{css:V,...t.draggableProps,ref:t.innerRef,style:t.draggableProps.style,className:(0,p.AK)({dragging:i.isDragging,selected:o.isChecked}),children:[o.loading?(0,Z.BX)("div",{style:{minHeight:"125px"},children:[lng("loading").caps(),"..."]}):o.data.task_id?(0,Z.tZ)(y.sD,{task:o.data,topRightIcon:b,onCheck:e=>(o.toggleCheck(),e.stopPropagation(),e.preventDefault()),checked:o.isChecked}):(0,Z.tZ)(G,{note:o,topRightIcon:b,onCheck:e=>(o.toggleCheck(),e.stopPropagation(),e.preventDefault()),checked:o.isChecked}),m&&(0,Z.tZ)(se,{onSave:e=>{o.save(e),g(!1)},data:o.data,onClose:()=>g(!1)})]})})),J=(0,r.iv)("padding:7px;margin-top:10px;border-radius:8px;background-color:",l.g.colors.bg_main,";",l.g.classes.shadow_light,";position:relative;min-width:",l.g.consts.CARD_WIDTH,"px;width:",l.g.consts.CARD_WIDTH,"px;.note-link{display:flex;flex-direction:column;justify-content:space-between;min-height:125px;}&:hover{",l.g.classes.shadow_strong,";background-color:",l.g.colors.dominant_main_shade,";}.meta-row{display:flex;justify-content:space-between;font-size:.9em;>span{max-width:35%;max-height:35px;font-size:0.9em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}}._content{color:",l.g.colors.text_main,";margin-bottom:7px;",l.g.classes.editor_directions,";img{max-height:100px;max-width:200px;}}.selected &{background-color:",l.g.colors.dominant_main_shade,";}.dragging &{background-color:",l.g.colors.dominant_main_shade,";}",""),G=(0,o.observer)((function(e){let{note:t,topRightIcon:i,onCheck:r,checked:s}=e;const[o,a]=(0,n.useState)(!1);return(0,Z.BX)("div",{css:J,children:[(0,Z.BX)(c.A,{className:"note-link",onClick:e=>{("A"!==e.target.nodeName||e.target.classList.contains("note-link"))&&a(!0)},children:[(0,Z.BX)("div",{className:"meta-row",children:[(0,Z.tZ)("span",{children:(0,Z.tZ)(d.gT,{color:l.g.colors.text_main,size:".7em"})}),(0,Z.tZ)("span",{children:(0,Z.tZ)(f.jC,{color:"purple",children:lng("note").caps()})}),i||(0,Z.tZ)("span",{})]}),(0,Z.tZ)(T.xn,{className:"_content",content:t.data.note_content}),(0,Z.tZ)("div",{className:"meta-row",children:(0,Z.BX)("span",{children:[r&&(0,Z.tZ)(d.JO,{icon:"checkbox"+(s?"_checked":""),color:l.g.colors.green,onClick:r})," #",t.data.note_id]})})]}),o&&(0,Z.tZ)(se,{onSave:e=>{t.save(e),a(!1)},data:t.data,onClose:()=>a(!1)})]})})),W=(0,r.iv)("display:flex;align-items:center;.board-select{padding:.4em 1em;border:1px solid ",l.g.colors.separator,";border-radius:8px;margin:0 5px;}.board-search{padding:2px 5px;border:1px solid ",l.g.colors.separator,";border-radius:8px;margin:0 5px;}",""),K=(0,o.observer)((function(){const e=(0,n.useContext)(s.l9).getStore("tasks").boardStore,[t,i]=(0,n.useState)(!1),[r,o]=(0,n.useState)(!1),[a,l]=(0,n.useState)(!1),c={title:lng("create new board").caps(),onConfirm:t=>{e.saveNewBoard(t),i(!1)},onCancel:()=>i(!1),placeholder:lng("board name").caps(),confirmText:lng("create").caps()},p=[{val:"add",label:lng("add column")},{val:"edit",label:lng("edit board")},{val:"delete",label:lng("delete board")}],g=a?{board_name:e.board.board_name,board_users:e.board.board_users}:{},b=[];return e.boards_list.forEach((e=>b.push({val:e.board_id,label:e.board_name}))),(0,Z.BX)("div",{css:W,children:[e.canWrite&&(0,Z.tZ)(N.l,{type:"contained",onClick:()=>e.toggleSearchTasks(),children:lng("search tasks").caps()}),"  ",e.boards_list.size>0&&(0,Z.tZ)(m.P,{className:"board-select",value:e.current_board,onChange:t=>e.changeBoard(t),options:b}),(0,Z.tZ)(O.I,{type:"text",className:"board-search",value:e.searchInBoard,onChange:t=>e.searchInBoard=t,placeholder:lng("search in board").caps()}),t&&(0,Z.tZ)(u.NL,{...c}),r&&(0,Z.tZ)(ne,{onSave:t=>(e.board.addColumn(t),o(!1)),onClose:()=>o(!1)}),a&&(0,Z.tZ)(re,{onSave:t=>{l(!1),e.board.save(t)},data:g,onClose:()=>l(!1)}),(0,Z.tZ)(I.zh,{}),(0,Z.tZ)(N.l,{type:"outlined",onClick:()=>i(!0),children:lng("new board").caps()}),e.mayBookmark&&(0,Z.tZ)(f.rp,{entity:e,buttonLike:!0,onClick:()=>e.toggleBookmark()}),e.canWrite&&(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)(d.JO,{icon:"trash",onClick:()=>{if(!e.board.selectedNoteIds().length)return(0,u.qR)(lng("please select at least one item").caps());(0,u.BB)(lng("are you sure you want to delete the selected items?").caps(),{text:lng("delete items"),onConfirm:()=>e.board.deleteSelected()})},buttonLike:!0})," ",(0,Z.tZ)(h.x,{className:"_menu",options:p,onSelect:t=>{switch(t){case"add":o(!0);break;case"edit":l(!0);break;case"delete":(0,u.BB)(lng("are you sure you want to delete this board?").caps(),{text:lng("delete").caps(),onConfirm:()=>e.board.delete(),confirmText:lng("delete")})}},children:(0,Z.tZ)(d.JO,{icon:"menu",buttonLike:!0})})]})]})})),Y=(0,o.observer)((function(){const e=(0,n.useRef)(0),t=(0,n.useContext)(s.l9).getStore("tasks").boardStore,i=["open","in_progress","closed","on_hold"].map((e=>({val:e,label:(0,y.HR)(null,e).caps()}))),r=(0,p.wd)([[1,lng("low").caps()],[5,lng("medium").caps()],[7,lng("high").caps()],[9,lng("urgent").caps()]]);let o=[{name:"task_id",label:"#",type:"text"},{name:"task_title",label:lng("title"),type:"text"},{name:"assignee",label:lng("assignee"),type:"text"},{name:"group",label:lng("workspace"),type:"select_multi",options:(0,p.wd)(t.workspaces)},{name:"task_type",label:lng("type"),type:"select_multi",options:(0,p.wd)(t.tasks_types)},{name:"priority",label:lng("priority"),type:"select_multi",options:r},{name:"status_id",label:lng("status"),type:"select_multi",options:(0,p.wd)(t.tasks_status)},{name:"task_resolution",label:lng("resolution"),type:"select_multi",options:i}];return(0,n.useEffect)((()=>(t.searchTasks.search(),e.current=setInterval((()=>t.searchTasks.search()),6e4),()=>clearInterval(e.current))),[]),(0,Z.BX)("div",{css:q,children:[(0,Z.BX)("div",{className:"column-name",children:[lng("search tasks").caps()," ",t.searchTasks.tasks.length>0?`(${t.searchTasks.tasks.length})`:""]}),(0,Z.BX)("div",{className:"search-box",children:[(0,Z.tZ)(O.I,{className:"search-term",type:"text",placeholder:lng("search").caps(),value:t.searchTasks.term,onChange:e=>t.searchTasks.updateTerm(e)}),(0,Z.tZ)(d.JO,{icon:"reload",className:"search-reload",onClick:()=>t.searchTasks.search(),smallButtonLike:!0}),(0,Z.tZ)("div",{className:"search-filter",children:(0,Z.tZ)(B.wn,{filters:o,filtersVals:t.searchTasks.filters,className:"_filter",onFilter:e=>t.searchTasks.setFilters(e),iconProps:{smallButtonLike:!0}})}),(0,Z.tZ)("div",{className:"search-filter",children:(0,Z.tZ)(d.JO,{icon:`arrow_${l.g.far}_double`,toolTip:lng("add matching to 1st column"),smallButtonLike:!0,onClick:()=>t.searchTasks.addMatchingToFirstCol()})})]}),(0,Z.tZ)(z,{droppableId:"search",type:"NOTE",children:e=>(0,Z.tZ)(ee,{provided:e})})]})})),Q={name:"bud1db",styles:".loading{margin-top:15px;}.list{max-height:calc(100vh - 245px);overflow:auto;}.nothing{text-align:center;font-size:1.1em;padding:50px 0;}"},ee=(0,o.observer)((function(e){let{provided:t}=e;const i=(0,n.useContext)(s.l9).getStore("tasks").boardStore,r=i.searchTasks.tasks;return(0,Z.tZ)("div",{...t.droppableProps,ref:t.innerRef,css:Q,children:i.searchTasks.searching?(0,Z.tZ)("div",{className:"loading",children:(0,Z.tZ)(g.$,{})}):(0,Z.tZ)("div",{className:"list",children:0===r.length?(0,Z.tZ)("div",{className:"nothing",children:lng("no tasks found").caps()}):r.map(((e,t)=>(0,Z.tZ)(te,{task:e,index:t},e.data.task_id)))})})})),te=(0,o.observer)((function(e){let{task:t,index:i}=e;return(0,Z.tZ)(P,{draggableId:t.data.task_id+"",index:i,type:"NOTE",children:(e,i)=>(0,Z.tZ)(ie,{provided:e,snapshot:i,task:t})})})),ie=(0,o.observer)((function(e){let{provided:t,snapshot:i,task:n}=e;return(0,Z.tZ)("div",{css:V,...t.draggableProps,ref:t.innerRef,style:t.draggableProps.style,className:(0,p.AK)({dragging:i.isDragging}),children:(0,Z.tZ)(y.sD,{task:n.data,topRightIcon:n.canWrite?(0,Z.tZ)(d.JO,{icon:"move",className:"_drag",...t.dragHandleProps}):(0,Z.tZ)("span",{})})})})),ne=e=>{let{onSave:t,onClose:i,data:n={}}=e;return(0,Z.tZ)(b.m,{form:new S({onSave:t,data:n}),onClose:i})},re=e=>{let{onSave:t,onClose:i,data:n={}}=e;return(0,Z.tZ)(b.m,{form:new C({onSave:t,data:n}),onClose:i})},se=e=>{let{onSave:t,onClose:i,data:n={}}=e;return(0,Z.tZ)(b.m,{form:new _({onSave:t,data:n}),onClose:i})};var oe=i(5247),ae=i(7018),le=i(7059),ce=i(8534),de=i(2616),pe=i(6291),ue=i(4268),me=i(6380),ge=i(8411),he=i(81),be=i(3346),ve=i(7828),_e=i(7965),fe=i(3550);const ye=(0,r.iv)(".MainCol{padding-top:0!important;background-color:",l.g.colors.bg_cont,"!important;}",""),we=(0,o.observer)((function(){const e=(0,n.useContext)(s.l9).getStore("tasks"),t=(0,n.useRef)(0),{ready:i}=e;(0,p.Ju)(lng("tasks",{phrase:!0}));const[r,o]=(0,n.useState)(null);return(0,n.useEffect)((()=>(i&&(t.current=setInterval((()=>e.refresh()),3e4)),()=>clearInterval(t.current))),[i]),i?(0,Z.tZ)(pe.T,{css:ye,internalScrolling:!0,children:(0,Z.tZ)(de.x9.Provider,{value:e,children:(0,Z.tZ)(ue.Z,{side:(0,Z.tZ)(ke,{}),mainRef:o,children:(0,Z.tZ)(a.SV,{children:(0,Z.tZ)(Ce,{scrollCont:r})})})})}):(0,Z.tZ)(oe.h,{})})),xe=(0,r.iv)("width:250px;min-width:250px;",l.g.mQuery.mobile,"{width:100%;}padding:20px;background-color:",l.g.colors.bg_page_containers,";display:flex;flex-direction:column;gap:5px;overflow:auto;direction:",l.g.isRTL?"ltr":"rtl",";>div{direction:",l.g.isRTL?"rtl":"ltr",";>.Button,>div .Button{padding:5px;display:flex;align-items:center;gap:8px;font-weight:600;&:not(.active){color:",l.g.colors.text_main,";}.Icon{min-width:23px;font-size:1.5em;}.Icon-arrow_go_far{font-size:.9em;}}.statistics{display:flex;flex-direction:column;}}.mobile-menu{position:absolute;top:10px;height:40px;padding:10px 10px 10px 0;",l.g.classes.near("10px"),";",l.g.classes.far("10px"),";display:flex;justify-content:space-between;border:1px solid ",l.g.colors.separator,";border-radius:10px;>div{align-items:center;display:flex;.counter-badge{",l.g.classes.margin_near("5px"),";}}}",""),ke=(0,o.observer)((function(){const e=(0,n.useContext)(de.x9),t=e.tabsWithCounters.map((e=>{let{val:t,label:i,icon:n,badge:r,subTabs:s}=e;return{val:t,label:i,icon:n,badge:r,subTabs:s}})),[i,r]=(0,n.useState)(t.find((t=>t.val==e.tab)));return(0,Z.BX)("div",{css:xe,children:[!(0,p.Oz)()&&(0,Z.BX)("div",{children:[t.map((t=>{let{val:i,label:r,icon:s,badge:o,subTabs:a}=t;return(0,Z.BX)(n.Fragment,{children:[(0,Z.tZ)(Ze,{tStore:e,val:i,label:r,icon:s,badge:o}),(null==a?void 0:a.length)>0&&(0,Z.tZ)(fe.b,{onSort:e=>{let{new_order:t}=e;return n=t,r=a,"board"==(s=i)?r.forEach((e=>e.widget_order=n.indexOf(e.object_id))):"custom"==s&&r.forEach((e=>e.widget_order=n.indexOf(e.bookmark_id))),(0,k.SC)("tasks/reorder_side_menu",{method:"POST",data:{ordering:n,type:s}});var n,r,s},children:a.sort(((e,t)=>e.widget_order-t.widget_order)).map((t=>(0,Z.tZ)(Ze,{tStore:e,val:"board"===i?`board/${t.val}`:t.val,label:t.label},t.val)))})]},i)})),e.resolution_numbers&&(0,Z.BX)("div",{className:"statistics mobile_off",children:[(0,Z.tZ)(le.N4,{label:lng("open tasks"),number:e.resolution_numbers.open||"0",icon:"sand_clock",color:l.g.colors.yellow}),(0,Z.tZ)(le.N4,{label:lng("in progress"),number:e.resolution_numbers.in_progress||"0",icon:"badge-rising-graph",color:l.g.colors.light_blue})]})]}),(0,p.Oz)()&&(0,Z.tZ)(h.x,{onSelect:i=>(r(t.find((e=>e.val==i))),e.tab=i),options:t,children:(0,Z.BX)("div",{className:"mobile-menu",children:[(0,Z.BX)("div",{children:[(0,Z.tZ)(d.JO,{icon:i.icon,buttonLike:!0}),i.label," ",(0,Z.tZ)(me.T,{className:"counter-badge",badge:i.badge})]}),(0,Z.tZ)(d.JO,{icon:"arrow_down"})]})})]})})),Ze=(0,o.observer)((function(e){let{val:t,label:i,icon:r,badge:s,tStore:o}=e;const a=t===o.tab,c=(0,n.useContext)(fe.y);return(0,Z.BX)(N.l,{onClick:()=>o.tab=t,className:(0,p.AK)("view_button",{active:a}),children:[(0,Z.tZ)(d.JO,{icon:r||(a?"circle_dot":"circle")}),(0,Z.tZ)("div",{css:l.g.classes.ellipsis,children:null==i?void 0:i.caps()}),(0,Z.tZ)(I.zh,{}),(t.includes("board")&&(0,p.B5)(t.split("/")[1])||(0,p.B5)(t))&&c&&(0,Z.tZ)("span",{...c.attributes,...c.listeners,children:(0,Z.tZ)(d.JO,{iconClass:"state-icon",icon:"equals",color:a?l.g.colors.dominant_main:l.g.colors.disabled_text})}),s>=0&&(0,Z.tZ)("div",{children:(0,Z.tZ)(me.T,{badge:s})})]},t)})),Ce=(0,o.observer)((function(e){var t;let{scrollCont:i}=e;const r=(0,n.useContext)(de.x9),{tab:s}=r;if(s.includes("board"))return(0,Z.tZ)(R,{});if("custom"===s||(0,p.B5)(s))return(0,Z.tZ)(Oe,{scrollCont:i},s);const o={key:s+"_tasks",listKey:s+"_tasks",title:null===(t=r.tabData)||void 0===t?void 0:t.label,viewMode:!0,scrollParent:i,sticky:0};switch(s){case"new":Object.assign(o,{filteredTasks:r.filteredNewTasks,tasks:r.new_tasks,filterNsort:r.filterNsort.new,markAsSeen:!0});break;case"recent":Object.assign(o,{tasks:r.recent_tasks});break;case"updated":Object.assign(o,{filteredTasks:r.filteredUpdatedTasks,tasks:r.updated_tasks,filterNsort:r.filterNsort.updated,markAsSeen:!0});break;case"my":Object.assign(o,{filteredTasks:r.filteredMyTasks,tasks:r.my_tasks,filterNsort:r.filterNsort.my,priorityOn:!0});break;case"bookmarks":Object.assign(o,{filteredTasks:r.filteredBookmarksTasks,tasks:r.bookmark_tasks,filterNsort:r.filterNsort.bookmarks,priorityOn:!0});break;default:return null}return(0,Z.tZ)(ae.B,{...o})})),Se=(0,r.iv)(".toggler{margin-top:7px;border-top:1px solid ",l.g.colors.separator,";display:flex;justify-content:center;>.Icon{background:",l.g.colors.separator,";padding:4px 9px;border-radius:0 0 10px 10px;cursor:pointer;}}",""),Oe=(0,o.observer)((function(e){let{scrollCont:t}=e;const i=(0,n.useContext)(de.x9),r=i.getViewForm(),{tab:s,task_statuses:o,task_types:a,viewTasks:c,tabData:u,extraFields:m,onUser:h}=i,b=(0,p.B5)(s),{filtersVals:_,setFilterVals:f,sort:w}=(0,he.qD)(r.filterNsort),[x,k]=(0,n.useState)(!b),C=(0,n.useRef)(!0);(0,n.useEffect)((()=>{C.current?C.current=!1:i.exeView()}),[w]);const S=Array.isArray(o)?o:[],O=[{type:"select_multi",name:"status_id",label:lng("status"),outOfMenu:!0,wrapped:!0,options:S.sort(((e,t)=>y.oJ.indexOf(e.resolve)-y.oJ.indexOf(t.resolve))).map((e=>({val:e.id,label:(0,y.HR)(e.name),color:(0,y.Pp)(e.resolve)})))},{type:"select_multi",name:"resolution",label:lng("resolution"),outOfMenu:!0,wrapped:!0,options:y.oJ.map((e=>({val:e,label:(0,y.Ey)(e),color:(0,y.Pp)(e)})))},{type:"select_multi",name:"task_type",label:lng("type"),outOfMenu:!0,wrapped:!0,options:a.map((e=>({val:e.id,label:e.name,color:e.colors[0]})))},{name:"priority",label:lng("priority"),type:"select_multi",options:[0,1,5,7,9].map((e=>({val:e,label:(0,y.aS)(e)})))},{type:"select",name:"creator_type",label:lng("created by"),emptyOption:!0,options:(0,p.wd)({users:lng("users"),managers:lng("managers")})}],B=[{icon:"reload",action:()=>i.exeView(),toolTip:lng("refresh")}];return(0,Z.BX)("div",{css:Se,children:[(0,Z.tZ)(ve.M,{initial:!1,children:x&&(0,Z.BX)(_e.E.div,{style:{overflow:"hidden"},initial:{height:0},animate:{height:"auto"},exit:{height:0},children:[(0,Z.tZ)("br",{}),(0,Z.BX)(I.c_,{children:[(0,Z.tZ)(ge.CX,{filters:O,filtersVals:_,onFilter:f,spreadFilters:!0,alwaysShow:!0}),(0,Z.tZ)(I.zh,{}),b&&(0,Z.tZ)("div",{children:(0,Z.tZ)(d.JO,{icon:"trash",buttonLike:!0,onClick:()=>i.deleteView()})})]}),(0,Z.BX)(v.q3.Provider,{value:r.form,children:[(0,Z.tZ)(be.au,{input:r.form.getFieldByName("filter[group]")}),(0,Z.tZ)(be.au,{input:r.form.getFieldByName("filter[user]")}),(0,Z.tZ)(be.au,{input:r.form.getFieldByName("filter[archive]")}),(0,Z.tZ)("div",{style:{maxWidth:"300px"},children:(0,Z.tZ)(be.au,{input:r.form.getFieldByName("custom_fields")})}),(0,Z.tZ)(be.au,{input:r.form.getFieldById("custom_fields_section")})]}),(0,Z.BX)(N.l,{bold:!0,chunky:!0,theme:"contained",onClick:()=>i.exeView(),children:[(0,Z.tZ)(d.JO,{icon:"enter"}),(0,Z.tZ)(I.Zv,{}),(b?lng("refresh"):lng("go")).caps()]}),(0,Z.tZ)(I.Zv,{}),(0,Z.BX)(N.l,{bold:!0,chunky:!0,theme:"outlined",onClick:()=>i.saveView(),children:[(0,Z.tZ)(d.JO,{icon:"save"}),(0,Z.tZ)(I.Zv,{}),(b?lng("save"):lng("save as view")).caps()]}),(0,Z.tZ)(I.Zv,{}),b&&(0,Z.BX)(N.l,{bold:!0,chunky:!0,theme:"outlined",onClick:()=>i.saveView(!0),children:[(0,Z.tZ)(d.JO,{icon:"copy"}),(0,Z.tZ)(I.Zv,{}),lng("save as copy").caps()]}),(0,Z.tZ)("div",{style:{height:"5px"}})]})}),(0,Z.tZ)("div",{className:"toggler",children:(0,Z.tZ)(d.JO,{onClick:()=>k(!x),icon:x?"arrow_up":"arrow_down"})}),c&&(c.abortFetch?(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)("br",{}),(0,Z.tZ)(g.$,{})]}):(0,Z.BX)(Z.HY,{children:[c.length>=500&&(0,Z.BX)("i",{style:{color:l.g.colors.warning},children:[(0,Z.tZ)(d.JO,{icon:"sign_notification"})," ",lng("maximum of %s tasks are displayed",c.length).caps()]}),(0,Z.tZ)(ae.B,{viewMode:!0,scrollParent:t,sticky:0,tasks:c,noFilterSort:"filter",title:null==u?void 0:u.label,displayCount:!0,filterNsort:r.filterNsort,extraFields:m,barExtraComponent:h&&Blsm.user.isPowerManager&&(0,Z.tZ)(d.JO,{icon:"report",href:{report:"TasksActivityReport",params:{range:"today",user:h}},toolTip:lng("open tasks activity report")}),actions:B,priorityOn:!0})]}))]})})),Be=()=>{const e=e=>{!1===e?(0,ce.nb)(lng("no workplans available")):(0,p.B5)(e)?(0,c.p4)({edit:"task",params:{ws:e}},!0):(0,u.cS)("",{title:lng("new task"),confirmText:lng("create"),startValue:e,inputType:"single_item",inputRequired:!0,inputOptions:{label:lng("select workspace").caps(),searchData:(e,t)=>(0,k.SC)("groups/autocomplete",{method:"POST",json:!0,data:{types:["Group","Ou","Qualification","Subset","Workplan","Course_template"],is_owner:1,managed_perm:"manage",member:1,tasks_enabled:1,term:e.term||""}},t)},onConfirm:e=>(0,c.p4)({edit:"task",params:{ws:e}},!0)})};void 0!==Blsm.InitialData.default_workplan||Blsm.user.isAdmin?e(Blsm.InitialData.default_workplan):(0,k.SC)("groups/autocomplete",{method:"POST",json:!0,data:{types:["Group","Ou","Qualification","Subset","Workplan","Course_template"],is_owner:1,managed_perm:"manage",member:1,tasks_enabled:1,term:"   ",limit:2}},(t=>{1===t.length?Blsm.InitialData.default_workplan=t[0].id:t.length>1?Blsm.InitialData.default_workplan=null:Blsm.InitialData.default_workplan=!1,e(Blsm.InitialData.default_workplan)}))}},5738:(e,t,i)=>{i.d(t,{dH:()=>S,lA:()=>P,P4:()=>T,bw:()=>D,xF:()=>j,Z:()=>O,Qy:()=>B});var n=i(4210),r=i(6975),s=i(8e3),o=i(7821),a=i(441),l=i(7154),c=i(7392),d=i(8534),p=i(8567),u=i(7363),m=i(6421),g=i(8318),h=i(5944);const b={name:"k6h3y7",styles:"display:flex;flex-direction:column;gap:5px"},v=function(e){let{mappableFields:t,sourceFields:i,value:n,onChange:s}=e;const[o,a]=(0,u.useState)((()=>Object.entries(n||{}).map((e=>{let[t,i]=e;return[i,t]})))),l=e=>{a(e),s(e.reduce(((e,t)=>{let[i,n]=t;return n&&i?{...e,[n]:i}:e}),{}))};return(0,h.BX)("div",{css:b,children:[o.map(((e,n)=>(0,h.tZ)(f,{pair:e,onChange:e=>l([...o.slice(0,n),e,...o.slice(n+1)]),onRemove:()=>l([...o.slice(0,n),...o.slice(n+1)]),mappableFields:t,sourceFields:i},n))),(0,h.tZ)("div",{children:(0,h.tZ)(r.JO,{icon:"sign_plus",smallButtonLike:!0,onClick:()=>l([...o,["",""]])})})]})},_={name:"12ly41g",styles:"display:flex;align-items:center;>._field_wrapper{flex:1 1 0;}"},f=function(e){let{pair:t,onChange:i,onRemove:n,mappableFields:s,sourceFields:o}=e;const[a,l]=t;return(0,h.BX)("div",{css:_,children:[(0,h.tZ)(m.I,{type:"text",wrapped:!0,value:a,onChange:e=>i([e,l]),suggest:o?{getData:(e,t)=>t(o.filter((t=>t.includes(e)&&t!==e)).map((e=>({value:e,label:e}))))}:void 0,placeholder:lng("remote field").caps()})," => ",(0,h.tZ)(m.I,{type:"select",wrapped:!0,value:l,onChange:e=>i([a,e]),options:(0,g.wd)(s.map((e=>[e,e]))),emptyOption:lng("select...")}),(0,h.tZ)("div",{children:(0,h.tZ)(r.JO,{icon:"trash",onClick:n,smallButtonLike:!0})})]})};var y,w,x,k;function Z(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function C(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let S=(y=o.action.bound,w=o.action.bound,x=class extends n.I{constructor(){var e,t,i,n;super(...arguments),Z(this,"objType",void 0),Z(this,"data",{}),Z(this,"isAdmin",!1),Z(this,"tutorial",void 0),Z(this,"group_id",void 0),Z(this,"importFromTemplate",!0),e=this,t="result",n=this,(i=k)&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0}),Z(this,"previewButtonLabel",lng("preview").caps()),this.confirmButtonLabel=lng("commit").caps(),(0,o.makeObservable)(this)}fetch(){(0,s.SC)(`import/${this.objType}/form`,{},(e=>{this.data=e,this.isAdmin=this.data.domains,this._buildFields(),this._prepFields(this.data),this.ready=!0}))}templateFields(){return this.importFromTemplate?[{type:"component",node:(0,h.tZ)("div",{children:(0,h.tZ)(a.A,{theme:"highlight",onClick:()=>(0,a.p4)(this.templateLink(this.values).csrf(),!0,!0),children:lng("template download").caps()})})},{type:"component",node:(0,h.BX)("div",{children:[(0,h.tZ)(r.JO,{icon:"menu_info"})," ",lng("you may upload an Excel file or a CSV encoded as UTF-8").caps()," "]})}]:[]}moreInfoFields(){return[]}settingsFields(){return[{type:"checkbox",name:"display_errors_only",label:lng("display only errors")}].filter((e=>e))}dataFileFields(){return this.importFromTemplate?[{type:"file",name:"sheet_file",label:lng("upload")},this.isAdmin&&{type:"text",name:"sheet_path",label:lng("or specify file location"),helpKey:"@import/sftp"}].filter((e=>e)):[]}_buildFields(){this.tutorial&&(this.titleExtra=(0,h.tZ)(l.u,{text:lng("online tutorial").caps(),children:(0,h.tZ)(r.JO,{icon:"badge-bulb",href:"https://www.blossom-kc.com/support/tutorials?tc="+this.tutorial,newTab:!0,className:"tutorial"})})),this._fields.push({type:"indent_set",toggleTitle:lng("template download").caps(),toggle:!0,fields:this.templateFields()},{type:"indent_set",toggleTitle:lng("more information").caps(),toggle:!0,fields:this.moreInfoFields()},{type:"indent_set",toggleTitle:lng("data file").caps(),toggle:!0,fields:this.dataFileFields()},{type:"indent_set",toggleTitle:lng("settings").caps(),toggle:!0,fields:this.settingsFields()});for(const e of this._fields)"indent_set"===e.type&&0===e.fields.length&&(e.insert=!1);this.isAdmin&&this._fields.unshift({type:"select",name:"domain",label:lng("select domain"),options:this.data.domains}),this.data.mappable_fields&&this._fields.push({type:"indent_set",toggleTitle:lng("field mapping").caps(),toggle:!0,fields:[{type:"component",name:"extended_map",Render:v,props:{mappableFields:this.data.mappable_fields,sourceFields:this.data.source_fields}}]}),this.isAdmin&&this._fields.push({type:"indent_set",toggleTitle:lng("scheduling").caps(),toggle:!0,fields:[{type:"checkbox",name:"auto_run",label:lng("run import every night"),grow:5,disable:this.scheduleDisabled},{type:"component",node:(0,h.tZ)(c.l,{theme:"outlined",onClick:()=>this.saveSchedule(),children:lng("save scheduling settings").caps()})}]})}scheduleDisabled(e){return!e.get("sheet_path")}saveSchedule(){(0,s.SC)(`import/${this.objType}/schedule`,{method:"POST",data:this.buildFinalValues()},(e=>{e.message&&(0,d.qV)(e.message)}))}preview(){this.values.delete("commit"),this.callSave()}commit(){this.validate().then((e=>{!0===e&&(this.values.set("commit",1),this.callSave())}))}save(e){this.saveToUrl(`import/${this.objType}/import`,Object.assign({group_id:this.group_id},e))}findServerMessage(e){return e.split("</table>")[1]+`</br> ${lng("see table for more details").caps()}`}SaveSuccess(e){if(this.values.get("commit")){const t=this.findServerMessage(e);(0,p.qR)((0,h.tZ)("div",{dangerouslySetInnerHTML:{__html:t}}),{title:lng("done")})}this.values.set("commit",0),this.result=e}templateLink(){return Blsm.prm.Mainref+`api?import/${this.objType}/sample/`}},k=C(x.prototype,"result",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),C(x.prototype,"preview",[y],Object.getOwnPropertyDescriptor(x.prototype,"preview"),x.prototype),C(x.prototype,"commit",[w],Object.getOwnPropertyDescriptor(x.prototype,"commit"),x.prototype),x);const O={type:"select",name:"userCol",label:lng("user column").caps(),options:(0,g.mi)(["user_name","user_external_id"]),caps:!1},B={...O,options:[...O.options,...(0,g.mi)(["username","external_id"])]},T={type:"select",name:"groupCol",label:lng("workspace column",lng("group")).caps(),options:(0,g.mi)(["workspace_name","workspace_external_id"]),caps:!1};var N={name:"1r5gb7q",styles:"display:inline-block"};const I=e=>{let{label:t,values:i}=e;return(0,h.BX)("div",{children:[(0,h.tZ)("span",{css:N,children:t})," ",Array.isArray(i)?i.map(((e,t)=>(0,h.BX)("span",{children:[(0,h.tZ)("b",{children:e}),t+1<i.length?", ":""]},t))):i]})},D=(e,t)=>({type:"component",node:(0,h.tZ)(I,{label:e,values:t})}),j=(e,t)=>({type:"set",fields:[{type:"component",node:(0,h.tZ)(I,{label:e+":"})},{type:"indent_set",fields:t.map((e=>{let{val:t,label:i}=e;return{type:"component",node:(0,h.BX)("div",{children:[(0,h.tZ)("b",{children:t}),(0,h.tZ)("br",{}),null==i?void 0:i.caps()]})}}))}]}),P=e=>`data:text/csv;charset=utf-8,${e.join("\n")}`},423:(e,t,i)=>{i.d(t,{l:()=>_,r:()=>f});var n,r,s,o=i(5738),a=i(676),l=i(5560),c=i(9180),d=i(7821),p=(i(7882),i(8567)),u=i(9934),m=i(441),g=i(5007),h=i(9637),b=i(5944);function v(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let _=(n=d.action.bound,r=class e extends o.dH{static match(t,i){let{nav:n}=i;const[r,...s]=t;if("ical"===r)return new e({route:s,nav:n})}constructor(e){var t,i,n,r;super(e),t=this,i="events",r=this,(n=s)&&Object.defineProperty(t,i,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0}),(0,d.makeObservable)(this),this.title=lng("import calendar").caps(),this.objType="ical",this.confirmButtonLabel=lng("save").caps(),this._fields=[{type:"file",name:"ics_file",label:lng("upload the data file containing the events information"),required:!0},{type:"text",name:"calendar_name",label:lng("calendar name"),required:!0},{type:"checkbox",name:"is_blocking",label:lng("set events as blocking events")}],this._prepFields(),this.ready=!0}save(e){var t;if(e.commit)if((null===(t=this.events)||void 0===t?void 0:t.length)>0){const t=this.events.filter((e=>e._checked));t.length>0?(t.map(((t,i)=>e[`cb[${i}]`]=JSON.stringify(t))),this.saveToUrl("calendar/import_ical_save",e)):(0,p.qR)(lng("please select at least one event"))}else(0,p.qR)(lng("please upload ICS or ICAL file with events")),this.values.set("commit",0);else this.saveToUrl("calendar/import_ical_data",e)}SaveSuccess(e){if(this.values.set("commit",0),e.events){let t=[];for(const[i,n]of Object.entries(e.events))n.key=i,t.push(new u.o(n));this.events=t}else(0,g.vm)().invalidateStore("calendar"),(0,m.p4)("#calendar",!0)}},s=v(r.prototype,"events",[d.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v(r.prototype,"SaveSuccess",[n],Object.getOwnPropertyDescriptor(r.prototype,"SaveSuccess"),r.prototype),r);const f=(0,l.observer)((function(e){let{events:t,scrollParent:i}=e;const n=[{title:lng("name")},{title:lng("start date")},{title:lng("end date")},{checkAll:!0}];return(0,b.tZ)("div",{children:(0,b.tZ)(a.iA,{cols:n,collection:t,rowIdCol:"key",loading:null===t,RowRenderer:y,compact:!0,scrollParent:i,noWindow:!0})})})),y=(0,l.observer)((function(e){let{row:t}=e;const{name:i,start:n,end:r}=t;return(0,b.BX)("tr",{children:[(0,b.tZ)(h.U6,{children:i}),(0,b.tZ)("td",{children:(0,b.tZ)(c.qp,{time:n})}),(0,b.tZ)("td",{children:(0,b.tZ)(c.qp,{time:r})}),(0,b.tZ)(h.Fo,{o:t})]})}))},3389:(e,t,i)=>{i.d(t,{b:()=>_,q:()=>v});var n=i(917),r=i(5560),s=i(7363),o=i(5007),a=i(6291),l=i(676),c=i(5151),d=i(8318),p=i(5247),u=i(2883),m=i(4268),g=i(6920),h=i(1137),b=i(5944);const v=(0,r.observer)((function(){var e;const t=(0,s.useContext)(o.l9).getStore("list");if(!1===t.ready)return(0,b.tZ)(p.h,{});if(t.error)return(0,b.tZ)(a.T,{children:t.error});const i=t.listObj;(0,d.Ju)(i.title);const r=i.pagination.totalItems;return(0,b.BX)(a.T,{bottomPadding:!0,children:[(0,b.tZ)(n.xB,{styles:(0,n.iv)("body{overflow-x:auto;",g.g.mQuery.notMobile,"{width:calc(100vw - 10px);}}","")}),(0,b.tZ)(u.v7,{headline:null===(e=i.title)||void 0===e?void 0:e.caps(),count:r,simple:!i.tabs.length,tabs:i.tabs.length>0?{tabs:i.tabs,activeTab:i.activeTab}:void 0,maxItems:i.maxItems}),(0,b.tZ)(m.Q,{children:(0,b.tZ)(_,{list:i,sticky:!0})}),i.drawerOpen&&(0,b.tZ)(h.d,{from:"side",onClose:()=>i.onDrawerClose(),children:i.drawerContent})]})})),_=(0,r.observer)((function(e){let{list:t,sticky:i}=e;const{cols:n,shownItems:r,filters:o,sorts:a,filterNsort:d,actions:p,barExtra:u,RowRenderer:m,rowIdCol:h,status:v,pagination:_,mobileSupport:f}=t;return(0,s.useEffect)((()=>(document.body.classList.add("horz_scroll"),()=>document.body.classList.remove("horz_scroll"))),[]),(0,b.BX)(b.HY,{children:[(0,b.tZ)(l.iA,{cols:n,collection:r,filters:o,sorts:a,filterNsort:d,filterDelay:1e3,actions:p,barExtraComponent:u,RowRenderer:m,rowIdCol:h,sticky:i?g.g.consts.TABLE_HEAD_HEIGHT:null,loading:"fetch"===v,noWindow:!0,compact:!0,mobileSupport:f,rowProps:t}),(0,b.tZ)(c.t,{..._,onChange:e=>_.curPage=e})]})}))},8555:(e,t,i)=>{i.d(t,{Fw:()=>b,TK:()=>w});var n=i(4216),r=i(917),s=i(5560),o=i(7821),a=i(8318),l=i(8e3),c=i(9180),d=i(9637),p=i(7363),u=i(6920),m=i(5944);function g(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const h="activity_log";class b extends n.D{static match(e,t){let{nav:i}=t;const[n,...r]=e;if(n===h)return new b({route:r,nav:i})}constructor(e){let{route:t,nav:i}=e;super({route:t,nav:i,basePath:h}),g(this,"_export",["csv"]),(0,l.SC)("domains/list_activity_log_filters",{},(e=>{let t=e.type,i=e.discipline;i.unshift(["",""]),t.unshift(["",""]),this._buildCols({activityTypes:t,activityDiscipline:i})}))}_buildCols(e){let{activityTypes:t,activityDiscipline:i}=e;this.title=lng("activity log").caps(!0),this._checkAllCol=!1,this._actionsCol=!1,this.RowRenderer=v,this._cols=[{title:"#",sortVal:"id",input:"text"},{title:lng("date").caps(),sortVal:"time"},{title:lng("discipline").caps(),sortVal:"discipline"},{title:lng("action").caps(),sortVal:"type"},{title:lng("user").caps(),sortVal:"user_name",input:"text"},{title:lng("predicate").caps()+" #",sortVal:"predicate_id",input:"text"},{title:lng("predicate").caps(),sortVal:"predicate_name",input:"text"},{title:`${lng("details")}: ${lng("user")}`.caps(),sortVal:"par_user_id",input:"number"},{title:`${lng("details")}: ${lng("workspace")}`.caps(),sortVal:"par_group_id",input:"number"},{title:lng("origin ip").caps(),sortVal:"origin_ip",input:"text"}],this.colsToFiltersAndSorts(),this._filters.push({label:lng("action").caps(),name:"type",type:"select",options:(0,a.wd)(t)},{label:lng("discipline").caps(),name:"discipline",type:"select",options:(0,a.wd)(i)},{label:lng("from date"),name:"date_from",type:"date"},{label:lng("to date"),name:"date_to",type:"date"},{label:lng("details"),name:"parameters",type:"text"},{label:lng("security related"),name:"sec_only",type:"checkbox"},{label:lng("changes tracker"),name:"changelog",type:"toggle",outOfMenu:!0}),this.rowIdCol="id",this.fetchUrl="domains/list_activity_log",this.rowProps={filterNsort:this.filterNsort},this.ready=!0,this.fetch()}_acceptDataFromServer(e){const t={};e.items.sort(((e,t)=>e.time-t.time)),e.items.forEach(((i,n)=>{if((0,a.xb)(i.parameters))return;const r=(e=>`${"create"===e.type?"update":e.type}:${e.discipline}:${e.predicate_id}`)(i),s=(0,o.toJS)(i.parameters);t[r]||(t[r]=[]),e.items[n].parameters_diff=t[r].length?_(t[r][t[r].length-1],s):s,t[r].push(s)})),super._acceptDataFromServer(e)}}const v=(0,s.observer)((function(e){let{row:t,rowProps:{filterNsort:i}}=e;const[n,s]=(0,p.useState)(!!i.filter.changelog),{id:o,time:l,discipline:g,type:h,predicate_id:b,predicate_name:v,pretender:_,user:f,origin_ip:w,parameters:x,parameters_diff:k}=t,Z=(0,r.iv)("direction:ltr;.emptyval{color:",u.g.colors.warning,";}&,& td{border:none!important;}","");return(0,m.BX)(m.HY,{children:[(0,m.BX)("tr",{onClick:()=>{s(!n)},children:[(0,m.BX)(d.U6,{children:["#",o]}),(0,m.tZ)("td",{children:(0,m.tZ)(c.qp,{time:l})}),(0,m.tZ)("td",{children:g.caps()}),(0,m.tZ)("td",{children:h.caps()}),(0,m.BX)("td",{children:[_?(0,a.v2)(_)+" "+lng("as")+" ":"",f?(0,a.v2)(f):""]}),(0,m.tZ)("td",{children:b}),(0,m.tZ)("td",{children:v}),(0,m.tZ)("td",{children:t.par_user_id&&`${t.par_user_full_name} #${t.par_user_id}`}),(0,m.tZ)("td",{children:t.par_group_id&&`${t.par_group_name} #${t.par_group_id}`}),(0,m.tZ)("td",{children:w})]}),n&&(0,m.tZ)("tr",{css:Z,children:(0,m.tZ)("td",{colSpan:"10",children:x?(0,m.tZ)(y,{className:"detailsCell",json:i.filter.changelog?k:x,empty:(0,m.tZ)("i",{className:"emptyval",children:"×"})}):null})})]})})),_=(e,t)=>{const i={};return Object.keys(e).forEach((n=>{if(e[n]!==t[n])if("object"==typeof e[n]&&"object"==typeof t[n]){const r=_(e[n],t[n]);Object.keys(r).length&&(i[n]=r)}else(0,a.DM)(t[n])?i[n]=t[n]:i[n]=""})),Object.keys(t).forEach((n=>{(0,a.DM)(e[n])||(i[n]=t[n])})),i},f=(0,r.iv)(u.g.mQuery.notMobile,"{max-width:calc(100vw - 90px);columns:",Math.floor((innerWidth-90)/445),";column-gap:5px;& &{columns:1;}.row{max-width:calc(440px);overflow:hidden;}}.row{display:block;}.label,.val{display:inline-block;vertical-align:top;border-radius:",u.g.consts.SKINNY_BORDER_RADIUS,"px;}.cascade_row{display:block;.val{background-color:",u.g.colors.bg_2,";margin-inline-start:20px;}}.label{font-weight:normal;margin-inline-end:5px;color:",u.g.colors.dominant_main,";&::after{content:': ';}}.val{color:",u.g.colors.text_sec,";background-color:",u.g.colors.bg_1,";font-weight:bold;min-width:1ch;min-height:1ex;padding:0 2px;word-break:break-word;white-space:break-spaces;}.row:not(:last-child){margin-inline-end:20px;}& &>.row>.val{border:1px dotted ",u.g.colors.border,";}",""),y=e=>{let{json:t,empty:i=""}=e;return(0,a.xb)(t)?i:(0,a.zG)(t)?t.map(((e,t)=>(0,m.tZ)(y,{json:e,empty:i},t))):(0,a.HD)(t)?t:(0,a.Kn)(t)?(0,m.tZ)("div",{css:f,children:Object.keys(t).map((e=>(0,m.BX)("div",{className:(0,a.Kn)(t[e])?"cascade_row":"row",children:[(0,m.tZ)("div",{className:"label",children:e}),(0,m.tZ)("div",{className:"val",children:(0,m.tZ)(y,{json:t[e],empty:i})})]},e)))}):JSON.stringify(t)},w=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"update",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return{list:"activity_log",params:`filters[discipline]=${e}&filters[predicate_id]=${t}&filters[type]=${i}&filters[changelog]=${n}&sort=time`,newTab:!0}}},5597:(e,t,i)=>{i.d(t,{KX:()=>A,Om:()=>L,_9:()=>Y,mL:()=>K,r4:()=>q,rl:()=>J});var n,r,s,o=i(917),a=i(4216),l=i(5560),c=i(676),d=(i(7882),i(7363)),p=i(8e3),u=i(8567),m=i(7821),g=i(441),h=i(6920),b=i(6975),v=i(9180),_=i(5898),f=i(5007),y=i(3718),w=i(7154),x=i(5474),k=i(6704),Z=i(1619),C=i(8162),S=i(8318),O=i(1137),B=i(8207),T=i(5446),N=i(7392),I=i(8534),D=i(1092),j=i(2334),P=i(409),z=i(5944);function E(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function R(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function F(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const M="approvals",A={Activity:lng("activity"),Reg:lng("course registration"),RegExt:lng("external events"),RegExtMgr:`${lng("external events")} (${lng("manager registration")})`,AuthorizeGroup:lng("groups authorization"),AuthorizeContent:lng("content authorization"),Recruitment:lng("recruitments"),AuthorizeUser:lng("user authorization"),GroupReceipt:lng("expenses"),Resource:lng("resources"),Form:lng("forms"),Confirmation:lng("authorization confirmation")};let q=(n=class e extends a.D{constructor(e){var t,i,n;let{route:o,nav:a}=e;super({route:o,nav:a,basePath:M}),R(this,"priorities",{}),R(this,"mobileSupport",!0),E(this,"activeAction",r,this),E(this,"activeRequest_id",s,this),R(this,"suppliers",void 0),(0,m.makeObservable)(this),this.title=lng("approvals").caps(),this.RowRenderer=X,this.rowIdCol="request_id",this.fetchUrl="approval/list",this._export=!0,this._actions=[{icon:"menu_overview",className:"mobile_off",action:()=>(0,g.p4)({report:`Report_Approvals_Status_${this.activeTab}`},!0),toolTip:lng("approval status report").caps()},{icon:"mark_v_strong",action:()=>{(0,u.BB)(lng("are you sure you want to commit all priorities?"),{onConfirm:()=>{(0,p.SC)("approval/commit_priorities",{method:"POST"},(()=>this.fetch()))}})},toolTip:lng("commit priorities").caps()}],this.activeAction=(null==o||null===(t=o[0])||void 0===t?void 0:t.act)||this.activeAction,this.activeRequest_id=(null==o||null===(i=o[0])||void 0===i||null===(n=i.filters)||void 0===n?void 0:n.request_id)||this.activeRequest_id,this.colsToFiltersAndSorts(),this.tabs=K(),f.Nd.once("FetchNotifications",(()=>this.tabs=K())),this._filters.push({label:lng("end of sequence"),name:"last_step",type:"checkbox"}),this.ready=!0,this.fetch()}static match(t,i){let{nav:n}=i;const[r,...s]=t;if(r===M)return new e({route:s,nav:n,status:s[0].status})}buildCols(){this.optionalCols={targetName:!["AuthorizeUser"].includes(this.activeTab),orgUnit:!["Resource","GroupReceipt","Form"].includes(this.activeTab),amount_in_use:["Resource"].includes(this.activeTab),amount:["Resource","GroupReceipt"].includes(this.activeTab),workspace:["Resource"].includes(this.activeTab),meeting:["Resource"].includes(this.activeTab),period:["Resource","Reg","RegExt","RegExtMgr"].includes(this.activeTab),participants:["RegExtMgr"].includes(this.activeTab),description:!0},this._cols=[this.optionalCols.targetName&&{title:lng("target name"),sortVal:"target_name",input:"text"},{title:lng("name"),sortVal:"full_name",input:"text"},{title:lng("request date"),sortVal:"request_date"},this.optionalCols.orgUnit&&{title:lng("org' unit"),sortVal:"org_unit_name",input:"text"},this.optionalCols.amount_in_use&&{title:lng("amount in use")},this.optionalCols.amount&&{title:lng("amount|money")},this.optionalCols.workspace&&{title:lng("workspace")},this.optionalCols.participants&&{title:lng("participants")},this.optionalCols.meeting&&{title:lng("meeting")},this.optionalCols.period&&{title:lng("time"),sortVal:"start_date"},this.optionalCols.description&&{title:lng("description"),sortVal:"description",input:"text"},{title:lng("next approver"),sortVal:"approver_name",input:"text"}].filter((e=>!1!==e))}_acceptDataFromServer(e){var t;null===(t=e.items)||void 0===t||t.forEach((e=>{e.partners&&(e.partners=Object.values(e.partners)||[]),e.buttons.approve||e.buttons.reject||(e.disabled=!0)})),this.suppliers=e.suppliers,super._acceptDataFromServer(e),this.priorities=e.priorities}dynamic_actions(){if("RegExtMgr"===this.activeTab)return null;const e=this.checkedItems.map((e=>e[this.rowIdCol]));return[{icon:"like",color:h.g.colors.positive,toolTip:lng("approve"),action:e.length?()=>(0,u.BB)(lng("are you sure you want to approve the selected requests?").caps(),{onConfirm:()=>(0,p.SC)("approval/approve_multiple",{data:{ids:e},method:"POST"},(()=>this.fetch()))}):void 0},{icon:"dislike",color:h.g.colors.negative,toolTip:lng("reject"),action:e.length?()=>(0,u.BB)(lng("are you sure you want to reject the selected requests?").caps(),{onConfirm:()=>(0,p.SC)("approval/reject_multiple",{data:{ids:e},method:"POST"},(()=>this.fetch()))}):void 0}]}_updateFromUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;this.activeTab=this.hidden_filters.type=e.type||"Reg",this.buildCols(),super._updateFromUrl(e,t)}_filterNsortUrlPrep(){const e=super._filterNsortUrlPrep();return this.hidden_filters.type&&(e.type=this.hidden_filters.type),e}},r=F(n.prototype,"activeAction",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),s=F(n.prototype,"activeRequest_id",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F(n.prototype,"_updateFromUrl",[m.override],Object.getOwnPropertyDescriptor(n.prototype,"_updateFromUrl"),n.prototype),n);const X=(0,l.observer)((function(e){let{row:t,rowProps:i,rows:n}=e;const{target_name:r,user_id:s,full_name:o,org_unit_name:a,org_unit_id:l,description:m,amount_in_use:Z,amount:O,next_approver:B,group_id:N,start_date:D,due_date:j,open_past_requests:P,request_id:E,approved_past_requests:R,buttons:F,external_courses:M,target_data:A,type:q,assignment_id:X,partners:$,run_on:V,group_available:H,request_date:J}=t,{rowAction:G,activeTab:W,priorities:K,activeAction:Y,activeRequest_id:Q,optionalCols:ee,suppliers:te}=i,[ie,ne]=(0,d.useState)(Y&&Q==E),[re,se]=(0,d.useState)(null),[oe,ae]=(0,d.useState)(null),[le,ce]=(0,d.useState)(null),de=e=>{ie&&ne(!1),"approve"===e&&"reached_max"===F.approve?(0,u.qR)(lng("workspace members limit reached").caps()):"approve"===e&&"no_allocations_for_your_ou"===F.approve?(0,u.qR)(lng("no allocations for your org' unit").caps()):"allow_user_to_update_ect"===e?(0,u.cS)("",{title:`${lng("ask the user to update the external event").caps()} `,confirmText:lng("send"),inputType:"textarea",inputRequired:!0,onConfirm:e=>(0,p.SC)("approval/allow_user_update_request",{method:"POST",data:{text:e,approval_request_id:E}},(()=>(0,I.qV)(lng("message sent, now the user can update the request"))))}):(0,f.vm)().openDialog("form",new y._({pushState:!0,approval_request:t,suppliers:te,action:e,onSaveSuccess:()=>((0,f.vm)().closeDialog(),i.fetch())}))};F.history&&M.map(((e,t)=>e.key=t));ie&&de(Y);const pe=[ee.targetName&&(H?{_:(0,z.tZ)(g.A,{href:{workspace:N},children:r})}:r),{type:"main",_:(0,z.BX)(z.HY,{children:[(0,z.tZ)(w.y,{content:(0,z.tZ)(T.O,{userId:s}),children:o}),(0,z.BX)("span",{className:"mobile_off",children:[!!V&&(0,z.BX)(z.HY,{children:[" ",(0,z.tZ)(_.jC,{title:lng("run on"),color:h.g.colors.yellow,children:V})]}),(null==$?void 0:$.length)>0&&(0,z.BX)(z.HY,{children:[" ",(0,z.tZ)(_.jC,{color:h.g.colors.dominant_main,children:lng("with partners")})]}),!!P>0&&(0,z.BX)(z.HY,{children:[" ",(0,z.BX)(_.jC,{color:h.g.colors.dominant_main,title:lng("%s other open requests",P),children:[" ",P]})]}),!!R>0&&(0,z.BX)(z.HY,{children:[" ",(0,z.tZ)(_.jC,{color:h.g.colors.positive,title:lng("%s requests approved in the past",R),children:R})]})]})]})},{_:(0,z.tZ)(v.qp,{time:J})},ee.orgUnit&&l&&{_:(0,z.BX)(z.HY,{children:[a," ",(0,z.tZ)(b.JO,{icon:"enter",href:{workspace:l},newTab:!0})]})},ee.amount_in_use&&Z,ee.amount&&(0,S.vC)(O),ee.workspace&&{_:(0,z.BX)(z.HY,{children:[t.target_group_name," ",(0,z.tZ)(b.JO,{icon:"enter",href:{workspace:t.target_group_id,tab:"schedule"},newTab:!0})]})},ee.participants&&{_:(0,z.tZ)(z.HY,{children:Object.values(t.participants).length})},ee.meeting&&t.assignment_name,ee.period&&{_:(0,z.tZ)(v.qm,{dateNote:{start:D,end:j}})},ee.description&&{type:"description",text:m},{_:(0,z.tZ)(z.HY,{children:null!=B&&B.approver_id?(0,z.tZ)(w.y,{content:(0,z.tZ)(T.O,{userId:B.approver_id}),children:B.approver_name}):lng("end of sequence").caps()})},{type:"icons",_:(0,z.BX)(z.HY,{children:[(0,z.tZ)(b.JO,{icon:"details",buttonLike:!0,toolTip:lng("details"),onClick:()=>{"RegExt"===W||"RegExtMgr"===W?se(!0):"Form"===q?(0,g.p4)({launcher:"assignment",id:X,params:{request_id:E}},!0):"GroupReceipt"===q?ae(!0):ce(!0)}}),F.approve&&(0,z.tZ)(b.JO,{icon:"like",buttonLike:!0,toolTip:lng("approve"),color:!["reached_max","no_allocations_for_your_ou"].includes(F.approve)&&h.g.colors.positive,onClick:()=>de("approve")}),F.reject&&(0,z.tZ)(b.JO,{icon:"dislike",buttonLike:!0,toolTip:lng("reject"),color:h.g.colors.negative,onClick:()=>de("reject")}),F.back&&(0,z.tZ)(b.JO,{icon:"reply",buttonLike:!0,toolTip:lng("go back"),color:h.g.colors.warning,onClick:()=>de("back")}),F.history&&(0,z.tZ)(b.JO,{icon:"clock",buttonLike:!0,toolTip:lng("previously approved"),onClick:()=>(0,u.qR)((0,z.tZ)(L,{external_courses:M,target_data:A}),{type:"Alert",title:lng("external events").caps(),width:"80vw"})}),F.waiting_list&&(0,z.tZ)(b.JO,{icon:"waiting_list",buttonLike:!0,toolTip:lng("add to waiting list"),color:h.g.colors.no_progress,onClick:()=>de("waiting_list")}),F.priority&&(0,z.tZ)((()=>{const[e,i]=(0,d.useState)(t.priority),n=[{val:"0",label:lng("reject")}];if(K[N])for(let e=1;e<=K[N];e++)n.push({val:e.toString(),label:e.toString()});return(0,z.tZ)("span",{children:(0,z.tZ)(x.P,{emptyOption:`-${lng("priority")}`,options:n,value:e||"",onChange:e=>{i(e),(0,p.SC)("approval/prioritize_requests",{data:{requests_priorities:{[E]:e}},method:"POST"})}})})}),{}),F.cancel&&(0,z.tZ)(b.JO,{icon:"mark_x",buttonLike:!0,toolTip:lng("cancel"),color:h.g.colors.negative,onClick:()=>de("cancel_decision")}),F.send_message_to_update_ect&&(0,z.tZ)(b.JO,{icon:"message",buttonLike:!0,toolTip:lng("ask the user to update the external event"),color:h.g.colors.blue,onClick:()=>de("allow_user_to_update_ect")}),re&&(0,z.tZ)(k.G,{approvalRequest:t,onClose:()=>(se(!1),i.fetch()),performApprovalAction:de}),oe&&(0,z.tZ)(C.d,{approvalRequest:t,performApprovalAction:de,external:t.excourse_details,receipts:n.filter((e=>e.group_id===t.group_id&&e.type==t.type)).map((e=>Object.assign({highlight:e.receipt_id===t.receipt_id},e))),readOnly:!0,onClose:()=>ae(!1)}),le&&(0,z.tZ)(U,{approvalRequest:t,performAction:de,onClose:()=>ce(!1)})]})},{type:"checkbox",o:t}].filter((e=>!1!==e));return(0,z.tZ)(c.lF,{tds:pe,onClick:()=>null==G?void 0:G(t)})})),L=e=>{let{external_courses:t,target_data:i,forceMobileView:n}=e;i.approved_funding=i.approved_funding||{};const r=[{title:lng("name").caps()},{title:lng("start date").caps()},{title:lng("end date").caps()},{title:lng("academic hours").caps()},{title:lng("days off").caps()},{title:lng("paid leave days").caps()},{title:lng("tuition").caps()},{title:lng("total required funding").caps()},{title:lng("diploma").caps()}],s=(0,l.observer)((function(e){let{row:t}=e;const{group_name:i,group_open_date:n,group_close_date:r,diploma_file:s}=t,o=t.target_data||{},a=[{type:"main",_:i},{_:n&&(0,z.tZ)(v.qp,{time:n})},{_:r&&(0,z.tZ)(v.qp,{time:r})},Y("hours",o),Y("days_off",o),Y("paid_leave",o),Y("price",o),Y("funding",o),{_:s&&(0,z.tZ)(b.JO,{icon:"diploma",toolTip:lng("download diploma").caps(),href:{file:s}})}];return(0,z.tZ)(c.lF,{tds:a})}));return(0,z.tZ)("div",{css:H,children:(0,z.BX)("div",{className:"request-details-table",children:[(0,z.tZ)("span",{className:"sub-title",children:lng("previously approved").caps()}),(0,z.tZ)(c.iA,{cols:r,collection:t,RowRenderer:s,rowIdCol:"key",compact:!0,noWindow:!0,mobileSupport:!0,forceMobileView:n})]})})},$=e=>{let{request_id:t}=e;const i=[{title:lng("step")},{title:lng("name").caps()},{title:lng("date").caps()},{title:lng("data").caps()}],n=(0,l.observer)((function(e){let{row:t}=e;const{step:i,full_name:n,time:r,text:s,user_id:o,files:a}=t,l=(null==a?void 0:a.length)>0,d=null==s?void 0:s.truncate(27),p=(null==s?void 0:s.length)>27?()=>{(0,u.qR)((0,z.tZ)(Z.xn,{content:s}),{title:lng("request text from %s",n)})}:void 0,m=[i,{_:(0,z.tZ)(w.y,{content:(0,z.tZ)(T.O,{userId:o}),children:n})},{_:(0,z.tZ)(v.qp,{time:r})},{_:(0,z.BX)("div",{children:[(0,z.tZ)("div",{css:h.g.classes.ellipsis_lines(3),onClick:p,children:(0,z.tZ)(Z.xn,{content:d})}),l&&(0,z.BX)("div",{children:[lng("attachments").caps(),(0,z.tZ)("br",{}),a.map((e=>(0,z.BX)("div",{children:[(0,z.BX)(g.A,{theme:"highlight",href:{file:e},children:[e.file_name," (",(0,z.tZ)(v.qp,{time:e.creation_time}),")"]}),(0,z.tZ)("br",{})]},e.file_id)))]})]})}];return(0,z.tZ)(c.lF,{tds:m})})),[r,s]=(0,d.useState)(null);return(0,d.useEffect)((()=>{const e=(0,p.SC)("approval/previous_approvers_data",{data:{request_id:t}},(e=>{for(const[t,i]of Object.entries(e.steps))i.key=t,i.files=e.files[i.step];s(Object.values(e.steps))}));return()=>e&&e.abortFetch()}),[t]),(0,z.BX)("div",{className:"request-details-table",children:[(0,z.tZ)("span",{className:"sub-title",children:lng("request process").caps()}),(0,z.tZ)(c.iA,{cols:i,collection:r,loading:null===r,RowRenderer:n,rowIdCol:"key",mobileSupport:!0,noWindow:!0,whiteSpace:"normal"})]})},V=e=>{let{partners:t}=e;const i=[{title:lng("name")},{title:lng("status").caps()}],n=(0,l.observer)((function(e){let{row:t}=e;const{full_name:i,user_id:n,status:r}=t,s=[{_:(0,z.tZ)(w.y,{content:(0,z.tZ)(T.O,{userId:n}),children:i})},{_:(0,z.tZ)(z.HY,{children:r?"accepted"===r?(0,z.tZ)("span",{css:(0,o.iv)({color:h.g.colors.positive},""),children:lng("accepted").caps()}):(0,z.tZ)("span",{css:(0,o.iv)({color:h.g.colors.negative},""),children:lng("declined").caps()}):lng("waiting").caps()})}];return(0,z.tZ)(c.lF,{tds:s})}));return(0,z.BX)("div",{className:"request-details-table",children:[(0,z.tZ)("span",{className:"sub-title",children:lng("partners").caps()}),(0,z.tZ)(c.iA,{cols:i,collection:t,RowRenderer:n,rowIdCol:"user_id",compact:!0,noWindow:!0,mobileSupport:!0})]})},U=(0,l.observer)((function(e){let{onClose:t,approvalRequest:i,performAction:n}=e;const r=(0,d.useRef)(null);return(0,z.tZ)(O.d,{from:"side",onClose:t,ref:r,scroll:!0,children:(0,z.tZ)(B.W2,{head:(0,z.tZ)(B.$0,{title:i.target_name,onClose:()=>r.current.close()}),stickyHead:!0,children:(0,z.tZ)(J,{approvalRequest:i,performAction:n})})})})),H={name:"4a3itv",styles:".request-details-table,.requser-actions{margin-top:20px;>.buttons{display:flex;gap:8px;margin-bottom:10px;}}.sub-title{font-size:14px;font-weight:600;margin-bottom:15px;}.note{margin:15px 5px;}"},J=(0,l.observer)((function(e){var t;let{approvalRequest:i,performAction:n}=e;const{request_id:r,buttons:s,partners:o,run_on:a,open_past_requests:l,approved_past_requests:c,components:p}=i,u=n&&s&&Object.keys(s).filter((e=>"priority"!==e)).length>0,m=[{val:"step_details",label:"step details".caps()},(null==p?void 0:p.length)>0&&{val:"components",label:lng("authorization components status")}].filter((e=>e)),[g,v]=(0,d.useState)((null==m||null===(t=m[0])||void 0===t?void 0:t.val)||!1);return(0,z.BX)("div",{css:H,children:[m.length>1&&(0,z.tZ)(D.m,{stickyTabs:!0,tabs:m,onSelect:v,activeTab:g}),("step_details"===g||!m.length)&&(0,z.BX)("div",{children:[!!a>0&&(0,z.BX)(_.jC,{className:"note",color:h.g.colors.yellow,children:[lng("run on"),": ",a]}),!!l>0&&(0,z.tZ)(_.jC,{className:"note",color:h.g.colors.dominant_main,children:lng("%s other open requests",l)}),!!c>0&&(0,z.tZ)(_.jC,{className:"note",color:h.g.colors.positive,children:lng("%s requests approved in the past",c)}),(0,z.tZ)($,{request_id:r}),(null==o?void 0:o.length)>0&&(0,z.tZ)(V,{partners:o}),u&&(0,z.BX)("div",{className:"requser-actions",children:[(0,z.tZ)("div",{className:"sub-title",children:lng("actions").caps()}),(0,z.BX)("div",{className:"buttons",children:[s.approve&&(0,z.BX)(N.l,{theme:"outlined",onClick:()=>n("approve"),children:[(0,z.tZ)(b.JO,{icon:"like",color:"reached_max"!==s.approve&&h.g.colors.positive})," ",lng("approve").caps()]}),s.reject&&(0,z.BX)(N.l,{theme:"outlined",onClick:()=>n("reject"),children:[(0,z.tZ)(b.JO,{icon:"dislike",color:h.g.colors.negative})," ",lng("reject").caps()]}),s.back&&(0,z.BX)(N.l,{theme:"outlined",onClick:()=>n("back"),children:[(0,z.tZ)(b.JO,{icon:"reply",color:h.g.colors.warning})," ",lng("go back").caps()]}),s.waiting_list&&(0,z.BX)(N.l,{theme:"outlined",onClick:()=>n("waiting_list"),children:[(0,z.tZ)(b.JO,{icon:"waiting_list",color:h.g.colors.no_progress})," ",lng("add to waiting list").caps()]}),s.cancel&&(0,z.BX)(N.l,{theme:"outlined",onClick:()=>n("cancel_decision"),children:[(0,z.tZ)(b.JO,{icon:"mark_x",color:h.g.colors.negative})," ",lng("cancel").caps()]}),s.send_message_to_update_ect&&(0,z.BX)(N.l,{theme:"outlined",onClick:()=>n("allow_user_to_update_ect"),children:[(0,z.tZ)(b.JO,{icon:"message",color:h.g.colors.blue})," ",lng("ask the user to update the external event").caps()]})]})]})]}),"components"===g&&(0,z.tZ)(G,{components:p})]})})),G=e=>{let{components:t}=e;const i=[{title:lng("name").caps()},{title:lng("type").caps()},{title:lng("completed").caps()},{title:lng("completion date").caps()}];return(0,z.tZ)(c.iA,{cols:i,collection:t,rowIdCol:"assignment_id",RowRenderer:W})},W=e=>{let{row:t}=e;const{lesson_name:i,type:n,completed:r,last_change:s}=t,o="assignment"===n?lng("assignment").caps():"lesson"===n?lng("lesson").caps():(0,P.p)(n,!0,!1);return(0,z.BX)("tr",{children:[(0,z.tZ)("td",{children:i}),(0,z.tZ)("td",{children:(0,z.tZ)(_.jC,{title:lng("run on"),color:h.g.colors.entity[n.toLowerCase()]||h.g.colors.positive,children:o.caps()})}),(0,z.tZ)("td",{children:(0,z.tZ)(b.JO,{icon:(0,S.P$)(r)?"mark_v":"mark_x",color:(0,S.P$)(r)?h.g.colors.positive:h.g.colors.negative})}),(0,z.tZ)("td",{children:(0,j.GG)(s,{time:!1})})]})},K=()=>{var e;const t=null===(e=(0,f.vm)().notificationsStore)||void 0===e?void 0:e.approvals;return["Reg",Blsm.isFeatureEnabled("course_registartion_external")&&"RegExt",Blsm.isFeatureEnabled("course_registartion_external")&&"RegExtMgr","Activity",Blsm.checkMod(["","ENT"])&&"AuthorizeGroup",(null===(i=Blsm.InitialData.special)||void 0===i?void 0:i.authorize_content_seq)&&"AuthorizeContent",(null===(n=Blsm.InitialData.special)||void 0===n?void 0:n.user_registration_seq)&&"AuthorizeUser",Blsm.isFeatureEnabled("resources")&&Blsm.checkMod(["resources","ENT"])&&"Resource",Blsm.isFeatureEnabled("questionnaire_forms")&&Blsm.checkMod(["questionnaire_forms","ENT"])&&"Form",Blsm.isFeatureEnabled("course_registartion_external")&&Blsm.checkMod(["course_registartion_external","ENT"])&&"GroupReceipt",Blsm.isFeatureEnabled("authorization_qualification")&&"Confirmation"].filter((e=>e)).map((e=>({href:{list:`approvals/type=${e}`},badge:parseInt(null==t?void 0:t[e])||0,label:A[e],val:e})));var i,n},Y=(e,t)=>({_:(0,z.BX)(z.HY,{children:[(0,S.DM)(t[e])&&(0,z.tZ)(w.u,{text:lng("approved"),children:t[e]}),(0,S.DM)(t["r_"+e])&&(0,z.BX)(w.u,{text:lng("requested"),children:[(0,S.DM)(t[e])&&(0,z.tZ)(z.HY,{children:" "}),"(",t["r_"+e],")"]})]})})},4216:(e,t,i)=>{i.d(t,{D:()=>E});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_,f,y,w,x,k,Z,C=i(7821),S=i(8e3),O=i(9934),B=i(8567),T=i(6303),N=i(8318),I=i(5832),D=i(5944);function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function P(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let E=(n=C.observable.shallow,r=C.action.bound,s=C.action.bound,a=z((o=class{static match(){return!1}updateListRoute(e){const[t,i]=e;return this.basePath===t&&(this._updateFromUrl(i),!0)}constructor(e){let{basePath:t,route:i=[],nav:n}=e;j(this,"ready",a,this),j(this,"error",l,this),j(this,"status",c,this),j(this,"items",d,this),j(this,"filterNsort",p,this),j(this,"page",u,this),j(this,"pagination",m,this),P(this,"_urlPageSize",void 0),j(this,"title",g,this),P(this,"RowRenderer",null),j(this,"_filters",h,this),P(this,"_sorts",[]),j(this,"_cols",b,this),P(this,"_checkAllCol",!0),P(this,"_actionsCol",!0),j(this,"extraFields",v,this),P(this,"_extraFieldsData",[]),P(this,"customFields",{}),P(this,"rowIdCol",""),j(this,"_actions",_,this),P(this,"hidden_filters",{}),P(this,"nav",null),P(this,"basePath",""),P(this,"fetchUrl",null),P(this,"delUrl",null),j(this,"linkNew",f,this),j(this,"linkNewTooltip",y,this),P(this,"_export",!1),P(this,"_internalNav",!1),P(this,"_innerFilterSort",!1),P(this,"_curFetch",null),j(this,"tabs",w,this),j(this,"activeTab",x,this),P(this,"mobileSupport",!1),j(this,"drawerOpen",k,this),j(this,"drawerContent",Z,this),P(this,"isEnterprise",Blsm.checkMod(["","ENT"])),P(this,"maxItems",null),P(this,"deleteDialogTitle",void 0),P(this,"deleteDialogMessage",lng("are you sure you want to delete the selected items?").caps()),P(this,"onDelete",(()=>this.fetch())),(0,C.makeObservable)(this),this.nav=n,this.basePath=t;const[r]=i;this._updateFromUrl(r,!0);const s=()=>{this._internalNav||this._innerFilterSort||this.nav([this.basePath,this._filterNsortUrlPrep()],{replace:!0})};(0,C.observe)(this.filterNsort,(()=>(this.pagination.curPage=0,s()))),(0,C.observe)(this.pagination,"curPage",s),(0,C.observe)(this.extraFields,s)}fetch(){if(!this.fetchUrl)throw new Error("fetchUrl or _acceptDataFromServer are missing");this.status="fetch",this._curFetch&&this._curFetch.abortFetch(),this._curFetch=(0,S.SC)(this.fetchUrl,{data:Object.assign({},this.hidden_filters,this._filterNsortUrlPrep()),onComplete:()=>(this._curFetch=null,this.status="")},(e=>this._acceptDataFromServer(e)))}get cols(){return this._cols.concat(this.extraFields.map((e=>({title:this._extraFieldsData[e],sortVal:e}))),this._actionsCol?[{title:lng("actions")}]:[],this._checkAllCol?[{checkAll:!0}]:[]).filter((e=>e))}get sorts(){return this._sorts.concat(this.extraFields.map((e=>({val:e,label:this._extraFieldsData[e]}))))}get filters(){return this._filters.concat(this.extraFields.map((e=>{var t;const i=[{val:"",label:""},{val:"1",label:lng("yes")},{val:"0",label:lng("no")}],n={name:e,label:this._extraFieldsData[e],type:"text"},r=null===(t=this.customFields)||void 0===t?void 0:t[e];switch(e){case"user_gender":return{...n,type:"select",options:[{val:"",label:lng("").caps()},{val:"male",label:lng("male").caps()},{val:"female",label:lng("female").caps()},{val:"other",label:lng("other",{phrase:!0}).caps()}]};case"group_open_date":case"group_close_date":case"registration_start_date":case"registration_end_date":case"consent_eula_updated":case"user_birthdate":case"user_expiration":case"employment_date":return{...n,type:"date"};case"inherit_dates_from_meetings":return{...n,type:"select",options:i};default:if(r)switch(n.label=r.field_name,n.type=r.form_type,n.type){case"select":n.options=[{val:"",label:""},...Object.keys(r.field_data.values).map((e=>({val:e,label:e})))];break;case"checkbox":n.type="select",n.options=i}return n}}))).filter((e=>e))}onDrawerClose(){this.drawerOpen=!1}get checkedItems(){return this.items.filter((e=>e._checked))}_acceptDataFromServer(e){var t;this.items.replace(null===(t=e.items)||void 0===t?void 0:t.map((e=>new O.o(e)))),this.pagination.pageSize=e.page_size,this.pagination.totalItems=parseInt(e.count),e.custom_fields&&(this.customFields=Object.fromEntries(e.custom_fields.map((e=>[e.field_column,e]))))}_updateFromUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;const i={filter:e.filters||{},sort:{by:e.sort||"",desc:"1"===e.reverse}};this._internalNav=!0,(0,C.set)(this.filterNsort,i),this.pagination.curPage=parseInt(e.page)||0,(0,C.set)(this.extraFields,e.extra_fields||[]),this._urlPageSize=e.page_size,this._internalNav=!1,!t&&this.fetch()}_filterNsortUrlPrep(){return(0,N.v7)({filters:(0,C.toJS)(this.filterNsort.filter),sort:this.filterNsort.sort.by,extra_fields:(0,C.toJS)(this.extraFields),reverse:this.filterNsort.sort.desc?1:void 0,page:this.pagination.curPage||void 0,page_size:this._urlPageSize})}get actions(){const e=[];if(this._export){let t=[{label:lng("export to excel"),val:"xlsx"},{label:lng("export to excel (2003)"),val:"xls"},{label:lng("export to %s","PDF"),val:"pdf"},{label:lng("export to %s","CSV"),val:"csv"}];Array.isArray(this._export)&&(t=t.filter((e=>this._export.includes(e.val)))),e.push({icon:"download",menu:t,onSelect:e=>window.open((0,S.Q2)(this.fetchUrl,Object.assign({},this.hidden_filters,this._filterNsortUrlPrep(),{page_size:0,export:e})))})}if(null!==this.linkNew&&e.push({icon:"new",action:this.linkNew,toolTip:this.linkNewTooltip||lng("create new").caps()}),this.rowIdCol&&this.delUrl){const t=this.checkedItems.map((e=>e[this.rowIdCol]));e.push({icon:"trash",toolTip:lng("delete the selected items").caps(),action:t.length?()=>(0,B.BB)(this.deleteDialogMessage,{title:this.deleteDialogTitle,text:lng("delete").caps(),onConfirm:(0,N.Wl)(this.delUrl)?()=>this.delUrl(t):()=>(0,S.SC)(this.delUrl,{data:{ids:t},method:"DELETE"},this.onDelete)}):void 0})}return e.concat((0,C.toJS)(this._actions),this.dynamic_actions())}colsToFiltersAndSorts(){for(let{sortVal:e,title:t,input:i,options:n,emptyOption:r,outOfMenu:s,showSearch:o}of this._cols)e&&this._sorts.push({val:e,label:t}),e&&i&&this._filters.push({name:e,label:t,type:i,options:n,emptyOption:r,outOfMenu:s,showSearch:o});this._sorts.length&&this._sorts.unshift({val:"",label:lng("default")})}prepExtraFields(e){this._extraFieldsData=(0,N.v7)(e,((e,t)=>!this._cols.some((e=>e.sortVal===t)))),this.barExtra=(0,D.tZ)(T._,{options:(0,N.wd)(this._extraFieldsData),value:this.extraFields,maxLabelLength:20,emptyLabel:lng("select extra fields").caps()+"...",onChange:e=>{this.extraFields.replace(e),this.sorts.map((e=>e.val)).includes(this.filterNsort.sort.by)||(this.filterNsort.sort={by:"",desc:!1})}})}dynamic_actions(){return[]}get shownItems(){return this._innerFilterSort?(0,I.WB)(this.items,this.filterNsort.filter,this.filterNsort.sort):this.items}}).prototype,"ready",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=z(o.prototype,"error",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),c=z(o.prototype,"status",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d=z(o.prototype,"items",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=z(o.prototype,"filterNsort",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,I.Cy)()}}),u=z(o.prototype,"page",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=z(o.prototype,"pagination",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{curPage:void 0,pageSize:void 0,totalItems:void 0,maySeeAll:!1}}}),g=z(o.prototype,"title",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=z(o.prototype,"_filters",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b=z(o.prototype,"_cols",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=z(o.prototype,"extraFields",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=z(o.prototype,"_actions",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=z(o.prototype,"linkNew",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=z(o.prototype,"linkNewTooltip",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),w=z(o.prototype,"tabs",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=z(o.prototype,"activeTab",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),k=z(o.prototype,"drawerOpen",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Z=z(o.prototype,"drawerContent",[C.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z(o.prototype,"updateListRoute",[C.action],Object.getOwnPropertyDescriptor(o.prototype,"updateListRoute"),o.prototype),z(o.prototype,"fetch",[r],Object.getOwnPropertyDescriptor(o.prototype,"fetch"),o.prototype),z(o.prototype,"cols",[C.computed],Object.getOwnPropertyDescriptor(o.prototype,"cols"),o.prototype),z(o.prototype,"sorts",[C.computed],Object.getOwnPropertyDescriptor(o.prototype,"sorts"),o.prototype),z(o.prototype,"filters",[C.computed],Object.getOwnPropertyDescriptor(o.prototype,"filters"),o.prototype),z(o.prototype,"onDrawerClose",[s],Object.getOwnPropertyDescriptor(o.prototype,"onDrawerClose"),o.prototype),z(o.prototype,"checkedItems",[C.computed],Object.getOwnPropertyDescriptor(o.prototype,"checkedItems"),o.prototype),z(o.prototype,"_acceptDataFromServer",[C.action],Object.getOwnPropertyDescriptor(o.prototype,"_acceptDataFromServer"),o.prototype),z(o.prototype,"_updateFromUrl",[C.action],Object.getOwnPropertyDescriptor(o.prototype,"_updateFromUrl"),o.prototype),z(o.prototype,"actions",[C.computed],Object.getOwnPropertyDescriptor(o.prototype,"actions"),o.prototype),z(o.prototype,"shownItems",[C.computed],Object.getOwnPropertyDescriptor(o.prototype,"shownItems"),o.prototype),o)},4061:(e,t,i)=>{i.d(t,{Jv:()=>ie,Ss:()=>be,Kr:()=>Q,hk:()=>ue,Hc:()=>ee});var n=i(7363),r=i(7821),s=i(5560),o=i(4216),a=i(676),l=i(441),c=i(8e3),d=i(3051),p=i(6975),u=i(9180),m=i(8567),g=(i(7882),i(5007)),h=i(484),b=i(4210);function v(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class _ extends b.I{constructor(e){var t,i,n,r;super(e),v(this,"lessonId",void 0),this.lessonId=(null==e?void 0:e.content.lesson_id)||this.lessonId;const s=[];s.questnrName=(null==e||null===(t=e.content)||void 0===t?void 0:t.lesson_name)||(null==e||null===(i=e.content)||void 0===i?void 0:i.name),s.questnrType=null==e||null===(n=e.content)||void 0===n?void 0:n.lesson_type,s.questnrDesc=null==e||null===(r=e.content)||void 0===r?void 0:r.lesson_description,this.title=lng("duplicate questionnaire").caps(),this.confirmButtonLabel=lng("duplicate|verb").caps();const o=[["Test",lng("test")],["Survey",lng("survey")],["Evaluation",lng("evaluation")]];this._fields=[{type:"single_item",name:"existingQuestnr",label:lng("select existing questionnaire"),searchData:(e,t)=>{let{term:i,ids:n}=e;(0,c.SC)("ajax/QuestionnaireAjax.class.php",{data:{req:"get_questionnaires_list",term:i,id:n,limit:10,current_id:this.lessonId}},t)}},{type:"text",name:"questnrName",label:lng("questionnaire name").caps(),visible:e=>!e.get("existingQuestnr")},{type:"select",name:"questnrType",label:lng("questionnaire type").caps(),options:o,visible:e=>!e.get("existingQuestnr")},{type:"richtext",name:"questnrDesc",label:lng("questionnaire description").caps(),visible:e=>!e.get("existingQuestnr")},{type:"radioset",name:"questions_options",value:"link",options:[{val:"link",label:lng("link the questions to the new questionnaire").caps()},{val:"copy",label:lng("copy the questions to the new questionnaire").caps()},{val:"outline",label:lng("do not link the questions (questionnaire outline only)").caps()}]}],this._prepFields(s),this.ready=!0}save(e){this.saveToUrl("content/duplicate_questionnaire",Object.assign({duplicate_questionnaire:this.lessonId},e))}}var f=i(9934),y=i(5024);function w(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class x extends b.I{constructor(e){super(e),w(this,"lessonInfo",void 0),w(this,"folderOptions",void 0),this.folderOptions=(null==e?void 0:e.folderOptions)||this.folderOptions,this.lessonInfo=null==e?void 0:e.lessonInfo,this.title=lng("move to private folder").caps(),this.confirmButtonLabel=lng("move").caps(),this._fields=[{type:"component",name:"folder_id",Render:y.p,props:{folderTree:this.folderOptions}}],this._prepFields(this.lessonInfo),this.ready=!0}save(e){this.saveToUrl("catalog/attach_lesson",Object.assign({lesson_id:this.lessonInfo.lesson_id},e))}}var k=i(8318),Z=i(9829),C=i(793),S=i(2307),O=i(8534),B=i(917),T=i(6920),N=i(81),I=i(9489),D=i(7154),j=i(9637),P=i(8152),z=i(1750),E=i(6946);function R(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class F extends b.I{constructor(e){super(e),R(this,"lessonId",null),this.lessonId=(null==e?void 0:e.lessonId)||this.lessonId,this.title=lng("edit skills").caps()+": "+e.lessonName,this.successMessage=lng("content skills saved"),(0,c.SC)("skills/get_lesson_skills",{data:{lesson_id:this.lessonId}},(e=>{const t=[];null==e||e.forEach((e=>e.label=e.name?e.name:e.label)),t.skills=e,this.buildFields(t)}))}buildFields(e){this._fields=[{type:"multiple_items",name:"skills",label:lng("skills"),showId:!1,value:e.skills,valueIsMap:!0,theme:"bright",objectKeys:["sk_id","name","skill_level"],buttons:[{Render:E.EU}],searchData:(e,t)=>{(0,c.SC)("skills/autocomplete_skill",{data:{term:e.term||"",id:e.ids||""}},t)}}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("content/edit_content_skills",Object.assign({lesson_id:this.lessonId},e))}}function M(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class A extends b.I{constructor(e){super(e),M(this,"ids",null),M(this,"initialSkills",void 0),this.ids=e.ids,this.title=lng("edit skills").caps()+` (${e.ids.length})`,this.successMessage=lng("content skills saved"),(0,c.SC)("skills/get_lessons_skills",{data:{lesson_id:this.ids}},(e=>{const t=[];null==e||e.forEach((e=>e.label=e.name?e.name:e.label)),this.initialSkills=e.map((e=>({sk_id:e.sk_id,skill_level:e.skill_level}))),t.skills=e,this.buildFields(t)}))}buildFields(e){this._fields=[{type:"multiple_items",name:"skills",label:lng("skills"),showId:!1,value:e.skills,valueIsMap:!0,theme:"bright",objectKeys:["sk_id","name","skill_level"],buttons:[{Render:E.EU}],searchData:(e,t)=>{(0,c.SC)("skills/autocomplete_skill",{data:{term:e.term||"",id:e.ids||""}},t)}}],this._prepFields(),this.ready=!0}save(e){this.initialSkills.forEach((t=>{Object.values(e.skills).find((e=>e.sk_id===t.sk_id))||(t.skill_level="-deleted-",e.skills[t.sk_id]=t)})),this.saveToUrl("content/edit_multi_content_skills",Object.assign({ids:this.ids,skills:e.skills}))}}var q,X,L,$,V,U,H=i(666),J=i(7675),G=i(5944);function W(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function K(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const Y="content";let Q=(q=r.action.bound,X=r.action.bound,L=r.action.bound,$=r.action.bound,V=class e extends o.D{static match(t,i){let{nav:n}=i;const[r,...s]=t;if(r===Y)return new e({route:s,nav:n})}constructor(e){let{route:t,nav:i}=e;var n,s,o,a;super({route:t,nav:i,basePath:Y}),n=this,s="folderTree",a=this,(o=U)&&Object.defineProperty(n,s,{enumerable:o.enumerable,configurable:o.configurable,writable:o.writable,value:o.initializer?o.initializer.call(a):void 0}),W(this,"assignmentId",void 0),(0,r.makeObservable)(this),g.Nd.on("FolderTree",(e=>this.folderTree.replace(e))),this.title=lng("my content"),this.RowRenderer=ie,this.fetchUrl="catalog/my",this.delUrl="content/delete_contents",this._actionsCol=!1,this._cols=ee(),this.colsToFiltersAndSorts(),this.pagination.maySeeAll=!0,this.rowIdCol="lesson_id",this._export=this.isEnterprise,this._actions=[{icon:"new",menu:(0,H.mG)()}],this.fetch()}_acceptDataFromServer(e){e.items=e.my,this.folderTree=(null==e?void 0:e.folders_tree)||this.folderTree,this.categoriesOptions=(null==e?void 0:e.categories_options)||this.categoriesOptions,Blsm.isFeatureEnabled("content")&&(this.barExtra=(0,G.tZ)(be,{text:lng("drag files here to create multiple file content").caps(),onDrop:t=>(0,g.vm)().openDialog("form",new I.y({files:t,folderOptions:this.folderTree,categoriesOptions:null==e?void 0:e.categories_options,onSaveSuccess:()=>this.fetch()}))})),this.buildFilters({tagCategories:e.tag_categories,commonTags:e.most_common_tags}),super._acceptDataFromServer(e)}_updateFromUrl(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;this.hidden_filters.forms="trash"===(null===(e=t.filters)||void 0===e?void 0:e.folder)?"any":"",super._updateFromUrl(t,i)}tree_to_folder_list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.folders=t.folders||[],t.indent_char=t.indent_char||" ",t.all&&t.folders.unshift(["",lng("all").caps()]);const i=(e,n)=>{for(const r in e)e[r].id&&(t.include_non_numeric||(0,k.kE)(e[r].id)&&"repo"!==e[r].icon)&&(e[r].count&&null!=t&&t.display_count&&(e[r].label+=` (${e[r].count})`),t.folders.push([e[r].id,n+e[r].label])),e[r].sons&&e[r].sons.length&&i(e[r].sons,n+t.indent_char)};return i(e,""),t.folders}buildFilters(e){let{tagCategories:t,commonTags:i}=e;this._filters=[{label:"#",name:"lesson_id",type:"text"},{label:lng("name"),name:"name",type:"text",outOfMenu:!0},{label:lng("description"),name:"lesson_description",type:"text"},{label:lng("private folder").caps(),name:"folder",type:"select",options:(0,k.wd)(this.tree_to_folder_list((0,r.toJS)(this.folderTree),{display_count:!0,include_non_numeric:!0}))},{label:lng("category").caps(),name:"category",type:"select",emptyOption:lng("all").caps(),options:(0,k.wd)(this.categoriesOptions)},{label:lng("created by").caps(),name:"created_by",type:"text"},{label:lng("modified by").caps(),name:"modified_by",type:"text"},{label:lng("content type").caps(),name:"content_types",type:"select_multi",options:(0,k.wd)([["File",lng("file")],["Survey",lng("survey")],["Test",lng("test")],["Evaluation",lng("evaluation")],["Lti","lti"],["Text",lng("text")]])},{label:lng("estimated duration").caps(),name:"duration",type:"select_multi",options:(0,k.wd)(Z.l)},{label:lng("last modified").caps(),name:"period",type:"select",options:(0,k.wd)(C.l)}],i&&this._filters.push({label:lng("relevant tags").caps(),name:"tags",type:"select_multi",options:(0,k.wd)(i.map((e=>[e[1].tag_id,e[1].tag_name+` (${e[1].times})`])))}),t&&t.forEach((e=>this._filters.push({type:"select_multi",name:"tags",label:e.tag_category_name,options:(0,k.wd)(e.tags.map((e=>[e.tag_id,e.tag_name])))}))),this.ready=!0}dynamic_actions(){const e=this.checkedItems.map((e=>e[this.rowIdCol])),t=this.checkedItems.map((e=>e.name)),i=this.checkedItems.every((e=>!0===e.can_edit)),n=[];return this.isEnterprise&&n.push({icon:"edit",toolTip:lng("edit multiple content"),action:e.length?()=>(0,g.vm)().openDialog("form",new S.s({names:t,ids:e,folderOptions:this.folderTree,onSaveSuccess:()=>((0,g.vm)().closeDialog(),this.fetch())})):void 0},{icon:"lock",toolTip:lng("edit permissions of selected contents"),action:e.length?()=>(0,g.vm)().openDialog("form",new h.H({lessonId:e,lessonName:t.join(", "),onSaveSuccess:()=>((0,g.vm)().closeDialog(),this.fetch())})):void 0},Blsm.isFeatureEnabled("skills_occupations")&&{icon:"skill",toolTip:lng("edit multiple contents skills"),action:e.length&&i?()=>(0,g.vm)().openDialog("form",new A({ids:e,onSaveSuccess:()=>((0,g.vm)().closeDialog(),this.fetch())})):void 0}),Blsm.isFeatureEnabled("catalog")&&Blsm.checkMod(["catalog","ENT"])&&(Blsm.isFeatureEnabled("share_to_user")||Blsm.user.isManager)&&n.push({icon:"share",toolTip:lng("share multiple contents"),action:e.length?()=>(0,l.p4)({edit:"share",id:1===e.length&&e[0],params:e.length>1&&{ids:e.join(",")}},!0):void 0}),n}restoreContent(e){(0,m.BB)((0,G.tZ)("div",{children:lng("would you like to also restore the assignments associated with this content?").caps()}),{closeText:lng("cancel"),confirmText:lng("restore"),title:lng("restore content").caps(),extraTailButtons:[{label:lng("restore with assignments"),action:()=>(t(e,2),(0,m.wN)())}],onConfirm:()=>t(e,1)});const t=(e,t)=>{(0,c.SC)("content/restore_content",{method:"POST",data:{lesson_id:e,restore_assignments:2===t?1:""}},(()=>this.fetch()))}}deleteContent(e){this.items.remove(e)}addToList(e){e.domain_id=Blsm.user.domain_id,e.can_edit=!0,this.items.unshift(new f.o(e))}recommend(e){(0,g.vm)().openDialog("form",new J.O({object_id:e,object_type:"lesson",onSaveSuccess:()=>(0,g.vm)().closeDialog()}))}moveToFolder(e){const t=new x({lessonInfo:e,folderOptions:this.folderTree,onSaveSuccess:()=>{e.folder_id=t.values.get("folder_id"),(0,g.vm)().closeDialog(),(0,O.qV)(lng("moved folder"))}});(0,g.vm)().openDialog("form",t)}},U=K(V.prototype,"folderTree",[r.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),K(V.prototype,"_updateFromUrl",[r.override],Object.getOwnPropertyDescriptor(V.prototype,"_updateFromUrl"),V.prototype),K(V.prototype,"restoreContent",[q],Object.getOwnPropertyDescriptor(V.prototype,"restoreContent"),V.prototype),K(V.prototype,"deleteContent",[X],Object.getOwnPropertyDescriptor(V.prototype,"deleteContent"),V.prototype),K(V.prototype,"addToList",[L],Object.getOwnPropertyDescriptor(V.prototype,"addToList"),V.prototype),K(V.prototype,"moveToFolder",[$],Object.getOwnPropertyDescriptor(V.prototype,"moveToFolder"),V.prototype),V);const ee=()=>[{title:"#",sortVal:"lesson_id"},{title:lng("type"),sortVal:"lesson_type"},{title:lng("name"),sortVal:"name",input:"text"},{title:lng("description"),sortVal:"lesson_description",input:"text"},{title:lng("category")},{title:lng("created"),sortVal:"created"},{title:lng("created by"),sortVal:"creator"},{title:lng("last modified"),sortVal:"modified"},{title:lng("modified by"),sortVal:"author"},Blsm.isFeatureEnabled("skills_occupations")&&{title:lng("skills")},{title:lng("actions")}];var te={name:"1eoy87d",styles:"display:flex;justify-content:space-between"};const ie=(0,s.observer)((function(e){let{row:t,rowProps:i}=e;const{lesson_id:n,author:r,creator:s,type_title:o,name:c,descriptionIsHtml:m,lesson_description:h,category_name:b,modification_time:v,creation_time:_,can_edit:f,lesson_public:y,lesson_type:w,domain_id:x,domain_name:Z,category_id:C,skills:S,match_rate:O,lesson_owners:B,cur_version:N}=t,I=(f||(null==B?void 0:B.includes(String(Blsm.user.id))))&&Blsm.isFeatureEnabled("skills_occupations"),j=3==y||Blsm.user.isManager&&2==y||Blsm.user.power_user_assignment_permissions,z=()=>{f||j?(0,l.p4)({edit:"content",id:n,type:w,version:N},!0):(0,l.p4)({launcher:"lesson",id:n},!0,!0)},E=["#"+n,{_:(0,G.tZ)("span",{css:T.g.classes.content_type_style,children:o})},{type:"main",_:`${c} ${parseInt(x)!==Blsm.user.domain_id?"("+lng("from %s|domain",Z)+")":""}`},{type:"description",text:h,isHtml:(0,k.P$)(m)},{_:(0,G.tZ)(P.W,{category:b,category_id:C})},{_:(0,G.tZ)(u.qp,{time:_,showTime:!1})},{_:(0,k.v2)(s)},{_:(0,G.tZ)(u.qp,{time:v,showTime:!1})},{_:(0,k.v2)(r)},Blsm.isFeatureEnabled("skills_occupations")&&{_:(0,G.BX)("div",{css:te,children:[(0,G.tZ)("div",{children:S}),O&&(0,G.BX)(D.u,{css:ne,text:lng("skill match percent").caps(),children:[O,"%"]})]})},{type:"icons",_:(0,G.BX)(G.HY,{children:[(0,G.tZ)(d.x,{options:ue({content:t,actions:i,isList:!0}),children:(0,G.tZ)(p.JO,{icon:"menu",buttonLike:!0})}),(0,G.tZ)(p.JO,{icon:"play",buttonLike:!0,onClick:()=>(0,l.p4)({launcher:"lesson",id:n},!0,!0)}),I&&(0,G.tZ)(p.JO,{icon:"skill",buttonLike:!0,toolTip:lng("edit skills").caps(),onClick:()=>(0,g.vm)().openDialog("form",new F({lessonId:n,lessonName:c,onSaveSuccess:()=>(0,g.vm)().closeDialog()}))})]})},!!i._checkAllCol&&{type:"checkbox",o:t}];return(0,G.tZ)(a.lF,{tds:E,onClick:()=>null==z?void 0:z()})})),ne=(0,B.iv)("border-radius:20px;font-size:.9rem;padding:5px;background-color:",T.g.colors.warning,";color:white;",""),re=e=>{let{lessonId:t}=e;const[i,r]=(0,n.useState)(null);return(0,n.useEffect)((()=>{const e=(0,c.SC)("content/versions",{method:"POST",data:{lesson_id:t}},(e=>{const t=[];for(const[i]of Object.entries(e))t.push(e[i]);r(t)}));return()=>e&&e.abortFetch()}),[t]),(0,G.tZ)("div",{children:null!==i&&0===i.length?lng("no versions for this content").caps():(0,G.tZ)(a.iA,{cols:se,collection:i,loading:null===i,RowRenderer:oe,rowIdCol:"lesson_id",compact:!0,noWindow:!0})})},se=[{title:"#"},{title:lng("name").caps()},{title:lng("created").caps()},{title:lng("modified").caps()},{title:lng("version").caps()}],oe=(0,s.observer)((function(e){let{row:t}=e;const{lesson_id:i,lesson_name:n,lesson_type:r,creation_time:s,modification_time:o,previous:a}=t;return(0,G.BX)("tr",{children:[(0,G.tZ)("td",{children:i}),(0,G.tZ)(j.U6,{children:(0,G.tZ)("div",{onClick:()=>{(0,l.p4)({edit:"content",id:i,type:r},!0),(0,m.wN)()},children:n})}),(0,G.tZ)("td",{children:(0,G.tZ)(u.qp,{time:s})}),(0,G.tZ)("td",{children:(0,G.tZ)(u.qp,{time:o})}),(0,G.tZ)("td",{children:a?lng("previous").caps():lng("new").caps()})]})})),ae=e=>{let{lessonId:t}=e;const[i,r]=(0,n.useState)(null);return(0,n.useEffect)((()=>{const e=(0,c.SC)("content/associated_assignments/"+t,{},(e=>{const t=[];for(const[i]of Object.entries(e))t.push(e[i]);r(t)}));return()=>e&&e.abortFetch()}),[t]),(0,G.tZ)("div",{children:null!==i&&0===i.length?lng("no assignments associated with this content").caps():(0,G.tZ)(a.iA,{cols:le,collection:i,loading:null===i,RowRenderer:pe,rowIdCol:"assignment_id",compact:!0,noWindow:!0})})},le=[{title:lng("assignment name").caps()},{title:lng("assignment owner").caps()},{title:lng("creation date").caps()},{title:lng("last modified").caps()}];var ce={name:"1wbll7q",styles:"text-decoration:underline"},de={name:"1wbll7q",styles:"text-decoration:underline"};const pe=(0,s.observer)((e=>{let{row:t}=e;const{assignment_id:i,assignment_name:n,lesson_name:r,assignment_owner:s,creation_time:o,modification_time:a}=t,c=n||r;return(0,G.BX)("tr",{children:[(0,G.tZ)("td",{children:(0,k.Tz)(s)||Blsm.user.power_user_assignment_permissions?(0,G.tZ)("div",{css:ce,onClick:()=>{(0,l.p4)({edit:"assignment",id:i},!0),(0,m.wN)()},children:c}):c}),(0,G.tZ)("td",{children:(0,G.tZ)("div",{css:de,onClick:()=>{(0,l.p4)({user:s},!0),(0,m.wN)()},children:(0,k.v2)(t)})}),(0,G.tZ)("td",{children:(0,G.tZ)(u.qp,{showTime:!1,time:o})}),(0,G.tZ)("td",{children:(0,G.tZ)(u.qp,{showTime:!1,time:a})})]})})),ue=e=>{var t;let{content:i,actions:n,isList:r,mayLockComments:s,viewReports:o}=e;const{fetch:a,assignmentId:d,restoreContent:p,deleteContent:u,moveToFolder:b,folderTree:v,addToList:_,recommend:f}=n,{domain_id:y,lesson_id:w,lesson_type:x,name:Z,lesson_deleted:C,owner:S,lesson_public:B,share_in_group:T,show_download:N,show_assignments:I,my_content_in_group:D,blog_in_group:j,blog_in_profile:P,assignment_id:E,group_id:R,anonymous_fetch_allowed:F,assign_to_domain:M}=i,A=i.can_edit||(null===(t=i.lesson_owners)||void 0===t?void 0:t.includes(String(Blsm.user.id)))||Blsm.user.power_user_assignment_permissions,q=Blsm.isFeatureEnabled("catalog")&&(i.show_share||!i.reshare_disabled&&(Blsm.user.isManager||Blsm.isFeatureEnabled("share_to_user"))),X=Blsm.checkMod(["","ENT"]),L=3==B||Blsm.user.isManager&&2==B,$=A&&!T,V="Form"===x,U=-1!==["Test","Survey","Courseware","Evaluation"].indexOf(x),H=null==S?void 0:S.attributes.is_manager,J=!(D||j||P),W=Blsm.isFeatureEnabled("file_versions")&&J&&!U&&!V,K=q||T&&H,Y=X&&M&&Blsm.isFeatureEnabled("online_content"),Q=Blsm.InitialData.repo_download_terms&&Blsm.InitialData.repo_download_terms[y],ee=Blsm.InitialData.repo_download_block&&Blsm.InitialData.repo_download_block[y],te=!("master"===i.assignment_type)&&R&&s&&Blsm.isFeatureEnabled("assignments_comments"),ie=Blsm.hasPermission(Blsm.ManagerPermissions.CONTENT_SHARE)&&E&&F&&X,ne=e=>{(0,c.SC)("assignment/lock_assignment_comments",{data:{lock:e,assignment_id:i.assignment_id,group_id:R},method:"POST"},(()=>se()))},se=()=>{i.lock_assignment_comments=!i.lock_assignment_comments,i.lock_assignment_comments?(0,O.qV)(lng("comments are now disabled.")):(0,O.qV)(lng("comments are now enabled."))};return[C&&p&&{label:lng("restore content"),icon:"recycle",onClick:()=>p(w)},(A||L)&&{label:lng("edit content").caps(),icon:"edit",onClick:()=>(0,l.p4)({edit:"content",id:w,type:x},!0)},A&&$&&u&&{label:lng("delete content").caps(),icon:"trash",onClick:()=>{(0,m.BB)((0,G.BX)("div",{children:[lng("are you sure you want to delete this content?").caps(),(0,k.kE)(i.associated_assignments_count)&&(0,G.BX)("div",{children:[lng("number of assignments associated with this content").caps(),": ",i.associated_assignments_count]})]}),{title:lng("delete content").caps(),onConfirm:()=>(0,c.SC)("content/"+i.lesson_id,{method:"DELETE"},(()=>u(i)))})}},Blsm.isFeatureEnabled("channels")&&E&&{label:lng("add to playlist").caps(),icon:"list_music",onClick:()=>(0,g.vm)().openDialog("form",new z.L({item:E}))},A&&W&&X&&{label:lng("show versions").caps(),icon:"sign_ok",onClick:()=>(0,m.qR)((0,G.tZ)("div",{children:(0,G.tZ)(re,{lessonId:w})},w),{title:lng("other versions of this content").caps(),width:"40vw"})},A&&J&&X&&{label:lng("edit permissions").caps(),icon:"lock",onClick:()=>(0,g.vm)().openDialog("form",new h.H({lessonId:w,lessonName:Z,onSaveSuccess:()=>((0,g.vm)().closeDialog(),null==a?void 0:a())}))},A&&U&&r&&{label:lng("duplicate content").caps(),icon:"copy",onClick:()=>me(i,_)},X&&(A||parseInt(y)!==parseInt(Blsm.user.domain_id))&&-1!==["Text"].indexOf(x)&&r&&{label:lng("duplicate content").caps(),icon:"copy",onClick:()=>ge(i,_)},(null==v?void 0:v.length)>0&&!d&&b&&X&&{label:lng("move to folder").caps(),icon:"open",onClick:()=>b(i)},K&&!V&&{label:lng("share").caps(),icon:"share",onClick:()=>(0,l.p4)({edit:"share",id:i.lesson_id},!0)},K&&ie&&{label:lng("share to email").caps(),icon:"by_mail",onClick:()=>(0,l.p4)({edit:"share_by_mail",id:i.lesson_id},!0)},Y&&{label:lng("recommend").caps(),icon:"recommend",onClick:()=>f(w)},N&&(!ee||Q)&&{label:lng("download"),icon:"download",onClick:()=>{E?(0,l.p4)(Blsm.prm.Mainref+"Launcher?dl=1&assignment="+E,!0):parseInt(y)!==parseInt(Blsm.user.domain_id)&&Q?ee?(0,m.qR)(Q,{title:lng("repository download terms")}):(0,m.BB)(Q,{title:lng("repository download terms"),confirmText:lng("accept"),cancelText:lng("decline"),onConfirm:()=>(0,l.p4)({file:{lesson_id:w}})}):(0,l.p4)({file:{lesson_id:w}},!0)}},I&&Blsm.user.isManager&&!V&&X&&{label:lng("create assignment").caps(),icon:"menu_overview",onClick:()=>(0,l.p4)({edit:"assignment",params:{content:w}},!0)},I&&Blsm.user.isManager&&!V&&X&&{label:lng("show assignments").caps(),icon:"preview",onClick:()=>(0,m.qR)((0,G.tZ)(ae,{lessonId:w}),{title:lng("assignments associated with this content").caps(),width:"40vw"})},(A||o)&&E&&{label:lng("shared content completion|report").caps(),icon:"report",href:(0,l.p4)({report:"SharedContentCompletion",params:{assignment:E,group:R,subs:1}})},A&&E&&U&&{label:lng("question distribution report").caps(),icon:"report",href:(0,l.p4)({report:"ReportQuestionDistribution",params:{shared:1,assignment:E,group:R,subs:1}})},A&&E&&"Survey"===x&&{label:lng("survey report").caps(),icon:"report",href:(0,l.p4)({report:"SurveyReport",params:{shared:1,assignment:E,group:R,subs:1}})},!A&&E&&{label:lng("assignment log").caps(),icon:"report",href:(0,l.p4)({report:"ReportUserPerformances",params:{user:Blsm.user.id,assignment:E,group:R,subs:1}})},te&&(null!==i.lock_assignment_comments||!0===i.lock_comments?{label:lng("unlock comments").caps(),val:"lock_assignment_comments",attr:{lock:1},icon:"lock_open",onClick:()=>ne(0)}:{label:lng("lock comments").caps(),val:"lock_assignment_comments",attr:{lock:0},icon:"lock",onClick:()=>ne(1)})]},me=(e,t)=>{const i=new _({content:e,onSaveSuccess:n=>{if(n.id&&((0,O.qV)(lng("questionnaire duplicated")),t)){const r=[];for(const[t,i]of Object.entries(e))r[t]=i;r.lesson_id=n.id,r.lesson_name=i.values.get("questnrName"),r.name=i.values.get("questnrName"),r.lesson_type=i.values.get("questnrType"),r.lesson_description=i.values.get("questnrDesc"),t(r)}(0,g.vm)().closeDialog()}});(0,g.vm)().openDialog("form",i)},ge=(e,t)=>{(0,m.BB)(lng("are you sure you want to duplicate this content?").caps(),{confirmText:lng("yes").caps(),cancelText:lng("no").caps(),onConfirm:()=>{(0,c.SC)("content/duplicate/"+e.lesson_id,{method:"POST"},(i=>{if(i.content_id&&((0,O.qV)(lng("click here to edit"),lng("duplicated"),{onClick:()=>(0,l.p4)({edit:"content",id:i.content_id},!0)}),t)){const n=[];for(const[t,i]of Object.entries(e))n[t]=i;n.lesson_id=i.content_id,t(n)}}))}})},he=(0,B.iv)("border:1px dashed ",T.g.colors.text_main,";background-color:rgba(255, 255, 255, 0.5);border-radius:7px;padding:0 0.3em;margin:0 .5em;color:",T.g.colors.text_main,";cursor:default;.dropzone{position:fixed;",T.g.classes.near(T.g.consts.SIDE_BAR_WIDTH+10+"px")," top:",T.g.consts.TOP_BAR_HEIGHT+10,"px;width:calc(100vw - ",T.g.consts.SIDE_BAR_WIDTH+30,"px);height:calc(100vh - ",T.g.consts.TOP_BAR_HEIGHT+20,"px);}",""),be=e=>{let{onDrop:t,text:i,toolTip:n}=e;const{dndEvents:r}=(0,N.aZ)((e=>t(e)));return(0,N.iP)().width<=1024?null:(0,G.tZ)("div",{css:he,children:(0,G.BX)(D.u,{text:n,children:[(0,G.tZ)(p.JO,{icon:"upload"})," ",i||lng("drag & drop content files").caps(),(0,G.tZ)("div",{css:T.g.classes.dropzone,className:"dropzone",...r,children:lng("drop files here").caps()})]})})}},6901:(e,t,i)=>{i.d(t,{u:()=>S,K:()=>C});var n=i(4216),r=i(5560),s=i(7821),o=i(3051),a=i(5007),l=i(4210);function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d extends l.I{constructor(e){var t,i,n,r,s,o,a,l,d;super(e),c(this,"info",{}),c(this,"object",void 0),c(this,"fieldOptions",void 0),c(this,"dependencyOptions",void 0),c(this,"allFields",void 0),this.info=e.info||this.info,this.object=e.object,this.fieldOptions=e.fieldOptions,this.dependencyOptions=null===(t=e.dependencyOptions)||void 0===t?void 0:t.filter((t=>{var i;return t.val!=(null===(i=e.info)||void 0===i?void 0:i.field_id)})),this.allFields=e.allFields,this.title=this.info?lng("edit custom field").caps():lng("add new custom field").caps();const u=/lessons|groups|users/.test(this.object);this.info.autocomplete=null===(i=this.info)||void 0===i||null===(n=i.field_data)||void 0===n?void 0:n.autocomplete,this.info.dependency_field_id=null===(r=this.info)||void 0===r||null===(s=r.field_data)||void 0===s?void 0:s.dependency_field_id,this.info.values=null!==(o=this.info)&&void 0!==o&&null!==(a=o.field_data)&&void 0!==a&&a.values?Object.entries(null===(l=this.info)||void 0===l||null===(d=l.field_data)||void 0===d?void 0:d.values).map((e=>{let[t,i]=e;return t+(!0===i?"":"|"+i.join("|"))})).join(","):"",this._fields=[{type:"text",name:"field_name",label:lng("field name").caps(),maxLength:100,required:!0},{type:"select",name:"field_type",label:lng("field type"),options:this.fieldOptions},{type:"text",name:"values",label:lng("field values"),visible:()=>"SELECT"===this.values.get("field_type"),required:()=>"SELECT"===this.values.get("field_type")},{type:"select",name:"dependency_field_id",label:lng("depends on"),options:this.dependencyOptions},{type:"text",name:"field_key",label:lng("field key"),maxLength:50,validate:e=>p(e,this.allFields.filter((e=>e.field_id!=this.info.field_id)))},{type:"text",name:"field_column",label:lng("field id"),readOnly:!0},{type:"checkbox",name:"autocomplete",label:lng("autocomplete"),visible:()=>"VARCHAR"===this.values.get("field_type")},{type:"checkbox",name:"must_fill",label:lng("mandatory"),insert:u}],this._prepFields(this.info),this.ready=!0}save(e){var t,i;this.saveToUrl("domains/save_custom_fields",Object.assign({object:this.object,field_id:(null===(t=this.info)||void 0===t?void 0:t.field_id)||"",type_changed:e.field_type!==(null===(i=this.info)||void 0===i?void 0:i.field_type)?1:void 0},e))}}const p=(e,t)=>{if(!e.match(/^[a-zA-Z0-9_]*$/))return{error:lng("please use alphanumeric characters")};if(e.match(/^(group_|user_|field_)/)||["fullname","full_name","external_id","lms_name","link","since","ip_address","lock_duration","added_message","password","date","job_name","text","description","notes","amount","assignment_name","lesson_name","resource_name","target_name","classification_name","syllabus_text","template_name","parent_name","welcome_text","report_link","report_url"].includes(e))return{error:lng("%s cannot contain reserved words such as %s",lng("field key"),"group_,user_,field_,full_name,description,…")};if(!e.match(/^[A-Za-z]/))return{error:lng("must start with a letter")};if(t){const i=Object.fromEntries(t.filter((e=>e.field_key)).map((e=>[e.field_key,e])))[e];if(i)return{error:lng("this %s is already in use by %s",lng("field key"),`${i.field_name} (${i.field_column})`)}}return!0};var u,m,g=i(8567),h=(i(7882),i(9637)),b=i(917),v=i(676),_=i(6975),f=i(8e3),y=i(6920),w=i(5944);function x(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function k(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const Z="customfields",C=e=>Object.fromEntries([["users",lng("users")],e&&["groups",lng("groups/courses")],e&&["ous",lng("org' units")],e&&["lessons",lng("content")],e&&Blsm.isFeatureEnabled("qualifications")&&["qualifications",lng("qualifications")],e&&Blsm.isFeatureEnabled("workplan")&&["workplan",lng("workplan")],e&&Blsm.isFeatureEnabled("resources")&&["resources",lng("resources")],e&&Blsm.isFeatureEnabled("resources")&&["resourcebundle",lng("resource bundle")],e&&Blsm.isFeatureEnabled("group_tasks")&&["tasks",lng("tasks",{phrase:!0})],e&&Blsm.isFeatureEnabled("course_registartion_external")&&["external_course_type",lng("external event types")],e&&Blsm.isFeatureEnabled("meetings")&&["meetings",lng("meetings")]].filter((e=>e)));let S=(u=class e extends n.D{_updateFromUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this.object=this.hidden_filters.object=e,this.fetchUrl=`domains/list_custom_fields/&object=${this.object}`,this.delUrl=e=>{(0,f.SC)("domains/delete_custom_fields",{data:{ids:e,object:this.object},method:"DELETE"},this.onDelete)},super._updateFromUrl(e,t)}constructor(e){let{route:t,nav:i}=e;var n,l,c,p;super({route:t,nav:i,basePath:Z}),n=this,l="object",p=this,(c=m)&&Object.defineProperty(n,l,{enumerable:c.enumerable,configurable:c.configurable,writable:c.writable,value:c.initializer?c.initializer.call(p):void 0}),x(this,"dependencyOptions",[]),x(this,"fieldTypes",{INT:lng("number").caps(),VARCHAR:lng("text").caps(),TEXT:lng("rich text").caps(),DATE:lng("date").caps(),CHECKBOX:lng("checkbox").caps(),SELECT:lng("drop down list").caps()}),x(this,"onDelete",(e=>{(null==e?void 0:e.field_appearances)>0&&(0,g.qR)((0,w.tZ)(T,{...e,message:lng("cannot remove this field because it is in use")}),{title:lng("cannot remove custom field"),width:"600px"}),this.fetch()})),(0,s.makeObservable)(this),this.object=t[0],this._innerFilterSort=!0,this.title=lng("custom fields"),this.RowRenderer=O,this._actionsCol=!1,this.rowIdCol="field_id",this.fetchUrl="domains/list_custom_fields",this.delUrl=e=>{(0,f.SC)("domains/delete_custom_fields",{data:{ids:e,object:this.object},method:"DELETE"},this.onDelete)},this.linkNew=()=>(0,a.vm)().openDialog("form",new d({object:this.object,fieldOptions:this.fieldTypes,dependencyOptions:this.dependencyOptions,allFields:this.items,onSaveSuccess:()=>((0,a.vm)().closeDialog(),this.fetch())})),this.rowAction=e=>(0,a.vm)().openDialog("form",new d({object:this.object,fieldOptions:this.fieldTypes,dependencyOptions:this.dependencyOptions,allFields:this.items,info:e,onSaveSuccess:e=>{(null==e?void 0:e.field_appearances)>0?(0,g.qR)((0,w.tZ)(T,{...e,message:lng("cannot update this field because it is in use")}),{title:lng("cannot update custom field"),width:"600px",onCancel:()=>(0,a.vm)().closeDialog()}):(this.fetch(),(0,a.vm)().closeDialog())}})),this._cols=[{title:lng("field id"),sortVal:"field_column",input:"text"},{title:lng("key"),sortVal:"field_key",input:"text"},{title:lng("field name"),sortVal:"field_name",input:"text"},{title:lng("type"),sortVal:"field_type"},{title:lng("depends on")},{title:lng("uses in rules"),sortVal:"field_appearances"}];const u=(0,r.observer)((()=>{const e=[];for(const[i,n]of Object.entries(C(this.isEnterprise)))e.push({label:n,onClick:()=>t(i)});const t=e=>{this.object=e,this.fetchUrl=`domains/list_custom_fields/&object=${this.object}`,this.delUrl=e=>{(0,f.SC)("domains/delete_custom_fields",{data:{ids:e,object:this.object},method:"DELETE"},this.onDelete)},this.nav([Z,e],{replace:!0})};return(0,w.tZ)(o.x,{dropDownLike:!0,options:e,children:C(this.isEnterprise)[this.object].caps()})}));this.barExtra=(0,w.tZ)(u,{}),this.colsToFiltersAndSorts(),this.ready=!0,this.fetch()}_acceptDataFromServer(e){this.title=`${lng("custom fields").caps()} - ${C(this.isEnterprise)[this.object].caps()}`,this.dependencyOptions=[{val:"",label:lng("nothing").caps()}],e.items.map((e=>{["SELECT","CHECKBOX"].indexOf(e.field_type)>=0&&this.dependencyOptions.push({val:e.field_id,label:e.field_name})})),super._acceptDataFromServer(e)}static match(t,i){let{nav:n}=i;const[r,...s]=t;if(r===Z)return new e({route:s,nav:n,object:s[0].object})}},m=k(u.prototype,"object",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),k(u.prototype,"_updateFromUrl",[s.override],Object.getOwnPropertyDescriptor(u.prototype,"_updateFromUrl"),u.prototype),u);const O=(0,r.observer)((function(e){let{row:t,rowProps:i}=e;const{field_key:n,field_column:r,field_name:s,field_type:o,depends_on:a,field_data:l,field_appearances:c,object:d}=t,{rowAction:p,fieldTypes:u}=i;return(0,w.BX)("tr",{onClick:()=>null==p?void 0:p(t),children:[(0,w.tZ)("td",{children:r}),(0,w.tZ)("td",{children:n||""}),(0,w.tZ)(h.U6,{children:s}),(0,w.BX)("td",{children:[u[o]||lng("unknown").caps(),"SELECT"===o&&(null==l?void 0:l.values)&&(0,w.BX)("div",{children:["(",Object.keys(null==l?void 0:l.values).join(","),")"]})]}),(0,w.tZ)("td",{children:a}),(0,w.tZ)("td",{children:c>0?(0,w.tZ)("div",{css:y.g.classes.link,onClick:e=>{e.stopPropagation(),(0,f.SC)("domains/list_field_appearances",{data:{field_id:t.field_id,object:d}},(e=>{(0,g.qR)((0,w.tZ)(T,{...e}),{title:lng("custom field appearances"),width:"600px"})}))},children:c}):c}),(0,w.tZ)(h.Fo,{o:t})]})})),B=(0,b.iv)("._title{font-weight:600;&._dialog_title{color:",y.g.colors.text_black,";margin-bottom:10px;}&._type{margin-top:15px;}}",""),T=e=>{let{groups:t,external_course_types:i,questionnaire_pages:n,message:r}=e;return(0,w.BX)("div",{css:B,children:[r&&(0,w.tZ)("div",{className:"_title _dialog_title",children:r.caps()}),t.length>0&&(0,w.BX)(w.HY,{children:[(0,w.BX)("div",{className:"_title _type",children:[lng("workspaces").caps(),":"]}),(0,w.tZ)(N,{collection:t,href:{edit:"workspace"}})]}),i.length>0&&(0,w.BX)(w.HY,{children:[(0,w.BX)("div",{className:"_title _type",children:[lng("external events").caps(),":"]}),(0,w.tZ)(N,{collection:i,href:{edit:"external_course_type"}})]}),n.length>0&&(0,w.BX)(w.HY,{children:[(0,w.BX)("div",{className:"_title _type",children:[lng("questionnaires").caps(),":"]}),(0,w.tZ)(N,{collection:n,href:{edit:!0,type:"Questionnaire"}})]})]})},N=e=>{let{collection:t,href:i}=e;const n=[{title:"#"},{title:lng("name")},{title:lng("section")},{}];return(0,w.tZ)(v.iA,{cols:n,filters:[],collection:t,rowIdCol:"id",RowRenderer:I,rowProps:{href:i},compact:!0,noWindow:!0})},I=e=>{let{row:t,rowProps:i}=e;const{href:n}=i;return(0,w.BX)("tr",{children:[(0,w.BX)("td",{children:["#",t.id]}),(0,w.tZ)(h.U6,{children:t.name}),t.section_title&&(0,w.tZ)("td",{children:t.section_title}),(0,w.tZ)(h.jA,{children:(0,w.tZ)(_.JO,{icon:"link",smallButtonLike:!0,href:{...n,id:t.id,section:t.section}})})]})}},8071:(e,t,i)=>{i.d(t,{A:()=>x,u:()=>T});var n=i(4216),r=i(5560),s=i(7363),o=i(4210);function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class l extends o.I{constructor(e){super(e),a(this,"permissionTypeInfo",void 0),this.permissionTypeInfo=e.permissionType||this.permissionTypeInfo,this.saveUrl=this.permissionTypeInfo?"users/save_permission_types":"users/new_permission_type",this.title=this.permissionTypeInfo?lng("edit permission type")+": "+this.permissionTypeInfo.name:lng("new permission type"),this._fields=[{type:"text",name:"name",label:lng("permission type name"),required:!0,maxLength:191}],this._prepFields(this.permissionTypeInfo),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,Object.assign({},this.permissionTypeInfo||{},e))}}var c,d,p=i(5007),u=i(5474),m=i(8e3),g=i(9159),h=i(7821),b=i(8534),v=i(9637),_=i(6920),f=(i(7882),i(5944));function y(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const w="manager_permission_types";let x=(c=h.action.bound,d=class e extends n.D{static match(t,i){let{nav:n}=i;const[r,...s]=t;if(r===w)return new e({route:s,nav:n})}constructor(e){let{route:t,nav:i}=e;super({route:t,nav:i,basePath:w}),y(this,"defaultManagerSettingOptions",[{val:"",label:lng("none").caps()},{val:"all",label:lng("all").caps()}]),y(this,"defaultManagerSetting",void 0),(0,h.makeObservable)(this),this.title=lng("manager permission types"),this._actionsCol=!1,this.fetchUrl="users/list_permission_types",this.delUrl="users/delete_permission_types",this.rowIdCol="id",this.RowRenderer=N,this._cols=[{title:lng("name"),val:"name",input:"text"},{title:lng("create assignments")},{title:lng("set assignment weights")},{title:lng("create meetings")},{title:lng("edit meetings")},{title:lng("set meeting attendance")},{title:lng("share content")},Blsm.isFeatureEnabled("evaluation")&&this.isEnterprise&&{title:lng("view evaluations")},this.isEnterprise&&{title:lng("grades management")},this.isEnterprise&&{title:lng("create portal")},{title:lng("general"),tooltip:T()}],this.colsToFiltersAndSorts(),this.linkNew=()=>(0,p.vm)().openDialog("form",new l({onSaveSuccess:()=>((0,p.vm)().closeDialog(),this.fetch())})),this.linkNewTooltip=lng("add new permission type"),this.rowAction=e=>(0,p.vm)().openDialog("form",new l({permissionType:e,onSaveSuccess:()=>((0,p.vm)().closeDialog(),this.fetch())})),this.fetch()}_acceptDataFromServer(e){null==e||e.items.forEach((e=>{this.defaultManagerSettingOptions.push({val:e.id,label:e.name})})),(0,m.SC)("domains/get_domain_field/field=default_manager_setting/",{},(e=>{this.defaultManagerSetting=e,this._buildCols()})),super._acceptDataFromServer(e)}_buildCols(){this.barExtra=(0,f.tZ)((()=>{const[e,t]=(0,s.useState)(this.defaultManagerSetting);return(0,f.BX)(f.HY,{children:[(0,f.BX)("label",{style:{padding:"5px"},children:[lng("default manager setting").caps(),": "]}),(0,f.tZ)(u.P,{options:this.defaultManagerSettingOptions,value:e,onChange:e=>{t(e),(0,m.SC)("domains/save_domain_field/single_value=1",{data:{default_manager_setting:e},method:"POST"},(()=>(0,b.qV)(lng("setting saved successfully"))))}})]})}),{}),this.ready=!0}savePermission(e){let{permissionType:t,value:i,name:n}=e;t[n]=i.toString(),(0,m.SC)("users/save_manager_permission_type",{data:{id:t.id,value:i,name:n},method:"POST"})}},k=d.prototype,Z="savePermission",C=[c],S=Object.getOwnPropertyDescriptor(d.prototype,"savePermission"),O=d.prototype,B={},Object.keys(S).forEach((function(e){B[e]=S[e]})),B.enumerable=!!B.enumerable,B.configurable=!!B.configurable,("value"in B||B.initializer)&&(B.writable=!0),B=C.slice().reverse().reduce((function(e,t){return t(k,Z,e)||e}),B),O&&void 0!==B.initializer&&(B.value=B.initializer?B.initializer.call(O):void 0,B.initializer=void 0),void 0===B.initializer&&(Object.defineProperty(k,Z,B),B=null),d);var k,Z,C,S,O,B;const T=()=>{const e=[];return e.push(lng("settings")),Blsm.isFeatureEnabled("group_subset")&&e.push(lng("subsets")),Blsm.isFeatureEnabled("discussions")&&e.push(lng("discussions")),Blsm.isFeatureEnabled("assignments_comments")&&e.push(lng("comments")),Blsm.isFeatureEnabled("rescue_assignment")&&e.push(lng("rescue assignments")),e.push(lng("set assignment order")),e.push(lng("upload diploma")),lng("manage: %s",e.reduce(((e,t)=>e+"\n• "+t.caps()),"")).caps()},N=(0,r.observer)((function(e){let{row:t,rowProps:i}=e;const{rowAction:n,isEnterprise:r}=i,{name:s,perm_assignments:o,perm_meetings:a,perm_content:l,perm_evaluation:c,perm_config:d,perm_grades_management:p,perm_portal:u}=t,m=[{cbVal:"1",value:o,defaultVal:"2",name:"perm_assignments"},{cbVal:"2",value:"1"===o?"2":o,defaultVal:"",name:"perm_assignments"},{cbVal:"1",value:a,defaultVal:"2",name:"perm_meetings"},{cbVal:"2",value:"1"===a?"2":a,defaultVal:"3",name:"perm_meetings"},{cbVal:"3",value:a&&"3",defaultVal:"",name:"perm_meetings"},{value:l,name:"perm_content"},Blsm.isFeatureEnabled("evaluation")&&r&&{value:c,name:"perm_evaluation"},r&&{value:p,name:"perm_grades_management"},r&&{value:u,name:"perm_portal"},{value:d,name:"perm_config"}].filter((e=>e));return(0,f.BX)("tr",{children:[(0,f.tZ)(v.U6,{children:(0,f.tZ)("div",{onClick:()=>null==n?void 0:n(t),children:s})}),m.map(((e,i)=>{let{cbVal:n,value:r,defaultVal:s,name:o}=e;return(0,f.tZ)(I,{value:r,cbVal:n,name:o,defaultVal:s,permissionType:t},i)})),(0,f.tZ)(v.Fo,{o:t})]})})),I=e=>{let{value:t,cbVal:i,name:n,defaultVal:r="0",permissionType:o}=e;const[a,l]=(0,s.useState)(!1);return(0,f.tZ)("td",{children:a?(0,f.tZ)(g.My,{color:_.g.colors.green}):(0,f.tZ)(g.XZ,{checkboxValue:i,value:t,onChange:e=>(e=>{let{value:t,name:i}=e;l(!0),o[i]=t.toString(),(0,m.SC)("users/save_manager_permission_type",{data:{id:o.id,value:t,name:i},method:"POST"},(()=>l(!1)))})({value:e||r,name:n})})})}},643:(e,t,i)=>{i.d(t,{W:()=>y});var n=i(917),r=i(6920),s=i(5560),o=i(6975),a=i(4902),l=i(8318),c=i(9180),d=i(7363),p=i(9159),u=i(6691),m=i(2698),g=i(6344),h=i(5944);const b=e=>{let{is_read:t,active:i,translucent:s}=e;return(0,n.iv)("color:",r.g.colors.text_main,";background-color:",(0,g.pp)(i?r.g.colors.highlight:t?r.g.colors.bg_cont:r.g.colors.dominant_main_shade,s?.6:null),";min-height:100px;display:flex;border-radius:15px;padding:10px 12px;cursor:pointer;>._side{display:flex;flex-direction:column;align-items:center;",r.g.classes.margin_far("10px"),";._avatar{border:1px solid ",i?r.g.colors.dominant_white:"transparent",";}.thumbnail{font-size:34px;line-height:0;}._icons{display:flex;flex-grow:1;margin-top:15px;font-size:1.1em;}}>._main{flex-grow:1;>._meta{display:flex;align-items:center;>._user_name{flex-grow:1;color:",r.g.colors.text_sec,";}>._date{font-size:.9em;}}>._subject{font-weight:",t?"normal":700,";font-size:1.1em;margin:5px 0 10px;",r.g.classes.ellipsis_lines(3),";word-break:break-word;}>._body{",r.g.classes.ellipsis_lines(1),";word-break:break-word;color:",r.g.colors.text_sec,";}}._check{",(0,l.Fq)()?"":"visibility: hidden;",";}&:hover{background-color:",r.g.colors.dominant_main,";&,._meta ._user_name,._body{color:",r.g.colors.dominant_white,";}}&:hover,&.checked{._check{visibility:visible;}}","")};var v={name:"gwdjul",styles:"position:relative;width:42px;height:42px;font-size:30px;display:flex;flex-direction:column;align-items:center"},_={name:"53gs8q",styles:"position:relative;width:42px;height:42px"},f={name:"1ogvqp6",styles:"position:relative;width:42px;height:42px;font-size:42px"};const y=(0,s.observer)((function(e){var t,i;let{msg:s,active:g,is_read:y,onClick:w,showAvatar:x=!0,translucent:k=!1}=e;const Z=(0,d.useContext)(u.Zm),{attached_files:C,message:S,subject:O,time:B,participants:T,recipients:N,future:I}=s,D=T||N||{};let j=null,P="";if(null!=I&&I.sending_time)j=(0,h.tZ)(o.JO,{icon:"clock",className:"thumbnail",title:lng("future message"),color:r.g.colors.purple}),P=lng("future message").caps();else if(D.group)j=(0,h.tZ)("div",{css:v,children:(0,h.tZ)(o.JO,{icon:"group"})}),P=D.group;else if((null===(t=D.users)||void 0===t?void 0:t.length)>1){const e=D.users[0],t=D.users[1];j=(0,h.BX)("div",{css:_,children:[(0,h.tZ)(a.qE,{user:t,size:"32px",className:"_avatar",css:(0,n.iv)({position:"absolute",[r.g.near]:9,top:3},"","")}),(0,h.tZ)(a.qE,{user:e,size:"32px",className:"_avatar",css:(0,n.iv)({position:"absolute",[r.g.near]:0,top:0},"","")})]}),P=lng("%s and %s others|person",(0,l.v2)(e),D.users.length-1).caps()}else if(1===(null===(i=D.users)||void 0===i?void 0:i.length)){const e=D.users[0];j=(0,h.tZ)(a.qE,{user:e,size:"42px",className:"_avatar"}),P=(0,l.v2)(e)}else D.system?(j=(0,h.tZ)(o.JO,{icon:"menu_info",className:"thumbnail",color:r.g.colors.purple}),P=lng("system").caps()):j=(0,h.tZ)("div",{css:f,children:(0,h.tZ)(o.JO,{icon:"empty"})});return(0,h.BX)(m.LZ,{css:b({is_read:y,active:g,translucent:k}),onClick:w,className:(0,l.AK)({checked:null==Z?void 0:Z.checkedItems.includes(s.message_id)}),children:[x&&j&&(0,h.BX)("div",{className:"_side",children:[j,(0,h.tZ)("div",{className:"_icons",children:(null==C?void 0:C.length)>0&&(0,h.tZ)(o.JO,{icon:"attachment"})})]}),(0,h.BX)("div",{className:"_main",children:[(0,h.BX)("div",{className:"_meta",children:[(0,h.tZ)("div",{className:"_user_name",children:P}),(0,h.tZ)(c.qp,{time:(null==I?void 0:I.sending_time)||B,className:"_date"}),Z&&(0,h.tZ)(p.XZ,{className:"_check",onChange:e=>e?Z.checkedItems.push(s.message_id):Z.checkedItems=Z.checkedItems.filter((e=>e!=s.message_id)),value:Z.checkedItems.includes(s.message_id)})]}),(0,h.tZ)("div",{className:"_subject",children:O}),(0,h.tZ)("div",{className:"_body",children:(0,l.s9)(S)})]})]})}))},1019:(e,t,i)=>{i.d(t,{Z:()=>P,t:()=>B});var n=i(917),r=i(5560),s=i(7363),o=i(6920),a=i(4902),l=i(9180),c=i(5405),d=i(8318),p=i(539),u=i(6975),m=i(6691),g=i(7392),h=i(3346),b=i(4210),v=i(8e3),_=i(8567),f=i(8534),y=i(1619),w=i(7154),x=i(9852),k=i(441),Z=i(5944);function C(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const S=(0,n.iv)("padding:0 20px 10px;display:flex;flex-direction:column;color:",o.g.colors.text_main,";>._head{padding:20px 0;display:flex;border-bottom:1px solid ",o.g.colors.separator,";>._subject{flex-grow:1;font-weight:700;font-size:1.8em;}}.buttonbar{margin-top:1em;margin-bottom:40px;display:flex;justify-content:stretch;gap:10px;>div{display:flex;gap:10px;}>.totheright{flex-grow:1;flex-direction:row-reverse;}>.totheleft{flex-grow:2;}}table[cellpadding]{th,td{padding:5px;}}table th{text-align:start;}","");var O={name:"iqoq9n",styles:"margin-top:20px"};const B=(0,r.observer)((function(e){var t;let{msg:i}=e;const n=(0,s.useContext)(m.Zm),{ready:r,message_id:o,subject:a,replies:l,from:v,replyForm:y,filterNsort:w}=i;if(!r)return(0,Z.tZ)(p.$,{css:O});const x="preset"===n.activeBoxKey,k="deleted"===n.activeBoxKey,C={};v>0&&(C[v]=i.from_user),null===(t=i.recipients)||void 0===t||t.users.forEach((e=>C[e.user_id]=e)),l.forEach((e=>{var t;return null===(t=e.recipients)||void 0===t?void 0:t.users.forEach((e=>C[e.user_id]=e))})),l.forEach((e=>e.from>0&&(C[e.from]=e.from_user))),delete C[Blsm.user.id];const B=Blsm.isFeatureEnabled("isolate_users")&&!(Blsm.user.isPowerManager||Blsm.user.perm.isGroupViewer),N=Blsm.isFeatureEnabled("create_messages")&&!k&&(0,d.B5)(v)&&!(0,d.Tz)(v)&&!(B&&Blsm.isFeatureEnabled("isolate_users_disable_reply")),I=Blsm.isFeatureEnabled("create_messages")&&!k&&(0,d.Dw)(C)&&!(B&&Blsm.isFeatureEnabled("isolate_users_disable_reply")),D=Blsm.isFeatureEnabled("create_messages")&&!k&&(0,d.B5)(v)&&!x&&!B,P=!k;return(0,Z.BX)("div",{css:S,children:[(0,Z.BX)("div",{className:"_head",children:[(0,Z.tZ)("div",{className:"_subject",children:a}),(0,Z.tZ)("div",{children:(0,Z.tZ)(u.JO,{icon:"close",buttonLike:!0,onClick:()=>n.activeMsg=null})})]}),(0,Z.tZ)(c.SV,{children:(0,Z.tZ)(j,{reply:i,main:!0})},o),l.filter((e=>T(e,w.filter.users))).map((e=>(0,Z.tZ)(c.SV,{children:(0,Z.tZ)(j,{reply:e,msg:i})},e.message_id))),(0,Z.tZ)(b.q3.Provider,{value:y,children:y?(0,Z.BX)("div",{className:"replying_bar",children:[(0,Z.tZ)(h.au,{input:y.getFieldByName("message_to_user")}),(0,Z.tZ)(h.au,{input:y.getFieldById("message")}),(0,Z.BX)("div",{className:"buttonbar",children:[(0,Z.tZ)(g.l,{theme:"contained",onClick:()=>y.callSave(),disabled:!(!y.status&&y.getValue("message")&&y.getValue("message_to_user")),children:"saving"===y.status?lng("please wait...").caps():lng("send").caps()}),(0,Z.tZ)(g.l,{theme:"outlined",onClick:()=>i.hideReplyForm(),children:lng("cancel").caps()})]})]}):null}),!y&&(0,Z.BX)("div",{className:"buttonbar",children:[(0,Z.BX)("div",{className:"totheleft",children:[N&&(0,Z.BX)(g.l,{theme:"contained",onClick:()=>i.showReplyForm([v]),children:[(0,Z.tZ)(u.JO,{icon:"reply"})," ",lng("reply").caps()]}),I&&(0,Z.BX)(g.l,{theme:"contained",onClick:()=>i.showReplyForm(Object.keys(C)),children:[(0,Z.tZ)(u.JO,{icon:"reply_all"})," ",lng("reply all").caps()]}),D&&(0,Z.BX)(g.l,{theme:"contained",onClick:()=>i.showReplyForm([]),children:[(0,Z.tZ)(u.JO,{icon:"forward"})," ",lng("forward").caps()]}),x&&(0,Z.BX)(g.l,{theme:"contained",onClick:()=>n.draft(i.subject,i.message),children:[(0,Z.tZ)(u.JO,{icon:"forward"})," ",lng("send to").caps()]})]}),(0,Z.tZ)("div",{className:"totheright",children:P&&(0,Z.BX)(g.l,{theme:"outlined",onClick:()=>{(0,_.BB)(lng("are you sure you want to delete this message?"),{onConfirm:()=>{n.deleteActiveMsg((()=>(0,f.qV)(lng("message deleted"))))}})},children:[(0,Z.tZ)(u.JO,{icon:"trash"})," ",lng("delete").caps()]})})]})]})})),T=(e,t)=>{var i;return(0,d.xb)(t)||t.includes(e.from)||(null===(i=e.recipients.users)||void 0===i?void 0:i.some((e=>t.includes(e.user_id))))},N=(0,n.iv)("border-top:1px solid ",o.g.colors.separator,";border-width:1px 0;>div{padding:10px 20px;",o.g.mQuery.mobile,"{padding:10px 0;}}.report-table{th,tfoot td{padding:5px 10px;background-color:",o.g.colors.bg_2,";text-align:start;}>tbody>tr:hover>td{background-color:",o.g.colors.bg_1,";}td{padding:5px 10px;}}>._meta{display:flex;gap:10px;align-items:center;>._avatar{",o.g.classes.margin_far(".8em"),";}._user_name{font-weight:700;font-size:1.1rem;}._date,._to{font-size:.9em;color:",o.g.colors.text_sec,";}._actions{display:flex;flex-direction:row-reverse;}}&.main{padding-top:1.5em;}.buttonbar{margin-top:1em;margin-bottom:40px;display:flex;flex-direction:row;gap:10px;}._body{a{text-decoration:underline;}}._files{display:flex;flex-wrap:wrap;>*{margin:5px;}}",""),I=(0,n.iv)("padding:10px;.title{font-weight:600;font-size:1.1em;padding-bottom:5px;}.report-table{margin:auto;th,tfoot td{background-color:",o.g.colors.bg_2,";text-align:start;}>tbody>tr:hover>td{background-color:",o.g.colors.bg_1,";}td{padding:5px 10px;}}",""),D=e=>{let{msg:t}=e;const{message:i,message_data:n}=t;return"birthday"===((null==n?void 0:n.message_type)||null)?(0,Z.tZ)(x.BP,{image:n.img,greeting:i,asMessage:!0}):(0,Z.tZ)(y.xn,{className:"_body",content:i,nl2br:!1,fixTrailingSpaces:!1})},j=(0,r.observer)((function(e){let{reply:t,msg:i,main:n}=e;const{from:r,from_user:s,message:c,recipients:p,attached_files:m,meta:g,msgStore:h,sending_time:b}=t,v=Blsm.isFeatureEnabled("create_messages")&&i&&(0,d.B5)(r)&&!(0,d.Tz)(r);let{datestamp:_}=t;n&&"planned"===h.activeBoxKey&&b>moment().unix()&&(_=b);const f=[];var y,x;p&&(p.group&&f.push(p.group),(null===(y=p.users)||void 0===y?void 0:y.length)>0&&f.push(...p.users.map(d.v2)),(null===(x=p.groups)||void 0===x?void 0:x.length)>0&&f.push(...p.groups.map((e=>e.group_name))));const C=m.filter((e=>!c.includes(e.id)));return(0,Z.BX)("div",{css:N,className:(0,d.AK)({main:n}),children:[(0,Z.BX)("div",{className:"_meta",children:[(0,d.B5)(r)&&(0,Z.tZ)("div",{className:"_avatar",children:(0,Z.tZ)(a.qE,{user:s,size:n?"50px":"40px",balloon:!1})}),(0,Z.BX)("div",{className:"_from_to",children:[(0,Z.tZ)("div",{className:"_user_name",children:(0,d.B5)(r)?`${(0,d.v2)(s)}`:lng("system message").caps()}),f.length>0&&(0,Z.BX)("div",{className:"_to",children:[lng("to|person").caps(),": ",f.join(", ")]})]}),(0,Z.tZ)("div",{css:o.g.classes.flex_grow}),(0,Z.tZ)("div",{className:"_actions",children:v&&(0,Z.tZ)(u.JO,{icon:"reply",buttonLike:!0,onClick:()=>i.showReplyForm([r]),title:lng("reply").caps()})}),(0,Z.tZ)(l.qp,{time:_,className:"_date"}),g&&(0,Z.tZ)(w.y,{content:(0,Z.BX)("div",{css:I,children:[(0,Z.tZ)("div",{className:"title",children:lng("metadata").caps()}),(0,Z.tZ)("div",{dangerouslySetInnerHTML:{__html:g}})]}),children:(0,Z.tZ)(u.JO,{icon:"placeholder"})})]}),(0,Z.tZ)(D,{msg:t}),(0,Z.tZ)("div",{className:"_files",css:o.g.classes.wysiwyg,children:C.map((e=>(0,Z.tZ)("a",{className:"attached-file",href:(0,k.p4)({file:e}),rel:"noreferrer",target:"_blank",children:e.filename},e.file_id)))})]})}));class P extends b.I{constructor(e,t){super(),C(this,"msgStore",void 0),this.msg=e,this.msgStore=t,this._fields=[{type:"multiple_items",name:"message_to_user",label:lng("select user"),outer_label:lng("send to"),separateLines:!1,inline:!0,theme:"bright",visible:()=>Blsm.user.isPowerManager||Blsm.user.perm.isGroupViewer||!Blsm.isFeatureEnabled("isolate_users"),searchData:(e,t)=>{(0,v.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||""}},t)}},{type:"richtext",name:"message",label:lng("message"),id:"message",toolbarOptions:{font:!0,color:!0,link:!0,attach:!0,media_link:!0,list:!0,align:!0},onValueChange:(e,t)=>this.values.set("message_commands",t.commands)}]}SaveSuccess(e){this.status="",(0,d.B5)(e.message_id)&&this.msgStore.invalidateActiveMsg()}save(e){this.status="saving";const t=this.msg.message_id||this.msgStore._activeMsgId;this.saveToUrl("messages/reply",Object.assign({},e,{message_id:t}))}}},541:(e,t,i)=>{i.d(t,{U:()=>Z,x:()=>k});var n=i(917),r=i(6920),s=i(5560),o=i(7363),a=i(6975),l=i(6691),c=i(539),d=i(643),p=i(5151),u=i(5405),m=i(6421),g=i(7392),h=i(5758),b=i(5007),v=i(3051),_=i(8567),f=i(8534),y=i(9159),w=i(5944);const x=(0,n.iv)("display:flex;flex-direction:column;>._top{padding-bottom:9px;margin-bottom:9px;border-bottom:1px solid ",r.g.colors.separator,";>._options{margin-bottom:18px;display:flex;align-items:center;font-weight:600;}._actions{padding-inline-start:5px;margin-bottom:10px;.search_input{background-color:",r.g.darkMode?r.g.colors.bg_input:"#F6F6F6",";padding:0 10px;display:flex;align-items:center;border-radius:8px;height:41px;margin:5px 0;>.Icon-search{margin:0 5px;transition:font-size .1s;}>input{flex-grow:1;background-color:transparent;height:100%;border:0;color:",r.g.colors.text_main,";width:250px;&::placeholder{color:",r.g.colors.text_placeholder,";}}}._note{margin-bottom:10px;}._multiactions{min-height:47px;display:flex;flex-direction:row;align-items:center;justify-content:space-evenly;gap:10px;>*{display:inline-block;flex-grow:1;height:fit-content;}}._new_button{display:block;padding:12px 0;border-radius:10px;}}}",""),k=(0,n.iv)("._list{flex-grow:1;overflow-y:auto;>.separator{margin:6px 15px 5px;border-top:1px solid ",r.g.colors.separator,";}}",""),Z=(0,s.observer)((function(){const e=(0,o.useContext)(b.l9),t=(0,o.useContext)(l.Zm),{activeBoxKey:i,activeBox:n,listBoxes:s,activeMsgId:Z,checkedItems:C}=t,{curPage:S,pageSize:O,totalItems:B,searchTerm:T}=n;function N(r){const s=n.messages.filter((e=>C.includes(e.message_id)&&!e.is_read)).length;let o;switch(r){case"select_all":return void(t.checkedItems.length===n.messages.length?t.checkedItems=[]:t.checkedItems=n.messages.map((e=>e.message_id)));case"delete":return void(0,_.BB)(lng("are you sure you want to delete the selected items?"),{onConfirm:()=>{o=()=>{["sys","in"].includes(i)&&(n.unreadCount-=s,e.notificationsStore.inbox_unread_count-=s),n.removeMessagesById(C),(0,f.qV)(lng("%s messages deleted",C.length))},t.multiAction({action:r,onSuccess:o})}});case"archive":o=()=>{["sys","in"].includes(i)&&(n.unreadCount-=s,e.notificationsStore.inbox_unread_count-=s),"archive"===r&&t.boxes.archive.appendMessages(n.messages.filter((e=>C.includes(e.message_id)))),n.removeMessagesById(C)};break;case"unarchive":case"undelete":o=()=>{t.boxes.in.unreadCount+=s,e.notificationsStore.inbox_unread_count+=s,t.boxes.in.appendMessages(n.messages.filter((e=>C.includes(e.message_id)))),n.removeMessagesById(C),n.unreadCount-=s};break;case"read":case"unread":o=()=>{n.setIsRead(C,"read"===r)}}t.multiAction({action:r,onSuccess:o})}const I=Blsm.isFeatureEnabled("create_messages")&&"sys"!==i&&"deleted"!==i&&0===C.length&&(Blsm.user.perm.isGroupViewer||!Blsm.isFeatureEnabled("isolate_users"));return(0,w.BX)(h.h,{css:[x,k,"",""],children:[(0,w.BX)("div",{className:"_top",children:[(0,w.tZ)("div",{className:"_options",children:(0,w.BX)("div",{css:r.g.classes.flex_grow,children:[(0,w.tZ)(m.I,{type:"select",options:s,value:i,onChange:e=>t.activeBox=e,wrapped:!0}),(0,w.tZ)(y.XZ,{value:n.toggleUserMsgs,label:lng("show only user messages").caps(),onChange:e=>n.toggleUserMsgs=e})]})}),(0,w.BX)("div",{className:"_actions",children:[(0,w.BX)("div",{className:"search_input",children:[(0,w.tZ)(a.JO,{icon:"search"}),(0,w.tZ)("input",{type:"text",placeholder:lng("search messages").caps(),value:T,onChange:e=>n.searchTerm=e.target.value,onKeyUp:e=>{"Escape"===e.key&&(n.searchTerm=""),"Enter"===e.key&&n.getMessages()}})]}),I&&(0,w.BX)(g.l,{theme:"contained",bold:!0,className:"_new_button",onClick:()=>t.activeMsg="new",disabled:"new"===Z,children:[(0,w.tZ)(a.JO,{icon:"create"})," ",lng("write message").caps()]}),C.length>0&&(0,w.BX)("div",{className:"_multiactions",children:["deleted"!==i&&(0,w.BX)(g.l,{theme:"outlined",onClick:()=>N("delete"),children:[(0,w.tZ)(a.JO,{icon:"trash"})," ",lng("delete").caps()]}),["in","sys"].includes(i)&&(0,w.tZ)(v.x,{className:"width100",options:[{label:lng("read|noun"),val:"read"},{label:lng("unread|noun"),val:"unread"},"in"===i&&{label:lng("archived"),val:"archive"}],onSelect:e=>N(e),children:(0,w.tZ)(g.l,{theme:"contained",children:lng("mark as...").caps()})}),"archive"===i&&(0,w.tZ)(g.l,{theme:"contained",onClick:()=>N("unarchive"),children:lng("unarchive").caps()}),"deleted"===i&&(0,w.tZ)(g.l,{theme:"contained",onClick:()=>N("undelete"),children:lng("restore").caps()}),(0,w.tZ)("div",{style:{flexGrow:0},children:(0,w.tZ)(a.JO,{buttonLike:!0,icon:"checkbox_checked",title:lng("select all"),onClick:()=>N("select_all")})})]})]}),(0,w.tZ)(p.t,{pageSize:O,totalItems:B,curPage:S,onChange:e=>n.curPage=e,compact:!0,spread:!0})]}),n.loading?(0,w.tZ)(c.$,{}):(0,w.tZ)("div",{className:"_list",children:n.messages?n.messages.map(((e,i)=>(0,w.BX)(o.Fragment,{children:[i>0&&(0,w.tZ)("div",{className:"separator"}),(0,w.tZ)(u.SV,{children:(0,w.tZ)(d.W,{msg:e,active:e.message_id===Z,is_read:e.is_read,onClick:()=>{t.activeMsg=e.message_id,e.is_read=!0}})})]},e.message_id))):(0,w.tZ)(c.$,{})})]})}))},1711:(e,t,i)=>{i.d(t,{i:()=>d});var n,r,s,o=i(7821);function a(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const d=new(r=c((n=class{constructor(){var e;a(this,"_mode",r,this),a(this,"_fSize",s,this),l(this,"modes",{saturate:[lng("saturated colors"),"saturate(400%);"],sepia:[lng("sepia colors"),"sepia(30%)"],invert:[lng("inverted colors"),"invert(150%)"],grayscale:[lng("color blind mode"),"grayscale(100%)"],dark:[lng("dark mode"),void 0]}),(0,o.makeObservable)(this),null!==(e=document.documentElement)&&void 0!==e&&e.style&&(document.documentElement.style.fontSize=Math.round(14*this._fSize)+"px")}get fontSize(){return this._fSize}set fontSize(e){var t;Blsm.cookies.set("fSize",e,{expires:365,path:Blsm.prm.relative_path}),null!==(t=document.documentElement)&&void 0!==t&&t.style&&(document.documentElement.style.fontSize=Math.round(14*e)+"px"),this._fSize=e}get mode(){return this._mode||""}get modeFilter(){var e;return this.mode&&(null===(e=this.modes[this.mode])||void 0===e?void 0:e[1])}set mode(e){e===this.mode&&(e=""),e?Blsm.cookies.set("aMode",e,{expires:365,path:Blsm.prm.relative_path}):Blsm.cookies.remove("aMode",{path:Blsm.prm.relative_path}),"dark"===e||"dark"===this._mode?location.reload():this._mode=e}}).prototype,"_mode",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Blsm.prm.printing_mode?void 0:Blsm.cookies.get("aMode")}}),s=c(n.prototype,"_fSize",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Blsm.cookies.get("fSize")||"1"}}),n)},6344:(e,t,i)=>{i.d(t,{BB:()=>l,HO:()=>m,gj:()=>p,mR:()=>o,ou:()=>a,pp:()=>g,wq:()=>u});const n=/^#([A-Fa-f0-9]{3}){1,2}$/,r=/rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)/,s=/rgba?(\(\s*\d+\s*,\s*\d+\s*,\s*\d+)(?:\s*,.+?)?\)/,o=(e,t)=>{if(!n.test(e))return r.test(e)?e.replace("rgb","rgba").replace(")",`, ${t||1})`):s.test(e)?t||0===t?e.replace(s,`rgba$1, ${t})`):e:(console.error("hexToRgbA: "+e+" is a bad hex."),"rgab(0, 0, 0, 1)");let i;return t||0===t||(t=1),i=e.substring(1).split(""),3===i.length&&(i=[i[0],i[0],i[1],i[1],i[2],i[2]]),i="0x"+i.join(""),`rgba(${[i>>16&255,i>>8&255,255&i].join(",")}, ${t})`},a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#000";const i=c(e,!1);if(!i)return t;const n=(299*i[0]+587*i[1]+114*i[2])/1e3;return n>=128?"#000":"#fff"},l=e=>/^(#[\da-f]{3,4}|#[\da-f]{6}||#[\da-f]{8}|rgb\s*\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)|rgba\s*\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*(1|1.0|0|0?\.\d+)\s*\))$/i.test(e),c=function(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,1];return e?"transparent"===(e=e.toLowerCase())?[0,0,0,0]:"white"===e?[255,255,255,1]:"black"===e?[0,0,0,1]:"#"===e[0]?(e.length<7&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+(e.length>4?e[4]+e[4]:"")),[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16),e.length>7?parseInt(e.substr(7,2),16)/255:1]):0===e.indexOf("rgb")&&(null===(t=e.match(/[.\d]+/g))||void 0===t?void 0:t.length)>=3?(3===(null===(n=e.match(/[.\d]+/g))||void 0===n?void 0:n.length)&&(e+=",1"),e.match(/[.\d]+/g).map((e=>+e))):i:i;var n},d=[["#ffb300",lng("orange")],["#aabd04",lng("olive")],["#2bba30",lng("green")],["#2fca86",lng("sea green")],["#00b8a5",lng("light sea green")],["#00bcd4",lng("turquoise")],["#e87e0d",lng("dark orange")],["#f44336",lng("red")],["#e91e63",lng("deep pink")],["#9c27b0",lng("violet")],["#3f51b5",lng("royal blue")],["#2196f3",lng("sky blue")]],p=e=>d[(e-1)%d.length][0],u=e=>d.map(((t,i)=>({val:e?i+1:"[&quot;"+t[0]+"&quot;,&quot;#ffffff&quot;]",label:t[1],bgColor:t[0],color:"#ffffff"}))),m=(e,t)=>{const i=c(e),[n,r,s,o]=i,a=t<0,l=a?0:255*t,d=a?1+t:1-t;return`rgba(${Math.round(n*d+l)},${Math.round(r*d+l)},${Math.round(s*d+l)},${o})`},g=(e,t)=>{if(("string"==typeof t||"number"==typeof t)&&t>=0&&t<=1){const[i,n,r]=c(e);return`rgba(${i},${n},${r},${t})`}return e}},6920:(e,t,i)=>{i.d(t,{g:()=>v});var n=i(917),r=i(8318),s=i(1711),o=i(6344);const a={text_main:"#171625",text_sec:"#717171",bg_main:"#FFFFFF",bg_page_containers:"#F5F4F5",bg_cont:"#FFFFFF",bg_input:"#FFFFFF",background_dark:"#F1F1F5",bg_1:"#E5E5E5",bg_2:"#F0F0F0",bg_2_text:"#4E4E4E",disabled_background:"#C0C0C0",separator:"#E5E5E5",separator_light:"#F1F1F5",text_black:"#171625",text_light_disabled:"#C9C9CE",link_blue:"#347EF7",link_blue_hover:"#3b5998",dominant_main:"#347EF7",dominant_main_shade:"#f0f5ff",mention_bg:"#c3ef90",dominant_orange:"#ff9800",dominant_white:"#FFF",half_black:"rgba(17,17,51,0.55)",half_white:"rgba(255,255,255,0.6)",half_gray:"rgba(192,192,192,0.6)",disabled_text:"#AAA",disabled_input:"#eaeaea",disabled_input_cb:"#888",text_placeholder:"#909090",border:"#D8D8D8",border_dark:"#EAEAF0",blue:"#347EF7",blue_shade:"#f0f5ff",white_shade:"#EBEBEB",light_blue:"#1194F6",light_blue2:"#B3D0FF",dark_blue:"#0D1B60",yellow:"#FFC441",grey:"#7F7F86",purple:"#714AB2",green:"#3CD598",negative:"#E64D40",negative_bg:"#B34B41",warning:"#E69E40",positive:"#3aa74a",positive_bg:"#297434",blossom:"#20AE61",highlight:"#F7DFAB",bright_green:"#85BF07",pink:"#E91E63",set:["#F44336","#E91E63","#9C27B0","#673AB7","#3D51B5","#2196F3","#03A9FA","#00BCD4","#009688","#5AB963","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722"],chart:{success:"#3aa74a",failure:"#E64D40",waiting:"#FFC441",progress:"#1194F6",neutral:"#F1F1F1",inactive:"#7F7F86",bg:"#D2D4D8"},task:{authorized:"#F7B617",late:"#F9412D",incomplete:"#AAAAAA",expired:"#ab0000",completed:"#3BBC31",in_progress:"#488CF2"},reports:{green:"#3aa74a",red:"#E64D40",blue:"#1194F6",yellow:"#FFC441"}};a.entity={discussion:"#FF9900",blog:"#89C53F",assignment:a.green,share:a.light_blue,meeting:a.purple,event:a.text_black,coach:a.yellow,course:a.light_blue,group:a.light_blue,course_template:a.dark_blue,workspace:a.light_blue,qualification:a.purple};const l="dark"===s.i.mode;l&&(a.text_main="white",a.text_sec="#D9D9D9",a.bg_main="#2D333B",a.bg_page_containers="#2D333B",a.bg_cont="#303544",a.bg_input="#3E455A",a.background_dark="#6676A5",a.dominant_main_shade="#243F54",a.bg_1="#405389",a.bg_2="#304172",a.bg_2_text="#D9D9D9",a.disabled_background="#656A6A",a.separator="#787878",a.highlight="#533980",a.link_blue_hover="#8db8ff",a.entity.event="#D9D9D9");const c={max:e=>`@media (max-width: ${e}px)`,mobile:"@media (max-width: 1023px)",mobileNarrow:"@media (max-width: 574px)",notMobile:"@media (min-width: 1024px)",ie:"@media all and (-ms-high-contrast: none), (-ms-high-contrast: active)"};let d=document.documentElement.classList.contains("RTL");d&&document.getElementById("bchat_full")&&(d=!1,document.querySelector("html").classList.remove("RTL"));let p=d?"rtl":"ltr",u=d?"right":"left",m=d?"left":"right";const g={TABLE_HEAD_HEIGHT:70,SIDE_BAR_WIDTH:70,TOP_BAR_HEIGHT:70,CONTAINER_MIN_WIDTH:350,PAGE_CONTENT_MAX_WIDTH:1380,CARD_WIDTH:315,CARD_HEIGHT:345,CARDS_SPACING:26,CONT_BORDER_RADIUS:20,WIDGET_BASE_WIDTH:280,WIDGET_BASE_HEIGHT:350,WIDGET_BORDER_RADIUS:10,WIDGET_SMALL_WIDTH:345,WIDGET_PADDING_SIDE:16,WIDGET_PADDING_TOP:20,LIST_MARGIN:12,LIST_MARGIN_CONDENSED:12,ITEM_IMG_SIZE:37,BUTTON_BORDER_RADIUS:10,FIELD_BORDER_RADIUS:7,SKINNY_BORDER_RADIUS:4,IMG_BORDER_RADIUS:4,CONT_MARGIN:40,PAGE_SIZE:100,ICON_MARGIN:"0.6em",MIN_FORM_HEIGHT_MOBILE:600,imgdata_half_white:`linear-gradient(${a.half_white}, ${a.half_white})`,imgdata_half_black:`linear-gradient(${a.half_black}, ${a.half_black})`,DEFAULT_STICKY_START_HEIGHT:42};g.WIDGET_DOUBLE_WIDTH=2*g.WIDGET_BASE_WIDTH+g.WIDGET_PADDING_SIDE;const h=(0,n.iv)("color:",a.link_blue,";text-decoration:underline;cursor:pointer;&a:hover{cursor:pointer;color:",a.link_blue_hover,';text-decoration:none;}&a[href^="#"]{font-weight:600;}&.attached-file,&.attached-error{background-color:',a.bg_1,";padding:3px 5px;border:1px solid ",a.separator,';border-radius:5px;text-decoration:none;display:inline-block;}&.attached-file:before{font-family:"Font Awesome 5 Pro";content:"\f0c6  ";}',""),b={direction:(0,n.iv)("direction:",p,";",""),float:(0,n.iv)("float:",d?"right":"left",";",""),opposite_float:(0,n.iv)("float:",d?"left":"right",";",""),opposite_text_align:(0,n.iv)("text-align:",d?"left":"right",";",""),side:d?"right":"left",opposite_side:d?"left":"right",circled_text:{name:"1t9h3hr",styles:"display:inline-block;min-width:1em;min-height:1em;line-height:1em;padding:0.2em 0.4em;text-align:center;border-radius:50%"},ellipsis:{name:"sqm42b",styles:"text-overflow:ellipsis;white-space:nowrap;overflow:hidden"},near:e=>(0,n.iv)(u,":",e,";",""),far:e=>(0,n.iv)(m,":",e,";",""),margin_near:e=>(0,n.iv)("margin-",u,":",e,";",""),margin_far:e=>(0,n.iv)("margin-",m,":",e,";",""),padding_near:e=>(0,n.iv)("padding-",u,":",e,";",""),padding_far:e=>(0,n.iv)("padding-",m,":",e,";",""),shadow_none:{name:"1t90u8d",styles:"box-shadow:none"},shadow_light:(0,n.iv)("box-shadow:0 0 3px rgba(",l?"255, 255, 255, .7":"0, 0, 0, .1",");",""),shadow_strong:(0,n.iv)("box-shadow:0 2px 4px rgba(",l?"255, 255, 255, .3":"0, 0, 0, .1",");",""),border_near:e=>(0,n.iv)("border-",u,":",e,";",""),border_far:e=>(0,n.iv)("border-",m,":",e,";",""),font_reset:{name:"1ec65v1",styles:"font-weight:normal;font-size:1rem"},flex_grow:{name:"1ff36h2",styles:"flex-grow:1"},full_width:{name:"wqxcwz",styles:"margin-left:auto;margin-right:auto;width:calc(100% - 40px)"},flex_space_evenly:{name:"1jq9lex",styles:"justify-content:space-between;&:before,&:after{content:'';}"},ellipsis_lines:e=>(0,n.iv)("display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:",e,";overflow:hidden;word-break:break-word;",""),editor_directions:{name:"ohez9p",styles:".dir-ltr{direction:ltr;}.dir-rtl{direction:rtl;}"},widget_title:(0,n.iv)("color:",a.text_main,";font-weight:bold;font-size:1.4rem;",""),flex_center:{name:"1vcob1d",styles:"display:flex;justify-content:center;align-items:center"},drop_button:(0,n.iv)("border-style:dashed;border-color:",a.border,";color:",a.text_sec,";cursor:pointer;",""),link:h,content_type_style:(0,n.iv)("color:",a.dominant_white,";font-weight:600;background-color:",a.yellow,";padding:1px 7px;border-radius:3px;",""),ws_type_style:(0,n.iv)("color:",a.dominant_white,";font-weight:600;background-color:#FA337C;padding:1px 7px;border-radius:3px;&._required_course{background-color:",a.dominant_orange,";}",""),dropzone:(0,n.iv)("display:none;border:3px dashed ",a.border,";body.body_drag &{color:",a.text_main,";background:rgba(255, 255, 255, .7);justify-content:center;z-index:1;display:flex;align-items:center;font-size:40px;}",""),iframeVideoSize:{name:"2m2gv7",styles:"position:relative;height:0;width:100%;padding-top:56.25%;>iframe,>.MediaPlayer{position:absolute!important;top:0;left:0;width:100%;height:100%;}"},descriptionShowMore:(0,n.iv)("margin-top:2px;font-size:.9em;height:4em;overflow:hidden;position:relative;color:",a.text_sec,';flex-grow:1;&:after{content:"";position:absolute;background-image:linear-gradient(to bottom, transparent, ',a.bg_cont,");height:2em;bottom:0;left:0;right:0;}",""),editorInputWrap:(0,n.iv)("border:1px solid ",a.separator,";padding:4px 15px;border-radius:25px;",""),mention:(0,n.iv)("color:",a.text_black,";background-color:",a.mention_bg,";padding:0 2px;border-radius:4px;","")};b.wysiwyg=(0,n.iv)("div,p{margin:0;min-height:1em;}a,span.attached-error{",h,';}[contenteditable="true"] a{cursor:text;}ul,ol{padding:0 1.3em;}li[dir=rtl]{text-align:right;}li[dir=ltr]{text-align:left;}img{max-width:100%;height:auto;&.emojione{height:1.5em;vertical-align:text-bottom;}}iframe{border:0;}.video_cont{',b.iframeVideoSize,";}.mention{",b.mention,";}",""),b.content_width=(0,n.iv)("max-width:",g.PAGE_CONTENT_MAX_WIDTH,"px;min-width:",g.CONTAINER_MIN_WIDTH,"px;",b.full_width,";",""),b.alert_count=(0,n.iv)("display:inline-block;background-color:#E64D40;color:white;font-weight:bold;",b.circled_text,";",""),b.page_position=(0,n.iv)("margin-top:",g.TOP_BAR_HEIGHT,"px;",b.margin_near(g.SIDE_BAR_WIDTH+"px"),";",c.mobile,"{",b.margin_near(0),";}",""),b.list=(0,n.iv)(">*+*{margin-top:",g.LIST_MARGIN,"px;}",""),b.list_condensed=(0,n.iv)(">*+*{margin-top:",g.LIST_MARGIN_CONDENSED,"px;}","");const v={colors:a,classes:b,styles:{progressBG:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return void 0!==e?{backgroundImage:`linear-gradient(90deg, silver, silver ${e}%, white ${e}%, white)`}:t}},mQuery:c,z:{report_headers:4,widget_bar:50,side_toggler:60,management_menu:1e3,top_bar:1001,side_bar:1002,dialog_overlay:1500,table_header:1999,context_menu:2e3,file_viewer:2500,notice:3e3,inactivity_alert:3500,congratulation:4e3},consts:g,near:u,far:m,isRTL:d,func:{color:e=>a[e]||e,id2color:e=>(0,r.B5)(e)?a.set[(e-1)%a.set.length]:a.grey,imgUrl:function(e,t){if(!e)return"";const[i,n]=e.split(":");if(!n)return e;let r="";switch(i){case"http":case"https":return e;case"img":r="GetFile?type=img&dom="+(t||Blsm.user.domain_id)+"&name="+n;break;case"media":r="GetFile?type=media&dom="+(t||Blsm.user.domain_id)+"&id="+n;break;case"file":r="GetFile?file_id="+n;break;case"gal":r="images/gallery/"+n;break;case"bday":r="images/birthday/"+n;break;case"editor":r="images/editor/"+n;break;default:return!1}return Blsm.prm.Mainref+r}},theme:(()=>{var e;const{files:t={},theme_home:i="",color_palette:n={},path:r}=(null===(e=Blsm.prm)||void 0===e?void 0:e.theme)||{},{Mainref:s,ViewRef:c}=Blsm.prm||{},d=n.color_1||a.blossom,p=location.pathname.startsWith("/support")?["#20ae61","#ffc441","#ff9800","#b34b41"]:[d,(0,o.HO)(d,.2),(0,o.HO)(d,.4),(0,o.HO)(d,.6)],u={logo_small:t.f_v4_logo_small?`${r}${t.f_v4_logo_small}`:s+"images/v4/blossom_logo_small.png",logo_full:t.f_v4_logo_full?`${r}${t.f_v4_logo_full}`:s+"images/v4/blossom_logo_dark.png",login_bg:t.f_login_bg_back?`${r}${t.f_login_bg_back}`:s+c+"images/login_bg_purple.jpg",login_logo:t.f_v4_logo_full?`${r}${t.f_v4_logo_full}`:s+"images/logo/logo_horz.svg",homePage:i&&!i.includes("://")?"http://"+i:i,mm_bg:n.mm_bg||a.bg_main,mm_fg:n.mm_fg||a.text_sec,mm_fg_active:n.mm_fg_active||a.blossom,color_1:n.color_1||a.purple,ln_bg:n.ln_bg||a.blossom,ln_fg:n.ln_fg||"#fff",spinnerSet:p};return!l&&n.color_2&&(a.dominant_main=n.color_2,a.dominant_main_shade=(0,o.HO)(a.dominant_main,.95)),u})(),darkMode:l}},7316:(e,t,i)=>{i.d(t,{h:()=>c});var n=i(7363),r=i(6920),s=i(917),o=i(5944);const a=e=>{const t=["balloons","confetti_1","confetti_2"];switch(e){case"balloons":return{url:r.g.func.imgUrl("bday:bday_greeting_balloons.gif"),timeout:3e3};case"confetti_1":case"confetti_2":return{url:r.g.func.imgUrl(`bday:bday_greeting_${e}.gif`),timeout:2500};default:return{url:r.g.func.imgUrl(`bday:bday_greeting_${t[Math.floor(3*Math.random())]}.gif`),timeout:3e3}}},l=(e,t)=>(0,s.iv)("background-image:url(data:image/gif;base64;gif-id=",t,e,");position:fixed;left:0;right:0;top:0;bottom:15px;z-index:",r.g.z.congratulation,";pointer-events:none;background-repeat:repeat-x;background-size:contain;",r.g.mQuery.mobileNarrow,"{position:absolute;left:-115px;right:-115px;background-size:cover;}",""),c=e=>{let{animation:t=!1}=e;const[i,r]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=Array.isArray(t)?a(t[Math.floor(Math.random()*t.length)]):a(t);fetch(e.url).then((e=>e.blob())).then((async t=>{const i=new FileReader;i.onload=t=>{r(t.currentTarget.result.replace("data:image/gif;base64","")),setTimeout((()=>r(!1)),e.timeout)},i.readAsDataURL(t)}))}),[]);const s=(new Date).getTime();return i&&(0,o.tZ)("div",{css:l(i,s)})}},81:(e,t,i)=>{i.d(t,{IV:()=>b,OR:()=>c,Qu:()=>y,Ry:()=>g,Xf:()=>l,aZ:()=>_,iP:()=>a,qD:()=>p,t$:()=>d,tm:()=>f});var n=i(7363),r=i(7821);const s="object"==typeof window,o=()=>({width:s?window.innerWidth:void 0,height:s?window.innerHeight:void 0}),a=()=>{const[e,t]=(0,n.useState)(o);return(0,n.useEffect)((()=>{if(!s)return!1;const e=()=>t(o());return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e},l=(e,t,i)=>{const r=(0,n.useRef)(null);(0,n.useEffect)((()=>()=>clearTimeout(r.current)),[]);return{events:{onMouseEnter:(0,n.useCallback)((()=>{clearTimeout(r.current),r.current=setTimeout(t,e)}),[t,e]),onMouseLeave:(0,n.useCallback)((()=>{clearTimeout(r.current),i()}),[i])},cancelEvent:()=>clearTimeout(r.current)}},c=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;const r=(0,n.useRef)();(0,n.useEffect)((()=>{r.current=t}),[t]),(0,n.useEffect)((()=>{const t=e=>r.current(e);return i.addEventListener(e,t),()=>i.removeEventListener(e,t)}),[e,i])},d=(e,t)=>{(0,n.useEffect)((()=>{if(!t)return;const i=i=>{var n;return e.current&&!e.current.contains(i.target)&&!e.current.contains(null===(n=i.target.closest(".BodyPortal"))||void 0===n?void 0:n.__parentEl)&&t(i)};return document.addEventListener("mousedown",i),document.addEventListener("touchstart",i),()=>{document.removeEventListener("mousedown",i),document.removeEventListener("touchstart",i)}}),[e,t])},p=e=>{const[t,i]=(0,n.useState)({}),[r,s]=(0,n.useState)({by:""}),o=t=>{const{by:i,desc:n}=e?e.sort:r,o=t===i?{by:i,desc:!n}:{by:t,desc:!1};e?e.sort=o:s(o)};return e?{filtersVals:e.filter,setFilterVals:t=>e.filter=t,sort:e.sort,setSort:o}:{filtersVals:t,setFilterVals:e=>i(e),sort:r,setSort:o}},u=(0,r.observable)([]);(0,r.observe)(u,(()=>{document.body.style.overflow=u.length?"hidden":""}));let m=0;const g=()=>{(0,n.useEffect)((()=>{const e=++m;return u.push(e),()=>{u.remove(e)}}),[])},h=()=>{var e;return(null===(e=history.state)||void 0===e?void 0:e.cobStack)||""},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(0,n.useRef)(!1),s=(0,n.useRef)(t+Math.random().toString()).current;(0,n.useEffect)((()=>{if(!i.disable)return history.pushState({cobStack:h()+","+s},""),()=>{h().includes(s)&&!i.noHistoryBack&&(r.current=!0,history.back())}}),[]),c("popstate",(()=>{i.disable||!e||h().includes(s)||e(r.current?void 0:()=>history.pushState({cobStack:h()+","+s},"")),r.current=!1}))},v=document.body;window.addEventListener("dragover",(e=>(e.preventDefault(),v.classList.add("body_drag"),e.dataTransfer.dropEffect="none"))),window.addEventListener("dragleave",(e=>(e.preventDefault(),!e.clientX&&!e.clientY&&v.classList.remove("body_drag")))),window.addEventListener("drop",(e=>(e.preventDefault(),v.classList.remove("body_drag"))));const _=e=>({dndEvents:{onDragOver:e=>(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move"),onDrop:t=>(t.preventDefault(),e(t.dataTransfer.files))}}),f=()=>{const e=(0,n.useRef)(!0);return(0,n.useEffect)((()=>()=>{e.current=!1}),[]),e},y=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;const[r,s]=(0,n.useState)(e),o=(0,n.useRef)(0);(0,n.useEffect)((()=>{s(e)}),[e]),(0,n.useEffect)((()=>{if(e!==r)return o.current=setTimeout((()=>{t(r)}),i),()=>clearTimeout(o.current)}),[r]);const a=()=>{e!==r&&(clearTimeout(o.current),t(r))};return{value:r,change:e=>s(e),update:a}}},9714:(e,t,i)=>{i.d(t,{R:()=>D,G:()=>I});var n=i(5697),r=i.n(n),s=i(8207),o=i(4238),a=i(7363),l=i(5560),c=i(5007),d=i(8567),p=i(3205),u=i(6920),m=i(8318),g=i(6975),h=i(441),b=i(917),v=i(6421),_=i(5944);const f=(0,b.iv)("height:",(0,m.tq)()?"calc(100vh - 130px)":"75vh",";>div{display:flex;}.topics{flex-basis:180px;",u.g.classes.margin_far((0,m.tq)()?"20px":"80px"),";margin-top:",(0,m.tq)()?10:30,"px;.type-search{margin-bottom:10px;}>div:not(.type-search){cursor:pointer;padding:5px 12px;margin:3px;>span{display:",(0,m.tq)()?"inline":"inline-block",";padding:0 6px;}&:hover{background-color:",u.g.colors.light_blue2,";border-radius:10px;color:#FFF;}&.selected{background-color:",u.g.colors.light_blue,";border-radius:10px;color:#FFF;}}}.types{flex-basis:75%;flex-grow:1;height:",(0,m.tq)()?"calc(100vh - 150px)":"calc(75vh - 20px)",";overflow:auto;>div{display:flex;flex-wrap:wrap;}.type-box{border:1px solid ",u.g.colors.separator,";border-radius:10px;padding:10px 7px;margin:6px;width:",(0,m.tq)()?"100%":"230px",";min-height:50px;cursor:pointer;&:hover{",u.g.classes.shadow_strong,";}.type-topic{color:#FFF;padding:5px 12px;border-radius:7px;font-size:.9em;display:inline-block;}.type-type{font-size:1.1em;font-weight:600;color:",u.g.colors.text_main,";margin:8px 0;}.type-text{font-size:.9em;color:",u.g.colors.text_sec,";}}}",""),y=e=>{let{types:t,topics:i,onSelect:n}=e;const[r,s]=(0,a.useState)(""),[o,l]=(0,a.useState)(""),d=[...new Set(t.map((e=>e.topic)))],p=t.filter((e=>e.topic.includes(r)&&e.typeLabel.includes(o)));return(0,_.tZ)("div",{css:f,children:(0,_.BX)("div",{children:[(0,_.BX)("div",{className:"topics",children:[(0,_.tZ)("div",{className:"type-search",children:(0,_.tZ)(v.I,{type:"search",placeholder:lng("search type"),wrapped:!0,onChange:e=>l(e),value:o})}),(0,_.BX)("div",{className:(0,m.AK)({selected:""===r}),onClick:()=>s(""),children:[(0,_.tZ)(g.gT,{color:""===r?u.g.colors.light_blue2:u.g.colors.grey}),(0,_.tZ)("span",{style:{fontWeight:"600"},children:lng("all categories").caps()})]}),d.map((e=>(0,_.BX)("div",{className:(0,m.AK)({selected:r===e}),onClick:()=>s(e),children:[(0,_.tZ)(g.gT,{color:r===e?u.g.colors.light_blue2:i[e].color}),(0,_.tZ)("span",{children:i[e].label.caps()})]},e)))]}),(0,_.tZ)("div",{className:"types",children:(0,_.tZ)("div",{children:p.map((e=>(0,_.BX)("div",{className:"type-box",onClick:()=>((0,c.vm)().closeDialog(),void(e.action?(0,m.Wl)(e.action)?e.action():(0,h.p4)(e.action,!0):n&&n(e.type))),children:[(0,_.tZ)("div",{className:"type-topic",style:{backgroundColor:i[e.topic].color},children:i[e.topic].label.caps()}),(0,_.tZ)("div",{className:"type-type",children:e.typeLabel.caps()}),e.text&&(0,_.BX)("div",{className:"type-text",children:[e.text.caps(),"."]})]},e.type)))})})]})})};var w=i(81),x=i(9793),k=i(1619),Z=i(2334),C=(i(20),i(539)),S=i(7392),O=i(6852),B=i(8534);const T={name:"zzqt9d",styles:".actions{margin-bottom:20px;}.blsm-notice{box-shadow:unset;}"},N=(0,l.observer)((e=>{let{store:t}=e;if(!t.ready)return(0,_.tZ)(C.$,{});if(!t.results.changes)return(0,_.tZ)("div",{style:{textAlign:"center",fontSize:"1.2em"},children:lng("no issues found").caps()});if(t.fixed)return(0,_.tZ)("div",{css:T,children:(0,_.tZ)(B.qX,{msg:lng("expiration dates were changed successfully").caps(),type:"success"})});const i={before:{name:lng("before").caps(),values:[{label:lng("completed").caps(),color:"success",data:t.results.completed_before},{label:lng("renewing").caps(),color:"progress",data:t.results.renewing_before},{label:lng("expired").caps(),color:"failure",data:t.results.expire_before}]},after:{name:lng("after").caps(),values:[{label:lng("completed").caps(),color:"success",data:t.results.completed_after},{label:lng("renewing").caps(),color:"progress",data:t.results.renewing_after},{label:lng("expired").caps(),color:"failure",data:t.results.expire_after}]}};return(0,_.BX)("div",{css:T,children:[(0,_.BX)("div",{className:"actions",children:[(0,_.tZ)(S.l,{theme:"contained",onClick:()=>t.fix_expiration_dates(),children:lng("fix expiration dates").caps()}),(0,_.BX)("div",{children:[lng("users with expiration dates that will be changed").caps(),": ",t.results.changes]}),(0,_.tZ)(B.qX,{type:"warning",msg:lng('users that were "expired" before the change, and their new expiration date has not yet arrived will revert to "renewing" status and not all the way back to "completed".').caps()})]}),(0,_.tZ)("div",{children:(0,_.tZ)(O.k,{type:"stackedbar",data:i,height:"300px",dataLabel:!0,legend:!0})})]})})),I=(0,a.createContext)(null),D=(0,l.observer)((function(){var e,t;const[i,n]=(0,a.useState)(""),r=(0,a.useContext)(c.l9),l=r.mainDialog,{dialog:u,data:b,options:v}=l;let f=null,w=null;const C=e=>{var t;null!==(t=w)&&void 0!==t&&t.dirty?((0,m.g4)(e),l.closeConfirm=!0):r.closeDialog()},S=null!=v&&v.hideX?null:null!=v&&v.onClose?()=>v.onClose(C):C;let O,B,T,D,P,z;switch(u){case"comments":w=b,f=(0,_.tZ)(o.H,{commentsStore:w,connectTo:w.connectTo,setTitle:e=>n(e)});break;case"form":w=b,f=(0,_.BX)(I.Provider,{value:!0,children:[(0,_.tZ)(p.l,{options:v,form:b,onClose:S,title:b.title,inDialog:!0,fitContent:null==v?void 0:v.fitContent,hideX:null==v?void 0:v.hideX})," "]});break;case"TypeSelector":f=(0,_.tZ)(y,{...b}),O=(0,m.tq)()?"100%":"70vw",B=b.title;break;case"Component":f=b.child,B=b.title,D=b.padded,O=b.width,T=b.headExtra||null,P=null===(e=b.options)||void 0===e?void 0:e.fullHeight,z=null===(t=b.options)||void 0===t?void 0:t.tailButtons;break;case"Launcher":f=(0,_.BX)("div",{children:[b._attr.lesson_author&&(0,_.BX)("div",{style:{fontWeight:"600",marginBottom:"6px"},children:[lng("by").caps(),": ",b._attr.lesson_author,(0,_.tZ)("br",{})]}),b._attr.modification_time&&(0,_.BX)("div",{style:{fontWeight:"500",marginBottom:"6px",textDecoration:"underline"},children:[lng("last modified").caps(),": ",(0,Z.GG)(b._attr.modification_time,{date:!0,time:!0}),(0,_.tZ)("br",{})]}),(0,_.tZ)(k.xn,{content:b.attr("lesson_text_data")})]}),B=b.title,O="800px",T=(0,_.tZ)(x.b,{children:(0,_.tZ)(g.JO,{icon:"popout",toolTip:lng("open in a new tab").caps(),onClick:()=>{window.open((0,h.p4)(b.link)),r.closeDialog()}})});break;case"QualificationRepeatIssues":f=(0,_.tZ)(N,{...b}),B=lng("qualification repeat issues")}if(f){var E;const e=(0,_.BX)(_.HY,{children:["form"===u?f:(0,_.tZ)(s.T,{title:B||i,padded:D,onClose:S,width:O,headExtra:T,fullHeight:P,tailButtons:z,hideX:null==v?void 0:v.hideX,children:f}),l.closeConfirm&&(0,_.tZ)(d.I4,{onConfirm:r.closeDialog,onCancel:()=>{var e;l.closeConfirm=!1,null===(e=b.backFromDirty)||void 0===e||e.call(b)},title:lng("discard changes"),confirmText:lng("close without saving"),children:lng("there are unsaved changes, are you sure you want to close the dialog?").caps()})]});return null!==(E=l.options)&&void 0!==E&&E.noState||(0,m.w1)()?e:(0,_.tZ)(j,{beforeClose:S,children:e})}return null})),j=e=>{let{beforeClose:t,children:i}=e;return(0,w.IV)(t,"DialogOpener"),(0,_.tZ)(_.HY,{children:i})};j.propTypes={beforeClose:r().func,children:r().node}},409:(e,t,i)=>{i.d(t,{X:()=>s,p:()=>r});var n=i(8318);const r=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];switch(null==e?void 0:e.toLowerCase()){case"group":return 1==t?i?lng("courses"):lng("course"):i?lng("groups"):lng("group");case"course":return n?r?lng("optional course"):lng("required course"):i?lng("courses"):lng("course");case"role":return i?lng("roles"):lng("role");case"ou":return i?lng("org units"):lng("org' unit");case"course_template":return i?lng("course templates"):lng("course template");case"course_external":return i?lng("external events"):lng("external event");case"qualification":return i?lng("qualifications",{phrase:!0}):lng("qualification",{phrase:!0});case"subset":return i?lng("subsets"):lng("subset");case"job":return i?lng("jobs"):lng("job");case"recruitment":return i?lng("recruitments"):lng("recruitment");case"workplan":return i?lng("workplans"):lng("workplan");case"campus":return i?lng("campuses"):lng("campus");case"patientcase":return i?lng("patient cases"):lng("patient case");case"resourcebundle":return i?lng("resource bundles"):lng("resource bundle");case"subprofession":return i?lng("sub professions"):lng("sub profession")}return""},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(0,n.xb)(t)&&e.startsWith("field_"))return t[e.replace("field_","")];switch(e){case"user_avatar":return lng("avatar");case"full_name":return lng("name");case"user_name":return lng("login name",{phrase:!0});case"user_first_name":return lng("first name");case"user_last_name":return lng("last name");case"user_birthdate":return lng("birthdate");case"user_email":return lng("email");case"org_unit_name":case"user_ou":return lng("org' unit");case"user_identity_num":return lng("identity number",{phrase:!0});case"employee_id":return lng("employee id",{phrase:!0});case"user_company":return lng("company");case"user_department":return lng("department");case"user_job_title":return lng("job title");case"user_business_phone":return lng("business phone");case"user_home_phone":return lng("home phone");case"user_mobile_phone":return lng("mobile phone");case"user_fax_number":return lng("fax");case"user_address":return lng("address");case"user_city":return lng("city");case"user_state":return lng("state");case"user_postal_code":return lng("postal code");case"user_country":return lng("country");case"user_gender":return lng("gender");case"employment_date":return lng("employment date");case"user_nt":return lng("user NT");case"status_id":case"status_name":return lng("status");case"classification_id":return lng("classification");case"user_joined":return lng("creation date");case"user_lastvisit":return lng("last visit");case"user_type":return lng("type");case"user_enabled":return lng("user enabled");case"user_locked":return lng("block sign in");case"user_expiration":return lng("expiration date");case"user_pretend":return lng("pretend");case"external_id":return lng("external id");case"user_ip":return lng("IP address");case"user_extra_time":return lng("extra time");case"user_language":return lng("language");case"user_date_format":return lng("date format");case"user_timezone":return lng("time zone");case"user_password":return lng("current password");case"user_newpassword":return lng("new password");case"user_newpassword2":return lng("confirm password");case"user_temp_password":return lng("set as temporary password");case"notification_settings[discussion]":return lng("notify about discussions");case"notification_settings[message]":return lng("notify about private message");case"notification_settings[comment]":return lng("notify about comments");case"notification_settings[push]":return lng("enable push notifications");case"user_no_notifications":return lng("notify by email");case"mail_notification_span":return lng("send email every");case"cv_file":case"cv_file_html":return lng("CV file");case"domain_name":return lng("domain");case"user_about":return lng("about")}return e}},2808:(e,t,i)=>{i.d(t,{BX:()=>n,DW:()=>o,Or:()=>s,r5:()=>r});const n=e=>e.indexOf(".")>=0?e.slice(e.lastIndexOf(".")+1).toLowerCase():"",r=(e,t)=>{let i=t&&Object.entries(Blsm.prm.mimetypes).find((e=>new RegExp(e[1]).test(t)));if(i)return i[0];let r=n(e);return i=r&&Object.entries(Blsm.prm.extensions).find((e=>e[1].indexOf(r)>=0)),i?i[0]:void 0},s=e=>"img"===r(e),o=(e,t)=>{if(!e)return"icon-vendor_file";t&&(e=n(e)),e=e.toLowerCase();const i={image:Blsm.prm.extensions.img,audio:Blsm.prm.extensions.aud,text:/txt$/,ppt:Blsm.prm.extensions.slides,video:Blsm.prm.extensions.vid.concat(["newrow_rec"]),activity:/task$|activity/,doc:/(docx?|rtf)$/,excel:/xlsx?$/,html:/html?$/,file:/(manual|file)$/,tincan:/tincan$/,scorm:/scorm/,general:/(certification|lesson)$/,assignment:0,blog:0,dictionary:0,courseware:0,evaluation:0,external:0,faq:0,final:0,form:0,glossary:0,master:0,meeting:0,pdf:0,survey:0,swf:0,test:0,checklist:0,wiki:0};for(let t in i){const n=i[t];if(t===e||n&&(Array.isArray(n)?n.includes(e):n.test(e)))return"vendor_"+t}return console.warn("unknown extension for icon: "+e),"vendor_file"}},8973:(e,t,i)=>{i.d(t,{Y:()=>d});var n=i(917),r=i(5560),s=i(6920),o=(i(7882),i(81)),a=i(1711),l=i(1042),c=i(5944);const d=(0,r.observer)((function(e){let{bgColor:t}=e;const{modeFilter:i}=a.i;return(0,o.OR)("mousedown",(e=>{0!==e.screenX&&0!==e.clientX&&document.body.classList.add("using-mouse")})),(0,o.OR)("keydown",(e=>{"Tab"===e.key&&document.body.classList.remove("using-mouse")})),(0,c.BX)(c.HY,{children:[(0,c.tZ)(n.xB,{styles:p({bgColor:t,modeFilter:i})}),(0,c.tZ)(n.xB,{styles:l.EN})]})})),p=e=>{let{bgColor:t=s.g.colors.bg_main,modeFilter:i}=e;return(0,n.iv)("html{font-size:14px;background-color:",t,";",i?`filter: ${i};`:"",";}*:not(.no_outline):focus{outline:",s.g.colors.dominant_main," auto 2px;}body{font-size:1em;font-family:'Open Sans Hebrew','Open Sans',sans-serif;overflow-x:hidden;overflow-y:auto;box-sizing:content-box;width:100vw;",s.g.classes.direction,";color:",s.g.colors.text_main,';background-size:cover;background-attachment:fixed;background-position:center top;background-repeat:no-repeat;&.using-mouse *:focus{outline-width:0;}}a{color:inherit;text-decoration:none;.tutorial{text-decoration:none!important;color:#FFEB3B!important;padding:3px;text-shadow:0 1px 1px black;}}[type="text"],textarea{background-color:',s.g.colors.bg_input,";}textarea{resize:none;}select{color:#5D676D;}.danger_text{color:",s.g.colors.negative,";}*,*:before,*:after{box-sizing:border-box;}",s.g.mQuery.notMobile,"{.mobile_only{display:none!important;}::-webkit-scrollbar{width:6px;height:6px;}::-webkit-scrollbar-thumb{border-radius:3px;background-color:#c1c1c1;}::-webkit-scrollbar-thumb:hover{background-color:#828282;}}",s.g.mQuery.mobile,"{.mobile_off{display:none!important;}body.bchat-on{padding-bottom:50px;}}","")}},8018:(e,t,i)=>{i.d(t,{F:()=>p,k:()=>u});var n=i(917),r=i(5560),s=i(539),o=i(5007),a=i(6920),l=i(5944);const c=(0,n.iv)("position:fixed;z-index:",a.g.z.dialog_overlay,";top:0;left:0;width:100vw;height:100vh;background-color:rgba(0, 0, 0, .7);",""),d=(0,n.iv)("display:flex;align-items:center;justify-content:center;",c,";",""),p=()=>(0,l.tZ)("div",{css:d,children:(0,l.tZ)(s.$,{color:"#FFF"})}),u=(0,r.observer)((function(){return(0,o.vm)().showGlobalLoader?(0,l.tZ)(p,{}):null}))},9523:(e,t,i)=>{i.d(t,{Rh:()=>a,j4:()=>o,rt:()=>s});var n=i(8e3),r=i(6920);const s=e=>{Blsm.cookies.set("language",e,{path:Blsm.prm.relative_path,expires:30}),(0,n.SC)("ajax/requests.php",{data:{req:"ChangeLanguage",lng:e}},(()=>location.reload(!0)))},o=()=>r.g.isRTL?"‎":"",a=()=>r.g.isRTL?"‏":""},8989:(e,t,i)=>{i.d(t,{X:()=>n});const n={set:function(e,t){try{if(void 0===t)return window.localStorage.removeItem(e);window.localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("Storage error: "+e.message,"store cleared!"),window.localStorage.clear()}},remove:function(e){return n.set(e)},get:function(e){const t=window.localStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}},push:function(e,t,i,n){let r=this.get(e)||[];if(r.push(t),n&&t.key){const e=new Map(r.map((e=>[e.key,e])));r=[...e.values()]}i&&r.length>i&&(r=r.slice(r.length-i)),this.set(e,r)},getKeys:function(){const e=[];for(let t=0;t<window.localStorage.length;t++)e.push(window.localStorage.key(t));return e}}},7882:(e,t,i)=>{var n=i(7821),r=i(8318);const s=(e,t,i)=>{console.error("propType validation failed","expected",e,"actual",t,i);const{propValue:n,location:r,propFullName:s,key:o,componentName:a}=i;return new Error(`Invalid prop \`${r&&s?s:o}\` passed to \`${a}\`. expected: ${e}. actual: ${JSON.stringify(n[o])}`)},o={id:(e,t,i,n,r)=>{if(e[t]&&e[t]!=parseInt(e[t])||null!==e[t]&&void 0!==e[t]&&parseInt(e[t])<=0)return new Error(`Invalid prop \`${n&&r?r:t}\` passed to \`${i}\`. Expected an id. Got ${JSON.stringify(e[t])}`)},numericValue:(e,t,i,n,r)=>{if(e[t]&&e[t]!=parseFloat(e[t]))return s("numeric string",e[t],{key:t,componentName:i,location:n,propFullName:r,propValue:e})},cssSize:(e,t,i,n,r)=>{if(e[t]&&!/^(\d+|\d*\.\d+)(px|%|vw|vh|rem|em)$/.test(e[t])&&!/^(calc|min|max|minmax)\(.+\)/.test(e[t]))return s("css size string",e[t],{key:t,componentName:i,location:n,propFullName:r,propValue:e})},cssColor:(e,t,i,n,r)=>{if(e[t]&&!/^#[\da-f]{3,4}|#([\da-f]{6,8})|(rgb|hsl)a?\(([.\d]+%?[,\s]*){3,4}\)$/i.test(e[t]))return s("css color string",e[t],{key:t,componentName:i,location:n,propFullName:r,propValue:e})},values:e=>(t,i,n,r,o)=>{if(t[i]&&!e.includes(t[i]))return s(e.join(", "),t[i],{key:i,componentName:n,location:r,propFullName:o,propValue:t})},arrayLike:(e,t,i,n,o)=>{if(e[t]&&!(0,r.zG)(e[t]))return s("collection",e[t],{key:t,componentName:i,location:n,propFullName:o,propValue:e})},objectLike:(e,t,i,n,s)=>{if(e[t]&&!(0,r.yD)(e[t]))return new Error(`Invalid prop \`${n&&s?s:t}\` passed to \`${i}\`. Expected: object. Got ${JSON.stringify(e[t])}`)},date:(e,t,i,n,r)=>{if(e[t]&&!moment.isMoment(e[t]))return s("moment object",e[t],{key:t,componentName:i,location:n,propFullName:r,propValue:e})},observableObject:(e,t,i,r,o)=>{if(e[t]&&!(0,n.isObservableObject)(e[t]))return s("observable object",e[t],{key:t,componentName:i,location:r,propFullName:o,propValue:e})},valLabelPairs:(e,t,i,n,r)=>{const o=e[t];if(void 0===o)return;if(!Array.isArray(o))return s("array (valLabelPairs)",e[t],{key:t,componentName:i,location:n,propFullName:r,propValue:e});let a={};for(const e in o){const c=o[e];if(c){const{options:o,optgroup:d}=c;if(!o&&d)return s(`optgroup ${d} has no options at ${e}`,c,{row:c,i:e,key:t,componentName:i,location:n,propFullName:r});if(o&&!d&&!c.val)return s(`options without optgroup at ${e}`,c,{row:c,i:e,key:t,componentName:i,location:n,propFullName:r});if(!c.onClick&&!c.val&&!d){if(void 0===(l=c).val||void 0===l.label||"string"!=typeof l.label)return s(`not object of shape {val,label} at ${e}`,c,{row:c,i:e,key:t,componentName:i,location:n,propFullName:r});if(a[c.val])return s(`duplicated val at ${e}`,c.val,{row:c,i:e,key:t,componentName:i,location:n,propFullName:r});a[c.val]=1}}}var l}};for(const e in o)o[e].isRequired=function(t,i,n,r,s){return null===t[i]||void 0===t[i]?new Error(`The prop \`${r&&s?s:i}\` is marked as required in \`${n}\`, but its value is \`${JSON.stringify(t[i])}\``):o[e].apply(this,arguments)}},8318:(e,t,i)=>{i.d(t,{s2:()=>k,yV:()=>C,dV:()=>Z,wd:()=>M,KX:()=>oe,pR:()=>Te,Ju:()=>Q,bQ:()=>he,g4:()=>E,AK:()=>v,Gs:()=>Xe,Ux:()=>Ce,pH:()=>je,Tj:()=>de,DK:()=>ke,ey:()=>S,Lv:()=>D,Ds:()=>le,nu:()=>P,Ic:()=>Ve,OM:()=>ye,FO:()=>Ae,s$:()=>W,F5:()=>Y,v7:()=>H,Du:()=>x,v2:()=>u,Rh:()=>$e,YR:()=>R,zO:()=>F,s9:()=>V,Wh:()=>I,lo:()=>Fe,zG:()=>m,X0:()=>xe,xb:()=>ee,Wl:()=>z,B5:()=>y,w1:()=>Ze,Nw:()=>g,tq:()=>pe,Fq:()=>ae,Oz:()=>ue,kE:()=>ve,Kn:()=>G,yD:()=>h,P$:()=>se,Tz:()=>ne,DM:()=>ce,HD:()=>_e,oH:()=>te,VD:()=>Me,wq:()=>Se,Y3:()=>Ee,rj:()=>ie,Dw:()=>U,c7:()=>J,SZ:()=>_,xh:()=>$,Um:()=>Oe,Mo:()=>Ie,en:()=>Ne,aQ:()=>O,e9:()=>be,ei:()=>q,VP:()=>X,jg:()=>L,vC:()=>we,Rn:()=>fe,p:()=>Pe,w6:()=>B,NM:()=>w,R4:()=>me,PG:()=>Re,f_:()=>re,Pz:()=>Le,Sy:()=>He,cW:()=>qe,mi:()=>A,x1:()=>De,qL:()=>ge,rO:()=>Ue,jj:()=>f,cT:()=>Be,$t:()=>j,mE:()=>K,sR:()=>ze});var n=i(7363),r=i(2334),s=i(7821);const o={true:!0,false:!1,null:null},a=Object.create(null);function l(e,t){const i=Object.create(a);return e.replace(/\+/g," ").split("&").forEach((function(e){const n=e.split("=");let r=decodeURIComponent(n[0]),s=r.split("]["),l=s.length-1;if(/\[/.test(s[0])&&/\]$/.test(s[l])?(s[l]=s[l].replace(/\]$/,""),s=s.shift().split("[").concat(s),l=s.length-1):l=0,n.length>=2){let e=decodeURIComponent(n.slice(1).join("="));if(t&&(e=e&&!isNaN(e)?+e:"undefined"===e?void 0:void 0!==o[e]?o[e]:e),l){let t=i;for(let i=0;i<=l;i++)r=""===s[i]?t.length:s[i],t=t[r]=i<l?t[r]||(s[i+1]&&isNaN(s[i+1])?Object.create(a):[]):e}else Array.isArray(i[r])?i[r].push(e):void 0!==i[r]?i[r]=[i[r],e]:i[r]=e}else r&&(i[r]=t?void 0:"")})),i}var c,d,p=i(5944);const u=e=>e?e.full_name||(e.user_first_name||e.first_name||"")+" "+(e.user_last_name||e.last_name||""):"",m=e=>Array.isArray(e)||(0,s.isObservableArray)(e),g=e=>e instanceof Map||(0,s.isObservableMap)(e),h=e=>G(e)||(0,s.isObservableObject)(e),b={}.hasOwnProperty,v=function(){const e=[];for(let t=0;t<arguments.length;t++){let i=arguments[t];if(!i)continue;let n=typeof i;if("string"===n||"number"===n)e.push(i);else if(Array.isArray(i)&&i.length){let t=v.apply(null,i);t&&e.push(t)}else if("object"===n)for(let t in i)b.call(i,t)&&i[t]&&e.push(t)}return e.join(" ")||void 0},_=(e,t)=>{if(null===e||"object"!=typeof e)return e;e instanceof Map&&(e=Object.fromEntries(e));const i=Object.keys(e).sort().map((t=>t+":"+_(e[t],!0))).join(",");return t?"{"+i+"}":i},f=e=>[...new Set(e)],y=e=>"object"!=typeof e&&parseInt(e)==e&&e>0&&e,w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.round(e*10**t)/10**t},x=e=>e?(e.focus(),e.selectionStart&&(e.selectionStart=e.value.length),e.selectionEnd&&(e.selectionEnd=e.value.length),e):e,k=86400,Z=3600,C=864e5,S=(e,t)=>{const i=Object.assign({date:!0,time:!0,year:!0,relative:!1},t);return(0,r.GG)(e,i)},O=(e,t,i)=>w(t>0?e/t*100:0,i||0),B=e=>[...Array(e).keys()],T={"&":"%26","/":"%2F","=":"%3D"," ":"%20","%":"%25","+":"%2b"},N=e=>"string"==typeof e?e.replace(/([&=/ %+])/g,((e,t)=>T[t])):e,I=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e?Object.entries(e).map((e=>{let[r,s]=e;if(null==s)return"";r=i?i+"["+r+"]":r,n&&m(s)&&(s=s.join("_"));const o=t?N:encodeURIComponent;return null!==s&&"object"==typeof s?I(s,t,r):`${o(r)}=${o(s)}`})).filter((e=>""!==e)).join("&"):""},D=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.search.substring(1);return l(e)},j=e=>{if(!e)return"";if(_e(e))return e;if(!window.URLSearchParams)return I(e);const t=new URLSearchParams;for(const[i,n]of Object.entries(e))n&&t.append(i,n);return t.toString()},P=function(e){try{e=decodeURIComponent(e)}catch(e){}return e},z=e=>"function"==typeof e,E=(e,t,i)=>z(e)?e.apply(t||null,i||[]):e,R=e=>(e||"")+Date.now().toString(),F=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t;const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<e;t++)i+=n.charAt(Math.floor(Math.random()*n.length));return i},M=e=>{let t=[];if(void 0===e)return[];if(e instanceof Map)for(const[i,n]of e)t.push({val:i,label:n});else if(Array.isArray(e))for(const[i,n]of e.entries())t.push(Array.isArray(n)?{val:n[0],label:n[1]}:"object"==typeof n?n:{val:i,label:n});else for(const[i,n]of Object.entries(e)){const e=(null==n?void 0:n.label)||n;t.push("object"==typeof e?{label:i,optgroup:!0,options:M(n)}:{val:i,label:e})}return t},A=e=>e.map((e=>({val:e,label:e})));function q(e,t){let{noEmpty:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n={};return t.forEach((t=>{!(t in e)||i&&!e[t]||(n[t]=e[t])})),n}function X(e,t){const i={};return Object.keys(e||{}).forEach((n=>{t(e[n])&&(i[n]=e[n])})),i}const L=(e,t)=>e.map((e=>e[t]));function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e;return Object.fromEntries(Object.entries(e).map((e=>[i(e[0]),t(e[1])])))}function V(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"…";if(!e)return"";const n=document.createRange().createContextualFragment(e);n.querySelectorAll("br").forEach((e=>e.replaceWith(" ")));const r=n.textContent.trim();return t&&r.length>t?r.truncate(t,i):r}const U=e=>!(null==e||""===e||Array.isArray(e)&&0===e.length||G(e)&&0===Object.keys(e).length),H=(e,t)=>(t=t||U,Object.entries(e).reduce(((e,i)=>{let[n,r]=i;return t(r,n)?{...e,[n]:r}:e}),{})),J=()=>parseInt(Date.now()/1e3),G=e=>{if("object"!=typeof e||null===e||e.$$typeof)return!1;const t=Object.getPrototypeOf(e);return null!==t&&null===Object.getPrototypeOf(t)},W=(e,t)=>{if(t&&!e)return!0;return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},K=(e,t)=>{let{min:i,max:n,integer:r}=t;if(""===e||!ce(e))return!0;if(!(r?/^\d*$/:/^\d+\.?\d*$/).test(e))return{error:r?lng("please type a whole number").caps():lng("please type a number").caps()};const s=r?parseInt(e):parseFloat(e);return ce(i)&&ce(n)&&(s<i||s>n)?{error:lng("number should be between %s and %s",i,n).caps()}:ce(i)&&s<i?{error:lng("number should be %s or higher",i).caps()}:!(ce(n)&&s>n)||{error:lng("number should be %s or lower",n).caps()}},Y=(e,t)=>{if("#text"===e.nodeName)return e.textContent;let i=[];for(let r=0;r<e.childNodes.length;r++){const s=e.childNodes[r];let o=!1;for(const e of t.filterClass){var n;null!==(n=s.className)&&void 0!==n&&n.split(" ").includes(e)&&(o=!0)}if(o)continue;const a=Y(s,t);a&&i.push(a)}return i.join("")},Q=e=>{document.title=Blsm.prm.branding+(e?" - "+e.caps(!1):"")},ee=e=>{return!e||m(e)&&0===e.length||g(e)&&0===e.size||((t=e)instanceof Set||(0,s.isObservableSet)(t))&&0===e.size||h(e)&&0===Object.keys((0,s.isObservableObject)(e)?(0,s.toJS)(e):e).length;var t},te=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if(!0===t(e))return e;const r=Array.isArray(e)||G(e)?Object.values(e):(0,s.isObservableArray)(e)||(0,s.isObservableObject)(e)?(0,s.values)(e):void 0;if(r)for(const e of r){if(ce(n)&&!1===n(e))continue;const r=te(e,t,i,n);if(void 0!==r)return!i||Array.isArray(e)||(0,s.isObservableArray)(e)||i.unshift(e),r}},ie=e=>{if("string"!=typeof e)return e;const t=e.split("\n").reduce(((e,t)=>(e.length&&e.push((0,p.tZ)("br",{})),e.push(t),e)),[]);return(0,n.createElement)(n.Fragment,null,...t)},ne=e=>parseInt(e)===Blsm.user.id,re=e=>e.forEach(((e,t)=>e._key=t+"_"+Math.random())),se=e=>"1"===e||1===e,oe=(e,t)=>{const i=[];for(let n=0,r=e.length;n<r;n+=t)i.push(e.slice(n,n+t));return i},ae=()=>/android|iPad|iPhone/i.test(navigator.userAgent),le=(e,t)=>{let i;return function(){const n=this,r=arguments;clearTimeout(i),i=setTimeout((()=>{e.apply(n,r)}),t)}},ce=e=>null!=e,de=e=>Object.fromEntries(Object.entries(e).map((e=>[e[0].replace(/(-)([a-z])/g,(e=>e[1].toUpperCase())),e[1]]))),pe=()=>window.innerWidth<=1023,ue=()=>window.innerWidth<=574,me=()=>-1<navigator.userAgent.indexOf(" BlsmAppReact"),ge=()=>location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+Blsm.prm.Mainref,he=e=>{if(0==e)return"0B";const t=Math.floor(Math.log(e)/Math.log(1024));return fe(e/Math.pow(1024,t))+["B","KB","MB","GB","TB","PB"][t]},be=(e,t,i)=>{i=Object.assign({add_sign:!0,verbose:!1,percent:!0,precision:0},i),isNaN(parseFloat(e))&&(e=0);let n=0==t?0:100*e/t;return n=fe(n,i.precision,!!i.add_sign&&"%"),i.verbose&&(n=e+"/"+t+(i.percent?" ("+n+")":"")),n},ve=e=>!isNaN(parseFloat(e))&&isFinite(e),_e=e=>"string"==typeof e,fe=(e,t,i)=>{if(!ve(e))return"-";const n=Math.pow(10,void 0===t?2:t);let r=Math.round(e*n)/n;return i&&(r+=i),"."===Blsm.lang.dec_point?r:r.toString().replace(".",Blsm.lang.dec_point)},ye=()=>Blsm.InitialData.default_currency||{symbol:"",rate:1},we=e=>`${ye().symbol}${fe(ye().rate*e,2)}`,xe=e=>/^field_\d+$/.test(e),ke=e=>`field_${e}`,Ze=()=>window.navigator.userAgent.includes("Trident"),Ce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=document.createElement(e);for(const[e,n]of Object.entries(t))void 0!==n&&(i[e]=n);return i},Se=e=>{const t=document.createElement("div");return e&&(t.id=e),document.body.appendChild(t),t},Oe=e=>window.addEventListener("DOMContentLoaded",e),Be=(e,t)=>e.filter(((e,i,n)=>n.findIndex((i=>e[t]===i[t]))===i)),Te=function(e){let{typingDelay:t=300,hashFn:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=null;return(s,o)=>{const a=i?i(s):_(s);if(n[a])return o(n[a]);clearTimeout(r),r=setTimeout((()=>{Object.keys(n).length>100&&(n={}),e(s,(e=>o(n[a]=e)))}),"string"==typeof s||"term"in s?t:0)}},Ne=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.includes("://")||(e=t+"//"+e);const i=document.createElement("a");return i.href=e,i},Ie=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e&&JSON.parse(e)||t},De=(e,t)=>0===e.localeCompare(t,void 0,{sensitivity:"accent"}),je=e=>{const t=document.createElement("canvas"),i=t.getContext("2d");t.width=e.width,t.height=e.height,i.drawImage(e,0,0);let n,r,s,o=t.width,a=t.height,l={x:[],y:[]},c=i.getImageData(0,0,o,a);for(r=0;r<a;r++)for(n=0;n<o;n++)s=4*(r*o+n),c.data[s+3]>0&&(l.x.push(n),l.y.push(r));l.x.sort(((e,t)=>e-t)),l.y.sort(((e,t)=>e-t));const d=l.x.length-1;o=l.x[d]-l.x[0],a=l.y[d]-l.y[0];const p=i.getImageData(l.x[0],l.y[0],o,a);return t.width=o,t.height=a,i.putImageData(p,0,0),t.toDataURL()},Pe=()=>"#"+Math.random().toString(16).slice(-6),ze=e=>{const t=Ne(e);let{hostname:i,protocol:n,pathname:r,search:s}=t;if("http:"===n||"https:"===n){i=i.replace(/^www\./,""),r=r.startsWith("/")?r.substring(1):r;const e=D(s.substring(1));if("youtube.com"===i&&e.v)return"https://www.youtube.com/embed/"+e.v+(e.t?"?start="+e.t:"");if("youtube-nocookie.com"===i&&e.v)return"https://www.youtube-nocookie.com/embed/"+e.v+(e.t?"?start="+e.t:"");if("youtu.be"===i&&r.length>1)return"https://www.youtube-nocookie.com/embed/"+r+(e.t?"?start="+e.t:"");if("vimeo.com"===i&&r.length>1){const[e,t]=r.split("/");return`https://player.vimeo.com/video/${e}${t?`?h=${t}`:""}`}if("ted.com"===i&&r.match("^talks/.+"))return`https://embed.ted.com/talks/lang/${e.language||"en"}/${r.split("/")[1]}`}return!1},Ee=e=>setTimeout(e,0),Re=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:",";return""===e?t:_e(e)?e.split(i):m(e)?e:t},Fe=e=>e>=1e3?Math.floor(e/1e3)+"K":e,Me=()=>location.hash.trim().replace(/^#/,""),Ae=e=>e.getClientRects().length>0,qe=e=>e.split("/").map((e=>e.includes("=")?D(e):e)),Xe=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter((e=>e)).length},Le=(e,t)=>Object.assign(e,q(t,Object.getOwnPropertyNames(e),{noEmpty:!0})),$e=null!==(c=document.body)&&void 0!==c&&c.requestFullscreen?"requestFullscreen":!(null===(d=document.body)||void 0===d||!d.webkitRequestFullscreen)&&"webkitRequestFullscreen",Ve=e=>JSON.parse(JSON.stringify(e)),Ue=(e,t)=>e.includes(t)?e.filter((e=>e!==t)):[...e,t],He=e=>{const t=[...e];for(let e=t.length-1;e>0;e--){const i=Math.floor(Math.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t}},4877:(e,t,i)=>{i.d(t,{PS:()=>I,RO:()=>j,wf:()=>T,a9:()=>O,gm:()=>C,sG:()=>D,An:()=>z,Kv:()=>P});var n=i(917),r=i(7363),s=i(8318),o=i(236),a=i(5007),l=i(539),c=i(5560),d=i(4210),p=i(9431),u=i(8567),m=i(5405),g=i(1823),h=i(6920),b=i(6975),v=i(441),_=i(5944);const f=function(e){let{...t}=e;const i=(0,n.iv)("margin:10px 10px;height:0;border-bottom:1px solid ",h.g.colors.separator_light,";","");return(0,_.tZ)("div",{css:i,...t})};var y=i(4070),w=i(6344),x=i(8e3),k=i(7965),Z=i(1533);const C=(0,c.observer)((function(e){var t,i,r;let{onClick:o,href:a,text:l=lng("show more"),widgetStore:c,...d}=e;if(c.options.hide_show_more)return null;const p=(0,s.tq)()?5:10;if(null!==(t=c.data)&&void 0!==t&&t.limit_reached){let e=parseInt((null==c?void 0:c.force_limit)||(null==c?void 0:c.options.limit));e&&(e<13||!o&&!a)&&(e+=p,o=()=>{c.force_limit=e,c.refreshFromServer()},a=null,l=lng("more")+"...")}if(!o&&!a)return null;const u=(0,n.iv)("color:",(null===(i=c.style)||void 0===i?void 0:i.fgc)||(null===(r=c.portalStore.style)||void 0===r?void 0:r.widgets_fgc)||h.g.colors.text_main,";text-align:center;display:block;margin:0 2px 12px;text-decoration:underline;","");return(0,_.BX)(_.HY,{children:[(0,_.tZ)(f,{}),(0,_.tZ)(v.A,{theme:"highlight",href:a,onClick:o,...d,css:u,children:l.caps()})]})})),S=(e,t,i,r,s)=>{const{widgets_title_color:o,widgets_title_bgc:a,widgets_fgc:l,widgets_bgc:c}=t,{bgimage:d,bgoverlay:p,bgpos:u,borderless:m,title_color:g=o,title_bgc:b=a,fgc:v=l,bgc:_=c}=e;return(0,n.iv)(i&&"outline: rgb(92, 101, 108) dotted 3px;",";",v&&`color:${v};`," ",_&&`background-color:${_};`," ",_&&m&&`border-color:${_};`," ",!_&&m&&"background-color:transparent;border-color:transparent;"," ",d&&`background-image:url('${h.g.func.imgUrl(d,r)}');background-size:cover;`," ",d&&`background-image:${p?`${/#000/.test((0,w.ou)(v||h.g.colors.text_main))?h.g.consts.imgdata_half_black:h.g.consts.imgdata_half_white},`:""}url('${h.g.func.imgUrl(d,r)}');background-size:cover;background-position: center center;`," background-position:",u||"top center",";.widget-title[class]{",g&&`color: ${g};`," ",b&&`background-color: ${b};`,";}.widget-body[class]{",v&&`color:${v};`,"overflow-y:",s?"hidden":"overlay",";}","")},O=(0,c.observer)((function(e){let{children:t,widgetStore:i,editForm:n,preferencesForm:c,scrolling:d}=e;const{loading:g,style:h={},titleLink:v,titleNewTab:f=!0,widget_active:w,mayEdit:x,toggleActivation:k,newMenuOptions:Z,widget_type:C,scrollBtnState:O}=i;let B=i.title;if(i.options.default_title){const e=C&&y.Z[C];null!=e&&e.widgetDefaultTitle&&(B=e.widgetDefaultTitle.caps()),i.defaultTitle&&(B=i.defaultTitle.caps())}const T=(0,r.useContext)(p._G),N=(0,r.useContext)(p.rN),I=[x&&n&&{label:lng("edit"),icon:"edit",onClick:()=>(0,a.vm)().openDialog("form",new n({widgetStore:i,onSaveSuccess:e=>{(0,a.vm)().closeDialog(),i.updateData(e)}}))},c&&{label:lng("preferences"),icon:"settings",onClick:()=>(0,a.vm)().openDialog("form",new c({widgetStore:i,onSaveSuccess:()=>{(0,a.vm)().closeDialog()}}))},x&&T.mayHideWidgets&&{label:w?lng("hide"):lng("show"),icon:"preview",onClick:k},x&&{label:lng("delete"),icon:"trash",onClick:()=>(0,u.BB)(lng("are you sure you want to delete this widget?"),{onConfirm:()=>T.deleteWidget(i)})},x&&{label:lng("refresh"),icon:"reload",onClick:()=>i.refreshFromServer()},x&&T.mayMoveToAnotherPortal&&Blsm.user.isPowerManager&&i.portal_id&&{label:lng("move to another portal").caps(),icon:"AssignOutsource",onClick:()=>N.moveWidget(T,i)}];return(0,_.tZ)(o.$L,{title:B,link:v,newTab:f,size:i.isDouble?2:1,newMenuOptions:Z,menuOptions:I||void 0,css:S(h,Object.assign(T.parent_style,T.style),!w,T.domain_id,!(0,s.tq)()&&d),additionalIcons:i.options.initial_scroll&&!(0,s.tq)()?(0,_.tZ)(b.JO,{className:"play-pause",smallButtonLike:!0,icon:O?"pause":"play",onClick:()=>i.scrollBtnState=!i.scrollBtnState}):null,widgetId:i.widget_id,children:(0,_.tZ)(m.SV,{children:g?(0,_.tZ)(l.$,{}):t})})})),B={name:"1dvdlnn",styles:"display:flex;height:90%;justify-content:center;align-items:center;flex-direction:column;._icon{display:block;font-size:3em;}"},T=function(e){let{message:t,icon:i,children:n,widgetStore:r,...o}=e;if(r.style.hidden_no_data&&!r.mayEdit)return null;let a=t;return!(0,s.DM)(t)&&(0,s.DM)(r.data)&&(0,s.xb)(r.data)&&(a=lng("no items")),(0,_.tZ)(O,{widgetStore:r,...o,children:(0,_.BX)("div",{css:B,children:[i&&(0,_.tZ)(b.JO,{className:"_icon",icon:i}),a&&(0,_.tZ)("div",{children:a.caps()}),r.style.hidden_no_data&&(0,_.BX)("div",{style:{fontStyle:"italic",color:h.g.colors.grey},children:["(",lng("hide when empty"),")"]}),n]})})},N={name:"15yxp6q",styles:"margin:0;>div{margin-bottom:15px;}"},I=(0,c.observer)((function(e){let{widget:t,itemsToShow:i,liRenderer:n,itemIdSelector:o,extraOptions:a}=e;const{options:l,scrollBtnState:c}=t,d=(0,r.useRef)(null),[p,u]=(0,r.useState)(i),[m,g]=(0,r.useState)(l.auto_scroll);let h;!p&&u(i),(0,r.useEffect)((()=>{if(!(0,s.tq)()){if(!h&&m){const e=document.querySelector(`.WidgetContainer [data-widget_id="${t.widget_id}"]`),n=e.querySelector(".list-layout").clientHeight,r=e.clientHeight;h=l.auto_scroll&&n>r&&i.length>1}if(h&&m&&c){const e=setTimeout((()=>{if(p){const e=[...p],t=e.shift();(0,Z.flushSync)((()=>u(e))),u((e=>[...e,t]))}}),3e3);return()=>clearTimeout(e)}}}),[p,m,c]);return(0,_.tZ)("div",{className:"list-layout",css:N,onMouseEnter:()=>{(0,s.tq)()||(g(!1),t.options.auto_scroll=!1)},onMouseLeave:e=>(e=>{if(!l.initial_scroll||(0,s.tq)())return;g(!0),t.options.auto_scroll=l.initial_scroll,e.target.closest(".widget-body").scrollTo({top:0,behavior:"smooth"})})(e),children:null==p?void 0:p.map((e=>(0,_.tZ)(k.E.div,{layout:!0,className:"_item",transition:{type:"spring",stiffness:200,ease:"linear",damping:30},children:n({item:e,widget:t,extraOptions:a,ref:d})},e[o])))})}));class D extends d.I{constructor(e){let{delayed_data:t=!1,allow_hidden_no_data:i=!1,allow_limit:n=!1,allow_title:r=!0,allow_double_box:o=!0,allow_self_style:a=!0,allow_self_style_only_title:l=!1,allow_bgimage:c=!0,allow_fgc:d=!0,has_show_more:p=!1,using_strips:u=!1,widgetStore:m,...g}=e;super(g),this.sendEmpty=!0,this.widgetStore=m;const h=lng("use portal setting").caps(),b=(0,s.wd)([["",h],["#171625",lng("black").caps()],["#FFFFFF",lng("white").caps()],["#717171",lng("light gray").caps()]]),v=function(){return[5,10,20,30,50,100].map((e=>({val:e,label:lng("%s items",e)})))},_=m.widget_type,f=_&&y.Z[_],w=!(!f.widgetDefaultTitle&&!("defaultTitle"in f.store.prototype)),k=[];(l||a)&&k.push({type:"select",name:"style[title_color]",label:lng("title color"),options:b,insert:r},{type:"color",alpha:!0,clear_button:!0,cls:"input_short",name:"style[title_bgc]",label:lng("title background"),placeholder:h,insert:r}),a&&k.push({type:"select",name:"style[fgc]",label:lng("text color"),options:b,insert:d},{type:"color",alpha:!0,clear_button:!0,cls:"input_short",placeholder:h,name:"style[bgc]",label:lng("background color")},{type:"checkbox",name:"style[translucent]",label:lng("translucent items"),insert:u},{type:"img",label:lng("background image"),title:lng("replace image"),tabs:["portal","images","gallery"],name:"style[bgimage]",removeButton:!0,insert:c},{type:"select",name:"style[bgpos]",label:lng("image position"),options:[["center top","🡻"],["right top","🡿"],["right center","🡸"],["right bottom","🡼"],["center bottom","🡹"],["left bottom","🡽"],["left center","🡺"],["left top","🡾"],["center center","▣"]],insert:c,visible:()=>this.values.get("style[bgimage]")},{type:"checkbox",name:"style[bgoverlay]",label:lng("background overlay"),insert:c,visible:()=>this.values.get("style[bgimage]"),helpKey:"@theme/background_overlay"}),this._fields=[{insert:m.portalStore.maySetWidgetsAvailableToMembers,type:"multiple_items",name:"group_ids",label:lng("available to members of"),placeholder:lng("all"),poster:!0,theme:"bright",searchData:(e,t)=>{(0,x.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",catalog:1,term:e.term||"",id:e.ids||""}},t)}},{insert:m.portalStore.maySetWidgetsAvailableToMembers,type:"checkbox",name:"widget_sub_groups",label:lng("include sub workspaces").caps(),visible:e=>{var t;return(null===(t=e.get("group_ids"))||void 0===t?void 0:t.length)>0}},{type:"section",title:lng("display"),titleSmall:!0,fields:[{type:"text",name:"title",label:lng("title"),insert:r,disable:()=>!!this.values.get("options[default_title]"),maxLength:200},{type:"checkbox",name:"options[default_title]",label:lng("default title"),insert:r&&w},{type:"checkbox",name:"style[hidden_no_data]",label:lng("hide when empty"),insert:i&&!t},{type:"checkbox",name:"style[double]",label:lng("double width"),insert:o},{type:"checkbox",name:"style[borderless]",label:lng("borderless")},{type:"select",name:"options[limit]",label:lng("show up to"),options:()=>v,insert:n},{type:"checkbox",name:"options[hide_show_more]",label:lng("show more"),reversed:!0,insert:p},{type:"checkbox",name:"options[auto_scroll]",label:lng("auto scroll"),insert:["rss","news"].includes(_)}]},k.length>0&&{type:"section",title:lng("theme"),titleSmall:!0,fields:k}],n&&!m.options.limit&&(m.options.limit=30)}prepareValuesForSave(e){return e}save(e){const{widget_id:t,group_id:i}=this.widgetStore;(e=Object.assign((0,s.ei)(this.widgetStore,["widget_id","widget_type","widget_order","portal_id","widget_active"]),e)).style&&(e.style=(0,s.v7)(e.style)),e.options&&(e.options=(0,s.v7)(e.options)),e=this.prepareValuesForSave(e),this.saveToUrl(`portal/widget/${t||""}${i?`&gid=${i}&`:""}`,e)}}const j=function(e){let{widget:t}=e;const{widget_type:i,data:n}=t;return console.warn("missing widget:",t),(0,_.tZ)(O,{widgetStore:t,editForm:void 0,children:n&&(n.length||Object.keys(n).length)?(0,_.tZ)(g.G,{jsonObj:n}):i})},P=function(){let{borderless:e,condensed:t,columns:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.iv)(i>0?`\n\t\tdisplay: block; \n\t\tcolumn-count: ${i};\n\t\trow-gap: ${(t?h.g.consts.LIST_MARGIN_CONDENSED:h.g.consts.LIST_MARGIN)-4}px;\n\t\tcolumn-gap: ${t?h.g.consts.WIDGET_PADDING_SIDE/2:h.g.consts.WIDGET_PADDING_SIDE}px;\n\t`:"\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\talign-items: flex-start;\n\t"," ",e?"":`padding: 5px ${h.g.consts.WIDGET_PADDING_SIDE}px`,";>*{flex-basis:100%;align-self:baseline;break-inside:avoid;padding:2px 0;}",i>0?"> * + *":"> *","{margin-top:",(t?h.g.consts.LIST_MARGIN_CONDENSED:h.g.consts.LIST_MARGIN)-4,"px;}","")},z=e=>{let{widget:t,condensed:i}=e;return(0,n.iv)("display:flex;flex-wrap:wrap;justify-content:space-between;align-items:normal;row-gap:",i?h.g.consts.LIST_MARGIN_CONDENSED:h.g.consts.LIST_MARGIN,"px;column-gap:",i?h.g.consts.WIDGET_PADDING_SIDE/2:h.g.consts.WIDGET_PADDING_SIDE,"px;>*{flex-grow:1;flex-basis:",null!=t&&t.isDouble?20:30,"%;>*{height:100%;}}",null!=t&&t.style.borderless?"":`padding: 0 ${h.g.consts.WIDGET_PADDING_SIDE}px;`,">*{margin-top:",i?h.g.consts.LIST_MARGIN_CONDENSED:h.g.consts.LIST_MARGIN,"px;}","")}},9852:(e,t,i)=>{i.d(t,{BP:()=>O,ZP:()=>N});var n=i(5560),r=i(4877),s=i(8318),o=i(6920),a=i(917),l=i(4902),c=i(6975),d=i(7363),p=i(1137),u=i(6421),m=i(8e3),g=i(8534),h=i(9483),b=i(5311),v=i(6344),_=i(7316),f=i(5944);const y=lng("birthdays"),w=lng("display users' upcoming birthdays"),x=y;var k={name:"t5e8y3",styles:"margin-inline-end:10px"};const Z=(0,n.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:p}=t,[u,m]=(0,d.useState)(!1);if((0,s.xb)(i))return(0,f.tZ)(r.wf,{message:lng("no upcoming birthdays"),widgetStore:t,editForm:C});const g=i.length>(n.avatar?5:8),h=(0,a.iv)(p.borderless?"":`margin: ${o.g.consts.WIDGET_PADDING_TOP}px ${o.g.consts.WIDGET_PADDING_SIDE}px 0 ${o.g.consts.WIDGET_PADDING_SIDE}px;`,">div{display:flex;flex-direction:row;justify-content:space-between;>div{display:inline-flex;align-items:center;}}","");return(0,f.BX)(r.a9,{widgetStore:t,editForm:C,children:[(0,f.tZ)("div",{css:[h,g?o.g.classes.list_condensed:o.g.classes.list,"",""],children:i.map((e=>(0,f.BX)("div",{children:[(0,f.BX)("div",{children:[n.avatar&&(0,f.tZ)(l.qE,{user:e,balloon:!1,size:"42px",css:k}),(0,s.v2)(e)]}),(0,f.BX)("div",{children:[Blsm.checkMod(["","ENT"])&&e.user_id!=Blsm.user.id&&(0,f.tZ)(c.JO,{color:o.g.colors.dominant_main,onClick:()=>m(e),smallButtonLike:!0,icon:"party_horn",toolTip:lng("send birthday message").caps()})," ",e.birthdate]})]},e.user_id)))}),u&&(0,f.tZ)(S,{subject:u,onClose:()=>m(!1)})]})}));class C extends r.sG{constructor(e){super({allow_double_box:!1,allow_hidden_no_data:!0,allow_fgc:!0,...e}),this.title=y,this._fields.unshift({type:"select",name:"options[days_ahead]",label:lng("show"),options:[{val:30,label:lng("next 30 days")},{val:7,label:lng("next 7 days")}]},{type:"checkbox",name:"options[days_ago]",label:lng("also include 2 days ago")},{type:"checkbox",name:"options[avatar]",label:lng("avatar")}),this._prepFields(this.widgetStore),this.ready=!0}}const S=(0,n.observer)((function(e){let{subject:t,onClose:i}=e;const n=(0,d.useRef)(null),r=Math.floor(4*Math.random()+1),[a,l]=(0,d.useState)(null),[h,v]=(0,d.useState)(!1),[_,y]=(0,d.useState)(""),[w,x]=(0,d.useState)(`bday:template_${r}.jpg`),[k,Z]=(0,d.useState)(r),[C,S]=(0,d.useState)(null);return(0,f.tZ)(p.d,{size:h?"1200px":"700px",onClose:i,from:"side",scroll:!0,ref:n,refDrawerBody:l,drawerBody:a,children:(0,f.BX)("div",{css:T,children:[(0,f.tZ)(c.JO,{icon:"close",onClick:()=>(n.current.close(),i),className:"close"}),h&&(0,f.tZ)(O,{greeting:_,preview:h,image:w}),(0,f.BX)("div",{className:"bday-container",children:[(0,f.BX)("div",{className:"bday",children:[(0,f.tZ)("div",{className:"bday-header",style:{backgroundImage:`url(${o.g.func.imgUrl("bday:template_5.svg")})`},children:(0,f.BX)("div",{className:"bday-header-cont",children:[(0,f.tZ)("div",{className:"header-upper",children:lng("wish happy birthday to").caps()}),(0,f.tZ)("div",{className:"header-lower",children:t.full_name.caps()})]})}),(0,f.tZ)("div",{className:"bday-body",children:(0,f.BX)("div",{className:"top",children:[(0,f.BX)("div",{className:"header",children:[(0,f.BX)("div",{className:"title",children:[lng("what would you like to wish").caps(),"?"]}),(0,f.tZ)("div",{children:lng("select a template down below").caps()})]}),(0,f.BX)("div",{className:"images",children:[[1,2,3,4].map((e=>(0,f.tZ)("div",{style:{backgroundImage:`url(${o.g.func.imgUrl(`bday:template_${e}.jpg`)})`},className:(0,s.AK)("template",{selected:k===e}),onClick:()=>(x(`bday:template_${e}.jpg`),S(null),Z(e))},e))),(0,f.tZ)("div",{className:"template",children:(0,f.tZ)(u.I,{type:"img",maxWidth:"185px",onChange:e=>(x(e),S(e),Z(null)),value:C})})]}),(0,f.tZ)(b.zh,{}),(0,f.tZ)("div",{className:"message",children:(0,f.tZ)(u.I,{type:"textarea",wrapped:!0,placeholder:lng("birthday greeting message").caps(),value:_,onChange:e=>y(e)})}),(0,f.tZ)(b.zh,{})]})}),(0,f.tZ)("div",{className:"submit btn",onClick:()=>(0,m.SC)("users/send_birthday_message",{method:"POST",data:{user_id:t.user_id,img:w,text:_,sender:Blsm.user.id}},(()=>((0,g.LB)({msg:lng("birthday message has been sent.").caps(),type:"success",closeOnClick:!0}),i()))),children:lng("send").caps()})]}),(0,f.BX)("div",{className:"preview-toggler btn",onClick:()=>v(!h),children:[lng("preview").caps()," ",(0,f.tZ)(c.JO,{icon:"arrow_"+(h?o.g.isRTL?"up":"down":o.g.isRTL?"down":"up")})]})]})]})})})),O=(0,n.observer)((function(e){let{image:t,preview:i,greeting:n,asMessage:r}=e;return(0,f.BX)("div",{className:"bday-preview",css:B(r,t),children:[(0,f.tZ)("div",{className:"preview-header"}),(0,f.tZ)("div",{className:"preview-cont",children:n&&(0,f.tZ)("div",{className:(0,s.AK)("preview-greeting",{preview:i}),children:(0,f.tZ)(h.m,{center:!0,keepAlign:!0,children:(0,f.tZ)("div",{dangerouslySetInnerHTML:{__html:n.emojify().nl2br()}})})})}),r&&(0,f.tZ)(_.h,{})]})})),B=(e,t)=>(0,a.iv)("background-image:",e?"none":`url(${o.g.func.imgUrl("bday:template_5.svg")})`,";position:relative;",o.g.mQuery.mobileNarrow,"{position:fixed;top:",o.g.consts.TOP_BAR_HEIGHT,"px;bottom:0;left:0;right:0;}.preview-header{background-image:",e?"none":` url(${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/garlend.jpg)`,";}.preview-cont{background-image:",`url(${o.g.func.imgUrl(t)})`,";margin:",e?"0 auto":0,";font-weight:700;font-size:1.4rem;height:470px;width:400px;max-width:80%;background-size:cover;background-repeat:no-repeat;background-position:center;border-radius:8px;overflow:hidden;text-align:center;white-space:nowrap;&:before{content:' ';display:inline-block;height:100%;vertical-align:middle;margin-right:-0.25em;}>div{padding:10px;background-color:rgba(0, 0, 0, .3);color:white;display:inline-block;margin:0 auto;word-wrap:break-word;max-width:95%;white-space:normal;vertical-align:middle;border-radius:8px;}",o.g.mQuery.mobileNarrow,"{height:400px;}}",""),T=(0,a.iv)("background-color:",o.g.colors.disabled_background,";width:100%;height:100%;display:flex;.close{position:absolute;",o.g.classes.far("20px"),";top:15px;color:white;font-size:2rem;z-index:",o.g.z.top_bar,";}.bday-preview{max-width:500px;width:100%;background-color:",o.g.colors.bg_main,";border-radius:0;display:flex;z-index:",o.g.z.top_bar+2,";justify-content:center;align-items:center;flex-direction:column;text-align:center;flex-grow:1;&:before{content:'';position:absolute;top:0;",o.g.classes.near("0"),";max-width:500px;height:100%;width:100%;background-color:",o.g.colors.bg_main,";background:linear-gradient(rgba(255, 255, 255, 1) 85%, rgba(255, 255, 255, 0) 100%);}.preview-cont{z-index:",o.g.z.top_bar+2,";}.preview-header{position:absolute;top:0;left:0;right:0;background-size:contain;background-repeat:no-repeat;background-position:center;height:100px;max-width:500px;width:100%;}",o.g.mQuery.mobileNarrow,"{max-width:100vw;&:before{max-width:100vw;}.preview-header{max-width:100vw;}}}.bday-container{width:700px;height:calc(100",navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/)?"dvh":"vh"," - 70px);background-color:",o.g.colors.disabled_background,";overflow:hidden;.bday{height:100%;background:transparent;text-align:center;position:relative;display:flex;flex-direction:column;.bday-header{height:200px;display:flex;background-color:",(0,v.mR)(o.g.colors.purple,.7),";flex-direction:column;justify-content:center;align-items:center;color:white;background-position:center;background-repeat:no-repeat;background-size:cover;.bday-header-cont{display:flex;flex-direction:column;height:200px;width:100%;background-color:",(0,v.mR)(o.g.colors.purple,.7),";}.header-upper{margin-top:30px;font-size:1.8rem;font-weight:700;}.header-lower{font-size:1.4rem;font-weight:600;}}.bday-body{margin:-35px auto 0;height:auto;border-radius:10px 10px 0 0;padding-top:30px;overflow:hidden;max-height:100%;width:85%;max-width:650px;background-color:",o.g.colors.bg_main,";position:relative;display:flex;flex-direction:column;justify-content:space-between;flex-grow:1;.top{overflow:scroll;color:",o.g.colors.text_main,";height:100vh;.header{align-items:center;display:flex;justify-content:center;flex-direction:column;margin-bottom:10px;.title{font-size:1.2rem;font-weight:600;}}.message{width:80%;margin:30px auto;}.images{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin-bottom:10px;.template{height:180px;width:180px;background-position:center;background-size:cover;background-repeat:no-repeat;border:1px solid transparent;border-radius:10px;&.selected{border:1px solid ",o.g.colors.dominant_main,";}._bg{height:180px;width:180px;}",o.g.mQuery.mobileNarrow,"{height:120px;width:120px;._bg{height:120px;width:120px;}}}}}}}}.preview-toggler{position:absolute;width:120px;",o.g.classes.far("625px"),";",o.g.classes.near("auto"),";z-index:0;top:45%;height:40px;display:flex;justify-content:center;align-items:end;transform:rotate(-90deg);border-radius:10px;padding:8px;background-color:",o.g.colors.bg_main,";line-height:25px;color:",o.g.colors.text_main,";border-top:none;.Icon{",o.g.classes.margin_near("10px"),";}",o.g.mQuery.mobileNarrow,"{",o.g.classes.near("-50px"),";",o.g.classes.far("auto"),";z-index:",o.g.z.top_bar+2,";}}.submit{position:relative;width:100%;height:62px;font-size:1.6rem;display:flex;justify-content:center;background-color:",o.g.colors.dominant_main,";text-align:center;margin:0 auto;color:white;align-items:center;padding:20px;}.btn{cursor:pointer;}",""),N={widget:Z,form:C,widgetName:y,widgetDesc:w,widgetDefaultTitle:x,isAvailable:e=>"anonymous"!==e}},4070:(e,t,i)=>{i.d(t,{Y:()=>Rn,Z:()=>En});var n,r=i(9852),s=i(5560),o=i(4877),a=i(8318),l=i(441),c=i(917),d=i(6920),p=i(7821),u=i(2517),m=i(8e3);let g=(n=class extends u.r{constructor(){super(...arguments),(0,p.makeObservable)(this)}updateData(e){Object.assign(this,e),this.loading=!0,this.widget_id&&(0,m.SC)(`portal/widget/${this.widget_id}&delayed=1`,{},(0,p.action)((e=>{var t;let i;i=e.data.xml?O(e.data.xml,this):e.data,Array.isArray(i.items)&&(null===(t=i.items)||void 0===t||t.forEach((e=>e.id=(0,a.zO)(16)))),this.data=i,this.loading=!1})))}},h=n.prototype,b="updateData",v=[p.override],_=Object.getOwnPropertyDescriptor(n.prototype,"updateData"),f=n.prototype,y={},Object.keys(_).forEach((function(e){y[e]=_[e]})),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=v.slice().reverse().reduce((function(e,t){return t(h,b,e)||e}),y),f&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(f):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(h,b,y),y=null),n);var h,b,v,_,f,y,w=i(2334),x=i(5944);const k=lng("rss"),Z=lng("display updates from websites that support RSS"),C=(0,s.observer)((function(e){var t;let{widget:i}=e;const{data:n,options:r}=i,s=r.auto_scroll&&(null===(t=n.items)||void 0===t?void 0:t.length)>4&&!(0,a.tq)();if(n.error_msg)return(0,x.tZ)(o.wf,{icon:"no_entry",message:lng("error parsing RSS"),widgetStore:i,editForm:B,children:(0,x.tZ)("pre",{children:n.error_msg})});if((0,a.xb)(n.items))return(0,x.tZ)(o.wf,{icon:"hierarchy",widgetStore:i,editForm:B});return(0,x.BX)(o.a9,{widgetStore:i,editForm:B,scrolling:s,children:[(0,x.tZ)("div",{css:S({widget:i}),children:(0,x.tZ)(o.PS,{widget:i,itemsToShow:n.items,liRenderer:e=>{let{item:t}=e;return(0,x.BX)(x.HY,{children:[r.show_image&&(t.img?(0,x.tZ)("img",{className:"_image",src:t.img}):(0,x.tZ)("span",{className:"_image"})),(0,x.BX)("div",{className:"_text",children:[t.href?(0,x.tZ)(l.A,{theme:"hover",href:t.href,newTab:!0,children:t.title}):(0,x.tZ)("span",{children:t.title}),(0,x.tZ)("div",{className:"_date",children:t.date})]})]})},itemIdSelector:"id"})}),!s&&(0,x.tZ)(o.gm,{widgetStore:i})]})})),S=e=>{let{widget:t}=e;return(0,c.iv)("._item{margin:",d.g.consts.LIST_MARGIN,"px ",d.g.consts.WIDGET_PADDING_SIDE,"px;display:flex;flex-direction:row;justify-items:baseline;padding:",t.options.autoScroll?"10px 0":"",";border-bottom:",t.options.autoScroll?`1px solid ${d.g.colors.separator}`:"",";._text{display:inline-block;}._image{display:inline-block;min-width:",t.isDouble?120:60,"px;width:",t.isDouble?120:60,"px;max-height:",t.isDouble?120:60,"px;object-fit:contain;object-position:top;vertical-align:top;margin-inline-end:10px;border-radius:",d.g.consts.IMG_BORDER_RADIUS,"px;align-self:baseline;margin-top:5px;}._date{display:inline;font-size:.8em;color:",d.g.colors.text_sec,";margin-inline-start:10px;}}","")},O=(e,t)=>{const{options:i}=t,n=(e,t,i)=>{const n=null==e?void 0:e.querySelector(t);if(n)return(i?n.getAttribute(i):"")||n.textContent},r=e=>{const t=e.querySelector('image,thumbnail[url],content[medium*="image"],content[type*="image"]');if(t){let e,i=/^(https?:|\/\/)/i;return i.test(e=t.getAttribute("url"))||i.test(e=n(t,"url"))||i.test(e=t.textContent)||(e=null),e}};try{const t=(new DOMParser).parseFromString(e,"text/xml"),s=Array.from(t.querySelectorAll("item,feed>entry")).map((e=>{const t={title:(0,a.s9)(n(e,"title")),href:n(e,"link","href"),pubDate:n(e,"pubDate,updated"),img:i.show_image&&r(e)};if(i.show_date&&t.pubDate){var s,o;let e=(0,w._3)(new Date(t.pubDate));null!==(s=e)&&void 0!==s&&s.isValid()||(e=(0,w._3)(t.pubDate)),null!==(o=e)&&void 0!==o&&o.isValid()?t.date=(0,a.ey)(e,{time:i.show_time,relative:!0}):console.warn("RSS entry invalid date:",t.pubDate,t)}return(0,a.v7)(t)})).filter((e=>!(0,a.xb)(e))).slice(0,i.limit);if(t.querySelector('feed>link[rel="self"][href^="https://www.reddit.com/"]')&&s.length>1&&s[0].pubDate&&s[1].pubDate){let e=(0,w._3)(s[0].pubDate),t=(0,w._3)(s[1].pubDate),i=864e5;e.isValid()&&t.isValid()&&t.diff(e)>60*i&&s.shift()}return{items:s}}catch(t){return console.warn("rss error: ",t,e),{error_msg:t.toString()}}};class B extends o.sG{constructor(e){super({allow_limit:!0,delayed_data:!0,has_show_more:!0,allow_fgc:!0,...e}),this.title=k,this._fields.unshift({type:"text",name:"options[url]",label:lng("url")},{type:"checkbox",name:"options[show_date]",label:lng("show date")},{type:"checkbox",name:"options[show_time]",label:lng("show time"),visible:()=>this.values.get("show_date")},{type:"checkbox",name:"options[show_image]",label:lng("show images")}),this._prepFields(this.widgetStore),this.ready=!0}}const T={widget:C,form:B,widgetName:k,widgetDesc:Z,store:g};var N=i(1766);class I extends u.r{get defaultTitle(){const e=this.options.type;return N.Ux[e]}get titleLink(){return{report:this.options.type,params:{group:this.group_id}}}}const D=lng("workspace report"),j=lng("display workspace status, meeting or completion report"),P=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n}=t,r=n.type;return i?(0,x.tZ)(o.a9,{widgetStore:t,editForm:z,children:(0,x.tZ)(N.Ql,{report:r,data:i,group_id:i.group_id,wrapWidget:!1})}):(0,x.tZ)(o.wf,{message:lng("nothing to show"),widgetStore:t,editForm:z})}));class z extends o.sG{constructor(e){super({allow_self_style:!1,allow_double_box:!1,...e}),this.widgetStore.widget_id||(this.widgetStore.options.default_title=!0);const{group_type:t}=this.widgetStore,i=["ReportGroupStatus","ReportGroupMeetings","ReportCompletion"];switch(t){case"Qualification":i.push("ReportQualifications");break;case"Ou":i.push("AssignmentCompletionReport","ReportOuQualificationStatus","OuStatusInCourses","MembersVisitReport","OuCoursesPlanExecute");break;case"Workplan":i.push("TasksStatusReport")}const n=i.map((e=>({val:e,label:N.Ux[e]})));this.title=D,this._fields.unshift({type:"select",name:"options[type]",label:lng("select report"),options:n}),this._prepFields(this.widgetStore),this.ready=!0}}const E={widget:P,form:z,widgetName:D,widgetDesc:j,isAvailable:e=>"group"===e,store:I};class R extends u.r{get titleLink(){return this.options.hideLink?null:this.options.url}}const F=lng("iframe"),M=lng("display an external site in a frame"),A=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n}=t;if(!/^(https?:)?\/\/[^"]+$/.test(i.url))return(0,x.tZ)(o.wf,{message:lng("unrecognized url"),widgetStore:t,editForm:q});const r=parseFloat(n.zoom||"1"),s=1/r*100+"%";let l={width:s,height:s,backgroundColor:"transparent",border:0,verticalAlign:"bottom"};return(0,a.tq)()&&(l.minHeight="calc(100vh - 140px)"),1!==r&&(l.transform=`scale(${r})`,l.transformOrigin="top left"),(0,x.tZ)(o.a9,{widgetStore:t,editForm:q,children:(0,x.tZ)("iframe",{src:i.url,allowtransparency:"true",allowFullScreen:!0,sandbox:"allow-scripts allow-popups allow-forms allow-same-origin",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",frameBorder:"0",style:l})})}));class q extends o.sG{constructor(e){super({allow_self_style:!1,allow_self_style_only_title:!0,...e}),this.title=F,this._fields.unshift({type:"text",name:"options[url]",label:lng("url"),placeholder:"https://...",required:!0},{type:"number",name:"options[zoom]",label:lng("zoom"),min:.1,max:5,step:.1,integer:!1,value:1},{type:"checkbox",name:"options[hideLink]",label:lng("show open in new tab button"),reversed:!0}),this._prepFields(this.widgetStore),this.ready=!0}}const X={widget:A,form:q,widgetName:F,widgetDesc:M,store:R};var L=i(9483),$=i(1619);const V=lng("text"),U=lng("display custom text"),H=(0,s.observer)((function(e){let{widget:t}=e;const{options:i,style:n}=t,r=(0,c.iv)(n.borderless?"":`padding: ${d.g.consts.WIDGET_PADDING_TOP}px ${d.g.consts.WIDGET_PADDING_SIDE}px 0;`," img:not(.emojione){max-width:100%;max-height:80vh;}a{color:",d.g.colors.link_blue,";}a:hover{color:",d.g.colors.link_blue_hover,";}ul{padding-inline-start:2em;max-width:calc(100% - 2.5em);}","");return(0,x.tZ)(o.a9,{widgetStore:t,editForm:J,children:(0,x.tZ)(L.m,{children:(0,x.tZ)($.xn,{css:r,content:i.user_content})})})}));class J extends o.sG{constructor(e){super({allow_fgc:!0,...e}),this.title=V,this._fields.unshift({type:"richtext",name:"options[user_content]",toolbarOptions:{font:!0,color:!0,link:!0,media:!0,list:!0}}),this._prepFields(this.widgetStore),this.ready=!0}}const G={widget:H,form:J,widgetName:V,widgetDesc:U,isAvailable:e=>"app"!==e},W=lng("weather"),K=lng("display weather forecast"),Y=W,Q=(0,c.iv)("width:100%;height:100%;",d.g.mQuery.mobile,"{min-height:283px;}@media (max-width: 955px){min-height:317px;}@media (max-width: 485px){min-height:340px;}vertical-align:bottom;",""),ee=(0,s.observer)((function(e){let{widget:t}=e;const{options:{deg_format:i}}=t,n={double:t.isDouble,deg_format:i,lng:Blsm.lang.current.toLowerCase().replace("_","-")},r=`${Blsm.prm.Mainref}portal_weather_iframe.php?${(0,a.Wh)(n)}`;return(0,x.tZ)(o.a9,{widgetStore:t,editForm:te,children:(0,x.tZ)("iframe",{src:r,css:Q,frameBorder:"0"})})}));class te extends o.sG{constructor(e){super({allow_self_style:!1,...e}),this.title=W,this._fields.unshift({type:"select",name:"options[deg_format]",label:lng("units"),options:(0,a.wd)([["c","°C"],["f","°F"]])}),this._prepFields(this.widgetStore),this.ready=!0}}const ie={widget:ee,form:te,widgetName:W,widgetDesc:K,widgetDefaultTitle:Y,isAvailable:e=>"app"!==e};var ne=i(5033),re=i(7327);const se=lng("assignments"),oe=lng("display user's waiting assignments"),ae=se,le=(0,s.observer)((function(e){var t;let{widget:i}=e;const{data:n,options:r,style:s,refLink:c}=i;if("select"===r.mode&&i.mayEdit)return(0,x.BX)(o.wf,{widgetStore:i,editForm:ce,message:"",children:[(0,x.tZ)("br",{}),(0,x.tZ)("p",{children:"Invalid widget configuration: Selecting specific assignments is no longer supported. Please use tags to filter the desired assignments."}),(0,x.BX)("p",{children:["Selected assignments: ",null===(t=r.assignment_id)||void 0===t?void 0:t.split(",").map((e=>(0,x.BX)("span",{children:[(0,x.BX)(l.A,{theme:"hover",href:{edit:"assignment",id:e},children:["#",e]})," "]},e)))]})]});if((0,a.xb)(n.items))return(0,x.tZ)(o.wf,{widgetStore:i,editForm:ce});const d=n.items.map((e=>new re.o(e,{showNew:r.newer}))),p=d.length>5;return(0,x.BX)(o.a9,{widgetStore:i,editForm:ce,children:[(0,x.tZ)("div",{css:(0,o.Kv)({borderless:s.borderless,condensed:p}),children:d.map((e=>(0,x.tZ)(ne.zq,{assignment:e,inContainer:!0,condensed:p,translucent:s.translucent,short:!i.isDouble,refLink:c},e.assignment_id)))}),(0,x.tZ)(o.gm,{href:{home:"overview",params:{alist:1}},text:lng("go to %s",lng("overview",{phrase:!0})),widgetStore:i})]})}));class ce extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e});const{group_id:t,options:i={}}=this.widgetStore;this.title=se;const n=[],r=[{val:"my",label:lng("all waiting assignments").caps()},{val:"coach",label:lng("coaching").caps()}];t&&r.push({val:"group",label:lng("workspace").caps()}),n.push({type:"select",name:"options[mode]",label:lng("show"),options:r}),i.types&&!i.types[0]&&((i.types.file||i.types.text)&&(i.types.content=1),i.types.coaching&&(i.types.activityCoach=i.types.checklistCoach=i.types.surveyCoach=1),i.types=Object.keys(i.types),this.updateValue(i.types,"options[types]"));const{types:s,topics:o}=(0,ne.aA)({ws:t});for(const e in o)o[e].types=[];for(const e of s)o[e.topic].types.push({val:e.type,label:e.typeLabel,color:o[e.topic].color});Object.entries(o).forEach((e=>{let[t,{label:r,types:s}]=e;return n.push({type:"select_multi",name:`pseudo:${t}`,theme:"tags",label:r,options:s,value:i.types,visible:()=>"my"===this.values.get("options[mode]"),onValueChange:e=>{const t=this.values.get("options[types]")||[];for(const i of s)e.includes(i.val)?t.includes(i.val)||t.push(i.val):t.includes(i.val)&&t.splice(t.indexOf(i.val),1);this.updateValue(t,"options[types]")}})})),n.push({type:"hidden",name:"options[types]"},{type:"tags",name:"tags",label:lng("filter by tags"),objectType:"Lesson,Assignment"},{type:"number",min:0,max:99,name:"options[newer]",label:lng("mark as new when newer than %s days").split("%s")[0],unit:lng("mark as new when newer than %s days").split("%s")[1]}),this._fields.unshift(...n),this._prepFields(this.widgetStore),this.ready=!0}prepareValuesForSave(e){for(const t in e)/pseudo:/.test(t)&&delete e[t];return e}}const de={widget:le,form:ce,widgetName:se,widgetDesc:oe,widgetDefaultTitle:ae,isAvailable:e=>"anonymous"!==e};var pe=i(5597),ue=i(5875);const me=lng("approvals"),ge=lng("display user's waiting approvals"),he=me,be=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,style:n}=t;return(0,a.xb)(i)?(0,x.tZ)(o.wf,{message:lng("nothing to approve"),widgetStore:t,editForm:ve}):(0,x.tZ)(o.a9,{widgetStore:t,editForm:ve,children:(0,x.tZ)("div",{css:(0,o.Kv)({borderless:n.borderless}),children:Object.entries(i).map((e=>(0,x.tZ)(ue.o,{title:pe.KX[e[0]],href:(0,l.p4)({list:"approvals",params:`type=${e[0]}`}),newTab:!1,subTitle:lng("%s requests are waiting",e[1]).caps(),markColor:d.g.colors.report_blue,condensed:!0,translucent:n.translucent},e[0])))})})}));class ve extends o.sG{constructor(e){super({allow_double_box:!1,allow_hidden_no_data:!0,using_strips:!0,...e}),this.title=me,this._prepFields(this.widgetStore),this.ready=!0}}const _e={widget:be,form:ve,widgetName:me,widgetDesc:ge,widgetDefaultTitle:he,isAvailable:e=>"app"!==e&&"anonymous"!==e};var fe=i(9180);const ye=lng("blog",{phrase:!0}),we=lng("share blogs of users or workspaces"),xe=ye,ke=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:r}=t,{mode:s}=n,c="g"===s,p="u"===s,u={workspace:c&&n.group_id,user:p&&n.user_id,tab:p?"blog":"social"};if((0,a.xb)(i.items))return(0,x.tZ)(o.wf,{widgetStore:t,editForm:Ze});const m=i.items.length>4;return(0,x.BX)(o.a9,{widgetStore:t,editForm:Ze,children:[(0,x.tZ)("div",{css:(0,o.Kv)({borderless:r.borderless,condensed:m}),children:i.items.map((e=>(0,x.tZ)(ue.o,{href:(0,l.p4)(u),title:e.lesson_name,img:d.g.func.imgUrl(e.poster),condensed:m,translucent:r.translucent,tags:[(0,a.v2)(e.author),t.isDouble?void 0:(0,a.ey)(e.creation_time,{time:!1})].filter((e=>e)),children:t.isDouble&&(0,x.tZ)(fe.qp,{time:e.creation_time,showTime:!1})},e.lesson_id)))}),(0,x.tZ)(o.gm,{href:u,text:lng("go to %s",c?lng("workspace"):lng("user profile")),widgetStore:t})]})}));class Ze extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e}),this.title=ye;const t=(0,a.wd)([{val:"u",label:lng("user blog").caps()},{val:"g",label:lng("group blog").caps()}]);this._fields.unshift({type:"select",name:"options[mode]",options:t},{type:"single_item",name:"options[user_id]",label:lng("select user").caps(),poster:!0,theme:"bright",visible:()=>"u"===this.values.get("options[mode]"),searchData:(e,t)=>{(0,m.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term,id:e.ids||""}},t)}},{type:"single_item",name:"options[group_id]",label:lng("select workspace").caps(),poster:!0,theme:"bright",visible:()=>"g"===this.values.get("options[mode]"),searchData:(e,t)=>{(0,m.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",catalog:1,term:e.term,id:e.ids||""}},t)}}),this._prepFields(this.widgetStore),this.ready=!0}}const Ce={widget:ke,form:Ze,widgetName:ye,widgetDesc:we,widgetDefaultTitle:xe,isAvailable:()=>!Blsm.user.id||Blsm.isFeatureEnabled("blog")};var Se=i(7363),Oe=i(5405),Be=i(643),Te=i(541);class Ne extends u.r{get defaultTitle(){return lng("inbox").caps()}}const Ie=lng("messages"),De=lng("display user's messages"),je=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:r}=t;if((0,a.xb)(i.items)){let e;return e="in"!==n.box||n.unread?n.unread?lng("no new messages"):lng("no messages"):lng("your inbox is empty"),(0,x.tZ)(o.wf,{icon:"mailbox",message:e,widgetStore:t,editForm:Pe})}const s=(0,c.iv)(r.borderless?"":`margin: ${d.g.consts.WIDGET_PADDING_TOP}px ${d.g.consts.WIDGET_PADDING_SIDE}px 0 ${d.g.consts.WIDGET_PADDING_SIDE}px;`,";","");return(0,x.BX)(o.a9,{widgetStore:t,editForm:Pe,children:[(0,x.tZ)("div",{css:[Te.x,s,"",""],children:(0,x.tZ)("div",{className:"_list",children:i.items.map((e=>Object.assign(e,{message:e.message_message,subject:e.message_subject,is_read:(0,a.P$)(e.is_read)}))).map((e=>(0,x.BX)(Se.Fragment,{children:[(0,x.tZ)(Oe.SV,{children:(0,x.tZ)(Be.W,{showAvatar:t.isDouble,msg:e,active:!1,is_read:e.is_read,translucent:r.translucent,onClick:()=>(0,l.p4)({message:e.message_id},!0)})}),(0,x.tZ)("div",{className:"separator"})]},e.message_id)))})}),(0,x.tZ)(o.gm,{href:{messages:!0},text:lng("go to %s",t.defaultTitle),widgetStore:t})]})}));class Pe extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e}),this.title=Ie,this._fields.unshift({type:"hidden",name:"options[box]"},{type:"checkbox",name:"options[unread]",label:lng("unread|noun")},{type:"checkbox",name:"options[user_messages]",label:lng("show only user messages"),onValueChange:e=>this.updateValue(e?"in":null,"options[box]")}),this._prepFields(this.widgetStore),this.ready=!0}}const ze={widget:je,form:Pe,widgetName:Ie,widgetDesc:De,isAvailable:e=>"app"!==e&&"anonymous"!==e,store:Ne};var Ee,Re,Fe=i(6975),Me=i(7659),Ae=i(6421);let qe=(Ee=p.action.bound,function(e,t,i,n,r){var s={};Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null)}((Re=class extends u.r{searchContent(e){this.searchText=e,this.searching=!0,clearTimeout(this.searchTO),this.searchTO=setTimeout((()=>{(0,m.SC)("portal/widget/"+this.widget_id,{data:{term:e.trim()}},(e=>{this.updateData(e),this.searching=!1}))}),500)}}).prototype,"searchContent",[Ee],Object.getOwnPropertyDescriptor(Re.prototype,"searchContent"),Re.prototype),Re);var Xe=i(539);const Le=lng("shared content"),$e=lng("display contents that were shared with the user"),Ve=Le;var Ue={name:"bjn8wh",styles:"position:relative"},He={name:"lytxz0",styles:"margin-inline-end:2px"};const Je=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:r,refLink:s,searchText:l,searchContent:p,searching:u}=t;if((0,a.xb)(i.items)&&(0,a.xb)(l)&&!u)return(0,x.tZ)(o.wf,{widgetStore:t,editForm:Ge});const m=i.items.length>4,g=n.newer&&(0,w._3)(Date.now()-n.newer*a.yV);return(0,x.BX)(o.a9,{widgetStore:t,editForm:Ge,children:[(0,x.BX)("div",{css:(0,o.Kv)({borderless:r.borderless,condensed:m}),children:[(0,x.BX)("div",{css:Ue,children:[(0,x.tZ)(Ae.I,{type:"text",wrapped:!0,placeholder:lng("search").caps(),value:l,onChange:e=>p(e,i.widget_id)}),(0,x.tZ)(Fe.JO,{icon:"search",css:(0,c.iv)({[d.g.far]:10,top:"calc(50% - 12px);",position:"absolute",pointerEvents:"none",color:d.g.colors.disabled_text,fontSize:18},"","")})]}),u?(0,x.tZ)(Xe.$,{}):i.items.map(((e,t)=>{var i,o,l;return(0,x.BX)(ue.o,{title:e.name||e.assignment_name||e.lesson_name,toolTip:e.descriptionIsHtml?(0,a.s9)(e.lesson_description):e.lesson_description,markColor:e.completed?d.g.colors.positive:d.g.colors.yellow,translucent:r.translucent,href:new Me.m(e,{refLink:s}).link,newTab:(0,a.P$)(n.open_new_window),icon:g&&e.modification_time&&(0,w._3)(e.modification_time).isAfter(g)?"asterisk":void 0,iconColor:d.g.colors.dominant_orange,iconTooltip:lng("new|mark new content"),tags:[!!n.show_category&&e.category_name,!!n.show_date&&(0,a.ey)(e.modification_time,{time:!1,relative:!0})].filter((e=>!1!==e)),children:[(null===(i=e.likes)||void 0===i?void 0:i.likes)>0&&(0,x.tZ)(Fe.JO,{icon:"like",badge:null===(o=e.likes)||void 0===o?void 0:o.likes,css:(0,c.iv)({marginInlineEnd:d.g.consts.ICON_MARGIN},"","")}),(null===(l=e.comments)||void 0===l?void 0:l.length)>0&&(0,x.tZ)(Fe.JO,{icon:"discussion",badge:e.comments.length,css:He})]},t)})),0===i.items.length&&(0,x.tZ)("div",{children:(0,x.BX)("div",{children:["🤷 ",lng("no results found").caps()]})})]}),(0,x.tZ)(o.gm,{href:{catalog:!0,term:l},text:(0,a.xb)(l)?lng("go to %s",lng("knowledge center",{phrase:!0})):lng('browse for "%s" in %s page',l,lng("knowledge center",{phrase:!0})),widgetStore:t})]})}));class Ge extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e});const{group_id:t,editValues:i}=this.widgetStore,n=(0,a.wd)({official:lng("official content").caps(),bookmarks:lng("bookmarked content").caps(),trending:lng("trending content").caps(),views:lng("popular content").caps()}),r=(i.categories||[]).map((e=>({val:e.id,label:e.label})));r.sort(((e,t)=>e.label.localeCompare(t.label))),this.title=Le,this._fields.unshift({type:"select",name:"options[show]",emptyOption:lng("all").caps(),label:lng("show"),options:n},{type:"select_multi",name:"options[categories]",options:r,label:lng("select categories")},{type:"tags",name:"tags",label:lng("include tags"),objectType:"Lesson"},{type:"select",name:"options[all_groups]",options:(0,a.wd)([{val:"",label:lng("content from this workspace").caps()},{val:"1",label:lng("all workspaces").caps()}]),insert:!!t},{type:"checkbox",label:lng("open in a new window"),name:"options[open_new_window]"},{type:"checkbox",label:lng("show and sort by date"),name:"options[show_date]"},{type:"checkbox",label:lng("show category"),name:"options[show_category]"},{type:"checkbox",label:Blsm.isFeatureEnabled("share_to_user")?lng("only content shared via workspace or by name"):lng("only content shared via workspace"),name:"options[only_shared_to_ws_or_users]"},{type:"number",min:0,max:99,name:"options[newer]",label:lng("mark as new when newer than %s days").split("%s")[0],unit:lng("mark as new when newer than %s days").split("%s")[1]}),this._prepFields(this.widgetStore),this.ready=!0}}const We={widget:Je,form:Ge,widgetName:Le,widgetDesc:$e,widgetDefaultTitle:Ve,isAvailable:e=>"anonymous"!==e&&Blsm.isFeatureEnabled("catalog"),store:qe};var Ke=i(7376),Ye=i(5898),Qe=i(7154);const et=lng("tasks",{phrase:!0}),tt=lng("display user's tasks"),it=et,nt=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:r}=t;if((0,a.xb)(i.items))return(0,x.tZ)(o.wf,{widgetStore:t,editForm:st});const s=n.newer&&(0,w._3)(Date.now()-n.newer*a.yV),c=i.items.length>3;return(0,x.BX)(o.a9,{widgetStore:t,editForm:st,children:[(0,x.tZ)("div",{css:(0,o.Kv)({borderless:r.borderless,condensed:c}),children:i.items.map(((e,i)=>(0,x.tZ)(ue.o,{href:(0,l.p4)({edit:"task",id:e.task_id}),title:e.task_title,subTitle:(0,x.tZ)(l.A,{href:{workspace:e.group_id,tab:"tasks"},newTab:!0,children:n.my?e.group_name:`${e.group_name} (${e.assignee_name})`}),toolTip:rt(e),markColor:(0,Ke.Pp)(e.task_resolution),icon:s&&e.creation_time&&(0,w._3)(e.creation_time).isAfter(s)?"asterisk":void 0,iconColor:d.g.colors.dominant_orange,iconTooltip:lng("new|mark new content"),tags:[(0,Ke.aS)(e.priority),(0,Ke.HR)(e.status_name,e.task_resolution),t.isDouble&&(0,Ke.i4)(e.severity),t.isDouble&&"creation_time"===n.sort&&(0,x.tZ)(Qe.u,{text:lng("creation date"),children:(0,a.ey)(e.creation_time,{time:!1})}),t.isDouble&&"modified_time"===n.sort&&(0,x.tZ)(Qe.u,{text:lng("modification date"),children:(0,a.ey)(e.modified_time,{time:!1})}),t.isDouble&&e.due_date&&`${lng("due date").caps()} ${(0,a.ey)(e.due_date,{time:!1})}`,...(n.custom_fields||[]).map((t=>e[(0,a.DK)(t)]))].filter((e=>e)),children:e.task_type&&(t.isDouble?(0,x.tZ)(Ye.jC,{color:e.task_type_color,children:e.task_type}):(0,x.tZ)(Qe.u,{text:e.task_type,children:(0,x.tZ)(Fe.gT,{color:e.task_type_color})}))},i)))}),n.my?(0,x.tZ)(o.gm,{href:{tasks:"my"},text:lng("go to %s",lng("my tasks",{phrase:!0})),widgetStore:t}):(0,x.tZ)(o.gm,{href:{report:"TasksStatusReport",params:{group:n.group_id,status:n.status,task_type:n.task_type}},text:lng("task status report"),widgetStore:t})]})})),rt=e=>{let t=[];return t.push("T#"+e.task_id),e.due_date&&t.push(`${lng("due date").caps()} ${(0,a.ey)(e.due_date,{time:!1})}`),t.push((0,Ke.HR)(e.status_name,e.task_resolution)),t.join("\n")};class st extends o.sG{constructor(e){var t,i,n;super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e});const{editValues:r,options:s={}}=this.widgetStore;(!this.widgetStore.widget_id||"my"===s.mode)&&(s.my=!0),"string"==typeof s.group_id&&(s.group_id=s.group_id.split(","));const o=null===(t=r.task_status)||void 0===t?void 0:t.map((e=>({val:e.id,label:e.name}))),a=null===(i=r.task_types)||void 0===i?void 0:i.map((e=>({val:e.id,label:e.name}))),l=null===(n=r.task_custom)||void 0===n?void 0:n.map((e=>({val:e.id,label:e.name})));this.title=et,this._fields.unshift({type:"checkbox",name:"options[my]",label:lng("my tasks",{phrase:!0})},{type:"multiple_items",name:"options[group_id]",label:lng("workspace filter"),poster:!0,theme:"bright",searchData:(e,t)=>{(0,m.SC)("search/groups",{data:{tasks_enabled:1,term:e.term||" ",id:e.ids||""}},t)}},(null==o?void 0:o.length)&&{type:"select_multi",name:"options[status]",options:o,label:lng("task statuses"),emptyLabel:lng("all").caps()},(null==a?void 0:a.length)&&{type:"select_multi",name:"options[task_type]",options:a,label:lng("task types"),emptyLabel:lng("all").caps()},{type:"select",name:"options[priority]",options:ot(Blsm.InitialData.parameters.priority),label:lng("priority filter")},{type:"select",name:"options[severity]",options:ot(Blsm.InitialData.parameters.severity),label:lng("severity filter")},{type:"checkbox",label:lng("show archive"),name:"options[archive]"},{type:"select",name:"options[sort]",options:[{val:"modified_time",label:lng("modification date").caps()},{val:"creation_time",label:lng("creation date").caps()},{val:"priority",label:lng("priority").caps()},{val:"severity",label:lng("severity").caps()}],label:lng("sort by")},(null==l?void 0:l.length)&&{type:"select_multi",name:"options[custom_fields]",options:l,label:lng("custom fields")},{type:"number",min:0,max:99,name:"options[newer]",label:lng("mark as new when newer than %s days").split("%s")[0],unit:lng("mark as new when newer than %s days").split("%s")[1]}),this._prepFields(this.widgetStore),this.ready=!0}}const ot=function(e){let t=Object.entries(e),i=t.length-1;return(0,a.wd)([["",lng("all")],...t.map(((e,t)=>[""+(e[0]-1),t===i?e[1]:lng("%s and above",e[1]).caps()]))])},at={widget:nt,form:st,widgetName:et,widgetDesc:tt,widgetDefaultTitle:it,isAvailable:e=>"app"!==e&&"anonymous"!==e&&Blsm.isFeatureEnabled("group_tasks")};var lt=i(4902),ct=i(3755),dt=i(409);const pt=lng("your profile"),ut=lng("display user's profile details and status"),mt=pt,gt=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:r}=t,s=i.charts.length,p=t.isDouble?"300px":"200px",u=ht.filter((e=>i.info&&i.info[e]));let m=4;(0,a.tq)()?m=1:(n.name&&m--,u.length>6&&(!t.isDouble||s)&&m--,!t.isDouble&&s&&m--);const g=[0,42,60,84,100][m]+"px",h=(0,c.iv)("display:flex;flex-direction:",t.isDouble?"row":"column",";min-height:100%;._user{flex-grow:1;padding:",d.g.consts.WIDGET_PADDING_TOP,"px ",d.g.consts.WIDGET_PADDING_SIDE,"px 0;display:flex;flex-direction:",t.isDouble&&!s?"row":"column",";align-items:center;justify-content:space-around;._avatarname{display:flex;flex-direction:column;align-items:center;margin-bottom:",n.name?0:1,"em;._name{margin:",u.length>4?1:2,"em;font-weight:600;}}._info{display:flex;flex-direction:column;>*{margin-bottom:",u.length>4?5:10,"px;}.info_val{font-weight:600;}}}._charts{flex-grow:",t.isDouble?2:1,";padding:0 ",d.g.consts.WIDGET_PADDING_SIDE,"px;display:flex;flex-direction:column;align-items:center;justify-content:start;margin-top:",n.avatar||n.name||n.info?"0px":"20px",";>*{margin-bottom:",t.isDouble?d.g.consts.LIST_MARGIN:d.g.consts.LIST_MARGIN_CONDENSED,"px;}}","");return(0,x.tZ)(o.a9,{widgetStore:t,editForm:bt,children:(0,x.BX)("div",{css:h,children:[(n.avatar||n.name||n.info)&&(0,x.BX)("div",{className:"_user",children:[(n.avatar||n.name)&&(0,x.BX)("div",{className:"_avatarname",children:[n.avatar&&(0,x.tZ)(lt.qE,{onClick:()=>(0,l.p4)({user:!0},!0),size:g,rounded:!0,shadowed:!0,balloon:!1}),n.name&&(0,x.tZ)(l.A,{className:"_name",href:{user:!0},children:(0,a.v2)(Blsm.user)})]}),n.info&&u.length>0&&(0,x.tZ)("div",{className:"_info",children:u.map((e=>(0,x.BX)("div",{children:[(0,x.BX)("span",{className:"info_label",children:[(0,dt.X)(e).caps(),": "]}),(0,x.tZ)("span",{className:"info_val",children:i.info[e]})]},e)))})]}),s>0&&(0,x.tZ)("div",{className:"_charts",children:i.charts.map(((e,t)=>(0,x.tZ)(l.A,{href:e.url,className:`chart_${e.key}`,children:(0,x.tZ)(ct.k,{textColor:r.fgc,width:p,numerator:e.value,denominator:e.total||e.totalForBar,label:e.label,showDenominator:!!e.total,showPercent:!!e.total,colorByVal:!0,valueInBar:!0})},t)))})]})})})),ht=["user_company","user_department","user_business_phone","user_home_phone","user_mobile_phone","user_address","user_city","user_state","user_postal_code","user_country"];class bt extends o.sG{constructor(e){super({allow_hidden_no_data:!0,...e}),this.title=pt,this._fields.unshift({type:"hidden",name:"options[flag]"},{type:"checkbox",name:"options[avatar]",label:lng("avatar")},{type:"checkbox",name:"options[name]",label:lng("name")},{type:"checkbox",name:"options[achievements]",label:lng("achievements"),insert:Blsm.isFeatureEnabled("assignments")},{type:"checkbox",name:"options[attendance]",label:lng("attendance"),insert:Blsm.isFeatureEnabled("meetings")},{type:"checkbox",name:"options[qualifications]",label:lng("qualifications"),insert:Blsm.isFeatureEnabled("qualifications")},{type:"checkbox",name:"options[courses]",label:lng("courses")},{type:"checkbox",name:"options[compliance]",label:lng("compliance"),insert:Blsm.isFeatureEnabled("compliance_module")},{type:"checkbox",name:"options[approved_courses]",label:lng("approved courses")},{type:"checkbox",name:"options[info]",label:lng("the following fields")},{type:"indent_set",fields:[{type:"component",node:(0,x.tZ)("ul",{children:ht.map((e=>(0,x.tZ)("li",{children:(0,dt.X)(e).caps()},e)))})}]}),this._prepFields(this.widgetStore),this.ready=!0}}const vt={widget:gt,form:bt,widgetName:pt,widgetDesc:ut,widgetDefaultTitle:mt,isAvailable:e=>"anonymous"!==e};var _t=i(493);const ft=lng("phonebook"),yt=lng("search for users phone number"),wt=ft;var xt={name:"zjik7",styles:"display:flex"};const kt=(0,s.observer)((function(e){let{widget:t}=e;const{options:i,style:n}=t,r=t.data.may_search_by_org_unit,[s,l]=(0,Se.useState)(""),[p,u]=(0,Se.useState)("user"),[g,h]=(0,Se.useState)(!1),[b,v]=(0,Se.useState)(lng("find by name")),_=(0,c.iv)("display:flex;min-height:200px;justify-content:center;align-items:center;._icon{font-size:7em;color:",d.g.colors.half_black,";height:fit-content;}",""),f=(0,c.iv)("margin-top:10px;display:flex;flex-direction:column;>*{flex-basis:100%;display:flex;flex-direction:column;margin:10px ",10,"px;align-items:baseline;._name{font-weight:bold;}}",""),y=(0,c.iv)(n.borderless?"":`padding: ${d.g.consts.WIDGET_PADDING_TOP}px ${d.g.consts.WIDGET_PADDING_SIDE}px;`,";",""),w=[{val:"user",label:lng("user name"),icon:"user"},{val:"org_unit",label:lng("org' unit"),icon:"users"}],k=(e,i)=>{clearTimeout(t.searchTO),t.searchTO=setTimeout((()=>{e&&e.trim().length>=2?(0,m.SC)("users/phonebook/",{data:{term:e.trim(),search_by:i}},(e=>h(Ot(e)))):h(!1)}),500)};return(0,x.tZ)(o.a9,{widgetStore:t,editForm:Bt,children:(0,x.BX)("div",{css:y,children:[(0,x.BX)("div",{css:xt,children:[(0,x.BX)("div",{css:(0,c.iv)({position:"relative",width:`calc(100% - ${r?"50":"0"}px)`},"",""),children:[(0,x.tZ)(Ae.I,{css:(0,c.iv)({color:d.g.colors.text_main},"",""),type:"text",value:s,wrapped:!0,placeholder:b,onChange:e=>{l(e),k(e,p)}}),(0,x.tZ)(Fe.JO,{icon:"search",css:(0,c.iv)({[d.g.far]:10,top:"calc(50% - 12px);",position:"absolute",pointerEvents:"none",color:d.g.colors.disabled_text,fontSize:18},"","")})]}),r&&(0,x.tZ)(_t.T,{inline:!0,value:p,size:30,onChange:e=>(u(e),v("org_unit"===e?lng("find by org' unit"):lng("find by name")),k(s,e)),options:w})]}),!(0,a.P$)(i.hide_icon)&&!g&&(0,x.tZ)("div",{css:_,children:(0,x.tZ)(Fe.JO,{className:"_icon",icon:"phone"})}),g&&(0,x.BX)("div",{css:f,children:[0===g.length&&(0,x.tZ)("div",{css:_,children:(0,x.BX)("div",{children:["🤷 ",lng("no results found").caps()]})}),g.map((e=>(0,x.tZ)(St,{user:e},e.user_id)))]})]})})})),Zt={name:"fewz6c",styles:"._user{width:100%;display:flex;flex-direction:row;align-items:center;justify-content:space-between;._user-details{display:flex;flex-direction:row;overflow-y:hidden;._info{font-weight:500;}}}._details{margin:10px auto;display:flex;flex-direction:row;flex-wrap:wrap;._detail{margin:10px auto;display:flex;flex-direction:revert;justify-content:space-between;width:100%;column-gap:5px;}}"};var Ct={name:"t5e8y3",styles:"margin-inline-end:10px"};const St=e=>{let{user:t}=e;const{user_id:i,user_company:n,user_department:r,user_job_title:s,details:o}=t,[c,d]=(0,Se.useState)(!1);return(0,x.BX)("div",{css:Zt,children:[(0,x.BX)("div",{className:"_user",children:[(0,x.BX)("div",{className:"_user-details",children:[(0,x.tZ)(lt.qE,{user:t,balloon:!1,size:"42px",css:Ct}),(0,x.BX)(l.A,{theme:"hover",href:{user:i},className:"_name",children:[(0,a.v2)(t),(n||s||r)&&(0,x.BX)("div",{className:"_info",children:[n&&(0,x.BX)("span",{children:[n," "]}),r&&(0,x.BX)("span",{children:[r," "]}),s&&(0,x.tZ)("span",{children:s})]})]})]}),(null==o?void 0:o.length)>0&&(0,x.tZ)(Fe.JO,{buttonLike:!0,icon:c?"arrow_up":"arrow_down",onClick:()=>d(!c)})]}),o&&c&&(0,x.tZ)("div",{className:"_details",children:o.map((e=>(0,x.BX)("div",{className:"_detail",children:[(0,x.BX)("span",{children:[e.label,":"]}),(0,x.tZ)("span",{children:"phone"===e.type&&(0,a.Fq)()&&/^[\d-]+\d$/.test(e.value)?(0,x.tZ)(l.A,{theme:"highlight",href:`tel:${e.value}`,children:e.value}):"email"===e.type?(0,x.tZ)(l.A,{theme:"highlight",href:`mailto:${e.value}`,children:e.value}):e.value})]},e.label)))})]})},Ot=e=>{const t=["user_avatar","full_name","user_id","user_name","user_company","user_department","user_job_title"];return e.map((e=>{Object.keys(e).forEach((i=>{e[i]&&t.indexOf(i)<0&&(0,dt.X)(i)&&(void 0===e.details&&(e.details=[]),e.details.push({type:/phone/.test(i)?"phone":"user_email"===i?"email":"",label:(0,dt.X)(i).caps(),value:e[i]}))}))})),e};class Bt extends o.sG{constructor(e){var t,i;super({allow_double_box:!0,allow_fgc:!0,...e}),this.title=ft,this.widgetStore.show_icon=!(0,a.P$)(null===(t=this.widgetStore)||void 0===t||null===(i=t.options)||void 0===i?void 0:i.hide_icon),this._fields.unshift({type:"hidden",name:"options[hide_icon]"},{type:"checkbox",name:"show_icon",label:lng("icon"),onValueChange:e=>this.values.set("options[hide_icon]",e?0:1)}),this._prepFields(this.widgetStore),this.ready=!0}}const Tt={widget:kt,form:Bt,widgetName:ft,widgetDesc:yt,widgetDefaultTitle:wt,isAvailable:e=>"anonymous"!==e};var Nt=i(9234),It=i(8246);const Dt=lng("published scores"),jt=lng("display user's published scores of workspaces"),Pt=Dt;var zt={name:"n8hpes",styles:"._score{margin:10px;text-align:center;>div{font-weight:700;font-size:1.2em;}}"};const Et=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,style:n}=t;if((0,a.xb)(i.items))return(0,x.tZ)(o.wf,{message:lng("you do not have any published scores yet"),widgetStore:t,editForm:Rt});const r=zt,s=i.items.length>4;return(0,x.BX)(o.a9,{widgetStore:t,editForm:Rt,children:[(0,x.tZ)("div",{css:[r,(0,o.Kv)({borderless:n.borderless,condensed:s}),"",""],children:i.items.map((e=>(0,x.tZ)(Nt.tP,{entity:new It.j(e),showImg:t.isDouble,condensed:s,translucent:n.translucent,inContainer:!0,newTab:!0,tags:[(0,a.ey)(e.performance_date,{time:!1,relative:!0})],children:(0,x.BX)("div",{className:"_score",children:[(0,x.tZ)("span",{children:lng("score")}),(0,x.tZ)("div",{children:e.performance_score})]})},e.group_id)))}),(0,x.tZ)(o.gm,{widgetStore:t})]})}));class Rt extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!1,using_strips:!0,...e}),this.title=Dt,this._prepFields(this.widgetStore),this.ready=!0}}const Ft={widget:Et,form:Rt,widgetName:Dt,widgetDesc:jt,widgetDefaultTitle:Pt,isAvailable:e=>"app"!==e&&"anonymous"!==e};var Mt=i(7095),At=i(8989);const qt=lng("workspaces"),Xt=lng("display workspaces that the user is a member of"),Lt=qt,$t=(0,s.observer)((function(e){var t,i;let{widget:n}=e;const{data:r,options:s,style:l}=n;if((0,a.xb)(r.items))return(0,x.tZ)(o.wf,{widgetStore:n,editForm:Ut});r.limit_reached=r.items.length>n.options.limit;const c=(0,Mt.p)(r.items.slice(0,n.options.limit),{by:""},"recent_groups","group_id"),d=r.items.length>4,p=(null===(t=At.X.get("recent_groups"))||void 0===t?void 0:t.length)||0;Vt(s);let u={href:{home:"overview",tab:""},text:lng("go to %s",lng("desktop",{phrase:!0}))};return 1===(null===(i=s.relation)||void 0===i?void 0:i.length)&&"manager"===s.relation[0]&&(u={href:{user:!0,tab:"management"},text:lng("go to %s",lng("management"))}),(0,x.BX)(o.a9,{widgetStore:n,editForm:Ut,children:[(0,x.BX)("div",{css:(0,o.Kv)({borderless:l.borderless,condensed:d}),children:[p>0&&(0,x.BX)("div",{children:[lng("recently accessed").caps(),":"]}),c.map(((e,t)=>(0,x.BX)(Se.Fragment,{children:[p>0&&t===p&&(0,x.BX)("div",{children:[lng("additional").caps(),":"]}),(0,x.tZ)(Nt.tP,{entity:new It.j(e),showImg:n.isDouble,condensed:d,translucent:l.translucent,children:e.group_open_date&&(0,x.tZ)(fe.qp,{time:e.group_open_date,showTime:!1})})]},e.group_id)))]}),(0,x.tZ)(o.gm,{...u,widgetStore:n})]})}));function Vt(e){var t,i,n;(0,a.Kn)(null==e?void 0:e.classifications)&&(e.classifications=null===(t=e.classifications)||void 0===t?void 0:t.split(",")),(0,a.Kn)(null==e?void 0:e.types)&&(e.types=Object.entries(e.types).map((e=>e[0]))),(0,a.Kn)(null==e?void 0:e.relation)&&(e.relation=Object.entries(e.relation).map((e=>e[0]))),null!==(i=e.types)&&void 0!==i&&i.length||(e.types=["group","course"]),null!==(n=e.relation)&&void 0!==n&&n.length||(e.relation=["member"])}class Ut extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e});const{options:t,editValues:i}=this.widgetStore;this.title=qt;const n=(i.classifications||[]).map((e=>({val:e.id,label:e.name})));Vt(t);const r=["group",Blsm.isFeatureEnabled("group_subset")&&"Subset","course","Qualification",Blsm.isFeatureEnabled("workplan")&&"Workplan","Ou"].filter((e=>e)).map((e=>({val:e,label:(0,dt.p)(e,null,!0).caps()}))),s=[{val:"member",label:lng("member of workspaces")},{val:"manager",label:lng("managed workspaces")},{val:"owner",label:lng("owned workspaces")}];this._fields.unshift({type:"title",label:lng("filters")},{type:"select_multi",label:lng("types").caps(),name:"options[types]",options:r},{type:"select_multi",label:lng("relation").caps(),name:"options[relation]",options:s},n.length&&{type:"select_multi",label:lng("classifications").caps(),name:"options[classifications]",options:n},{type:"tags",name:"tags",label:lng("tags"),objectType:"Group"},{type:"checkbox",label:lng("include completed workspaces"),name:"options[exclude_completed]",reversed:!0}),this._prepFields(this.widgetStore),this.ready=!0}}const Ht={widget:$t,form:Ut,widgetName:qt,widgetDesc:Xt,widgetDefaultTitle:Lt,isAvailable:e=>"app"!==e&&"anonymous"!==e};var Jt=i(8162),Gt=i(7392);const Wt=lng("approved external events"),Kt=lng("display the user's approved external events"),Yt=Wt,Qt=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,style:n}=t,[r,s]=(0,Se.useState)(null);if((0,a.xb)(i.items))return(0,x.tZ)(o.wf,{widgetStore:t,editForm:ei});i.limit_reached=i.items.length>t.options.limit;const l=i.items.slice(0,t.options.limit);l.sort(((e,t)=>(+e.group_open_date||0)<(+t.group_open_date||0)?1:-1));const p=i.items.length>4;return(0,x.BX)(o.a9,{widgetStore:t,editForm:ei,children:[(0,x.tZ)("div",{css:[(0,o.Kv)({borderless:n.borderless,condensed:p}),(e=>{let{widget:t}=e;return(0,c.iv)("._dates{flex-basis:100%;}",t.isDouble?"":"._titles { max-width: calc(100% - 20px - 32px); }",";","")})({widget:t}),"",""],children:l.map((e=>(0,x.BX)(Nt.tP,{entity:new It.j(e),condensed:p,translucent:n.translucent,href:null,children:[e.group_open_date&&(0,x.tZ)("div",{className:"_dates",children:(0,x.tZ)(fe.qm,{className:"_dates",dateNote:{start:e.group_open_date,end:e.group_close_date},showTime:"auto"})}),e.ect_receipt_sequence&&!t.isDouble&&(0,x.tZ)(Fe.JO,{icon:"receipt",toolTip:lng("expenses").caps(),onClick:()=>s(e.group_id),buttonLike:!0,color:d.g.colors.link_blue}),e.ect_receipt_sequence&&t.isDouble&&(0,x.tZ)("div",{children:(0,x.tZ)(Gt.l,{icon:"receipt",onClick:()=>s(e.group_id),theme:"contained",children:lng("expenses").caps()})}),r===e.group_id&&(0,x.tZ)(Jt.d,{external:e,receipts:e.receipts,onClose:()=>s(!1)})]},e.group_id)))}),(0,x.tZ)(o.gm,{href:{user:!0,tab:"requests"},text:lng("go to %s",lng("my requests status")),widgetStore:t})]})}));class ei extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e}),this.title=Wt,this._fields.unshift({type:"title",label:lng("filters")},{type:"checkbox",name:"options[filter_expenses]",label:lng("expenses")}),this._prepFields(this.widgetStore),this.ready=!0}}const ti={widget:Qt,form:ei,widgetName:Wt,widgetDesc:Kt,widgetDefaultTitle:Yt,isAvailable:e=>Blsm.isFeatureEnabled("course_registartion_external")&&"app"!==e&&"anonymous"!==e};var ii=i(8567),ni=i(2645);const ri=lng("course catalog"),si=lng("available courses for registration from the catalog"),oi=ri;var ai={name:"c6nazo",styles:"._inner_content{flex-wrap:wrap;}.statusContainer{display:flex;flex-direction:column;align-items:center;flex-basis:100%;}"},li={name:"4nshc5",styles:"._inner_content[class]{flex-wrap:initial;}.statusContainer{display:flex;flex-direction:column;align-items:end;.statusNote{width:fit-content;}}"};const ci=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,style:n}=t;if((0,a.xb)(i.items))return(0,x.tZ)(o.wf,{widgetStore:t,editForm:di});i.items.forEach((e=>e.statusInfo=(0,ni.cW)(e.status)));const r=i.items.length>4,s=li,l=ai;return(0,x.BX)(o.a9,{widgetStore:t,editForm:di,children:[(0,x.tZ)("div",{css:(0,o.Kv)({borderless:n.borderless,condensed:r}),children:i.items.map((e=>{return(0,x.tZ)(Nt.tP,{css:t.isDouble?s:l,entity:new It.j(e),tags:[],showImg:t.isDouble,condensed:r,translucent:n.translucent,href:Blsm.user.id?(e.statusInfo.selfStatus,i=e.group_id,{courseCatalog:!0,tab:"self",id:i}):void 0,onClick:Blsm.user.id?void 0:()=>(0,ii.qR)(lng("please sign in to see the content"),{title:lng("sign in is required")}),children:(0,x.BX)("div",{className:"statusContainer",children:[(0,x.tZ)(Ye.jC,{color:e.statusInfo.cardColor,className:`statusNote ${e.statusInfo.selfButtonClass}`,children:e.statusInfo.selfText}),e.group_open_date&&(0,x.tZ)(fe.qp,{time:e.group_open_date,showTime:!1})]})},e.group_id);var i}))}),(0,x.tZ)(o.gm,{href:{courseCatalog:!0,tab:"self"},text:lng("go to %s",lng("course catalog")),widgetStore:t})]})}));class di extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_limit:!0,has_show_more:!0,using_strips:!0,...e});const{editValues:t}=this.widgetStore,i=(t.classifications||[]).map((e=>({val:e.id,label:e.name})));this.title=ri,this._fields.unshift({type:"select_multi",name:"options[classifications]",label:lng("filter by classifications").caps(),options:i},{type:"tags",name:"tags",label:lng("filter by tags"),objectType:"Group"},{type:"select",name:"options[open_within]",label:lng("courses that starts within"),options:{0:lng("all"),10:lng("%s days",10),30:lng("%s days",30),60:lng("%s days",60),120:lng("%s days",120),ongoing:lng("currently open").caps()}}),this._prepFields(this.widgetStore),this.ready=!0}}const pi={widget:ci,form:di,widgetName:ri,widgetDesc:si,widgetDefaultTitle:oi,isAvailable:e=>"app"!==e},ui=lng("image"),mi=lng("display an image"),gi=ui,hi=(0,s.observer)((function(e){let{widget:t}=e;const{options:i,domain_id:n,refLink:r}=t,{fit:s,position:p,image:u,link:m,item_type:g}=i;let h=m;if(g){const e=i[`${g}_id`];switch(g){case"assignment":case"content":h={launcher:"assignment",id:e,ref:r};break;default:h={[g]:e,ref:r}}}const b=(0,c.iv)("width:100%;height:100%;overflow:hidden;._img{object-fit:",s,";object-position:",p,";width:100%;height:100%;}",""),v=(0,a.tq)()?{height:d.g.consts.WIDGET_BASE_HEIGHT}:{},_=(0,x.tZ)("img",{className:"_img",src:d.g.func.imgUrl(u,n),...v});return(0,x.tZ)(o.a9,{widgetStore:t,editForm:bi,children:(0,x.tZ)("div",{css:b,children:h?(0,x.tZ)(l.A,{href:h,newTab:"auto",children:_}):_})})}));class bi extends o.sG{constructor(e){super({allow_double_box:!0,allow_bgimage:!1,allow_fgc:!1,...e}),this.title=ui,this._fields.unshift({type:"img",name:"options[image]",tabs:["portal","images","gallery"]},{type:"select",name:"options[fit]",label:lng("contain image"),options:[{val:"contain",label:lng("contain").caps()},{val:"cover",label:lng("cover").caps()},{val:"fill",label:lng("stretch").caps()}]},{type:"select",name:"options[position]",label:lng("alignment"),visible:()=>"fill"!==this.values.get("options[fit]"),options:[{val:"top",label:lng("top").caps()},{val:"center",label:lng("center").caps()},{val:"bottom",label:lng("bottom").caps()},{val:"left",label:lng("left").caps()},{val:"right",label:lng("right").caps()}]},{type:"radioset",name:"options[item_type]",inline:!0,options:[{val:"",label:lng("link").caps()},{val:"content",label:lng("content")},{val:"assignment",label:lng("assignment")},{val:"portal",label:lng("portal")},{val:"user",label:lng("user")}]},{type:"text",name:"options[link]",label:`${lng("link")} (${lng("optional")})`,visible:()=>!this.values.get("options[item_type]")},{type:"single_item",name:"options[content_id]",label:lng("link to").caps(),placeholder:lng("select content"),visible:e=>"content"===e.get("options[item_type]"),required:!0,theme:"bright",searchData:(e,t)=>{(0,m.SC)("search/content",{data:{term:e.term||" ",id:e.ids,idLabelPairs:1}},t)}},{type:"single_item",name:"options[assignment_id]",label:lng("link to").caps(),placeholder:lng("select assignment"),visible:e=>"assignment"===e.get("options[item_type]"),required:!0,theme:"bright",searchData:(e,t)=>{(0,m.SC)("search/assignments",{data:{term:e.term||" ",id:e.ids}},t)}},{type:"single_item",name:"options[portal_id]",label:lng("link to").caps(),placeholder:lng("select portal"),visible:e=>"portal"===e.get("options[item_type]"),required:!0,theme:"bright",searchData:(e,t)=>{var i;(0,m.SC)("search/portal",{data:{term:e.term||" ",id:e.ids,active:1,exclude:e.ids?"":null===(i=this.widgetStore.portal)||void 0===i?void 0:i.portal_id}},t)}},{type:"single_item",name:"options[user_id]",label:lng("link to").caps(),placeholder:lng("select user"),visible:e=>"user"===e.get("options[item_type]"),required:!0,theme:"bright",searchData:(e,t)=>{(0,m.SC)("search/users",{data:{term:e.term||" ",id:e.ids}},t)}}),this._prepFields(this.widgetStore),this.ready=!0}}const vi={widget:hi,form:bi,widgetName:ui,widgetDesc:mi,widgetDefaultTitle:gi};var _i,fi=i(9160),yi=i(9415),wi=i(2464);let xi=(function(e,t,i,n,r){var s={};Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null)}((_i=class extends u.r{constructor(){super(...arguments),(0,p.makeObservable)(this)}updateData(e){var t;e.object_id=null===(t=e.object_id)||void 0===t?void 0:t.split(","),Object.assign(this,e),this.loading=!1}}).prototype,"updateData",[p.override],Object.getOwnPropertyDescriptor(_i.prototype,"updateData"),_i.prototype),_i);var ki=i(6418);function Zi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ci=lng("photo album"),Si=lng("create and share a photo albums"),Oi=Ci,Bi=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n}=t,r=i.filter((e=>e.photos.length)),s=r.length,[l,c]=(0,Se.useState)(null);if(0===s)return(0,x.tZ)(o.wf,{message:lng("nothing to show"),icon:"media",widgetStore:t,editForm:Ti});const d=e=>{let{file_name:t}=e;return(0,a.nu)(t.replace(/^.*[/]/,""))},p=1===s?r[0].photos.map((e=>({img:e.url,overlayText:d(e),photos:r[0].photos,...e}))):r.map((e=>({img:e.photos[0].url,overlayText:e.album_name,...e})));return(0,x.BX)(o.a9,{widgetStore:t,editForm:Ti,children:[(0,x.tZ)(wi.VK,{layout:(0,a.Oz)()?"mobile":t.isDouble?"wide":"narrow",maxPhotos:1===s?+n.max_photos:void 0,height:(0,a.tq)()?"min(120vw, calc(100vh - 200px))":void 0,children:p.map(((e,t)=>(0,x.tZ)(wi.XI,{size:["100%","100%"],...e,onClick:()=>{var t;c({type:"img",likes:(t=e).photos.map((e=>e.likes)),url:t.url||t.photos[0].url,images:t.photos.map((e=>e.url)),labels:t.photos.map(d),object_ids:t.photos.map((e=>e.file_id))})}},t)))}),l&&(0,x.tZ)(ki.$,{onClose:()=>c(null),file:l,socialFlag:Blsm.isFeatureEnabled("assignments_comments")})]})}));class Ti extends o.sG{constructor(e){super({allow_hidden_no_data:!0,...e}),Zi(this,"newAlbumName",(e=>{e&&(0,m.SC)("album/album",{data:{album_name:e,album_id:null},method:"POST"},(e=>{if(e){const t=[...this.values.get("object_id")||[]];t.push(e),this.updateValue(t,"object_id"),this.updateValue("","new_album_name")}}))})),this.widgetStore.created=this.widgetStore.created||Date.now(),this.title=Ci;this._fields.unshift({type:"multiple_items",maxItems:wi.kj,name:"object_id",label:lng("select photo albums"),theme:"bright",searchData:(e,t)=>{let{term:i,ids:n}=e;(0,m.SC)("album/autocomplete",{data:{object_id:this.values.get("object_id"),term:i,id:n||""}},t)},buttons:[{Render:e=>{let{item:t}=e;const[i,n]=(0,fi.b)({mediaStore:new yi.H({albumId:t.id,albumName:t.label})});return(0,x.BX)(x.HY,{children:[(0,x.tZ)(Fe.JO,{icon:"photos",toolTip:lng("manage album photos"),onClick:t.id?n:null}),i]})}}]},{type:"select",name:"options[max_photos]",label:lng("photos to display"),options:(0,a.w6)(wi.kj).map((e=>({val:e+1,label:""+(e+1)}))),emptyOption:!0,visible:()=>{var e;return 1===(null===(e=this.values.get("object_id"))||void 0===e?void 0:e.length)}},{type:"row_set",fields:[{type:"text",label:lng("new photo album name"),name:"new_album_name"},{type:"component",node:(0,x.tZ)(Gt.l,{onClick:()=>this.newAlbumName(this.values.get("new_album_name")),children:lng("create album")})}],visible:()=>{var e;return((null===(e=this.values.get("object_id"))||void 0===e?void 0:e.length)||0)<wi.kj}},{type:"component",node:(0,x.tZ)(l.A,{theme:"highlight",href:{list:"album"},target:"_blank",children:lng("edit all photo albums").caps()})}),this._prepFields(this.widgetStore),this.ready=!0}}const Ni={widget:Bi,form:Ti,widgetName:Ci,widgetDesc:Si,widgetDefaultTitle:Oi,store:xi};var Ii=i(9431),Di=i(4210),ji=i(3550),Pi=i(5007);function zi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ei extends u.r{constructor(){super(...arguments),zi(this,"newMenuOptions",this.mayEdit?[{label:lng("text/link"),onClick:()=>this.itemList_UpdateItem({itemType:"basic"})},{label:lng("shared content"),onClick:()=>this.itemList_UpdateItem({itemType:"content"})},{label:lng("assignment"),onClick:()=>this.itemList_UpdateItem({itemType:"assignment"})},this.portal_id&&{label:lng("sub page").caps(),onClick:()=>this.itemList_UpdateItem({itemType:"portal"})},{label:lng("user"),onClick:()=>this.itemList_UpdateItem({itemType:"user"})}]:void 0),zi(this,"onSortItemList",(e=>{let{new_order:t}=e;(0,m.SC)("content/item_list_order",{data:{id:this.object_id,new_order:t.join(",")},method:"POST"})}))}itemList_removeItem(e){(0,ii.BB)(lng("are you sure you want to delete this item?").caps(),{onConfirm:()=>{this.data.items=this.data.items.filter((t=>t!==e)),(0,m.SC)(`content/item_list_item/${e.item_id}&lesson_id=${this.object_id}&`,{method:"DELETE"})}})}itemList_UpdateItem(e){let{itemType:t,itemInfo:i}=e;const n=e=>{let{itemForm:n,res:r,item:s}=e,o=s||r;return o.item_type=t||i.item_type,o.object_id=n.values.get("object_id"),o.item_data=(null==s?void 0:s.item_data)||{title:"",text:"",url:"",newTab:"",poster:"",title_style:{color:""},text_style:{color:""},style:{"background-color":""}},o.item_data.title=n.values.get("item_data[title]"),o.item_data.text=n.values.get("item_data[text]"),o.item_data.url=n.values.get("item_data[url]"),o.item_data.can_message=n.values.get("item_data[can_message]"),o.item_data.can_chat=n.values.get("item_data[can_chat]"),o.item_data.current_window=n.values.get("item_data[current_window]"),o.item_data.hide_completed=n.values.get("item_data[hide_completed]"),o.item_data.poster=n.values.get("item_data[poster]"),o.item_data.title_style={color:n.values.get("item_data[title_style][color]")},o.item_data.text_style={color:n.values.get("item_data[text_style][color]")},o.item_data.style={"background-color":n.values.get("item_data[style][background-color]")},"basic"!==(null==i?void 0:i.item_type)&&(o.object_data=r.object_data),o},r=new Vi({itemType:t,itemInfo:i,widgetStore:this,onSaveSuccess:e=>{if(i){const t=[];this.data.items.map((s=>{s.item_id===i.item_id&&(s=n({itemForm:r,res:e,item:s})),t.push(s)})),this.data.items=t}else{const t=[...this.data.items];t.push(n({itemForm:r,res:e})),this.data.items=t}(0,Pi.vm)().closeDialog()}});(0,Pi.vm)().openDialog("form",r)}}function Ri(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Fi=lng("list"),Mi=lng("display links to content, assignment, sub-portal, custom url or a user");var Ai={name:"1boyrcs",styles:"margin-top:8px;line-height:normal;display:flex;>div{margin:2px;min-width:unset;}"};const qi=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:r,refLink:s}=t,c="buttons"===n.layout;if((0,a.xb)(i.items))return(0,x.tZ)(o.wf,{widgetStore:t,editForm:Xi});const p=e=>{var t;const{object_id:i,object_data:n,item_type:r}=e,o=s;switch(r){case"basic":return null===(t=e.item_data)||void 0===t?void 0:t.url;case"blog":return(0,l.p4)({blog:i,ref:o});case"content":return new Me.m(e.object_data,{refLink:s}).link;case"assignment":return(0,l.p4)({launcher:"assignment",id:i,ref:o});case"user":return(0,l.p4)({user:i});case"portal":return n.parent_id?(0,l.p4)({portal:n.parent_id,sub_id:n.portal_id,app:n.parent_type===Ii.Bu.APP}):(0,l.p4)({portal:n.portal_id,app:n.parent_type===Ii.Bu.APP});default:console.warn("unknown list item type",e)}},u=Ai,m=e=>{let{item_type:t,item_data:i,object_data:n}=e;return"user"===t?(0,x.BX)("div",{css:u,children:[(null==i?void 0:i.can_message)&&(0,x.tZ)(Gt.l,{theme:"contained",onClick:()=>(0,l.p4)({message:"new",params:{to:null==n?void 0:n.user_id}},!0),children:lng("send message").caps()}),(null==i?void 0:i.can_chat)&&window.bchat&&(0,x.tZ)(Gt.l,{theme:"outlined",onClick:()=>window.bchat.openChat(null==n?void 0:n.user_id),children:(0,x.tZ)(Fe.JO,{icon:"chat"})})]}):null},g=e=>{var i,n,r;let s=e.object_data||{},o=e.item_data||{},l=o.title||s.assignment_name||s.lesson_name||s.portal_title,u=c?void 0:(0,x.tZ)("div",{style:{color:null===(i=o.text_style)||void 0===i?void 0:i.color},children:o.text||(null!=s&&s.descriptionIsHtml?(0,a.s9)(null==s?void 0:s.lesson_description,70):null==s?void 0:s.lesson_description)});return"user"===e.item_type&&l&&(u=(0,x.BX)("div",{style:{display:"flex",flexDirection:"column",color:null===(n=o.text_style)||void 0===n?void 0:n.color},children:[(0,x.tZ)("div",{style:{fontWeight:600},children:s.full_name}),(0,x.tZ)("div",{children:u})]})),{href:p(e),newTab:!(0,a.P$)(o.current_window),title:l||s.full_name||"",titleColor:null===(r=o.title_style)||void 0===r?void 0:r.color,subTitle:u,condensed:!0,img:d.g.func.imgUrl(o.poster||s.poster),css:o.style&&(0,a.Tj)(o.style),className:"_item",menuOptions:t.mayEdit?[{label:lng("edit"),icon:"edit",onClick:()=>t.itemList_UpdateItem({itemInfo:e})},{label:lng("delete"),icon:"trash",onClick:()=>t.itemList_removeItem(e)}]:void 0,avatar:"user"!==e.item_type||o.poster||s.poster?null:s,avatarBalloon:!1,additionalBottom:m(e)}},h=i.items.map((e=>(0,x.tZ)($i,{buttonView:c,translucent:r.translucent,...g(e)},e.item_id)));return(0,x.tZ)(o.a9,{widgetStore:t,editForm:Xi,children:(0,x.tZ)("div",{css:c?(0,o.An)({widget:t}):(0,o.Kv)({borderless:r.borderless,condensed:!t.isDouble,columns:null==n?void 0:n.columns}),children:t.mayEdit?(0,x.tZ)(ji.b,{onSort:t.onSortItemList,children:h}):h})})}));class Xi extends o.sG{constructor(e){super({allow_fgc:!1,allow_hidden_no_data:!0,...e}),this.title=Fi,this._fields.unshift({type:"hidden",name:"object_id"},{type:"select",name:"options[layout]",label:lng("layout"),options:[{val:"",label:lng("list")},{val:"buttons",label:lng("icons")}]},{type:"select",name:"options[columns]",label:lng("columns"),options:[{val:"",label:"1"},{val:2,label:"2"},{val:3,label:"3"}],visible:e=>"buttons"!==e.get("options[layout]")}),this._prepFields(this.widgetStore),this.ready=!0}}const Li={widget:qi,form:Xi,widgetName:Fi,widgetDesc:Mi,store:Ei},$i=e=>{let{buttonView:t,...i}=e;const[n,r]=(0,Se.useState)(!1);let s;const o=(0,c.iv)("._actions{color:",d.g.colors.text_main,";position:absolute;top:0;",d.g.far,":0;}&:not(.hoverDelayed) ._actions{display:none;}","");return(0,x.tZ)("div",{css:o,className:(0,a.AK)({hoverDelayed:n}),onMouseEnter:()=>{r(!0),clearTimeout(s)},onMouseLeave:()=>{s=setTimeout((()=>r(!1)),200)},children:t?(0,x.tZ)(ue.S,{...i}):(0,x.tZ)(ue.o,{...i})})};class Vi extends Di.I{constructor(e){var t,i,n,r,s,o,l,c,d,p,u,g,h,b,v,_;let{...f}=e;super({using_strips:!0,...f}),Ri(this,"itemInfo",null),Ri(this,"isNew",void 0),Ri(this,"itemType",void 0),this.itemInfo=f.itemInfo||this.itemInfo,this.itemType=f.itemType||this.itemInfo.item_type,this.isNew=void 0===(null===(t=this.itemInfo)||void 0===t?void 0:t.item_id),this.widget=f.widgetStore;const{portal:y,object_id:w,options:x}=this.widget,k=(null===(i=this.itemInfo)||void 0===i||null===(n=i.object_data)||void 0===n?void 0:n.assignment_name)||(null===(r=this.itemInfo)||void 0===r||null===(s=r.object_data)||void 0===s?void 0:s.lesson_name)||(null===(o=this.itemInfo)||void 0===o||null===(l=o.object_data)||void 0===l?void 0:l.portal_title);this.setTitleAndSearchUrl(),this.saveUrl="content/item_list_item/&lesson_id="+w,this.successMessage=lng("preferences saved"),this._fields=[{type:"hidden",name:"item_type",value:this.itemType},{type:"hidden",name:"lesson_id",value:w},{type:"hidden",name:"item_id"},{type:"hidden",name:"order_id"},{type:"single_item",name:"object_id",label:null!==(c=this.itemInfo)&&void 0!==c&&c.item_id?lng("link to").caps():this.title,insert:["content","assignment","portal","user"].indexOf(this.itemType)>=0,required:!0,theme:"bright",disabled:void 0!==(null===(d=this.itemInfo)||void 0===d?void 0:d.object_data)&&!(null===(p=this.itemInfo)||void 0===p||!p.item_id),searchData:(e,t)=>{(0,m.SC)(this.searchUrl,{data:this.searchData(e,y)},t)}},{insert:"basic"===this.itemType||"user"===this.itemType||!this.isNew,type:"text",name:"item_data[title]",label:lng("title"),placeholder:k},{insert:"basic"===this.itemType||"user"===this.itemType||!this.isNew,type:"textarea",name:"item_data[text]",label:lng("description"),visible:()=>"buttons"!==(null==x?void 0:x.layout),placeholder:null!==(u=this.itemInfo)&&void 0!==u&&null!==(g=u.object_data)&&void 0!==g&&g.descriptionIsHtml?(0,a.s9)(null===(h=this.itemInfo)||void 0===h||null===(b=h.object_data)||void 0===b?void 0:b.lesson_description,70):null===(v=this.itemInfo)||void 0===v||null===(_=v.object_data)||void 0===_?void 0:_.lesson_description},{insert:"basic"===this.itemType,type:"text",name:"item_data[url]",label:lng("link"),placeholder:"https://..."},{insert:"assignment"===this.itemType,type:"checkbox",name:"item_data[hide_completed]",label:lng("hide after completion")},{insert:"user"===this.itemType&&window.bchat,type:"checkbox",name:"item_data[can_chat]",label:lng("show private chat button")},{insert:"user"===this.itemType,type:"checkbox",name:"item_data[can_message]",label:lng("show message button")},{type:"checkbox",name:"item_data[current_window]",reversed:!0,label:lng("open in a new window")},{type:"img",name:"item_data[poster]",label:lng("image"),title:lng("replace image"),tabs:["images","gallery"],removeButton:!0,insert:"basic"===this.itemType||"user"===this.itemType||!this.isNew},{type:"section",insert:"basic"===this.itemType||"user"===this.itemType||!this.isNew,title:lng("layout"),titleSmall:!0,fields:[{type:"color",name:"item_data[title_style][color]",label:lng("title color"),clear_button:!0},{type:"color",name:"item_data[text_style][color]",label:lng("text color"),clear_button:!0},{type:"color",name:"item_data[style][background-color]",label:lng("background color"),clear_button:!0}]}],this._prepFields(this.itemInfo),this.ready=!0}setTitleAndSearchUrl(){switch(this.itemInfo&&(this.title=lng("edit item")),this.searchData=e=>({term:e.term||" ",id:e.ids}),this.itemType){case"content":this.title=this.title||lng("select content"),this.searchUrl="search/content",this.searchData=e=>({term:e.term||" ",id:e.ids,idLabelPairs:1});break;case"assignment":this.title=this.title||lng("select assignment"),this.searchUrl="search/assignments",this.searchData=e=>({term:e.term||" ",id:e.ids,limit:20});break;case"portal":this.title=this.title||lng("select sub page"),this.searchUrl="search/portal",this.searchData=(e,t)=>({term:e.term||" ",id:e.ids,active:1,parent:(null==t?void 0:t.parent_id)||(null==t?void 0:t.portal_id),exclude:e.ids?"":null==t?void 0:t.portal_id});break;case"user":this.title=this.title||lng("select user"),this.searchUrl="search/users";break;default:this.title=this.title||lng("new item")}}save(e){this.saveToUrl(this.saveUrl,e)}}var Ui,Hi,Ji,Gi,Wi,Ki=i(619),Yi=i(8116);function Qi(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function en(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let tn=(Ui=class extends u.r{constructor(){super(...arguments),Qi(this,"events",Hi,this),Qi(this,"activeCalendarDate",Ji,this),Qi(this,"activeCalendarMonth",Gi,this),Qi(this,"defaultPreferences",Wi,this),(0,p.makeObservable)(this)}get monthEvents(){if(!this.activeCalendarMonth)return!1;const e=this.activeCalendarMonth.format("YYYY-MM");return this.events.has(e)||(this.events.set(e,!1),this._fetchMonthEvents(this.activeCalendarMonth)),this.events.get(e)}_fetchMonthEvents(e){const t=At.X.get("widget_calendar")||(null==this?void 0:this.defaultPreferences);(0,m.SC)("calendar/get_events",{data:{...t,public:1,group_member:1,mine:1,start:e.clone().startOf("month").unix(),end:e.clone().endOf("month").unix()}},(t=>{const i=e.format("YYYY-MM");this.events.set(i,t.map((e=>(0,Yi.aZ)(e,{displayWorkspace:!0,onClick:e=>this.setActiveComponent(e)}))))}))}setActiveComponent(e){(0,Pi.vm)().showSideDrawer(e,{tab:"",close:()=>this.setActiveComponent(null)})}},Hi=en(Ui.prototype,"events",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Ji=en(Ui.prototype,"activeCalendarDate",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,w.WQ)().startOf("day")}}),Gi=en(Ui.prototype,"activeCalendarMonth",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wi=en(Ui.prototype,"defaultPreferences",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{meetings:!0,workspace_events:!0,assignments:!0,courses:!0,group_manager:!0,managed_users_groups:!0,group_owner:!0,instructor:!0}}}),en(Ui.prototype,"monthEvents",[p.computed],Object.getOwnPropertyDescriptor(Ui.prototype,"monthEvents"),Ui.prototype),Ui);var nn=i(8534);const rn=lng("calendar"),sn=lng("display user's calender"),on=(0,s.observer)((function(e){var t;let{widget:i}=e;const{style:n}=i,r=!(null===(t=i.options)||void 0===t||!t.start_agenda),s=!!r||((0,a.tq)()?innerWidth<650:!i.isDouble),l=(0,c.iv)("background-color:transparent;border-radius:0;",(0,a.tq)()||i.isDouble?"":"max-width: calc(72px * 7)",";margin:auto;.headers[class]{&,& ._title,& .el_icon,& th{background-color:",n.bgc,";color:",n.fgc,";}}",i.isDouble&&!(0,a.tq)()&&`._events { overflow: auto; max-height: ${d.g.consts.WIDGET_BASE_HEIGHT-d.g.consts.WIDGET_PADDING_TOP}px;}`," ._list{color:",d.g.colors.text_main,";}._table{color:",n.fgc,";}","");return(0,x.tZ)(o.a9,{widgetStore:i,editForm:an,preferencesForm:ln,children:(0,x.tZ)(Ki.V,{css:l,activeDate:i.activeCalendarDate,onDateSelect:e=>i.activeCalendarDate=e,onMonthChange:e=>i.activeCalendarMonth=e,small:s,theme:"widget",events:i.monthEvents,monthNavigation:i.isDouble&&!r,defaultDayView:r})})}));class an extends o.sG{constructor(e){super({allow_title:!1,...e}),this.title=rn,this._fields.unshift({type:"select",name:"options[start_agenda]",label:lng("layout"),options:[{val:"",label:lng("calendar").caps()},{val:1,label:lng("daily agenda").caps()}]}),this._prepFields(this.widgetStore),this.ready=!0}}class ln extends Di.I{constructor(e){var t;let{...i}=e;super(i),this.widgetStore=i.widgetStore;const{data:n}=i.widgetStore;this.title=lng("preferences"),this.successMessage=lng("preferences saved"),this._fields=[{type:"checkbox",name:"meetings",label:lng("schedule",{phrase:!0})},{type:"indent_set",fields:[{type:"checkbox",value:!0,disable:()=>!0,disabled:!0,name:"fake",label:lng("meetings")},{type:"checkbox",name:"workspace_events",label:lng("events")}]},{type:"checkbox",name:"assignments",label:lng("assignments")},{type:"checkbox",name:"courses",label:lng("courses")},Blsm.user.perm.isGroupViewer&&{type:"checkbox",name:"group_manager",label:lng("managed workspaces")},Blsm.user.perm.isOuManager&&{type:"checkbox",name:"managed_users_groups",label:lng("managed user courses")},n.is_owner&&{type:"checkbox",name:"group_owner",label:lng("owned workspaces")},n.is_instructor&&{type:"checkbox",name:"instructor",label:lng("instructed meetings")}],this._prepFields(At.X.get("widget_calendar")||(null===(t=this.widgetStore)||void 0===t?void 0:t.defaultPreferences)),this.ready=!0}save(e){At.X.set("widget_calendar",e),this.widgetStore.defaultPreferences=e,this.widgetStore.events.clear(),this.setActiveSection(null),this.progress=null,this.status="success",this.successMessage&&(0,nn.qV)(this.successMessage),this.onSaveSuccess?this.onSaveSuccess(this.widgetStore):this.SaveSuccess(this.widgetStore)}}const cn={widget:on,form:an,widgetName:rn,widgetDesc:sn,store:tn,isAvailable:e=>"app"!==e&&"anonymous"!==e};var dn=i(656);i(7882);const pn=lng("qualification levels"),un=lng("display user's qualification paths"),mn=pn,gn=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,options:n,style:r}=t,s=(null==n?void 0:n.display)||"hierarchy",l=(0,c.iv)(r.borderless?"":`padding: 0 ${d.g.consts.WIDGET_PADDING_SIDE}px;`,";","");return(0,a.xb)(i)?(0,x.tZ)(o.wf,{widgetStore:t,editForm:yn}):(0,x.tZ)(o.a9,{widgetStore:t,editForm:yn,children:(0,x.BX)("div",{className:s,css:l,children:["dependencies"===s&&(0,x.tZ)(hn,{items:i}),"hierarchy"===s&&(0,x.tZ)(vn,{items:i})]})})})),hn=e=>{let{items:t}=e;const i=(0,c.iv)("._title{margin-bottom:10px;color:",d.g.colors.text_main,";font-weight:bold;}._items{margin-bottom:",d.g.consts.LIST_MARGIN_CONDENSED,"px;>*{margin-inline-start:",10,"px;margin-top:",d.g.consts.LIST_MARGIN_CONDENSED,"px;font-size:.9em;}}","");return(0,x.tZ)("div",{css:[i,d.g.classes.list,"",""],children:t.map(((e,t)=>{var i;return(0,x.BX)("div",{children:[(0,x.tZ)("span",{className:"_title",children:e.qual_top_name}),(0,x.tZ)("div",{className:"_items",children:null===(i=e.qual_list)||void 0===i?void 0:i.map(((e,t)=>(0,x.tZ)(bn,{data:e},t)))})]},t)}))})},bn=e=>{let{data:t}=e;const i=t.c_completed||t.has_perm,n=!i&&!t.user_id,r=n?"lock":i?"sign_ok":"empty",s=(0,c.iv)("","");return(0,x.BX)("div",{css:s,children:[(0,x.tZ)(Fe.JO,{icon:r,css:(0,c.iv)({marginInlineEnd:d.g.consts.ICON_MARGIN},"","")}),n?(0,x.tZ)("div",{children:t.group_name}):(0,x.tZ)(l.A,{theme:"hover",href:{workspace:t.group_id},children:t.group_name})]})},vn=e=>{let{items:t}=e;return t.map(((e,t)=>Array.isArray(e)?(0,x.tZ)(vn,{items:e},t):(0,x.tZ)(fn,{qualificationLevel:e},t)))};var _n={name:"je8g23",styles:"pointer-events:none"};const fn=e=>{let{qualificationLevel:t}=e;const{depth:i,group_id:n,group_name:r,is_manager:s,is_member:o,is_owner:p,parent:u,sons:m}=t,g=!(null!=m&&m.length),h=null===u,[b,v]=(0,Se.useState)(h),_=o||s||p,f=s||p?"manager":h||o?null:"lock",y=(0,x.tZ)(Fe.JO,{icon:"empty",buttonLike:!0,css:_n}),w=(0,c.iv)("user-select:none;margin-inline-start:",10*i,"px;.isTopLevel{._title{color:",d.g.colors.text_main,";font-weight:bold;}._items>*{font-size:.9em;}}._items{margin-bottom:",d.g.consts.LIST_MARGIN_CONDENSED,"px;>*{margin-inline-start:",10,"px;}}","");return(0,x.BX)("div",{css:w,className:(0,a.AK)({isTopLevel:h}),children:[(0,x.BX)("div",{className:"_title",children:[g?y:(0,x.tZ)(Fe.JO,{icon:b?"arrow_down":"arrow_far",buttonLike:!0,onClick:()=>v(!b)}),f&&(0,x.tZ)(Fe.JO,{icon:f,css:(0,c.iv)({marginInlineEnd:d.g.consts.ICON_MARGIN},"","")}),_?(0,x.tZ)(l.A,{theme:"hover",href:{workspace:n},children:r}):(0,x.tZ)("span",{children:r})]}),b&&!g&&(0,x.tZ)("div",{className:"_items",children:(0,x.tZ)(vn,{items:m})})]})};class yn extends o.sG{constructor(e){super({allow_double_box:!0,allow_hidden_no_data:!0,allow_fgc:!0,...e}),this.title=pn;const{editValues:t}=this.widgetStore,i=(t.classifications||[]).map((e=>({val:e.id,label:e.name}))),n=i.map((e=>e.val));(0,a.B5)(this.widgetStore.options.classifications)&&(this.widgetStore.options.classifications=[this.widgetStore.options.classifications]),this.widgetStore.options.classifications&&(this.widgetStore.options.classifications=[...new Set(this.widgetStore.options.classifications.filter((e=>n.includes(e))))]),this._fields.unshift({type:"select",name:"options[display]",label:lng("layout"),options:[{val:"hierarchy",label:lng("hierarchy").caps()},{val:"dependencies",label:lng("dependencies").caps()}]},{type:"select",name:"options[mode]",options:[{val:"qualification_role",label:lng("qualification role").caps()},{val:"classifications",label:lng("classifications").caps()}]},{type:"select_multi",label:lng("select classifications").caps(),name:"options[classifications]",options:i,visible:()=>"classifications"===this.values.get("options[mode]")}),this._prepFields(this.widgetStore),this.ready=!0}}const wn={widget:gn,form:yn,widgetName:pn,widgetDesc:un,widgetDefaultTitle:mn,isAvailable:e=>"app"!==e&&"anonymous"!==e&&Blsm.isFeatureEnabled("qualifications")},xn=lng("report list"),kn=lng("display saved, shared or recommended reports"),Zn=xn,Cn=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,style:n}=t;if(!Blsm.canAccessModule("Reports"))return null;if((0,a.xb)(i))return(0,x.tZ)(o.wf,{message:lng("nothing to show"),widgetStore:t,editForm:Sn});const r={recommended:[lng("recommended"),"bookmark"],shared:[lng("shared"),"share"],personal:[lng("personal"),"user"]},s=i.map((e=>(e.href=On(e),e.href?e:null))),c=s.length>5;return(0,x.tZ)(o.a9,{widgetStore:t,editForm:Sn,children:(0,x.BX)("div",{css:(0,o.Kv)({borderless:n.borderless,condensed:c}),children:[s.filter((e=>e)).map(((e,t)=>(0,x.tZ)(ue.o,{title:e.bookmark_name,icon:r[e.type][1],iconTooltip:r[e.type][0],href:(0,l.p4)(e.href),newTab:!0,condensed:c,translucent:n.translucent},t))),(0,x.tZ)(o.gm,{href:(0,l.p4)({reports:!0}),text:lng("additional reports"),widgetStore:t})]})})}));class Sn extends o.sG{constructor(e){super({allow_hidden_no_data:!0,allow_fgc:!1,using_strips:!0,...e}),this.title=xn,this._prepFields(this.widgetStore),this.ready=!0}}const On=e=>{try{if((e.shared||"shared"===e.type)&&e.bookmark_id)return{report:"bookmark",params:{bm_id:e.bookmark_id}};{let t=e.bookmark_url;return{report:t.report_name,params:t.parameters,bookmarkId:e.bookmark_id}}}catch(t){return console.warn("report list bad item: ",e,t),null}},Bn={widget:Cn,form:Sn,widgetName:xn,widgetDesc:kn,widgetDefaultTitle:Zn,isAvailable:e=>"app"!==e&&"anonymous"!==e&&Blsm.canAccessModule("Reports")},Tn=lng("challenges"),Nn=lng("display user's challenges"),In=Tn,Dn=(0,s.observer)((function(e){let{widget:t}=e;const{data:i,style:n}=t;return(0,a.xb)(i)?(0,x.tZ)(o.wf,{message:lng("no challenges to show"),widgetStore:t,editForm:jn,children:(0,x.tZ)(Gt.l,{href:{challenges:!0},theme:"outlined",children:lng("find new challenges").caps()})}):(0,x.tZ)(o.a9,{widgetStore:t,editForm:jn,children:(0,x.BX)("div",{css:(0,o.Kv)({borderless:n.borderless}),children:[i.map(((e,t)=>(0,x.tZ)(ue.o,{title:e.badge_name,href:(0,l.p4)({challenges:e.badge_id}),icon:e.icon,iconColor:e.color,subTitle:`${lng("due date").caps()} ${(0,a.ey)(e.badge_due_date,{time:!1})}`,condensed:!0,translucent:n.translucent},t))),(0,x.tZ)(Gt.l,{href:{challenges:!0},theme:"outlined",children:lng("find new challenges").caps()})]})})}));class jn extends o.sG{constructor(e){super({allow_double_box:!1,allow_hidden_no_data:!0,using_strips:!0,...e}),this.title=Tn,this._prepFields(this.widgetStore),this.ready=!0}}const Pn={widget:Dn,form:jn,widgetName:Tn,widgetDesc:Nn,widgetDefaultTitle:In,isAvailable:e=>"anonymous"!==e},zn={album:Ni,approvals:_e,assignments:de,birthdays:r.ZP,blog:Ce,calendar:cn,challenges:Pn,courses:pi,group_report:E,groups:Ht,exevents:ti,iframe:X,image:vi,item_list:Li,messages:ze,news:dn.ZP,phonebook:Tt,qualification_levels:wn,report_list:Bn,rss:T,scores:Ft,shared_content:We,tasks:at,text:G,weather:ie,your_profile:vt};for(const e in zn)zn[e].store||(zn[e].store=u.r),zn[e].widgetDesc||(zn[e].widgetDesc="");const En=zn,Rn=e=>{const t={external:{label:lng("external sources"),color:d.g.colors.set[1],widgets:["iframe","rss","weather"]},photos:{label:lng("photos"),color:d.g.colors.set[2],widgets:["album","image"]},system:{label:lng("system"),color:d.g.colors.set[6],widgets:["approvals","assignments","calendar","scores","shared_content","tasks","report_list"]},text_links:{label:lng("text & links"),color:d.g.colors.set[8],widgets:["item_list","news","text"]},users:{label:lng("users"),color:d.g.colors.set[10],widgets:["birthdays","phonebook","your_profile"]},social:{label:lng("social"),color:d.g.colors.set[13],widgets:["blog","messages","challenges"]},workspaces:{label:lng("workspaces"),color:d.g.colors.set[15],widgets:["courses","groups","qualification_levels","group_report","exevents"]}},i=e=>{for(const[i,{widgets:n}]of Object.entries(t))if(n.includes(e))return i;return"system"},n=[];return Object.entries(zn).map((t=>{let[r,s]=t;e.mayAddWidgetToPortal(Object.assign(s,{widget_type:r}))&&n.push({type:r,topic:i(r),typeLabel:s.widgetName,text:s.widgetDesc})})),n.sort(((e,t)=>e.topic.localeCompare(t.topic))),{types:n,topics:t,title:lng("add widget"),onSelect:t=>{const i=e.createEmptyWidget(t);(0,Pi.vm)().openDialog("form",new zn[t].form({widgetStore:i,onSaveSuccess:t=>{(0,Pi.vm)().closeDialog(),i.updateData(t),e.addWidget(i)}}))}}}},656:(e,t,i)=>{i.d(t,{ZP:()=>P,tp:()=>j});var n,r=i(5560),s=i(4877),o=i(8318),a=i(441),l=i(5875),c=i(6920),d=i(9180),p=i(2517),u=i(7821);function m(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let g=(n=class extends p.r{constructor(){super(...arguments),m(this,"newMenuOptions",this.mayEdit?[{label:lng("edit news list"),onClick:()=>(0,a.p4)({list:"news_items",params:`t=widget&id=${this.widget_id}`},!0)},Blsm.hasPermission("portal_manager")&&{label:lng("edit the global news list"),onClick:()=>(0,a.p4)({list:"news_items",params:`t=domain&id=${this.domain_id}`},!0)}]:void 0)}get items(){const e=this.options;return this.data.items.map((t=>{const i={...t};i.tags=[];const n=parseInt(i.created);if(e.newer){const t=(0,o.c7)()-e.newer*o.s2;i.markNew=t<n}if(e.show_date){const t=n<(0,o.c7)()-31*o.s2;i.show_date=(0,o.P$)(e.show_date),i.show_time=(0,o.P$)(e.show_time)&&!t,this.isDouble?(i.bigTime=!0,i.highlightFirstTag=!1):(i.tags[0]=(0,o.ey)(i.created,{time:i.show_time,date:i.show_date,hideMidnight:!0,relative:!0}),i.highlightFirstTag=!0)}return e.show_tags&&!(0,o.xb)(t.tags)&&i.tags.push(...t.tags),i}))}},h=n.prototype,b="items",v=[u.computed],_=Object.getOwnPropertyDescriptor(n.prototype,"items"),f=n.prototype,y={},Object.keys(_).forEach((function(e){y[e]=_[e]})),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=v.slice().reverse().reduce((function(e,t){return t(h,b,e)||e}),y),f&&void 0!==y.initializer&&(y.value=y.initializer?y.initializer.call(f):void 0,y.initializer=void 0),void 0===y.initializer&&(Object.defineProperty(h,b,y),y=null),n);var h,b,v,_,f,y,w=i(917),x=i(8567),k=i(6975),Z=i(1619),C=i(5944);const S=lng("news"),O=lng("post internal updates and news items");var B={name:"zlj7mt",styles:"border:none;padding:3px"};const T=(0,r.observer)((function(e){let{widget:t}=e;const{options:i,style:n,items:r}=t,a=i.auto_scroll&&r.length>4&&!(0,o.tq)();if((0,o.xb)(r))return(0,C.tZ)(s.wf,{widgetStore:t,editForm:D});const p=r.length>5;return(0,C.BX)(s.a9,{widgetStore:t,editForm:D,scrolling:a,children:[(0,C.tZ)("div",{css:(0,s.Kv)({borderless:n.borderless,condensed:p}),children:(0,C.tZ)(s.PS,{widget:t,itemsToShow:r,liRenderer:e=>{let{item:i}=e;return(0,C.tZ)(l.o,{css:B,title:i.title,onClick:()=>j({item:i,widget:t}),newTab:"auto",subTitle:(0,C.tZ)(Z.xn,{content:i.content}),icon:i.markNew?"sparkles":void 0,iconColor:c.g.colors.dominant_orange,iconTooltip:lng("new|mark new content"),tags:i.tags,highlightFirstTag:i.highlightFirstTag,condensed:p,translucent:n.translucent,children:i.bigTime&&(0,C.tZ)(d.qp,{time:i.created,showDate:i.show_date,showTime:i.show_time,hideMidnight:!0,relative:!0})},i.news_id)},itemIdSelector:"news_id"})}),(0,C.tZ)(s.gm,{widgetStore:t})]})})),N=(0,w.iv)("display:flex;flex-direction:column;*{padding:5px;}.title{font-size:1.5em;font-weight:600;color:",c.g.colors.text_main,";}.date{font-size:.9em;color:",c.g.colors.text_sec,";}.content{word-wrap:break-word;&._is_rtl{direction:rtl;text-align:right;}}",""),I=(0,r.observer)((e=>{let{title:t,created:i,content:n,url:r,showDate:s}=e;return(0,C.BX)("div",{css:N,children:[(0,C.tZ)("div",{className:"title",children:t}),s&&(0,C.tZ)("div",{className:"date",children:(0,C.tZ)(d.qp,{time:i,showDate:!0,hideMidnight:!0,relative:!0})}),(0,C.tZ)(Z.xn,{content:n}),r&&(0,C.BX)(a.A,{theme:"highlight",href:r,children:[(0,C.tZ)(k.JO,{icon:"link"}),r]})]})}));class D extends s.sG{constructor(e){super({allow_limit:!0,allow_hidden_no_data:!0,has_show_more:!0,using_strips:!0,...e}),this.title=S,this._fields.unshift({type:"hidden",name:"object_id"},{type:"checkbox",name:"options[list_domain]",label:lng("show news items from the global list"),insert:Blsm.hasPermission("portal_manager")},{type:"indent_set",visible:e=>e.get("options[list_domain]"),insert:Blsm.hasPermission("portal_manager"),fields:[{type:"tags",name:"tags",label:lng("filter by tags"),objectType:"News"}]},{type:"number",min:0,max:99,name:"options[newer]",label:lng("mark as new when newer than %s days").split("%s")[0],unit:lng("mark as new when newer than %s days").split("%s")[1]},{type:"checkbox",name:"options[show_date]",label:lng("show date")},{type:"checkbox",name:"options[show_time]",label:lng("show time"),visible:()=>(0,o.P$)(this.values.get("options[show_date]"))},{type:"checkbox",name:"options[show_tags]",label:lng("show tags")},{type:"number",min:0,max:99,name:"options[days]",label:lng("include last %s days").split("%s")[0],unit:lng("include last %s days").split("%s")[1]}),this._prepFields(this.widgetStore),this.ready=!0}}const j=e=>{let{item:t,widget:i}=e;(0,x.qR)((0,C.tZ)(I,{...t}),{title:(null==i?void 0:i.title)||t.widget_title})},P={widget:T,form:D,widgetName:S,widgetDesc:O,store:g}},435:(e,t,i)=>{i.d(t,{Z:()=>d,q:()=>p});var n=i(6421),r=i(6975),s=i(6920),o=i(7363),a=i(6344),l=(i(7882),i(5944));const c={name:"1ea8zt0",styles:"display:flex;flex-direction:column;margin-top:40px;.inputs{display:flex;justify-content:space-between;width:100%;>div{width:45%;}}.icons-display{font-size:2em;margin:50px auto 0;display:flex;.Icon{padding:0 8px;}}"},d=e=>{let{onChange:t,value:i={}}=e;const{icon:r="bookmark",scale:s=5,preview:a}=i,d=[{val:"bookmark",label:lng("stars")},{val:"love",label:lng("hearts")},{val:"tomato",label:lng("tomatoes")},{val:"smiley",label:lng("smiles")}],[u,m]=(0,o.useState)(r),[g,h]=(0,o.useState)(s),b=["smiley"].includes(u)?"highlight":"default";return(0,l.BX)("div",{css:c,className:"rating-display",children:[(0,l.BX)("div",{className:"inputs",children:[(0,l.tZ)(n.I,{type:"select",name:"rating[icon]",value:u,options:d,onChange:e=>(m(e),t("rating[icon]",e))}),(0,l.tZ)(n.I,{type:"select",name:"rating[scale]",value:g,options:[3,5].map((e=>({val:e,label:lng("from 1 to %i",e)}))),onChange:e=>(h(e),t("rating[scale]",e))})]}),(0,l.tZ)(p,{icon:u,scale:g,colorTheme:"highlight"===b,selection:"highlight"===b?"single":"drag",preview:a})]})},p=e=>{let{icon:t="bookmark",rating:i=0,scale:n=5,onSelect:c,colorTheme:d=!1,selection:p="drag",preview:m=!1}=e;const[g,h]=(0,o.useState)(0),[b,v]=(0,o.useState)(parseInt(i||0)),_=u({icon:t,scale:n}),f=[s.g.colors.negative_bg,s.g.colors.negative,s.g.colors.yellow,s.g.colors.bright_green,s.g.colors.positive],y=(e,t)=>{const i=t+1;let r=e.color;return d&&(r=f[Math.ceil(5*t/n)]),"single"===p?g===i||b===i&&!g?r:(0,a.mR)(r,.3):g>=i||b>=i&&!g?r:s.g.colors.text_main},w=(e,t)=>{const i=t+1;return"drag"===p?g>=i||!g&&b>=i?e.alt:e.val:g===i||b===i&&!g?e.alt:e.val};return(0,l.tZ)("div",{className:"icons-display",children:_.map(((e,t)=>(0,l.tZ)(r.JO,{color:y(e,t),onMouseLeave:()=>h(0),onMouseEnter:()=>h(t+1),onClick:()=>(!m&&null!=c&&c(t+1),v(t+1)),icon:w(e,t)},t)))})},u=e=>{let{icon:t,scale:i=5}=e;const n=[{val:"face_frown",alt:"face_frown_full",color:s.g.colors.positive},{val:"face_frown_slight",alt:"face_frown_slight_full",color:s.g.colors.positive},{val:"face_meh",alt:"face_meh_full",color:s.g.colors.positive},{val:"face_smile",alt:"face_smile_full",color:s.g.colors.positive},{val:"face_smile_beam",alt:"face_smile_beam_full",color:s.g.colors.positive}],r={bookmark:{val:"bookmark",alt:"bookmark_filled",color:s.g.colors.yellow},love:{val:"love",alt:"love_full",color:s.g.colors.pink},tomato:{val:"tomato",alt:"tomato_full",color:s.g.colors.negative}};switch(t){case"bookmark":case"love":case"tomato":return Array.from(Array(i)).map((()=>r[t]));case"smiley":return(3===i?[0,2,4]:[0,1,2,3,4]).map((e=>n[e]))}}},3634:(e,t,i)=>{i.d(t,{S:()=>_});var n=i(917),r=i(6920),s=i(81),o=i(8e3),a=i(539),l=i(3755),c=i(7392),d=i(5007),p=i(8318),u=i(9483),m=i(6421),g=(i(7882),i(435)),h=i(7363),b=i(5944);const v=(0,n.iv)(".footer{width:100%;position:relative;font-size:1.2em;padding:15px;height:60px;display:flex;justify-content:space-between;border-radius:0 0 8px 8px;color:",r.g.colors.text_main,";background-color:white;align-items:center;}",""),_=e=>{var t,i,n;let{ws:p,options:u={},preview:m}=e;const g=p.rating,{objectId:_,type:f}=u,w=p.meetings.filter((e=>e._attr.completed)),{id:x,icon:k,scale:Z,info:C,apply_to_managers:S}=g,O=g.name||(null===(t=g.default)||void 0===t?void 0:t.name),B=(null==C?void 0:C.opening_text)||(null===(i=g.default)||void 0===i?void 0:i.opening_text)||!1,T=(null==C?void 0:C.closing_text)||(null===(n=g.default)||void 0===n?void 0:n.closing_text)||!1,[N,I]=(0,h.useState)(m?p.previewRating:null),[D,j]=(0,h.useState)(0);if((0,s.iP)(),N||m||(0,o.SC)("ratings/load_rating_survey",{data:{id:x,type:f,group_id:p.group_id}},(e=>I(e))),!N)return(0,b.tZ)(a.$,{});const P=("meeting"===f||w.length>0&&!f)&&("instructor"===f||w.some((e=>e.instructors&&e.instructors.some((e=>e.user_id))))),z={};P&&w.forEach((e=>{var t;return null===(t=e.instructors)||void 0===t?void 0:t.forEach((e=>!!e.user_id&&(z[e.user_id]=e.full_name)))})),S&&p.managers&&!f&&p.managers.forEach((e=>z[e.user_id]=e.full_name));const{r_id:E,questions:R,answers:F}=N,M=[R.workspace&&"workspace",R.instructor&&"instructor",R.meeting&&"meeting"].filter((e=>e));f||(T&&M.push("closing"),B&&M.unshift("opening"));const A=[];M.forEach((e=>{switch(e){case"opening":A.push({type:"text",text:B||g.default.opening_text,title:lng("welcome")});break;case"closing":A.push({type:"text",text:T||g.default.closing_text,title:lng("goodbye")});break;case"workspace":return R.workspace.forEach((e=>e.answer=null==F?void 0:F.find((t=>t.rq_id===e.rq_id)))),A.push({group_type:p.group_type,sId:"workspace",type:"questions",r_id:E,id:p.group_id,title:p.group_name,questions:R.workspace});case"instructor":Object.keys(z).map((e=>{const t=z[e],i=[...R.instructor].map((t=>Object.assign({answer:null==F?void 0:F.find((i=>i.rq_id==t.rq_id&&i.instructor_id==e))},t)));return A.push({sId:"instructor",type:"questions",r_id:E,id:e,title:t,questions:i})}));break;case"meeting":w.filter((e=>_?e.id===_:e)).forEach((e=>{const{id:t,title:i}=e,n=[...R.meeting].map((e=>Object.assign({answer:null==F?void 0:F.find((i=>i.rq_id==e.rq_id&&i.meeting_id==t))},e)));return A.push({sId:"meeting",type:"questions",r_id:E,id:t,title:i,questions:n})}))}}));const q=A.filter((e=>"questions"===e.type)).length,X=A.findIndex((e=>"questions"===e.type)),L=D>=X?D-X:0,$=A.filter((e=>"questions"===e.type)).length>1;return(0,b.BX)("div",{css:v,children:[$&&(0,b.tZ)(l.k,{padded:!1,numerator:L,valueInBar:!0,denominator:q,colorByVal:!0,topLabels:!1,rounded:!1}),(0,b.tZ)("div",{className:"cards",children:A.map(((e,t)=>(0,b.tZ)(y,{active:t===D,preview:m,groupId:p.group_id,card:e,icon:k,scale:Z,title:O},"text"===e.type?e.text:e.id)))}),(0,b.BX)("div",{className:"footer",children:[1===A.length||0===D?(0,b.tZ)("div",{}):(0,b.tZ)("div",{children:(0,b.tZ)(c.l,{style:{color:r.g.colors.blossom,border:"2px solid "+r.g.colors.blossom},bold:!0,onClick:()=>j(0===D?0:D-1),theme:"outlined",children:lng("back").caps()})}),$&&(0,b.BX)("div",{style:{color:r.g.colors.blossom},children:[D+1,"/",A.length]}),(0,b.tZ)("div",{children:(0,b.tZ)(c.l,{style:{backgroundColor:r.g.colors.blossom,border:"2px solid "+r.g.colors.blossom},bold:!0,onClick:()=>D===A.length-1?(0,d.vm)().closeDialog():j(D===A.length-1?0:D+1),theme:"contained",children:D===A.length-1||1===A.length?lng("finish").caps():lng("next").caps()})})]})]})},f=(0,n.iv)("display:none;flex-direction:column;justify-content:space-between;margin:0 auto;background-image:",`url(${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/rating_survey_bg.jpg)`,";border-radius:8px;background-position:center;background-repeat:no-repeat;background-size:cover;",r.g.mQuery.notMobile,"{background-color:",r.g.colors.bg_main,";}&.active{display:flex;}.title{color:",r.g.colors.text_main,";font-size:2em;font-weight:600;display:flex;padding:10px;height:60px;border-radius:8px 8px 0 0;",r.g.mQuery.mobile,"{border-radius:0;}}.body{position:relative;display:flex;border-radius:8px 8px 0 0;min-height:50vh;box-shadow:rgba(0, 0, 0, 0.3) 0 0 5px;flex-direction:column;max-height:calc(100vh - 330px);width:100%;margin:0 auto;",r.g.mQuery.notMobile,"{width:75%;margin:40px auto;background-color:",r.g.colors.bg_main,";}.title{height:60px;display:flex;font-size:1.7em;font-weight:700;align-items:center;padding:10px 40px;color:",r.g.colors.bg_main,";background-color:",r.g.colors.purple,";}.text-card{margin:40px;padding:10px;white-space:break-spaces;background-color:",r.g.colors.bg_main,";border-radius:8px;",r.g.mQuery.mobile,"{box-shadow:rgba(0, 0, 0, 0.3) 0 0 5px;}}.questions{width:100%;max-height:500px;overflow-y:scroll;color:",r.g.colors.text_main,";",r.g.mQuery.notMobile,"{background-color:",r.g.colors.bg_main,";}}}",""),y=e=>{let{active:t,card:i,preview:n,scale:r,icon:s,groupId:o}=e;const{id:a,sId:l,questions:c,r_id:d,type:m,title:g}=i,h="workspace"===l?`${lng("rate this")} ${i.group_type.caps()}`:"meeting"===l||"instructor"===l?`${lng("rate the %s",i.sId.caps())}`:"",v=`${h}${h&&": "}${g}`;return(0,b.tZ)("div",{css:f,className:(0,p.AK)({active:t}),children:(0,b.BX)("div",{className:"body",children:[(0,b.tZ)(u.m,{keepAlign:!0,children:(0,b.tZ)("div",{className:"title",children:v.caps()})}),"text"===m&&(0,b.tZ)("div",{className:"text-card",dangerouslySetInnerHTML:{__html:i.text}}),"questions"===m&&(0,b.tZ)("div",{className:"questions",children:c.map((e=>(0,b.tZ)(x,{preview:n,groupId:o,objectId:a,ratingId:d,icon:s,scale:r,question:e},`${e.rq_id}_${a}`)))})]})})},w=(0,n.iv)("width:93%;display:flex;max-width:93%;text-align:start;margin:25px auto;padding:15px 20px;border-radius:8px;flex-direction:column;white-space:break-spaces;justify-content:space-evenly;box-shadow:rgba(0, 0, 0, 0.3) 0 0 5px;background-color:",r.g.colors.bg_main,";.icons{display:flex;flex-wrap:wrap;margin-top:30px;font-weight:600;align-items:center;justify-content:space-between;.icons-display{flex-grow:1;display:flex;font-size:3em;.Icon{padding:0 8px;}",r.g.mQuery.mobile,"{font-size:2em;}}.explanation-button{",r.g.mQuery.mobile,"{display:block;width:100%;margin:25px 0 10px;>div{width:100%;}}}}.explanation{margin-top:25px;}",""),x=e=>{let{question:t,icon:i,scale:n,ratingId:r,objectId:s,groupId:a,preview:l}=e;const{answer:d,rq_id:p,text:u,type:v}=t,[_,f]=(0,h.useState)((null==d?void 0:d.rating)||0),[y,x]=(0,h.useState)((null==d?void 0:d.text)||""),[k,Z]=(0,h.useState)(!!y),C=["smiley"].includes(i)?"highlight":"default",S=e=>{if(l)return;const t=e||_;(0,o.SC)("ratings/submit_rating_answer",{method:"POST",data:{rating:t,explanation:y,r_id:r,rq_id:p,group_id:a,object_id:s,type:v}},(()=>f(t)))};return(0,b.BX)("div",{css:w,children:[(0,b.tZ)("div",{className:"question",children:u}),(0,b.BX)("div",{className:"icons",children:[(0,b.tZ)("div",{}),(0,b.tZ)(g.q,{icon:i,rating:_,scale:n,onSelect:e=>S(e),colorTheme:"highlight"===C,selection:"highlight"===C?"single":"drag",preview:l}),!k&&(0,b.tZ)("div",{className:"explanation-button",children:(0,b.tZ)(c.l,{onClick:()=>Z(!k),theme:"contained",children:lng("write comment").caps()})})]}),k&&(0,b.tZ)("div",{className:"explanation",children:(0,b.tZ)(m.I,{placeholder:lng("enter explanation to your rating (optional)"),onBlur:()=>S(),type:"text",wrapped:!0,value:y,onChange:e=>x(e)})})]})}},247:(e,t,i)=>{i.d(t,{yy:()=>W,St:()=>te,PX:()=>Q,om:()=>H,rZ:()=>K});var n=i(917),r=i(6920),s=i(7154),o=i(6975),a=i(5560),l=i(81),c=i(8411),d=i(539),p=i(9234),u=i(7392),m=i(8318),g=i(1092),h=i(2883),b=i(7137),v=i(676),_=i(7363),f=i(8207),y=i(1137),w=i(4902),x=i(3051),k=i(6421),Z=i(7371),C=i(2334),S=i(5761),O=i(6344),B=i(441),T=i(9637),N=i(5680),I=i(236),D=i(6852),j=i(5967),P=(i(7882),i(7693)),z=i(1766),E=i(3550),R=i(5875),F=i(5944);const M={name:"zg786d",styles:"max-width:fit-content;padding:0px 10px"},A=(0,n.iv)(r.g.mQuery.notMobile,"{height:",r.g.consts.WIDGET_BASE_HEIGHT+50,"px;}",""),q=(e,t)=>(0,n.iv)("display:flex;flex-direction:row;flex-wrap:wrap;height:100%;justify-content:space-around;>.chart-item{display:flex;flex-direction:column;align-items:center;>.chart-title{text-align:center;white-space:nowrap;font-size:1.2em;padding:6px;}>.chart-chart{height:",2!=t?"100%":"70%",";max-width:",2==t?"300px":"200px",";}}",""),X=function(e){let{bookmark_name:t,bookmark_url:i,widget_options:r,dashboard_data:s,activeTab:o,bookmark_id:a,menuOptions:l,tags:c}=e;const d=s.graphs[0];let p,u;if(i&&(p={report:i.report_name,params:i.parameters||{}},"personal"!==o&&"recommended"!==o||(p.bookmarkId=a)),r=(0,m.Mo)(r,{}),null!=d&&d.statistics){u={};const e=d.statistics.numbers?d.statistics:d.values;u.numbers=e.map((e=>{let{label:t,color:i,data:n,percent:r}=e;return{label:t,color:(0,D.J)(i),number:n,percent:r}})),(0,m.Kn)(d.statistics)&&Object.assign(u,d.statistics)}const g=1===s.graphs.length?s.graphs[0]:void 0,h=parseInt(r.widget_size)||void 0;return(0,F.BX)(I.$L,{title:t,subtitle:z.Ux[s.report_name],link:p,size:h,menuOptions:l,css:A,children:[s.graph_partial_data?(0,F.tZ)("div",{children:(0,F.tZ)(P.M,{title:lng("graph unavailable"),subTitle:lng("graph loading time exceeds threshold"),icon:"broken_graph",buttons:[{click:()=>(0,B.p4)(p,!0),label:lng("enter the detailed report")}]})}):(0,F.BX)("div",{css:(b=!(0,m.xb)(c),(0,n.iv)("display:flex;flex-direction:column;height:",b?"80%":"100%",";._chart{flex-grow:1;padding:0 10px 10px;}","")),children:[(0,F.tZ)("div",{className:"_chart",children:s.graphs.length>0?g?(0,F.tZ)(D.k,{type:g.type,data:g.values||g.data,height:"100%",width:"100%",legend:!u,dataLabel:!0,scaleLabels:null==g?void 0:g.scale_labels}):(0,F.tZ)("div",{css:q(s.graphs.length,h),children:s.graphs.map(((e,t)=>(0,F.BX)("div",{className:"chart-item",children:[(0,F.tZ)("div",{className:"chart-title",children:null==e?void 0:e.display_label}),(0,F.tZ)("div",{className:"chart-chart",children:(0,F.tZ)(D.k,{type:e.type,data:e.values||e.data,height:"100%",width:"100%",legend:!u,dataLabel:!0,scaleLabels:null==e?void 0:e.scale_labels},t)})]},t)))}):lng("no data")}),u&&(0,F.tZ)(j.Q,{children:u.numbers.filter((e=>{let{statistics:t,label:i}=e;return i&&!1!==t})).map(((e,t)=>{let{color:i,label:n,date:r,number:s,percent:o}=e;return(0,F.tZ)(j.t,{numerator:r?(0,C.GG)(s,{time:!1}):(0,m.Rn)(s,2,o?"%":""),label:n,color:(0,D.J)(i)},t)}))})]}),!(0,m.xb)(c)&&(0,F.tZ)("div",{css:M,children:(0,F.tZ)(N.r$,{className:"dashboard-widget-tags",children:null==c?void 0:c.map((e=>(0,F.tZ)(N.Vp,{tag:e,smaller:!0},e)))})})]});var b},L={name:"12tmrid",styles:"display:flex;flex-direction:column;padding:5px;>*{margin:0 0 5px 0;}"},$=e=>{let{reports:t=[],activeTab:i}=e;function n(e){const t=e.bookmark_url,n={report:t.report_name,params:t.parameters};return("personal"===i||"recommended"===i&&Blsm.user.isPowerManager)&&(n.bookmarkId=e.bookmark_id),n}return(0,F.tZ)(I.$L,{title:lng("report list"),dragHandle:!1,children:(0,F.tZ)(E.y.Provider,{value:void 0,children:(0,F.tZ)("div",{css:L,children:t.map((e=>(0,F.tZ)(R.o,{title:e.bookmark_name,href:n(e)},e.bookmark_id)))})})})};var V=i(493);const U={name:"em0udc",styles:"width:calc(100% + 30px);.row{display:flex;justify-content:space-between;height:42px;font-size:0.9em;}.bottom{height:15px;}"},H=e=>{let{scores:t,last:i}=e;return(0,F.BX)("div",{css:U,children:[(0,F.tZ)("div",{className:"row",children:null==t?void 0:t.map(((e,t)=>(0,F.tZ)(G,{...e,fixedLength:2},t)))}),(0,F.tZ)("div",{className:"bottom",children:(null==i?void 0:i.val)>0&&(0,F.tZ)(G,{...i,oneRow:!0},"last")})]})},J=(e,t)=>(0,n.iv)("padding:2px;color:",t&&e,";text-align:center;.info{color:",e,";font-size:14px;}.label{font-size:.9em;",r.g.classes.margin_near("3px"),";.twoRows{color:",r.g.colors.text_light_disabled,";",r.g.classes.margin_near("0"),";}}.sub{padding:2px;font-size:10px;}",""),G=e=>{let{val:t,label:i,color:n,icon:r,sub:a,oneRow:l,fixedLength:c}=e;const d=e=>(0,m.kE)(e)?(Math.round(100*e)/100).toFixed(c):"---";return(0,F.BX)("div",{css:J(n,l),children:[(0,F.tZ)(s.u,{text:i,children:(0,F.BX)("span",{className:l?"":"info",children:[(0,F.tZ)(o.JO,{icon:r,color:n})," ",d(t)]})}),(null==a?void 0:a.val)>0&&(0,F.tZ)("span",{className:"sub",children:(0,F.BX)(s.u,{text:a.label,children:["(",d(a.val),")"]})}),!l&&(0,F.tZ)("br",{}),(0,F.tZ)("span",{className:(0,m.AK)("label",{twoRows:!l}),children:i})]})},W=(0,a.observer)((function(e){let{dashboardsStore:t}=e;const{activeDashboard:i,dashboardData:n,moreAvailable:r,loadingMore:s,getMore:o}=t,{filtersVals:a,setFilterVals:m,sort:g,setSort:h}=(0,l.qD)(t.assignmentsFilters),b=[{name:"assignment_name",label:lng("name"),type:"text",outOfMenu:!0,wrapped:!0},{name:"lesson_description",label:lng("description"),type:"text"}],v=[{val:"",label:lng("default")},{val:"assignment_name",label:lng("name")},{val:"due_date",label:lng("date")}];return(0,F.BX)(F.HY,{children:[(0,F.tZ)(c.CX,{filters:b,filtersVals:a,onFilter:m,sorts:v,sort:g,onSort:h,collection:"loading"===n?[]:n}),"loading"===n?(0,F.tZ)(d.$,{}):(0,F.BX)("div",{children:[(0,F.tZ)(p.TY,{workspaces:n,page:"dashboard",activeTab:i}),r&&(s?(0,F.tZ)(d.$,{}):(0,F.tZ)(u.l,{onClick:o,style:{display:"block"},children:lng("more").caps()+"..."}))]})]})})),K=(0,a.observer)((function(e){let{dashboardsStore:t}=e;const{activeDashboard:i,dashboardData:n}=t,{filtersVals:r,setFilterVals:s,sort:o,setSort:a}=(0,l.qD)(t.groupsFilters),u=[{name:"group_name",label:lng("name"),type:"text",outOfMenu:!0,wrapped:!0},{name:"classification_name",label:lng("classification"),type:"text"}],m=[{val:"",label:lng("default")},{val:"group_name",label:lng("name")},{val:"classification_name",label:lng("classification")},{val:"group_type",label:lng("type")}];return(0,F.BX)(F.HY,{children:[(0,F.tZ)(c.CX,{filters:u,filtersVals:r,onFilter:s,sorts:m,sort:o,onSort:a,collection:"loading"===n?[]:n}),"loading"===n?(0,F.tZ)(d.$,{}):(0,F.tZ)("div",{children:(0,F.tZ)(p.TY,{workspaces:n,page:"dashboard",activeTab:i})})]})}));var Y={name:"1a0f7sg",styles:".tags_wrapper{padding:10px;margin-bottom:10px;}"};const Q=(0,a.observer)((function(e){let{dashboardsStore:t}=e;const{activeDashboard:i,dashboardData:n,sortBookmark:r,editable:s,getTags:o,selectedTags:a,clearTagSelection:d,toggleTagSelection:p,removeTag:u,searchTagRelation:g,setSearchTagRelation:h}=t,{filtersVals:b,setFilterVals:v}=(0,l.qD)(t[i+"Filters"]),_=n.filter((e=>{var t,i;return(null==e||null===(t=e.dashboard_data)||void 0===t||null===(i=t.graphs)||void 0===i?void 0:i.length)>0})),f=n.filter((e=>{var t,i;return!(null!=e&&null!==(t=e.dashboard_data)&&void 0!==t&&null!==(i=t.graphs)&&void 0!==i&&i.length)})),y=o(!0),w=o(),x=!(0,m.xb)(y)||!(0,m.xb)(w),k=[{val:"AND",label:lng("all the tags")},{val:"OR",label:lng("one of the tags")}],Z=Y,C=[{type:"select_multi",name:"tags",outOfMenu:!0,wrapped:!0,label:lng("tags"),emptyLabel:lng("select tags to filter"),staticLabel:!0,showSearch:!0,options:[{optgroup:!0,label:lng("important tags").caps(),options:(0,m.wd)(y.map((e=>[e.tag,e.tag])))},{optgroup:!0,label:lng("other tags").caps(),options:(0,m.wd)(w.map((e=>[e.tag,e.tag])))}]}];return f.length&&_.push({noGraph:f}),(0,F.BX)("div",{css:Z,children:[x&&(0,F.tZ)(c.CX,{filters:C,filtersVals:b,onFilter:e=>{p(null==e?void 0:e.tags),v(e)},spreadFilters:!0,alwaysShow:!0}),(!(0,m.xb)(y)||!(0,m.xb)(w))&&(0,F.BX)("div",{className:"tags_wrapper",children:[a[i].size>1&&(0,F.tZ)("div",{className:"tagsTitle",children:(0,F.tZ)(V.T,{label:lng("show results using"),inline:!0,value:g,size:25,onChange:e=>h(e),options:k,inlineLabels:!0})}),(0,F.tZ)(N.r$,{justify:!0,onClear:a[i].size>0?d:void 0,toggleShowMore:!0,removableTags:!0,children:y.map((e=>{let{tag:t,disabled:n}=e;return!n&&(0,F.tZ)(N.Vp,{bright:!0,tag:t,active:a[i].has(t),onRemove:()=>u(t),bigger:!0},t)}))}),(0,F.tZ)(N.r$,{justify:!0,onClear:a[i].size>0&&(0,m.xb)(o(!0))?d:void 0,toggleShowMore:!0,removableTags:!0,children:w.map((e=>{let{tag:t,disabled:n}=e;return!n&&(0,F.tZ)(N.Vp,{bright:!0,tag:t,active:a[i].has(t),onRemove:()=>u(t)},t)}))})]}),(0,F.tZ)(I.Hl,{sortable:s,onSort:r,children:_.map((e=>e.noGraph?(0,F.tZ)($,{reports:e.noGraph,activeTab:i},"000"):(0,F.tZ)(X,{activeTab:i,...e},e.bookmark_id)))})]})})),ee={name:"1ndd409",styles:">.header{display:flex;justify-content:space-around;.tree{width:25%;}}"},te=(0,a.observer)((function(e){let{dashboardsStore:t}=e;const i=t.dashboardData;if(!i.ready)return(0,F.tZ)(d.$,{});const{tabs:n,activeTab:r,showDrawer:s,ous:o,activeOu:a}=i;return(0,F.BX)("div",{css:ee,children:[(0,F.BX)("div",{className:"header",children:[(0,F.tZ)(g.m,{className:"tabs",tabs:n,subTabs:!0,activeTab:r,onSelect:e=>i.selectTab(e)}),(0,F.tZ)("div",{className:"tree",children:(0,F.tZ)(k.I,{type:"tree_node",tree:o,value:a,onChange:e=>(i.activeOu=e,i.fetchData()),wrapped:!0,label:lng("org' unit").caps()})})]}),(0,F.BX)("div",{children:["skill_ranking"===r&&(0,F.tZ)(be,{dashboardSkillStore:i}),"skills_map"===r&&(0,F.tZ)(ge,{dashboardSkillStore:i}),"skills_list"===r&&(0,F.tZ)(de,{dashboardSkillStore:i})]}),s&&(0,F.tZ)(ie,{onClose:()=>i.toggleDrawer(!1),dashboardSkillStore:i})]})})),ie=(0,a.observer)((function(e){let{dashboardSkillStore:t,onClose:i}=e;const n=(0,_.useRef)(null),[r,s]=(0,_.useState)(null),{activeTab:o}=t;return(0,F.BX)(y.d,{size:"skill_ranking"===o?"500px":"700px",onClose:i,from:"side",scroll:!0,ref:n,refDrawerBody:s,children:[("skills_list"===o||"skills_map"===o)&&(0,F.tZ)(ne,{drawerBody:r,dbStore:t,onClose:i}),"skill_ranking"===o&&(0,F.tZ)(oe,{drawerBody:r,dbStore:t,onClose:i})]})})),ne=(0,a.observer)((function(e){let{drawerBody:t,dbStore:i,onClose:n}=e;const{drawerReady:r,skillTableCollection:s,filterSortSubTable:o,selectedRow:a}=i,{name:l}=a,p=(0,F.tZ)(f.$0,{icon:"skill",title:l?l.caps():lng("user list").caps(),onClose:n}),u=[lng("name"),lng("job title"),lng("level"),lng("actions"),{checkAll:!0}],g=[{val:"",label:"default"},{val:"full_name",label:"user name"},{val:"manager_level",label:lng("skill level")}],h="user_id",b=s.map((e=>1===e._checked&&!(0,m.Tz)(e.user_id)&&e[h])).filter((e=>e)),_=[{icon:"message",action:b.length>0?()=>(0,B.p4)({message:"new",params:{to:b.join()}},!0):void 0}],y=[{name:"full_name",label:lng("user name"),type:"search",outOfMenu:!0},{name:"occupation",label:lng("job title"),type:"search"}];return(0,F.BX)("div",{children:[(!r||!s)&&(0,F.tZ)(d.$,{}),r&&(0,F.BX)(f.W2,{head:p,stickyHead:!0,children:[(0,F.tZ)(c.CX,{filters:y,filtersVals:o.filter,onFilter:e=>o.filter=e,sorts:g,sort:o.sort,onSort:e=>{const t={...o.sort};t.desc=o.sort.by===e&&!o.sort.desc,t.by=e,o.sort=t}}),(0,F.tZ)(v.iA,{cols:u,rowIdCol:h,scrollParent:t,collection:s.map((e=>e)),RowRenderer:re,rowProps:i,actions:_})]})]})})),re=(0,a.observer)((function(e){let{row:t,rowProps:i}=e;const{full_name:n,manager_level:r,occupation:a,user_id:l}=t,{selectedRow:c}=i,d=(0,b.r0)(r),p=[1,2,3].map((e=>(0,b.r0)(e)));return p.forEach((e=>e.onClick=()=>i.setSkillLevelFromSkillTable({sk_id:c.sk_id,user_id:l,val:parseInt(e.val)}))),(0,F.BX)("tr",{css:se(d.color),children:[(0,F.tZ)("td",{children:(0,F.BX)("div",{className:"user",children:[(0,F.tZ)(w.qE,{user:t})," ",(0,F.tZ)("span",{className:"name",children:n})]})}),(0,F.tZ)("td",{children:(0,F.tZ)(s.u,{text:a,children:a})}),(0,F.tZ)("td",{children:(0,F.tZ)("div",{className:"skill",children:(0,F.tZ)(x.x,{options:p,children:(0,F.BX)("div",{className:"level",children:[(0,F.BX)("div",{children:[(0,F.tZ)(o.JO,{icon:d.icon})," ",d.label.caps()]}),(0,F.tZ)(o.JO,{icon:"caret_down"})]})})})}),(0,F.BX)("td",{children:[(0,F.tZ)(o.JO,{icon:"enter",toolTip:lng("").caps(),buttonLike:!0,onClick:()=>(0,B.p4)({user:l,tab:"skills"},!0)}),!(0,m.Tz)(l)&&(0,F.tZ)(o.JO,{icon:"message",buttonLike:!0,onClick:()=>(0,B.p4)({message:"new",params:{to:l}},!0)})]}),(0,F.tZ)(T.Fo,{o:t})]})})),se=e=>(0,n.iv)(">td .user{display:flex;align-items:center;>.name{",r.g.classes.margin_near("10px"),";}}>td .skill{border-radius:25px;padding:5px 10px;background-color:",e,";color:white;>div{width:100%;>._btn{width:100%;>span{>.level{display:flex;justify-content:space-between;&:hover{cursor:pointer;}}}}}}",""),oe=(0,a.observer)((function(e){let{dbStore:t,onClose:i}=e;const{drawerReady:n,userTableCollection:r,filterSortSubTable:s,selectedRow:a}=t,{full_name:l,user_id:p,rank_status:u,occupation:m}=a,g=(0,F.tZ)(f.$0,{title:lng("skills list").caps(),onClose:i}),h=[{val:"",label:"default"},{val:"name",label:"skill name"},{val:"manager_level",label:lng("skill level")}],b=[{name:"name",label:lng("skill name"),type:"search",outOfMenu:!0,placeholder:lng("skill name")}];return(0,F.BX)("div",{children:[(!n||!r)&&(0,F.tZ)(d.$,{}),n&&r&&(0,F.BX)(f.W2,{head:g,stickyHead:!0,css:ae,children:[(0,F.BX)("div",{className:"header",children:[(0,F.BX)("div",{className:"title",children:[(0,F.tZ)(w.qE,{user:a})," ",`${l} ${m?" - ":""} ${m.caps()}`]}),u>0&&(0,F.tZ)("div",{className:"info",children:(0,F.BX)(F.HY,{children:[(0,F.tZ)(o.JO,{icon:"warning_triangle"})," ",lng("you have %s skills without rank",u).caps()]})})]}),(0,F.tZ)(c.CX,{filters:b,filtersVals:s.filter,onFilter:e=>s.filter=e,sorts:h,sort:s.sort,onSort:e=>{const t={...s.sort};t.desc=s.sort.by===e&&!s.sort.desc,t.by=e,s.sort=t}}),(0,F.tZ)("div",{children:r.map((e=>(0,F.tZ)(le,{skill:e,onSelect:(e,i)=>{let{sk_id:n,val:r}=e;return t.setSkillLevelFromUserTable({sk_id:n,val:r,user_id:p},i)}},`${p}_${e.sk_id}`)))})]})]})})),ae=(0,n.iv)(".header{margin-top:10px;margin-bottom:30px;.title{font-size:1.4rem;font-weight:600;}.info{border:1px solid ",r.g.colors.dominant_orange,";color:",r.g.colors.dominant_orange,";background-color:",(0,O.mR)(r.g.colors.dominant_orange,.1),";border-radius:8px;margin:20px 0;padding:10px;}}",""),le=(0,a.observer)((function(e){let{skill:t,onSelect:i}=e;const[n,r]=(0,_.useState)(!1),{name:a,description:l,manager_level:c,sk_id:d}=t,p=[1,2,3].map((e=>(0,b.r0)(e)));return(0,F.BX)("div",{css:ce,children:[(0,F.tZ)(s.u,{className:"name",text:l,children:(0,F.tZ)("div",{children:a.caps()})}),(0,F.BX)("div",{className:"skills",children:[p.map((e=>(0,F.tZ)(S.xY,{skillTag:e,selected:e.val===c,onSelect:()=>i({sk_id:d,val:e.val},r)},e.val))),(0,F.tZ)("div",{className:"updated",children:n&&(0,F.tZ)(o.JO,{icon:"mark_v"})})]})]})})),ce=(0,n.iv)("margin-top:20px;padding:10px 10px 10px 0;border-bottom:1px solid ",r.g.colors.separator,";>.name{color:",r.g.colors.text_main,";font-size:1.1rem;}>.skills{color:",r.g.colors.text_sec,";display:flex;gap:10px;margin-top:20px;justify-content:space-between;align-items:center;.updated{width:30px;.Icon{font-size:1.2rem;color:",r.g.colors.green,";transition:transform 1s ease-out;}}}",""),de=(0,a.observer)((function(e){let{dashboardSkillStore:t}=e;const{skillsList:i,filterSortTable:n}=t,r=[lng("name"),lng("levels")],s=[{name:"name",label:lng("skill name"),type:"text",outOfMenu:!0,wrapped:!0}],o=[{val:"",label:""},{val:"name",label:lng("skill name")},{val:"lvl_0",label:lng("entry")},{val:"lvl_1",label:lng("basic")},{val:"lvl_2",label:lng("intermediate")},{val:"lvl_3",label:lng("advanced")}];return(0,F.BX)(F.HY,{children:[(0,F.tZ)(h.Of,{headline:lng("skills list"),image:`${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/star_factory.svg`}),(0,F.BX)("div",{children:[(0,F.tZ)(c.CX,{filters:s,filtersVals:n.filter,onFilter:e=>n.filter=e,sorts:o,sort:n.sort,onSort:e=>{const t={...n.sort};t.desc=n.sort.by===e&&!n.sort.desc,t.by=e,n.sort=t}}),(0,F.tZ)(v.iA,{cols:r,collection:i,rowIdCol:"sk_id",RowRenderer:pe,rowProps:t})]})]})})),pe=(0,a.observer)((function(e){let{row:t,rowProps:i}=e;const{sk_id:n,name:r,description:a,lvl_1:l,lvl_2:c,lvl_3:d,lvl_u:p}=t,u=[1,2,3,4].map((e=>(0,b.r0)(e)));return t.type="skill",(0,F.BX)("tr",{css:me,onClick:()=>i.toggleDrawer(t),children:[(0,F.tZ)("td",{className:"title",children:(0,F.tZ)(s.u,{text:a,children:(0,F.tZ)("div",{children:r.caps()})})}),(0,F.tZ)("td",{className:"skills",children:(0,F.tZ)("div",{className:"skills-count",children:[l,c,d,p].map(((e,n)=>(0,F.tZ)(s.u,{className:"skill",text:u[n].label,onClick:e=>(e.stopPropagation(),i.toggleDrawer(Object.assign({lvl:n},t))),css:ue(u[n].color),children:(0,F.BX)("div",{children:[(0,F.tZ)(o.JO,{icon:u[n].icon})," ",e]})},n)))})})]},n)})),ue=e=>(0,n.iv)("background-color:",e,";color:white;border-radius:25px;padding:5px 10px;",""),me=(0,n.iv)(".title{font-size:1.2rem;font-weight:600;}>.skills{>.skills-count{>.skill{display:inline-block;cursor:pointer;",r.g.classes.margin_far("10px"),";>.Icon{}}}}",""),ge=(0,a.observer)((function(e){let{dashboardSkillStore:t}=e;const{skillsList:i}=t,n=[];return i?(i.forEach((e=>{const{lvl_1:t,lvl_2:i,lvl_3:r,lvl_u:s,name:o,users:a,sk_id:l}=e;[t,i,r,s].forEach(((e,t)=>n.push({name:o,value:e,color:(0,b.r0)(t+1).color,data:{users:a,sk_id:l,lvl:t,name:o,type:"skill"}})))})),(0,F.BX)("div",{css:he,children:[(0,F.tZ)(Z.O,{data:n,circle:!0,size:"600px",onCircleClick:e=>t.toggleDrawer(e.data)}),(0,F.tZ)("div",{className:"legend",children:[1,2,3,4].map((e=>{const{color:t,label:i}=(0,b.r0)(e);return(0,F.BX)("span",{children:[" ",(0,F.tZ)(o.gT,{className:"bullet",color:t})," ",i.caps()]},e)}))})]})):(0,F.tZ)(d.$,{})})),he={name:"sdkra6",styles:"display:flex;align-items:center;flex-direction:column;.legend{margin-top:20px;span{margin:0 5px;}}"},be=(0,a.observer)((function(e){var t;let{dashboardSkillStore:i}=e;const{usersList:n,filterSortTable:r}=i,s=(null===(t=n.filter((e=>e.rank_status>0)))||void 0===t?void 0:t.length)||0,o=n.length-s,a=[lng("name"),lng("occupation"),lng("status"),lng("last rank update")],l=[{name:"full_name",label:lng("user name"),type:"search",outOfMenu:!0,wrapped:!0},{name:"occupation",label:lng("occupation"),type:"search",outOfMenu:!0,wrapped:!0},{name:"rank_status",label:lng("status"),type:"select",options:[["",""],["0","ranked"],["1","unranked"]],outOfMenu:!0,wrapped:!0}];return(0,F.BX)(F.HY,{children:[(0,F.tZ)(h.Of,{headline:lng("skill ranking"),image:`${Blsm.prm.Mainref+Blsm.prm.ViewRef}images/stars_showcase.svg`,content:(0,F.tZ)(ve,{ranked:o,unranked:s})}),!n&&(0,F.tZ)(d.$,{}),n&&(0,F.BX)("div",{children:[(0,F.tZ)(c.CX,{filters:l,filtersVals:r.filter,onFilter:e=>r.filter=e,sorts:[{val:"",label:""},{val:"full_name",label:"name"}],sort:r.sort,onSort:e=>{const t={...r.sort};t.desc=r.sort.by===e&&!r.sort.desc,t.by=e,r.sort=t}}),(0,F.tZ)(v.iA,{cols:a,collection:n,rowIdCol:"user_id",RowRenderer:fe,rowProps:i})]})]})})),ve=e=>{let{ranked:t,unranked:i}=e;return(0,F.tZ)("div",{css:_e,children:(0,F.BX)("div",{children:[(0,F.BX)("div",{className:"ranked",children:[(0,F.tZ)(o.JO,{icon:"vendor_final"}),(0,F.BX)("div",{children:[(0,F.tZ)("div",{children:lng("ranked users").caps()}),(0,F.tZ)("span",{className:"count",children:t})]})]}),(0,F.BX)("div",{className:"unranked",children:[(0,F.tZ)(o.JO,{icon:"clock"}),(0,F.BX)("div",{children:[(0,F.tZ)("div",{children:lng("awaiting rank").caps()}),(0,F.tZ)("span",{className:"count",children:i})]})]})]})})},_e=(0,n.iv)("display:flex;flex-direction:column;height:100px;justify-content:space-around;>div{display:flex;justify-content:space-around;>div{padding:5px 10px;display:flex;align-items:center;border-radius:8px;.count{font-size:1.4rem;}}}.ranked{background-color:",(0,O.mR)(r.g.colors.positive,.1),";color:",r.g.colors.positive,";}.unranked{background-color:",(0,O.mR)(r.g.colors.highlight,.1),";color:",r.g.colors.dominant_orange,";}.Icon{font-size:2rem;",r.g.classes.margin_far("10px"),";}",""),fe=(0,a.observer)((function(e){let{row:t,rowProps:i}=e;const{full_name:n,occupation:s,rank_status:a,last_modified:l}=t,c=a>"0"?lng("unranked"):lng("ranked");return t.type="user",(0,F.BX)("tr",{css:ye,onClick:()=>i.toggleDrawer(t),children:[(0,F.tZ)("td",{children:(0,F.BX)("div",{className:"name",children:[(0,F.tZ)(w.qE,{user:t})," ",n]})}),(0,F.tZ)("td",{children:s}),(0,F.BX)("td",{children:[(0,F.tZ)(o.gT,{color:"0"==a?r.g.colors.positive:r.g.colors.yellow})," ",c.caps()]}),(0,F.tZ)("td",{children:(0,C.k6)((0,C._3)(l),{date:!0,time:!1})})]})})),ye=(0,n.iv)(">td .name{display:flex;align-items:center;>div{",r.g.classes.margin_far("10px"),";}}","")},3079:(e,t,i)=>{i.d(t,{N:()=>s,q:()=>o});var n=i(441),r=i(8318);const s=e=>{let{user_id:t,is_manager:i,auth_permission:s,ou_auth_permission:o}=e;const a={user:t},l=(0,r.Tz)(t),c=l||i,d=Blsm.checkMod(["","ENT"]);return[c&&{label:lng("course status report").caps(),href:(0,n.p4)({report:"ReportCourseCompletion",params:a})},c&&{label:lng("status report").caps(),href:(0,n.p4)({report:"ReportUserStatus",params:a})},c&&{label:lng("performances log").caps(),href:(0,n.p4)({report:"ReportUserPerformancesLog",params:a})},c&&d&&{label:lng("qualification courses status").caps(),href:(0,n.p4)({report:"ReportUserQualificationStatus",params:a})},c&&{label:lng("usage report").caps(),href:(0,n.p4)({report:"UsageReport",params:a})},c&&{label:lng("meetings report").caps(),href:(0,n.p4)({report:"User_meetingsReport",params:a})},c&&{label:lng("basic qualification report").caps(),href:(0,n.p4)({report:"BasicQualificationReport",params:{user:t,self:l?1:""}})},c&&d&&{label:lng("compliance report").caps(),href:(0,n.p4)({report:"ComplianceReport",params:a})},l&&{label:lng("member course grades report").caps(),href:(0,n.p4)({report:"CourseGradesReport",params:{user_mode:1}})},s&&{label:lng("user's job authorizations").caps(),href:(0,n.p4)({report:"QualificationAuthorizations",params:a})},o&&{label:lng("job authorizations status"),href:(0,n.p4)({report:"OuAuthorizations",params:{user:l?void 0:t}})},Blsm.user.isPowerManager&&{label:lng("activity log"),href:{list:"activity_log",params:`filters[user_id]=${t}`}}].filter((e=>e))},o=(e,t,i)=>["Survey"===t&&{title:lng("survey report").caps(),href:(0,n.p4)({report:"SurveyReport",params:{assignment:e}})},"regular"===i&&["File","Test","Courseware"].includes(t)&&{title:lng("success report").caps(),href:(0,n.p4)({report:"ReportSuccess",params:{assignment:e}})},{title:lng("completion report").caps(),href:(0,n.p4)({report:"ReportCompletion",params:{assignment:e}})},"regular"===i&&["Test","Survey","Courseware","Evaluation","Form","Checklist"].includes(t)&&{title:lng("question distribution report").caps(),href:(0,n.p4)({report:"ReportQuestionDistribution",params:{assignment:e}})},"regular"===i&&{title:lng("league report").caps(),href:(0,n.p4)({report:"Report_League",params:{assignment:e}})}]},4074:(e,t,i)=>{i.d(t,{l:()=>U,_:()=>Q});var n,r,s=i(7363),o=i(1224),a=(i(7882),i(8567)),l=i(6975),c=i(7154),d=i(6920),p=i(7821),u=i(5007),m=i(4210),g=i(8534);function h(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let b=(n=p.action.bound,r=class extends m.I{constructor(e){super(e),h(this,"performance_data",void 0),h(this,"actions",void 0),h(this,"initScore",void 0),this.title=lng("save"),this.performance_data=e.data,this.actions=e.actions,this.initScore=e.initScore,this.initNote=e.initNote,this.buildFields()}buildFields(){this._fields=[{name:"grade",type:"number",label:lng("score"),min:0,max:100,integer:!0,required:!0},{name:"performance_note",type:"textarea",label:lng("manager note")}],this._prepFields({grade:this.initScore,performance_note:this.initNote}),this.ready=!0}save(e){this.actions.setScore(e.grade),this.actions.setNote(e.performance_note),this.saveToUrl("reports/action/change_test_result",{...e,...this.performance_data})}SaveSuccess(e){"1"!==e?(this.actions.setScore(this.initScore),this.actions.setNote(this.initNote),(0,g.Mj)(e)):this.actions.updateReloadBtn(),(0,u.vm)().closeDialog()}},v=r.prototype,_="SaveSuccess",f=[n],y=Object.getOwnPropertyDescriptor(r.prototype,"SaveSuccess"),w=r.prototype,x={},Object.keys(y).forEach((function(e){x[e]=y[e]})),x.enumerable=!!x.enumerable,x.configurable=!!x.configurable,("value"in x||x.initializer)&&(x.writable=!0),x=f.slice().reverse().reduce((function(e,t){return t(v,_,e)||e}),x),w&&void 0!==x.initializer&&(x.value=x.initializer?x.initializer.call(w):void 0,x.initializer=void 0),void 0===x.initializer&&(Object.defineProperty(v,_,x),x=null),r);var v,_,f,y,w,x;function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Z extends m.I{constructor(e){super(e),k(this,"info",void 0),this.title=lng("manager note"),this.info=e.info||{},this.confirmButtonLabel=this.info.permission?lng("save").caps():"",this.buildFields()}buildFields(){this._fields=[{name:"text",type:"textarea",label:lng("manager note")+(this.info.permission?"":" ("+this.info.grader_name+")"),readOnly:!this.info.permission,insert:this.info.permission||this.info.step_note},{type:"file",name:"files",label:lng("add files"),maxFiles:3,multiFile:!0,readOnly:!this.info.permission,insert:this.info.permission||this.info.files}],this._prepFields({files:this.info.files,text:this.info.step_note}),this.ready=!0}save(e){this.saveToUrl("reports/action/set_teacher_note",{performance:this.info.performance_id,question:this.info.step_question_number,index:this.info.step_frame_number,step_number:this.info.step_number,...e})}}var C,S,O=i(7392),B=i(8318),T=i(917),N=i(3346),I=i(5560),D=i(676),j=i(8e3),P=i(5944);let z=(C=p.action.bound,function(e,t,i,n,r){var s={};Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null)}((S=class extends m.I{constructor(e){super(e),this.FormComponent=R,this.title=lng("question score"),this._fields=[];const{question:t,info:i}=this.params,{rows:n,question_type:r,cols:s}=t,{steps:o,set_score:a}=i;if(a)switch(r){case"table_question":n.forEach(((e,t)=>{s.forEach(((e,i)=>{const n=t+"_"+i,r=o.find((e=>e.step_frame_number==n));this._fields.push({type:"number",name:`score_${n}`,value:null==r?void 0:r.step_grade,min:0,max:100,required:!0})}))}));break;case"completion":for(const e of o)this._fields.push({type:"number",name:`score_${e.step_frame_number}`,value:null==e?void 0:e.step_grade,min:0,max:100,required:!0});break;case"single_textbox":this._fields.push({type:"number",name:"score",value:null==i?void 0:i.step_grade,min:0,max:100,required:!0})}else this.confirmButtonLabel=!1;this._prepFields(),this.ready=!0}save(e){(0,j.SC)("questionnaire/change_question_score",{method:"POST",data:{question_scores:Object.entries(e).map((e=>({name:e[0],value:e[1]}))),performance:this.params.info.performance_id,question:this.params.info.step_question_number}},(()=>{(0,u.vm)().closeDialog(),(0,u.vm)().getStore("reports").reloadReport({scroll:{doc:document.scrollingElement.scrollTop,table:document.querySelector(".report-table-wrapper").scrollTop}})}))}SaveSuccess(){}}).prototype,"SaveSuccess",[C],Object.getOwnPropertyDescriptor(S.prototype,"SaveSuccess"),S.prototype),S);const E=(0,T.iv)(".sub-name{div{display:inline-block;}}.question-text{font-size:1.3em;font-weight:bold;padding-bottom:5px;}.question-desc{padding-left:15px;}.question-content{margin:10px 0;table{border-collapse:separate;border-spacing:0 5px;width:100%;font-size:.9rem;color:",d.g.colors.text_sec,";>tbody>tr{height:",D.q3,"px;>td{border-style:solid;border-color:",d.g.colors.border,";border-width:1px 0;padding:0 10px;&:first-of-type{border-",d.g.near,"-width:1px;border-top-",d.g.near,"-radius:5px;border-bottom-",d.g.near,"-radius:5px;}&:last-of-type{border-",d.g.far,"-width:1px;border-top-",d.g.far,"-radius:5px;border-bottom-",d.g.far,"-radius:5px;}}}}}.answer-cell{display:flex;justify-content:space-between;align-items:center;background-color:",d.g.colors.bg_2,";padding:2px 6px;border-radius:6px;span.read-answer{min-width:30px;text-align:center;display:inline-block;background-color:",d.g.colors.dominant_white,";}._field_wrapper{min-width:80px;}}.question-after-info{margin-top:14px;img{max-width:100%;height:auto;}}",""),R=(0,I.observer)((e=>{let{fields:t}=e;const i=(0,s.useContext)(m.q3),{values:n,updateValue:r,errors:o,params:a}=i,{question:l,info:c}=a;let d="";switch(l.question_type){case"table_question":d=(0,P.tZ)(F,{fields:t});break;case"completion":d=(0,P.tZ)(M,{fields:t});break;case"single_textbox":{const e=c.set_score?t.find((e=>"score"===e.name)):null;d=(0,P.BX)("div",{className:"answer-cell",style:{marginTop:"4px"},children:[(0,P.tZ)("span",{children:c.answer_text}),e?(0,P.tZ)(N.gN,{input:e,required:!0===e.required||(0,B.g4)(e.required),value:e.name?i.getValue(e.name,e.checkboxValue):n,skinny:!0,minimalist:e.minimalist,onChange:e.readOnly?null:r,error:o.get(e.name),disabled:(0,B.g4)(e.disable,null,[n])}):c.show_correctness?(0,P.tZ)("span",{className:"read-answer",children:null==c?void 0:c.step_grade}):""]})}break;case"multiple_choice":case"multiple_choice_single_answer":case"dropdown_list":d=(0,P.BX)("div",{className:"answer-cell",style:{marginTop:"4px"},children:[(0,P.tZ)("span",{children:(0,P.tZ)("span",{dangerouslySetInnerHTML:{__html:c.text}})}),c.show_correctness?(0,P.tZ)("span",{className:"read-answer",children:null==c?void 0:c.step_grade}):""]});break;case"rating_scale":case"matching":d=(0,P.tZ)("table",{children:(0,P.tZ)("tbody",{children:c.steps.map((e=>(0,P.BX)("tr",{children:[(0,P.tZ)("td",{children:(0,P.tZ)("span",{dangerouslySetInnerHTML:{__html:c.sub_names[e.step_frame_number]}})}),(0,P.tZ)("td",{children:(0,P.BX)("div",{className:"answer-cell",children:[(0,P.tZ)("span",{children:l.answers_text[e.step_frame_number]}),c.show_correctness?(0,P.tZ)("span",{className:"read-answer",children:null==e?void 0:e.step_grade}):""]})})]},e.step_frame_number)))})});break;case"sorting":d=(0,P.BX)("div",{className:"answer-cell",style:{marginTop:"4px"},children:[(0,P.tZ)("span",{children:c.text.map(((e,t)=>(0,P.tZ)("span",{dangerouslySetInnerHTML:{__html:e}},t)))}),c.show_correctness?(0,P.tZ)("span",{className:"read-answer",children:null==c?void 0:c.step_grade}):""]});break;case"hotspot":d=(0,P.BX)("div",{style:{marginTop:"4px"},children:[(0,P.tZ)("div",{className:"answer-cell",style:{marginBottom:"8px"},children:c.show_correctness?(0,P.tZ)("span",{className:"read-answer",children:null==c?void 0:c.step_grade}):""}),(0,P.tZ)("div",{dangerouslySetInnerHTML:{__html:l.html_image}})]})}return(0,P.BX)("div",{css:E,children:[(0,P.tZ)("div",{className:"question-text",children:l.question_text}),l.question_description&&(0,P.tZ)("div",{className:"question-desc",dangerouslySetInnerHTML:{__html:l.question_description}}),(0,P.tZ)("div",{className:"question-content",children:d}),l.question_after_info&&(0,P.BX)("div",{className:"question-after-info",children:[(0,P.tZ)("div",{children:(0,P.BX)("u",{children:[lng("added information").caps(),":"]})}),(0,P.tZ)("span",{dangerouslySetInnerHTML:{__html:l.question_after_info}})]})]})})),F=(0,I.observer)((e=>{let{fields:t}=e;const i=(0,s.useContext)(m.q3),{values:n,updateValue:r,errors:o,params:a}=i,{question:l,info:c}=a;return(0,P.BX)("table",{children:[(0,P.tZ)("thead",{children:(0,P.BX)("tr",{children:[(0,P.tZ)("th",{}),l.cols.map(((e,t)=>(0,P.tZ)("th",{dangerouslySetInnerHTML:{__html:e}},t)))]})}),(0,P.tZ)("tbody",{children:l.rows.map(((e,s)=>(0,P.BX)("tr",{children:[(0,P.tZ)("td",{dangerouslySetInnerHTML:{__html:e}}),l.cols.map(((e,a)=>{const l=s+"_"+a,d=c.steps.find((e=>e.step_frame_number==l)),p=c.set_score?t.find((e=>e.name===`score_${l}`)):null;return(0,P.tZ)("td",{children:(0,P.BX)("div",{className:"answer-cell",children:[(0,P.BX)("span",{children:[null==d?void 0:d.text," "]})," ",p?(0,P.tZ)(N.gN,{input:p,required:!0===p.required||(0,B.g4)(p.required),value:p.name?i.getValue(p.name,p.checkboxValue):n,skinny:!0,minimalist:p.minimalist,onChange:p.readOnly?null:r,error:o.get(p.name),disabled:(0,B.g4)(p.disable,null,[n])}):c.show_correctness?(0,P.tZ)("span",{className:"read-answer",children:null==d?void 0:d.step_grade}):""]})},a)}))]},s)))})]})})),M=(0,I.observer)((e=>{let{fields:t}=e;const i=(0,s.useContext)(m.q3),{values:n,updateValue:r,errors:o,params:a}=i,{question:l,info:c}=a;let d="";for(const[e,t]of Object.entries(l.pieces)){let i="";e>0&&(i=`<u>${l.answers_text[e]}</u>`),d+=i+t}return(0,P.BX)("div",{children:[(0,P.tZ)("div",{dangerouslySetInnerHTML:{__html:d}}),Object.entries(l.answers_text).map((e=>{let[s,a]=e;const l=c.steps.find((e=>e.step_frame_number==s)),d=c.set_score?t.find((e=>e.name===`score_${s}`)):null;return(0,P.BX)("div",{className:"answer-cell",style:{marginTop:"4px"},children:[(0,P.BX)("span",{children:[a," "]})," ",d?(0,P.tZ)(N.gN,{input:d,required:!0===d.required||(0,B.g4)(d.required),value:d.name?i.getValue(d.name,d.checkboxValue):n,skinny:!0,minimalist:d.minimalist,onChange:d.readOnly?null:r,error:o.get(d.name),disabled:(0,B.g4)(d.disable,null,[n])}):c.show_correctness?(0,P.tZ)("span",{className:"read-answer",children:null==l?void 0:l.step_grade}):""]},s)}))]})}));var A,q,X;function L(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function $(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function V(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let U=(A=class extends o.S{constructor(){super(...arguments),L(this,"reloadReportHighlight",q,this),L(this,"reloadReportTitle",X,this),$(this,"haveToolbar",!1),(0,p.makeObservable)(this)}mainButtons(){return[(0,P.tZ)(l.JO,{buttonLike:!0,icon:"reload",color:this.reloadReportHighlight?d.g.colors.dominant_orange:"",onClick:()=>this.reloadReport(),toolTip:this.reloadReportTitle},"reload")]}onLoad(e){if(!e)return;this.showPdf(),this.addToolbar(),this.showQuestionsTooltip(),this.showQuestionsScore(e),e.querySelectorAll(".question-note-button").forEach((e=>{const t=e.parentElement,i=JSON.parse(t.dataset.questionInfo);e.innerHTML="",e.className="",this.renderReactNode((0,P.tZ)(H,{question_info:i}),e)}));let t=e.querySelector("#score");if(t){const r=e.querySelector("#score_set_form");if(r){var i,n;const e=t.value,s=document.getElementById("note").value,o=this.filters.performance_id,a=(null===(i=t.closest(".score-button"))||void 0===i||null===(n=i.dataset.info)||void 0===n?void 0:n.question)||0;r.parentElement.setAttribute("id","react-SetScore"),this.renderReactNode((0,P.tZ)(G,{initScore:e,initNote:s,performance:o,question:a,updateReloadBtn:()=>this.updateReloadBtn()}),r.parentElement)}else{const e=document.getElementById("score_view");if(e){const i=t.innerHTML,n=document.getElementById("note").innerHTML;e.parentElement.setAttribute("id","react-score"),this.renderReactNode((0,P.tZ)(W,{score:i,performance_note:n}),e.parentElement)}}}document.addEventListener("click",(e=>{const t=e.target.closest(".hotspot-dialog");if(t){const e=t.dataset.hotspot;(0,a.qR)((0,P.tZ)("div",{dangerouslySetInnerHTML:{__html:e}}),{width:"70vw"})}}))}updateReloadBtn(){this.reloadReportHighlight||(this.reloadReportHighlight=!0,this.reloadReportTitle=lng("reload the report to see the changes."))}showPdf(){const e={file_type:"performance_report_file",file_props:{performance_id:this.filters.performance_id}};Q({fileData:e})}addToolbar(){if(!this.haveToolbar){this.haveToolbar=!0;const e=document.createElement("div");document.querySelector(".ReportTable").prepend(e),this.renderReactNode((0,P.tZ)(Y,{report:this,toggleReportClass:e=>document.querySelectorAll(".report").forEach((t=>t.classList.toggle(e)))}),e)}}showQuestionsTooltip(){document.querySelectorAll(".question-description-icon").forEach((e=>{const t=e.title;if(e.title="",t)for(;e=e.previousElementSibling;)if(e.classList.contains("question-id")){e.innerText&&this.renderReactNode((0,P.tZ)(c.u,{html:t,children:"[...]"}),e);break}}))}showQuestionsScore(e){null==e||e.querySelectorAll(".question-score-button").forEach((e=>{const t=e.closest(".question-info"),i=JSON.parse(t.dataset.questionInfo),n=JSON.parse(t.dataset.question);i&&this.renderReactNode((0,P.tZ)(J,{info:i,question:n}),e)}))}},q=V(A.prototype,"reloadReportHighlight",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),X=V(A.prototype,"reloadReportTitle",[p.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return lng("reload")}}),A);const H=e=>{var t;let{question_info:i}=e;const[n,r]=(0,s.useState)(i),o=n.step_note||(null===(t=n.files)||void 0===t?void 0:t.length)>0;return(0,P.tZ)(l.JO,{icon:"chat",onClick:()=>{(0,u.vm)().openDialog("form",new Z({info:n,onSaveSuccess:e=>{r({...n,step_note:e.text,files:e.files}),(0,u.vm)().closeDialog()}}))},className:(0,B.AK)({active:o})})},J=e=>{let{info:t,question:i}=e;return(0,P.tZ)(l.JO,{icon:"mark_v",toolTip:lng("score"),onClick:()=>((e,t)=>{const i=new z({info:e,question:t});(0,u.vm)().openDialog("form",i,{fitContent:!0})})(t,i)})},G=e=>{let{initScore:t,initNote:i="",performance:n,question:r,updateReloadBtn:o}=e;const[a,c]=(0,s.useState)(t),[d,p]=(0,s.useState)(i);return(0,P.BX)("div",{children:[a,(0,P.tZ)(l.JO,{icon:"edit",buttonLike:!0,onClick:()=>{(0,u.vm)().openDialog("form",new b({data:{performance:n,question:r},initScore:a,initNote:d,actions:{setScore:c,setNote:p,updateReloadBtn:o}}))},toolTip:lng("edit score")})]})},W=e=>{let{score:t,performance_note:i}=e;return(0,P.BX)("div",{children:[t,i.length>0&&(0,P.tZ)(l.JO,{icon:"menu_info",buttonLike:!0,onClick:()=>{(0,a.qR)((0,P.tZ)("span",{children:i}),{title:lng("manager note")})}})]})},K={name:"7dnfdi",styles:"margin-bottom:15px;.item{margin:10px;}"},Y=e=>{var t,i;let{report:n,toggleReportClass:r}=e;const o=null===(t=n.data)||void 0===t?void 0:t.lesson_type,l=null===(i=n.data)||void 0===i?void 0:i.can_set_score,c="Test"===o||"Courseware"===o,[d,p]=(0,s.useState)("outlined"),[u,m]=(0,s.useState)("outlined"),[h,b]=(0,s.useState)("outlined");if(!o)return null;const v=n.filters.performance_id;return(0,P.BX)("div",{css:K,children:[(0,P.tZ)(O.l,{className:"item",theme:u,onClick:()=>(r("show_only_marked"),m("outlined"===u?"contained":"outlined")),children:lng("marked questions").caps()}),(0,P.tZ)(O.l,{className:"item",theme:d,onClick:()=>(r("show_only_mandatory"),p("outlined"===d?"contained":"outlined")),children:lng("mandatory questions").caps()}),c&&(0,P.tZ)(O.l,{className:"item",theme:h,onClick:()=>(r("show_only_incorrect"),b("outlined"===h?"contained":"outlined")),children:lng("incorrect questions").caps()}),l&&(0,P.tZ)(O.l,{className:"item",theme:"contained",onClick:()=>(0,a.BB)(lng("notify user about manager notes"),{text:lng("restore").caps(),onConfirm:()=>(0,j.SC)("reports/action/notify_performer",{data:{performance_id:v},method:"POST"},(e=>{let{warning:t}=e;t?(0,g.nb)(t,lng("message not sent")):(0,g.qV)(lng("performer will be notified"),lng("success"))}))}),children:lng("notify user about manager notes").caps()})]})},Q=e=>{let{fileData:t,elementId:i="pdf_canvases",addScroll:n=!0,forPrint:r=!1}=e;const{file_type:s,file_props:o}=t,a=`GetFile?type=${s}&${(0,B.Wh)(o)}`;Blsm.loadJS([Blsm.prm.Mainref+"lib/external/pdfjs-2.16.105-legacy/build/pdf.js"]).then((()=>{window.pdfjsLib.GlobalWorkerOptions.workerSrc=Blsm.prm.Mainref+"lib/external/pdfjs-2.16.105-legacy/build/pdf.worker.js";const e=document.getElementById(i),t=window.pdfjsLib.getDocument(a);(async()=>{const i=await t.promise;for(let t=1;t<=i.numPages;t++){const s=document.createElement("canvas");e.style.direction="ltr",e.style.margin="auto",e.appendChild(s);const o=await i.getPage(t),a=r?1:1.5,l=o.getViewport({scale:a}),c=window.devicePixelRatio||1,p=s.getContext("2d"),u=Math.floor(l.width);s.width=Math.floor(l.width*c),s.height=Math.floor(l.height*c),s.style.width=u+"px",s.style.height=Math.floor(l.height)+"px",1===t&&(r||(e.style.border=`solid 1px ${d.g.colors.border}`),e.style.width=u+2+"px"),1===t&&n&&i.numPages>1&&(e.style.height=s.style.height,e.style.width=u+10+"px",e.style.overflowY="scroll");const m={canvasContext:p,transform:1!==c?[c,0,0,c,0,0]:null,viewport:l};o.render(m)}})()}))}},1224:(e,t,i)=>{i.d(t,{S:()=>a,a:()=>o});var n=i(745),r=i(7363);function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const o=(0,r.createContext)(null);class a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;s(this,"_reactRoots",[]),s(this,"HelpLegendLoaded",!1),this.data=e,this.filters=t,this.reloadReport=e=>i(e)}onLoad(){return null}onUnload(){this._reactRoots.forEach((e=>e.unmount()))}renderReactNode(e,t){const i=(0,n.s)(t);this._reactRoots.push(i),i.render(e)}inRowClickEvents(){return{}}inRowChangeEvents(){return{}}mainButtons(){return[]}tableCss(){}checkboxes(){return!1}tableButtons(){return[]}}},6026:(e,t,i)=>{i.d(t,{K:()=>D});var n=i(917),r=i(6920),s=i(5560),o=i(81),a=i(7363),l=i(6975),c=i(7154),d=i(441),p=i(5459),u=i(5944);const m=(0,n.iv)("position:fixed;z-index:",r.g.z.management_menu,";top:",r.g.consts.TOP_BAR_HEIGHT,"px;bottom:0;width:865px;max-width:calc(100vw - ",r.g.consts.SIDE_BAR_WIDTH,"px);",r.g.classes.near(r.g.consts.SIDE_BAR_WIDTH+"px"),";padding:20px 0 20px 0;box-shadow:0px 3px 6px rgba(0, 0, 0, 0.16);background-color:",r.g.darkMode?r.g.colors.bg_page_containers:"#fafafa",";color:",r.g.colors.text_sec,";.admin-panel-head{padding:0 20px;.admin-panel-title{color:",r.g.colors.text_main,";font-weight:700;font-size:1.4em;margin-top:20px;}}.scroll-area{position:absolute;top:120px;bottom:0;width:100%;overflow-y:auto;margin-top:20px;padding:0 20px;ul.admin-panel-list{padding:0;margin:0;list-style:none;display:flex;flex-wrap:wrap;}}",""),g=(0,s.observer)((function(e){let{aniProps:t,mmStore:i}=e;const n=(0,a.useRef)(),r=e=>{i.addRecentLink(e),i.managementMenuOpen=!1};(0,o.t$)(n,(e=>!e.target.closest("#management")&&(i.managementMenuOpen=!1)));const s=i.filterText.trim().replace(/\s\s+/g," ").toLowerCase().replace(/['"]/g,"");return(0,u.BX)("div",{css:m,ref:n,...t,children:[(0,u.BX)("div",{className:"admin-panel-head",children:[(0,u.tZ)("div",{className:"admin-panel-title title",children:lng("management").caps()}),(0,u.tZ)(_,{onSubmit:()=>{for(const e of i.managementMenuOptions)for(const t of e.items)if(t.label.toLowerCase().replace(/['"]/g,"").includes(s))return r(t.link),(0,d.p4)(t.link,!0)},mmStore:i})]}),(0,u.BX)("div",{className:"scroll-area",children:[(0,u.tZ)(y,{linkClicked:r,mmStore:i}),(0,u.tZ)("ul",{className:"admin-panel-list",children:i.managementMenuOptions.map((e=>{const t=s?e.items.filter((e=>e.label.toLowerCase().replace(/['"]/g,"").includes(s))):e.items;return(0,u.tZ)(b,{title:e.title,icon:e.icon,tutorial:e.tutorial,items:t,linkClicked:r},e.title)}))})]})]})})),h=(0,n.iv)("width:270px;margin:13px 0 20px 0;.category_title{color:",r.g.colors.text_main,";font-weight:600;.category_icon{vertical-align:middle;font-size:1.4rem;}}>.links{margin:9px 0 0 0;padding:0;",r.g.classes.padding_near("1em"),";}",""),b=(0,s.observer)((function(e){let{title:t,icon:i,items:n,linkClicked:r}=e;return n.length?(0,u.BX)("li",{css:h,children:[(0,u.BX)("div",{className:"category_title",children:[(0,u.tZ)(l.JO,{icon:i,className:"category_icon"}),"   ",t.caps()]}),(0,u.tZ)("div",{className:"links",children:n.map((e=>(0,u.tZ)(x,{item:e,linkClicked:r},e.label)))})]}):null})),v=(0,n.iv)("margin-top:25px;display:flex;align-items:center;padding-bottom:5px;border-bottom:1px solid ",r.g.colors.separator,";.Icon{font-size:1.2em;}form{flex-grow:1;input{background:transparent;border:0;width:100%;&::placeholder{color:#869298;}}}.input-clear{font-size:0.8em;cursor:pointer;}",""),_=(0,s.observer)((function(e){let{onSubmit:t,mmStore:i}=e;return(0,u.BX)("div",{css:v,className:"admin-panel-filter",children:[(0,u.tZ)(l.JO,{icon:"search"}),"  ",(0,u.tZ)("form",{onSubmit:e=>{e.preventDefault(),t()},children:(0,u.tZ)("input",{type:"search",placeholder:lng("filter").caps()+"...",value:i.filterText,onChange:e=>i.filterText=e.target.value,ref:e=>null==e?void 0:e.focus()})}),i.filterText.length>0&&(0,u.tZ)(l.JO,{icon:"close",className:"input-clear",onClick:()=>i.filterText=""})]})})),f=(0,n.iv)("background:",r.g.colors.dominant_main,";color:white;border-radius:6px;padding:1rem;margin:0 -1rem 1rem;>.category_title{font-weight:600;.category_icon{vertical-align:middle;font-size:1.4rem;}}>.links{display:flex;flex-wrap:wrap;>div{",r.g.classes.padding_near("1em"),";width:270px;margin-top:0.8em;}a[href]{color:inherit;&:hover{text-decoration:underline;}}}",""),y=(0,s.observer)((function(e){let{linkClicked:t,mmStore:i}=e;const{recentUse:n}=i;return n.length?(0,u.BX)("div",{css:f,className:"admin-panel-filter",children:[(0,u.BX)("div",{className:"category_title",children:[(0,u.tZ)(l.JO,{icon:"clock",className:"category_icon"}),"   ",lng("recently used").caps()]}),(0,u.tZ)("div",{className:"links",children:n.map((e=>(0,u.tZ)(x,{item:e,linkClicked:t,inRecentList:!0},e.label)))})]}):null})),w=(0,n.iv)("margin-top:0.8em;display:flex;.Icon{",r.g.classes.margin_far(".5em"),";}a{color:#696A72;display:inline-block;&[href]{color:inherit;&:hover{text-decoration:underline;}}&.tutorial{font-size:14px!important;vertical-align:super!important;}}>ul.subs{",r.g.classes.padding_near("1.5em"),";>li{list-style:none;font-size:0.9em;margin:0.4em;}}",""),x=function(e){let{item:t,linkClicked:i,inRecentList:n}=e;return(0,u.BX)("div",{css:w,children:[t.help?(0,u.tZ)(p.I,{helpKey:t.help}):(0,u.tZ)(l.e$,{}),(0,u.tZ)(d.A,{href:t.link,onClick:()=>i(t.link),children:t.label.caps()}),!n&&t.tutorial&&(0,u.tZ)(c.u,{text:lng("online tutorial").caps(),children:(0,u.tZ)(l.JO,{icon:"badge-bulb",href:"https://www.blossom-kc.com/support/tutorials?tc="+t.tutorial,newTab:!0,className:"tutorial"})}),!n&&t.subs&&(0,u.tZ)("ul",{className:"subs",children:t.subs.map((e=>{let{link:t,label:n}=e;return(0,u.tZ)("li",{children:(0,u.tZ)(d.A,{href:t,onClick:()=>i(t),children:n.caps()})},n)}))})]})};var k=i(3051),Z=i(5405),C=i(5338),S=(i(7882),i(2698)),O=i(9523),B=i(1042),T=i(9011);const N=(0,n.iv)("position:fixed;z-index:",r.g.z.side_bar,";top:0;bottom:0;min-width:",r.g.consts.SIDE_BAR_WIDTH,"px;max-width:",r.g.consts.SIDE_BAR_WIDTH,"px;transition:max-width .3s ease-in-out,margin .3s ease-in-out;",r.g.classes.near("0"),";",r.g.mQuery.mobile,"{&:not(.opened){transition:max-width 0s ease-in-out,margin .3s ease-in-out;",r.g.classes.margin_near(`-${r.g.consts.SIDE_BAR_WIDTH}px`),";}}",""),I=(0,n.iv)("display:flex;flex-direction:column;color:",r.g.colors.text_sec,";background-color:",r.g.theme.mm_bg,";",r.g.classes.border_far(`1px solid ${r.g.colors.separator}`),";overflow:hidden;._top{flex-grow:1;._logo{display:block;height:",r.g.consts.TOP_BAR_HEIGHT,"px;margin:20px 0 25px;>img{margin:auto;display:block;max-height:40px;max-width:",r.g.consts.SIDE_BAR_WIDTH,"px;transition:max-width .3s linear;}}._links{flex-grow:1;position:relative;}}._bottom{white-space:nowrap;padding:19px 0;>*{display:inline-block;",r.g.classes.margin_far("25px"),";color:",r.g.theme.mm_fg,";&:hover{color:",r.g.theme.mm_fg_active,";}&:first-of-type{width:",r.g.consts.SIDE_BAR_WIDTH,"px;",r.g.classes.margin_far(0),";text-align:center;>*{text-align:initial;}}}._lang{cursor:default;font-weight:700;}}&.opened{max-width:400px;._logo>img{max-height:70px;max-width:225px;transition:max-width .3s linear;}}",""),D=()=>(0,u.tZ)(Z.SV,{css:N,children:(0,u.tZ)(j,{})}),j=(0,s.observer)((function(){const e=(0,a.useContext)(T.h);(0,o.iP)();const t=(0,a.useRef)(null);(0,o.t$)(t,e.opened?()=>e.opened=!1:void 0);const{events:i,cancelEvent:n}=(0,o.Xf)(100,(()=>e.opened=!0),(()=>e.opened=!1)),{activeItem:s,managementMenuStore:l}=e,{managementMenuOpen:c}=null!=l?l:{managementMenuOpen:!1},p=(0,a.useRef)(null),m=(0,a.useRef)(null),h=()=>e.opened=!1,b=Object.entries(Blsm.lang.available||{}).map((e=>{let[t,i]=e;return{val:t,label:i,active:Blsm.lang.current===t}})),[v,_]=(0,B.$V)({show:c,type:"slide"});return(0,u.BX)(u.HY,{children:[v&&(0,u.tZ)(g,{aniProps:_,mmStore:e.managementMenuStore}),(0,u.tZ)(C.mp,{onSwipedLeft:r.g.isRTL?void 0:h,onSwipedRight:r.g.isRTL?h:void 0,delta:20,children:(0,u.BX)("div",{css:[N,I,"",""],className:"react_container "+(e.opened?"opened":""),...i,ref:e=>{if(t.current=e,!e)return;const i=p.current;let n=19;do{for(let e of i.children)e.style.padding=n+"px 0";n--}while(n>=0&&i.offsetTop+i.offsetHeight+60>e.offsetHeight)},onClick:t=>{m.current.contains(t.target)||(n(),e.opened=!1)},children:[(0,u.BX)("div",{className:"_top",children:[(0,u.tZ)(d.A,{className:"_logo",href:r.g.theme.homePage,newTab:!0,children:(0,u.tZ)("img",{src:e.opened?r.g.theme.logo_full:r.g.theme.logo_small,alt:r.g.theme.name})}),(0,u.tZ)("div",{className:"_links",ref:p,children:e.menuOptions.map(((e,t)=>(0,u.tZ)(z,{...e,active:"management"===e.id&&c||e.id===s},t)))})]}),(0,u.BX)("div",{className:"_bottom",ref:m,children:[b.length>0&&(0,u.tZ)(k.x,{className:"_lang",options:b,onSelect:O.rt,children:Blsm.lang.current.substring(0,2).caps()}),(0,u.tZ)(S.Dq,{})]})]})})]})})),P=(0,n.iv)("display:block;white-space:nowrap;cursor:pointer;min-width:225px;color:",r.g.theme.mm_fg,";&:hover,&.active{color:",r.g.theme.mm_fg_active,";}>div{font-size:21px;width:",r.g.consts.SIDE_BAR_WIDTH,"px;display:inline-block;text-align:center;}._alert_count{",r.g.classes.circled_text,";background-color:",r.g.colors.yellow,";color:white;font-size:9px;position:absolute;right:7px;opacity:1;transition-property:opacity;transition-duration:200ms;transition-timing-function:ease-out;}",""),z=e=>{let{href:t,icon:i,label:n,active:r,count:s,onClick:o,id:a,className:c=""}=e;return(0,u.BX)("a",{css:P,href:t,className:c+(r?" active":""),onClick:o,id:a,children:[(0,u.tZ)(l.JO,{icon:i}),n.caps(),s>0&&(0,u.tZ)("span",{className:"_alert_count",children:s})]})}},554:(e,t,i)=>{i.d(t,{m:()=>W,i:()=>G});var n=i(7363),r=i.n(n),s=i(7821),o=i(8e3),a=i(8318),l=i(441),c=i(5007),d=i(4401),p=i(8567),u=i(4210);function m(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class g extends u.I{constructor(e){super(e),m(this,"calendarId",null),m(this,"calendarInfo",{}),this.calendarId=null==e?void 0:e.calendarId,this.title=lng("calendar"),this.calendarId?(0,o.SC)(`calendar/${this.calendarId}`,{},(e=>{this.calendarInfo=e,this.calendarInfo.user_id=e.user_id||"on",this._buildFields()})):this._buildFields()}_buildFields(){this._fields=[{type:"text",name:"name",label:lng("calendar name"),required:!0},{type:"color",name:"color",label:lng("color")}],Blsm.user.isPowerManager&&this._fields.push({type:"select",name:"user_id",options:[{val:Blsm.user.id,label:lng("personal").caps()},{val:"on",label:lng("public").caps()}]}),this._prepFields(this.calendarInfo),this.ready=!0}save(e){this.saveToUrl(`calendar/${this.calendarId}`,e)}}var h=i(8534),b=i(2334),v=i(6344),_=i(7392),f=i(5944);const y={name:"1d3w5wq",styles:"width:100%"};class w extends u.I{constructor(e){super(e),this.title=lng("select type"),this.calStor=e.data.calStor,this.buildDialog(e.data.selectionInfo)}buildDialog(e){this._fields=[{type:"component",node:(0,f.tZ)(_.l,{component:l.A,css:y,theme:"outlined",href:{edit:"workspace",params:{type:"course",start:e.startStr,end:e.endStr},section:"timing"},children:lng("course").caps()})},{type:"component",node:(0,f.tZ)(_.l,{theme:"outlined",css:y,onClick:()=>{e.allDay&&(e.startStr+=" 09:00",e.endStr=e.end.toISOString().substring(0,10)+" 10:00"),this.calStor.openCalendarEventForm(e)},children:lng("event").caps()})}],this._prepFields(),this.ready=!0}}var x,k,Z,C,S,O,B,T,N,I,D,j,P,z,E,R,F,M,A,q,X,L,$,V;function U(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function H(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function J(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const G=(0,n.createContext)(null);let W=(x=s.action.bound,k=s.action.bound,Z=s.action.bound,C=s.action.bound,S=s.action.bound,O=s.action.bound,B=s.action.bound,T=s.action.bound,N=s.action.bound,I=s.action.bound,D=s.action.bound,j=s.action.bound,z=J((P=class{constructor(e){let{nav:t}=e;U(this,"ready",z,this),H(this,"calendarRef",r().createRef()),H(this,"agenda",{}),H(this,"otherCalendars",[]),U(this,"mineCalendars",E,this),U(this,"title",R,this),U(this,"viewType",F,this),H(this,"viewTypes",{month:"dayGridMonth",week:"timeGridWeek",day:"timeGridDay"}),U(this,"start",M,this),U(this,"todayDisabled",A,this),U(this,"activeCalendars",q,this),U(this,"refresh",X,this),U(this,"resources",L,this),U(this,"resourceBundle",$,this),U(this,"preferences",V,this),H(this,"allMyCalendars",1),H(this,"allOtherCalendars",1),H(this,"_internalNav",!0),(0,s.makeObservable)(this),this.nav=t,this.ready=!1,(0,o.SC)("calendar",{},(e=>{this.agenda=e.calendars.agenda,this.otherCalendars=e.calendars.other,this.otherCalendars.forEach((e=>(0,s.set)(this.activeCalendars,e.id,!this.excludeWhenReady.includes(e.id)))),this.mineCalendars.replace(e.calendars.mine),this.mineCalendars.forEach((e=>(0,s.set)(this.activeCalendars,e.id,!this.excludeWhenReady.includes(e.id)))),(0,s.autorun)((()=>{var e;this.nav([Object.keys((0,a.v7)(this.activeCalendars,(e=>!e))),this.resources,this.resourceBundle,this.preferences,this.start,this.viewType],{replace:!0}),this._internalNav||"month"===this.viewType&&(this.start=this.handleStartDate(this.start)),null===(e=this.calendarRef.current)||void 0===e||e.refresh()})),this.ready=!0}))}handleStartDate(e){let t=(0,b._3)(e);return t.date()>15?t.add(1,"month").startOf("month"):t.startOf("month"),t.format().substring(0,10)}updateRoute(e){let[t,i,n,r,s,o]=e;if(this._internalNav=!0,this.ready){t=(0,a.PG)(t);for(const e of Object.keys(this.activeCalendars))this.activeCalendars[e]=!t.includes(e)}else this.excludeWhenReady=t||[];i=(0,a.PG)(i);for(const e of Object.keys(this.resources))this.resources[e]=i[e];n=(0,a.PG)(n);for(const e of Object.keys(this.resourceBundle))this.resourceBundle[e]=n[e];if(r)for(const e of Object.keys(this.preferences))this.preferences[e]=r[e];this.start=s,this.viewType=o,this.ready||(this._internalNav=!1)}updateFromFC(e){this.title=e.title,this.viewType=e.viewType,this.todayDisabled=e.todayDisabled,this.start=this.handleStartDate(e.dateInfo.start)}checkCalendars(e,t){let i={};for(const[n]of Object.entries(this.activeCalendars))((0,a.B5)(n)&&"allMyCalendars"==t||!(0,a.B5)(n)&&"allOtherCalendars"==t)&&(i[n]=e);(0,s.set)(this.activeCalendars,i),this[t]=!!e}getEvents(e,t){let i={start:e.start.getTime()/1e3,end:e.end.getTime()/1e3+a.s2};for(const[e,t]of Object.entries(this.preferences))i[e]=t;Object.assign(i,{group_resource_visibility:"all",resources:this.resources,resource_bundles:this.resourceBundle});let n=[];for(let[e,t]of Object.entries(this.activeCalendars))t&&((0,a.B5)(e)||["events","blocking_events"].includes(e)?n.push(e):i[e]=1);i.cal=n.toString(),(0,o.SC)("calendar/get_events/&",{data:i},(e=>{const i=e.map((e=>{let t,i,n,r,s,{id:o,allDay:c,whole_day:d,title:p,url:u,backgroundColor:m,textColor:g,className:h,color:_}=e;const{start_time:f,end_time:y,hasEditPermission:w,type:x,canAccessGroup:k,group_id:Z,repeat_type:C}=e;if("event"!==x||void 0!==o||e.data||(o=e.event_id),s=o,!f||!y)return!1;switch(t=f,i=y,c&&(i=(0,b._3)(i).add(1,"days").toISOString()),m=m?(0,a.kE)(m)?(0,v.gj)(m):m:(0,a.kE)(_)?(0,v.gj)(_):_,g=(0,v.ou)(m),r=n=!(0,a.tq)()&&!!w,x){case"meeting":u=w&&!(0,a.tq)()?(0,l.p4)({edit:"meeting",id:o}):k?(0,l.p4)({workspace:Z,tab:"schedule"}):!!/managed_users_groups/.test(h)&&(0,l.p4)({report:"UserCourseParticipation",params:{group:Z}});break;case"event":u=!1,!w&&k&&(u=(0,l.p4)({workspace:Z,tab:"schedule"})),d&&(c=!0);break;case"group":u=(0,l.p4)({workspace:o})}const S={id:o,allDay:c,title:p,backgroundColor:m,textColor:g,className:h,start:t,end:i,startEditable:n,durationEditable:r,groupId:s,extendedProps:{type:x,repeat_type:C}};return u&&(S.url=u),S}));t(i.filter((e=>!!e)))}))}eventClick(e){"event"===e.event.extendedProps.type&&e.event.durationEditable&&(0,c.vm)().openDialog("form",new d.Z({event:e.event,store:this}))}eventMouseEnter(e){e.el.title=e.event._def.title}updateEventDates(e,t){let i;i=t?e.endDelta:e.delta;let n=Math.floor(i.milliseconds/6e4);(0,o.SC)("calendar/update_event_dates",{method:"POST",data:{event_id:e.event.id,dayDelta:i.days,minuteDelta:n,end_only:t}},(t=>{t.message||1===t.error?((0,h.Mj)(t.message||lng("an error occurred")),e.revert()):1==t&&(0,h.qV)(lng("event moved successfully")+": "+e.event.title)}))}updateMeetingDates(e,t){(0,p.BB)(lng("send an email invitation with an update about the meeting time?").caps(),{confirmText:lng("yes").caps(),cancelText:lng("no").caps(),onConfirm:()=>i(e,!0,t),onCancel:()=>i(e,!1,t)});const i=(e,t,i)=>{let n;n=i?e.endDelta:e.delta;let r=Math.floor(n.milliseconds/6e4);(0,o.SC)("calendar/update_meeting_dates",{method:"POST",data:{assignment_id:e.event.id,dayDelta:n.days,minuteDelta:r,end_only:i,sendMailToUsers:t,sendMailToResources:t}},(t=>{t.message||1===t.error?((0,h.Mj)(t.message||lng("an error occurred")),e.revert()):(0,h.qV)(lng("meeting moved successfully")+": "+e.event.title)}))}}eventDrop(e){"event"!==e.event.extendedProps.type||e.delta.milliseconds?"meeting"===e.event.extendedProps.type?this.updateMeetingDates(e):e.revert():e.relatedEvents.length>0?((0,h.nb)(lng("cannot move a repeating event")),e.revert()):e.event.allDay?this.updateEventDates(e):((0,h.nb)(lng("can only move whole day events")),e.revert())}eventResize(e){"event"===e.event.extendedProps.type&&this.updateEventDates(e,!0),"meeting"===e.event.extendedProps.type&&this.updateMeetingDates(e,!0)}datesSelect(e,t){Blsm.user.perm.group_admin?(0,c.vm)().openDialog("form",new w({data:{selectionInfo:e,calendarRef:t,calStor:this}})):this.openCalendarEventForm(e)}mayAddEvent(){return this.mineCalendars.length>0}openCalendarEventForm(e){this.mayAddEvent()?(0,c.vm)().openDialog("form",new d.Z({selectionInfo:e,store:this})):(0,h.nb)(lng("please add at least one personal calendar before creating an event"))}addCalendar(){const e=new g({onSaveSuccess:e=>{let t={};for(const[i,n]of Object.entries(e))t[i]=n;t.created=null,this.mineCalendars.push(t),(0,s.set)(this.activeCalendars,t.id,!this.excludeWhenReady.includes(t.id)),(0,c.vm)().closeDialog()}});(0,c.vm)().openDialog("form",e)}updateCalendar(e){let{calendar:t}=e;const i=new g({calendarId:t.id,onSaveSuccess:e=>{for(const[i,n]of Object.entries(e))t[i]=n;(0,c.vm)().closeDialog()}});(0,c.vm)().openDialog("form",i)}deleteCalendar(e){let{calendar:t}=e;(0,p.BB)(lng("are you sure you want to delete this calendar?".caps()),{title:lng("delete").caps(),onConfirm:()=>(0,o.SC)("calendar/"+t.id,{method:"DELETE"},(()=>{this.mineCalendars.remove(t),this.activeCalendars[t.id]=!1,(0,c.vm)().closeDialog()}))})}}).prototype,"ready",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=J(P.prototype,"mineCalendars",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=J(P.prototype,"title",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),F=J(P.prototype,"viewType",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"month"}}),M=J(P.prototype,"start",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),A=J(P.prototype,"todayDisabled",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),q=J(P.prototype,"activeCalendars",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),X=J(P.prototype,"refresh",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),L=J(P.prototype,"resources",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$=J(P.prototype,"resourceBundle",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=J(P.prototype,"preferences",[s.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{meetings:1,workspace_events:1,assignments:1,courses:0,blocking_events:""}}}),J(P.prototype,"updateRoute",[x],Object.getOwnPropertyDescriptor(P.prototype,"updateRoute"),P.prototype),J(P.prototype,"updateFromFC",[k],Object.getOwnPropertyDescriptor(P.prototype,"updateFromFC"),P.prototype),J(P.prototype,"checkCalendars",[s.action],Object.getOwnPropertyDescriptor(P.prototype,"checkCalendars"),P.prototype),J(P.prototype,"getEvents",[Z],Object.getOwnPropertyDescriptor(P.prototype,"getEvents"),P.prototype),J(P.prototype,"eventClick",[C],Object.getOwnPropertyDescriptor(P.prototype,"eventClick"),P.prototype),J(P.prototype,"eventMouseEnter",[S],Object.getOwnPropertyDescriptor(P.prototype,"eventMouseEnter"),P.prototype),J(P.prototype,"eventDrop",[O],Object.getOwnPropertyDescriptor(P.prototype,"eventDrop"),P.prototype),J(P.prototype,"eventResize",[B],Object.getOwnPropertyDescriptor(P.prototype,"eventResize"),P.prototype),J(P.prototype,"datesSelect",[T],Object.getOwnPropertyDescriptor(P.prototype,"datesSelect"),P.prototype),J(P.prototype,"openCalendarEventForm",[N],Object.getOwnPropertyDescriptor(P.prototype,"openCalendarEventForm"),P.prototype),J(P.prototype,"addCalendar",[I],Object.getOwnPropertyDescriptor(P.prototype,"addCalendar"),P.prototype),J(P.prototype,"updateCalendar",[D],Object.getOwnPropertyDescriptor(P.prototype,"updateCalendar"),P.prototype),J(P.prototype,"deleteCalendar",[j],Object.getOwnPropertyDescriptor(P.prototype,"deleteCalendar"),P.prototype),P)},6259:(e,t,i)=>{i.d(t,{Z:()=>X,s:()=>q});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_,f,y,w,x,k,Z,C,S=i(7821),O=i(7363),B=i(8e3),T=i(7659),N=i(101),I=i(4210),D=i(8318),j=i(6975),P=i(5007),z=i(441),E=i(8534),R=i(5944);function F(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function A(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const q=(0,O.createContext)(null);let X=(n=S.observable.shallow,r=S.observable.shallow,s=S.observable.shallow,o=S.action.bound,a=S.action.bound,l=S.action.bound,c=S.action.bound,d=S.action.bound,p=S.action.bound,u=S.action.bound,m=S.action.bound,h=A((g=class{constructor(e){let{nav:t}=e;F(this,"ready",h,this),F(this,"activeOu",b,this),F(this,"loading",v,this),F(this,"content",_,this),F(this,"contentCount",f,this),F(this,"tags",y,this),F(this,"skills",w,this),M(this,"tag_categories",[]),M(this,"filtersForm",null),F(this,"pageSize",x,this),M(this,"_initialFilters",void 0),F(this,"_curPage",k,this),M(this,"_categoriesTree",[]),M(this,"activeLessonId",null),(0,S.makeObservable)(this),this.nav=t,this._fetch=(0,D.Ds)(this._fetch,500)}updateNav(){var e;this.nav([null===(e=this.filtersForm)||void 0===e?void 0:e.buildFinalValues(),this.curPage,this.activeLessonId],{replace:!0})}_fetch(){var e;this.loading=!0,null===(e=this._curFetch)||void 0===e||e.abortFetch();const t=this.ready?this.filtersForm.buildFinalValues():this._initialFilters||{};t.page=this.curPage,this._curFetch=(0,B.SC)("catalog/shared",{data:t},(0,S.action)((e=>{const{shared:t,catalog_tree:i,most_common_tags:n,skills:r,tag_categories:s,page_size:o,count:a,bookmarks_count:l}=e;this.bookmarksCount=l,this.ready||(this.filtersForm=new L({initialValues:this._initialFilters,categoriesTree:this._categoriesTree=i,onValueChange:()=>{void 0===this._curPage?this.updateNav():this.curPage=void 0}}),this.tag_categories=s,this._categoriesTagIds=s.reduce(((e,t)=>{let{tags:i}=t;return[...e,...i.map((e=>e.tag_id))]}),[])),this.pageSize=o,this.contentCount=a,this.content.replace(t.map((e=>new T.m(e,{deleteContent:this.deleteContent})))),this.tags.replace(n.map((e=>e[1]))),this.skills=r;const c=this.filtersForm.getValue("tags");if(null!=c&&c.length){const e=[...n.map((e=>e[0].toString())),...this._categoriesTagIds];this.filtersForm.updateValue(c.filter((t=>e.includes(t))),"tags",void 0,!0)}this.activeLessonId&&this.showAssignment(),this.loading=!1,this.ready=!0})))}deleteContent(e){this.content=this.content.filter((t=>t!==e))}updateRoute(e){let[t,i,n]=e;if("shared"!==t&&"bookmarks"!==t&&"trending"!==t||(i=i||{},"bookmarks"===t&&(i.bookmarked=1),t=i,i=void 0),this.ready&&n)return this.activeLessonId=n,void(this.activeLessonId&&this.showAssignment());this.loading=!0,this.filtersForm?this.filtersForm.setValues(t,{clear:!0}):this._initialFilters=t,this._curPage=i,this.activeLessonId=n,this._fetch()}toggleSkillSelection(e){const t=this.selectedSkills;t[t.has(e)?"delete":"add"](e),this.filtersForm.updateValue([...t],"skills")}clearSkillsSelection(){const e=this.selectedSkills;e.clear(),this.filtersForm.updateValue([...e],"skills")}setActiveContent(e){(null==e?void 0:e.lesson_id)!=this.activeLessonId&&(this.activeLessonId=null==e?void 0:e.lesson_id,this.updateNav())}get selectedSkills(){return new Set(this.filtersForm.getValue("skills"))}get selectedTags(){return new Set(this.filtersForm.getValue("tags"))}toggleTagSelection(e){const t=this.selectedTags;t[t.has(e)?"delete":"add"](e),this.filtersForm.updateValue([...t],"tags")}clearTagSelection(){const e=this.selectedTags;e.clear(),this.filtersForm.updateValue([...e],"tags")}get curPage(){return this._curPage>0?this._curPage:void 0}set curPage(e){this._curPage=e,this.updateNav()}get subCategories(){const e=this.filtersForm.getValue("cat");if(e){const t=(0,D.oH)(this._categoriesTree,(t=>(null==t?void 0:t.id)===""+e));return null==t?void 0:t.sons}return this._categoriesTree.filter((e=>e.id))}get categoryBreadCrumbs(){const e=[],t=this.filtersForm.getValue("cat");if(t){const i={id:"",label:lng("all categories")};return(0,D.oH)(this._categoriesTree,(e=>(null==e?void 0:e.id)===""+t),e)?[i,...e]:[i]}return e}showAssignment(){const e=this.content.find((e=>e.lesson_id==this.activeLessonId));e?(0,P.vm)().showSideDrawer(e,{close:()=>this.setActiveContent(null)}):(0,E.nb)(lng("the content is no longer available").caps())}setCategoryId(e){this.filtersForm.updateValue(e,"cat")}haveMyContentPermission(){return Blsm.canAccessModule("Content|Questionnaires")||Blsm.hasPermission("blogs")}mayDragFiles(){return this.haveMyContentPermission()}onFileDrop(e){(0,P.vm)().formPassData=e,(0,z.p4)({edit:"share",params:{multipleFromFiles:!0}},!0)}}).prototype,"ready",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=A(g.prototype,"activeOu",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=A(g.prototype,"loading",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=A(g.prototype,"content",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=A(g.prototype,"contentCount",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y=A(g.prototype,"tags",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w=A(g.prototype,"skills",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=A(g.prototype,"pageSize",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),k=A(g.prototype,"_curPage",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),A(g.prototype,"updateNav",[o],Object.getOwnPropertyDescriptor(g.prototype,"updateNav"),g.prototype),A(g.prototype,"deleteContent",[a],Object.getOwnPropertyDescriptor(g.prototype,"deleteContent"),g.prototype),A(g.prototype,"updateRoute",[S.action],Object.getOwnPropertyDescriptor(g.prototype,"updateRoute"),g.prototype),A(g.prototype,"toggleSkillSelection",[l],Object.getOwnPropertyDescriptor(g.prototype,"toggleSkillSelection"),g.prototype),A(g.prototype,"clearSkillsSelection",[c],Object.getOwnPropertyDescriptor(g.prototype,"clearSkillsSelection"),g.prototype),A(g.prototype,"setActiveContent",[d],Object.getOwnPropertyDescriptor(g.prototype,"setActiveContent"),g.prototype),A(g.prototype,"selectedSkills",[S.computed],Object.getOwnPropertyDescriptor(g.prototype,"selectedSkills"),g.prototype),A(g.prototype,"selectedTags",[S.computed],Object.getOwnPropertyDescriptor(g.prototype,"selectedTags"),g.prototype),A(g.prototype,"toggleTagSelection",[p],Object.getOwnPropertyDescriptor(g.prototype,"toggleTagSelection"),g.prototype),A(g.prototype,"clearTagSelection",[u],Object.getOwnPropertyDescriptor(g.prototype,"clearTagSelection"),g.prototype),A(g.prototype,"subCategories",[S.computed],Object.getOwnPropertyDescriptor(g.prototype,"subCategories"),g.prototype),A(g.prototype,"categoryBreadCrumbs",[S.computed],Object.getOwnPropertyDescriptor(g.prototype,"categoryBreadCrumbs"),g.prototype),A(g.prototype,"mayDragFiles",[m],Object.getOwnPropertyDescriptor(g.prototype,"mayDragFiles"),g.prototype),g),L=(Z=class extends I.I{constructor(e){let{initialValues:t,categoriesTree:i,onValueChange:n}=e;super({onValueChange:n}),F(this,"expanded",C,this),(0,S.makeObservable)(this),(0,N.v0)(i),this._fields=[{type:"hidden",name:"tags"},{type:"hidden",name:"skills"},{type:"hidden",name:"page_size"},{type:"row_set",fields:[{type:"search",name:"term",placeholder:lng("search").caps()},{type:"component",grow:0,node:(0,R.tZ)(j.JO,{icon:"filter",className:"mobile_only",buttonLike:!0,onClick:()=>this.expanded=!this.expanded})}]},{type:"select",name:"sort",label:lng("sort by"),options:(0,D.wd)([["original-order",lng("default")],["name",lng("name")],["lesson_description",lng("description")],["category_name",lng("category")],["views",lng("popularity")]])},{type:"row_set",fields:[{type:"tree_node",name:"cat",label:lng("category"),tree:i,nameField:"label"},{type:"component",grow:0,node:(0,R.tZ)(j.JO,{icon:"edit",buttonLike:!0,onClick:()=>(0,z.p4)({categoryTree:!0},!0)}),insert:Blsm.user.isPowerManager}]},{type:"select_multi",name:"content_types",label:lng("content type"),onValueChange:e=>!e.includes("Text")&&this.updateValue(null,"textsub"),options:(0,D.wd)([["File",lng("file")],["Survey",lng("survey")],["Test",lng("test")],["Evaluation",lng("evaluation")],["Lti","lti"],["Text",lng("text")],["Kaltura",lng("video (advanced)")],["document",lng("document")],["courseware",lng("courseware")],["slideshow",lng("slideshow")],["excel",lng("excel")],["video",lng("video")],["audio",lng("audio")]])},{type:"select_multi",name:"textsub",label:lng("text type"),visible:e=>{var t;return null===(t=e.get("content_types"))||void 0===t?void 0:t.includes("Text")},options:(0,D.wd)([["text",lng("general"),!0],["wiki",lng("wiki"),!0],["glossary",lng("glossary"),!0],["faq",lng("faq"),!0],["dictionary",lng("dictionary"),!0]])},{type:"select_multi",name:"duration",label:lng("estimated duration"),options:(0,D.wd)([["0_30",lng("under 30 min")],["30_60",lng("30 min to 1 hour")],["60_120",lng("1 hour to 2 hours")],["120_",lng("over 2 hours")]])},{type:"select",name:"period",label:lng("modification time"),options:(0,D.wd)([["",lng("any time")],["week",lng("past week")],["month",lng("past month")],["year",lng("past year")]])},{type:"checkbox",name:"bookmarked",label:lng("bookmarked"),mod:["","ENT"]},{type:"multiple_items",name:"group_id",label:lng("workspace"),searchData:(e,t)=>{(0,B.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",member:1,term:e.term,id:e.ids}},t)}}],this._prepFields(t)}},C=A(Z.prototype,"expanded",[S.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Z)},2213:(e,t,i)=>{i.d(t,{pE:()=>x,t0:()=>w});var n,r,s,o,a,l,c,d,p,u=i(7821),m=i(7363),g=i(8e3),h=i(5007),b=i(8318),v=i(660);function _(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function f(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const w=(0,m.createContext)(null);let x=(n=u.observable.shallow,s=y((r=class{constructor(e){let{endPoint:t="comments"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f(this,"connectTo",null),_(this,"ready",s,this),_(this,"_comments",o,this),_(this,"title",a,this),_(this,"rememberedComments",l,this),f(this,"mentions",[]),f(this,"last_update",0),f(this,"noReplies",!1),f(this,"endPoint",""),_(this,"inner_context",c,this),f(this,"refreshError",!1),(0,u.makeObservable)(this),this.connectTo=e,this.noReplies=["patients_communication","launcher_private"].includes(e.type),this.endPoint=t,this.fetch()}get size(){return this.comments.length}get comments(){const e=Array.from(this._comments.values());return this.inner_context?e.filter((e=>e.data.inner_context==this.inner_context)):e}fetch(){const e={...this.connectTo,group_id:0,mentions:!0};(0,g.SC)(this.endPoint,{data:e},(0,u.action)((e=>{if(e.comments)for(const t of e.comments)this._comments.set(t.id,new k(t));this.mentions=(0,b.wd)(e.mentions),this.title=e.title,this.ready=!0,this.last_update=e.timestamp})))}sendComment(e,t){const i=this.rememberedComment(e);if(i.isEmpty())return t&&t(!1);const n={text:i.html,inner_context:this.inner_context,commands:(0,u.toJS)(i.commands),...e};(0,g.SC)(this.endPoint,{data:n,method:"POST",onError:t?()=>t(!1):void 0},(i=>{if(i){var n,r;if(e.comment_id)"comment"===i.connect_to.type?null===(r=this._comments.get(i.connect_to.object_id))||void 0===r||r._subComments.set(e.comment_id,new k(i)):this._comments.set(e.comment_id,new k(i));else"comment"===e.type?null===(n=this._comments.get(e.object_id))||void 0===n||n._subComments.set(i.id,new k(i)):this._comments.set(i.id,new k(i));h.Nd.trigger("commentsUpdateCount",{connectTo:this.connectTo,length:this._comments.size,action:"add"})}this.resetRememberedComment(e),null==t||t(!0)}))}deleteComment(e){const t={comment_id:e.comment_id};(0,g.SC)(this.endPoint+"/delete",{data:t},(()=>{var t;"comment"===e.type?null===(t=this._comments.get(e.object_id))||void 0===t||t._subComments.delete(e.comment_id):this._comments.delete(e.comment_id),h.Nd.trigger("commentsUpdateCount",{connectTo:this.connectTo,length:this._comments.size,action:"subtract"})}))}setCommentLabel(e){const t={comment_id:e.comment_id,label:e.label};(0,g.SC)(this.endPoint+"/label",{data:t,method:"POST"},(t=>{var i;"comment"===e.type?null===(i=this._comments.get(e.object_id))||void 0===i||i._subComments.set(e.comment_id,new k(t)):this._comments.set(e.comment_id,new k(t))}))}change(e){let{data:{id:t,type:i},callback:n}=e;(0,g.SC)(this.endPoint+"/change",{data:{id:t,type:i},method:"POST"},n)}rememberedComment(e){const t=(0,b.SZ)(e);return this.rememberedComments.has(t)||this.resetRememberedComment(e),this.rememberedComments.get(t)}resetRememberedComment(e){this.setRememberComment(e,new v.g)}setRememberComment(e,t){const i=(0,b.SZ)(e);this.rememberedComments.set(i,t)}get dirty(){for(const e of this.rememberedComments.values())if(e.notEmpty())return!0;return!1}fullRefresh(){this._comments.clear(),this.last_update=0,this.refresh()}refresh(){if(this.refreshError)return;const e={...this.connectTo,group_id:0,t:this.last_update};(0,g.SC)(this.endPoint,{data:e,onError:e=>{var t;if("error"===(null===(t=e.responseJSON)||void 0===t?void 0:t.res)){this.refreshError=!0;const t=e.responseJSON.error_msg||lng("an error occurred");Blsm.Error(lng("comments")+": "+t)}}},(0,u.action)((e=>{if(this.last_update=e.timestamp,e.comments)for(const t of e.comments)this._comments.set(t.id,new k(t))})))}findComment(e,t){(0,u.autorun)((()=>{this.ready&&(this._comments.has(e)?t(this._comments.get(e)):this._comments.forEach((i=>{i._subComments.has(e)&&t(i._subComments.get(e),i)})))}))}}).prototype,"ready",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=y(r.prototype,"_comments",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),a=y(r.prototype,"title",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=y(r.prototype,"rememberedComments",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),c=y(r.prototype,"inner_context",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),y(r.prototype,"size",[u.computed],Object.getOwnPropertyDescriptor(r.prototype,"size"),r.prototype),y(r.prototype,"comments",[u.computed],Object.getOwnPropertyDescriptor(r.prototype,"comments"),r.prototype),y(r.prototype,"setRememberComment",[u.action],Object.getOwnPropertyDescriptor(r.prototype,"setRememberComment"),r.prototype),y(r.prototype,"dirty",[u.computed],Object.getOwnPropertyDescriptor(r.prototype,"dirty"),r.prototype),r),k=(d=class e{constructor(t){let{id:i,type:n,time:r,connect_to:s,sub_comments:o,...a}=t;if(f(this,"id",null),f(this,"connectTo",null),f(this,"type",null),f(this,"time",null),_(this,"_subComments",p,this),f(this,"data",{}),(0,u.makeObservable)(this),this.id=i,this.type=n,this.time=r,this.connectTo=s,null!=o&&o.length)for(const t of o)this._subComments.set(t.id,new e({parent:this,...t}));a.user&&0===a.user.user_id&&null===a.user.user_first_name&&Object.assign(a.user,{user_first_name:lng("deleted user").caps(),user_last_name:""}),this.data=a}chainMembers(e){const t=new Map;this.data.user&&t.set(parseInt(this.data.user.user_id),{id:this.data.user.user_id,name:(0,b.v2)(this.data.user)}),this._subComments.forEach((e=>{const i={id:e.data.user.user_id,name:(0,b.v2)(e.data.user)};t.set(parseInt(i.id),i)}));const i=[...t.values()];return e?i.filter((e=>!(0,b.Tz)(e.id))):i}get subComments(){return Array.from(this._subComments.values())}},p=y(d.prototype,"_subComments",[u.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),y(d.prototype,"subComments",[u.computed],Object.getOwnPropertyDescriptor(d.prototype,"subComments"),d.prototype),d)},2645:(e,t,i)=>{i.d(t,{cW:()=>V,iS:()=>$,wV:()=>X});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_,f,y,w,x,k,Z,C,S,O,B,T=i(7821),N=i(7363),I=i(8e3),D=i(5832),j=i(9934),P=i(6920),z=i(8918),E=i(6633),R=i(2334),F=i(8318);function M(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function A(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function q(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const X=(0,N.createContext)(null),L=e=>{let{_attr:t}=e;return{start:t.group_open_date,end:t.group_close_date,groupId:t.group_id,id:t.group_id,title:t.group_name,backgroundColor:V(t.status).cardColor,allDay:!0}};let $=(n=T.observable.shallow,r=T.observable.shallow,s=T.action.bound,o=T.action.bound,a=T.action.bound,l=T.action.bound,c=T.action.bound,d=T.action.bound,p=T.action.bound,u=T.action.bound,g=q((m=class{constructor(e){let{nav:t}=e;M(this,"ready",g,this),M(this,"_activeTab",h,this),M(this,"urlId",b,this),A(this,"_tabs",[]),A(this,"options",{}),M(this,"userWorkspaces",v,this),M(this,"managerWorkspaces",_,this),A(this,"anonymous",!Blsm.user.id&&Blsm.prm.anonymous_courses_catalog),M(this,"selfFilters",f,this),M(this,"managerFilters",y,this),M(this,"existingMembers",w,this),M(this,"waitingRequests",x,this),M(this,"newMembers",k,this),M(this,"view",Z,this),M(this,"term",C,this),M(this,"selectedTags",S,this),M(this,"searchTagRelation",O,this),A(this,"digitalLibrary",Blsm.isFeatureEnabled("digital_library")||Blsm.isFeatureEnabled("online_content")),M(this,"handleSelectNewMember",B,this),(0,T.makeObservable)(this),this.nav=t,this.view=Blsm.GuiFeatureValue("registration_page_default_view")||"tiles",Blsm.InitialData.main_menu.coursecatalog&&this._tabs.push("self"),Blsm.InitialData.main_menu.manager_coursecatalog&&this._tabs.push("manager"),this.fetch()}updateRoute(e){let[t,i]=e;if(this._activeTab=t,null==i||!i.term)return this.setActive(i);this.term=null==i?void 0:i.term,this.selfFilters.filter.group_name=this.term}get usersDrawerTabs(){return[{val:"new",label:lng("member list")},{val:"waiting",label:`${lng("waiting request")} (${this.waitingRequests.length})`},{val:"existing",label:`${lng("registered members")} (${this.existingMembers.length})`}]}get activeTab(){return this._tabs.includes(this._activeTab)?this._activeTab:this._tabs[0]}set activeTab(e){this.nav([e],{replace:!0})}setSearchTagRelation(e){this.searchTagRelation=e}setActive(e){e!==this.urlId&&(this.waitingRequests.clear(),this.existingMembers.clear(),this.newMembers.clear(),this.urlId=e,this.nav([this.activeTab,e],{replace:!0}))}get groupInfo(){if(!this.urlId)return null;let e=null;for(const t of this.workspaces){if(this.urlId===t.url_id){e=t;break}for(const i of t.instances)if(this.urlId===i.url_id){e=i;break}}return e}extractSchedule(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=[],n=[];return e.forEach((e=>{e.isExternal&&n.push(e),e.isTemplate?e.instances.forEach((e=>{e.activityDates.start&&e.activityDates.end?i.push(e):n.push(e)})):e.activityDates.start&&e.activityDates.end?i.push(e):n.push(e)})),t?n:i}get workspaces(){return"self"===this.activeTab?this.userWorkspaces:"manager"===this.activeTab?this.managerWorkspace:[]}get filters(){return"self"===this.activeTab?this.selfFilters:"manager"===this.activeTab?this.managerFilters:(0,D.Cy)()}get dateSorted(){return(0,D.WB)(this.extractSchedule(this.userWorkspaces),this.filters.filter,this.filters.sort,{filters:this.customFuncFilters})}get noDate(){return(0,D.WB)(this.extractSchedule(this.userWorkspaces,!0),this.filters.filter,{},{filters:this.customFuncFilters})}fetch(){this.ready=!1,(0,I.SC)("registration/catalog",{},(0,T.action)((e=>{var t,i,n;const r={anonymous:this.anonymous,display:"registration",custom_fields:null==e||null===(t=e.options)||void 0===t?void 0:t.custom_fields};this.userWorkspaces=(null===(i=e.courses)||void 0===i?void 0:i.map((e=>new z.N(e,r,"self"))))||[],this._tabs.includes("manager")&&(this.managerWorkspace=(null===(n=e.manager_courses)||void 0===n?void 0:n.map((e=>new z.N(e,r,"manager"))))||[]),"self"===this.activeTab&&this._tabs.includes("manager")&&0===this.userWorkspaces.length&&(this.activeTab="manager"),this.selfFilters=Blsm.isGuiFeatureEnabled("registration_page_show_pending")?(0,D.Cy)({group_name:this.term}):(0,D.Cy)({group_name:this.term,status:V(null,"selfText",["IS_MEMBER_CLOSED","IS_MEMBER_OPEN","IN_WAITING_LIST","REQUEST_PENDING"])}),this.options=e.options,this.ready=!0})))}get classifications(){const e=new Set;return this.workspaces.forEach((t=>e.add(t._attr.classification_name||null))),[...e].sort().map((e=>({val:e,label:e||lng("no classification").caps()})))}get statuses(){const e=new Set;return this.workspaces.forEach((t=>{var i,n;null!==(i=t.statusInfo)&&void 0!==i&&i.selfText&&e.add(null===(n=t.statusInfo)||void 0===n?void 0:n.selfText)})),[...e].sort().map((e=>({val:e,label:e})))}get tags(){const e=new Set;return this.workspaces.forEach((t=>{var i;return null===(i=t._attr.tags)||void 0===i?void 0:i.forEach((t=>e.add(t)))})),[...e].sort().map((e=>({val:e,label:e||lng("no tags").caps()})))}getTags(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new Set;return this.workspaces.forEach((i=>{var n;return null===(n=i._attr.tags)||void 0===n?void 0:n.forEach((i=>{var n,r;(!e&&(null===(n=this.options.important_tags)||void 0===n||!n.includes(i))||e&&null!==(r=this.options.important_tags)&&void 0!==r&&r.includes(i))&&t.add(i)}))})),[...t].sort().map((e=>{var t;return{tag:e,disabled:!(null!==(t=this.selectedTags)&&void 0!==t&&t.has(e))}}))}toggleTagSelection(e){void 0===e?this.selectedTags.clear():(null==e||e.forEach((e=>this.selectedTags.add(e))),[...this.selectedTags].filter((t=>!(null!=e&&e.includes(t)))).forEach((e=>this.selectedTags.delete(e))))}removeTag(e){this.selectedTags.delete(e),this.filters.filter.tags=[...this.selectedTags]}clearTagSelection(){this.selectedTags.clear(),this.filters.filter.tags=[]}get tabs(){return this._tabs.map((e=>this.tabsInfo(e)))}tabsInfo(e){switch(e){case"self":if(this.userWorkspaces.length)return{val:e,label:lng("self registration",{phrase:!0}),badge:this.userWorkspaces.length};break;case"manager":if(this.managerWorkspace.length)return{val:e,label:lng("manager registration"),badge:this.managerWorkspace.length}}return{}}get customFuncFilters(){const e=(e,t,i)=>{if(!(0,E.R)(e))return t;const n=(0,R._3)(e).unix()+("group_close_date_unix"===i?F.s2:0);if(t.attr(i)&&t.attr(i)>=n)return t;if(t.isTemplate&&t.instances.length>0)for(let e=0;e<t.instances.length;e++)if(t.instances[e].attr(i)>=n)return t},t=(e,t)=>{if("AND"===this.searchTagRelation){if(e.filter((e=>{var i;return null===(i=t.tags)||void 0===i?void 0:i.includes(e)})).length===e.length)return t}else if("OR"===this.searchTagRelation&&e.filter((e=>{var i;return null===(i=t.tags)||void 0===i?void 0:i.includes(e)})).length>0)return t};return[{name:"group_open_date",func:(t,i)=>e(t,i,"group_open_date_unix")},{name:"group_close_date",func:(t,i)=>e(t,i,"group_close_date_unix")},{name:"status",func:(e,t)=>{var i;return e.includes(null===(i=t.statusInfo)||void 0===i?void 0:i.selfText)?t:null}},{name:"tags",func:(e,i)=>t(e,i)}]}get sections(){let e=(0,D.WB)(this.workspaces.filter((e=>!e._attr.hide_with_link)),this.filters.filter,{},{filters:this.customFuncFilters});const t={member:{title:lng("member").caps(),courses:[]},registered:{title:lng("registered").caps(),courses:[]},pending:{title:lng("pending").caps(),courses:[]},available:{title:lng("available registrations").caps(),subTitle:lng("available registration"),courses:[],classifications:{}},manager:{title:lng("manager registration").caps(),subTitle:lng("manager registration"),courses:[],classifications:{}},external:{title:lng("external events").caps(),courses:[]}};null==e||e.map((e=>{if(e.isExternal)t.external.courses.push(e);else{var i,n,r;const s="manager_register"===e.attr("group_access")?"manager":["open","closed"].includes(null===(i=e.statusInfo)||void 0===i?void 0:i.selfStatus)?"available":"";if(["member","registered"].includes(null===(n=e.statusInfo)||void 0===n?void 0:n.selfStatus)&&t.registered.courses.push(e),["pending"].includes(null===(r=e.statusInfo)||void 0===r?void 0:r.selfStatus)&&t.pending.courses.push(e),s){t[s].courses.push(e);const i=e.attr("classification_name")||"others";t[s].classifications[i]||(t[s].classifications[i]=[]),t[s].classifications[i].push(e)}}}));for(const e of Object.values(t))if(e.classifications){for(const[t,i]of Object.entries(e.classifications))1===i.length&&"others"!==t&&(e.classifications.others||(e.classifications.others=[]),e.classifications.others.push(i[0]),delete e.classifications[t]);1===Object.keys(e.classifications).length&&delete e.classifications}return t}asEvents(e,t){t(this.extractSchedule(this.workspaces).map(L)||[])}fetchMembers(e){(0,I.SC)("registration/departmental_workspace_dialog_data/"+e,{},(e=>{var t,i;this.existingMembers.replace((null==e||null===(t=e.existing_members)||void 0===t?void 0:t.map((e=>new j.o(e))))||[]),this.waitingRequests.replace((null==e||null===(i=e.waiting_requests)||void 0===i?void 0:i.map((e=>new j.o(e))))||[])}))}addNewMembers(){const e=[],t=[];this.newMembers.map((i=>{""===i.result&&(i.canJoin&&e.push(i.user_id),i.exceptionJoin&&t.push(i.user_id))})),(e||t)&&(0,I.SC)("registration/departmental_add_members",{data:{workspace:this.groupInfo.group_id,members:e,exceptions:t}},(e=>this.newMembers.map((t=>t.result=this.buildResult(e.results[t.user_id]||"",t)))))}buildResult(e,t){let i={color:"",label:""};return e.request&&(i={color:P.g.colors.positive,label:lng("request sent").caps()}),e.added&&(i={color:P.g.colors.positive,label:lng("added as member").caps()},this.existingMembers.unshift(Object.assign({isNew:!0,org_unit_name:t.group_name},t))),e.error&&(i={color:P.g.colors.negative,label:e.error}),e.warning&&(i={color:P.g.colors.negative,label:e.warning}),i}}).prototype,"ready",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=q(m.prototype,"_activeTab",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=q(m.prototype,"urlId",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=q(m.prototype,"userWorkspaces",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_=q(m.prototype,"managerWorkspaces",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=q(m.prototype,"selfFilters",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,D.Cy)()}}),y=q(m.prototype,"managerFilters",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,D.Cy)()}}),w=q(m.prototype,"existingMembers",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x=q(m.prototype,"waitingRequests",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=q(m.prototype,"newMembers",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z=q(m.prototype,"view",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"tiles"}}),C=q(m.prototype,"term",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=q(m.prototype,"selectedTags",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),O=q(m.prototype,"searchTagRelation",[T.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"AND"}}),q(m.prototype,"updateRoute",[T.action],Object.getOwnPropertyDescriptor(m.prototype,"updateRoute"),m.prototype),q(m.prototype,"setSearchTagRelation",[s],Object.getOwnPropertyDescriptor(m.prototype,"setSearchTagRelation"),m.prototype),q(m.prototype,"groupInfo",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"groupInfo"),m.prototype),q(m.prototype,"workspaces",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"workspaces"),m.prototype),q(m.prototype,"filters",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"filters"),m.prototype),q(m.prototype,"dateSorted",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"dateSorted"),m.prototype),q(m.prototype,"noDate",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"noDate"),m.prototype),q(m.prototype,"classifications",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"classifications"),m.prototype),q(m.prototype,"statuses",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"statuses"),m.prototype),q(m.prototype,"tags",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"tags"),m.prototype),q(m.prototype,"getTags",[o],Object.getOwnPropertyDescriptor(m.prototype,"getTags"),m.prototype),q(m.prototype,"toggleTagSelection",[a],Object.getOwnPropertyDescriptor(m.prototype,"toggleTagSelection"),m.prototype),q(m.prototype,"removeTag",[l],Object.getOwnPropertyDescriptor(m.prototype,"removeTag"),m.prototype),q(m.prototype,"clearTagSelection",[c],Object.getOwnPropertyDescriptor(m.prototype,"clearTagSelection"),m.prototype),q(m.prototype,"tabs",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"tabs"),m.prototype),q(m.prototype,"sections",[T.computed],Object.getOwnPropertyDescriptor(m.prototype,"sections"),m.prototype),q(m.prototype,"asEvents",[d],Object.getOwnPropertyDescriptor(m.prototype,"asEvents"),m.prototype),q(m.prototype,"fetchMembers",[T.action],Object.getOwnPropertyDescriptor(m.prototype,"fetchMembers"),m.prototype),B=q(m.prototype,"handleSelectNewMember",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;this.newMembers.find((t=>t.user_id===e.user_id))||(e.statusInfo=V(e.status),e.canJoin=e.statusInfo.check,e.exceptionJoin=(null===(t=this.groupInfo)||void 0===t?void 0:t.exceptions_approval_sequence)&&"NOT_MATCHING_AVAILABILITY_CONDITIONS"===e.status,e.result="",e.canJoin?this.newMembers.unshift(e):this.newMembers.push(e))}}}),q(m.prototype,"addNewMembers",[u],Object.getOwnPropertyDescriptor(m.prototype,"addNewMembers"),m.prototype),m);const V=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n={ADD_MEMBERS:{check:!1,selfStatus:"manageMembers",selfText:lng("manage members").caps(),selfButtonText:lng("manage members"),departmental:lng("manage members").caps(),action:"manageMembers"},IS_MEMBER_CLOSED:{check:!1,selfStatus:"registered",selfText:lng("registered").caps(),cardColor:"#2BBA30",selfButtonText:lng("already a member"),departmental:lng("already a member").caps(),action:null},MEMBER:{check:!1,selfStatus:"member",selfText:lng("member").caps(),cardColor:"#2BBA30",selfButtonText:lng("member"),departmental:lng("already a member").caps()},IS_MEMBER_OPEN:{check:!1,selfStatus:"registered",selfText:lng("joined").caps(),selfButtonClass:"_cancel",cardColor:"#2BBA30",selfButtonText:lng("leave"),departmental:lng("already a member").caps(),action:"leave"},IN_WAITING_LIST:{check:!1,selfStatus:"pending",selfText:lng("pending").caps(),selfButtonClass:"_cancel",cardColor:"#3F51B5",selfButtonText:lng("leave waiting list"),departmental:lng("already in waiting list").caps(),action:"leave_waiting_list"},REQUEST_PENDING:{check:!1,selfStatus:"pending",selfText:lng("pending request").caps(),selfButtonClass:"_cancel",cardColor:"#3F51B5",selfButtonText:lng("cancel request"),departmental:lng("request pending").caps(),action:"cancel_request"},IN_OTHER_INSTANCE:{check:!1,selfStatus:"closed",selfText:lng("closed").caps(),cardColor:"#F44336",selfButtonText:lng("member of other instance"),departmental:lng("member of other instance").caps(),action:null},CLASSIFICATION_LIMIT_REACHED:{check:!1,selfStatus:"closed",selfText:Blsm.prm.CLASSIFICATION_LIMIT_TEXT_HP?lng("course limit reached").caps():lng("not available").caps(),cardColor:"#F44336",selfButtonText:Blsm.prm.CLASSIFICATION_LIMIT_TEXT_HP?lng("course limit reached"):lng("not available"),departmental:lng("classification limit reached").caps(),action:null},HAS_DEPENDENCIES:{check:!1,selfStatus:"closed",selfText:lng("closed").caps(),cardColor:"#F44336",selfButtonText:lng("you have uncompleted dependencies"),departmental:lng("you have uncompleted dependencies").caps(),action:null},NOT_MATCHING_AVAILABILITY_CONDITIONS:{check:!1,selfStatus:"closed",selfText:lng("not available").caps(),cardColor:"#F44336",selfButtonText:lng("not part of target audience"),departmental:lng("not part of target audience").caps(),action:null},FUTURE_REGISTRATION:{check:!1,selfStatus:"closed",selfText:lng("registration will open later").caps(),cardColor:"#FFC107",selfButtonText:lng("registration will open later"),departmental:lng("registration will open later").caps(),action:null},LIMIT_REACHED:{check:!1,selfStatus:"closed",selfText:lng("closed").caps(),cardColor:"#F44336",selfButtonText:lng("course is full"),departmental:lng("course is full").caps(),action:null},OU_LIMIT_REACHED:{check:!1,selfStatus:"closed",selfText:lng("closed").caps(),cardColor:"#F44336",selfButtonText:lng("org' unit allocation is full"),departmental:lng("org' unit allocation is full").caps(),action:null},NO_OU_ALLOCATION:{check:!1,selfStatus:"closed",selfText:lng("closed").caps(),cardColor:"#F44336",selfButtonText:lng("org' unit has no allocation"),departmental:lng("org' unit has no allocation").caps(),action:null},WAITING_LIST_OPEN:{check:!0,selfStatus:"open",selfText:lng("open").caps(),cardColor:"#2196F3",selfButtonText:lng("join waiting list",{phrase:!0}),departmental:lng("can join waiting list",{phrase:!0}).caps(),action:"join_waiting_list"},REGISTER:{check:!0,selfStatus:"open",selfText:lng("open").caps(),cardColor:"#2196F3",selfButtonText:lng("register"),departmental:lng("can register").caps(),action:"register"},OPEN:{check:!0,selfStatus:"open",selfText:lng("open").caps(),cardColor:"#2196F3",selfButtonText:lng("join|verb",{phrase:!0}),departmental:lng("can join").caps(),action:"join"},PRICE:{check:!0,selfStatus:"open",selfText:lng("buy").caps(),cardColor:"#2196F3",selfButtonText:lng("buy"),departmental:lng("can buy").caps(),action:"buy"}};if(i.length&&i.forEach((e=>delete n[e])),!e)return"status"===t?Object.keys(n):Object.values(n).map((e=>e[t]));const r=n[e];return r.status=e,t?r[t]:r}},7806:(e,t,i)=>{i.d(t,{EK:()=>de,fd:()=>le,i3:()=>ce});var n,r,s,o,a,l,c,d,p,u,m,g,h,b=i(7821),v=i(7363),_=i(8e3),f=i(101),y=i(5832),w=i(8318),x=i(441),k=i(8567),Z=i(5007),C=i(3079),S=i(8534),O=i(6945),B=i(8246),T=i(7327);function N(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function I(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function D(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let j=(r=D((n=class{constructor(e){let{nav:t,user:i}=e;N(this,"ready",r,this),N(this,"activeTab",s,this),N(this,"showDrawer",o,this),N(this,"_skillsList",a,this),N(this,"_usersList",l,this),N(this,"_skillDrawerCollection",c,this),N(this,"_usersDrawerCollection",d,this),N(this,"filterSortTable",p,this),N(this,"filterSortSubTable",u,this),N(this,"drawerReady",m,this),N(this,"selectedRow",g,this),N(this,"activeOu",h,this),I(this,"user",void 0),I(this,"nav",void 0),I(this,"tabs",[]),(0,b.makeObservable)(this),this.nav=t,this.user=i,this.fetch()}updateRoute(e){this.id=(0,w.B5)(e[0])?e[0]:void 0}get skillsList(){return(0,y.WB)(this._skillsList,this.filterSortTable.filter,this.filterSortTable.sort)}get usersList(){return(0,y.WB)(this._usersList,this.filterSortTable.filter,this.filterSortTable.sort)}get skillTableCollection(){return(0,y.WB)(this._skillDrawerCollection,this.filterSortSubTable.filter,this.filterSortSubTable.sort)}get userTableCollection(){return(0,y.WB)(this._usersDrawerCollection,this.filterSortSubTable.filter,this.filterSortSubTable.sort)}selectTab(e){this.activeTab=e,this.fetchData(),this.filterSortSubTable=(0,y.Cy)(),this.filterSortTable=(0,y.Cy)()}fetch(){(0,_.SC)("dashboard/ou/",{},(e=>{var t;const i=(null===(t=e.ous)||void 0===t?void 0:t.reduce(((e,t)=>[...e,...(0,f.Jf)(t.map((e=>{let[,t]=e;return{id:t.group_id,name:t.group_name,parent:t.parent}})))]),[]))||[];i.length>0&&(this.ous=i,this.activeOu=this.ous[0].id),this.buildTabs()}))}fetchData(){const e=this.activeOu,t=this.activeTab,i="skill_ranking"===t?"_usersList":"_skillsList",n="skill_ranking"===t?"users_list":"skills_list";(0,_.SC)(`skills/dashboard_${n}`,{data:{ou:e}},(e=>(this.ready=!0,this[i]=e,e)))}toggleDrawer(e){this.drawerReady=!1,"skill"===e.type&&this.fetchUsersBySkill(e),"user"===e.type&&this.fetchSkillsByUser(e),this.showDrawer=!this.showDrawer}fetchSkillsByUser(e){const{user_id:t,skills:i}=e,n=this._usersList.find((e=>e.user_id===t)),r=!!Array.isArray(n.skills)&&n.skills;this.selectedRow=e,r?(this._usersDrawerCollection=r,this.drawerReady=!0):(0,_.SC)("skills/skills_by_user",{data:{user_id:t,skills:i}},(e=>{n.skills=e,this._usersDrawerCollection=n.skills,this.drawerReady=!0}))}fetchUsersBySkill(e){const{sk_id:t,users:i,lvl:n}=e,r=this._skillsList.find((e=>e.sk_id===t)),s=!!Array.isArray(r.users)&&r.users;this.selectedRow=e;const o=(e,t)=>(this._skillDrawerCollection=t>=0?e.filter((e=>3===t?!e.manager_level:e.manager_level==t+1)):e,this.drawerReady=!0);s?o(s,n):(0,_.SC)("skills/users_by_skills",{data:{sk_id:t,users:i}},(e=>(r.users=e,o(e,n))))}setSkillLevelFromSkillTable(e){let{user_id:t,sk_id:i,val:n}=e;const r={sk_id:i,user_id:t,manager_level:n},s=this._skillDrawerCollection.find((e=>e.user_id===t)),o=s.manager_level;(0,_.SC)("skills/set_level",{method:"POST",data:r},(()=>{const e=this._skillsList.find((e=>e.sk_id===i));e[`lvl_${[0,1,2,3].includes(parseInt(o))?o:"u"}`]=--e[`lvl_${[0,1,2,3].includes(parseInt(o))?o:"u"}`],e[`lvl_${n}`]=++e[`lvl_${n}`],s.manager_level=n}))}setSkillLevelFromUserTable(e,t){let{user_id:i,sk_id:n,val:r}=e;const s={sk_id:n,user_id:i,manager_level:r},o=this._usersDrawerCollection.find((e=>e.sk_id===n));(0,_.SC)("skills/set_level",{method:"POST",data:s},(()=>{o.manager_level=r;const e=this._usersList.find((e=>e.user_id===i)),n=e.skills.filter((e=>!e.manager_level)).length;return e.rank_status=n,t(!0)}))}buildTabs(){this.tabs.push({val:"skill_ranking",label:lng("skill ranking",{phrase:!0})}),this.tabs.push({val:"skills_map",label:lng("skills map",{phrase:!0})}),this.tabs.push({val:"skills_list",label:lng("skills list",{phrase:!0})}),this.selectTab(this.activeTab)}}).prototype,"ready",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=D(n.prototype,"activeTab",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"skill_ranking"}}),o=D(n.prototype,"showDrawer",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),a=D(n.prototype,"_skillsList",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),l=D(n.prototype,"_usersList",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),c=D(n.prototype,"_skillDrawerCollection",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=D(n.prototype,"_usersDrawerCollection",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=D(n.prototype,"filterSortTable",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,y.Cy)()}}),u=D(n.prototype,"filterSortSubTable",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,y.Cy)()}}),m=D(n.prototype,"drawerReady",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=D(n.prototype,"selectedRow",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),h=D(n.prototype,"activeOu",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D(n.prototype,"updateRoute",[b.action],Object.getOwnPropertyDescriptor(n.prototype,"updateRoute"),n.prototype),D(n.prototype,"skillsList",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"skillsList"),n.prototype),D(n.prototype,"usersList",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"usersList"),n.prototype),D(n.prototype,"skillTableCollection",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"skillTableCollection"),n.prototype),D(n.prototype,"userTableCollection",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"userTableCollection"),n.prototype),n);var P,z,E,R,F,M,A,q,X,L,$,V,U,H,J,G,W,K,Y,Q,ee,te,ie,ne,re;function se(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function oe(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ae(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const le=(0,v.createContext)(null),ce=e=>{switch(e){case"personal":return lng("bookmarks");case"recommended":return lng("recommended");case"ou":return lng("org' unit");case"assignments":return lng("assignments");case"groups":return lng("workspaces");case"skills":return lng("skills")}return e};let de=(P=b.observable.shallow,z=b.action.bound,E=b.action.bound,R=b.action.bound,F=b.action.bound,M=b.action.bound,A=b.action.bound,q=b.action.bound,X=b.action.bound,L=b.action.bound,V=ae(($=class{constructor(e){let{nav:t}=e;se(this,"ready",V,this),se(this,"_activeDashboard",U,this),se(this,"activeOu",H,this),se(this,"assignmentsFilters",J,this),se(this,"groupsFilters",G,this),se(this,"personalFilters",W,this),se(this,"recommendedFilters",K,this),se(this,"_searchTagRelation",Y,this),se(this,"totalCount",Q,this),se(this,"loadingMore",ee,this),se(this,"nexPage",te,this),oe(this,"dashboards",[]),oe(this,"ous",null),se(this,"_data",ie,this),se(this,"selectedTags",ne,this),oe(this,"important_tags",[]),se(this,"removeBookmarkFromTab",re,this),(0,b.makeObservable)(this),this.nav=t,(0,_.SC)("dashboard//sidebar=1",{},(0,b.action)((e=>{const t=e.bookmarks;var i,n;(this.important_tags=null==e?void 0:e.important_tags,t)&&(Blsm.isFeatureEnabled("personal_dashboard")&&(null!==(i=t.recommended)&&void 0!==i&&i.filter((e=>parseInt(e.share_with_all)>0)).length&&this.dashboards.push("recommended"),null!==(n=t.personal)&&void 0!==n&&n.filter((e=>parseInt(e.widget_order)>0)).length&&this.dashboards.push("personal")));Blsm.isFeatureEnabled("dashboard_assignments_workspaces")&&(this.dashboards.push("assignments"),this.dashboards.push("groups")),Blsm.isFeatureEnabled("personal_dashboard")&&Blsm.user.perm.isOuViewer&&this.dashboards.push("ou"),Blsm.isFeatureEnabled("skills_occupations")&&Blsm.user.isManager&&this.dashboards.push("skills"),this.ready=!0})))}updateRoute(e){let[t]=e;this._activeDashboard=t}get activeDashboard(){return this.dashboards.includes(this._activeDashboard)?this._activeDashboard:this.dashboards[0]}set activeDashboard(e){this.nav([e],{replace:!0})}get searchTagRelation(){return this._searchTagRelation[this.activeDashboard]}setSearchTagRelation(e){this._searchTagRelation[this.activeDashboard]=e}get dashboardData(){const e=this.activeDashboard;let t=e;if("ou"===e)t+=`_${this.activeOu}`,this._data.has(t)||(this._data.set(t,"loading"),this.activeOu?(0,_.SC)("groups/reports_data/group_id="+this.activeOu,{},(0,b.action)((e=>e.reports&&this._data.set(t,e.reports)))):this.fetchOus(t));else if("skills"===e){this.fetchOus();const e=new j({nav:this.nav,user:Blsm.user.id});this._data.set(t,e)}else{var i;const l=this[t+"Filters"],c=0===Object.keys((null==l?void 0:l.filter)||[]).length&&""===(null==l||null===(i=l.sort)||void 0===i?void 0:i.by);if("assignments"!==t&&"groups"!==t||c||(t+=(0,w.SZ)((0,b.toJS)(this[t+"Filters"]))),this._data.has(t)){if(["personal","recommended"].includes(e))return(0,y.WB)(this._data.get(e),this[this.activeDashboard+"Filters"].filter,{},{filters:this.customFuncFilters})}else{var n,r,s,o,a;this._data.set(t,"loading");const i={filters:null===(n=this[e+"Filters"])||void 0===n?void 0:n.filter,sort:null===(r=this[e+"Filters"])||void 0===r||null===(s=r.sort)||void 0===s?void 0:s.by,reverse:null===(o=this[e+"Filters"])||void 0===o||null===(a=o.sort)||void 0===a?void 0:a.desc,dashboard:!0};e&&(0,_.SC)(`dashboard/${e}`,{data:i},(0,b.action)((i=>{const n="recommended"===t?"share_with_all":"widget_order";let r=i[e]||i.bookmarks[e];r&&["recommended","personal"].includes(e)?(r.map((e=>(e.menuOptions=this.getMenuOptions(e),e.tags=e.tags.length>0?e.tags.split(","):[],e))),this._data.set(t,r.filter((e=>parseInt(e[n])>0)).sort(((e,t)=>e[n]-t[n])))):(this.totalCount=i[e+"_count"],r=r.map((t=>"groups"===e?new B.j(t,{display:"dashboard"}):new T.o(t,{display:"dashboard"}))),r&&this._data.set(t,r))})))}}return this._data.get(t)}get customFuncFilters(){const e=(e,t)=>{if("AND"===this.searchTagRelation){if(e.filter((e=>{var i;return null===(i=t.tags)||void 0===i?void 0:i.includes(e)})).length===e.length)return t}else if("OR"===this.searchTagRelation&&e.filter((e=>{var i;return null===(i=t.tags)||void 0===i?void 0:i.includes(e)})).length>0)return t};return[{name:"tags",func:(t,i)=>e(t,i)}]}fetchOus(e){(0,_.SC)("dashboard/ou/",{},(t=>{var i;const n=(null===(i=t.ous)||void 0===i?void 0:i.reduce(((e,t)=>[...e,...(0,f.Jf)(t.map((e=>{let[,t]=e;return{id:t.group_id,name:t.group_name,parent:t.parent}})))]),[]))||[];n.length>0?(this.ous=n,this.activeOu=this.ous[0].id):this._data.set(e,!1)}))}toggleTagSelection(e){void 0===e?this.selectedTags[this.activeDashboard].clear():(null==e||e.forEach((e=>this.selectedTags[this.activeDashboard].add(e))),[...this.selectedTags[this.activeDashboard]].filter((t=>!(null!=e&&e.includes(t)))).forEach((e=>this.selectedTags[this.activeDashboard].delete(e))))}removeTag(e){this.selectedTags[this.activeDashboard].delete(e),this[this.activeDashboard+"Filters"].filter.tags=[...this.selectedTags[this.activeDashboard]]}clearTagSelection(){this.selectedTags[this.activeDashboard].clear(),this[this.activeDashboard+"Filters"].filter.tags=[]}getTags(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new Set;return"loading"!==this.dashboardData&&this.dashboardData.forEach((i=>{var n;return null==i||null===(n=i.tags)||void 0===n?void 0:n.forEach((i=>{var n,r;(!e&&(null===(n=this.important_tags)||void 0===n||!n.includes(i))||e&&null!==(r=this.important_tags)&&void 0!==r&&r.includes(i))&&t.add(i)}))})),[...t].sort().map((e=>{var t;return{tag:e,disabled:!(null!==(t=this[this.activeDashboard+"Filters"].filter.tags)&&void 0!==t&&t.includes(e))}}))}sortBookmark(e){var t;let{new_order:i,moved_id:n}=e;const r=this.activeDashboard,s=null===(t=this._data.get(r))||void 0===t?void 0:t.slice();if(!s)return;const o=s.findIndex((e=>e.bookmark_id===n)),a=i.findIndex((e=>e===n));o!==a&&(s.splice(a,0,s.splice(o,1)[0]),this._data.set(r,s),(0,_.SC)("bookmarks/widget_order",{method:"POST",data:{tab:r,new_order:i.join(",")}}))}get editable(){const e=this.activeDashboard;return"personal"===e||"recommended"===e&&Blsm.user.isPowerManager}getMenuOptions(e){let t=[];switch(this.activeDashboard){case"assignments":t=(0,C.q)(e.assignment_id_org,e.assignment_type,"regular").filter((e=>e)).map((e=>({label:e.title,href:e.href})));break;case"groups":t=[{label:lng("grades report"),href:(0,x.p4)({report:"CourseGradesReport",params:{group:e.group_id}})},{label:lng("status report"),href:(0,x.p4)({report:"ReportGroupStatus",params:{group:e.group_id}})},{label:lng("instructors report"),href:(0,x.p4)({report:"ReportCoursesinstructors",params:{group:e.group_id}})},{label:lng("social report"),href:(0,x.p4)({report:"SocialReport",params:{group:e.group_id}})},{label:lng("meetings report"),href:(0,x.p4)({report:"meetings",params:{group:e.group_id}})},e.is_course&&Blsm.isFeatureEnabled("course_monitoring")&&Blsm.user.isPowerManager&&{label:lng("course monitoring"),href:(0,x.p4)({report:"ReportCourseMonitoring",params:{group:e.group_id}})}];break;case"personal":case"recommended":this.mayEdit(e.bookmark_id)&&(t=[{label:lng("edit"),onClick:()=>this.editBookmark(e)},{label:lng("delete"),onClick:()=>this.deleteBookmark(e.bookmark_id)}])}return t}mayEdit(e){var t,i;return Blsm.user.isPowerManager||(null===(t=this._data.get("personal"))||void 0===t||null===(i=t.some)||void 0===i?void 0:i.call(t,(t=>t.bookmark_id===e)))}editBookmark(e){const t=e.bookmark_url,i=new O.T({bookmarkId:e.bookmark_id,activeReport:e.dashboard_data.report_name,parameters:t.parameters,onSaveSuccess:t=>{(0,Z.vm)().closeDialog(),(0,Z.vm)().invalidateStore("reports");const n=null==t?void 0:t.bookmarkInfo;n.menuOptions=this.getMenuOptions(n);const r=i.values.get("personal_dashboard"),s=i.values.get("share_with_all");["personal","recommended"].forEach((t=>{var i;const o=null===(i=this._data.get(t))||void 0===i?void 0:i.filter((t=>t.bookmark_id===e.bookmark_id));var a;if((null==o?void 0:o.length)>0)null===(a=this._data.get(t))||void 0===a||a.map((i=>{i.bookmark_id==n.bookmark_id&&("personal"===t&&(r?this._data.set(t,this._data.get(t).map((e=>e.bookmark_id===n.bookmark_id?n:e))):this.removeBookmarkFromTab(t,e.bookmark_id)),"recommended"===t&&(s?this._data.set(t,this._data.get(t).map((e=>e.bookmark_id===n.bookmark_id?n:e))):this.removeBookmarkFromTab(t,e.bookmark_id)))}));else if(r&&"personal"==t||s&&"recommended"===t){const e=this._data.get(t)||[];e.push(n),this._data.set(t,e)}}))}});(0,Z.vm)().openDialog("form",i)}deleteBookmark(e){(0,k.BB)(lng("are you sure you want to delete this bookmark?"),{onConfirm:()=>{(0,Z.vm)().invalidateStore("reports"),Blsm.user.isPowerManager?["personal","recommended"].forEach((t=>this.removeBookmarkFromTab(t,e))):this.removeBookmarkFromTab("personal",e),(0,_.SC)("reports/action/delete_bookmark",{data:{bm_id:e},method:"POST"},(()=>{(0,S.qV)(lng("bookmarks deleted successfully"))}))}})}get moreAvailable(){var e,t;return this.activeDashboard&&(null===(e=this.dashboardData)||void 0===e?void 0:e.length)>0&&this.totalCount>(null===(t=this.dashboardData)||void 0===t?void 0:t.length)}activeDashboardKey(){return"assignments"===this.activeDashboard?"assignment_dashboard_id":"group_id"}getMore(){this.loadingMore=!0,this.nexPage++,(0,_.SC)("dashboard/"+this.activeDashboard,{data:{page:this.nexPage}},(e=>{var t,i;if((null===(t=e[this.activeDashboard])||void 0===t?void 0:t.length)>0){const t=this._data.get(this.activeDashboard).slice();e[this.activeDashboard].forEach((e=>{var i;null!==(i=this._data.get(this.activeDashboard))&&void 0!==i&&i.some((t=>t[this.activeDashboardKey()]===e[this.activeDashboardKey()]))||null==t||t.push("groups"===this.activeDashboard?new B.j(e,{display:"dashboard"}):new T.o(e,{display:"dashboard"}))})),this._data.set(this.activeDashboard,t)}else this.totalCount=(null===(i=this._data.get(this.activeDashboard))||void 0===i?void 0:i.length)-1;this.loadingMore=!1}))}}).prototype,"ready",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),U=ae($.prototype,"_activeDashboard",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=ae($.prototype,"activeOu",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=ae($.prototype,"assignmentsFilters",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,y.Cy)()}}),G=ae($.prototype,"groupsFilters",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,y.Cy)()}}),W=ae($.prototype,"personalFilters",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,y.Cy)()}}),K=ae($.prototype,"recommendedFilters",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,y.Cy)()}}),Y=ae($.prototype,"_searchTagRelation",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{personal:"AND",recommended:"AND"}}}),Q=ae($.prototype,"totalCount",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ee=ae($.prototype,"loadingMore",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),te=ae($.prototype,"nexPage",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ie=ae($.prototype,"_data",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),ne=ae($.prototype,"selectedTags",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{personal:new Set,recommended:new Set}}}),ae($.prototype,"updateRoute",[b.action],Object.getOwnPropertyDescriptor($.prototype,"updateRoute"),$.prototype),ae($.prototype,"setSearchTagRelation",[z],Object.getOwnPropertyDescriptor($.prototype,"setSearchTagRelation"),$.prototype),ae($.prototype,"dashboardData",[b.computed],Object.getOwnPropertyDescriptor($.prototype,"dashboardData"),$.prototype),ae($.prototype,"toggleTagSelection",[E],Object.getOwnPropertyDescriptor($.prototype,"toggleTagSelection"),$.prototype),ae($.prototype,"removeTag",[R],Object.getOwnPropertyDescriptor($.prototype,"removeTag"),$.prototype),ae($.prototype,"clearTagSelection",[F],Object.getOwnPropertyDescriptor($.prototype,"clearTagSelection"),$.prototype),ae($.prototype,"getTags",[M],Object.getOwnPropertyDescriptor($.prototype,"getTags"),$.prototype),ae($.prototype,"sortBookmark",[A],Object.getOwnPropertyDescriptor($.prototype,"sortBookmark"),$.prototype),ae($.prototype,"editable",[b.computed],Object.getOwnPropertyDescriptor($.prototype,"editable"),$.prototype),ae($.prototype,"editBookmark",[q],Object.getOwnPropertyDescriptor($.prototype,"editBookmark"),$.prototype),re=ae($.prototype,"removeBookmarkFromTab",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i;this._data.set(e,null===(i=this._data.get(e))||void 0===i?void 0:i.filter((e=>e.bookmark_id!==t)))}}}),ae($.prototype,"getMore",[L],Object.getOwnPropertyDescriptor($.prototype,"getMore"),$.prototype),$)},2115:(e,t,i)=>{i.d(t,{$:()=>g,C:()=>m});var n,r,s,o=i(7821),a=i(8e3),l=i(5832),c=i(2334);function d(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let m=(r=u((n=class{constructor(e){let{nav:t}=e;p(this,"nav",void 0),d(this,"ready",r,this),d(this,"filterSortObj",s,this),(0,o.makeObservable)(this),this.nav=t,this.fetch()}updateRoute(){}fetch(){(0,a.SC)("overview/discussions",{method:"GET"},(0,o.action)((e=>{var t;this.discussions=null===(t=e.discussions)||void 0===t?void 0:t.map((e=>new g(e))),this.ready=!0})))}get filteredDiscussions(){return(0,l.WB)(this.discussions,this.filterSortObj.filter,this.filterSortObj.sort)}}).prototype,"ready",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=u(n.prototype,"filterSortObj",[o.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,l.Cy)()}}),u(n.prototype,"updateRoute",[o.action],Object.getOwnPropertyDescriptor(n.prototype,"updateRoute"),n.prototype),u(n.prototype,"filteredDiscussions",[o.computed],Object.getOwnPropertyDescriptor(n.prototype,"filteredDiscussions"),n.prototype),n);class g{constructor(e){p(this,"data",void 0),this.data=e}get type(){return"discussion"}get id(){return"d_"+this.data.discussion_id}get discussion_id(){return this.data.discussion_id}get title(){return this.data.title}get user(){return this.data.user}get comments_count(){return this.data.comments_count}get date(){return(0,c._3)(this.data.last_modified)}get group_name(){return this.data.patient_name?this.data.group_name+" - "+this.data.patient_name:this.data.group_name}}},1612:(e,t,i)=>{i.d(t,{U:()=>J,W:()=>H});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_=i(7821),f=i(7363),y=i(6259),w=i(2645),x=i(8e3),k=i(919),Z=i(5832),C=i(8318);function S(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function O(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function B(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let T=(n=_.action.bound,r=_.action.bound,s=_.action.bound,o=_.action.bound,a=class{constructor(e){let{nav:t}=e;S(this,"ready",l,this),S(this,"content",c,this),S(this,"followed_content",d,this),S(this,"filterNsort",p,this),S(this,"currentContent",u,this),O(this,"filtersArr",null),O(this,"first_fetch",!0),O(this,"_internalNav",!0),S(this,"sideMenu",m,this),O(this,"providers",[]),O(this,"categories",[]),O(this,"importantCategories",[]),S(this,"selectedCategories",g,this),S(this,"searchTagRelation",h,this),S(this,"filter_skills",b,this),S(this,"filterSkillsRelation",v,this),(0,_.makeObservable)(this),this.nav=t;const i=(0,C.Ds)((()=>this.nav([this._filtersToObject()],{replace:!0})),500);(0,_.observe)(this.filterNsort,(()=>!this._internalNav&&i()))}toggleSideMenu(e){this.currentContent=e,this.sideMenu=!this.sideMenu}follow(e){e.following||this.followed_content.find((t=>t.oc_id==e.oc_id))||(this.followed_content=[e,...this.followed_content]),e.following=!e.following}_filtersToObject(){return(0,C.v7)((0,_.toJS)(this.filterNsort.filter))}updateNav(){this.nav([this._filtersToObject()],{replace:!0})}updateRoute(e){var t;let[i]=e;this.loading=!0,this._internalNav=!0,this.filterNsort.filter=i||{},null==i||null===(t=i.category)||void 0===t||t.forEach((e=>this.selectedCategories.add(e))),this._internalNav=!1,this._fetch()}_fetch(){var e;this.loading=!0,null===(e=this._curFetch)||void 0===e||e.abortFetch();const t=this.filterNsort?this._filtersToObject():{};t.skills_filter_relation=this.filterSkillsRelation,t.first_fetch=Number(this.first_fetch),this._curFetch=(0,x.SC)("content/online_content",{data:t},(0,_.action)((e=>{var t,i,n;this.first_fetch=!1,this.content=(null===(t=e.content)||void 0===t?void 0:t.map((e=>new k.O(e,this))))||[],e.filter_skills&&e.filter_skills.length>0&&(this.filter_skills=(null==e?void 0:e.filter_skills)||[]),this.importantCategories=(null==e||null===(i=e.important_categories)||void 0===i?void 0:i.map((e=>({val:e,label:e}))))||this.importantCategories,e.providers&&(this.providers=e.providers.map((e=>({val:e,label:(0,k.V)(e)})))),e.categories&&(this.categories=e.categories.map((e=>({val:e,label:e}))).filter((t=>{var i;return!(null!=e&&null!==(i=e.important_categories)&&void 0!==i&&i.includes(t.val))}))),e.following&&(this.followed_content=(null===(n=e.following)||void 0===n?void 0:n.map((e=>new k.O(e,this))))||[]);const r=[{label:"",val:""},{label:lng("less than hour"),val:"0-60"},{label:lng("1 to 6 hours"),val:"60-360"},{label:lng("6 to 24 hours"),val:"360-1440"},{label:lng("24 hours to 1 week"),val:"1440-1w"},{label:lng("1 to 2 weeks"),val:"1w-2w"},{label:lng("2 to 4 weeks"),val:"2w-4w"},{label:lng("more than 4 weeks"),val:"4w-1000w"}];this.filtersArr=[{type:"search",name:"term",placeholder:lng("search").caps(),outOfMenu:!0,wrapped:!0},{type:"select_multi",name:"provider",label:lng("provider"),outOfMenu:!0,wrapped:!0,options:this.providers},{type:"select",name:"duration",label:lng("duration"),outOfMenu:!0,wrapped:!0,options:r},{type:"multiple_items",name:"filter_skills",showId:!1,showList:!1,valueIsMap:!0,objectKeys:["id","skill_id","label"],label:lng("skills"),theme:"bright",outOfMenu:!0,searchData:(e,t)=>{let{term:i,ids:n}=e;return(0,x.SC)("skills/autocomplete_skill",{data:{term:i,id:n,coupled:1}},t)},onSelect:e=>{var t;null!==(t=this.filter_skills)&&void 0!==t&&t.find((t=>t.sk_id===e.id))||(this.filterNsort.filter.filter_skills=this.filterNsort.filter.filter_skills?[...this.filterNsort.filter.filter_skills,e.id]:[e.id],this.filter_skills.push({sk_id:e.id,skill_id:e.skill_id,name:e.label}))},onClear:e=>{this.filterNsort.filter.filter_skills=e?this.filterNsort.filter.filter_skills.filter((t=>parseInt(t)!==parseInt(e.sk_id))):[],this.filter_skills.replace(e?this.filter_skills.filter((t=>parseInt(t.sk_id)!==parseInt(e.sk_id))):[])}}],this.loading=!1,this.ready=!0})))}removeTag(e){this.selectedCategories.delete(e),this.filterNsort.filter.category=[...this.selectedCategories],this.updateNav()}toggleCategoriesSelection(e){e&&(void 0===e?this.selectedCategories.clear():(null==e||e.forEach((e=>this.selectedCategories.add(e))),[...this.selectedCategories].filter((t=>!(null!=e&&e.includes(t)))).forEach((e=>this.selectedCategories.delete(e)))),this.filterNsort.filter.category=e,this.updateNav())}clearTagSelection(){this.selectedCategories.clear(),this.filterNsort.filter.category=[],this.updateNav()}},l=B(a.prototype,"ready",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=B(a.prototype,"content",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=B(a.prototype,"followed_content",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=B(a.prototype,"filterNsort",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,Z.Cy)()}}),u=B(a.prototype,"currentContent",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=B(a.prototype,"sideMenu",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=B(a.prototype,"selectedCategories",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),h=B(a.prototype,"searchTagRelation",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"OR"}}),b=B(a.prototype,"filter_skills",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=B(a.prototype,"filterSkillsRelation",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"OR"}}),B(a.prototype,"updateNav",[n],Object.getOwnPropertyDescriptor(a.prototype,"updateNav"),a.prototype),B(a.prototype,"updateRoute",[_.action],Object.getOwnPropertyDescriptor(a.prototype,"updateRoute"),a.prototype),B(a.prototype,"removeTag",[r],Object.getOwnPropertyDescriptor(a.prototype,"removeTag"),a.prototype),B(a.prototype,"toggleCategoriesSelection",[s],Object.getOwnPropertyDescriptor(a.prototype,"toggleCategoriesSelection"),a.prototype),B(a.prototype,"clearTagSelection",[o],Object.getOwnPropertyDescriptor(a.prototype,"clearTagSelection"),a.prototype),a);var N,I,D,j,P,z,E,R,F,M,A,q=i(8918),X=i(7659),L=i(4821);function $(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function V(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function U(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const H=(0,f.createContext)(null);let J=(N=_.action.bound,D=U((I=class{constructor(e){var t,i;let{nav:n}=e;$(this,"ready",D,this),V(this,"tabs",[{val:"main",label:lng("recommended"),icon:"for_u"}]),$(this,"_activeTab",j,this),V(this,"_stores",{cregistration:null,catalog:null,ocontent:null,main:null,channels:null}),V(this,"_typeToStoreClass",{cregistration:w.iS,catalog:y.Z,ocontent:T,main:G,channels:W}),(0,_.makeObservable)(this),(null!==(t=Blsm.InitialData.main_menu)&&void 0!==t&&t.coursecatalog||null!==(i=Blsm.InitialData.main_menu)&&void 0!==i&&i.manager_coursecatalog)&&this.tabs.push({val:"cregistration",label:lng("courses"),icon:"menu_workspaces"}),Blsm.isFeatureEnabled("catalog")&&this.tabs.push({val:"catalog",label:lng("content"),icon:"content"}),Blsm.isFeatureEnabled("online_content")&&this.tabs.push({val:"ocontent",label:lng("online content"),icon:"online_content"}),Blsm.isFeatureEnabled("channels")&&this.tabs.push({val:"channels",label:lng("channels"),icon:"channel"}),this.nav=n}updateNav(){this.nav([this.activeTab],{replace:!0})}updateRoute(e){var t;let[i,...n]=e;this._activeTab=i,null===(t=this.tabStore(i))||void 0===t||t.updateRoute(n)}tabStore(e){return e in this._stores&&!this._stores[e]&&(this._stores[e]=new this._typeToStoreClass[e]({nav:(t,i)=>this.nav([e,...t],i)})),this._stores[e]}get activeTab(){return this.tabs.map((e=>e.val)).includes(this._activeTab)?this._activeTab:this.tabs[0].val}set activeTab(e){this._activeTab=e,this.updateNav()}}).prototype,"ready",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),j=U(I.prototype,"_activeTab",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),U(I.prototype,"updateNav",[N],Object.getOwnPropertyDescriptor(I.prototype,"updateNav"),I.prototype),U(I.prototype,"updateRoute",[_.action],Object.getOwnPropertyDescriptor(I.prototype,"updateRoute"),I.prototype),U(I.prototype,"activeTab",[_.computed],Object.getOwnPropertyDescriptor(I.prototype,"activeTab"),I.prototype),I),G=(z=U((P=class{constructor(e){let{nav:t}=e;$(this,"ready",z,this),$(this,"sideMenu",E,this),(0,_.makeObservable)(this),this.nav=t,this.ready=!1,this.fetch()}toggleSideMenu(e){this.currentContent=e,this.sideMenu=!this.sideMenu}updateRoute(){}fetch(){(0,x.SC)("library/page",{},(e=>{var t,i,n,r,s,o,a;this.popular=null===(t=e.popular)||void 0===t?void 0:t.map((e=>e.assignment_id?new X.m(e):e.group_id?new q.N(e):void 0)),this.recent=null===(i=e.recent)||void 0===i?void 0:i.map((e=>e.assignment_id?new X.m(e):e.group_id?new q.N(e):void 0)),this.skills=null===(n=e.skills)||void 0===n?void 0:n.map((e=>"OnlineContent"===e.group_type?new k.O(e):e.assignment_id?new X.m(e):e.group_id?new q.N(e):void 0)),this.unfinished=null===(r=e.unfinished)||void 0===r?void 0:r.map((e=>e.assignment_id?new X.m(e):e.group_id?new q.N(e):void 0)),this.bookmarked=null===(s=e.bookmarked)||void 0===s?void 0:s.map((e=>e.assignment_id?new X.m(e):e.group_id?new q.N(e):void 0)),this.followedOc=null===(o=e.followed_oc)||void 0===o?void 0:o.map((e=>new k.O(e))),this.channels=null===(a=e.channels)||void 0===a?void 0:a.map((e=>new L.$(e))),this.ready=!0}))}}).prototype,"ready",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),E=U(P.prototype,"sideMenu",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),U(P.prototype,"updateRoute",[_.action],Object.getOwnPropertyDescriptor(P.prototype,"updateRoute"),P.prototype),P),W=(F=U((R=class{constructor(e){let{nav:t}=e;$(this,"ready",F,this),$(this,"_channels",M,this),$(this,"filterNsort",A,this),V(this,"filtersArr",null),V(this,"sortsArr",null),(0,_.makeObservable)(this),this.nav=t,this.fetch()}updateRoute(){}fetch(){(0,x.SC)("channel/list_channels",{},(e=>{this._channels=e.map((e=>new L.$(e))),this.filtersArr=[{name:"channel_name",label:lng("channel name").caps(),type:"search",outOfMenu:!0,wrapped:!0},{name:"full_name",label:lng("user name").caps(),type:"search",outOfMenu:!0,wrapped:!0}],this.sortsArr=[{val:"",label:lng("default")},{val:"channel_name",label:lng("channel name").caps()},{val:"followers",label:lng("followers").caps()},{val:"playlists",label:lng("playlists").caps()}],this.ready=!0}))}get channels(){return(0,Z.WB)(this._channels,this.filterNsort.filter,this.filterNsort.sort)}}).prototype,"ready",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),M=U(R.prototype,"_channels",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),A=U(R.prototype,"filterNsort",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,Z.Cy)()}}),U(R.prototype,"updateRoute",[_.action],Object.getOwnPropertyDescriptor(R.prototype,"updateRoute"),R.prototype),U(R.prototype,"channels",[_.computed],Object.getOwnPropertyDescriptor(R.prototype,"channels"),R.prototype),R)},6691:(e,t,i)=>{i.d(t,{Ou:()=>F,Zm:()=>z,v0:()=>E});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_,f,y,w,x,k,Z,C,S,O=i(7821),B=i(8e3),T=i(7363),N=i(5832),I=i(1019);function D(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function P(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const z=(0,T.createContext)(null);let E=(r=P((n=class{constructor(e){let{id:t,onSuccess:i,msgStore:n}=e;D(this,"ready",r,this),D(this,"replyForm",s,this),D(this,"filterNsort",o,this),j(this,"msgStore",void 0),j(this,"id",null),(0,O.makeObservable)(this),this.id=t,this.msgStore=n,this.fetch({id:t,onSuccess:i})}fetch(e){let{id:t,onSuccess:i}=e;"string"==typeof t&&(this.id=t,(0,B.SC)(`messages/get/${this.id}`,{},(0,O.action)((e=>{(0,O.extendObservable)(this,e),this.ready=!0,null==i||i()}))))}hideReplyForm(){this.filterNsort.filter.users=null,this.replyForm=null}showReplyForm(e){this.replyForm=new I.Z(this,this.msgStore),this.replyForm.updateValue(e,"message_to_user",!1),this.filterNsort.filter.users=e}}).prototype,"ready",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=P(n.prototype,"replyForm",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=P(n.prototype,"filterNsort",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,N.Cy)()}}),P(n.prototype,"hideReplyForm",[O.action],Object.getOwnPropertyDescriptor(n.prototype,"hideReplyForm"),n.prototype),P(n.prototype,"showReplyForm",[O.action],Object.getOwnPropertyDescriptor(n.prototype,"showReplyForm"),n.prototype),n),R=(a=O.action.bound,c=P((l=class{constructor(e){j(this,"box",""),D(this,"messages",c,this),D(this,"unreadCount",d,this),D(this,"storedPage",p,this),D(this,"curPage",u,this),D(this,"totalItems",m,this),D(this,"pageSize",g,this),D(this,"toggleUserMsgs",h,this),D(this,"searchTerm",b,this),D(this,"storedSearchTerm",v,this),D(this,"loading",_,this),(0,O.makeObservable)(this),this.box=e}listen(){(0,O.autorun)((()=>{this.storedPage===this.curPage&&0===this.toggleUserMsgs||this.getMessages(),this.storedSearchTerm!==this.searchTerm&&(clearTimeout(this.__delayTimeout),this.__delayTimeout=setTimeout((()=>{this.curPage>0?this.curPage=0:this.getMessages()}),300))}))}getMessages(){this.loading=!0,(0,B.SC)(`messages/box/${this.box}`,{data:{page:this.curPage,get_total:!0,user_messages:this.toggleUserMsgs,term:this.searchTerm}},(0,O.action)((e=>{this.unreadCount=e.unread_count,this.storedPage=this.curPage,this.storedSearchTerm=this.searchTerm,this.messages.replace(e.items),this.totalItems=parseInt(e.count)||0,this.pageSize=parseInt(e.page_size),this.loading=!1})))}invalidate(){this.storedPage=null}removeMessageById(e){this.messages.splice(this.messages.findIndex((t=>t.message_id==e)),1)}removeMessagesById(e){this.messages.replace(this.messages.filter((t=>!e.includes(t.message_id))))}appendMessages(e){for(const t of e)this.messages.unshift(t)}setIsRead(e,t){for(const i of this.messages)e.includes(i.message_id)&&(i.is_read=t)}}).prototype,"messages",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),d=P(l.prototype,"unreadCount",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),p=P(l.prototype,"storedPage",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u=P(l.prototype,"curPage",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=P(l.prototype,"totalItems",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=P(l.prototype,"pageSize",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=P(l.prototype,"toggleUserMsgs",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),b=P(l.prototype,"searchTerm",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),v=P(l.prototype,"storedSearchTerm",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_=P(l.prototype,"loading",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P(l.prototype,"listen",[O.action],Object.getOwnPropertyDescriptor(l.prototype,"listen"),l.prototype),P(l.prototype,"getMessages",[a],Object.getOwnPropertyDescriptor(l.prototype,"getMessages"),l.prototype),P(l.prototype,"removeMessageById",[O.action],Object.getOwnPropertyDescriptor(l.prototype,"removeMessageById"),l.prototype),P(l.prototype,"removeMessagesById",[O.action],Object.getOwnPropertyDescriptor(l.prototype,"removeMessagesById"),l.prototype),P(l.prototype,"appendMessages",[O.action],Object.getOwnPropertyDescriptor(l.prototype,"appendMessages"),l.prototype),P(l.prototype,"setIsRead",[O.action],Object.getOwnPropertyDescriptor(l.prototype,"setIsRead"),l.prototype),l),F=(f=O.observable.shallow,w=P((y=class{constructor(e){let{nav:t,mainStore:i}=e;D(this,"ready",w,this),j(this,"boxes",{}),D(this,"_activeBoxKey",x,this),D(this,"_activeMsgId",k,this),D(this,"_queryParams",Z,this),D(this,"_msgs",C,this),j(this,"draftSubject",null),j(this,"draftBody",null),j(this,"permission_types",[]),D(this,"checkedItems",S,this),j(this,"mainStore",void 0),(0,O.makeObservable)(this),this.mainStore=i,this.nav=t,this.fetch()}fetch(){(0,B.SC)("messages/init",{},(0,O.action)((e=>{var t;for(const t in e.boxes)this.boxes[t]=new R(t);this.activeBox.listen(),this.contexts=e.contexts,this.permission_types=e.permission_types,this.boxes.in.unreadCount=e.unread_count,this.mainStore.notificationsStore.inbox_unread_count=parseInt(this.boxes.in.unreadCount)+parseInt((null===(t=this.boxes.sys)||void 0===t?void 0:t.unreadCount)||0),this.ready=!0})))}get listBoxes(){return[{val:"in",label:lng("inbox")},{val:"out",label:lng("outbox")},{val:"archive",label:lng("archive|noun")},{val:"preset",label:lng("drafts")},{val:"deleted",label:lng("trash")},{val:"planned",label:lng("scheduled")}].map((e=>{var t;const i=null===(t=this.boxes[e.val])||void 0===t?void 0:t.unreadCount;return i>0&&(e.label+=` (${i})`),e}))}get activeBox(){return this.boxes[this.activeBoxKey]}set activeBox(e){e!==this.activeBoxKey&&(this.checkedItems=[],this.nav([e]))}get activeMsg(){if(!this.activeMsgId)return null;if("new"===this.activeMsgId)return this.activeMsgId;if(this._msgs.has(this.activeMsgId))return this._msgs.get(this.activeMsgId);{let e;const t=this.ready&&this.activeBox.messages.find((e=>e.message_id==this.activeMsgId));t&&["sys","in"].includes(this.activeBoxKey)&&!t.is_read&&(e=()=>{this.activeBox.unreadCount--,this.mainStore.notificationsStore.inbox_unread_count--}),this._msgs.set(this.activeMsgId,new E({id:this.activeMsgId,onSuccess:e,msgStore:this}))}return this._msgs.get(this.activeMsgId)}set activeMsg(e){this.draftSubject=null,this.draftBody=null,this.nav([this.activeBoxKey,e])}draft(e,t){this.draftSubject=e,this.draftBody=t,this.nav([this.activeBoxKey,"new"])}editPlanned(e,t){this.draftSubject=e,this.draftBody=t}get activeBoxKey(){return this._activeBoxKey||"in"}get activeMsgId(){return this._activeMsgId}get queryParams(){return this._queryParams}updateRoute(e){var t;let[i,n,r]=e;this._activeBoxKey=i,this._activeMsgId=n,this._queryParams=r||{},null===(t=this.boxes[i])||void 0===t||t.listen()}deleteActiveMsg(e){(0,B.SC)("messages/delete",{data:{message_id:this.activeMsg.message_id},method:"POST"},(()=>{null==e||e(this.activeMsg),this.activeBox.removeMessageById(this._activeMsgId),this.invalidateActiveMsg(),this.activeMsg=null}))}multiAction(e){let{action:t,onSuccess:i}=e;(0,B.SC)(`messages/${t}`,{data:{message_id:this.checkedItems},method:"POST"},(()=>{this.checkedItems.includes(this._activeMsgId)&&(this.activeMsg=null),null==i||i(),this.checkedItems=[]}))}invalidateActiveMsg(){this._msgs.delete(this._activeMsgId)}}).prototype,"ready",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),x=P(y.prototype,"_activeBoxKey",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"in"}}),k=P(y.prototype,"_activeMsgId",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=P(y.prototype,"_queryParams",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),C=P(y.prototype,"_msgs",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),S=P(y.prototype,"checkedItems",[O.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P(y.prototype,"listBoxes",[O.computed],Object.getOwnPropertyDescriptor(y.prototype,"listBoxes"),y.prototype),P(y.prototype,"activeBox",[O.computed],Object.getOwnPropertyDescriptor(y.prototype,"activeBox"),y.prototype),P(y.prototype,"activeMsg",[O.computed],Object.getOwnPropertyDescriptor(y.prototype,"activeMsg"),y.prototype),P(y.prototype,"draft",[O.action],Object.getOwnPropertyDescriptor(y.prototype,"draft"),y.prototype),P(y.prototype,"editPlanned",[O.action],Object.getOwnPropertyDescriptor(y.prototype,"editPlanned"),y.prototype),P(y.prototype,"activeBoxKey",[O.computed],Object.getOwnPropertyDescriptor(y.prototype,"activeBoxKey"),y.prototype),P(y.prototype,"activeMsgId",[O.computed],Object.getOwnPropertyDescriptor(y.prototype,"activeMsgId"),y.prototype),P(y.prototype,"queryParams",[O.computed],Object.getOwnPropertyDescriptor(y.prototype,"queryParams"),y.prototype),P(y.prototype,"updateRoute",[O.action],Object.getOwnPropertyDescriptor(y.prototype,"updateRoute"),y.prototype),y)},9415:(e,t,i)=>{i.d(t,{H:()=>p});var n,r=i(8e3),s=i(3380),o=i(7821),a=i(8318),l=i(2808);function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let p=(d((n=class extends s.Er{constructor(e){let{albumId:t,albumName:i}=e;super({}),c(this,"albumName",""),c(this,"albumId",null),(0,o.makeObservable)(this),this.albumName=i,this.albumId=t,t&&(0,r.SC)(`album/media/${this.albumId}`,{},this._load)}_load(e){(0,o.extendObservable)(this.tabs,{[this.albumName]:e.images}),this.activeTab=this.albumName,this.ready=!0}deleteItem(e){this.tabs[this.albumName].remove(e),(0,r.SC)(`album/photo/id=${e.file_id}&album_id=${this.albumId}&`,{method:"DELETE"})}uploadItems(e){for(const t of e){if(!this.extensions.includes((0,l.BX)(t.name)))continue;const e=(0,o.observable)({name:t.name,mf_id:"tmp_"+Math.floor(999999*Math.random()),imgtag:"",progress:0});this.tabs[this.activeTab].unshift(e),(0,r.Wi)(`album/photo/${this.albumId}&${(0,a.$t)({tab:this.activeTab,folder:this.activeFolder})}`,t,(0,o.action)((t=>{let i=t.inserts[0];Object.assign(e,i),e.mf_id=i.file_id,e.progress=void 0})),((t,i)=>e.progress=(0,a.NM)(100*t/i)),(()=>this.tabs[this.activeTab].remove(e)))}}renameFile(e){let{file_id:t,path:i,name:n}=e;(0,r.SC)("album/rename_file",{method:"POST",data:{file_id:t,path:i}},(()=>this.tabs[this.activeTab]=this.tabs[this.activeTab].map((e=>({...e,name:t===e.file_id?(i.split("/").length>1?i.split("/").slice(0,-1).join("/")+"/":"")+n+"."+(0,s.N)(e.name):e.name})))))}}).prototype,"_load",[o.override],Object.getOwnPropertyDescriptor(n.prototype,"_load"),n.prototype),d(n.prototype,"deleteItem",[o.override],Object.getOwnPropertyDescriptor(n.prototype,"deleteItem"),n.prototype),d(n.prototype,"uploadItems",[o.override],Object.getOwnPropertyDescriptor(n.prototype,"uploadItems"),n.prototype),d(n.prototype,"renameFile",[o.override],Object.getOwnPropertyDescriptor(n.prototype,"renameFile"),n.prototype),n)},9934:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(7821);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,n.extendObservable)(this,Object.assign({_checked:t},e))}},3380:(e,t,i)=>{i.d(t,{Er:()=>D,N:()=>I,aF:()=>P,bw:()=>T});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_,f,y=i(7821),w=i(8e3),x=i(7363),k=i(8318),Z=i(2808),C=i(8534);function S(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function O(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function B(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const T=(0,x.createContext)(null);function N(e){return null==e?void 0:e.replace(/[^/]+$/,"")}const I=e=>e.split(".")[e.split(".").length-1];let D=(n=y.action.bound,r=y.action.bound,s=y.action.bound,o=y.action.bound,a=y.action.bound,l=y.action.bound,c=y.action.bound,d=y.action.bound,p=y.action.bound,m=B((u=class{constructor(e){let{tabs:t,activeItemUrl:i,my:n}=e;S(this,"ready",m,this),O(this,"_tabKeys",[]),S(this,"tabs",g,this),S(this,"activeTab",h,this),S(this,"activeItem",b,this),S(this,"activeFolder",v,this),O(this,"_activeItemUrl",null),S(this,"search",_,this),S(this,"byMe",f,this),O(this,"allTabs",{portal:lng("portal"),questionnaire:lng("questionnaires"),images:lng("images"),my_images:lng("my images"),videos:lng("videos"),my_videos:lng("my videos"),gallery:lng("gallery")}),(0,y.makeObservable)(this),this._activeItemUrl=i,z(),t&&(t=Object.keys(this.allTabs).filter((e=>t.includes(e)||n&&t.includes(e.replace("my_","")))),Blsm.user.perm.mediaManagerGlobal||(t=t.filter((e=>e.startsWith("my_")||"gallery"===e))),this._tabKeys=t,this.fetch(t))}fetch(e){this.ready=!1,(0,w.SC)("media",{data:{tabs:e.join(",")}},this._load)}get extensions(){return Blsm.prm.extensions[/vid/.test(this.activeTab)?"vid":"img"]}deleteItem(e){const[t,i]=this._findMediaItem(e.imgtag);t&&(this.tabs[i].remove(t),(0,w.SC)("media/delete",{method:"POST",data:{mf_id:t.mf_id}}))}uploadItems(e){for(const t of e){if(!this.extensions.includes((0,Z.BX)(t.name))){(0,C.Mj)(lng("unsupported file type"));continue}const e=(0,y.observable)({name:t.name,mf_id:"tmp_"+Math.floor(999999*Math.random()),imgtag:"",progress:0});this.tabs[this.activeTab].unshift(e),(0,w.Wi)("media/file&"+(0,k.$t)({tab:this.activeTab,folder:this.activeFolder}),t,(0,y.action)((t=>{e.imgtag=t.imgtag,e.name=t.name,e.mf_id=t.mf_id,e.progress=void 0})),((t,i)=>e.progress=(0,k.NM)(100*t/i)),(()=>this.tabs[this.activeTab].remove(e)))}z(!0)}createNewFolder(e){this.activeFolder+=e+"/",j.temp_folders.push({folder:e,context:this.activeTab})}renameFile(e){let{mf_id:t,path:i,name:n}=e;(0,w.SC)("media/rename",{method:"POST",data:{mf_id:t,path:i}},(()=>this.tabs[this.activeTab]=this.tabs[this.activeTab].map((e=>({...e,name:t===e.mf_id?(i.split("/").length>1?i.split("/").slice(0,-1).join("/")+"/":"")+n+"."+I(e.name):e.name})))))}renameFolder(e){let{path:t,name:i,temp:n,tab:r}=e;n?j.temp_folders=j.temp_folders.map((e=>e===t.slice(0,-1)?i:e)):(0,w.SC)("media/rename_folder",{method:"POST",data:{path:t,name:i,tab:r}},(()=>(z(!0),this.fetch(this._tabKeys))))}moveFile(e){let{folder:t,file:i}=e;if(this.activeFolder){const e=this.tabs[this.activeTab]||[];1===(null==e?void 0:e.filter((e=>e.name&&N(e.name)===this.activeFolder))).length&&j.temp_folders.push({folder:this.activeFolder.slice(0,-1),context:this.activeTab})}(0,w.SC)("media/move_file",{method:"POST",data:{folder:t,...i}},(()=>this.fetch(this._tabKeys)))}createFromColor(e){this.activeTab=this._tabKeys[0],(0,w.SC)("media/generate_color",{method:"POST",data:{tab:this.activeTab,folder:this.activeFolder,background:e}},(0,y.action)((e=>{const t=(0,y.observable)({imgtag:e.imgtag,name:e.name,mf_id:e.mf_id});this.tabs[this.activeTab].unshift(t)})))}get itemsInFolder(){const e=this.activeFolder,t=e.length,i=this.tabs[this.activeTab]||[],n=null==i?void 0:i.filter((t=>t.name&&N(t.name)===e)),r=[...new Set(i.map((i=>!!i.name&&i.name.substr(0,t)===e&&function(e){const t=e.indexOf("/");if(t>0)return e.substr(0,t+1)}(i.name.substr(t)))).filter((e=>e)))];n.sort(),r.sort();let s=[];e?r.unshift("../"):(s=j.temp_folders.filter((e=>e.context===this.activeTab)).map((e=>e.folder+"/")),s=[...new Set(s)].filter((e=>!r.includes(e))));let o=[...s.map((e=>({folder:!0,name:e,temp:!0}))),...r.map((e=>({folder:!0,name:e}))),...n];return this.byMe&&(o=o.filter((e=>(0,k.Tz)(e.user_id)||e.folder&&"../"===e.name))),this.search&&(o=o.filter((e=>(0,k.nu)(e.name).toLowerCase().includes(this.search.toLowerCase())))),o}_load(e){if(this.tabs={},this._tabKeys.forEach((t=>t in e&&(0,y.extendObservable)(this.tabs,{[t]:e[t]}))),this._activeItemUrl){const e=this._findMediaItem(this._activeItemUrl);if(e){const[t,i]=e;this.activeItem=t,this.activeTab||(this.activeTab=i)}}this.activeTab&&this.activeItem?"gallery"!==this.activeTab&&(this.activeFolder=N(this.activeItem.name)||this.activeFolder):this.activeTab=Object.keys(this.tabs)[0],this.ready=!0}_findMediaItem(e){let t=null;for(const[i,n]of Object.entries(this.tabs))if("gallery"===i){for(const r of Object.values(n))if(t=r.find((t=>t.imgtag===e)),t)return[t,i]}else if(t=n.find((t=>t.imgtag===e)),t)return[t,i]}}).prototype,"ready",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=B(u.prototype,"tabs",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),h=B(u.prototype,"activeTab",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),b=B(u.prototype,"activeItem",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=B(u.prototype,"activeFolder",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_=B(u.prototype,"search",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f=B(u.prototype,"byMe",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B(u.prototype,"fetch",[n],Object.getOwnPropertyDescriptor(u.prototype,"fetch"),u.prototype),B(u.prototype,"extensions",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"extensions"),u.prototype),B(u.prototype,"deleteItem",[r],Object.getOwnPropertyDescriptor(u.prototype,"deleteItem"),u.prototype),B(u.prototype,"uploadItems",[s],Object.getOwnPropertyDescriptor(u.prototype,"uploadItems"),u.prototype),B(u.prototype,"createNewFolder",[o],Object.getOwnPropertyDescriptor(u.prototype,"createNewFolder"),u.prototype),B(u.prototype,"renameFile",[a],Object.getOwnPropertyDescriptor(u.prototype,"renameFile"),u.prototype),B(u.prototype,"renameFolder",[l],Object.getOwnPropertyDescriptor(u.prototype,"renameFolder"),u.prototype),B(u.prototype,"moveFile",[c],Object.getOwnPropertyDescriptor(u.prototype,"moveFile"),u.prototype),B(u.prototype,"createFromColor",[d],Object.getOwnPropertyDescriptor(u.prototype,"createFromColor"),u.prototype),B(u.prototype,"itemsInFolder",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"itemsInFolder"),u.prototype),B(u.prototype,"_load",[p],Object.getOwnPropertyDescriptor(u.prototype,"_load"),u.prototype),u);const j=(0,y.observable)({loaded:!1,folders:[],temp_folders:[]}),P=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return[...new Set([...j.temp_folders,...j.folders].filter((t=>0===e.length||t.context===e)).map((e=>e.folder)))]},z=(0,y.action)((e=>{j.loaded&&!e||(j.loaded=!0,(0,w.SC)("media/folders_list",{},(e=>{const t=[];Object.values(e||{}).forEach((e=>t.push(e))),j.folders=t})))}))},8e3:(e,t,i)=>{i.d(t,{Q2:()=>r,SC:()=>s,Wi:()=>p,fN:()=>d,hn:()=>l,xI:()=>o});var n=i(8318);const r=function(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=["test","ajax/","Launcher","integrations/","setup","lib/Branch.class.php"];return r.some((t=>e.startsWith(t)))||(e=(e.startsWith("chat")?"chat/chat_api?/":"api?/")+(e.endsWith("&")?e.slice(0,-1):e.endsWith("/")?e:e+"/"),i&&(e=e.csrf())),t&&(e+="&"+(0,n.Wh)(t)),Blsm.prm.Mainref+e},s=(e,t,i)=>{let{method:s="GET",data:l,onProgressUp:c,onProgressDown:d,json:p,onError:u,onComplete:m,selfErrorHandling:g}=t||{};e=r(e,null,!1);const h={};let b;if(l){if((["DELETE","PATCH","PUT"].includes(s)||p)&&(0,n.Kn)(l))if(p){const e={};for(const[t,i]of Object.entries(l))(0,n.oH)(i,(e=>e instanceof File),!1)&&(e[t]=i);l={json:JSON.stringify(l),...e}}else h["Content-Type"]="application/json",b=JSON.stringify(l);"GET"===s?e+=(e.includes("?")?"&":"?")+(0,n.Wh)(l):void 0===b&&(b=o(l))}const v=new window.XMLHttpRequest;if(v.open(s,e),v.responseJSON=null,v.onabort=()=>v.onloadend=void 0,v.onloadend=()=>{var t,n;if("application/json"===v.getResponseHeader("Content-Type")&&(v.responseJSON=JSON.parse(v.response)),null==m||m(v.responseJSON),200===v.status){if(null==i||i(null!==(t=v.responseJSON)&&void 0!==t?t:v.response),!g&&null!==(n=v.responseJSON)&&void 0!==n&&n.res&&"1"!=v.responseJSON.res){const e=v.responseJSON.res||lng("an error occurred");Blsm.Error(e)}}else null==u||u(v,(()=>a(v,e))),!g&&a(v,e)},c&&v.upload.addEventListener("progress",(e=>e.lengthComputable&&c(e.loaded,e.total)),!1),d&&v.addEventListener("progress",(e=>e.lengthComputable&&d(e.loaded,e.total)),!1),e.includes("api?")){h.origin_hash=encodeURIComponent(window.location.hash).substring(0,5e3);const e=Blsm.csrf_get();e&&(h["X-CSRF-TOKEN"]=e)}for(const[e,t]of Object.entries(h))v.setRequestHeader(e,t);return v.send(b),{abortFetch:()=>v.abort()}},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new FormData,i=arguments.length>2?arguments[2]:void 0;return(0,n.Kn)(e)||Array.isArray(e)?Object.keys(e).forEach((n=>o(e[n],t,i?`${i}[${n}]`:n))):t.append(i,(0,n.DM)(e)?e:""),t},a=(e,t)=>{if(console.error("Error (ajax): ",{xhr:e,url:t}),[0,502,503,504].includes(e.status))return;if(["/api?/notifications/","/api?/comments/","arrowchat","ipapi.co/"].some((e=>t.includes(e))))return;const i=e.responseJSON||{};if(i.redirect)return void location.replace(i.redirect);let n=i.error_msg||e.responseText||lng("an error occurred");const r=Blsm.prm.LOCALHOST&&i.unexpected_output;r&&(n+="<br/>"+i.unexpected_output),Blsm.Error(n,lng("the server returned an error")+" :(",i.error_code&&!r?void 0:{htmlMsg:!0})},l=(e,t,i)=>{const r=(0,n.Ux)("form",{name:"RedirectPostForm",method:"post",action:e||void 0,target:i?"_blank":void 0}),s=(e,t,i)=>{if((0,n.Kn)(i)||Array.isArray(i))for(let n in i)s(e,t+"["+n+"]",i[n]);else i instanceof File?console.error("redirectPost does not support file sending!"):e.append((0,n.Ux)("input",{type:"hidden",name:t,value:i}))};for(let e in t)s(r,e,t[e]);document.body.append(r),r.submit()},c=new Map,d=(e,t,i)=>{const{method:n="GET",data:r}=t||{},o=JSON.stringify({url:e,method:n,data:r});if(c.has(o))return i(c.get(o));s(e,t,(e=>{c.set(o,e),i(e)}))},p=(e,t,i,n,r)=>s(e,{data:{file:t},method:"POST",onProgressUp:n,onError:r},i)},9431:(e,t,i)=>{i.d(t,{Bu:()=>V,AX:()=>G,_G:()=>$,fm:()=>J,rN:()=>L,rc:()=>U,Eo:()=>H});var n=i(7821),r=i(7363),s=i(8e3),o=i(8318),a=i(8567),l=i(4070),c=i(8534),d=i(4210);class p extends d.I{constructor(e){super(e);const{options:t,data:i}=e;this.title=lng("move widget")+(t.widgetTitle?` - ${t.widgetTitle}`:""),this._fields=[{type:"hidden",name:"widget_id"},{type:"select",name:"portal_id",label:lng("select portal").caps(),options:t.portalOptions,required:!0},{type:"checkbox",name:"duplicate",label:lng("duplicate").caps()}],this._prepFields(i),this.ready=!0}save(e){this.saveToUrl("portal/move_widget",e)}}var u,m,g,h,b,v,_,f,y,w,x,k,Z,C,S,O,B,T,N,I,D,j,P,z,E,R,F=i(5007),M=i(656);function A(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function q(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function X(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const L=(0,r.createContext)(null),$=(0,r.createContext)(null),V={DOMAIN:"domain",GROUP:"group",SUB:"sub",ANONYMOUS:"anonymous",APP:"app"},U={[V.APP]:lng("app").caps(),[V.SUB]:lng("sub page").caps(),[V.DOMAIN]:lng("general").caps(),[V.GROUP]:lng("workspace").caps(),[V.ANONYMOUS]:lng("portal for unregistered users").caps()},H={[V.APP]:lng("enterprise app").caps(),[V.DOMAIN]:lng("general portals").caps(),[V.GROUP]:lng("workspace portals").caps(),[V.ANONYMOUS]:lng("portals for unregistered users").caps()};let J=(u=n.action.bound,m=n.action.bound,g=n.action.bound,h=n.action.bound,v=X((b=class{constructor(e){let{nav:t}=e;A(this,"ready",v,this),A(this,"portals",_,this),A(this,"_activePortalId",f,this),q(this,"subPortalId",null),A(this,"editMode",y,this),q(this,"editValues",{}),(0,n.makeObservable)(this),this.nav=t,(0,s.SC)("portal/portal",{data:{related_only:!0}},(0,n.action)((e=>{this.editValues=(0,o.ei)(e,["categories","classifications","tags","task_status","task_types","task_custom"]),this.portals=e.portals.map((e=>new G({portalData:e,editValues:this.editValues,urlParams:this.urlParams}))),this.setSubPortalId(this.subPortalId),(0,n.autorun)((()=>{if(!this.activePortalStore&&this.activePortalId){const e=(0,n.toJS)(this.portals).map((e=>e.portal_id));!e.includes(this.activePortalId)&&Blsm.hasPermission("portal_manager")&&(this.editMode=!0,this.getPortals({portal_id:this.activePortalId,exclude:e.join()}))}})),this.ready=!0}))),Blsm.portalStore=this}getPortals(e){let{portal_id:t,exclude:i}=e;(0,s.SC)("portal/portal",{data:{portal_id:t,exclude:i}},(0,n.action)((e=>{this.portals=e.portals.map((e=>new G({portalData:e,editValues:this.editValues,urlParams:this.urlParams}))),this.setSubPortalId(this.subPortalId)})))}get activePortalId(){var e;return this._activePortalId||(this.portals.length>0?null===(e=this.portals[0])||void 0===e?void 0:e.portal_id:null)}set activePortalId(e){this.nav([e])}setSubPortalId(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.subPortalId=e,this.activePortalStore&&this.activePortalStore.subPortalId!=e&&(this.activePortalStore.subPortalId=e||null,t&&this.updateNav())}get activePortalStore(){return this.portals.find((e=>e.portal_id===this.activePortalId))}get allowAnonymous(){var e;return!(null!==(e=this.portals.find((e=>e.portal_type===V.ANONYMOUS)))&&void 0!==e&&e.portal_id)}updateNav(){this.nav([this.activePortalId,...this.subPortalId?[this.subPortalId]:[],this.urlParams],{replace:!0})}updateRoute(e){let[t,i,n]=e;if((0,o.B5)(i)||(n=i,i=null),t&&!(0,o.B5)(t))throw new Error(lng("invalid URL"));this.urlParams=n,this._activePortalId=t,this.setSubPortalId(i)}deletePortal(e,t){(0,a.BB)(lng("are you sure you want to delete this portal?"),{onConfirm:()=>{e.parent_id?this.activePortalStore.subs.remove(e):this.portals.remove(e),(0,s.SC)("portal/portal/"+e.portal_id,{method:"DELETE"}),t?t():this.activePortalId=null}})}addPortalCallback(e,t){const{parent_id:i}=e,n=t.toString(),r=new G({portalData:Object.assign(e,{portal_id:n,can_edit:this.activePortalStore.can_edit}),editValues:this.editValues,urlParams:this.urlParams,can_edit:1});i?(this.activePortalStore.subs.push(r),this.setSubPortalId(n)):(this.portals.push(r),this.activePortalId=n)}moveSubPortal(e){let{portal_id:t,parent_id:i}=e;this.activePortalStore.portalToShow.parent_id=i,this.portals.find((e=>e.portal_id==i)).subs.push(this.activePortalStore.portalToShow),this.activePortalStore.subs.remove(this.activePortalStore.portalToShow),this.setActivePortal({portal_id:t,parent_id:i})}moveWidget(e,t){const i=[{val:"",label:""}];this.portals.map((n=>{if(n.can_edit&&e.mayAddWidgetToPortal(l.Z[t.widget_type],n)){const e=n.title;i.push({val:n.portal_id,label:e}),n.subs.length>0&&n.subs.map((t=>i.push({val:t.portal_id,label:t.title+` (${e})`})))}}));const n=new p({data:{widget_id:t.widget_id},options:{portalOptions:i,widgetTitle:t.title},onSaveSuccess:i=>{const r=n.values.get("duplicate");if(null!=i&&i.other_portal_data){r?t.portal_id!==n.values.get("portal_id")&&(t.portal.portal_active=!1):e._widgets.remove(t);const s=e.createEmptyWidget(t.widget_type);s.updateData(i.widget_data),this.setActivePortal(i.other_portal_data),this.activePortalStore.addWidget(s)}(0,F.vm)().closeDialog()}});(0,F.vm)().openDialog("form",n)}setActivePortal(e){let{parent_id:t,portal_id:i}=e;const n=t>0;this.activePortalId=n?t:i,n&&this.setSubPortalId(i)}}).prototype,"ready",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_=X(b.prototype,"portals",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=X(b.prototype,"_activePortalId",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=X(b.prototype,"editMode",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),X(b.prototype,"activePortalId",[n.computed],Object.getOwnPropertyDescriptor(b.prototype,"activePortalId"),b.prototype),X(b.prototype,"setSubPortalId",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"setSubPortalId"),b.prototype),X(b.prototype,"activePortalStore",[n.computed],Object.getOwnPropertyDescriptor(b.prototype,"activePortalStore"),b.prototype),X(b.prototype,"updateRoute",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"updateRoute"),b.prototype),X(b.prototype,"deletePortal",[n.action],Object.getOwnPropertyDescriptor(b.prototype,"deletePortal"),b.prototype),X(b.prototype,"addPortalCallback",[u],Object.getOwnPropertyDescriptor(b.prototype,"addPortalCallback"),b.prototype),X(b.prototype,"moveSubPortal",[m],Object.getOwnPropertyDescriptor(b.prototype,"moveSubPortal"),b.prototype),X(b.prototype,"moveWidget",[g],Object.getOwnPropertyDescriptor(b.prototype,"moveWidget"),b.prototype),X(b.prototype,"setActivePortal",[h],Object.getOwnPropertyDescriptor(b.prototype,"setActivePortal"),b.prototype),b),G=(w=n.observable.shallow,x=n.observable.shallow,k=n.action.bound,Z=n.action.bound,C=n.action.bound,S=class e{constructor(t){let{portalData:i,editValues:r,urlParams:s}=t;A(this,"_loaded",O,this),A(this,"showDeactivatedWidgets",B,this),A(this,"portal_title",T,this),A(this,"group_ids",N,this),A(this,"poster",I,this),A(this,"sub_groups",D,this),A(this,"portal_active",j,this),A(this,"style",P,this),q(this,"parent_style",void 0),A(this,"subs",z,this),A(this,"_widgets",E,this),A(this,"subPortalId",R,this),q(this,"urlParams",void 0),q(this,"isEnterprise",Blsm.checkMod(["","ENT"])),(0,n.makeObservable)(this);const{subs:o,...a}=i;this.urlParams=s,Object.assign(this,a),this.editValues=r,o&&(this.subs=o.map((t=>new e({portalData:Object.assign(t,{can_edit:this.can_edit}),editValues:this.editValues,urlParams:this.urlParams,can_edit:1}))))}newsItemPopupLoad(e){this.newsItemPopupLoadRunOnce||(this.newsItemPopupLoadRunOnce=!0,(0,s.SC)(`portal/get_news_by_id/news_id=${e}&portal_id=${this.portal_id}`,{selfErrorHandling:!0,onError:t=>console.error("get_news_by_id",e,this.portal_id,t.responseJSON)},(0,n.action)((e=>(0,M.tp)({item:e})))))}get loaded(){const e=(0,o.tq)()?3:null;return!this._loaded&&(0,s.SC)(`portal/portal_data/${this.portal_id}${e?`&force_limit=${e}&`:""}`,{},(0,n.action)((t=>{var i,n;if("string"==typeof t)return(0,c.Mj)(t);t.group_ids=null===(i=t.group_ids)||void 0===i?void 0:i.split(",");const{widgets:r,subs:s,...a}=t;Object.assign(this,a),this._widgets.replace(r.map((t=>{const i=l.Z[t.widget_type];if(i)return new i.store({widgetData:{group_type:this.group_type,portal:a,force_limit:e,...t},mayEdit:this.mayEdit,editValues:this.editValues,domain_id:this.domain_id,portalStore:this});console.warn("unrecognized widget type",t.widget_type,t)})).filter((e=>e))),this._loaded=!0,(0,o.B5)(null===(n=this.urlParams)||void 0===n?void 0:n.news_id)&&this.newsItemPopupLoad(this.urlParams.news_id)}))),this._loaded}get widgets(){return this._widgets.slice().sort(((e,t)=>e.widget_order-t.widget_order)).filter((e=>this.showDeactivatedWidgets||(0,o.P$)(e.widget_active)))}get portalToShow(){return this.subPortalId&&this.subs.find((e=>e.portal_id==this.subPortalId))||this}get title(){const e=this.parent_id>0,t=e?"?":lng("home").caps();return this.portal_title||!e&&this.group_name||t}get mayEdit(){return(0,o.P$)(this.can_edit)&&!this.disable_edit}get mayHideWidgets(){return this.isEnterprise}get mayMoveToAnotherPortal(){return this.isEnterprise}get mayAddSubPortal(){return this.isEnterprise}get actualType(){return this.portal_type===this.parent_type||this.portal_type}get maySetWidgetsAvailableToMembers(){return[V.DOMAIN,V.APP].includes(this.actualType)}mayAddWidgetToPortal(e,t){let i=!1;const n=t||this,r=(0,o.xb)(null==e?void 0:e.group_ids)||n.maySetWidgetsAvailableToMembers;return(this.isEnterprise||["weather","message","assignments","calendar","scores","shared_content","birthdays","phonebook","your_profile","groups"].includes(e.widget_type))&&r&&(void 0===e.isAvailable||e.isAvailable(n.actualType))&&(i=!0),i}updateVals(e){e.portal_active=e.portal_active||0,e.sub_groups=e.sub_groups||0,e.available_to_managers=e.available_to_managers||0,e.group_ids=e.group_ids||[],e["style[portal_slider]"]&&(this.style.portal_slider=e["style[portal_slider]"]),Object.assign(this,e)}toggleShowDeactivatedWidgets(){this.showDeactivatedWidgets=!this.showDeactivatedWidgets}createEmptyWidget(e){return new l.Z[e].store({widgetData:{widget_type:e,portal_id:this.portal_id,widget_order:this._widgets.length+1,widget_active:1,group_id:this.group_id,group_type:this.group_type},portalStore:this,mayEdit:!0,editValues:this.editValues})}addWidget(e){this._widgets.push(e)}deleteWidget(e){this._widgets.remove(e);const{widget_id:t,group_id:i}=e;(0,s.SC)(`portal/widget/${t}${i?`&gid=${i}`:""}`,{method:"DELETE"})}newOrder(e){const t=Object.fromEntries(e.map(((e,t)=>[e,t])));for(const e of this._widgets)e.widget_order=(0,o.kE)(t[e.widget_id])?(t[e.widget_id]+1).toString():e.widget_order;(0,s.SC)("portal/widget_order",{method:"POST",data:{new_order:e.join(","),portal_id:this.portal_id}})}},O=X(S.prototype,"_loaded",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=X(S.prototype,"showDeactivatedWidgets",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=X(S.prototype,"portal_title",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=X(S.prototype,"group_ids",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=X(S.prototype,"poster",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=X(S.prototype,"sub_groups",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=X(S.prototype,"portal_active",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=X(S.prototype,"style",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=X(S.prototype,"subs",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),E=X(S.prototype,"_widgets",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),R=X(S.prototype,"subPortalId",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X(S.prototype,"newsItemPopupLoad",[n.action],Object.getOwnPropertyDescriptor(S.prototype,"newsItemPopupLoad"),S.prototype),X(S.prototype,"loaded",[n.computed],Object.getOwnPropertyDescriptor(S.prototype,"loaded"),S.prototype),X(S.prototype,"widgets",[n.computed],Object.getOwnPropertyDescriptor(S.prototype,"widgets"),S.prototype),X(S.prototype,"portalToShow",[n.computed],Object.getOwnPropertyDescriptor(S.prototype,"portalToShow"),S.prototype),X(S.prototype,"title",[n.computed],Object.getOwnPropertyDescriptor(S.prototype,"title"),S.prototype),X(S.prototype,"mayAddWidgetToPortal",[k],Object.getOwnPropertyDescriptor(S.prototype,"mayAddWidgetToPortal"),S.prototype),X(S.prototype,"updateVals",[n.action],Object.getOwnPropertyDescriptor(S.prototype,"updateVals"),S.prototype),X(S.prototype,"toggleShowDeactivatedWidgets",[Z],Object.getOwnPropertyDescriptor(S.prototype,"toggleShowDeactivatedWidgets"),S.prototype),X(S.prototype,"createEmptyWidget",[C],Object.getOwnPropertyDescriptor(S.prototype,"createEmptyWidget"),S.prototype),X(S.prototype,"addWidget",[n.action],Object.getOwnPropertyDescriptor(S.prototype,"addWidget"),S.prototype),X(S.prototype,"deleteWidget",[n.action],Object.getOwnPropertyDescriptor(S.prototype,"deleteWidget"),S.prototype),X(S.prototype,"newOrder",[n.action],Object.getOwnPropertyDescriptor(S.prototype,"newOrder"),S.prototype),S)},2517:(e,t,i)=>{i.d(t,{r:()=>Z});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v=i(7821),_=i(8e3),f=i(8318),y=i(441);function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function x(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function k(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Z=(n=v.observable.shallow,r=v.observable.shallow,s=v.observable.shallow,o=v.action.bound,l=k((a=class{constructor(e){let{widgetData:t,mayEdit:i,editValues:n,domain_id:r,portalStore:s}=e;x(this,"mayEdit",!1),x(this,"newMenuOptions",void 0),x(this,"portalStore",void 0),w(this,"loading",l,this),w(this,"data",c,this),w(this,"options",d,this),w(this,"style",p,this),w(this,"widget_order",u,this),w(this,"widget_active",m,this),w(this,"searchText",g,this),w(this,"searching",h,this),w(this,"scrollBtnState",b,this),(0,v.makeObservable)(this),this.mayEdit=i,this.editValues=n,this.domain_id=r,this.newMenuOptions,this.portalStore=s,t.portal=s,this.updateData(t)}updateData(e){var t;!1===e.data&&(console.warn("Bad data at",e),e.data=null),(0,f.P$)(null===(t=e.style)||void 0===t?void 0:t.translucent)&&(e.style.translucent=!0),Object.assign(this,e),this.loading=!1}refreshFromServer(){this.loading=!0;const e={};this.group_id&&(e.gid=this.group_id),this.force_limit&&(e.force_limit=this.force_limit),(0,_.SC)(`portal/widget/${this.widget_id}${(0,f.xb)(e)?"":`/&${(0,f.Wh)(e)}&`}`,{},(e=>this.updateData(e)))}openInNewWindow(){(0,_.SC)(`portal/widget/${this.widget_id}${this.group_id?`/&gid=${this.group_id}&`:""}`,{},(e=>window.open(e.options.url)))}toggleActivation(){this.widget_active=(0,f.P$)(this.widget_active)?null:1,(0,_.SC)("portal/widget_active",{method:"POST",data:{widget_id:this.widget_id,portal_id:this.portal_id,a:this.widget_active?1:0}})}get isDouble(){var e;return(0,f.tq)()?!(0,f.Oz)():(0,f.P$)(null===(e=this.style)||void 0===e?void 0:e.double)}get refLink(){const e=this.portal,t=this.widget_id;return e?Blsm.prm.Mainref+(0,y.p4)(e.parent_id?{portal:e.parent_id,sub_id:e.portal_id,wid:t}:{portal:e.portal_id,wid:t}):null}}).prototype,"loading",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),c=k(a.prototype,"data",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=k(a.prototype,"options",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),p=k(a.prototype,"style",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),u=k(a.prototype,"widget_order",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=k(a.prototype,"widget_active",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),g=k(a.prototype,"searchText",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),h=k(a.prototype,"searching",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),b=k(a.prototype,"scrollBtnState",[v.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),k(a.prototype,"updateData",[v.action],Object.getOwnPropertyDescriptor(a.prototype,"updateData"),a.prototype),k(a.prototype,"toggleActivation",[o],Object.getOwnPropertyDescriptor(a.prototype,"toggleActivation"),a.prototype),k(a.prototype,"isDouble",[v.computed],Object.getOwnPropertyDescriptor(a.prototype,"isDouble"),a.prototype),k(a.prototype,"refLink",[v.computed],Object.getOwnPropertyDescriptor(a.prototype,"refLink"),a.prototype),a)},20:(e,t,i)=>{i.d(t,{u:()=>p});var n,r,s,o=i(8e3),a=i(7821);function l(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function d(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let p=(r=d((n=class{constructor(e){l(this,"ready",r,this),l(this,"fixed",s,this),c(this,"data",void 0),c(this,"results",[]),(0,a.makeObservable)(this),this.data=e,(0,o.SC)("groups/qualification_issues",{data:{group_id:e.group_id}},(e=>{this.ready=!0,this.results=e}))}fix_expiration_dates(){this.ready=!1,(0,o.SC)("groups/qualification_issues",{data:{group_id:this.data.group_id,fix:!0}},(()=>{this.ready=!0,this.fixed=!0}))}}).prototype,"ready",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=d(n.prototype,"fixed",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n)},3390:(e,t,i)=>{i.d(t,{E:()=>be,P:()=>ge});var n=i(7821),r=i(7363),s=i(8e3),o=i(8318),a=i(8567),l=i(4210),c=i(6975),d=i(5944);var p=i(2755);const u={group:"groups",assignment:"assignments",user:"users",creator:"users",ou:"groups",qualification:"groups",resourcebundle:"groups",classification:"classification",question:"question",external_course_type:"external_course_type",food_provider:"food_provider",content:"content",resource:"resource"};var m,g=i(6920);function h(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let b=(m=class extends l.I{constructor(e){super(e),h(this,"required",[]);const{initialValues:t={},reportData:i}=e,{filters:n,data:r}=i,{question_data:a}=r;let{dates:l,date_ranges:m,checkboxes:b,selects:v,optionsFilters:_,hidden_values:f,numerics:y,custom_filters:w,timedist:x}=n;if(f={...f,...t},x&&this._fields.push((e=>{const t=[["daily",lng("daily")],["weekly",lng("weekly")],["monthly",lng("monthly")],["quarterly",lng("quarterly")],["yearly",lng("yearly")]];return{type:"select",name:"timedist",label:lng("time distribution"),options:(0,o.wd)(t),data:e}})(x)),l){const e=((e,t,i)=>{let{date_ranges:n}=t;const{ranges_only:r,ranges:s,dates_only:o,future:a,past:l}=e,p=[];return r||o||p.push({val:"dates",label:lng("select dates")}),!o&&s.length>0&&p.push(...n.map((e=>({val:e.code,label:e.range_text})))),{data:e,filterType:"dates",type:"set",label:lng("dates").caps(),ranges:new Map(null==n?void 0:n.map((e=>[e.code,{text:e.range_text,to:e.to,from:e.from}]))),fields:[{type:"row_set",fields:[{type:"select",name:"range",inline:!0,options:p,insert:p.length>0},{type:"component",node:(0,d.tZ)(c.JO,{icon:"trash",toolTip:lng("clear|verb"),onClick:()=>{i.updateValue("dates","range"),i.updateValue(void 0,"from"),i.updateValue(void 0,"to")},buttonLike:!0})}]},{type:"date",name:"from",label:lng("from|date"),inline:!0,options:p,insert:!r,visible:o?void 0:e=>"dates"===e.get("range"),minDate:a?()=>moment().subtract(1,"day"):void 0,maxDate:()=>moment(i.values.get("to"),Blsm.prm.date_moment_format).utcOffset(Blsm.prm.timezone_offset,!0)},{type:"date",name:"to",label:lng("to|date"),inline:!0,ptions:p,insert:!r,visible:o?void 0:e=>"dates"===e.get("range"),minDate:()=>moment(i.values.get("from"),Blsm.prm.date_moment_format).utcOffset(Blsm.prm.timezone_offset,!0),maxDate:l?()=>moment().subtract(1,"day"):void 0}]}})(l,{date_ranges:m},this);l.required&&(e.reportRequired=!0,this.required.push("range")),this._fields.push(e)}if(["assignment","group","external_course_type","user","creator","ou","qualification","classification","question","resourcebundle","food_provider","content","resource"].forEach((e=>{if(n[e]){t[e]&&(t[e]=t[e].split("_"),Array.isArray(t[e])&&!t[e].every((e=>(0,o.B5)(e)||["mypou","myou","mysubou"].includes(e)))&&(t[e]=void 0));const i=((e,t,i)=>{const{multiple:n,name:r,type:o,mine:a,rules:l,inner_filters:c,idColumn:m,...g}=e;switch(o){case"group":g.sons=n?1:0;break;case"assignment":g.related=n?1:0;break;case"ou":g.group_type="Ou",g.sons=n?1:0;break;case"qualification":g.group_type="Qualification",g.conditions=1;break;case"resourcebundle":g.group_type="ResourceBundle"}const h=[{label:lng("select my primary org' units").caps(),val:"mypou"},{label:lng("select my direct org' units").caps(),val:"myou"},{label:lng("select all my org' units").caps(),val:"mysubou"}];return{data:e,type:n?"multiple_items":"single_item",name:o,addAll:n,addMine:a,mineMenu:h,innerFilters:c,rules:l,filterType:"items",label:r,idColumn:m,searchData:(e,i)=>{let{term:n,ids:r,...a}=e;if("question"===o&&t){let e=t.filter((e=>null==r?void 0:r.includes(e.id)));n&&e&&(e=t.filter((e=>e.value.toLowerCase().search(n.toLowerCase())>0))),i(e)}else Object.keys(g).forEach((e=>{!0===g[e]&&(g[e]=1)})),delete g.explanation,delete g.help,(0,s.SC)("reports/filter/"+u[o],{method:"POST",json:!0,data:{...g,...a,term:n,id:r}},i)},buttons:[{Render:e=>{var t,n;let{item:r,name:s}=e;const o=e=>{const t=new Set(i.values.get(s)||[]),n=e.some((e=>t.has(e)));e.forEach((e=>n?t.delete(e):t.add(e))),i.updateValue([...t.values()],s)};return(null===(t=r.conditions)||void 0===t?void 0:t.length)>0?(0,d.tZ)(p.ZT,{toolTip:lng("add/remove conditions"),onClick:()=>o(r.conditions),size:27,icon:"tree"}):(null===(n=r.sons)||void 0===n?void 0:n.length)>0?(0,d.tZ)(p.ZT,{toolTip:lng("add/remove children"),onClick:()=>o(r.sons),size:27,icon:"hierarchy"}):""},props:{name:o}}]}})(n[e],a,this);n[e].required&&(i.reportRequired=!0,this.required.push(i.name)),this._fields.push(i)}})),v||b||y||_||w){let e=[];v&&(v.forEach((e=>{let{name:i,multiple:n}=e;n&&t[i]&&(t[i]=t[i].replace(/__/g,"<#!PLACEHOLDER!#>").replace(/_/g,",").replace(/<#!PLACEHOLDER!#>/g,"_").split(",").map((e=>(0,o.kE)(e)?parseInt(e):e)))})),e=v.filter((e=>e.options.length>0)).map((e=>{let{name:i,label:n,options:r,multiple:s,defaultValue:a,helpKey:l}=e;return a&&!t[i]&&(t[i]=a),{type:s?"select_multi":"select",name:i,label:n,helpKey:l,options:(0,o.wd)(r),emptyOption:!a&&""!==r[0][0]}})));let i=[];_&&(_.forEach((e=>{let{name:i,multiple:n}=e;t[i]&&n&&(t[i]=t[i].replace(/__/g,"<#!PLACEHOLDER!#>").replace(/_/g,",").replace(/<#!PLACEHOLDER!#>/g,"_").split(",").map((e=>(0,o.kE)(e)?parseInt(e):e)))})),i=_.map((e=>{let{type:t,name:i,label:n,options:r,searchData:a,...l}=e;return(0,o.v7)({type:t,name:i,label:n,options:r&&(0,o.wd)(r),emptyOption:void 0===l.emptyOption||l.emptyOption,searchData:a&&((e,t)=>(0,s.SC)(a.url,{data:Object.assign({term:e.term||"",id:e.ids||"",ids:e.ids||""},a.data)},t)),...l},o.DM)})));const n=(null==b?void 0:b.length)>0?b.map((e=>{let{name:t,label:i,value:n,required:r,helpKey:s}=e;const o={type:"switcher",required:r,name:t,label:i,helpKey:s,options:[{color:g.g.colors.text_placeholder},{val:n||1,color:g.g.colors.dominant_main}]};return r&&this.required.push(t),o})):[],r=(null==y?void 0:y.length)>0?y.map((e=>{let{name:t,label:i,min:n,max:r,helpKey:s}=e;return{type:"number",name:t,label:i,min:n,max:r,helpKey:s}})):[];this._fields.push({filterType:"options",type:"set",fields:[...w||[],...e,...i,...r,...n]})}f&&this._fields.push(...(e=>Object.entries(e).map((e=>{let[t,i]=e;return{type:"hidden",name:t,value:i}})))(f)),this._fields.push({type:"hidden",name:"page"}),this._prepFields(t)}buildFinalValues(){const e=super.buildFinalValues();"dates"!==e.range&&(delete e.from,delete e.to);for(const t of Object.keys(e))Array.isArray(e[t])&&(e[t]=e[t].map((e=>"string"==typeof e?e.replace(/_/g,"__"):parseInt(e))).join("_"));return e}get filtersReady(){if(0===this.required.length)return!0;for(const e of this.required){const t=this.values.get(e),i=this.values.get(e+"c");if("range"===e&&"dates"===t?this.values.get("from")||this.values.get("to"):t||i)return!0}return!1}},v=m.prototype,_="filtersReady",f=[n.computed],y=Object.getOwnPropertyDescriptor(m.prototype,"filtersReady"),w=m.prototype,x={},Object.keys(y).forEach((function(e){x[e]=y[e]})),x.enumerable=!!x.enumerable,x.configurable=!!x.configurable,("value"in x||x.initializer)&&(x.writable=!0),x=f.slice().reverse().reduce((function(e,t){return t(v,_,e)||e}),x),w&&void 0!==x.initializer&&(x.value=x.initializer?x.initializer.call(w):void 0,x.initializer=void 0),void 0===x.initializer&&(Object.defineProperty(v,_,x),x=null),m);var v,_,f,y,w,x,k=i(5007),Z=i(6945),C=i(8534),S=i(8989),O=i(2334);function B(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class T extends l.I{constructor(e){super(e),B(this,"bookmarkId",void 0),this.bookmarkId=e.bookmarkId,this.bookmark_name=e.bookmark_name,this.title=lng("share report").caps(),this.confirmButtonLabel=lng("share").caps(),(0,s.SC)("bookmarks/get_permission_users",{data:{bm_id:this.bookmarkId}},(e=>{const t={users:e.map((e=>e.id))};this._buildFields(t)}))}_buildFields(e){this._fields=[{type:"component",node:(0,d.BX)("div",{children:[(0,d.tZ)(c.JO,{icon:"sign_notification"}),(0,d.BX)("span",{children:[" ",lng("sharing with a specific user will let him see the report from your point of view").caps()]})]})},{type:"multiple_items",name:"users",label:lng("select users"),poster:!0,theme:"bright",searchData:(e,t)=>{let{term:i,ids:n}=e;(0,s.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:i,id:n||""}},t)}}],this._prepFields(e),this.ready=!0}save(e){this.saveToUrl("bookmarks/set_permission_users",Object.assign({bm_id:this.bookmarkId,bm_name:this.bookmark_name},e))}}var N=i(2247);function I(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class D extends l.I{constructor(e){super(e),I(this,"bookmarkId",void 0),this.bookmarkId=e.bookmarkId,this.title=lng("add notification").caps(),this.confirmButtonLabel=lng("save").caps(),(0,s.SC)("bookmarks/get_notifications",{data:{object_id:this.bookmarkId}},(e=>{if(e.notifications){const t=new Map;for(const[i,n]of Object.entries(e.notifications))t.set(i,n);e.notifications=t}this._buildFields(e)}))}_buildFields(e){const t={bookmark:{dates:!0,options:{targetFieldsOptions:["other_user","group","role"]},messageType:"bookmark_reminder",message:!0}},i={targetFieldsOptions:["other_user","group","role"]};this._fields=[{type:"component",name:"notifications",Render:N.oS,props:{notificationsTypes:t,options:i,objectId:this._id,form:"bookmark"}},{type:"component",name:"notifications",Render:N.oQ,props:{notificationsTypes:t,options:i}}],this._prepFields(e),this.ready=!0}save(e){this.saveToUrl("bookmarks/add_notifications",Object.assign({object_id:this.bookmarkId},e))}}var j,P,z,E,R,F,M,A,q,X,L,$,V,U,H,J,G,W,K,Y,Q,ee,te,ie,ne,re,se,oe,ae,le,ce,de=i(441);function pe(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ue(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function me(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const ge=(0,r.createContext)(null),he=e=>{switch(e){case"find":return lng("find report");case"recent":return lng("recent reports");case"personal":return lng("bookmarks");case"recommended":return lng("recommended");case"shared":return lng("shared")}};let be=(j=n.observable.shallow,P=n.action.bound,z=n.action.bound,E=n.action.bound,R=n.action.bound,F=n.action.bound,M=n.action.bound,A=n.action.bound,q=n.action.bound,X=n.action.bound,L=n.action.bound,V=me(($=class{constructor(e){let{nav:t}=e;pe(this,"ready",V,this),ue(this,"isEnterprise",Blsm.checkMod(["","ENT"])),ue(this,"_categories",[]),ue(this,"_allReports",[]),ue(this,"_allReportsHash",{}),ue(this,"_tagsCount",[]),pe(this,"selectedTags",U,this),pe(this,"searchText",H,this),pe(this,"listTab",J,this),pe(this,"_sets",G,this),pe(this,"reportReady",W,this),pe(this,"_activeReport",K,this),pe(this,"_activeGraph",Y,this),pe(this,"reportParams",Q,this),pe(this,"_bookmarkId",ee,this),ue(this,"reportFiltersForm",null),pe(this,"reportData",te,this),pe(this,"actionsData",ie,this),pe(this,"showSetupFields",ne,this),ue(this,"noCache",!1),ue(this,"force",!1),ue(this,"requestConfirmHighlight",!1),ue(this,"scrollTo",null),ue(this,"_autoRefreshInterval",null),pe(this,"refreshSeconds",re,this),pe(this,"reportTooBig",se,this),pe(this,"compactView",oe,this),pe(this,"hideDescription",ae,this),ue(this,"mainPopularReportsNamesAndOrder",["ReportCompletion","CourseGradesReport","BasicQualificationReport","ReportQuestionDistribution","ReportGroupMeetings","ReportGroupStatus","UserQuestionDistribution","ReportQualifications","Report_Approvals_Status_Reg","SurveyReport","RatingsReport","RatingsReportInstructor"]),ue(this,"popularReports",new Map),ue(this,"shared_reports",[]),pe(this,"sortBy",le,this),pe(this,"desc",ce,this),ue(this,"sortOptions",[{val:"",label:lng("default")},{val:"label",label:lng("name")}]),(0,n.makeObservable)(this),this.nav=t,(0,s.SC)("dashboard/reports/sidebar=1",{},(0,n.action)((e=>{let{list:t,bookmarks:i,shared_reports:n}=e;this._allReports=(t||[]).reduce(((e,t)=>[...e,...t.items]),[]);const r={};this._allReports.forEach((e=>{var t;this._allReportsHash[e.cls]=e,null===(t=e.tags)||void 0===t||t.forEach((e=>r[e]=(r[e]||0)+1))})),this._tagsCount=Object.entries(r).sort(((e,t)=>t[1]-e[1])),this._sets.set("recent",(S.X.get("recent_reports_"+Blsm.user.id)||[]).filter((e=>this._allReportsHash[e.bookmark_url.report_name]))),["personal","recommended","shared"].forEach((e=>this._sets.set(e,i[e].filter((t=>t.bookmark_url&&("shared"===e||this._allReportsHash[t.bookmark_url.report_name])))))),this.shared_reports=n;const s=[],o=this.addKeys(this.addResentInfo(this._allReports.filter((e=>this.mainPopularReportsNamesAndOrder.includes(e.cls)))));this.mainPopularReportsNamesAndOrder.forEach((e=>o.find((t=>{t.cls===e&&s.push(t)})))),this.popularReports=s,this.ready=!0})))}get tabs(){const e=[{val:"find",label:he("find")}];return["recent","personal","recommended","shared"].forEach((t=>{this._sets.get(t).length&&e.push({val:t,label:he(t)})})),e}get visibleReports(){let e=this._allReports;if("find"===this.listTab&&(e=this.addResentInfo(e)),"recent"===this.listTab?e=this._sets.get(this.listTab).map((e=>{const t=this._allReportsHash[e.bookmark_url.report_name],i=e.bookmark_name||t.label;return Object.assign({},t,{label:i},{params:e.bookmark_url.parameters},{subLabel:(0,O.GG)(e.modification_time),time:e.modification_time})})):["personal","recommended","shared"].includes(this.listTab)&&(e=this._sets.get(this.listTab).map((e=>{const t=this._allReportsHash[e.bookmark_url.report_name]||this.shared_reports[e.bookmark_url.report_name];let i={params:e.bookmark_url.parameters};return Object.assign({},e,t,i,{label:e.bookmark_name,subLabel:"QueryReport"===t.cls?this.getQueryReportName(e.bookmark_url.parameters.report_id):null==t?void 0:t.label})}))),this.selectedTags.size||this.searchText){const t=this.searchText.toLowerCase(),i=[...this.selectedTags],n=e.filter((e=>{var n,r,s;return i.filter((t=>{var i;return null===(i=e.tags)||void 0===i?void 0:i.includes(t)})).length===i.length&&((null===(n=e.label)||void 0===n?void 0:n.toLowerCase().includes(t))||(null===(r=e.desc)||void 0===r?void 0:r.includes(t))||(null===(s=e.tags)||void 0===s?void 0:s.some((e=>e.includes(t)))))}));e=n.map((e=>{var i;return e.order=null!==(i=e.label)&&void 0!==i&&i.toLowerCase().includes(t)?-1:1,e})).sort(((e,t)=>""!==this.sortBy?e[this.sortBy].localeCompare(t[this.sortBy]):e.order-t.order))}else""!==this.sortBy&&(e=e.slice().sort(((e,t)=>e[this.sortBy].localeCompare(t[this.sortBy]))));return this.desc&&e.reverse(),this.addKeys(e)}setSortBy(e){this.desc=e===this.sortBy?!this.desc:this.desc,this.sortBy=e}addKeys(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.map((e=>(e._key=t+(0,o.SZ)((0,o.ei)(e,["cls","time","params","bookmark_id"])),e)))}addResentInfo(e){const t=this._sets.get("recent").map((e=>{const t=this._allReportsHash[e.bookmark_url.report_name];return Object.assign({params:e.bookmark_url.parameters},t,{subLabel:(0,O.GG)(e.modification_time),time:e.modification_time})}));return e.map((e=>(e.recent=t.find((t=>t.cls===e.cls)),e))),e}getQueryReportName(e){return this._allReports.find((t=>"QueryReport"===t.cls&&t.params.report_id==e)).label}get tags(){const e=[lng("users"),lng("assignments"),lng("meetings"),lng("org units"),lng("approvals"),lng("workspaces"),lng("qualifications"),lng("status"),lng("courses")];return{other:this._tagsCount.filter((t=>{let[i]=t;return!e.includes(i)})).map((e=>{let[t]=e;return{tag:t,disabled:!this.visibleReports.some((e=>{var i;return null===(i=e.tags)||void 0===i?void 0:i.includes(t)}))}})),main:this._tagsCount.filter((t=>{let[i]=t;return e.includes(i)})).map((e=>{let[t]=e;return{tag:t,disabled:!this.visibleReports.some((e=>{var i;return null===(i=e.tags)||void 0===i?void 0:i.includes(t)}))}}))}}toogleHideDescription(){window.localStorage.setItem("reports_hideDescription",!this.hideDescription),this.hideDescription=!this.hideDescription}toggleTagSelection(e){this.selectedTags[this.selectedTags.has(e)?"delete":"add"](e)}clearTagSelection(){this.selectedTags.clear()}_addRecent(e){if(void 0===e)return;const t=this._activeReport&&this._allReportsHash[this._activeReport];if(!t)return;const i={report_name:this._activeReport,parameters:e},n=S.X.get("recent_reports_"+Blsm.user.id)||[],r=n.find((e=>e.bookmark_url.report_name===i.report_name));if(r)r.modification_time=(0,o.c7)(),r.bookmark_url=i;else{const r="QueryReport"===t.cls?this.getQueryReportName(e.report_id):null==t?void 0:t.label;n.push({bookmark_name:r,bookmark_url:i,modification_time:(0,o.c7)()})}n.sort(((e,t)=>e.modification_time>t.modification_time?-1:t.modification_time>e.modification_time?1:0)),this._sets.set("recent",n.filter((e=>this._allReportsHash[e.bookmark_url.report_name]))),S.X.set("recent_reports_"+Blsm.user.id,n)}onViewSelect(e){window.localStorage.setItem("reports_compactView",e),this.compactView=e}updateRoute(e){let[t,i,r,s]=e;this._activeReport=t||null;const a=this.activeGraph;this._activeGraph=r,this._bookmarkId=s,this.reportParams=i;const l=this.noCache;if(this.noCache=!1,this._activeReport&&(a===this.activeGraph||(0,o.SZ)(i)!==(0,o.SZ)(this.filterValues()))){if(this.showSetupFields=!1,this.reportReady=!1,this.stopAutoRefresh(),null!=i&&i.export){const e=i.export;return delete i.export,this.reportExport(i,e),void setTimeout((()=>(0,de.p4)({reports:!0},!0)),1e3)}this.reportFetch(i,this.force?"force_html":"",l,(0,n.action)((e=>{if(this._addRecent(i),"object"!=typeof e)return(0,C.Mj)(lng("unexpected error occurred"));this.reportData=e,this.reportFiltersForm=new b({reportData:e,initialValues:i||{}}),this.reportReady=!0,"UpcomingZoomMeetings"===this.reportData.type&&["thisday","latertoday"].includes(null==i?void 0:i.range)&&(this.refreshSeconds=60,this._autoRefreshInterval=setInterval((()=>{this.refreshSeconds--,0===this.refreshSeconds&&this.reloadReport()}),1e3))})))}}stopAutoRefresh(){clearInterval(this._autoRefreshInterval),this.refreshSeconds=void 0}reloadReport(){let{activeGraph:e=this._activeGraph,page:t,noCache:i,swapReportClass:n,hidden_values:r,requestConfirmHighlight:s,scroll:o,force:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scrollTo=o;const l=Object.assign(this.filterValues(),r);l.page=t||(-1===l.page?-1:0),0==l.page&&delete l.page,this.noCache=i,this.force=a,this.requestConfirmHighlight=s,this.nav([n||this._activeReport,l,e,this._bookmarkId])}filterValues(){var e;return(null===(e=this.reportFiltersForm)||void 0===e?void 0:e.buildFinalValues())||{}}reportFetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;return(0,s.SC)(`reports/data/${this._activeReport}`,{method:"POST",data:{filters:e,format:t,noCache:i,bm:this.bookmarkId,origin:sessionStorage.getItem("last_location")}},n)}reportRedirect(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,s.hn)((0,s.Q2)(`reports/data/${this._activeReport}`),{filters:e,format:t,bm:this.bookmarkId,origin:sessionStorage.getItem("last_location")},i)}openPrint(){return this.reportRedirect(this.filterValues(),"print",!0)}openExport(){(0,a.cS)((0,d.BX)("div",{style:{paddingBottom:"10px"},children:[lng("pick the format that works best for you").caps(),":"]}),{title:lng("export report"),confirmText:lng("export"),inputType:"radioset",selectOptions:(0,o.wd)([[1,lng("excel").caps()],["pdf","PDF"],["csv","CSV"]]),inputOptions:{},onConfirm:e=>this.reportExport(this.filterValues(),e)})}reportExport(e,t){(0,k.vm)().showGlobalLoader=!0,fetch((0,s.Q2)(`reports/data/${this._activeReport}`,null,!0),{method:"POST",body:(0,s.xI)({filters:e,format:t,bm:this.bookmarkId})}).then((e=>e.blob())).then((e=>{(0,k.vm)().showGlobalLoader=!1;const i=window.open("","_blank"),n=i.document.createElement("a");i.document.body.appendChild(n);const r=n.href=window.URL.createObjectURL(e);var s;"pdf"!==t&&(t=1===t?"xlsx":t,n.download=((null===(s=this.reportData)||void 0===s?void 0:s.headline)||this._activeReport||"report").substring(0,31).trim()+"."+t,setTimeout((()=>i.close()),100));n.click(),n.remove(),setTimeout((()=>window.URL.revokeObjectURL(r)),36e5)}))}openCsv(){this.reportExport(this.filterValues(),"csv")}loadAnyway(){this.reloadReport({force:!0})}get activeReport(){return this._activeReport}set activeReport(e){this.nav([e])}get showFilters(){return"bookmark"!==this.activeReport}get activeGraph(){return parseInt(this._activeGraph)||0}set activeGraph(e){this.reloadReport({activeGraph:e})}get activePage(){return this.reportFiltersForm.getValue("page")}set activePage(e){this.reloadReport({page:e})}get bookmarkId(){return this._bookmarkId}set bookmarkId(e){this._bookmarkId=(null==e?void 0:e.toString())||null,this.reloadReport()}deleteBookmark(e){const t=(e,t)=>{this._sets.get(e).map((i=>{i.bookmark_id==t&&this._sets.get(e).remove(i)}))};(0,a.BB)(lng("are you sure you want to delete this bookmark?"),{onConfirm:()=>{(0,k.vm)().invalidateStore("dashboard"),this.bookmarkId=null,Blsm.user.isPowerManager?["personal","recommended","shared"].forEach((i=>t(i,e))):t("personal",e),(0,s.SC)("reports/action/delete_bookmark",{data:{bm_id:e},method:"POST"},(()=>{(0,C.qV)(lng("bookmarks deleted successfully"))}))}})}get mayEdit(){return Blsm.user.isPowerManager||this.isBookmarkCreator}get isBookmarkCreator(){return this._sets.get("personal").some((e=>parseInt(e.bookmark_id)===parseInt(this.bookmarkId)))}addBookmark(e,t,i,n){var r;const s=new Z.T({bookmarkId:e,activeReport:t||this.activeReport,parameters:i?null===(r=this.reportFiltersForm)||void 0===r?void 0:r.buildFinalValues():null==n?void 0:n.params,tab:this.listTab,onSaveSuccess:t=>{var i;(0,k.vm)().closeDialog(),(0,k.vm)().invalidateStore("dashboard");const n=s.values.get("personal_dashboard"),r=s.values.get("share_with_all"),o={bookmark_id:(null==t||null===(i=t.bookmarkInfo)||void 0===i?void 0:i.bookmark_id)||(null==t?void 0:t.bookmark_id)||this.bookmarkId,bookmark_name:s.values.get("bookmark_name"),bookmark_description:s.values.get("bookmark_desc"),bookmark_url:JSON.parse(s.values.get("bookmark_url")),modification_time:"0",object_id:null,share_with_all:s.values.get("share_with_all"),user_id:Blsm.user.id,widget_options:{widget_size:s.values.get("widget_size"),widget_view:s.values.get("widget_view")}};e?(this.reportData&&(this.reportData.bookmark_name=t.bookmarkInfo.bookmark_name,this.reportData.bookmark_description=t.bookmarkInfo.bookmark_description),["personal","recommended"].forEach((t=>{const i=this._sets.get(t).some((t=>t.bookmark_id===e));i?this._sets.get(t).map((i=>{i.bookmark_id==e&&("personal"===t&&Object.assign(i,o),"recommended"===t&&(r?Object.assign(i,o):this._sets.get(t).remove(i)))})):(n&&"personal"==t&&this._sets.get("personal").unshift(Object.assign({widget_order:n},o)),r&&"recommended"===t&&this._sets.get("recommended").unshift(Object.assign({widget_order:r},o)))}))):(this.bookmarkId=t.bookmark_id,this._sets.get("personal").unshift(Object.assign({widget_order:this._sets.get("personal").length+1},o)),r&&this._sets.get("recommended").unshift(Object.assign({widget_order:this._sets.get("recommended").length+1},o)))}});(0,k.vm)().openDialog("form",s)}shareReport(e){let{bookmarkId:t,bookmark_name:i}=e;(0,k.vm)().openDialog("form",new T({bookmarkId:t,bookmark_name:i,onSaveSuccess:()=>{(0,k.vm)().closeDialog(),(0,C.qV)(lng("report share saved"))}}))}bookmarkNotification(e){let{bookmarkId:t}=e;(0,k.vm)().openDialog("form",new D({bookmarkId:t,onSaveSuccess:()=>(0,k.vm)().closeDialog()}))}get reportIsDisplayed(){var e,t;return(null===(e=this.reportData)||void 0===e||null===(t=e.tables)||void 0===t?void 0:t.length)>0}}).prototype,"ready",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),U=me($.prototype,"selectedTags",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),H=me($.prototype,"searchText",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),J=me($.prototype,"listTab",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"find"}}),G=me($.prototype,"_sets",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),W=me($.prototype,"reportReady",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),K=me($.prototype,"_activeReport",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=me($.prototype,"_activeGraph",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Q=me($.prototype,"reportParams",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),ee=me($.prototype,"_bookmarkId",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),te=me($.prototype,"reportData",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=me($.prototype,"actionsData",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{a:null}}}),ne=me($.prototype,"showSetupFields",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),re=me($.prototype,"refreshSeconds",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=me($.prototype,"reportTooBig",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),oe=me($.prototype,"compactView",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!!S.X.get("reports_compactView")}}),ae=me($.prototype,"hideDescription",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!!S.X.get("reports_hideDescription")}}),le=me($.prototype,"sortBy",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ce=me($.prototype,"desc",[n.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),me($.prototype,"tabs",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"tabs"),$.prototype),me($.prototype,"visibleReports",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"visibleReports"),$.prototype),me($.prototype,"setSortBy",[P],Object.getOwnPropertyDescriptor($.prototype,"setSortBy"),$.prototype),me($.prototype,"tags",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"tags"),$.prototype),me($.prototype,"toogleHideDescription",[z],Object.getOwnPropertyDescriptor($.prototype,"toogleHideDescription"),$.prototype),me($.prototype,"toggleTagSelection",[E],Object.getOwnPropertyDescriptor($.prototype,"toggleTagSelection"),$.prototype),me($.prototype,"clearTagSelection",[R],Object.getOwnPropertyDescriptor($.prototype,"clearTagSelection"),$.prototype),me($.prototype,"_addRecent",[n.action],Object.getOwnPropertyDescriptor($.prototype,"_addRecent"),$.prototype),me($.prototype,"onViewSelect",[F],Object.getOwnPropertyDescriptor($.prototype,"onViewSelect"),$.prototype),me($.prototype,"updateRoute",[n.action],Object.getOwnPropertyDescriptor($.prototype,"updateRoute"),$.prototype),me($.prototype,"reloadReport",[M],Object.getOwnPropertyDescriptor($.prototype,"reloadReport"),$.prototype),me($.prototype,"filterValues",[A],Object.getOwnPropertyDescriptor($.prototype,"filterValues"),$.prototype),me($.prototype,"openPrint",[q],Object.getOwnPropertyDescriptor($.prototype,"openPrint"),$.prototype),me($.prototype,"openExport",[X],Object.getOwnPropertyDescriptor($.prototype,"openExport"),$.prototype),me($.prototype,"activeReport",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"activeReport"),$.prototype),me($.prototype,"showFilters",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"showFilters"),$.prototype),me($.prototype,"activeGraph",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"activeGraph"),$.prototype),me($.prototype,"activePage",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"activePage"),$.prototype),me($.prototype,"bookmarkId",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"bookmarkId"),$.prototype),me($.prototype,"addBookmark",[L],Object.getOwnPropertyDescriptor($.prototype,"addBookmark"),$.prototype),me($.prototype,"reportIsDisplayed",[n.computed],Object.getOwnPropertyDescriptor($.prototype,"reportIsDisplayed"),$.prototype),$)},7861:(e,t,i)=>{i.d(t,{Z:()=>R,hI:()=>E});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_=i(7821),f=i(8e3),y=i(4210),w=i(5007),x=i(793),k=i(9829),Z=i(5702),C=i(7327),S=i(7659),O=i(8246),B=i(8989),T=i(5519),N=i(8918),I=i(441),D=i(8318);function j(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function P(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function z(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const E=()=>({users:lng("users",{phrase:!0}),groups:lng("workspaces",{phrase:!0}),assignments:lng("assignments"),catalog:lng("catalog"),tasks:lng("tasks",{phrase:!0}),content:lng("shared content"),mycontent:lng("my content"),discussions:lng("discussions",{phrase:!0})});let R=(n=_.action.bound,r=_.action.bound,o=z((s=class{constructor(e){let{nav:t}=e;P(this,"searchCategories",[]),P(this,"availableCategories",[]),j(this,"_searchTerm",o,this),j(this,"_category",a,this),j(this,"results",l,this),j(this,"totalCount",c,this),j(this,"loading",d,this),j(this,"loadingMore",p,this),j(this,"compactView",u,this),j(this,"advanceFilterShow",m,this),j(this,"_filterForms",g,this),P(this,"_curFetch",null),j(this,"advanced",h,this),j(this,"suggestion",b,this),j(this,"recentSearchesRefresh",v,this),P(this,"skillSearchForm",void 0),P(this,"allowedUserFields",[]),(0,_.makeObservable)(this),this.nav=t,this.availableCategories=[Blsm.isFeatureEnabled("catalog")&&"content",Blsm.canAccessModule("Content")&&"mycontent","assignments",Blsm.isFeatureEnabled("course_registartion")&&"catalog",(!Blsm.isFeatureEnabled("isolate_users")||Blsm.user.isPowerManager||Blsm.user.perm.isGroupViewer||Blsm.user.perm.isOuViewer)&&"users","groups",Blsm.isFeatureEnabled("group_tasks")&&"tasks"].filter((e=>!!e)),this.searchCategories=this.availableCategories.map((e=>({val:e,label:E()[e]}))),Blsm.isFeatureEnabled("skills_occupations")&&(this.skillSearchForm=new A({onValueChange:(0,D.Ds)(this.doSearch,500),showOccupation:()=>"users"===this.activeCategory}))}get activeCategory(){return this._category||B.X.get("active_search_category")||this.searchCategories[0].val}set activeCategory(e){var t;const[i]=(0,w.vm)().mainRoute;B.X.set("active_search_category",e),"search"!==i?this._category=e:this.nav([e,{q:this.searchTerm,...null===(t=this.skillSearchForm)||void 0===t?void 0:t.buildFinalValues()}])}get filterForm(){return this._filterForms[this.activeCategory]}get searchTerm(){return this._searchTerm}set searchTerm(e){this.nav([this.activeCategory,{q:e}])}get moreAvailable(){return!this.loading&&!1!==this.totalCount&&this.totalCount>this.results.length}setQDelayed(e){this._searchTerm=e,clearTimeout(this.__delayTimeout),this.__delayTimeout=setTimeout(this.doSearch,1500)}loadHistory(e){const{q:t,category:i,filters:n}=e;this.nav([i,{q:t,...n}])}doSearch(){var e,t;this.nav([this.activeCategory,Object.assign({q:this.searchTerm},null===(e=this.filterForm)||void 0===e?void 0:e.buildFinalValues(),null===(t=this.skillSearchForm)||void 0===t?void 0:t.buildFinalValues())]),clearTimeout(this.__delayTimeout)}clearSearch(){clearTimeout(this.__delayTimeout),this._searchTerm=""}updateRoute(e){var t,i;let[n,{q:r="",...s}={}]=e,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._category=this.availableCategories.includes(n)?n:this.availableCategories[0],this._searchTerm=r,o.skipFetch||(null===(t=this.filterForm)||void 0===t||t.setValues(s,{clear:!0}),null===(i=this.skillSearchForm)||void 0===i||i.setValues(s,{clear:!0}),this.loading=!0,this.loadingMore=!1,this._fetch((e=>{var t,i,r,s;switch(n){case"assignments":this.results=(null===(t=e[n])||void 0===t?void 0:t.map((e=>new C.o(e,{workspace:this}))))||[];break;case"content":this.results=(null===(i=e[n])||void 0===i?void 0:i.map((e=>new S.m(e,{workspace:this}))))||[];break;case"catalog":this.results=null===(r=e[n])||void 0===r?void 0:r.map((e=>new N.N(e)));break;case"groups":this.results=(null===(s=e[n])||void 0===s?void 0:s.map((e=>new O.j(e))))||[];break;default:this.results.replace(e[n])}this.totalCount="users"===this.activeCategory?parseInt(e.users_total):"tasks"===this.activeCategory?parseInt(e.total_tasks):"groups"===this.activeCategory&&parseInt(e.groups_total),this.allowedUserFields=e.allowedUserFields,this.buildFilterForms(e.advanced),this.suggestion=e.suggestion,this.loading=!1})))}buildFilterForms(e){"groups"===this.activeCategory&&!this._filterForms.groups&&e&&(this._filterForms.groups=new F({onValueChange:(0,D.Ds)(this.doSearch,500)})),"users"===this.activeCategory&&!this._filterForms.users&&e&&(this._filterForms.users=new M({onValueChange:(0,D.Ds)(this.doSearch,500)})),"tasks"===this.activeCategory&&!this._filterForms.tasks&&e&&(this._filterForms.tasks=new x.h({onValueChange:(0,D.Ds)(this.doSearch,500),advanced:e})),"assignments"===this.activeCategory&&!this._filterForms.assignments&&e&&(this._filterForms.assignments=new k.g({onValueChange:(0,D.Ds)(this.doSearch,500),advanced:e,type:"assignments"})),"content"===this.activeCategory&&!this._filterForms.content&&e&&(this._filterForms.content=new k.g({onValueChange:(0,D.Ds)(this.doSearch,500),advanced:e,type:"content"})),"mycontent"==this.activeCategory&&!this._filterForms.mycontent&&e&&(this._filterForms.mycontent=new k.g({onValueChange:(0,D.Ds)(this.doSearch,500),advanced:e,type:"mycontent"}))}searchContentPage(e,t){switch(e){case"catalog":return{title:lng("catalog").caps(),href:(0,I.p4)({courseCatalog:!0,tab:"self",params:{term:t}})};case"content":return{title:lng("knowledge center").caps(),href:(0,I.p4)({catalog:!0,term:t})};case"mycontent":if(Blsm.user.isManager&&Blsm.isFeatureEnabled("catalog"))return{title:lng("my content").caps(),href:(0,I.p4)({list:"content",params:"filters[name]="+t})};break;case"users":if(Blsm.user.isPowerManager)return{title:lng("users").caps(),href:(0,I.p4)({list:"users",params:"filters[user_first_name]="+t})};break;default:return!1}}getMore(){const e=this.activeCategory;this.loadingMore=!0,this._fetch((t=>{var i,n,r;switch(e){case"assignments":this.results.push(...(null===(i=t[e])||void 0===i?void 0:i.map((e=>new C.o(e,{workspace:this}))))||[]);break;case"content":this.results.push(...(null===(n=t[e])||void 0===n?void 0:n.map((e=>new S.m(e,{workspace:this}))))||[]);break;case"groups":this.results.push(...(null===(r=t[e])||void 0===r?void 0:r.map((e=>new O.j(e))))||[]);break;default:this.results.push(...t[e])}this.loadingMore=!1}),!0)}_fetch(e,t){var i,n,r;const s={...null===(i=this.filterForm)||void 0===i?void 0:i.buildFinalValues(),...null===(n=this.skillSearchForm)||void 0===n?void 0:n.buildFinalValues()};B.X.push("recent_search",{q:this.searchTerm,key:this.searchTerm||" ",category:this.activeCategory,filters:s,date:new Date},15,!0),this.recentSearchesRefresh++,null===(r=this._curFetch)||void 0===r||r.abortFetch(),this._curFetch=(0,f.SC)("search/"+this.activeCategory,{onComplete:()=>this._curFetch=null,data:Object.assign({q:this.searchTerm,skip:t&&this.results.length},s)},e)}get recentSearches(){var e;return this.recentSearchesRefresh,((null===(e=B.X.get("recent_search"))||void 0===e?void 0:e.reverse())||[]).map((e=>{const t=e.q?e.q.truncate(40,"..."):"---";return{val:e,label:`${e.date?new moment(e.date).utcOffset(Blsm.prm.timezone_offset).format(`${Blsm.prm.short_date_moment_format} ${Blsm.prm.time_moment_format}`):""}    ${t} (${E()[e.category].caps()})`}}))}clear(){this._searchTerm="",Blsm.isFeatureEnabled("skills_occupations")&&!this.skillSearchForm&&(this.skillSearchForm=new A({onValueChange:(0,D.Ds)(this.doSearch,500),showOccupation:()=>"users"===this.activeCategory}))}}).prototype,"_searchTerm",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),a=z(s.prototype,"_category",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),l=z(s.prototype,"results",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),c=z(s.prototype,"totalCount",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=z(s.prototype,"loading",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=z(s.prototype,"loadingMore",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=z(s.prototype,"compactView",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=z(s.prototype,"advanceFilterShow",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=z(s.prototype,"_filterForms",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{users:null,groups:null,assignments:null,catalog:null,tasks:null,content:null,mycontent:null,discussions:null}}}),h=z(s.prototype,"advanced",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b=z(s.prototype,"suggestion",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=z(s.prototype,"recentSearchesRefresh",[_.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z(s.prototype,"activeCategory",[_.computed],Object.getOwnPropertyDescriptor(s.prototype,"activeCategory"),s.prototype),z(s.prototype,"filterForm",[_.computed],Object.getOwnPropertyDescriptor(s.prototype,"filterForm"),s.prototype),z(s.prototype,"searchTerm",[_.computed],Object.getOwnPropertyDescriptor(s.prototype,"searchTerm"),s.prototype),z(s.prototype,"moreAvailable",[_.computed],Object.getOwnPropertyDescriptor(s.prototype,"moreAvailable"),s.prototype),z(s.prototype,"doSearch",[n],Object.getOwnPropertyDescriptor(s.prototype,"doSearch"),s.prototype),z(s.prototype,"updateRoute",[_.action],Object.getOwnPropertyDescriptor(s.prototype,"updateRoute"),s.prototype),z(s.prototype,"getMore",[r],Object.getOwnPropertyDescriptor(s.prototype,"getMore"),s.prototype),z(s.prototype,"recentSearches",[_.computed],Object.getOwnPropertyDescriptor(s.prototype,"recentSearches"),s.prototype),s);class F extends y.I{constructor(e){let{onValueChange:t}=e;super({onValueChange:t}),this._fields=[{type:"component",Render:T.R9,label:lng("filter by type").caps()+":"},{type:"checkbox",name:"types[Group]",checkboxValue:"Group",label:lng("groups").caps()},{type:"checkbox",name:"types[Course]",checkboxValue:"Course",label:lng("courses").caps()},{type:"checkbox",name:"types[Ou]",checkboxValue:"Ou",label:lng("org units").caps()},{type:"checkbox",name:"types[Qualification]",checkboxValue:"Qualification",label:lng("qualifications").caps()},{type:"checkbox",name:"types[Workplan]",checkboxValue:"Workplan",label:lng("workplans").caps()},{type:"component",name:"rules",Render:Z._,props:{object_type:"groups"}}],this._prepFields()}}class M extends y.I{constructor(e){let{onValueChange:t}=e;super({onValueChange:t}),this._fields=[{type:"text",name:"ou",label:lng("filter by org' unit").caps(),disable:e=>!!e.get("no_ou")},{type:"checkbox",name:"no_ou",label:lng("no org' unit").caps()},{type:"component",Render:Z._,props:{object_type:"users"},name:"rules"}],this._prepFields()}}class A extends y.I{constructor(e){let{onValueChange:t,showOccupation:i}=e;super({onValueChange:t}),this._fields=[{type:"multiple_items",name:"skills",label:lng("search skill"),showId:!1,searchData:(e,t)=>{let{term:i,ids:n}=e;return(0,f.SC)("skills/autocomplete_skill",{data:{term:i,id:n}},t)}},{type:"single_item",name:"occupation",label:lng("search occupation"),showId:!1,searchData:(e,t)=>{let{term:i,ids:n}=e;return(0,f.SC)("skills/autocomplete_occupation",{data:{term:i,id:n}},t)},visible:()=>i()}],this._prepFields(),this.ready=!0}}},9011:(e,t,i)=>{i.d(t,{tT:()=>T,ye:()=>B,h:()=>O});var n,r,s,o,a=i(7821),l=i(7363),c=i(8318),d=i(6901),p=i(441),u=i(8989),m=i(5597),g=i(9431);function h(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let _=(r=v((n=class{constructor(){b(this,"managementMenuOptions",[]),b(this,"isEnterprise",Blsm.checkMod(["","ENT"])),h(this,"managementMenuOpen",r,this),h(this,"filterText",s,this),h(this,"_recentUse",o,this),(0,a.makeObservable)(this),this.managementMenuOptions=this._managementMenuBuild()}addRecentLink(e){e=(0,c.SZ)(e),this._recentUse.remove(e),this._recentUse.unshift(e);this._recentUse.length>9&&this._recentUse.replace(this._recentUse.slice(0,9)),u.X.set("management_menu_recent",this._recentUse.slice())}get recentUse(){const e=this.managementMenuOptions.slice();return this._recentUse.map((t=>(0,c.oH)(e,(e=>"object"==typeof e&&t===(0,c.SZ)(e.link))))).filter((e=>e))}_managementMenuBuild(){let e=[];const t=Blsm.InitialData.main_menu||{};if(Blsm.canAccessModule("Catalog")){const t=[];(Blsm.canAccessModule("Content|Questionnaires")||Blsm.hasPermission("blogs"))&&t.push({label:lng("my content"),link:{list:"content"}}),Blsm.hasPermission("catalog_manager")&&(Blsm.canAccessModule("Content|Questionnaires")&&t.push({label:lng("content permissions"),link:{list:"content_permissions"},help:"@content_permissions",displayInPermissions:!0}),t.push({label:lng("category tree"),link:{categoryTree:!0},help:"@categories_tree"}),this.isEnterprise&&t.push({label:lng("manage tags"),link:{list:"tags"},help:"@manage_tags"})),t.length&&e.push({title:lng("knowledge & content"),icon:"menu_library",items:t,tutorial:"content:management"})}if(Blsm.canAccessModule("Elearning")){const t=[{label:lng("assignments"),link:{list:"assignments"},help:"@my_assignments"}];Blsm.isFeatureEnabled("assignments")&&Blsm.checkMod(["assignments","ENT"])&&t.push({label:lng("master assignments"),link:{list:"master_assignments"},help:"@my_master_assignments"}),Blsm.user.isPowerManager&&(t.push({label:lng("all assignments"),link:{list:"all_assignments"}}),Blsm.checkMod(["assignments","ENT"])&&t.push({label:lng("grading ladders (verbal scoring)"),link:{list:"grading_ladders"}})),e.push({title:lng("assignments"),icon:"mng_elearning",items:t})}{const i=[];if(Blsm.CanUser("view","users","relative")){let e={label:lng("users"),link:{list:"users"},help:"@users",subs:[]};i.push(e),Blsm.user.isAdmin&&(t.ldapOn&&e.subs.push({label:lng("import users from %s","active directory"),link:{import:"ldap"}}),t.hibobOn&&e.subs.push({label:lng("import users from %s","Hibob"),link:{import:"hibob"}}),t.aadOn&&e.subs.push({label:lng("import users from %s","Azure Active Directory"),link:{import:"aad"}}))}Blsm.user.isPowerManager&&i.push({label:lng("power managers"),link:{list:"power_managers"},displayInPermissions:!0}),Blsm.canAccessModule("Ous")&&i.push({label:lng("organizational units"),link:{list:"ous"},help:"@organizational_units"}),Blsm.CanUser("view","groups","relative")&&i.push({label:lng("groups"),link:{list:"groups"},help:"@groups",tutorial:"workspace:configurations"}),Blsm.user.isPowerManager&&(i.push({label:lng("roles and privileges"),link:{list:"roles"},help:"@roles_and_privileges",displayInPermissions:!0},{label:lng("user fields"),link:{list:"user_fields"},help:"@manage_profile"}),this.isEnterprise&&i.push({label:lng("workspace fields"),link:{list:"group_fields"}})),Blsm.isFeatureEnabled("patients")&&Blsm.hasPermission("case_manager")&&Blsm.checkMod(["patients","ENT"])&&(i.push({label:lng("patients"),link:{list:"patients"}}),i.push({label:lng("patient cases"),link:{list:"patient_cases"}})),i.length&&e.push({title:lng("users & groups"),icon:"mng_users",items:i})}{const t=[];Blsm.CanUser("view","groups","relative")&&t.push({label:lng("courses"),link:{list:"courses"},help:"@groups"}),Blsm.user.isPowerManager&&Blsm.isFeatureEnabled("course_registartion_external")&&Blsm.checkMod(["course_registartion_external","ENT"])&&t.push({label:lng("external event types"),link:{list:"external_course_types"}},{label:`${lng("organizing institutions")}`,link:{list:"suppliers",params:"type=RegExt"}}),Blsm.user.isPowerManager&&Blsm.isFeatureEnabled("rating_tool")&&t.push({label:lng("rating tool"),link:{list:"rating_tool"}}),Blsm.CanUser("view","templates","relative")&&t.push({label:lng("course templates"),link:{list:"course_templates"},help:"@course_templates"}),Blsm.canAccessModule("Workplan")&&Blsm.checkMod(["","ENT"])&&t.push({label:lng("workplans"),link:{list:"workplans"}}),Blsm.canAccessModule("Certificates")&&t.push({label:lng("diplomas"),link:{list:"diplomas"},help:"@my_diplomas"}),Blsm.checkMod(["training_needs","ENT"])&&(Blsm.user.isPowerManager&&t.push({label:lng("training needs periods"),link:{list:"training_needs_periods"}}),Blsm.user.perm.isOuManager&&t.push({label:lng("training needs requests"),link:{list:"training_needs_requests"}})),t.length&&e.push({title:lng("courses"),icon:"mng_courses",items:t})}if(Blsm.canAccessModule("Qualifications")){const t=[{label:lng("qualifications",{phrase:!0}),link:{list:"qualifications"}}];Blsm.isFeatureEnabled("professions")&&Blsm.checkMod(["professions","ENT"])&&(t.push({label:lng("professions"),link:{list:"qualifications",params:"filters[professions]=1"}}),Blsm.user.isPowerManager&&t.push({label:lng("professional levels"),link:{list:"levels"}})),e.push({title:lng("qualifications",{phrase:!0}),icon:"mng_qualifications",items:t})}if(Blsm.canAccessModule("Resources")){const t=[{label:lng("resources"),link:{list:"resources"},help:"@manage_resources"},{label:lng("instructors"),link:{list:"resources",params:"mode=instructors"},help:"@manage_instructors"}];Blsm.checkMod(["Resources","ENT"])&&t.push({label:lng("resource categories"),link:{list:"resource_categories"}},{label:lng("resource planning"),link:{resourcePlanning:!0},help:"@resources_planning"},{label:lng("resource bundles"),link:{list:"resource_bundles"}}),e.push({title:lng("resources"),icon:"mng_resources",items:t})}if(Blsm.canAccessModule("Budgets")&&Blsm.checkMod(["Budgets","ENT"])){const t=[{label:lng("budgets"),link:{list:"budgets"}},{label:lng("budget items"),link:{list:"budget_items"}}];e.push({title:lng("budgets"),icon:"mng_budget",items:t})}if(Blsm.user.isPowerManager){const t=[];t.push.apply(t,(0,m.mL)().map((e=>Object.assign({link:e.href},e)))),Blsm.canAccessModule("Sequences")&&t.push({label:lng("approval sequences"),link:{list:"approval_sequences"},help:"@manage_approval_sequences"}),t.length&&e.push({title:lng("approvals"),icon:"mng_approvals",items:t,approvals_menu:!0})}{const t=[];Blsm.isFeatureEnabled("sites")&&Blsm.user.isPowerManager&&Blsm.checkMod(["sites","ENT"])&&t.push({label:lng("sites"),link:{list:"sites"}}),Blsm.user.isPowerManager&&(t.push({label:lng("themes"),link:{list:"themes"},help:"@manage_themes"}),this.isEnterprise&&t.push({label:lng("poster default gallery"),link:{list:"gallery"}})),Blsm.isFeatureEnabled("portal")&&Blsm.hasPermission("portal_manager")&&(t.push({label:g.Eo[g.Bu.DOMAIN],link:{list:"portals",params:{type:g.Bu.DOMAIN}}},{label:lng("edit the global news list"),link:{list:"news_items"}}),Blsm.checkMod(["portal","ENT"])&&t.push({label:g.Eo[g.Bu.ANONYMOUS],link:{list:"portals",params:{type:g.Bu.ANONYMOUS}}},{label:g.Eo[g.Bu.GROUP],link:{list:"portals",params:{type:g.Bu.GROUP}}},{label:lng("photo albums"),link:{list:"album"}})),Blsm.isFeatureEnabled("app_portal")&&Blsm.hasPermission("portal_manager")&&t.push({label:g.Eo[g.Bu.APP],link:{list:"portals",params:{type:g.Bu.APP}}}),t.length&&e.push({title:lng("sites & portals"),icon:"mng_site",items:t})}if(Blsm.user.isPowerManager){const t=[];Blsm.isFeatureEnabled("checkin")&&Blsm.checkMod(["checkin","ENT"])&&t.push({label:lng("check-in desk"),link:"checkin/config?domain="+Blsm.user.domain_id}),Blsm.isFeatureEnabled("food")&&Blsm.checkMod(["food","ENT"])&&(t.push({label:lng("food providers"),link:{list:"food_providers"}}),t.push({label:lng("food orders"),link:{list:"food_orders"}})),t.length&&e.push({title:lng("kiosk"),icon:"kiosk",items:t})}{const t=[];Blsm.user.isPowerManager&&Blsm.isFeatureEnabled("group_tasks")&&Blsm.checkMod(["group_tasks","ENT"])&&t.push({label:lng("task statuses"),link:{list:"task_statuses"}},{label:lng("task types"),link:{list:"task_types"}}),t.length&&e.push({title:lng("tasks"),icon:"support",items:t})}{const t=[];Blsm.user.isPowerManager&&Blsm.isFeatureEnabled("gamification")&&t.push({label:lng("challenges"),link:{list:"challenges"}}),t.length&&e.push({title:lng("gamification"),icon:"game",items:t})}if(Blsm.user.isPowerManager||Blsm.hasPermission("system_messages_editor")){{const t=[];Blsm.user.isPowerManager&&(t.push({label:lng("manager permission types"),link:{list:"manager_permission_types"},tutorial:"workspace:manager_permission_types",displayInPermissions:!0},{label:lng("classifications"),link:{list:"classifications"}},{label:lng("domain"),link:{edit:"domain",id:Blsm.user.domain_id},help:"@manage_domain"}),this.isEnterprise&&t.push({label:lng("phrases"),link:{list:"phrases"},help:"@manage_phrases"},{label:lng("manuals|guide"),link:{list:"manuals"},help:"@manage_manuals"},{label:lng("user status codes"),link:{list:"status_codes"}}),Blsm.canAccessModule("Currency")&&Blsm.checkMod(["Currency","ENT"])&&t.push({label:lng("currencies"),link:{list:"currencies"}}),Blsm.isFeatureEnabled("designation")&&Blsm.checkMod(["designation","ENT"])&&t.push({label:lng("designation",{phrase:!0}),link:{list:"designation"}}),Blsm.isFeatureEnabled("professions")&&Blsm.checkMod(["professions","ENT"])&&t.push({label:lng("skills for questionnaires",{phrase:!0}),link:{list:"question_skills"}}),Blsm.isFeatureEnabled("skills_occupations")&&(Blsm.user.isAdmin||Blsm.user.isPowerManager&&(0===Blsm.user.multi_user.length||null===Blsm.user.domains_list))&&t.push({label:lng("manage occupations",{phrase:!0}),link:{list:"occupations"}}),Blsm.isFeatureEnabled("online_content")&&t.push({label:lng("online content categories"),link:{list:"oc_categories"}}),Blsm.isFeatureEnabled("eula")&&t.push({label:lng("EULA consent"),link:{edit:"eula"}}),t.push({label:lng("activity log"),link:{list:"activity_log"}}),Blsm.InitialData.pm_monitoring&&t.push({label:lng("mailing monitor"),link:{list:"mails/status=queue"}})),this.isEnterprise&&Blsm.hasPermission("system_messages_editor")&&t.push({label:lng("system messages"),link:{list:"system_messages"},help:"@manage_system_messages"}),e.push({title:lng("general"),icon:"mng_domain",items:t})}{const i=[];t.providers&&Object.entries(t.providers).forEach((e=>{let[t,{name:n,single:r}]=e;i.push({label:n,link:r?{edit:"provider_"+t}:{list:"providers",params:{provider:t}}})})),Blsm.user.isAdmin&&i.push({label:"OpenSesame",link:{edit:"opensesame"}},{label:"LinkedIn Learning",link:{edit:"linkedin_learning"}}),i.length&&e.push({title:lng("integrations"),icon:"external_content",items:i})}if(Blsm.user.isPowerManager){const t=[];for(const[e,i]of Object.entries((0,d.K)(this.isEnterprise)))t.push({label:`${lng("custom fields")} - ${i.caps(!1)}`,link:{list:"customfields",params:e}});t.length&&e.push({title:lng("custom fields"),icon:"edit",items:t})}}if(Blsm.user.isAdmin){const t=[{label:lng("domains"),link:{list:"domains"}},{label:lng("admins"),link:{list:"admins"},displayInPermissions:!0},{label:lng("power managers"),link:{list:"power_managers"}},{label:lng("server configuration"),link:{edit:"server"},help:"@edit_server_parameters"},{label:lng("update"),link:{edit:"update_system"}},{label:lng("mailing monitor"),link:{list:"mails/status=queue"}},{label:lng("error log"),link:{list:"error_log"}},{label:lng("remote servers"),link:{list:"remote_systems"}}];Blsm.InitialData.special.sqltools&&t.push({label:lng("sql tools"),link:"#sql"}),e.push({title:lng("system administration"),icon:"mng_settings",items:t})}{const t=[];e.forEach((e=>{e.items.length&&e.items.forEach((e=>e.displayInPermissions&&t.push(e)))})),t.length>0&&e.push({title:lng("permissions"),icon:"lock",items:t})}return 1===e.length&&e[0].approvals_menu&&(e=[]),e}}).prototype,"managementMenuOpen",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=v(n.prototype,"filterText",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),o=v(n.prototype,"_recentUse",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return u.X.get("management_menu_recent")||[]}}),v(n.prototype,"addRecentLink",[a.action],Object.getOwnPropertyDescriptor(n.prototype,"addRecentLink"),n.prototype),v(n.prototype,"recentUse",[a.computed],Object.getOwnPropertyDescriptor(n.prototype,"recentUse"),n.prototype),n);var f,y,w,x,k;function Z(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function C(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function S(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const O=(0,l.createContext)(null);let B=(y=S((f=class{constructor(){Z(this,"opened",y,this),Z(this,"activeItem",w,this),(0,a.makeObservable)(this)}}).prototype,"opened",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=S(f.prototype,"activeItem",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),f),T=(k=S((x=class extends B{constructor(){super(),Z(this,"managementMenuOpen",k,this),C(this,"managementMenuStore",new _),(0,a.makeObservable)(this)}updateRoute(e){const[t,i]=e;if("list"===t&&"forms"===i)return this.activeItem=i;switch(t){case"workspace":return this.activeItem="home";case"edit":case"edit2":return this.activeItem="management";case"user":return this.activeItem="challenges"}this.activeItem=t}get menuOptions(){var e,t,i,n;const r=[],s=Blsm.isFeatureEnabled("digital_library")||Blsm.isFeatureEnabled("online_content"),o=Blsm.isFeatureEnabled("catalog"),a=(null===(e=Blsm.InitialData.main_menu)||void 0===e?void 0:e.coursecatalog)||(null===(t=Blsm.InitialData.main_menu)||void 0===t?void 0:t.manager_coursecatalog),l=Blsm.isFeatureEnabled("gamification")&&(null===(i=Blsm.InitialData.main_menu)||void 0===i?void 0:i.challenges);if(Blsm.user.id&&this.managementMenuStore.managementMenuOptions.length>0){const e=()=>{this.managementMenuStore.managementMenuOpen=!this.managementMenuStore.managementMenuOpen,this.managementMenuStore.filterText=""};r.push({id:"management",icon:"menu_management",label:lng("management"),className:"mobile_off",onClick:e})}return null!==(n=Blsm.InitialData.main_menu)&&void 0!==n&&n.portal&&r.push({id:"portal",label:lng("portal",{phrase:!0}),icon:"home",href:(0,p.p4)({portal:!0})}),Blsm.user.id&&(r.push({id:"home",label:lng("desktop",{phrase:!0}),icon:"desktop",href:(0,p.p4)({home:!0})}),Blsm.isFeatureEnabled("group_tasks")&&r.push({id:"tasks",label:lng("tasks",{phrase:!0}),icon:"tasks",href:(0,p.p4)({tasks:!0})}),Blsm.canAccessModule("Reports")&&!(0,c.tq)()&&((Blsm.isFeatureEnabled("personal_dashboard")||Blsm.isFeatureEnabled("dashboard_assignments_workspaces"))&&r.push({id:"dashboard",label:lng("dashboard"),icon:"menu_dashboard",href:"#dashboard"}),r.push({id:"reports",label:lng("reports"),icon:"report",href:"#reports"})),s?(o||a)&&r.push({id:"library",label:lng("digital library",{phrase:!0}),icon:"for_u",href:(0,p.p4)({library:!0})}):o&&r.push({id:"catalog",label:lng("knowledge center",{phrase:!0}),icon:"menu_library",href:(0,p.p4)({catalog:!0})}),Blsm.isGuiFeatureEnabled("hide_calendar")||r.push({id:"calendar",label:lng("calendar"),icon:"menu_calendar",href:(0,p.p4)({calendar:!0})})),!a||Blsm.user.id&&s||r.push({id:"cregistration",label:lng("catalog",{phrase:!0}),icon:"mng_courses",href:(0,p.p4)({courseCatalog:!0})}),Blsm.user.id&&Blsm.isFeatureEnabled("questionnaire_forms")&&Blsm.checkMod(["questionnaire_forms","ENT"])&&r.push({id:"forms",label:lng("forms"),icon:"vendor_form",href:(0,p.p4)({list:"forms"})}),l&&r.push({id:"challenges",label:lng("challenges"),icon:"challenge",href:(0,p.p4)({user:!0,tab:"challenges"})}),r}_managementMenuBuild(){let e=[];if(Blsm.canAccessModule("Catalog")){const t=[];(Blsm.canAccessModule("Content|Questionnaires")||Blsm.hasPermission("blogs"))&&t.push({label:lng("my content"),link:{list:"content"}}),Blsm.hasPermission("catalog_manager")&&(Blsm.canAccessModule("Content|Questionnaires")&&t.push({label:lng("content permissions"),link:{list:"content_permissions"},help:"@content_permissions"}),t.push({label:lng("category tree"),link:{categoryTree:!0},help:"@categories_tree"}),Blsm.checkMod(["","ENT"])&&t.push({label:lng("manage tags"),link:{list:"tags"},help:"@manage_tags"})),t.length&&e.push({title:lng("knowledge & content"),icon:"menu_library",items:t,tutorial:"content:management"})}if(Blsm.canAccessModule("Elearning")){const t=[{label:lng("assignments"),link:{list:"assignments"},help:"@my_assignments"}];Blsm.isFeatureEnabled("assignments")&&Blsm.checkMod(["assignments","ENT"])&&t.push({label:lng("master assignments"),link:{list:"master_assignments"},help:"@my_master_assignments"}),Blsm.user.isPowerManager&&(t.push({label:lng("all assignments"),link:{list:"all_assignments"}}),Blsm.checkMod(["assignments","ENT"])&&t.push({label:lng("grading ladders (verbal scoring)"),link:{list:"grading_ladders"}})),e.push({title:lng("assignments"),icon:"mng_elearning",items:t})}{const i=[];if(Blsm.CanUser("view","users","relative")){let e={label:lng("users"),link:{list:"users"},help:"@users",subs:[]};var t;if(i.push(e),Blsm.user.isAdmin)e.subs.push({label:lng("import users from %s","active directory"),link:{import:"ldap"}}),(null===(t=Blsm.InitialData.main_menu)||void 0===t?void 0:t.hibobOn)&&e.subs.push({label:lng("import users from %s","Hibob"),link:{import:"hibob"}})}Blsm.user.isPowerManager&&i.push({label:lng("power managers"),link:{list:"power_managers"}}),Blsm.canAccessModule("Ous")&&i.push({label:lng("organizational units"),link:{list:"ous"},help:"@organizational_units"}),Blsm.CanUser("view","groups","relative")&&i.push({label:lng("groups"),link:{list:"groups"},help:"@groups",tutorial:"workspace:configurations"}),Blsm.user.isPowerManager&&(i.push({label:lng("roles and privileges"),link:{list:"roles"},help:"@roles_and_privileges"},{label:lng("user fields"),link:{list:"user_fields"},help:"@manage_profile"}),Blsm.checkMod(["","ENT"])&&i.push({label:lng("workspace fields"),link:{list:"group_fields"}})),Blsm.isFeatureEnabled("patients")&&Blsm.hasPermission("case_manager")&&Blsm.checkMod(["patients","ENT"])&&(i.push({label:lng("patients"),link:{list:"patients"}}),i.push({label:lng("patient cases"),link:{list:"patient_cases"}})),i.length&&e.push({title:lng("users & groups"),icon:"mng_users",items:i})}{const t=[];Blsm.CanUser("view","groups","relative")&&t.push({label:lng("courses"),link:{list:"courses"},help:"@groups"}),Blsm.user.isPowerManager&&Blsm.isFeatureEnabled("course_registartion_external")&&Blsm.checkMod(["course_registartion_external","ENT"])&&t.push({label:lng("external event types"),link:{list:"external_course_types"}},{label:`${lng("organizing institutions")}`,link:{list:"suppliers",params:"type=RegExt"}}),Blsm.CanUser("view","templates","relative")&&t.push({label:lng("course templates"),link:{list:"course_templates"},help:"@course_templates"}),Blsm.canAccessModule("Workplan")&&Blsm.checkMod(["","ENT"])&&t.push({label:lng("workplans"),link:{list:"workplans"}}),Blsm.canAccessModule("Certificates")&&t.push({label:lng("diplomas"),link:{list:"diplomas"},help:"@my_diplomas"}),t.length&&e.push({title:lng("courses"),icon:"mng_courses",items:t})}if(Blsm.canAccessModule("Qualifications")){const t=[{label:lng("qualifications"),link:{list:"qualifications"}}];Blsm.isFeatureEnabled("professions")&&Blsm.checkMod(["professions","ENT"])&&(t.push({label:lng("professions"),link:{list:"qualifications",params:"filters[professions]=1"}}),Blsm.user.isPowerManager&&t.push({label:lng("professional levels"),link:{list:"levels"}})),e.push({title:lng("qualifications"),icon:"mng_qualifications",items:t})}if(Blsm.canAccessModule("Resources")){const t=[{label:lng("resources"),link:{list:"resources"},help:"@manage_resources"},{label:lng("instructors"),link:{list:"resources",params:"mode=instructors"},help:"@manage_instructors"}];Blsm.checkMod(["Resources","ENT"])&&t.push({label:lng("resource categories"),link:{list:"resource_categories"}},{label:lng("resource planning"),link:{resourcePlanning:!0},help:"@resources_planning"},{label:lng("resource bundles"),link:{list:"resource_bundles"}}),e.push({title:lng("resources"),icon:"mng_resources",items:t})}if(Blsm.canAccessModule("Budgets")&&Blsm.checkMod(["Budgets","ENT"])){const t=[{label:lng("budgets"),link:{list:"budgets"}},{label:lng("budget items"),link:{list:"budget_items"}}];e.push({title:lng("budgets"),icon:"mng_budget",items:t})}if(Blsm.user.isPowerManager){const t=[];t.push.apply(t,(0,m.mL)().map((e=>Object.assign({link:e.href},e)))),Blsm.canAccessModule("Sequences")&&t.push({label:lng("approval sequences"),link:{list:"approval_sequences"},help:"@manage_approval_sequences"}),t.length&&e.push({title:lng("approvals"),icon:"mng_approvals",items:t,approvals_menu:!0})}{const t=[];Blsm.isFeatureEnabled("sites")&&Blsm.user.isPowerManager&&Blsm.checkMod(["sites","ENT"])&&t.push({label:lng("sites"),link:{list:"sites"}}),Blsm.user.isPowerManager&&(t.push({label:lng("themes"),link:{list:"themes"},help:"@manage_themes"}),Blsm.checkMod(["","ENT"])&&t.push({label:lng("poster default gallery"),link:{list:"gallery"}})),Blsm.isFeatureEnabled("portal")&&Blsm.hasPermission("portal_manager")&&(t.push({label:g.Eo[g.Bu.DOMAIN],link:{list:"portals",params:{type:g.Bu.DOMAIN}}},{label:lng("edit the global news list"),link:{list:"news_items"}}),Blsm.checkMod(["portal","ENT"])&&t.push({label:g.Eo[g.Bu.ANONYMOUS],link:{list:"portals",params:{type:g.Bu.ANONYMOUS}}},{label:g.Eo[g.Bu.GROUP],link:{list:"portals",params:{type:g.Bu.GROUP}}},{label:lng("photo albums"),link:{list:"album"}})),Blsm.isFeatureEnabled("app_portal")&&Blsm.hasPermission("portal_manager")&&t.push({label:g.Eo[g.Bu.APP],link:{list:"portals",params:{type:g.Bu.APP}}}),t.length&&e.push({title:lng("sites & portals"),icon:"mng_site",items:t})}if(Blsm.user.isPowerManager){const t=[];Blsm.isFeatureEnabled("checkin")&&Blsm.checkMod(["checkin","ENT"])&&t.push({label:lng("check-in desk"),link:"checkin/config?domain="+Blsm.user.domain_id}),Blsm.isFeatureEnabled("food")&&Blsm.checkMod(["food","ENT"])&&(t.push({label:lng("food providers"),link:{list:"food_providers"}}),t.push({label:lng("food orders"),link:{list:"food_orders"}})),t.length&&e.push({title:lng("kiosk"),icon:"kiosk",items:t})}{const t=[];Blsm.user.isPowerManager&&Blsm.isFeatureEnabled("group_tasks")&&Blsm.checkMod(["group_tasks","ENT"])&&t.push({label:lng("task statuses"),link:{list:"task_statuses"}},{label:lng("task types"),link:{list:"task_types"}}),t.length&&e.push({title:lng("tasks"),icon:"support",items:t})}{const t=[];Blsm.user.isPowerManager&&Blsm.isFeatureEnabled("gamification")&&t.push({label:lng("challenges"),link:{list:"challenges"}}),t.length&&e.push({title:lng("gamification"),icon:"game",items:t})}if(Blsm.user.isPowerManager){{var i;const t=[{label:lng("manager permission types"),link:{list:"manager_permission_types"},tutorial:"workspace:manager_permission_types"},{label:lng("domain"),link:{edit:"domain",id:Blsm.user.domain_id},help:"@manage_domain"}];Blsm.checkMod(["","ENT"])&&t.push({label:lng("manuals|guide"),link:{list:"manuals"},help:"@manage_manuals"},{label:lng("user status codes"),link:{list:"status_codes"}},{label:lng("system messages"),link:{list:"system_messages"},help:"@manage_system_messages"},{label:lng("phrases"),link:{list:"phrases"},help:"@manage_phrases"}),Blsm.canAccessModule("Currency")&&Blsm.checkMod(["Currency","ENT"])&&t.push({label:lng("currencies"),link:{list:"currencies"}}),window.Branch.isAdmin()&&t.push({label:lng("classifications"),link:{list:"classifications"}}),Blsm.isFeatureEnabled("designation")&&Blsm.checkMod(["designation","ENT"])&&t.push({label:lng("designation",{phrase:!0}),link:{list:"designation"}}),Blsm.isFeatureEnabled("professions")&&Blsm.checkMod(["professions","ENT"])&&t.push({label:lng("skills for questionnaires",{phrase:!0}),link:{list:"question_skills"}}),Blsm.isFeatureEnabled("online_content")&&t.push({label:lng("online content categories"),link:{list:"oc_categories"}}),Blsm.isFeatureEnabled("eula")&&t.push({label:lng("EULA consent"),link:{edit:"eula"}}),null!==(i=Blsm.InitialData.main_menu)&&void 0!==i&&i.providersOn&&t.push({label:lng("providers"),link:{list:"providers"}}),t.push({label:lng("activity log"),link:{list:"activity_log"}}),e.push({title:lng("domain management"),icon:"mng_domain",items:t})}{const t=[];if(Blsm.checkMod(["","ENT"]))for(const[e,i]of Object.entries((0,d.K)()))t.push({label:`${lng("custom fields")} - ${i.caps(!1)}`,link:{list:"customfields",params:e}});t.length&&e.push({title:lng("custom fields"),icon:"edit",items:t})}}if(Blsm.user.isAdmin){const t=[{label:lng("domains"),link:{list:"domains"}},{label:lng("admins"),link:{list:"admins"}},{label:lng("power managers"),link:{list:"power_managers"}},{label:lng("server configuration"),link:{edit:"server"},help:"@edit_server_parameters"},{label:lng("update"),link:{edit:"update_system"}},{label:lng("mailing monitor"),link:{list:"mails/status=queue"}},{label:lng("error log"),link:{list:"error_log"}},{label:lng("remote servers"),link:{list:"remote_systems"}}];Blsm.InitialData.special.sqltools&&t.push({label:lng("sql tools"),link:"#sql"}),e.push({title:lng("system administration"),icon:"mng_settings",items:t})}if(Blsm.user.isAdmin){const t=[{label:"OpenSesame",link:{edit:"opensesame"}},{label:"LinkedIn Learning",link:{edit:"linkedin_learning"}}];e.push({title:lng("online content"),icon:"external_content",items:t})}return 1===e.length&&e[0].approvals_menu&&(e=[]),e}}).prototype,"managementMenuOpen",[a.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),S(x.prototype,"updateRoute",[a.action],Object.getOwnPropertyDescriptor(x.prototype,"updateRoute"),x.prototype),S(x.prototype,"menuOptions",[a.computed],Object.getOwnPropertyDescriptor(x.prototype,"menuOptions"),x.prototype),x)},5007:(e,t,i)=>{i.d(t,{Nd:()=>Gs,Zg:()=>Js,l9:()=>$s,vm:()=>Us});var n,r,s,o,a,l,c,d,p,u,m=i(7821),g=i(7363),h=i(9011),b=i(2213),v=i(8e3),_=i(8318),f=i(8534),y=i(4902),w=i(2334),x=i(2906),k=i(2216),Z=i(6920),C=i(5944);function S(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function O(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function B(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let T=(n=m.action.bound,s=B((r=class{constructor(){S(this,"new_count",s,this),S(this,"notifications",o,this),S(this,"approvals",a,this),S(this,"t2k_echo",l,this),S(this,"t2k_echo_count",c,this),S(this,"skillsExist",d,this),S(this,"showImportant",p,this),S(this,"inbox_unread_count",u,this),O(this,"timestamp",null),O(this,"total",0),O(this,"broadCastChannel",void 0),O(this,"_refreshInterval",void 0),(0,m.makeObservable)(this),void 0!==window.BroadcastChannel&&(this.broadCastChannel=new BroadcastChannel("NotificationStore"),this.broadCastChannel.onmessage=e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.popupClosed)&&(0,f.EP)(e.data.popupClosed)}),this.fetchNotifications();Blsm.prm.LOCALHOST||(this._refreshInterval=setInterval((()=>this.fetchNotifications()),6e4*((0,_.B5)(Blsm.InitialData.notification_frequency)||window.Branch.NotificationInterval())))}fetchNotifications(){let{more:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!(0,_.B5)(Blsm.user.id))return;const t={};e?t.skip=this.notifications.reduce(((e,t)=>e+t.count),0):t.since=this.timestamp,(0,v.SC)("notifications",{data:t,selfErrorHandling:!0,onError:e=>401===e.status&&clearInterval(this._refreshInterval)},(0,m.action)((e=>{var t,i,n,r,s,o;if(!Array.isArray(null==e?void 0:e.notifications))return console.warn(e);this.skillsExist=e.skills_exist,this.showCongratulations=e.congratulations,null!==(t=e.t2k_echo_req)&&void 0!==t&&null!==(i=t.post)&&void 0!==i&&i.context_id&&(this.t2k_echo=e.t2k_echo_req,fetch(this.t2k_echo.url,{method:"POST",body:(0,v.xI)(this.t2k_echo.post)}).then((e=>e.json())).then((e=>(0,_.kE)(null==e?void 0:e.responseText)&&(this.t2k_echo_count=parseInt(e.responseText)))).catch((e=>console.error("T2K_ECHO Error:",e)))),(null===(n=e.notifications)||void 0===n?void 0:n.length)>0&&(null===(r=Blsm.user)||void 0===r||null===(s=r.preferences)||void 0===s||!s.hide_mention_notice)&&this.mentionNotice(e),this.followingAssignmentsNotice(e),this.showCongratulations&&this.congratulationsNotice();const a=[],l=new Map;for(const t of e.notifications){const e=new N(t);a.push(e),(0,_.B5)(e.task_id)&&l.set(e.task_id,e)}for(const e of this.notifications)a.push(e);this.notifications=a,e.timestamp&&(this.timestamp=e.timestamp),"new_count"in e&&(this.new_count=parseInt(e.new_count),Blsm.helpers.favicon_dot(this.new_count>0)),e.total&&(this.total=parseInt(e.total)),(0,_.Dw)(e.approvals)&&(this.approvals=m.observable.object(e.approvals)),null!==(o=e.notifications)&&void 0!==o&&o.length&&Gs.trigger("FetchNotifications",null==e?void 0:e.notifications)})))}markNotificationsRead(){(0,v.SC)("notifications/mark_all_read",{},(()=>{this.notifications.forEach((e=>e.markRead()))})),Blsm.helpers.favicon_dot(!1)}toggleImportant(){this.showImportant=!this.showImportant}markRead(e){(0,v.SC)("notifications/mark_read",{data:{id:e}},(()=>{this.notifications.forEach((t=>{t.pn_id==e&&t.markRead()}))}))}get filteredNotifications(){return this.notifications.slice().sort(((e,t)=>t.attr("time_order")-e.attr("time_order"))).filter((e=>!this.showImportant||!!(e.task_id&&e.assignee_name===(0,_.v2)(Blsm.user)||"comment_mention"===e.object_type)))||[]}get t2k_echo_req(){return this.t2k_echo}approvalTypesSorted(){return Object.keys(this.approvals).filter((e=>this.approvals[e]>0)).sort(((e,t)=>this.approvals[e]>this.approvals[t]?-1:1))}totalApprovals(){return Object.values(this.approvals).reduce(((e,t)=>parseInt(e||0)+parseInt(t||0)),0)}mentionNotice(e){const t=e.notifications.filter((e=>"comment_mention"===e.object_type&&!e.is_read&&moment(e.pn_time).isAfter(Us().startTime))).sort(((e,t)=>moment(e.pn_time).isAfter(t.pn_time)));if(t.length>0){const{data:e,pn_id:i,pn_time:n,user:r}=t[0];(0,f.LB)({title:e.task_title,msg:lng("%s mentioned you in a comment",(0,_.v2)(r)),href:{edit:"task",id:e.task_id,section:`c=${e.comment_id}`},onClick:()=>{this.markRead(i),this.new_count>0&&this.new_count--},altIconComponent:(0,C.tZ)(y.qE,{user:r,size:"2em",rounded:!1,balloon:!1}),remark:(0,w.GG)(n,{relative:!0}),closeOnClick:!0,type:"notice",id:i,onClose:()=>{var e;return null===(e=this.broadCastChannel)||void 0===e?void 0:e.postMessage({popupClosed:i})}})}}followingAssignmentsNotice(e){const t=e.notifications.filter((e=>"following_assignment"===e.object_type&&!e.is_read)).sort(((e,t)=>moment(e.pn_time).isAfter(t.pn_time)));for(const e of t)(0,k.S)({title:lng("the assignment you just finished has a following assignment"),msg:lng('next assignment: "%s"',e.data.assignment_name).caps(),href:{launcher:"assignment",id:e.object_id,cuser:e.data.cuser,absolute:!0},color:Z.g.colors.yellow,hrefTitle:lng("run assignment").caps(),type:"notice"}),this.markRead(e.pn_id)}congratulationsNotice(){(0,k.S)({type:"congratulations",animation:["confetti_1","confetti_2"]})}}).prototype,"new_count",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=B(r.prototype,"notifications",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),a=B(r.prototype,"approvals",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),l=B(r.prototype,"t2k_echo",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=B(r.prototype,"t2k_echo_count",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),d=B(r.prototype,"skillsExist",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=B(r.prototype,"showImportant",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u=B(r.prototype,"inbox_unread_count",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Blsm.InitialData.inbox_unread_count}}),B(r.prototype,"fetchNotifications",[n],Object.getOwnPropertyDescriptor(r.prototype,"fetchNotifications"),r.prototype),B(r.prototype,"filteredNotifications",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"filteredNotifications"),r.prototype),B(r.prototype,"t2k_echo_req",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"t2k_echo_req"),r.prototype),r);class N extends x.JH{constructor(e){super(e),O(this,"subs",[]),(0,m.makeObservable)(this)}markRead(){this._attr.is_read=1}get pn_id(){return this._attr.pn_id}get is_read(){return this._attr.is_read}get time(){return this._attr.pn_time||this._attr.time}get task_id(){return this._attr.data.task_id}get assignee_name(){return this._attr.data.assignee_name}get object_type(){return this._attr.object_type}get count(){return this.subs.length+1}get task_resolution(){return this._attr.data.task_resolution}get task_status(){return this._attr.data.task_status}get task_title(){return this._attr.data.task_title}get activity_type(){return this._attr.data.type}get user(){return this._attr.user}addSub(e){this.subs=[...this.subs,e,...e.subs]}}var I,D,j,P,z=i(421);function E(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function R(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function F(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let M=(I=class{constructor(e){let{nav:t}=e;E(this,"loadingChunk",D,this),E(this,"formObj",j,this),R(this,"route",[]),E(this,"_showUsersDrawer",P,this),(0,m.makeObservable)(this),this.nav=t}updateRoute(e,t){var i;let{reload:n}=t;var r;if(!n&&"success"!==(null===(i=this.formObj)||void 0===i?void 0:i.status)&&!0===(null===(r=this.formObj)||void 0===r?void 0:r.updateFormRoute(e)))return;this.route=e,this._getFormObject().then((e=>this.formObj=e))}async _getFormObject(){const{forms:e}=await i.e(800).then(i.bind(i,6733));this.loadingChunk=!1;for(let t of e){const e=t.matchForm(this.route,{nav:this.nav});if(e)return Blsm.forms||(Blsm.forms=[]),Blsm.forms.push(e),e}}setShowUsersDrawer(e){this._showUsersDrawer=e}get showUsersDrawer(){return this._showUsersDrawer}get ready(){return this.formObj&&this.formObj.ready}invalidate(){this.formObj&&(this.formObj.ready=!1)}get error(){return this.formObj?this.formObj.error:"form not found"}},D=F(I.prototype,"loadingChunk",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),j=F(I.prototype,"formObj",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=F(I.prototype,"_showUsersDrawer",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),F(I.prototype,"setShowUsersDrawer",[m.action],Object.getOwnPropertyDescriptor(I.prototype,"setShowUsersDrawer"),I.prototype),F(I.prototype,"showUsersDrawer",[m.computed],Object.getOwnPropertyDescriptor(I.prototype,"showUsersDrawer"),I.prototype),F(I.prototype,"ready",[m.computed],Object.getOwnPropertyDescriptor(I.prototype,"ready"),I.prototype),F(I.prototype,"error",[m.computed],Object.getOwnPropertyDescriptor(I.prototype,"error"),I.prototype),I);var A,q;function X(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function L(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let $=(A=class{constructor(e){let{nav:t}=e;var i,n,r,s;i=this,n="listObj",s=this,(r=q)&&Object.defineProperty(i,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(s):void 0}),X(this,"route",[]),(0,m.makeObservable)(this),this.nav=t}updateRoute(e){var t;!0!==(null===(t=this.listObj)||void 0===t?void 0:t.updateListRoute(e))&&(this.route=e,this._getListObject().then((e=>this.listObj=e)))}async _getListObject(){const{lists:e}=await Promise.all([i.e(866),i.e(822)]).then(i.bind(i,130));for(let t of e){const e=t.match(this.route,{nav:this.nav});if(e)return e}}get ready(){var e;return null!==this.listObj&&(null===(e=this.listObj)||void 0===e?void 0:e.ready)}get error(){return this.listObj?this.listObj.error:"list not found"}},q=L(A.prototype,"listObj",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L(A.prototype,"ready",[m.computed],Object.getOwnPropertyDescriptor(A.prototype,"ready"),A.prototype),L(A.prototype,"error",[m.computed],Object.getOwnPropertyDescriptor(A.prototype,"error"),A.prototype),A);var V=i(5832),U=i(8567),H=i(409),J=i(917),G=i(81),W=i(8207),K=i(3178),Y=i(6421),Q=i(7392),ee=i(539);const te=(0,J.iv)("p{margin-top:0;a{text-decoration:underline;color:",Z.g.colors.dominant_main,";}}.error{color:",Z.g.colors.negative,";}.inputs{margin:15px 0;display:flex;align-items:center;>*+*{",Z.g.classes.margin_near("10px"),";}}",""),ie=function(e){let{onSuccess:t}=e;const[i,n]=(0,g.useState)(""),[r,s]=(0,g.useState)(""),[o,a]=(0,g.useState)(),l=(0,G.tm)();return(0,g.useEffect)((()=>{(0,v.SC)("users/otp_get_code",{},(e=>{let{url:t}=e;return l.current&&a(t)}))}),[]),(0,C.tZ)("div",{css:te,width:"650px",children:(0,C.BX)(W.U0,{children:[(0,C.tZ)("div",{children:o?(0,C.tZ)(K.s,{value:o,size:260}):(0,C.tZ)(ee.$,{})}),(0,C.BX)("div",{children:[(0,C.tZ)("p",{dangerouslySetInnerHTML:{__html:lng('first, download %s or any other "Google Authenticator" compatible application.','<a target="blank" href="https://authy.com/download/">Authy</a>').caps()}}),(0,C.tZ)("p",{children:lng("next, scan the QR Code on the side with the application.").caps()}),(0,C.BX)("p",{children:[lng("then, enter your 6 digit code here and press confirm").caps(),":"]}),(0,C.tZ)("form",{onSubmit:function(e){e.preventDefault();const n=(0,_.Lv)((0,_.en)(o).search.substr(1)).secret;(0,v.SC)("users/otp_set_code",{method:"POST",data:{secret:n,code:i}},(e=>{let{msg:i,error:n}=e;if(l.current){if(n)return s(n);(0,f.qV)(i),Us().closeDialog(),null==t||t()}}))},children:(0,C.BX)("div",{className:"inputs",children:[(0,C.tZ)(Y.I,{type:"text",wrapped:!0,label:lng("code"),value:i||void 0,onChange:n,error:r}),(0,C.tZ)("div",{children:(0,C.tZ)(Q.l,{theme:"contained",formButton:!0,disabled:!i,children:lng("confirm").caps()})})]})}),r&&(0,C.tZ)("div",{className:"error",children:r})]})]})})};var ne,re,se,oe,ae,le,ce=i(3079),de=i(441),pe=i(4210);function ue(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function me(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let ge=(ne=m.action.bound,re=m.action.bound,se=m.action.bound,oe=m.action.bound,ae=class extends pe.I{constructor(e){var t,i,n,r;super(),ue(this,"initialData",void 0),t=this,i="fetchWorkspaces",r=this,(n=le)&&Object.defineProperty(t,i,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0}),(0,m.makeObservable)(this),this.user=e.userStore.basicDetails,this.params=e,this.title=lng("add %s to workspaces|full name",(0,_.v2)(this.user)),this.fetchWorkspaces()}buildFields(e){this.initialData=e,this._fields=[{type:"multiple_items",name:"member_of_workspaces",label:lng("select workspaces"),theme:"bright",searchData:(e,t)=>{(0,v.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",is_owner:1,term:e.term,id:e.ids,types:["Group","Qualification"]}},t)}}],this._prepFields(e),this.ready=!0}save(e){const t=e.member_of_workspaces.filter((e=>!this.initialData.member_of_workspaces.includes(e))),i=this.initialData.member_of_workspaces.filter((t=>!e.member_of_workspaces.includes(t)));this.saveToUrl("users/toggle_user_groups",{user:this.user.user_id,add:t,remove:i})}SaveSuccess(){this.params.userStore.fetch(),(0,f.qV)(lng("user added to workspaces successfully")),Us().closeDialog()}},le=me(ae.prototype,"fetchWorkspaces",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{(0,v.SC)("users/member_of_allowed_workspaces/"+this.user.user_id,{},this.buildFields)}}}),me(ae.prototype,"buildFields",[re],Object.getOwnPropertyDescriptor(ae.prototype,"buildFields"),ae.prototype),me(ae.prototype,"save",[se],Object.getOwnPropertyDescriptor(ae.prototype,"save"),ae.prototype),me(ae.prototype,"SaveSuccess",[oe],Object.getOwnPropertyDescriptor(ae.prototype,"SaveSuccess"),ae.prototype),ae);var he,be,ve,_e,fe,ye,we=i(7659),xe=i(8918),ke=i(919);function Ze(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Ce(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Se(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Oe=(he=class{constructor(e){let{sk_id:t,user_id:i}=e;Ze(this,"ready",be,this),Ce(this,"edit_level",null),Ze(this,"skill",ve,this),Ce(this,"leaderboard",[]),Ze(this,"skillLog",_e,this),Ze(this,"skillSuggestions",fe,this),Ze(this,"showLeaderboard",ye,this),Ce(this,"type",void 0),(0,m.makeObservable)(this),this.type=localStorage.getItem(`current_skill_type_${t}`),(0,v.SC)("skills/skill_page",{data:{sk_id:t,user_id:i,type:this.type}},(e=>{var t,n,r;this.user_id=i,this.edit_level=e.edit_level,this.skill=e.skill,null===(t=e.leaderboard)||void 0===t||t.forEach(((e,t)=>{e.rank=t+1,this.leaderboard.push(e)})),this.skillLog=null===(n=e.log)||void 0===n?void 0:n.map((e=>e.assignment_id?new we.m(e):e.group_id?new xe.N(e):void 0)),this.skillSuggestions=null===(r=e.suggestions)||void 0===r?void 0:r.map((e=>"OnlineContent"===e.group_type?new ke.O(e):e.assignment_id?new we.m(e):e.group_id?new xe.N(e):void 0)),this.ready=!0}))}setSkillLevel(e){let{user_id:t,sk_id:i,val:n}=e;const r=Blsm.user,s={sk_id:i,user_id:t};(r.isPowerManager||r.isManager)&&(s.manager_level=n),r.id==t&&(s.skill_level=n),(0,v.SC)("skills/set_level",{method:"POST",data:s},(()=>{(r.isPowerManager||r.isManager)&&(this.skill.manager_level=n),r.id==t&&(this.skill.skill_level=n)}))}},be=Se(he.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ve=Se(he.prototype,"skill",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),_e=Se(he.prototype,"skillLog",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fe=Se(he.prototype,"skillSuggestions",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ye=Se(he.prototype,"showLeaderboard",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),he);var Be,Te,Ne,Ie,De,je,Pe,ze,Ee,Re,Fe,Me;function Ae(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function qe(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Xe(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Le=(Be=class{constructor(e){qe(this,"user_id",null),Ae(this,"_loaded",Te,this),Ae(this,"_skills",Ne,this),Ae(this,"_occupation",Ie,this),Ae(this,"filterNsort",De,this),Ae(this,"leaderboard",je,this),Ae(this,"onBoardingShowingNeeded",Pe,this),Ae(this,"loaded",ze,this),Ae(this,"type",Ee,this),Ae(this,"sideMenu",Re,this),Ae(this,"currentContent",Fe,this),Ae(this,"_skillData",Me,this),this.userStore=e,this.user_id=this.userStore.id,(0,m.makeObservable)(this)}get ready(){return null===this._skills&&(this._skills="loading",(0,v.SC)("skills/user_skills/leaderboard=1&user_id="+this.user_id,{},(e=>{var t;this._skills=e.skills||[],e.leaderboard&&(null===(t=e.leaderboard)||void 0===t||t.forEach(((e,t)=>e.rank=t+1))),this.leaderboard=e.leaderboard,this.onBoardingShowingNeeded=0===this._skills.length&&(0,_.Tz)(this.user_id),this.loaded=!0}))),(0,m.isObservableArray)(this._skills)}get userOccupation(){return null===this._occupation&&(this._occupation="loading",(0,v.SC)("skills/user_occupation/"+this.user_id,{},(e=>{this._occupation=e}))),this._occupation}get unrankedSkills(){return this.occupationSkills.filter((e=>null===e.manager_level))}get occupationSkills(){return(0,V.WB)(this._skills.filter((e=>"occupation"===e.type)),this.filterNsort.filter,this.filterNsort.sort)}get additionalSkills(){return(0,V.WB)(this._skills.filter((e=>"additional"===e.type&&e.is_personal)),this.filterNsort.filter,this.filterNsort.sort)}get gainedSkills(){return(0,V.WB)(this._skills.filter((e=>"additional"===e.type&&!e.is_personal&&e.sk_rating>0)),this.filterNsort.filter,this.filterNsort.sort)}setCurrentSkill(e){this.type=e.type,window.localStorage&&localStorage.setItem(`current_skill_type_${e.sk_id}`,e.type),this.userStore.nav(["skills",null==e?void 0:e.sk_id])}setSkillLevel(e){let{user_id:t,sk_id:i,val:n}=e;const r=Blsm.user,s={sk_id:i,user_id:t};(r.isPowerManager||r.isManager)&&this.occupationSkills.find((e=>e.sk_id===i))&&(s.manager_level=n),(0,_.Tz)(t)&&this.additionalSkills.find((e=>e.sk_id===i))&&(s.skill_level=n),(0,v.SC)("skills/set_level",{method:"POST",data:s},(0,m.action)((()=>{this._skills.forEach((e=>{e.sk_id===i&&((r.isPowerManager||r.isManager)&&(e.manager_level=n),(0,_.Tz)(t)&&(e.skill_level=n))}))})))}onRemoveSkill(e){(0,U.BB)(lng("are you sure you want to remove this skill from your list?").caps(),{title:lng("remove skill from my list"),confirmText:lng("remove"),onConfirm:()=>{(0,v.SC)("skills/remove/"+e,{},(()=>{this._skills=this._skills.map((t=>(t.sk_id===e&&t.optional>1&&(t.skill_level=null,t.is_personal=null),t)))}))}})}onAddSkill(e,t){var i;let{user_id:n,skills:r}=e;Blsm.user.isPowerManager&&(null===(i=this.occupationSkills)||void 0===i?void 0:i.length)>0&&Object.values(r).forEach((e=>{var t;(null===(t=this.occupationSkills)||void 0===t?void 0:t.find((t=>t.sk_id==e.id)))&&(e.manager_level=e.skill_level)})),(0,v.SC)("skills/save",{method:"POST",data:{user_id:n,skills:r}},(()=>{Us().notificationsStore.skillsExist=!0,Object.values(r).forEach((0,m.action)((e=>{const t=!!!!this._skills&&this._skills.find((t=>t.sk_id===e.id&&"additional"===t.type));if(t)t.skill_level=e.skill_level,t.is_personal=1;else{const t={editable:!0,following:!0,type:"additional",name:e.label,optional:"2",is_personal:1,sk_id:e.id,skill_level:e.skill_level};this._skills=this._skills.length?[...this._skills,t]:[t]}})))})),t()}setFollowing(e){let{sk_id:t,user_id:i,following:n}=e;return(0,v.SC)("skills/set_following",{data:{sk_id:t,user_id:i,unfollow:n?1:0}},(()=>!n))}get skillStore(){const e=this.userStore._p2;if(!(0,_.B5)(e))return null;if(this._skillData.has(e))return this._skillData.get(e);const t=new Oe({sk_id:e,user_id:this.user_id});return this._skillData.set(e,t),t}toggleSideMenu(e){this.currentContent=e,this.sideMenu=!this.sideMenu}},Te=Xe(Be.prototype,"_loaded",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ne=Xe(Be.prototype,"_skills",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=Xe(Be.prototype,"_occupation",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=Xe(Be.prototype,"filterNsort",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,V.Cy)()}}),je=Xe(Be.prototype,"leaderboard",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Pe=Xe(Be.prototype,"onBoardingShowingNeeded",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=Xe(Be.prototype,"loaded",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ee=Xe(Be.prototype,"type",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Xe(Be.prototype,"sideMenu",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fe=Xe(Be.prototype,"currentContent",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=Xe(Be.prototype,"_skillData",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),Xe(Be.prototype,"ready",[m.computed],Object.getOwnPropertyDescriptor(Be.prototype,"ready"),Be.prototype),Xe(Be.prototype,"userOccupation",[m.computed],Object.getOwnPropertyDescriptor(Be.prototype,"userOccupation"),Be.prototype),Xe(Be.prototype,"unrankedSkills",[m.computed],Object.getOwnPropertyDescriptor(Be.prototype,"unrankedSkills"),Be.prototype),Xe(Be.prototype,"occupationSkills",[m.computed],Object.getOwnPropertyDescriptor(Be.prototype,"occupationSkills"),Be.prototype),Xe(Be.prototype,"additionalSkills",[m.computed],Object.getOwnPropertyDescriptor(Be.prototype,"additionalSkills"),Be.prototype),Xe(Be.prototype,"gainedSkills",[m.computed],Object.getOwnPropertyDescriptor(Be.prototype,"gainedSkills"),Be.prototype),Be);var $e,Ve=i(3522);function Ue(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function He(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Je=(He(($e=class extends x.JH{constructor(e,t){super(e),Ue(this,"store",void 0),(0,m.makeObservable)(this),this.store=t}get id(){return this._attr.badge_id}get title(){return this._attr.badge_name}get color(){return this._attr.color}get icon(){return this._attr.icon}get completed(){var e;return null===(e=this.progress)||void 0===e?void 0:e.completed}get explain(){switch(this._attr.badge_type){case"score_workspace":case"score_assignment":return lng('score %s or higher in "%s"',this._attr.req_score,this._attr.condition_item_name);case"social_like":return lng("get %s likes on your content",this._attr.amount);case"social_comment":return lng("write %s comments",this._attr.amount);case"social_discussion":return lng("create %s discussions",this._attr.amount);case"social_join_challenge":return lng("join %s challenges",this._attr.amount);case"action_enroll":return lng('enroll to "%s"',this._attr.condition_item_name);case"action_view_content":return lng("view the content below")+":";case"points":return lng("get %s points",this._attr.amount)}return""}get description(){return this._attr.badge_description}get dueDate(){return this._attr.badge_due_date}get type(){return Ve.m[this._attr.badge_type]}get active(){return this._attr.active}get leaderboard(){return this._attr.leaderboard}get progress(){return this._attr.progress}get joined(){return this._attr.user_joined||"auto"===this._attr.badge_access}join(){this.store.join(this._attr.badge_id),this._attr.user_joined=!0}leave(){this.store.leave(this._attr.badge_id),this._attr.user_joined=!1}}).prototype,"joined",[m.computed],Object.getOwnPropertyDescriptor($e.prototype,"joined"),$e.prototype),He($e.prototype,"join",[m.action],Object.getOwnPropertyDescriptor($e.prototype,"join"),$e.prototype),He($e.prototype,"leave",[m.action],Object.getOwnPropertyDescriptor($e.prototype,"leave"),$e.prototype),$e);var Ge,We,Ke,Ye,Qe,et,tt,it;function nt(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function rt(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function st(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let ot=(Ge=class{constructor(e){let{nav:t,user:i}=e;nt(this,"_challenges",We,this),nt(this,"currentChallenge",Ke,this),nt(this,"challengeHistory",Ye,this),nt(this,"ready",Qe,this),nt(this,"filterNsort",et,this),nt(this,"sideMenu",tt,this),rt(this,"currentId",void 0),rt(this,"filters",void 0),rt(this,"sorts",void 0),rt(this,"challenge_types",[]),nt(this,"user",it,this),(0,m.makeObservable)(this),this.nav=t,this.user=i,this.fetch()}get getCurrentChallenge(){return this.user?this.user._p2:this.id}toggleSideMenu(e){if(e){let t="string"==typeof e?e:e.id;this.user?this.user.nav(["challenges",t]):this.nav([t],{trigger:!1}),(0,v.SC)("gamification/challenge_data",{data:{id:t}},(e=>{this.currentChallenge=new Je(e,this),this.sideMenu=!0}))}else this.id=!1,this.user&&(this.user._p2=!1),this.currentChallenge=!1,this.sideMenu=!1,this.user?this.user.nav(["challenges",""],{trigger:!1}):this.nav([""],{trigger:!1})}updateRoute(e){e&&(this.id=(0,_.B5)(e[0])?e[0]:void 0),this.ready=!1}fetch(){let e={};this.id&&(e.id=this.id),this.user&&(e.user_joined=this.user.id),e.id&&!e.user_joined&&(e={}),(0,v.SC)("gamification/challenges_page",{data:e},(e=>{const t=Array.isArray(e)?e:[e];this._challenges=(null==t?void 0:t.map((e=>new Je(e,this))))||[],this._challenges.forEach((e=>{this.challenge_types.find((t=>t.val===e.type))||this.challenge_types.push({val:e.type,label:e.type})})),this.filters=[{type:"text",name:"title",label:lng("name"),outOfMenu:!0},{type:"select_multi",name:"type",label:lng("challenge type"),options:this.challenge_types},{type:"checkbox",name:"joined",label:lng("bookmarked")},{type:"checkbox",name:"completed",label:lng("completed")}],this.sorts=[{label:lng("default"),val:""},{label:lng("name"),val:"title"},{label:lng("creation time"),val:"id"},{label:lng("joined"),val:"joined"},{label:lng("completed"),val:"completed"}],this.ready=!0}))}get challenges(){return(0,V.WB)(this._challenges,this.filterNsort.filter,this.filterNsort.sort)}join(e){(0,v.SC)("gamification/challenge_join",{method:"POST",data:{badge_id:e}})}invite(){(0,v.SC)("gamification/invite_to_challenge",{method:"POST"})}leave(e){(0,v.SC)("gamification/challenge_join",{method:"POST",data:{badge_id:e,leave:!0}})}getChallengeHistory(e){if(e!==this.currentId)return this.challengeHistory=null,(0,v.SC)("gamification/challenge_history",{data:{badge_id:e}},(e=>this.challengeHistory=e),this.currentId=e)}},We=st(Ge.prototype,"_challenges",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ke=st(Ge.prototype,"currentChallenge",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ye=st(Ge.prototype,"challengeHistory",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qe=st(Ge.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),et=st(Ge.prototype,"filterNsort",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,V.Cy)()}}),tt=st(Ge.prototype,"sideMenu",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),it=st(Ge.prototype,"user",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st(Ge.prototype,"updateRoute",[m.action],Object.getOwnPropertyDescriptor(Ge.prototype,"updateRoute"),Ge.prototype),Ge);var at,lt,ct,dt,pt,ut,mt,gt=i(4821),ht=i(8989),bt=i(5673),vt=i(7675);function _t(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ft(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function yt(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let wt=(at=m.action.bound,lt=class{constructor(e){let{nav:t,user:i}=e;_t(this,"channel",ct,this),_t(this,"filterNsort",dt,this),_t(this,"_playlists",pt,this),_t(this,"bottomMenu",ut,this),_t(this,"subscribed",mt,this),ft(this,"componentsView",void 0),ft(this,"user",void 0),ft(this,"nav",void 0),(0,m.makeObservable)(this),this.nav=t,this.user=i}updateRoute(e){this.id=(0,_.B5)(e[0])?e[0]:void 0,this.fetch()}get customFuncFilters(){return[{name:"playlist_items",func:(e,t)=>t.playlistItems.filter((t=>t.title.includes(e))).length>0},{name:"playlist_skills",func:(e,t)=>t.playlistItems.filter((t=>t.skills.filter((t=>t.label.toLowerCase().includes(e.toLowerCase()))).length>0)).length>0}]}get channelPlaylists(){var e;return(0,V.WB)(null===(e=this._playlists)||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.items)||void 0===t?void 0:t.length)>0&&(this.user.isSelf||e.status>0)})),this.filterNsort.filter,this.filterNsort.sort,{filters:this.customFuncFilters})}get channelPlaylistsEmpty(){var e;return(0,V.WB)(null===(e=this._playlists)||void 0===e?void 0:e.filter((e=>{var t;return 0===(null===(t=e.items)||void 0===t?void 0:t.length)})),this.filterNsort.filter)}toggleBottomMenu(){this.bottomMenu=!this.bottomMenu}get ready(){return null===this.channel&&this.fetch(),"loading"!==this.channel}invalidate(){this.channel=null}removePlaylist(e){this._playlists=this._playlists.filter((t=>t.id!==e))}fetch(){this.channel="loading";const e={};this.id&&(e.id=this.id),this.user&&(e.id=this.user.id),(0,v.SC)("channel/channel_page",{data:e},(0,m.action)((e=>{this.subscribed=e.subscribed,this.channel=e?new gt.$(e,this):{},this._playlists=this.channel.playlists||[],this.following=this.channel.following,this.followers=this.channel.followers,this._ready=!0})))}componentsCompactView(e){this.componentsView=e?"compact":"",ht.X.set("workspace_components_view",e?"compact":void 0)}addPlaylist(){(0,U.cS)("",{title:lng("playlist name"),confirmText:lng("add"),inputType:"text",onConfirm:e=>{const t={playlist_name:e,channel_id:parseInt(this.channel.id)||null,status:1};(0,v.SC)("channel/save_playlist",{method:"POST",data:t},(e=>{this._ready=!1,this._playlists.push(new bt.g({...t,playlist_id:e,items:[]})),(0,de.p4)({playlist:e},!0)}))}})}Recommend(){Us().openDialog("form",new vt.O({object_id:this.user.user_id,object_type:"channel",title:lng("invite to channel").caps(),onSaveSuccess:()=>Us().closeDialog(),confirmButtonLabel:lng("invite").caps()}))}},ct=yt(lt.prototype,"channel",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dt=yt(lt.prototype,"filterNsort",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,V.Cy)()}}),pt=yt(lt.prototype,"_playlists",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ut=yt(lt.prototype,"bottomMenu",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),mt=yt(lt.prototype,"subscribed",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt(lt.prototype,"updateRoute",[m.action],Object.getOwnPropertyDescriptor(lt.prototype,"updateRoute"),lt.prototype),yt(lt.prototype,"channelPlaylists",[m.computed],Object.getOwnPropertyDescriptor(lt.prototype,"channelPlaylists"),lt.prototype),yt(lt.prototype,"channelPlaylistsEmpty",[m.computed],Object.getOwnPropertyDescriptor(lt.prototype,"channelPlaylistsEmpty"),lt.prototype),yt(lt.prototype,"ready",[m.computed],Object.getOwnPropertyDescriptor(lt.prototype,"ready"),lt.prototype),yt(lt.prototype,"invalidate",[m.action],Object.getOwnPropertyDescriptor(lt.prototype,"invalidate"),lt.prototype),yt(lt.prototype,"removePlaylist",[at],Object.getOwnPropertyDescriptor(lt.prototype,"removePlaylist"),lt.prototype),lt);var xt,kt,Zt,Ct,St=i(5311),Ot=i(7166),Bt=i(6059),Tt=i(9793);function Nt(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function It(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Dt=(xt=m.action.bound,kt=m.action.bound,Zt=m.action.bound,Ct=class e extends pe.I{constructor(e){super(),Nt(this,"initialData",void 0),Nt(this,"createAnother",!1),Nt(this,"countFieldsSections",0),Nt(this,"resetChkboxes",(()=>{this.values.set("start_sequence",""),this.values.set("add_to_sub_qualifications",""),this.values.set("ignore_workspace_restrictions","")})),this.user=e.userStore.basicDetails,this.params=e,this.title=lng("add to workspace and publish grade"),this.headExtra=(0,C.tZ)(Tt.b,{children:(0,C.tZ)(Q.l,{variant:"outlined",onClick:()=>(this.createAnother=!0,this.callSave()),children:lng("save & create another")})}),this.buildFields()}buildFields(){const e=Blsm.user.isPowerManager?{show_all:1}:{members_director:1,is_owner:1,perm:Bt.P.ManagerPermissions.MEMBERS_DIRECTOR,managed_perm:Bt.P.ManagerPermissions.GRADES_MANAGEMENT};this._fields.push({type:"hidden",name:"users",value:this.user.user_id},{type:"multiple_items",name:"groups",label:lng("select workspace"),required:!0,valueIsMap:!0,maxItems:1,objectKeys:["id","group_type"],searchData:(t,i)=>{(0,v.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",term:t.term,id:t.ids,...e}},i)},onValueChange:()=>this.resetChkboxes()},{type:"row_set",fields:[{type:"date",name:"publish_date",label:lng("select date"),required:!0},{type:"number",name:"custom_score",label:lng("grade"),min:0,max:100,required:!0,integer:!0}]},{type:"checkbox",name:"send_joining_notification",label:lng('send "joined workspace" notification')},{type:"checkbox",name:"start_sequence",label:lng("start approval sequence"),visible:e=>{var t,i;const n=e.get("groups");return!!n&&(null===(t=Array.from(null==n?void 0:n.values()))||void 0===t||null===(i=t[0])||void 0===i?void 0:i.sequence_id)>0}},{type:"checkbox",name:"add_to_sub_qualifications",label:lng("add user to the required qualifications"),visible:e=>{var t,i;const n=e.get("groups");return!!n&&"Qualification"===(null===(t=Array.from(null==n?void 0:n.values()))||void 0===t||null===(i=t[0])||void 0===i?void 0:i.group_type)}},{type:"checkbox",name:"ignore_workspace_restrictions",label:lng("ignore workspace restrictions"),visible:e=>{var t,i;const n=e.get("groups");return!!n&&(Blsm.user.isPowerManager||!0===(null===(t=Array.from(null==n?void 0:n.values()))||void 0===t||null===(i=t[0])||void 0===i?void 0:i.owner))}}),this._prepFields(),this.ready=!0}save(e){e.groups=[Object.keys(e.groups)[0]],this.saveToUrl("users/add_users_to_groups",e)}SaveSuccess(t){t.warning&&(0,f.nb)(t.warning),1!=t.success&&1!=t.request||(0,f.qV)(lng("user added to workspaces successfully")),Us().closeDialog(),this.createAnother&&(this.createAnother=!1,Us().openDialog("form",new e({userStore:this.params.userStore})))}},It(Ct.prototype,"buildFields",[xt],Object.getOwnPropertyDescriptor(Ct.prototype,"buildFields"),Ct.prototype),It(Ct.prototype,"save",[kt],Object.getOwnPropertyDescriptor(Ct.prototype,"save"),Ct.prototype),It(Ct.prototype,"SaveSuccess",[Zt],Object.getOwnPropertyDescriptor(Ct.prototype,"SaveSuccess"),Ct.prototype),Ct);var jt,Pt,zt,Et,Rt,Ft,Mt,At,qt,Xt,Lt,$t,Vt,Ut,Ht,Jt,Gt,Wt,Kt,Yt,Qt,ei,ti,ii,ni,ri,si,oi,ai,li,ci,di,pi,ui;function mi(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function gi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function hi(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let bi=(jt=m.action.bound,Pt=m.action.bound,zt=m.action.bound,Et=m.action.bound,Rt=m.action.bound,Ft=m.action.bound,Mt=m.action.bound,At=class{constructor(e){let{id:t,nav:i}=e;gi(this,"isEnterprise",Blsm.checkMod(["","ENT"])),mi(this,"ready",qt,this),mi(this,"basicDetailsWidgetSpread",Xt,this),mi(this,"wsShowComponents",Lt,this),mi(this,"showDependenciesOf",$t,this),mi(this,"wsFilterNsort",Vt,this),mi(this,"tasks_filterNsort",Ut,this),gi(this,"isSelf",!1),gi(this,"user_id",""),gi(this,"manageGroups",!1),gi(this,"basicDetails",{}),gi(this,"custom_fields_data",[]),gi(this,"direct_manager",{}),mi(this,"_tab",Ht,this),mi(this,"_p2",Jt,this),gi(this,"_profileTabs",[]),gi(this,"_topTabs",void 0),gi(this,"managed_groups",[]),gi(this,"managed_ous",[]),gi(this,"roles",[]),mi(this,"_courses",Gt,this),mi(this,"groups",Wt,this),mi(this,"blog",Kt,this),gi(this,"qualifications_roles",[]),gi(this,"authorization_qualification",[]),gi(this,"qualifications",[]),gi(this,"professions",[]),gi(this,"all_sub_professions",[]),gi(this,"compliance_qualifications",[]),gi(this,"compliance_courses",[]),gi(this,"compliance_assignments",[]),gi(this,"compliance_assignments_docs",[]),mi(this,"external",Yt,this),gi(this,"requests",[]),gi(this,"participationPlanningEnabled",Blsm.isFeatureEnabled("participation_planning")),gi(this,"participation",[]),gi(this,"evaluation",[]),gi(this,"self_evaluation",[]),gi(this,"assignments_stats",{}),gi(this,"tasks",[]),gi(this,"badges",[]),gi(this,"forms",[]),mi(this,"userFiles",Qt,this),mi(this,"login_sessions",ei,this),mi(this,"slaves",ti,this),mi(this,"otp",ii,this),mi(this,"google_id",ni,this),gi(this,"skillsStore",null),gi(this,"challengesStore",null),gi(this,"channelStore",null),mi(this,"OUHistory",ri,this),mi(this,"support_auth_on",si,this),mi(this,"platform_auth_on",oi,this),gi(this,"_internalNav",!1),(0,m.makeObservable)(this),this.id=t,this.nav=i,this.skillsStore=new Le(this),this.challengesStore=new ot({user:this}),this.channelStore=new wt({user:this}),this.manageGroups=Blsm.user.isPowerManager||Blsm.hasPermission("group_admin")||Blsm.hasPermission("users_admin"),Gs.on("commentsUpdateCount",(e=>{if("content"===e.connectTo.type){let t=this.blog.find((t=>t.lesson_id==e.connectTo.object_id));if(t){const i=e.action;"add"==i&&(t.comment_count=parseInt(t.comment_count)+1),"subtract"===i&&(t.comment_count=parseInt(t.comment_count)-1)}}})),(0,m.observe)(this.tasks_filterNsort,(()=>this.taskFilterNav())),this.fetch()}get courses(){return this._courses}get tab(){var e,t;return null!==(e=this._topTabs)&&void 0!==e&&e.some((e=>e.val===this._tab))||this._profileTabs.some((e=>e.val===this._tab))?this._tab:null===(t=this._profileTabs[0])||void 0===t?void 0:t.val}set tab(e){this.nav(e?[e]:[])}get topTabs(){return this._topTabs||this._profileTabs}get subTabs(){return this._topTabs&&!this._topTabs.some((e=>e.val===this._tab))&&this._profileTabs}taskFilterNav(){var e,t;if(this._internalNav)return;const i={filters:(0,m.toJS)(this.tasks_filterNsort.filter),sort:null===(e=this.tasks_filterNsort.sort)||void 0===e?void 0:e.by,reverse:null!==(t=this.tasks_filterNsort.sort)&&void 0!==t&&t.desc?1:void 0};this.nav(["tasks",i],{trigger:!1})}get rolesBadges(){return this.qualifications_roles.filter((e=>e.special_qualification))}get filteredTasks(){return(0,V.WB)(this.tasks,this.tasks_filterNsort.filter,this.tasks_filterNsort.sort)}get loginWithLocationData(){return this.login_sessions.forEach((e=>{null===e.geoData&&(e.geoData=!1,fetch(`https://ipapi.co/${e.ip}/json`).then((e=>e.json())).then((t=>t.city&&(0,m.set)(e,"geoData",t))).catch((e=>console.error("ipapi Error:",e))))})),this.login_sessions}get userDetails(){return[{label:lng("base"),fields:[{field:"user_birthdate",type:"date"},"user_email"]},{label:lng("personal"),fields:["user_gender","user_identity_num","user_address","user_city","user_state","user_postal_code","user_country"]},{label:lng("work"),fields:["user_company","user_department","user_job_title",{field:"employee_id",type:"text"},{field:"employment_date",type:"date"}]},{label:lng("contact"),fields:["user_business_phone","user_home_phone","user_mobile_phone","user_fax_number"]},{label:lng("more"),fields:["status_name","classification_id",{field:"user_extra_time",type:"checkbox",hideEmpty:!0},...this.custom_fields_data.map((e=>({field:e.field_column,name:e.field_name,type:e.field_type.toLowerCase()})))]},{id:"monitor",label:lng("monitor"),fields:["user_name","domain_name","external_id","user_nt","user_type",Blsm.hasPermission("users_admin")&&(this.basicDetails.user_enabled?{field:"user_enabled",type:"checkbox"}:{field:"user_locked",type:"checkbox",attr:{"data-field":"user_locked"}}),{field:"user_joined",type:"date"},{field:"user_lastvisit",type:"date"},{field:"user_expiration",type:"datetime"},"user_pretend","user_ip"]}].map((e=>{const t=e.fields.map((e=>{const{field:t,type:i,hideEmpty:n,name:r}=(0,_.Kn)(e)?e:{field:e};let s=this.basicDetails[t];if("user_gender"===t)s="Male"===s?lng("male"):"Female"===s?lng("female"):"Other"===s?lng("other",{phrase:!0}):void 0;else if("user_locked"===t)s={icon:s?"lock":"lock_open"};else if("date"===i||"datetime"===i){if(!/^\d+-\d+-\d+/.test(s))return;s=(0,w.GG)(s,{time:/time/.test(i)})}else"checkbox"===i&&(s=(0,_.P$)(s)?{icon:"mark_v"}:n?void 0:{icon:"mark_x"});if(s)return[r||(0,H.X)(t),s,i]})).filter((e=>!!e));return!!t.length&&Object.assign({},e,{fields:t})})).filter((e=>!!e))}updateRoute(e){let[t,i]=e;if(this._tab=t,this._p2=i,"tasks"===t){const e={filter:(null==i?void 0:i.filters)||{},sort:{by:(null==i?void 0:i.sort)||"",desc:"1"===(null==i?void 0:i.reverse)}};this._internalNav=!0,(0,m.set)(this.tasks_filterNsort,e),this._internalNav=!1}}fetch(){this.ready=!1,(0,v.SC)("users/"+this.id+"/all",{},(0,m.action)((e=>{var t;const i=this;i.user_id=e.user_id,i.isSelf=(0,_.Tz)(i.user_id),i.basicDetails=(0,_.v7)(e,(e=>!Array.isArray(e)&&!(0,_.Kn)(e))),["managed_groups","managed_ous","roles","courses","groups","professions","qualifications_roles","authorization_qualification","qualifications","compliance_qualifications","compliance_courses","compliance_assignments","compliance_assignments_docs","evaluation","self_evaluation","tasks","login_sessions","external","requests","participation","forms","direct_manager","assignments_stats","badges","slaves","custom_fields_data","blog","google_id","auth_google","support_auth_on","google_id","auth_google","user_type","support_system","platform_auth_on"].forEach((t=>e[t]&&((0,m.isObservableArray)(i[t])?i[t].replace(e[t]):i[t]=e[t]))),this.userFiles=new vi(e.files||[],e.has_file_drawer,e.can_upload_user_files);for(let e of i.professions)for(let t of e.sub)if(i.all_sub_professions.push(Object.assign({},t,{group_type:"SubProfession"})),t.dependencies)for(let e of t.dependencies)e.hidden_row=!0,i.all_sub_professions.push(e);[i.qualifications_roles,i.authorization_qualification,i.qualifications,i.all_sub_professions].forEach(_.f_),i.login_sessions.forEach(((e,t)=>(0,m.set)(e,{_key:t+"_"+Math.random(),geoData:null}))),i.external.forEach((e=>{e.registration_extra_info=e.registration_extra_info||{},e.target_data=e.target_data||{}}));const n=i.all_sub_professions.length||i.qualifications_roles.length||i.qualifications.length||i._courses.length||i.groups.length,r=i.authorization_qualification.length;i._profileTabs=[{val:"general",label:lng("general")},n&&{val:"workspaces",label:lng("workspaces")},r&&{val:"job_authorizations",label:lng("job authorizations")},(i.managed_ous.length||i.managed_groups.length||i.roles.length)&&{val:"management",label:lng("management")},(i.evaluation.length||i.self_evaluation.length)&&{val:"evaluation",label:lng("evaluation")},(i.compliance_qualifications.length||i.compliance_courses.length||i.compliance_assignments.length||i.compliance_assignments_docs.length)&&{val:"compliance",label:lng("compliance")},(i.external.length||i.requests.length)&&{val:"requests",label:lng("requests status")},i.tasks.length&&{val:"tasks",label:lng("tasks",{phrase:!0})},i.login_sessions.length&&{val:"logins",label:lng("login sessions")},Blsm.user.isAdmin&&{val:"multiuser",label:lng("multiuser")},e.blog&&(i.blog.length||this.isSelf)&&{val:"blog",label:lng("blog",{phrase:!0})},i.forms.length&&{val:"forms",label:lng("forms")},i.participationPlanningEnabled&&{val:"participation",label:lng("participation planning")}].filter((e=>!!e)),Blsm.isFeatureEnabled("skills_occupations")&&i.addTopTab({val:"skills",label:lng("skills"),icon:"skill"}),Blsm.isFeatureEnabled("gamification")&&(n||null!==(t=i.challengesStore)&&void 0!==t&&t.challenges.length)&&Blsm.checkMod(["gamification","ENT"])&&i.addTopTab({val:"challenges",label:lng("challenges"),icon:"challenge"}),Blsm.isFeatureEnabled("channels")&&(this.basicDetails.channel_exists||(0,_.Tz)(this.user_id))&&i.addTopTab({val:"channel",label:lng("channel"),icon:"channel"}),"otp"in e&&(this.otp=!!e.otp),i.ready=!0})))}addTopTab(e){this._topTabs||(this._topTabs=[{val:"",label:lng("profile"),icon:"user"}]),this._topTabs.push(e)}loadOUHistory(){(0,v.SC)("users/ou_history/"+this.id,{},(e=>this.OUHistory=e))}updateShowDependenciesOf(e){this.showDependenciesOf=e.group_id===this.showDependenciesOf.group_id?{}:e}removeUserExternalCourse(e){(0,U.BB)(lng("are you sure you want to delete this external event?").caps(),{onConfirm:()=>{this.external.remove(e),(0,v.SC)("groups/removeUserExternalCourse",{data:{group_id:e.group_id,user_id:this.user_id},method:"POST"})}})}removeUserWorkspace(e){(0,U.BB)(lng("are you sure you want to remove user from %s?",e.group_name),{onConfirm:()=>{e.is_course?this._courses.remove(e):this.groups.remove(e),(0,v.SC)("ajax/GroupsAjax.class.php",{method:"POST",data:{req:"remove_user_from_group",group_id:e.group_id,user_id:this.user_id}},(t=>1!=t&&((0,f.nb)(lng("an error has occurred")),e.is_course?this._courses.push(e):this.groups.push(e))))}})}removeBlog(e){(0,U.BB)(lng("are you sure you want to delete this post?"),{onConfirm:()=>{this.blog.remove(e),(0,v.SC)("content/"+e.lesson_id,{method:"DELETE"},(t=>{"error"===t.res&&this.blog.push(e)}))}})}toggleLockPostComments(e){var t;const i=null===(t=e.lesson_options)||void 0===t||!t.lock_comments;e.lesson_options={lock_comments:i},(0,v.SC)("content/lock_comments",{method:"POST",data:{lesson_id:e.lesson_id}})}toggleUserVotePost(e){var t,i,n;e.likes={likes:null!=e&&null!==(t=e.likes)&&void 0!==t&&t.user_vote?parseInt(e.likes.likes)-1:parseInt(null==e||null===(i=e.likes)||void 0===i?void 0:i.likes)+1,user_vote:null==e||null===(n=e.likes)||void 0===n||!n.user_vote};const r={req:"vote",type:"content",object_id:e.lesson_id,user_action:"like"};(0,v.SC)("likes",{data:r,method:"POST"})}disconnectSession(e){this.login_sessions.remove(e),(0,v.SC)("users/session_disconnect",{method:"POST",data:{user_id:this.user_id,ip:e.ip,expiry:e.expiry}})}disconnectMultiUser(e){this.slaves.remove(e),(0,v.SC)("users/disconnect_multi_user",{method:"POST",data:{user_id:this.user_id,connect_id:e.user_id}})}get deleted(){return"1"===this.basicDetails.deleted}toggleOtp(){this.otp?(0,U.BB)(lng("are you sure you want to turn off 2-step verification?").caps(),{onConfirm:()=>{this.otp=0,(0,v.SC)("users/otp_remove_code/"+this.id,{method:"DELETE"})}}):Us().openDialog("Component",{child:(0,C.tZ)(ie,{onSuccess:()=>this.otp=1}),title:lng("setup 2 step authentication")})}get actionIcons(){const{user_id:e,isSelf:t,deleted:i,otp:n,basicDetails:r,google_id:s,auth_google:o,support_system:a}=this,{pretend:l,manager:c,can_edit:d,auth_permission:p,ou_auth_permission:u,user_type:m}=r,g=(0,ce.N)({user_id:e,is_manager:c,auth_permission:p,ou_auth_permission:u}),h=!Blsm.InitialData.parameters.disable_user_totp&&null!==n&&((0,_.Tz)(e)||n),b=!t&&(Blsm.user.isManager&&Blsm.user.perm.grades_management||Blsm.user.perm.isGroupOwner||Blsm.user.isPowerManager);return[d&&!i&&{icon:"edit",href:{edit:"user",id:e},toolTip:lng("edit user")},o&&(0,_.Tz)(e)&&{icon:"google",toolTip:(s?lng("detach account",!0):lng("connect account",!0)).caps(),onClick:()=>s?(0,U.BB)(lng("are you sure you want to disconnect this account?").caps(),{onConfirm:()=>(0,v.SC)("ajax/requests.php",{method:"POST",data:{req:"RemoveOauth",provider:"google"}},(()=>{this.google_id=null,this.fetch()}))}):(0,de.p4)("oauth?s=google",!0),bgColor:s?Z.g.colors.negative:Z.g.colors.dominant_main},h&&{icon:n?"mfa_on":"mfa",toolTip:n?lng("turn off 2-step verification"):lng("protect your account with 2 step verification"),onClick:()=>this.toggleOtp()},(Blsm.hasPermission("group_admin")||Blsm.hasPermission("qualifications"))&&!i&&this.isEnterprise&&{icon:"user_plus",toolTip:lng("add user to workspaces"),onClick:()=>Us().openDialog("form",new ge({userStore:this}))},b&&{icon:"publish_grade",toolTip:"add to workspace and publish grade",onClick:()=>Us().openDialog("form",new Dt({userStore:this}))},c&&!t&&!i&&this.isEnterprise&&{icon:"lock_open",toolTip:lng("send the user a reset password link via email"),onClick:()=>{(0,U.cS)((0,_.rj)(lng("are you sure you want to send the user a reset password link?").caps()+"\n\n"+lng("add extra details for the user (optional)").caps()),{title:lng("reset password"),confirmText:lng("send"),textArea:!0,onConfirm:t=>(0,v.SC)("users/send_reset_password_link",{method:"POST",data:{user_id:e,message:t}},(()=>(0,f.qV)(lng("reset password link was sent successfully."))))})}},Blsm.isFeatureEnabled("users_files")&&this.userFiles.canSeeFiles&&(t||c)&&{icon:"vendor_file",toolTip:lng("files"),onClick:()=>this.userFiles.showFiles=!0},l&&!i&&{icon:"pretend",onClick:()=>Us().pretend(e),toolTip:lng("pretend to be this user")},g.length>0&&{icon:"report",menu:g,className:"mobile_off"},!a&&Blsm.user.isAdmin&&{icon:"support",toolTip:"support quick access",bgColor:this.support_auth_on?Z.g.colors.negative:Z.g.colors.dominant_main,className:"mobile_off",onClick:()=>this.support_auth_on?(0,U.BB)("would you like to remove support quick access for this user?".caps(),{onConfirm:()=>(0,v.SC)("users/set_support_token",{method:"POST",data:{user_id:e}},(()=>this.support_auth_on=null))}):(0,U.cS)("paste the token from the support system here:",{title:"support quick access",inputRequired:!0,onConfirm:t=>(0,v.SC)("users/set_support_token",{method:"POST",data:{user_id:e,token:t}},(()=>this.support_auth_on=!0))})},a&&"User"===m&&{icon:"support",toolTip:"support quick access",bgColor:this.platform_auth_on?Z.g.colors.negative:Z.g.colors.dominant_main,className:"mobile_off",onClick:()=>this.platform_auth_on?(0,U.BB)("would you like to remove support quick access for this user?".caps(),{onConfirm:()=>(0,v.SC)("users/platform_auth_token_remove",{method:"POST",data:{user_id:e}},(()=>this.platform_auth_on=null))}):(0,v.SC)("users/platform_auth_token_generate",{method:"POST",data:{user_id:e}},(e=>{(0,U.qR)((0,C.BX)("div",{children:["Paste the following token in the client's user profile:",(0,C.BX)(St.c_,{children:[(0,C.tZ)(St.jM,{text:e,grow:!0}),(0,C.tZ)(Ot.g,{copy:e,success:lng("token copied to clipboard"),buttonLike:!0})]}),"This is the only time you will see this token, so make sure to copy it before closing the dialog."]}),{width:"500px"}),this.platform_auth_on=!0}))}]}},qt=hi(At.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xt=hi(At.prototype,"basicDetailsWidgetSpread",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Lt=hi(At.prototype,"wsShowComponents",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),$t=hi(At.prototype,"showDependenciesOf",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Vt=hi(At.prototype,"wsFilterNsort",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,V.Cy)()}}),Ut=hi(At.prototype,"tasks_filterNsort",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{filter:{task_resolution:[]},sort:{by:"priority",desc:!0}}}}),Ht=hi(At.prototype,"_tab",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Jt=hi(At.prototype,"_p2",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Gt=hi(At.prototype,"_courses",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Wt=hi(At.prototype,"groups",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Kt=hi(At.prototype,"blog",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Yt=hi(At.prototype,"external",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qt=hi(At.prototype,"userFiles",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ei=hi(At.prototype,"login_sessions",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ti=hi(At.prototype,"slaves",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ii=hi(At.prototype,"otp",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ni=hi(At.prototype,"google_id",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ri=hi(At.prototype,"OUHistory",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),si=hi(At.prototype,"support_auth_on",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),oi=hi(At.prototype,"platform_auth_on",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hi(At.prototype,"courses",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"courses"),At.prototype),hi(At.prototype,"tab",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"tab"),At.prototype),hi(At.prototype,"topTabs",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"topTabs"),At.prototype),hi(At.prototype,"subTabs",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"subTabs"),At.prototype),hi(At.prototype,"rolesBadges",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"rolesBadges"),At.prototype),hi(At.prototype,"filteredTasks",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"filteredTasks"),At.prototype),hi(At.prototype,"loginWithLocationData",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"loginWithLocationData"),At.prototype),hi(At.prototype,"userDetails",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"userDetails"),At.prototype),hi(At.prototype,"updateRoute",[m.action],Object.getOwnPropertyDescriptor(At.prototype,"updateRoute"),At.prototype),hi(At.prototype,"fetch",[m.action],Object.getOwnPropertyDescriptor(At.prototype,"fetch"),At.prototype),hi(At.prototype,"loadOUHistory",[jt],Object.getOwnPropertyDescriptor(At.prototype,"loadOUHistory"),At.prototype),hi(At.prototype,"updateShowDependenciesOf",[Pt],Object.getOwnPropertyDescriptor(At.prototype,"updateShowDependenciesOf"),At.prototype),hi(At.prototype,"removeUserExternalCourse",[zt],Object.getOwnPropertyDescriptor(At.prototype,"removeUserExternalCourse"),At.prototype),hi(At.prototype,"removeUserWorkspace",[Et],Object.getOwnPropertyDescriptor(At.prototype,"removeUserWorkspace"),At.prototype),hi(At.prototype,"removeBlog",[Rt],Object.getOwnPropertyDescriptor(At.prototype,"removeBlog"),At.prototype),hi(At.prototype,"disconnectSession",[Ft],Object.getOwnPropertyDescriptor(At.prototype,"disconnectSession"),At.prototype),hi(At.prototype,"disconnectMultiUser",[Mt],Object.getOwnPropertyDescriptor(At.prototype,"disconnectMultiUser"),At.prototype),hi(At.prototype,"actionIcons",[m.computed],Object.getOwnPropertyDescriptor(At.prototype,"actionIcons"),At.prototype),At),vi=(ai=m.action.bound,li=m.action.bound,di=hi((ci=class{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];gi(this,"canSeeFiles",void 0),gi(this,"canUploadFiles",void 0),mi(this,"showFiles",di,this),mi(this,"files",pi,this),mi(this,"selectedTags",ui,this),(0,m.makeObservable)(this),this.files=e,this.canSeeFiles=t,this.canUploadFiles=i}get tags(){const e=[];return this.files.forEach((t=>e.push(...t.tags))),[...new Set(e)]}toggleTagSelection(e){this.selectedTags[this.selectedTags.has(e)?"delete":"add"](e)}clearTagSelection(){this.selectedTags.clear()}get list(){return 0===this.selectedTags.size?this.files:this.files.filter((e=>e.tags.some((e=>this.selectedTags.has(e)))))}deleteFile(e){this.files=this.files.filter((t=>t.file_id!==e)),(0,v.SC)(`file/user_files=${e}`,{method:"DELETE"})}updateFileData(e,t){e.file_name=t.file_name,e.file_availability=t.file_availability,e.tags=t.tags}}).prototype,"showFiles",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pi=hi(ci.prototype,"files",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ui=hi(ci.prototype,"selectedTags",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),hi(ci.prototype,"tags",[m.computed],Object.getOwnPropertyDescriptor(ci.prototype,"tags"),ci.prototype),hi(ci.prototype,"toggleTagSelection",[ai],Object.getOwnPropertyDescriptor(ci.prototype,"toggleTagSelection"),ci.prototype),hi(ci.prototype,"clearTagSelection",[li],Object.getOwnPropertyDescriptor(ci.prototype,"clearTagSelection"),ci.prototype),hi(ci.prototype,"list",[m.computed],Object.getOwnPropertyDescriptor(ci.prototype,"list"),ci.prototype),hi(ci.prototype,"deleteFile",[m.action],Object.getOwnPropertyDescriptor(ci.prototype,"deleteFile"),ci.prototype),hi(ci.prototype,"updateFileData",[m.action],Object.getOwnPropertyDescriptor(ci.prototype,"updateFileData"),ci.prototype),ci);var _i,fi,yi,wi,xi,ki,Zi,Ci,Si,Oi,Bi=i(6691),Ti=i(554);function Ni(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Ii(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Di=(_i=m.observable.shallow,fi=m.observable.shallow,yi=m.observable.shallow,wi=m.action.bound,xi=class{constructor(){Ni(this,"tables",ki,this),Ni(this,"recentQueries",Zi,this),Ni(this,"savedReports",Ci,this),Ni(this,"size",Si,this),Ni(this,"query",Oi,this),(0,m.makeObservable)(this),this.fetch()}fetch(){(0,v.SC)("SQL/initial_data",{},(0,m.action)((e=>{const{tables:t,recent_queries:i,saved_reports:n,size:r}=e;this.tables.replace(t),this.recentQueries.replace(i),this.savedReports.replace(n),this.size=r})))}selectedTableCols(e){return e?this.tables.find((t=>t.name===e)).cols:void 0}getSavedReportById(e){return this.savedReports.find((t=>t.id===e))}deletedSavedReport(e){e&&(0,U.BB)(lng("are you sure you want to delete this report?").caps(),{onConfirm:()=>{this.savedReports.remove(this.getSavedReportById(e)),(0,v.SC)("SQL/saved_reports/",{method:"DELETE",data:{id:e}})}})}saveReport(e){(0,v.SC)("SQL/save_report",{method:"POST",data:{report_name:e,QueryText:this.query}},(e=>this.savedReports.replace(e.saved_reports)))}reformatQuery(){let e=this.query;e=e.replace(/\r/g,"").replace(/\n/g," "),e=e.replace(/\b(SELECT|FROM|LEFT JOIN|JOIN|WHERE|GROUP BY|ORDER BY|LIMIT)\b/gi,((e,t)=>"\n"+t.toUpperCase())),this.query=e.trim()}selectiveDownload(){Us().openDialog("form",new zi(this.tables))}sendScehma(e){(0,U.cS)("Send to mail (optional)",{title:"dump schema"+(1===e?" - slim":e?" - "+e:""),confirmText:lng("submit"),onConfirm:t=>window.open((0,v.Q2)("SQL/dump",{slim:e,mail:t}))})}},ki=Ii(xi.prototype,"tables",[_i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Zi=Ii(xi.prototype,"recentQueries",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ci=Ii(xi.prototype,"savedReports",[yi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Si=Ii(xi.prototype,"size",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Oi=Ii(xi.prototype,"query",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ii(xi.prototype,"reformatQuery",[wi],Object.getOwnPropertyDescriptor(xi.prototype,"reformatQuery"),xi.prototype),xi);const ji=e=>e.name.startsWith("log")||e.name.includes("history")||["outgoing_mails","login_sessions","personal_notifications","processing_queue","mails_blacklist","lessons_text_search"].includes(e.name),Pi=e=>e.name.includes("performance");class zi extends pe.I{constructor(e){super(),this.title="dump schema - selective";const t=20971520;let i=0;this.skipableTables=e.filter((e=>{if(!(e=>["users","groups","assignments","users_in_groups","lessons","approval_requests","assignments_in_groups","domains","questionnaire_pages","questionnaire_questions","categories","classifications","resources","external_course_types","external_course_types_required_groups","sequences","sequences_steps","extended_fields","lessons_folders","lessons_in_folders","themes","assignments_status","comments","tasks"].includes(e.name))(e)&&(e.size>t||ji(e)&&e.size>524288))return!0;i+=e.size})).sort(((e,t)=>Pi(e)!==Pi(t)?Pi(e)?-1:1:ji(e)!==ji(t)?ji(e)?1:-1:e.name.localeCompare(t.name)));let n=!1,r=!1,s=!1;this.confirmButtonLabel=lng("submit").caps(),this._fields=[{type:"text",name:"mail",label:"send to mail (optional)"},{type:"title",label:lng("download")+":"},...this.skipableTables.map((e=>Pi(e)&&!n?(n=!0,{type:"set",titleSmall:!0,noMarginBottom:!0,title:lng("performance tables"),fields:[{type:"checkbox",name:e.name,label:`${e.name}: ${(0,_.bQ)(e.size)}, ${e.rows} rows`}]}):ji(e)&&!s?(s=!0,{type:"set",titleSmall:!0,noMarginBottom:!0,title:lng("log tables"),fields:[{type:"checkbox",name:e.name,label:`${e.name}: ${(0,_.bQ)(e.size)}, ${e.rows} rows`}]}):ji(e)||Pi(e)||r?{type:"checkbox",name:e.name,label:`${e.name}: ${(0,_.bQ)(e.size)}, ${e.rows} rows`}:(r=!0,{type:"set",titleSmall:!0,noMarginBottom:!0,title:lng("other tables"),fields:[{type:"checkbox",name:e.name,label:`${e.name}: ${(0,_.bQ)(e.size)}, ${e.rows} rows`}]}))),{type:"checkbox",disabled:!0,name:"__rest__",value:1,label:`all other tables (mandatory and smaller than ${(0,_.bQ)(t)}): ${(0,_.bQ)(i)}`}],this._prepFields(),this.ready=!0}save(){const e=this.skipableTables.map((e=>e.name)).filter((e=>!this.values.get(e)));(0,v.hn)((0,v.Q2)("SQL/dump",{slim:"skip",mail:this.values.get("mail")}),{skip:e.join()},!0),Us().closeDialog()}}var Ei=i(7861),Ri=i(6975),Fi=i(5738);class Mi extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("users"===n)return new Mi({route:r,nav:i})}constructor(e){super(e),this.title=lng("import users").caps(),this.objType="users",this.fetch()}settingsFields(){return[{type:"checkbox",name:"keep_old_values",label:lng("empty cells in the import file won't erase the current profile field values")},{type:"checkbox",name:"temp_password",label:lng("set temporary password for new users")},{type:"checkbox",name:"password_not_required",label:lng("do not require password for new users (SSO only)")},{type:"checkbox",name:"update_password",label:lng("update password for existing users"),className:"danger_text",onValueChange:e=>e&&(0,U.BB)((0,C.BX)(C.HY,{children:[(0,C.tZ)("span",{className:"danger_text",children:lng("this may prevent the users from accessing the system!").caps()}),(0,C.tZ)("br",{}),(0,C.tZ)("br",{}),lng("are you sure you want to continue?").caps()]}),{onCancel:()=>this.values.set("update_password",void 0)})},{type:"checkbox",name:"new_user_notification",label:lng("send users details by mail (requires valid email)")},{type:"checkbox",name:"manager_ou",label:lng("create org' units using manager field"),helpKey:"@import/manager_ou"},{type:"hidden",name:"is_import_page",value:1},...super.settingsFields()]}moreInfoFields(){return[(0,Fi.bw)(`Excel: ${lng("date cells must be in Excel proper date format.").caps()} ${lng("if uncertain, use long date format").caps()}:`,["March 14, 2012"]),(0,Fi.bw)(`CSV: ${lng("date cells must be in the following date format:").caps()}`,[Blsm.prm.date_moment_format]),(0,Fi.bw)(lng("the following fields are of type %s",lng("date").caps()).caps()+":",["employment_date","birthday"]),(0,Fi.bw)(lng("available values for %s","gender").caps()+":",["male","female"]),(0,Fi.bw)(lng("available values for %s","language").caps(),(0,C.tZ)(de.A,{href:(0,Fi.lA)(Object.keys(this.data.languages)),target:"_blank",children:(0,C.tZ)(Ri.JO,{icon:"download"})})),(0,Fi.bw)(lng("available values for %s","date_format").caps()+":",["dd/mm/yy","mm/dd/yy"]),(0,Fi.bw)(lng("available values for %s","disabled, extra_time"+(Blsm.isFeatureEnabled("eula")?", consent_eula":"")).caps()+":",[1,0]),(0,Fi.bw)(lng("available values for %s","timezone").caps(),(0,C.tZ)(de.A,{href:(0,Fi.lA)(this.data.timezones),target:"_blank",children:(0,C.tZ)(Ri.JO,{icon:"download"})})),(0,Fi.bw)(lng("the following fields are of type %s",lng("external id")).caps()+":",["group","human_resources_coordinator","professional_manager","personal_coach"]),(0,Fi.bw)(lng("available values for %s","ou").caps()+":",(0,C.BX)("div",{children:[lng("the name of an existing org' unit").caps(),"."]})),...super.moreInfoFields()]}templateLink(e){return super.templateLink(e)+(e.get("manager_ou")?"manager_ou=1":"")}}var Ai=i(7191);class qi extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("groups"===n)return new qi({route:r,nav:i})}constructor(e){super(e),this.title=lng("import workspaces").caps(),this.objType="groups",this.tutorial="workspace:excel_import",this.fetch()}settingsFields(){var e;return[{type:"checkbox",name:"keep_old_values",label:lng("keep empty values untouched for updates")},{type:"select",name:"managers_permission",label:lng("managers permission"),options:(0,_.wd)(null===(e=this.data)||void 0===e?void 0:e.permissions_types)},{type:"checkbox",name:"override_existing_permissions",label:lng("override existing managers permissions")},{type:"checkbox",name:"remove_existing_managers",label:lng("remove existing managers")},{type:"checkbox",name:"set_primary_manager",label:lng("set as primary manager")},...super.settingsFields()]}_buildFields(){super._buildFields(),this._fields.push({type:"indent_set",toggleTitle:lng("copy from course template").caps(),toggle:!0,fields:(0,Ai.v)(this,{prefix:"import_data[",suffix:"]"})})}templateFields(){return[{type:"select",name:"template_type",label:lng("type").caps(),options:[{val:"",label:lng("all")},{val:"ou",label:lng("org' units")},{val:"group",label:[lng("groups"),lng("courses"),lng("course templates")].join(", ")},{val:"qualification",label:lng("qualifications")},{val:"role",label:lng("roles")},{val:"workplan",label:lng("workplans")}]},...super.templateFields()]}templateLink(e){return super.templateLink(e)+(e.get("template_type")?"type="+e.get("template_type"):"")}}class Xi extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("users_deletion"===n)return new Xi({route:r,nav:i})}constructor(e){super(e),this.title=lng("delete users").caps(),this.objType="users_deletion",this.fetch()}templateFields(){return[Fi.Qy,...super.templateFields()]}templateLink(e){return super.templateLink(e)+e.get("userCol")}}function Li(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class $i extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("members"===n)return new $i({route:r,nav:i})}constructor(e){var t;super(e),Li(this,"workspaceId",null);const{route:i}=e;this.workspace_id=(null===(t=i[0])||void 0===t?void 0:t.workspace_id)||this.workspace,this.title=lng("import members").caps(),this.objType="members",this.tutorial="workspace:excel_import",this._fields=[{type:"single_item",name:"workspace_id",label:lng("select workspace"),value:this.workspace_id,poster:!0,theme:"bright",searchData:(e,t)=>{(0,v.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",is_owner:1,members_director:1,show_all:1,types:"Group,Ou,Qualification,Subset,Workplan,Role",term:e.term||void 0,id:e.ids||void 0}},t)}}],this.fetch()}templateFields(){return[Fi.Z,{...Fi.P4,visible:()=>!this.values.get("workspace_id")},...super.templateFields()]}templateLink(e){return super.templateLink(e)+e.get("userCol")+(e.get("workspace_id")?"":"-"+e.get("groupCol"))}}function Vi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ui extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("group_performances"===n)return new Ui({route:r,nav:i})}constructor(e){var t;super(e),Vi(this,"workspace_id",void 0),this.workspace_id=(null===(t=e.route[0])||void 0===t?void 0:t.workspace_id)||this.workspace_id,this.title=lng("import workspace performances").caps(),this.objType="groupperformances",this.fetch()}settingsFields(){return[{type:"single_item",name:"workspace_id",label:lng("select workspace"),value:this.workspace_id,poster:!0,theme:"bright",searchData:(e,t)=>{(0,v.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",types:["Group","Qualification"],term:e.term||"",id:e.ids||"",is_owner:1,show_all:1}},t)}},{type:"checkbox",name:"assignments_exemption",label:lng("give exemption to workspace assignments")},...super.settingsFields()]}templateFields(){return[Fi.Z,{...Fi.P4,visible:()=>!this.values.get("workspace_id")},...super.templateFields(this.values)]}moreInfoFields(){return[(0,Fi.bw)(lng("data must be sorted by date in ascending order").caps()+"."),(0,Fi.bw)(lng("qualification performances can be imported for qualifications in status:").caps(),[lng("renewing"),lng("late"),lng("expired")]),...super.moreInfoFields()]}templateLink(e){return super.templateLink(e)+e.get("userCol")+(e.get("workspace_id")?"":"-"+e.get("groupCol"))}}function Hi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ji extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("assignment_performances"===n)return new Ji({route:r,nav:i})}constructor(e){var t;super(e),Hi(this,"assignment_id",void 0),this.assignment_id=(null===(t=e.route[0])||void 0===t?void 0:t.assignment_id)||this.assignment_id,this.title=lng("import assignment performances").caps(),this.objType="assignmentperformances",this.fetch()}settingsFields(){return[{type:"single_item",name:"assignment_id",label:lng("select assignment"),value:this.assignment_id,poster:!0,theme:"bright",searchData:(e,t)=>{(0,v.SC)("search/assignments/",{data:{req:"AutoComplete",term:e.term||"",assignment_type:"lesson,task",id:e.ids||""},method:"POST"},t)}},{type:"checkbox",name:"my_assignments",label:lng("load performances only for my assignments"),visible:()=>!this.values.get("assignment_id")},...super.settingsFields()]}templateFields(){return[Fi.Z,{type:"select",name:"assignmentCol",label:lng("assignment column",lng("assignment")).caps(),options:(0,_.mi)(["assignment_name","assignment_id"]),caps:!1,visible:()=>!this.values.get("assignment_id")},...super.templateFields(),{type:"component",node:(0,C.tZ)("div",{children:lng("supported assignment types:").caps()+" "+[lng("content"),lng("activity")].join(", ")})}]}templateLink(e){return super.templateLink(e)+e.get("userCol")+(e.get("assignment_id")?"":"-"+e.get("assignmentCol"))}}function Gi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Wi extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("ldap"===n)return new Wi({route:r,nav:i})}constructor(e){super(e),Gi(this,"importFromTemplate",!1),this.title=lng("import users from %s","active directory").caps(),this.objType="ldap",this.fetch()}settingsFields(){return[{type:"checkbox",name:"import_photos",label:lng("import photos")},{type:"checkbox",name:"create_ou",label:lng("create org' units")},{type:"indent_set",fields:[{type:"checkbox",name:"attach_ou_manager",label:lng("assign managers"),disable:()=>!this.values.get("create_ou"),onValueChange:e=>e&&this.updateValue(null,"manager_ou")},{type:"checkbox",name:"manager_ou",label:lng("create using manager field"),disable:()=>!this.values.get("create_ou"),onValueChange:e=>e&&this.updateValue(null,"attach_ou_manager")}]},{type:"checkbox",name:"del_users",label:lng("remove missing users")},...super.settingsFields()]}_buildFields(){this._fields.push({type:"indent_set",toggleTitle:lng("connection details").caps(),toggle:!0,fields:[{type:"text",name:"ldap_server",label:lng("server address"),disabled:!0},{type:"text",name:"ldap_domain",label:lng("domain"),disabled:!0},{type:"text",name:"user",label:lng("user"),required:!0},{type:"password",name:"password",label:lng("password"),autoComplete:"new-password",required:!0}]},{type:"indent_set",toggleTitle:lng("filtering").caps(),toggle:!0,fields:[{type:"text",name:"ou",label:lng("org' unit")},{type:"text",name:"filter",label:lng("ldap filter string")},{type:"checkbox",name:"bi_filters[0]",label:lng("skip disabled users"),checkboxValue:"enabled_users"}]}),super._buildFields()}scheduleDisabled(e){return!e.get("user")}}class Ki extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("meetings"===n)return new Ki({route:r,nav:i})}constructor(e){super(e),this.title=lng("import meetings").caps(),this.objType="meetings",this._fields=[],this.fetch()}moreInfoFields(){const e=[{val:lng("any valid url").caps(),label:lng("e.g.: %s","https://example.com/mymeeting").caps()},...this.data.assignment_url_options.map((e=>{let{label:t,code:i}=e;return{label:t,val:i}}))],t=[{label:lng("automatic attendance when clicking online link (link shows 5 min before starting)"),val:1},{label:lng("none"),val:0}];return[(0,Fi.xF)(lng("available values for %s","meeting url").caps(),e),(0,Fi.xF)(lng("available values for %s","auto attendance").caps(),t),...super.moreInfoFields()]}}function Yi(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Qi extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("tasks"===n)return new Qi({route:r,nav:i})}constructor(e){var t;super(e),Yi(this,"group_id",null),this.group_id=(null===(t=e.route[0])||void 0===t?void 0:t.group_id)||this.group_id,this.title=lng("import tasks").caps(),this.objType="tasks",this.fetch()}}class en extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("questionnaires"===n)return new en({route:r,nav:i})}constructor(e){super(e),this.title=lng("import questionnaires").caps(),this.objType="questionnaires",this.fetch()}}var tn=i(423);function nn(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class rn extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("hibob"===n)return new rn({route:r,nav:i})}constructor(e){super(e),nn(this,"importFromTemplate",!1),this.title=lng("import users from %s","hibob").caps(),this.objType="hibob",this.fetch()}settingsFields(){return[{type:"checkbox",name:"create_ou",label:lng("create org' units")},{type:"radioset",skinny:!0,name:"manager_ou",options:[{val:"",label:lng("flat structure based on the field:")+" department"},{val:1,label:lng("hierarchical management structure based on the field:")+" manager"}],visible:()=>!!this.values.get("create_ou")},{type:"checkbox",name:"del_users",label:lng("remove missing users")},...super.settingsFields()]}_buildFields(){this._fields.push({type:"indent_set",toggleTitle:lng("connection details").caps(),toggle:!0,fields:[{type:"text",name:"user",label:lng("user"),required:!0},{type:"password",name:"password",label:lng("password"),autoComplete:"new-password",required:!0}]},{type:"indent_set",toggleTitle:lng("filtering").caps(),toggle:!0,fields:[{type:"text",name:"filters[departments]",label:lng("departments")+" (csv)"}]}),super._buildFields()}scheduleDisabled(e){return!e.get("user")}}class sn extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("occupations"===n)return new sn({route:r,nav:i})}constructor(e){super(e),this.title=lng("import occupations").caps(),this.objType="occupations",this._fields=[],this.fetch()}moreInfoFields(){return[(0,Fi.bw)(lng("occupation name should be in english only").caps()),...super.moreInfoFields()]}}function on(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class an extends Fi.dH{static match(e,t){let{nav:i}=t;const[n,...r]=e;if("aad"===n)return new an({route:r,nav:i})}constructor(e){super(e),on(this,"importFromTemplate",!1),this.title=lng("import users from %s","Azure Active Directory").caps(),this.objType="aad",this.fetch()}settingsFields(){return[{type:"checkbox",name:"create_ou",label:lng("create org' units")},{type:"radioset",skinny:!0,name:"manager_ou",options:[{val:"",label:lng("flat structure based on the field:")+" department"},{val:1,label:lng("hierarchical management structure based on the field:")+" manager"}],visible:()=>!!this.values.get("create_ou")},{type:"select",label:lng("external id"),name:"external_id_field",options:[{val:"",label:"object id"},{val:"userPrincipalName",label:"userPrincipalName"}]},{type:"checkbox",name:"del_users",label:lng("remove missing users")},...super.settingsFields()]}_buildFields(){this._fields.push({type:"indent_set",toggleTitle:lng("connection details").caps(),toggle:!0,fields:[{type:"text",name:"tenantID",label:"Directory/Tenant ID",required:!0},{type:"text",name:"clientID",label:"Application/Client ID",required:!0},{type:"text",name:"clientSecret",label:"Client Secret Value",required:!0,helpKey:"@import/client_secret"}]},{type:"indent_set",toggleTitle:lng("filtering").caps(),toggle:!0,fields:[{type:"text",name:"filters[groups]",label:lng("groups")+" (csv) "+lng("by name or GUID"),onValueChange:e=>this.validate(e)},{type:"text",name:"filters[departments]",label:lng("departments")+" (csv)"},{type:"checkbox",name:"filters[skip_disabled]",label:lng("skip disabled users")}]}),super._buildFields()}scheduleDisabled(e){return!(e.get("tenantID")&&e.get("clientID")&&e.get("clientSecret"))}}var ln,cn;function dn(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function pn(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let un=(ln=class{constructor(e){let{nav:t}=e;var i,n,r,s;i=this,n="importObj",s=this,(r=cn)&&Object.defineProperty(i,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(s):void 0}),dn(this,"route",[]),(0,m.makeObservable)(this),this.nav=t}updateRoute(e){this.route=e,this.importObj=this._getImportObject()}_getImportObject(){const e=[Mi,qi,Xi,$i,Ui,Ji,Wi,Ki,Qi,en,tn.l,rn,an,sn];for(let t of e){const e=t.match(this.route,{nav:this.nav});if(e)return e}}get ready(){return this.importObj&&this.importObj.ready}get error(){return this.importObj?this.importObj.error:"import not found"}},cn=pn(ln.prototype,"importObj",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pn(ln.prototype,"ready",[m.computed],Object.getOwnPropertyDescriptor(ln.prototype,"ready"),ln.prototype),pn(ln.prototype,"error",[m.computed],Object.getOwnPropertyDescriptor(ln.prototype,"error"),ln.prototype),ln);var mn,gn,hn,bn,vn,_n,fn,yn,wn,xn,kn,Zn,Cn,Sn,On,Bn,Tn,Nn,In,Dn,jn=i(7327),Pn=i(8246),zn=i(8116);function En(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Rn(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Fn(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Mn=(mn=m.action.bound,gn=m.action.bound,hn=class{constructor(e){let{nav:t}=e;En(this,"ready",bn,this),En(this,"assignments",vn,this),En(this,"workspaces",_n,this),En(this,"groupsCompactView",fn,this),En(this,"events",yn,this),En(this,"assignment_completion",wn,this),En(this,"qualification_completion",xn,this),En(this,"course_completion",kn,this),En(this,"coach_completion",Zn,this),En(this,"activeCalendarDate",Cn,this),En(this,"activeCalendarMonth",Sn,this),En(this,"_showOnlyAssignments",On,this),En(this,"_coachingMode",Bn,this),En(this,"_coachingUserId",Tn,this),En(this,"showOld",Nn,this),En(this,"showOldLoading",In,this),En(this,"showCompleted",Dn,this),Rn(this,"_trainees",new Map),(0,m.makeObservable)(this),this.nav=t,this.fetch(),(0,m.observe)(this,"groupsCompactView",(e=>{ht.X.set("overview_groupsCompactView",e.newValue?1:void 0)})),Gs.on("commentsUpdateCount",(e=>{if("assignment"===e.connectTo.type){let t=this.assignments.find((t=>t.assignment_id==e.connectTo.object_id));t&&(t.comment_count=e.length)}}))}get todoAssignments(){return this.assignments.filter((e=>!e.isForCoach()&&e.isToDO()))}get listAssignments(){return this.assignments.filter((e=>!e.isForCoach()))}get coachingAssignments(){return this.assignments.filter((e=>e.isForCoach()))}calcTraineeData(){this.coachingAssignments.forEach((e=>{e.users.forEach((t=>{var i;const n=this._trainees.get(t.user_id)||{...t,countAssignments:0,countAssignmentsOverdue:0};n.countAssignments++,(null===(i=e.sortTime)||void 0===i?void 0:i.unix())<Blsm.prm.TIME&&!t.performance_completed&&n.countAssignmentsOverdue++,this._trainees.set(t.user_id,n)}))}))}get trainees(){return Array.from(this._trainees.values()).sort(((e,t)=>(0,_.v2)(e).localeCompare((0,_.v2)(t))))}fetch(){const e=(0,w.WQ)(),t=`${e.year()}-${e.month()+1}-01`,i=e.clone().endOf("month"),n=`${i.year()}-${i.month()+1}-${i.date()}`;(0,v.SC)("overview/basic",{method:"GET",data:{dateFrom:t,dateTo:n,show_old:null==this?void 0:this.showOld,waiting_only:1}},(0,m.action)((t=>{var i,n,r;this.assignments=(null===(i=t.assignments)||void 0===i?void 0:i.map((e=>new jn.o(e))))||[],this.workspaces=(null===(n=t.workspaces)||void 0===n?void 0:n.map((e=>new Pn.j(e))))||[];const s=(null===(r=t.schedule)||void 0===r?void 0:r.map((e=>(0,zn.aZ)(e,{displayWorkspace:!0}))))||[],o=e.clone().format("YYYY-MM");this.events.set(o,s),this.assignment_completion=t.assignment_completion,this.qualification_completion=t.qualification_completion,this.course_completion=t.course_completion,this.coach_completion=t.coach_completion,this.calcTraineeData(),this.ready=!0})))}get monthEvents(){if(!this.activeCalendarMonth)return!1;const e=this.activeCalendarMonth.format("YYYY-MM");return this.events.has(e)||(this.events.set(e,!1),this._fetchMonthEvents(this.activeCalendarMonth)),this.events.get(e)}_fetchMonthEvents(e){const t=`${e.year()}-${e.month()+1}-01`,i=e.clone().endOf("month"),n=`${e.year()}-${e.month()+1}-${i.date()}`;(0,v.SC)("overview/schedule",{method:"GET",data:{dateFrom:t,dateTo:n}},(0,m.action)((t=>{var i;const n=(null===(i=t.schedule)||void 0===i?void 0:i.map((e=>(0,zn.aZ)(e,{displayWorkspace:!0}))))||[],r=e.format("YYYY-MM");this.events.set(r,n)})))}get showOnlyAssignments(){return this._showOnlyAssignments}set showOnlyAssignments(e){this.nav([{alist:e?1:""}])}get coachingMode(){return this._coachingMode}get coachingUserId(){return this._coachingUserId}set coachingUserId(e){this.nav(e?["coaching",e]:["coaching"])}updateRoute(e){let[t,i]=e;this._coachingMode="coaching"===t,this._coachingUserId=this._coachingMode&&i,this._showOnlyAssignments="1"===(null==t?void 0:t.alist),"1"===(null==t?void 0:t.alist)&&"1"===(null==i?void 0:i.show_completed)&&this.setShowCompleted(!0)}setShowOld(e){this.showOld=e,(0,v.SC)("overview/workspaces",{data:{show_old:this.showOld?1:0},method:"GET"},(e=>this.workspaces=(null==e?void 0:e.map((e=>new Pn.j(e))))||[]))}setShowCompleted(e){this.showCompleted=e,this.showOldLoading=!0,(0,v.SC)("overview/assignments",{data:{waiting_only:this.showCompleted?0:1},method:"GET"},(e=>(this.showOldLoading=!1,this.assignments=(null==e?void 0:e.map((e=>new jn.o(e))))||[])))}setActiveComponent(e){Us().showSideDrawer(e,{tab:"",close:()=>this.setActiveComponent(null)})}},bn=Fn(hn.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),vn=Fn(hn.prototype,"assignments",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_n=Fn(hn.prototype,"workspaces",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fn=Fn(hn.prototype,"groupsCompactView",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!!ht.X.get("overview_groupsCompactView")}}),yn=Fn(hn.prototype,"events",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),wn=Fn(hn.prototype,"assignment_completion",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xn=Fn(hn.prototype,"qualification_completion",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=Fn(hn.prototype,"course_completion",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zn=Fn(hn.prototype,"coach_completion",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=Fn(hn.prototype,"activeCalendarDate",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,w.WQ)().startOf("day")}}),Sn=Fn(hn.prototype,"activeCalendarMonth",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),On=Fn(hn.prototype,"_showOnlyAssignments",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Bn=Fn(hn.prototype,"_coachingMode",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Tn=Fn(hn.prototype,"_coachingUserId",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nn=Fn(hn.prototype,"showOld",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),In=Fn(hn.prototype,"showOldLoading",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Dn=Fn(hn.prototype,"showCompleted",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fn(hn.prototype,"todoAssignments",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"todoAssignments"),hn.prototype),Fn(hn.prototype,"listAssignments",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"listAssignments"),hn.prototype),Fn(hn.prototype,"coachingAssignments",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"coachingAssignments"),hn.prototype),Fn(hn.prototype,"trainees",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"trainees"),hn.prototype),Fn(hn.prototype,"fetch",[m.action],Object.getOwnPropertyDescriptor(hn.prototype,"fetch"),hn.prototype),Fn(hn.prototype,"monthEvents",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"monthEvents"),hn.prototype),Fn(hn.prototype,"showOnlyAssignments",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"showOnlyAssignments"),hn.prototype),Fn(hn.prototype,"coachingMode",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"coachingMode"),hn.prototype),Fn(hn.prototype,"coachingUserId",[m.computed],Object.getOwnPropertyDescriptor(hn.prototype,"coachingUserId"),hn.prototype),Fn(hn.prototype,"updateRoute",[m.action],Object.getOwnPropertyDescriptor(hn.prototype,"updateRoute"),hn.prototype),Fn(hn.prototype,"setShowOld",[mn],Object.getOwnPropertyDescriptor(hn.prototype,"setShowOld"),hn.prototype),Fn(hn.prototype,"setShowCompleted",[gn],Object.getOwnPropertyDescriptor(hn.prototype,"setShowCompleted"),hn.prototype),hn);var An,qn,Xn=i(2115);function Ln(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $n(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Vn=(An=class{constructor(e){let{nav:t}=e;var i,n,r,s;Ln(this,"nav",void 0),Ln(this,"modes",["overview"]),Ln(this,"show_tasks",void 0),Ln(this,"show_discussions",void 0),Ln(this,"show_nav",void 0),i=this,n="mode",s=this,(r=qn)&&Object.defineProperty(i,n,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(s):void 0}),Ln(this,"overviewStore",null),Ln(this,"discussionsStore",null),(0,m.makeObservable)(this),this.nav=t,this.show_discussions=Blsm.isGuiFeatureEnabled("show_discussions_in_home")&&Blsm.isFeatureEnabled("discussions"),this.show_nav=this.show_discussions||this.show_tasks,this.show_discussions&&this.modes.push("discussions")}updateRoute(e){let[t,...i]=e,n="overview";const r=Blsm.prm.Mainref+"home_default";ht.X.get(r)&&this.modes.includes(ht.X.get(r))&&(n=ht.X.get(r)),this.modes.includes(t)?(this.mode=t,ht.X.set(r,t)):this.mode=n;this.getStore(this.mode).updateRoute(i)}getOverviewStore(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.overviewStore||e||(this.overviewStore=new Mn({nav:(e,t)=>this.nav(["overview",...e],t)})),this.overviewStore}getDiscussionsStore(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.discussionsStore||e||(this.discussionsStore=new Xn.C({nav:(e,t)=>this.nav(["discussions",...e],t)})),this.discussionsStore}getStore(e){switch(e){case"overview":return this.getOverviewStore();case"discussions":return this.getDiscussionsStore()}}},qn=$n(An.prototype,"mode",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),$n(An.prototype,"updateRoute",[m.action],Object.getOwnPropertyDescriptor(An.prototype,"updateRoute"),An.prototype),An);var Un,Hn,Jn,Gn,Wn=i(3390),Kn=i(7806),Yn=i(2645),Qn=i(6259),er=i(9431);function tr(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ir(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function nr(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let rr=(Un=class{constructor(e){tr(this,"ready",Hn,this),tr(this,"subs",Jn,this),tr(this,"data",Gn,this),ir(this,"id",void 0),ir(this,"ws",void 0),(0,m.makeObservable)(this),this.id=e}updateRoute(e,t){let{reload:i}=t;this.ready&&!i||(this.ws=e[1],(0,v.SC)(`assignment/master/${this.ws?`group=${this.ws}`:""}/${this.id}`,{},(e=>{var t;this.data=e,this.subs=(null===(t=e.subs)||void 0===t?void 0:t.map((e=>new jn.o(e,{master:this}))))||[],this.ready=!0})))}removeSub(e){this.subs=this.subs.filter((t=>t.assignment_id!=e))}},Hn=nr(Un.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Jn=nr(Un.prototype,"subs",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Gn=nr(Un.prototype,"data",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Un);var sr,or,ar=i(101);let lr=(sr=m.action.bound,or=class extends pe.I{constructor(e){super(),(0,m.makeObservable)(this);const{data:t={}}=e;this.tab=t.tab,this.onSaveSuccess=e.onSaveSuccess,t.category?(this.category=t.category,this.title=lng('add category under "%s"',t.category.name).caps()):this.title=lng("add new category").caps(),this._fields=[{type:"text",name:"title",label:lng("category name").caps(),theme:"bright",required:!0}],this._prepFields(),this.ready=!0}save(e){var t;let i=Object.assign({...e,create:!0,id:(null===(t=this.category)||void 0===t?void 0:t.id)||0});1===this.tab&&(i.global=!0),this.saveToUrl("domains/category_tree",i)}SaveSuccess(){}},cr=or.prototype,dr="SaveSuccess",pr=[sr],ur=Object.getOwnPropertyDescriptor(or.prototype,"SaveSuccess"),mr=or.prototype,gr={},Object.keys(ur).forEach((function(e){gr[e]=ur[e]})),gr.enumerable=!!gr.enumerable,gr.configurable=!!gr.configurable,("value"in gr||gr.initializer)&&(gr.writable=!0),gr=pr.slice().reverse().reduce((function(e,t){return t(cr,dr,e)||e}),gr),mr&&void 0!==gr.initializer&&(gr.value=gr.initializer?gr.initializer.call(mr):void 0,gr.initializer=void 0),void 0===gr.initializer&&(Object.defineProperty(cr,dr,gr),gr=null),or);var cr,dr,pr,ur,mr,gr,hr,br;const vr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===(null==e?void 0:e.slice().length)||!e)return[];for(let i of e.slice())t.push(i),i.sons&&i.sons.slice().length>0&&t.push(vr(i.sons,t));return t.filter((e=>"object"==typeof e&&!Array.isArray(e)))};let _r=(hr=m.action.bound,br=class extends pe.I{constructor(e){super(),(0,m.makeObservable)(this);const{data:t={}}=e;this.onSaveSuccess=e.onSaveSuccess,this.category=t.category,this.title=lng("edit category").caps()+" "+t.category.name;let i=vr(t.categories.sons);this.buildFields(t.category.id,e.initialValues,i)}buildFields(e,t,i){this._fields=[{type:"text",name:"title",label:lng("category name").caps(),theme:"bright",required:!0},{type:"select",name:"parent",label:lng("parent"),empty_option:!0,options:[{val:0,label:""}].concat(i.filter((t=>parseInt(t.id)!==parseInt(e))).map((e=>{let{name:t,id:i}=e;return{label:t,val:i}})))}],this._prepFields(t),this.ready=!0}save(e){this.saveToUrl("domains/category_tree",Object.assign({...e,id:this.category.id}))}SaveSuccess(){}},function(e,t,i,n,r){var s={};Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null)}(br.prototype,"SaveSuccess",[hr],Object.getOwnPropertyDescriptor(br.prototype,"SaveSuccess"),br.prototype),br);var fr,yr,wr,xr,kr,Zr,Cr=i(9637),Sr=i(676);i(7882);function Or(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Br(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Tr(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Nr=(fr=m.action.bound,yr=m.action.bound,wr=class{constructor(e){let{nav:t}=e;Or(this,"ready",xr,this),Or(this,"_tree",kr,this),Or(this,"tab",Zr,this),Br(this,"addCategory",(e=>{Us().openDialog("form",new lr({data:{category:e,tab:this.tab},onSaveSuccess:e=>this.onDialogClose(e)}))})),Br(this,"addParentCategory",(()=>{Us().openDialog("form",new lr({data:{tab:this.tab},onSaveSuccess:this.onDialogClose}))})),Br(this,"editCategory",(e=>{var t;let i=this._findNode(e.id);Us().openDialog("form",new _r({data:{category:e,categories:this._tree,tab:this.tab},initialValues:{title:e.name,parent:null===(t=i[1])||void 0===t?void 0:t.id},onSaveSuccess:this.onDialogClose}))})),Br(this,"deleteCategory",(e=>{(0,v.SC)("domains/category_usages/"+e.id,{},(t=>{t.usages.length>0?Us().openDialog("form",new Ir({...t,category_id:e.id,onSaveSuccess:this.onDialogClose})):(0,U.BB)(lng('are you sure that you want to delete the category "%s"?',e.name).caps(),{text:lng("delete").caps(),onConfirm:()=>(0,v.SC)("domains/category_tree",{data:e,method:"DELETE"},this.onDialogClose)})}))})),Br(this,"onDialogClose",(e=>{this._tree.lastSon=parseInt(e),Us().closeDialog(),this._fetch()})),(0,m.makeObservable)(this),this.nav=t,this._fetch()}_fetch(){this._tree.sons=[],(0,v.SC)("domains/category_tree",{data:{global:this.tab}},(0,m.action)((e=>{this._tree.sons=e.categories,(0,ar.v0)(this._tree.sons),this.ready=!0})))}fetch(){this._fetch()}setTab(e){this.tab=e,this.fetch()}updateRoute(){}get tree(){return this._tree.sons}updateNav(){this.nav([],{replace:!0})}moveNode(e,t){e=e.toString(),t=t.toString();const[i]=this._findNode(t);let n=!1;if(t.includes("|")){let[,r]=t.split("|",2);n=parseInt(r);const[s,o]=this._findNode(e);if(o===i){i.sons.indexOf(s)<n&&n--}}const[r,s]=this._findNode(e);s.sons.remove(r),i.sons.splice(!1===n?i.sons.length:n,0,r),(0,ar.v0)(this._tree.sons),(0,v.SC)("domains/category_tree_move",{method:"POST",data:{moved_id:e,to_parent:i.id,to_index:n,global:0}})}_findNode(e){let[t]=e.split("|",2);if(!t)return[this._tree,this._tree];const i=[];return[(0,_.oH)(this._tree.sons,(e=>e.id===t),i),i.length>1?i[i.length-2]:this._tree]}},xr=Tr(wr.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kr=Tr(wr.prototype,"_tree",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{sons:[]}}}),Zr=Tr(wr.prototype,"tab",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Tr(wr.prototype,"fetch",[m.action],Object.getOwnPropertyDescriptor(wr.prototype,"fetch"),wr.prototype),Tr(wr.prototype,"setTab",[m.action],Object.getOwnPropertyDescriptor(wr.prototype,"setTab"),wr.prototype),Tr(wr.prototype,"updateRoute",[m.action],Object.getOwnPropertyDescriptor(wr.prototype,"updateRoute"),wr.prototype),Tr(wr.prototype,"tree",[m.computed],Object.getOwnPropertyDescriptor(wr.prototype,"tree"),wr.prototype),Tr(wr.prototype,"updateNav",[fr],Object.getOwnPropertyDescriptor(wr.prototype,"updateNav"),wr.prototype),Tr(wr.prototype,"moveNode",[yr],Object.getOwnPropertyDescriptor(wr.prototype,"moveNode"),wr.prototype),wr);class Ir extends pe.I{constructor(e){super(e),this.title=lng("can't remove category").caps(),this._fields=[{type:"hidden",name:"category_id"},{name:"new_category_id",type:"select",label:lng("select a new category for the following items"),options:(0,_.wd)(e.options).filter((t=>t.val!=e.category_id))},{type:"component",node:(0,C.tZ)(Dr,{usages:e.usages})}],this._prepFields(e),this.ready=!0}save(e){this.saveToUrl("domains/update_category_and_delete",e)}SaveSuccess(){Us().closeDialog()}}const Dr=e=>{let{usages:t}=e;const i=[{title:"#"},{title:lng("name")},{title:lng("category")},{}];return t?(0,C.tZ)(Sr.iA,{cols:i,collection:t,rowIdCol:"id",RowRenderer:jr,compact:!0,noWindow:!0}):(0,C.tZ)(ee.$,{})},jr=e=>{let{row:t}=e;return(0,C.BX)("tr",{children:[(0,C.BX)("td",{children:["#",t.lesson_id]}),(0,C.tZ)(Cr.U6,{children:t.lesson_name}),(0,C.tZ)("td",{children:t.category_name}),(0,C.tZ)(Cr.jA,{children:(0,C.tZ)(Ri.JO,{icon:"edit",smallButtonLike:!0,href:{edit:"content",id:t.lesson_id,section:"advanced"}})})]})};var Pr,zr,Er,Rr,Fr,Mr,Ar,qr,Xr,Lr,$r,Vr,Ur=i(5519);class Hr extends pe.I{constructor(e){super(e),this.initialValues=e.data||{},this.successMessage=lng("resources for meeting saved successfully"),this.title=lng("meeting resources").caps(),this._fields=[{type:"hidden",name:"group_id"},{type:"hidden",name:"obj_id"},{type:"hidden",name:"obj_type"},{type:"multiple_items",name:"resources",label:lng("select resources"),poster:!0,theme:"bright",valueIsMap:!0,objectKeys:["resource_id","label","amount_in_use","resource_category","note"],searchData:(e,t)=>{(0,v.SC)("resources/search_resource",{data:{req:"AutoComplete",by_id:e.ids,mode:"all",term:e.term,matches_only:!0}},t)},buttons:[{Render:Ur.V_,props:{period:()=>[this.initialValues.start,this.initialValues.end],assignmentId:this.initialValues.obj_id,groupId:this.initialValues.group_id},onChange:(e,t)=>{let{note:i,amount_in_use:n}=t;return void 0!==i&&(e.note=i),void 0!==n&&(e.amount_in_use=n),e}}]}],this._prepFields(this.initialValues),this.ready=!0}save(e){this.saveToUrl("resources/set_use",Object.assign(e))}}function Jr(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Gr(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Wr(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Kr=(Pr=m.action.bound,zr=m.action.bound,Er=m.action.bound,Rr=m.action.bound,Fr=m.action.bound,Mr=class{constructor(e){let{nav:t}=e;Jr(this,"allUses",Ar,this),Jr(this,"id",qr,this),Jr(this,"name",Xr,this),Jr(this,"type",Lr,this),Jr(this,"fcTitle",$r,this),Jr(this,"ready",Vr,this),Gr(this,"calendarRef",{current:null}),Gr(this,"viewType","month"),Gr(this,"viewTypes",{month:"dayGridMonth",week:"timeGridWeek",day:"timeGridDay"}),Gr(this,"todayDisabled",!1),Gr(this,"title",null),(0,m.makeObservable)(this),this.nav=t,this.ready=!0}updateRoute(e){let[t,i]=e;switch(this.title="resource"===t?lng("resource planning"):lng("resource bundle planning"),this.id=i,this.type=t,this.name="",this.type){case"resource":this.id&&(0,v.SC)("resources/list_resource_planning_resources",{data:{resource_id:this.id}},(e=>{this.name=e.resource_name,this.allUses=e.items}));break;case"bundle":(0,v.SC)("resources/list_resource_planning_bundles",{data:{group_id:this.id}},(e=>{this.allUses=e.items,this.name=e.group_name}))}}updateFromFC(e){this.fcTitle=e.title}updateNav(){this.nav([],{replace:!0})}getEvents(e,t){let i={start:e.start.getTime()/1e3,end:e.end.getTime()/1e3};(0,v.SC)("calendar/get_resource_planning",{data:i},(e=>{const i=e.map((e=>{let{id:t,allDay:i,title:n,start:r,end:s,backgroundColor:o,resources:a,group_id:l,event_date:c,start_time:d,end_time:p}=e;n+=Object.values(a).map((e=>` ${e.label}(${e.amount_in_use})`));return{id:t,allDay:i,title:n,backgroundColor:o,start:r,end:s,durationEditable:!1,startEditable:!1,extendedProps:{resources:a,group_id:l,date:c,start_time:d,end_time:p}}}));t(i.filter((e=>!!e)))}))}eventClick(e){Us().openDialog("form",new Hr({data:{obj_id:e.event.id,obj_type:"Meeting",resources:e.event.extendedProps.resources,group_id:e.event.extendedProps.group_id,start:e.event.extendedProps.date+" "+e.event.extendedProps.start_time,end:e.event.extendedProps.date+" "+e.event.extendedProps.end_time},onSaveSuccess:()=>(Us().closeDialog(),this.calendarRef.current.refresh())}))}changeDate(e){this.calendarRef.current.gotoDate((0,w.GG)(e,{format:"YYYY-MM-DD"}))}},Ar=Wr(Mr.prototype,"allUses",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qr=Wr(Mr.prototype,"id",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xr=Wr(Mr.prototype,"name",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Lr=Wr(Mr.prototype,"type",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$r=Wr(Mr.prototype,"fcTitle",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Vr=Wr(Mr.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wr(Mr.prototype,"updateRoute",[m.action],Object.getOwnPropertyDescriptor(Mr.prototype,"updateRoute"),Mr.prototype),Wr(Mr.prototype,"updateFromFC",[Pr],Object.getOwnPropertyDescriptor(Mr.prototype,"updateFromFC"),Mr.prototype),Wr(Mr.prototype,"updateNav",[zr],Object.getOwnPropertyDescriptor(Mr.prototype,"updateNav"),Mr.prototype),Wr(Mr.prototype,"getEvents",[Er],Object.getOwnPropertyDescriptor(Mr.prototype,"getEvents"),Mr.prototype),Wr(Mr.prototype,"eventClick",[Rr],Object.getOwnPropertyDescriptor(Mr.prototype,"eventClick"),Mr.prototype),Wr(Mr.prototype,"changeDate",[Fr],Object.getOwnPropertyDescriptor(Mr.prototype,"changeDate"),Mr.prototype),Mr);var Yr,Qr,es,ts,is=i(4943),ns=i(1619);function rs(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ss(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let os=(Qr=ss((Yr=class{constructor(){rs(this,"ready",Qr,this),rs(this,"url",es,this),rs(this,"post",ts,this),(0,m.makeObservable)(this),this.fetch()}fetch(){(0,v.SC)("generic/t2k_echo_overview",{},(e=>{this.url=e.url,this.post=e.post,this.ready=!0}))}}).prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),es=ss(Yr.prototype,"url",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ts=ss(Yr.prototype,"post",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Yr);var as,ls,cs,ds,ps,us,ms,gs,hs,bs,vs;function _s(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function fs(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let ys=(as=m.action.bound,ls=class{constructor(e){let{nav:t}=e;_s(this,"ready",cs,this),_s(this,"listId",ds,this),_s(this,"assignmentId",ps,this),_s(this,"activePlayItem",us,this),_s(this,"createMode",ms,this),_s(this,"editDetailsDrawer",gs,this),_s(this,"playlist",hs,this),_s(this,"displayComments",bs,this),_s(this,"list",vs,this),(0,m.makeObservable)(this),this.nav=t}updateRoute(e){let[{list:t,id:i}]=e;"edit"===i?this.editDetailsDrawer=!0:this.assignmentId=i,this.listId!==t&&(this.listId=t,this.fetch())}fetch(){(0,v.SC)("channel/playlist",{data:{id:this.listId}},(e=>{this.playlist=new bt.g(e),this.ready=!0}))}get assignmentPlaying(){const e=this.playlistItems.find((e=>e.assignment_id==this.assignmentId));return!!e&&(this.activePlayItem=parseInt(e.assignment_id),e)}get playlistItems(){return this.playlist.items}get playlistTitle(){return this.playlist.title}updatePlaylist(e){this.playlist.updatePlaylist(e)}toggleCreateMode(e){if(!1===e||!0===e)return this.createMode=e;this.createMode=!this.createMode}toggleEditPlaylistDetails(){this.editDetailsDrawer=!this.editDetailsDrawer}toggleComments(){this.displayComments=!this.displayComments}setItemsOrder(e){this.playlist.items.forEach((t=>{t._attr.item_order=e.indexOf(t._attr.assignment_id+""),t.order=e.indexOf(t._attr.assignment_id+"")})),this.playlist.items.sort(((e,t)=>parseInt(e.order)-parseInt(t.order)))}},cs=fs(ls.prototype,"ready",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ds=fs(ls.prototype,"listId",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ps=fs(ls.prototype,"assignmentId",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),us=fs(ls.prototype,"activePlayItem",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ms=fs(ls.prototype,"createMode",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gs=fs(ls.prototype,"editDetailsDrawer",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hs=fs(ls.prototype,"playlist",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs=fs(ls.prototype,"displayComments",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),vs=fs(ls.prototype,"list",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fs(ls.prototype,"assignmentPlaying",[m.computed],Object.getOwnPropertyDescriptor(ls.prototype,"assignmentPlaying"),ls.prototype),fs(ls.prototype,"playlistItems",[m.computed],Object.getOwnPropertyDescriptor(ls.prototype,"playlistItems"),ls.prototype),fs(ls.prototype,"playlistTitle",[m.computed],Object.getOwnPropertyDescriptor(ls.prototype,"playlistTitle"),ls.prototype),fs(ls.prototype,"updatePlaylist",[as],Object.getOwnPropertyDescriptor(ls.prototype,"updatePlaylist"),ls.prototype),ls);var ws=i(1612);class xs extends pe.I{constructor(e){super(e),this.params=e,this.confirmButtonLabel=!1,e.close_is_decline&&(this.headExtra=(0,C.tZ)(Ri.JO,{buttonLike:!0,icon:"close",onClick:()=>this.save({val:0})})),this.title=e.text.title||"",this._fields=[{type:"component",node:(0,C.tZ)(ns.xn,{content:e.text.content})},{type:"row_set",fields:[{type:"component",node:(0,C.BX)("div",{children:[e.text.accept?(0,C.tZ)(Q.l,{onClick:()=>this.save({val:1}),theme:"contained",children:e.text.accept}):null," ",e.text.decline?(0,C.tZ)(Q.l,{onClick:()=>this.save({val:0}),style:{color:Z.g.colors.negative},children:e.text.decline}):null]})}]}],this.ready=!0}save(e){this.ready&&this.saveToUrl("users/consent",Object.assign({type:"eula"},e))}SaveSuccess(){this.ready=!1,location.reload()}}var ks=i(9523);var Zs={name:"hobrju",styles:"width:100%;display:block;padding:5px 10px;>*{width:100%;}"};const Cs=()=>{const[e,t]=(0,g.useState)(!1),i={en_US:"Continue in english",he_IL:"המשך בעברית",es_ES:"Continuar en español",pt_BR:"Continue em português",de_DE:"Weiter auf deutsch",fr_FR:"Continuer en français",vi_VN:"Tiếp tục bằng tiếng việt",ru_RU:"Продолжить на русском",hi_IN:"हिंदी में जारी रखें",ar_SA:"تواصل بالعربية"},n=Object.keys(Blsm.lang.available),r=Zs,s=e=>{let{langCode:n}=e;return(0,C.tZ)("div",{css:r,children:(0,C.tZ)(Q.l,{onClick:()=>{return e=n,t(!0),void(0,ks.rt)(e);var e},theme:"contained",children:i[n]||n})})};return e?(0,C.tZ)(ee.$,{}):(0,C.tZ)("div",{children:n.map((e=>(0,C.tZ)(s,{langCode:e},e)))})};var Ss,Os,Bs,Ts,Ns,Is,Ds,js,Ps,zs,Es,Rs,Fs,Ms=i(2616),As=i(20);function qs(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Xs(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ls(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const $s=(0,g.createContext)(null);let Vs=null;const Us=()=>Vs;window.mainStoreInstance=Us;const Hs=e=>(0,_.DM)(e)?(0,_.Kn)(e)?(0,_.Wh)((0,_.v7)(e),!0):e:"";let Js=(Ss=m.observable.shallow,Os=m.action.bound,Bs=m.action.bound,Ts=class{constructor(){Xs(this,"sideMenuStore",null),Xs(this,"notificationsStore",null),Xs(this,"user",Object.assign({},Blsm.user)),qs(this,"hierarchy_button_show",Ns,this),Xs(this,"_stores",new Map),qs(this,"mainRoute",Is,this),qs(this,"overlayRoute",Ds,this),qs(this,"mainDialog",js,this),Xs(this,"_curRoute",[]),Xs(this,"_curHash",""),Xs(this,"_mainRouteWindowTitle",null),Xs(this,"restoreOldRoute",!1),qs(this,"componentSideDrawer",Ps,this),Xs(this,"dirtyStore",null),Xs(this,"formPassData",null),qs(this,"showGlobalLoader",zs,this),qs(this,"startTime",Es,this),Xs(this,"history",[]),Vs=this,(0,m.makeObservable)(this),this.startTime=moment(),this.sideMenuStore=new h.tT({mainStore:this}),this.notificationsStore=new T,this.searchStore=new Ei.Z({nav:(e,t)=>this._buildNav("search",e,t)}),this._curHash=(0,_.VD)(),this._loadUrl(),window.addEventListener("hashchange",(()=>this.loadNewHash())),Blsm.InitialData.show_login_popup&&setTimeout((()=>(0,U.cS)((0,C.tZ)(ns.xn,{content:Blsm.InitialData.login_popup}),{inputType:Blsm.InitialData.login_popup_show_dont_show_again?"checkbox":"hidden",inputOptions:{label:lng("don't show again").caps()},title:lng("message"),cancelText:"",onConfirm:e=>(0,v.SC)("users/dismiss_login_popup",{method:"POST",data:{login_popup_hide:e}})})),1e3),Blsm.InitialData.action&&this.handleActionFromServer(Blsm.InitialData.action)}loadNewHash(){const e=(0,_.VD)();if(this._curHash!==e){var t,i,n,r;const c=()=>{this._curHash=e,this._loadUrl()};var s,o,a,l;if(null!==(t=this.dirtyStore)&&void 0!==t&&null!==(i=t.formObj)&&void 0!==i&&i.dirty||null!==(n=this.dirtyStore)&&void 0!==n&&null!==(r=n.formObj)&&void 0!==r&&r.alertBeforeClose)(0,U.BB)(null!==(s=this.dirtyStore)&&void 0!==s&&null!==(o=s.formObj)&&void 0!==o&&o.dirty?lng("there are unsaved changes, are you sure you want to close the dialog?").caps():null===(a=this.dirtyStore)||void 0===a||null===(l=a.formObj)||void 0===l?void 0:l.alertBeforeClose,{title:lng("discard changes"),confirmText:lng("close without saving").caps(),onConfirm:c,noHistoryBack:!0,onCancel:()=>(0,_.Y3)((()=>this.nav(this._curHash,{replace:!0,trigger:!1})))});else c()}}storeKey(e,t){let i=e;return t&&(i+=":"+((0,_.Kn)(t)?(0,_.SZ)(t):t)),i}hasStore(e,t){return this._stores.has(this.storeKey(e,t))}invalidateStore(e,t){const i=this.storeKey(e,t);if(this._stores.has(i)){var n;const e=this._stores.get(i);this._stores.delete(i),(0,m.isObservableProp)(e,"ready")&&!(0,m.isComputedProp)(e,"ready")&&(e.ready=!1),null===(n=e.invalidate)||void 0===n||n.call(e)}}get selfUserStore(){return Us().hasStore("user",Blsm.user.user_id)?this.getStore("user",Blsm.user.user_id):null}getStore(e,t){let{onlyIfExists:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.storeKey(e,t);if(this._stores.has(n))return this._stores.get(n);if(i)return;const r={withNav:{home:Vn,messages:Bi.Ou,calendar:Ti.m,edit:M,list:$,import:un,reports:Wn.E,dashboard:Kn.EK,cregistration:Yn.iS,catalog:Qn.Z,yearly:is.I,t2k_echo:os,portal:er.fm,category_tree:Nr,resourceplanning:Kr,challenges:ot,play:ys,library:ws.U,tasks:Ms.UP},withNavAndId:{workspace:z.J,user:bi},withId:{comments:b.pE,master:rr,qualification_issues:As.u},other:{sql:Di}};let s,o=null;return(s=r.withNav[e])?o=new s({nav:(t,i)=>this._buildNav(e,t,i),mainStore:this}):(s=r.withNavAndId[e])?o=new s({id:t,nav:(i,n)=>this._buildNav(e+"/"+t,i,n)}):(s=r.withId[e])?o=new s(t):(s=r.other[e])?o=new s:"test"===e&&(o={}),o?(this._stores.set(n,o),o):void 0}_buildNav(e,t){let{reload:i,trigger:n,replace:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(i)return this._loadUrl({reload:!0});const s=Array.isArray(t)?t.map(Hs).join("/").replace(/\/+$/g,""):"";this.nav(e+(e&&s?"/":"")+s,{trigger:n,replace:r})}nav(e){let{trigger:t=!0,replace:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.trimStart();i?location.replace("#"+n):location.href="#"+n,this._curHash=(0,_.VD)(),t&&this._loadUrl()}_loadUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};sessionStorage.getItem("cur_location")!==sessionStorage.getItem("last_location")&&sessionStorage.setItem("last_location",sessionStorage.getItem("cur_location")),sessionStorage.setItem("cur_location",this._curHash),this._curRoute=(0,_.cW)(this._curHash),this.dirtyStore=null,this.componentSideDrawer=null;const t=this._curRoute[0];if("user"!==t||this._curRoute[1]||(this._curRoute[1]=Blsm.user.id),this.checkMissingFields()||this.checkEULAConsent()||this.checkChooseLanguage())return void this.overlayRoute.replace(this._curRoute);this.addToHistory(this._curHash),this.sideMenuStore.updateRoute(this._curRoute),"edit"!==t&&this.invalidateStore("edit"),"search"!==t&&this.searchStore.clear();if("edit"===t&&["task","discussion","share","share_by_mail","training_needs_request"].includes(this._curRoute[1])||"master"===t||"request"===t){this._mainRouteWindowTitle=document.title,this.overlayRoute.replace(this._curRoute);const i="master"===t?(0,_.B5)(this._curRoute[1]):void 0;"request"!==t&&this.getStore(t,i).updateRoute(this._curRoute.slice(1),e),"edit"===t&&(this.dirtyStore=this.getStore(t))}else["home","messages","workspace","groups","user","edit","list","calendar","sql","search","import","reports","dashboard","tasks","cregistration","catalog","portal","category_tree","test","resourceplanning","yearly","challenges","t2k_echo","play","library"].includes(t)?(this.overlayRoute.clear(),this.mainRoute.replace((0,_.Ic)(this._curRoute)),"search"===t?this.searchStore.updateRoute(this._curRoute.slice(1),Object.assign(e,{skipFetch:!!this.restoreOldRoute})):["sql"].includes(t)?this.getStore(t):["home","messages","edit","list","calendar","import","reports","dashboard","cregistration","catalog","library","portal","category_tree","resourceplanning","yearly","challenges","channel","play","tasks"].includes(t)?this.getStore(t).updateRoute(this._curRoute.slice(1),e):["workspace","user"].includes(t)&&this.getStore(t,this._curRoute[1]).updateRoute(this._curRoute.slice(2),e),"edit"===t&&(this.dirtyStore=this.getStore(t))):Blsm.user.id&&Blsm.InitialData.main_menu.portal?this.nav("portal",{replace:!0}):Blsm.user.id&&this.nav("home",{replace:!0});this.restoreOldRoute=!1}closeOverlay(e){null!==this._mainRouteWindowTitle&&(document.title=this._mainRouteWindowTitle,this._mainRouteWindowTitle=null),this.overlayRoute.clear(),this.restoreOldRoute=!0,this.mainRoute.length>0?this._buildNav("",(0,m.toJS)(this.mainRoute)):this._buildNav(e||"",[])}openCommentsDialog(e){this.openDialog("comments",this.getStore("comments",e))}openDialog(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.mainDialog.data=t,this.mainDialog.options=i,this.mainDialog.closeConfirm=!1,this.mainDialog.dialog=e,document.getElementsByTagName("body")[0].style.overflow=""}closeDialog(){this.mainDialog.dialog=!1}showSideDrawer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.componentSideDrawer=e?{component:e,options:t}:null}pretend(e){this.showGlobalLoader=!0,(0,v.SC)("generic/pretend/"+e,{onError:(0,m.action)((()=>this.showGlobalLoader=!1))},(()=>location.reload()))}addToHistory(e){this.history.unshift(e),this.history=this.history.slice(0,4)}searchHistory(e){let t=!1;return this.history.some((i=>{const n=(0,_.cW)(i);if(e(n))return t=()=>this.nav(i),!0})),t}handleActionFromServer(e){let{type:t,...i}=e;if("meeting_attendance"===t){const e=()=>{(0,de.p4)({workspace:i.group_id,components:!0},!0),Blsm.Success(lng('setting attendance for "%s"',[i.assignment_name]))};i.signature_needed?(0,U.cS)("",{title:i.assignment_name,inputType:"signpad",inputRequired:!0,inputOptions:{label:lng("sign here to confirm your attendance").caps()+":"},confirmText:lng("submit"),onConfirm:t=>(0,v.SC)("meetings/verify_attendance/"+(0,_.$t)((0,_.ei)(i,["group_id","assignment_id","origin_user_id"])),{method:"POST",data:{signature:t}},(()=>e()))}):e()}}checkMissingFields(){const e=Blsm.InitialData.MissingMandatoryFields;if((null==e?void 0:e.length)>0){if(!("edit"===this._curRoute[0]&&"user"===this._curRoute[1]&&(0,_.Tz)(this._curRoute[2])))return this.missingTimeoutHandler=!1,this.nav("edit/user/"+Blsm.user.id),!0;this.missingTimeoutHandler||(this.missingTimeoutHandler=setTimeout((()=>{const t=[];for(const i of e)t.push((0,H.X)(i));(0,f.LB)({msg:lng("in order to continue, please fill in the necessary fields in your profile.")+" ("+t.join(", ")+")",closeOnClick:!0,type:"warning"})}),500))}return!1}checkEULAConsent(){var e;return!(!Blsm.InitialData.EulaReplyRequired||null!==(e=Blsm.user)&&void 0!==e&&e.real_data)&&(this.openDialog("form",new xs(Blsm.InitialData.EulaReplyRequired,{onClose:!1}),{hideX:!0}),!0)}checkChooseLanguage(){var e;return!(!Blsm.isFeatureEnabled("first_login_language")||Blsm.lang.user_language||null!==(e=Blsm.user)&&void 0!==e&&e.real_data)&&(this.openDialog("Component",{child:(0,C.tZ)(Cs,{}),title:lng("welcome, please select the system language").caps()},{hideX:!0}),!0)}},Ns=Ls(Ts.prototype,"hierarchy_button_show",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Is=Ls(Ts.prototype,"mainRoute",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ds=Ls(Ts.prototype,"overlayRoute",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),js=Ls(Ts.prototype,"mainDialog",[Ss],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{dialog:!1,data:null,closeConfirm:!1,options:{hideX:!1,fullHeight:!1,tailButtons:{}}}}}),Ps=Ls(Ts.prototype,"componentSideDrawer",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),zs=Ls(Ts.prototype,"showGlobalLoader",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Es=Ls(Ts.prototype,"startTime",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ls(Ts.prototype,"closeOverlay",[Os],Object.getOwnPropertyDescriptor(Ts.prototype,"closeOverlay"),Ts.prototype),Ls(Ts.prototype,"openCommentsDialog",[m.action],Object.getOwnPropertyDescriptor(Ts.prototype,"openCommentsDialog"),Ts.prototype),Ls(Ts.prototype,"openDialog",[m.action],Object.getOwnPropertyDescriptor(Ts.prototype,"openDialog"),Ts.prototype),Ls(Ts.prototype,"closeDialog",[Bs],Object.getOwnPropertyDescriptor(Ts.prototype,"closeDialog"),Ts.prototype),Ls(Ts.prototype,"showSideDrawer",[m.action],Object.getOwnPropertyDescriptor(Ts.prototype,"showSideDrawer"),Ts.prototype),Ls(Ts.prototype,"pretend",[m.action],Object.getOwnPropertyDescriptor(Ts.prototype,"pretend"),Ts.prototype),Ts);const Gs=new(Fs=Ls((Rs=class{constructor(){qs(this,"events",Fs,this),Xs(this,"keep",{}),(0,m.makeObservable)(this)}on(e,t){return(0,m.observe)(this.events,e,(e=>t((0,m.toJS)(e.newValue))))}trigger(e,t){this.events[e]=t}once(e,t){console.warn("calling disposer",this.keep[e]),(0,_.g4)(this.keep[e]);const i=this.on(e,t);return this.keep[e]=i,i}}).prototype,"events",[m.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{commentsUpdateCount:null,TaskUpdate:null,TaskDelete:null,DiscussionDelete:null,DiscussionCreate:null,FolderTree:null,FetchNotifications:null}}}),Rs)},2616:(e,t,i)=>{i.d(t,{UP:()=>pe,x9:()=>de,kM:()=>ce});var n,r,s,o,a,l,c,d,p,u,m,g,h,b,v,_,f,y,w,x,k,Z,C,S,O=i(7363),B=i(7821),T=i(8e3),N=i(5832),I=i(5007),D=i(8989),j=i(4210),P=i(8318),z=i(8567),E=i(7787),R=i(8534);function F(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function M(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function A(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let q=(r=A((n=class{constructor(e){let{nav:t,tStore:i}=e;F(this,"ready",r,this),F(this,"showSearch",s,this),F(this,"boards_list",o,this),F(this,"boards",a,this),F(this,"current_board",l,this),F(this,"searchInBoard",c,this),F(this,"bookmarked_boards",d,this),F(this,"tasksStore",p,this),M(this,"searchTasks",void 0),M(this,"lastSync",void 0),(0,B.makeObservable)(this),this.nav=t,this.tasksStore=i,this.init(),this.searchTasks=new V(this)}init(e){const t=e&&this.current_board?this.current_board:D.X.get("last_board")||0;t&&this.boards.has(t)&&(this.tasksStore._tab="board/"+t),this.ready=!1,(0,T.SC)(`projectBoard/init/board_id=${t}`,{},(e=>{(Object.keys(e.boards_list)||[]).forEach((t=>this.boards_list.set(parseInt(t),e.boards_list[t]))),this.current_board=e.current_board,this.tasks_status=e.tasks_status,this.tasks_types=e.tasks_types,this.workspaces=e.workspaces,e.first_board&&this.boards.set(this.current_board,new X(e.first_board,this)),this.ready=!0,this.lastSync=(0,P.c7)()}))}updateRoute(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.current_board=parseInt(e)||D.X.get("last_board")||0,this.current_board&&D.X.set("last_board",this.current_board),this.nav([this.current_board],{replace:!0,trigger:!1}),t&&e&&this.fetchBoard(this.current_board)}saveNewBoard(e){(0,T.SC)("projectBoard/saveNewBoard",{data:{name:e}},(t=>{t.board_id&&(this.boards_list.set(t.board_id,{board_id:t.board_id,board_name:e}),t.board&&this.boards.set(t.board_id,new X(t.board,this)),this.current_board=t.board_id)}))}changeBoard(e){const t=parseInt(e);this.nav([t]),this.boards.has(t)?this.current_board=t:this.fetchBoard(t)}fetchBoard(e){this.current_board=0,(0,T.SC)("projectBoard/getBoard",{data:{id:e}},(t=>{this.boards.set(e,new X(t,this)),this.current_board=e,this.lastSync=(0,P.c7)()}))}toggleSearchTasks(){this.showSearch=!this.showSearch}refresh(){const e=(0,P.c7)();e-this.lastSync<=20||(0,T.SC)("projectBoard/syncBoard",{data:{id:this.current_board,syncTime:this.lastSync}},(t=>{this.board.sync(t),this.lastSync=e}))}get board(){return this.current_board?this.boards.get(this.current_board):null}get canWrite(){var e;return null===(e=this.board)||void 0===e?void 0:e.canWrite}get mayBookmark(){return!0}get bookmarked(){var e;return 1===parseInt(null===(e=this.boards_list.get(this.current_board))||void 0===e?void 0:e.bookmarked)}toggleBookmark(){this.bookmark_id=!this.bookmark_id;const e={type:"board",id:this.current_board,delete:this.bookmarked?"1":"0"};(0,T.SC)("bookmarks",{data:e,method:"POST"},(()=>this.boards_list.get(this.current_board).bookmarked=this.bookmarked?"0":"1"))}}).prototype,"ready",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),s=A(n.prototype,"showSearch",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o=A(n.prototype,"boards_list",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),a=A(n.prototype,"boards",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),l=A(n.prototype,"current_board",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=A(n.prototype,"searchInBoard",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d=A(n.prototype,"bookmarked_boards",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=A(n.prototype,"tasksStore",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A(n.prototype,"updateRoute",[B.action],Object.getOwnPropertyDescriptor(n.prototype,"updateRoute"),n.prototype),A(n.prototype,"board",[B.computed],Object.getOwnPropertyDescriptor(n.prototype,"board"),n.prototype),A(n.prototype,"canWrite",[B.computed],Object.getOwnPropertyDescriptor(n.prototype,"canWrite"),n.prototype),n),X=(u=class{constructor(e,t){let{board_id:i,columns:n,board_name:r,board_users:s,permission:o}=e;F(this,"columns",m,this),M(this,"board_id",void 0),M(this,"board_name",void 0),M(this,"board_users",void 0),F(this,"permission",g,this),M(this,"store",void 0),M(this,"notes_map",new Map),(0,B.makeObservable)(this),this.store=t,this.board_id=i,this.board_name=r,this.board_users=s,this.permission=o,this.columns=(null==n?void 0:n.map((e=>new L(e,this))))||[]}swapNotes(e,t,i,n){const r=this.getColumnById(e).removeNoteByIndex(t),s=this.getColumnById(i);s.addNoteToIndex(n,r),(0,T.SC)("projectBoard/moveNote",{method:"POST",data:{note_id:r.data.note_id,column_id:s.column_id,order:n}})}swapColumns(e,t){const i=this.removeColumnByIndex(e);this.addColumnToIndex(t,i),(0,T.SC)("projectBoard/moveColumn",{method:"POST",data:{board_id:this.board_id,column_id:i.column_id,order:t}})}removeColumnByIndex(e){const t=this.columns.find(((t,i)=>i===e));return this.columns=this.columns.filter(((t,i)=>i!==e)),t}removeColumnById(e){const t=this.columns.findIndex((t=>t.column_id===e));this.columns=this.columns.filter(((e,i)=>i!==t))}addColumnToIndex(e,t){this.columns=[...this.columns.slice(0,e),t,...this.columns.slice(e)]}getColumnById(e){return this.columns.find((t=>t.column_id==e))}get existingTaskIds(){return this.columns.reduce(((e,t)=>[...e,...t.existingTaskIds]),[])}addColumn(e){e.board_id=this.board_id;const t=new L(e,this);t.save(e),this.columns=[...this.columns,t]}save(e){e.board_id=this.board_id,(0,T.SC)("projectBoard/saveBoard",{method:"POST",data:e},(()=>{var t;this.board_name=e.board_name,this.board_users=e.board_users,this.permission=null!==(t=e.board_users[Blsm.user.id])&&void 0!==t&&t.write_permission?"write":"read",this.store.boards_list.set(parseInt(e.board_id),{board_name:e.board_name})}))}delete(){const e=parseInt(this.board_id||this.store.current_board);(0,T.SC)("projectBoard/deleteBoard",{method:"POST",data:{board_id:e}},(0,B.action)((()=>{this.store.boards_list.delete(e),this.store.boards.delete(e),this.store.current_board=this.store.boards.keys().next().value||null})))}addTaskFromSearch(e,t,i){const n=this.getColumnById(t);null==n||n.addNote({task_id:e},i)}get canWrite(){return"write"===this.permission}firstColumn(){return this.columns[0]}selectedNoteIds(){return this.columns.reduce(((e,t)=>[...e,...t.selectedNoteIds()]),[])}deleteSelected(){const e=this.selectedNoteIds();e.length&&(0,T.SC)("projectBoard/deleteNotes",{method:"POST",data:{note_ids:e}},(0,B.action)((()=>{this.columns.forEach((e=>e.removeSelectedNotes()))})))}sync(e){for(const t of Object.values(e))for(const e of Object.values(t)){const t=this.notes_map.get(parseInt(e.note_id));if(!t||t.data.column_id!=e.column_id){let i=new $(e,this);null!=t&&t.data.note_id&&(i=t.column.removeNoteByNoteID(t.data.note_id));const n=this.getColumnById(e.column_id);n?n.addNoteToIndex(e.note_order,i):console.warn(`didnt find column with id: ${e.column_id}`)}}this.columns.forEach((t=>e[t.column_id]&&t.sync(e[t.column_id])))}},m=A(u.prototype,"columns",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),g=A(u.prototype,"permission",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A(u.prototype,"swapNotes",[B.action],Object.getOwnPropertyDescriptor(u.prototype,"swapNotes"),u.prototype),A(u.prototype,"swapColumns",[B.action],Object.getOwnPropertyDescriptor(u.prototype,"swapColumns"),u.prototype),A(u.prototype,"removeColumnByIndex",[B.action],Object.getOwnPropertyDescriptor(u.prototype,"removeColumnByIndex"),u.prototype),A(u.prototype,"removeColumnById",[B.action],Object.getOwnPropertyDescriptor(u.prototype,"removeColumnById"),u.prototype),A(u.prototype,"addColumnToIndex",[B.action],Object.getOwnPropertyDescriptor(u.prototype,"addColumnToIndex"),u.prototype),A(u.prototype,"existingTaskIds",[B.computed],Object.getOwnPropertyDescriptor(u.prototype,"existingTaskIds"),u.prototype),A(u.prototype,"canWrite",[B.computed],Object.getOwnPropertyDescriptor(u.prototype,"canWrite"),u.prototype),u),L=(b=A((h=class{constructor(e,t){let{notes:i,...n}=e;F(this,"notes",b,this),F(this,"column_name",v,this),F(this,"column_color",_,this),M(this,"board_id",void 0),M(this,"column_id",void 0),M(this,"column_order",void 0),M(this,"board",void 0),(0,B.makeObservable)(this),this.board=t,this.notes=(null==i?void 0:i.map((e=>{const t=new $(e,this);return this.board.notes_map.set(parseInt(t.data.note_id),t),t})))||[],this.setValues(n)}setValues(e){let{column_name:t,board_id:i,column_id:n,column_order:r,column_color:s}=e;this.column_name=t,this.board_id=i,this.column_id=n,this.column_order=r,this.column_color=s}data(){return{column_id:this.column_id,column_name:this.column_name,column_color:this.column_color,board_id:this.board_id}}save(e){this.column_name=e.column_name,this.column_color=e.column_color,(0,T.SC)("projectBoard/saveColumn",{method:"POST",data:this.data()},(0,B.action)((e=>{e&&this.setValues(e)})))}addNote(e,t){e.column_id=this.column_id,t=t>=0?t:this.notes.length,this.addNoteToIndex(t,new $({loading:!0},this)),(0,T.SC)("projectBoard/saveNewNote",{method:"POST",data:e},(e=>{this.notes[t]=new $(e,this),this.board.notes_map.set(parseInt(e.note_id),this.notes[t])}))}removeNoteByIndex(e){const t=this.notes[e];return this.notes=[...this.notes.slice(0,e),...this.notes.slice(e+1)],t}removeNoteByNoteID(e){const t=this.notes.find((t=>t.data.note_id===e));return this.notes=this.notes.filter((t=>t.data.note_id!==e)),t}addNoteToIndex(e,t){t.column=this,t.data.column_id=this.column_id,this.notes=[...this.notes.slice(0,e),t,...this.notes.slice(e)]}get existingTaskIds(){return this.notes.map((e=>(0,P.B5)(e.data.task_id))).filter((e=>!!e))}selectedNoteIds(){return this.notes.filter((e=>e.checked)).map((e=>(0,P.B5)(e.data.note_id))).filter((e=>!!e))}removeSelectedNotes(){this.notes=this.notes.filter((e=>!e.checked))}delete(){(0,T.SC)("projectBoard/deleteColumn",{method:"POST",data:{column_id:this.column_id}},(()=>{this.board.removeColumnById(this.column_id)}))}get canWrite(){return this.board.canWrite}sync(e){const t=Object.keys(e);this.notes=this.notes.filter((e=>t.includes(""+e.data.note_id))),this.notes.forEach((t=>t.sync(e[t.data.note_id]))),this.notes=[...this.notes.sort(((e,t)=>e.data.note_order-t.data.note_order))]}empty(){const e=this.notes.map((e=>parseInt(e.data.note_id)));(0,T.SC)("projectBoard/deleteNotes",{method:"POST",data:{note_ids:e}},(0,B.action)((()=>{this.notes=[]})))}}).prototype,"notes",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=A(h.prototype,"column_name",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=A(h.prototype,"column_color",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),A(h.prototype,"save",[B.action],Object.getOwnPropertyDescriptor(h.prototype,"save"),h.prototype),A(h.prototype,"removeNoteByIndex",[B.action],Object.getOwnPropertyDescriptor(h.prototype,"removeNoteByIndex"),h.prototype),A(h.prototype,"removeNoteByNoteID",[B.action],Object.getOwnPropertyDescriptor(h.prototype,"removeNoteByNoteID"),h.prototype),A(h.prototype,"addNoteToIndex",[B.action],Object.getOwnPropertyDescriptor(h.prototype,"addNoteToIndex"),h.prototype),A(h.prototype,"existingTaskIds",[B.computed],Object.getOwnPropertyDescriptor(h.prototype,"existingTaskIds"),h.prototype),A(h.prototype,"removeSelectedNotes",[B.action],Object.getOwnPropertyDescriptor(h.prototype,"removeSelectedNotes"),h.prototype),A(h.prototype,"canWrite",[B.computed],Object.getOwnPropertyDescriptor(h.prototype,"canWrite"),h.prototype),h),$=(y=A((f=class{constructor(e,t){F(this,"data",y,this),M(this,"column",void 0),F(this,"checked",w,this),(0,B.makeObservable)(this),this.data=e||{},this.column=t}get loading(){return!!this.data.loading}get title(){return this.data.task_id?this.data.task_title:this.data.note_content}get canWrite(){return this.column.canWrite}save(e){this.data.note_content=e.note_content,(0,T.SC)("projectBoard/saveNote",{method:"POST",data:{note_id:this.data.note_id,note_content:e.note_content}})}toggleCheck(){this.checked=!this.checked}get isChecked(){return this.checked}sync(e){e.task_id?this.data=e:(this.data.note_order=e.note_order,this.data.note_content=e.note_content)}}).prototype,"data",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=A(f.prototype,"checked",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A(f.prototype,"canWrite",[B.computed],Object.getOwnPropertyDescriptor(f.prototype,"canWrite"),f.prototype),A(f.prototype,"isChecked",[B.computed],Object.getOwnPropertyDescriptor(f.prototype,"isChecked"),f.prototype),f),V=(x=class{constructor(e){F(this,"foundTasks",k,this),F(this,"term",Z,this),F(this,"filters",C,this),F(this,"searching",S,this),M(this,"handle",0),M(this,"canWrite",!0),M(this,"store",void 0),(0,B.makeObservable)(this),this.store=e}updateTerm(e){this.term=e,this.search()}search(){if(clearTimeout(this.handle),!this.term&&!Object.keys(this.filters).length)return this.searching=!1,void(this.foundTasks=[]);this.handle=setTimeout((()=>{this.searching=!0;let e=(0,B.toJS)(this.filters);e.term=this.term,e.exclude=this.store.board.existingTaskIds.join(","),(0,T.SC)("tasks/search2",{data:{filters:e}},(e=>{var t;this.searching&&(this.searching=!1,this.foundTasks=(null==e||null===(t=e.map)||void 0===t?void 0:t.call(e,(e=>this.fakeNote(e))))||[])}))}),1e3)}addMatchingToFirstCol(){let e=(0,B.toJS)(this.filters);if(e.term=this.term,e.exclude=this.store.board.existingTaskIds.join(","),!e.term&&0===Object.keys(e).filter((e=>!["term","exclude"].includes(e))).length)return;const t=this.store.board.firstColumn().column_id;(0,T.SC)("projectBoard/addMatchingToCol",{data:{filters:e,column_id:t},method:"POST"},(e=>{let[,t]=e;(0,R.qV)(lng("added %s tasks to column",t)),this.store.fetchBoard(this.store.current_board)}))}fakeNote(e){return new $(e,this)}setFilters(e){this.filters=e,D.X.set("board_filters",e),this.search()}get tasks(){return this.foundTasks.filter((e=>!this.store.board.existingTaskIds.includes(e.data.task_id)))}},k=A(x.prototype,"foundTasks",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Z=A(x.prototype,"term",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),C=A(x.prototype,"filters",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return D.X.get("board_filters")||{}}}),S=A(x.prototype,"searching",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A(x.prototype,"tasks",[B.computed],Object.getOwnPropertyDescriptor(x.prototype,"tasks"),x.prototype),x);var U,H,J,G,W,K,Y,Q,ee,te,ie,ne,re,se;function oe(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ae(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function le(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const ce=e=>{e.bookmarked=!e.bookmarked,(0,T.SC)("bookmarks",{method:"POST",data:{type:"task",id:e.task_id,delete:e.bookmarked?"0":"1"}})},de=(0,O.createContext)(null);let pe=(U=B.action.bound,J=le((H=class{constructor(e){let{nav:t}=e;oe(this,"ready",J,this),oe(this,"_tab",G,this),oe(this,"new_tasks",W,this),oe(this,"updated_tasks",K,this),oe(this,"my_tasks",Y,this),oe(this,"bookmark_tasks",Q,this),oe(this,"resolution_numbers",ee,this),oe(this,"recent_tasks",te,this),oe(this,"_view_tasks",ie,this),oe(this,"filterNsort",ne,this),ae(this,"_internalNav",!1),ae(this,"timestamp",void 0),ae(this,"group_image",void 0),ae(this,"task_statuses",[]),ae(this,"task_types",[]),ae(this,"task_custom_fields",[]),oe(this,"_views",re,this),oe(this,"_viewsForms",se,this),(0,B.makeObservable)(this),this.nav=t,this.fetch();const i=(0,P.Ds)((()=>this.updateNav()),500),n=()=>{this._internalNav||i()};(0,B.observe)(this.filterNsort.new,n),(0,B.observe)(this.filterNsort.updated,n),(0,B.observe)(this.filterNsort.my,n),(0,B.observe)(this.filterNsort.bookmarks,n),I.Nd.on("TaskUpdate",(e=>{var t;const i=null===(t=this.my_tasks)||void 0===t?void 0:t.find((t=>t.task_id==e.id));if(i){for(const[t,n]of Object.entries(e.task))Object.prototype.hasOwnProperty.call(i,t)&&(0,B.set)(i,t,n);this.exeView()}})),this.boardStore||(this.boardStore=new q({nav:(e,t)=>this.nav(["board",...e],t),tStore:this}))}fetch(){this.ready=!1;const e=(D.X.get("recent_tasks_"+Blsm.user.id)||[]).join(",");(0,T.SC)("tasks/page",{data:{recent_tasks:e}},(0,B.action)((e=>{["new_tasks","updated_tasks","my_tasks","bookmark_tasks","bookmarked_boards","recent_tasks","resolution_numbers","timestamp","group_image","task_statuses","task_types","task_custom_fields"].forEach((t=>this[t]=e[t]||[])),this._views=e.views,this.boardStore&&this.boardStore.bookmarked_boards.replace(e.bookmarked_boards.map((e=>e.object_id))),this.ready=!0})))}refresh(){(0,T.SC)("tasks/page",{data:{t:this.timestamp,idCheck:this.gatherTaskIds()}},(e=>{this.timestamp=e.timestamp;for(const i of["new_tasks","updated_tasks","my_tasks","bookmark_tasks"]){var t;if(null!==(t=e[i])&&void 0!==t&&t.length)for(const t of e[i])t.shownAt=this.timestamp,this.removeTaskFromList(i,t.task_id),t.relevant&&this[i].unshift(t)}}))}removeTaskFromList(e,t){this[e].remove(this[e].find((e=>e.task_id==t)))}get tabs(){var e,t,i;const n=[{val:"my",label:lng("assigned to me",{phrase:!0}),icon:"user_empty"},(null===(e=this.new_tasks)||void 0===e?void 0:e.length)>0&&{val:"new",label:lng("new"),icon:"fresh"},(null===(t=this.updated_tasks)||void 0===t?void 0:t.length)>0&&{val:"updated",label:lng("updated"),icon:"task-updated"},(null===(i=this.recent_tasks)||void 0===i?void 0:i.length)>0&&{val:"recent",label:lng("recently entered"),icon:"clock"},{val:"bookmarks",label:lng("bookmarks"),icon:"bookmark"}];if(1===parseInt(Blsm.user.preferences.show_project_boards)){var r;const e={val:"board",label:lng("boards"),icon:"canban"},t=(null===(r=this.bookmarked_boards)||void 0===r?void 0:r.map((e=>({val:e.object_id,label:e.board_name,icon:"canban",widget_order:e.widget_order}))))||[];(0,P.tq)()?[e,...t].forEach((e=>n.push(e))):n.push(Object.assign(e,{subTabs:t}))}if(Blsm.user.isPowerManager){var s;const e=(null===(s=this._views)||void 0===s?void 0:s.map((e=>({val:e.bookmark_id,label:e.bookmark_name,icon:"details",widget_order:e.widget_order}))))||[],t={val:"custom",label:lng("custom view"),icon:"details"};(0,P.tq)()?[t,...e].forEach((e=>n.push(e))):n.push(Object.assign(t,{subTabs:e}))}return n.filter((e=>e))}get tab(){const e=this.tabs.map((e=>e.val));return this._tab.includes("board")&&(0,P.B5)(this._tab.split("/")[1])||(0,P.B5)(this._tab)||this._tab&&e.includes(this._tab)?this._tab:e[0]}get tabData(){return this.tabs.find((e=>e.val===this.tab))}set tab(e){var t,i;(0,P.B5)(this._tab)&&(null===(t=this._view_tasks.get(this._tab))||void 0===t||null===(i=t.abortFetch)||void 0===i||i.call(t),this._view_tasks.set(this._tab,void 0),this._viewsForms.delete(this._tab));e.includes("board")&&(0,P.B5)(e.split("/")[1])&&(this.boardStore.current_board=e.split("/")[1]),this._tab=e,this.updateNav()}updateNav(){var e,t,i;if(this._internalNav)return;const n=(null===(e=this.filterNsort)||void 0===e?void 0:e[this.tab])||{},r={filters:(0,B.toJS)(n.filter),sort:null===(t=n.sort)||void 0===t?void 0:t.by,reverse:null!==(i=n.sort)&&void 0!==i&&i.desc?1:void 0};this.nav([this._tab,r],{replace:!0})}updateRoute(e){let[t,i]=e;"new_task"===t&&(location.replace(location.href.replace("/new_task","/")),(0,E.l)()),"board"===t&&(0,P.B5)(i)&&(t="board/"+i),this._tab=t||this._tab,this._tab.includes("board")?this.boardStore.updateRoute(i):this._updateFromUrl(i)}_updateFromUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._tab.includes("board"))return this.boardStore.updateRoute(e);const t={filter:e.filters||{},sort:{by:e.sort||"",desc:"1"===e.reverse}};this._internalNav=!0,this.filterNsort[this.tab]&&(0,B.set)(this.filterNsort[this.tab],t),this._internalNav=!1}get filteredNewTasks(){return(0,N.WB)(this.new_tasks,this.filterNsort.new.filter,this.filterNsort.new.sort)}get filteredUpdatedTasks(){return(0,N.WB)(this.updated_tasks,this.filterNsort.updated.filter,this.filterNsort.updated.sort)}get filteredMyTasks(){return(0,N.WB)(this.my_tasks.filter((e=>(0,P.Tz)(e.allocated_to))),this.filterNsort.my.filter,this.filterNsort.my.sort)}get filteredBookmarksTasks(){return(0,N.WB)(this.bookmark_tasks,this.filterNsort.bookmarks.filter,this.filterNsort.bookmarks.sort)}get tabsWithCounters(){return this.tabs.map((e=>{switch(e.val){case"new":e.badge=this.filteredNewTasks.length;break;case"recent":e.badge=this.recent_tasks.length;break;case"updated":e.badge=this.filteredUpdatedTasks.length;break;case"my":e.badge=this.filteredMyTasks.length;break;case"bookmarks":e.badge=this.filteredBookmarksTasks.length}return e}))}addToRecentTasks(e){let{task_id:t,task_title:i,task_resolution:n,status_name:r,assignee_name:s}=e;this.recent_tasks=this.recent_tasks.filter((e=>e.task_id!=t)),this.recent_tasks.unshift({task_id:t,task_title:i,task_resolution:n,status_name:r,assignee_name:s})}gatherTaskIds(){return{new_tasks:this.new_tasks.map((e=>e.task_id)).join("_"),updated_tasks:this.updated_tasks.map((e=>e.task_id)).join("_"),my_tasks:this.my_tasks.map((e=>e.task_id)).join("_"),bookmark_tasks:this.bookmark_tasks.map((e=>e.task_id)).join("_")}}exeView(){var e,t;const i=this._tab;null===(e=this._view_tasks.get(i))||void 0===e||null===(t=e.abortFetch)||void 0===t||t.call(e),this._view_tasks.set(i,(0,T.SC)("tasks/exec_view",{method:"POST",json:!0,data:this._viewParams()},(0,B.action)((e=>this._view_tasks.set(i,e)))))}get viewTasks(){const e=this._tab,t=this._view_tasks.get(e);return!t&&(0,P.B5)(e)&&(0,P.Y3)((()=>this.exeView())),t}saveView(e){var t;const i=this._tab;let n=null===(t=this._views.find((e=>e.bookmark_id===i)))||void 0===t?void 0:t.bookmark_name;n&&e&&(n+=" 2"),(0,z.cS)("",{title:lng("save view"),confirmText:lng("save").caps(),startValue:n,placeholder:lng("view name"),inputRequired:!0,onConfirm:t=>{const n=this._viewParams();(0,T.SC)("tasks/save_view",{method:"POST",json:!0,data:{params:n,id:e?"":i,name:t}},(r=>{const s={bookmark_id:r,bookmark_name:t,bookmark_url:JSON.stringify(n)};!e&&(0,P.B5)(i)?this._views[this._views.findIndex((e=>e.bookmark_id===i))]=s:(this._views.push(s),this.tab=r)}))}})}deleteView(){(0,z.BB)(lng("are you sure you want to delete this view?").caps(),{title:lng("delete view").caps(),onConfirm:()=>{const e=this._tab;(0,T.SC)("tasks/delete_view",{method:"POST",data:{id:e}}),this._views.remove(this._views.find((t=>t.bookmark_id===e)))}})}_viewParams(){const e=this.getViewForm(),t=e.form.buildFinalValues(),i=e.filterNsort;return Object.keys(i.filter).length&&(t.filter=Object.assign({},t.filter,i.filter)),i.sort.by&&(t.sort=i.sort),t}getViewForm(){const e=this._tab;if(this._viewsForms.has(e))return this._viewsForms.get(e);let t={};try{var i;const n=this._views.find((t=>t.bookmark_id===e));n&&(t=null!==(i=JSON.parse(n.bookmark_url))&&void 0!==i?i:{})}catch(e){}return this._viewsForms.set(e,{filterNsort:(0,N.Cy)((0,P.v7)(t.filter||{},((e,t)=>!["user","group","archive"].includes(t))),t.sort),form:new ue(t,this.task_custom_fields)}),this._viewsForms.get(e)}get extraFields(){const e=this.getViewForm().form.getValue("custom_fields");return e?this.task_custom_fields.filter((t=>e.includes(t.field_number))).map((e=>["field_"+e.field_number,e.field_name])):[]}get onUser(){const e=this.getViewForm().form.getValue("filter[user]");return 1===(null==e?void 0:e.length)?e[0]:null}}).prototype,"ready",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),G=le(H.prototype,"_tab",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),W=le(H.prototype,"new_tasks",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=le(H.prototype,"updated_tasks",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=le(H.prototype,"my_tasks",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=le(H.prototype,"bookmark_tasks",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=le(H.prototype,"resolution_numbers",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=le(H.prototype,"recent_tasks",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ie=le(H.prototype,"_view_tasks",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),ne=le(H.prototype,"filterNsort",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{new:(0,N.Cy)(),updated:(0,N.Cy)(),my:(0,N.Cy)(),bookmarks:(0,N.Cy)()}}}),re=le(H.prototype,"_views",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),se=le(H.prototype,"_viewsForms",[B.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Map}}),le(H.prototype,"tabs",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"tabs"),H.prototype),le(H.prototype,"tab",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"tab"),H.prototype),le(H.prototype,"tabData",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"tabData"),H.prototype),le(H.prototype,"updateRoute",[B.action],Object.getOwnPropertyDescriptor(H.prototype,"updateRoute"),H.prototype),le(H.prototype,"_updateFromUrl",[B.action],Object.getOwnPropertyDescriptor(H.prototype,"_updateFromUrl"),H.prototype),le(H.prototype,"filteredNewTasks",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"filteredNewTasks"),H.prototype),le(H.prototype,"filteredUpdatedTasks",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"filteredUpdatedTasks"),H.prototype),le(H.prototype,"filteredMyTasks",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"filteredMyTasks"),H.prototype),le(H.prototype,"filteredBookmarksTasks",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"filteredBookmarksTasks"),H.prototype),le(H.prototype,"tabsWithCounters",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"tabsWithCounters"),H.prototype),le(H.prototype,"addToRecentTasks",[B.action],Object.getOwnPropertyDescriptor(H.prototype,"addToRecentTasks"),H.prototype),le(H.prototype,"exeView",[U],Object.getOwnPropertyDescriptor(H.prototype,"exeView"),H.prototype),le(H.prototype,"viewTasks",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"viewTasks"),H.prototype),le(H.prototype,"extraFields",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"extraFields"),H.prototype),le(H.prototype,"onUser",[B.computed],Object.getOwnPropertyDescriptor(H.prototype,"onUser"),H.prototype),H);class ue extends j.I{constructor(e,t){super(),this.buildFields(e,t)}buildFields(e,t){const i=this._customFieldsPrep(t,{columns:3,visible:(e,t)=>{var i;return null===(i=e.get("custom_fields"))||void 0===i?void 0:i.includes(t.replace("field_",""))}});this._fields=[{type:"multiple_items",name:"filter[user]",label:lng("select assignee"),inline:!0,theme:"bright",searchData:(e,t)=>{let{ids:i,term:n}=e;(0,T.SC)("ajax/UsersAjax.class.php",{method:"POST",data:{req:"AutoComplete",term:n||"",id:i||"",limit:!i&&null}},t)}},{type:"multiple_items",name:"filter[group]",label:lng("select workspace"),inline:!0,theme:"bright",searchData:(e,t)=>{const i=this.values.get("group"),n=i&&Array.from(i.values()).map((e=>e.id));(0,T.SC)("groups/autocomplete",{method:"POST",json:!0,data:{managed_perm:Blsm.ManagerPermissions.VIEW,member:1,owned:1,term:e.term||"",id:e.ids||"",limit:e.ids?null:10,exclude:n}},t)}},{type:"checkbox",name:"filter[archive]",label:lng("show archive")},t.length>0&&{type:"select_multi",name:"custom_fields",options:t.map((e=>({val:e.field_number,label:e.field_name}))),label:lng("custom fields")},{type:"section",title:lng("custom fields"),titleSmall:!0,id:"custom_fields_section",fields:i}],this._prepFields(e)}}},421:(e,t,i)=>{i.d(t,{J:()=>Di});var n,r,s,o,a,l,c,d,p,u,m,g,h,b=i(7821),v=i(8e3),_=i(5007),f=i(5832),y=i(8318);function w(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function x(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function k(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Z=(n=b.action.bound,r=b.action.bound,s=b.action.bound,a=k((o=class{constructor(){let{assignment_id:e,question:t,choices:i,answered:n,results:r,due_date:s,past:o,assignment_options:v,assignment_owner:_}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0;x(this,"workspaceStore",null),w(this,"assignment_id",a,this),w(this,"assignment_owner",l,this),w(this,"question",c,this),w(this,"choices",d,this),w(this,"due_date",p,this),w(this,"assignment_options",u,this),w(this,"past",m,this),w(this,"answered",g,this),w(this,"results",h,this),(0,b.makeObservable)(this),Object.assign(this,{assignment_id:e,question:t,answered:n,due_date:s,past:o,assignment_options:v,assignment_owner:_,workspaceStore:f}),this.choices.replace(i),Array.isArray(r)&&this.results.replace(r)}vote(e){this.answered=e,this.results[e]++,(0,v.SC)("poll",{method:"POST",data:{id:this.assignment_id,answer:e}})}save(e,t){this.assignment_id?(0,v.SC)("poll/id="+this.assignment_id,{method:"POST",data:e},(()=>{Object.assign(this,(0,y.ei)(e,["question","assignment_options","due_date"])),this.choices.replace(Object.values(e.choices));let i=this.results.length;this.results.length=this.choices.length,this.results.fill(0,i,this.results.length),null==t||t()})):(0,v.SC)("poll/group="+e.group_id,{method:"POST",data:e},(i=>{Object.assign(this,(0,y.ei)(e,["question","assignment_options","due_date"]),(0,y.ei)(i,["assignment_id","assignment_type","assignment_owner","creation_time"])),this.choices.replace(Object.values(e.choices)),this.results.length=this.choices.length,this.results.fill(0),null==t||t()}))}delete(e){(0,v.SC)("poll",{method:"DELETE",data:{ids:e}})}get isAnswered(){return null!==this.answered&&void 0!==this.answered}get mayEdit(){let e=!1;return((0,y.Tz)(this.assignment_owner)||Blsm.user.isPowerManager||this.workspaceStore.permissions&&this.workspaceStore.permissions[Blsm.ManagerPermissions.CREATE_ASSIGNMENTS])&&(e=!0),e}}).prototype,"assignment_id",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),l=k(o.prototype,"assignment_owner",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=k(o.prototype,"question",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d=k(o.prototype,"choices",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=k(o.prototype,"due_date",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),u=k(o.prototype,"assignment_options",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),m=k(o.prototype,"past",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=k(o.prototype,"answered",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=k(o.prototype,"results",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k(o.prototype,"vote",[n],Object.getOwnPropertyDescriptor(o.prototype,"vote"),o.prototype),k(o.prototype,"save",[r],Object.getOwnPropertyDescriptor(o.prototype,"save"),o.prototype),k(o.prototype,"delete",[s],Object.getOwnPropertyDescriptor(o.prototype,"delete"),o.prototype),k(o.prototype,"isAnswered",[b.computed],Object.getOwnPropertyDescriptor(o.prototype,"isAnswered"),o.prototype),o);var C,S,O,B,T=i(9934),N=i(8567),I=i(6401),D=i(2115),j=i(7327),P=i(7659),z=i(8116),E=i(2906);function R(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function F(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function M(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let A=(C=class e extends E.JH{constructor(t,i){super(t),F(this,"workspace",void 0),F(this,"parent_unit",void 0),R(this,"active",S,this),R(this,"countItems",O,this),R(this,"sub_units",B,this),(0,b.makeObservable)(this),this.workspace=null==i?void 0:i.workspace,this.parent_unit=null==i?void 0:i.parent_unit,!this.parent_unit&&t.sub_units&&(this.sub_units=t.sub_units.map((t=>new e(t,{workspace:this.workspace,parent_unit:this}))))}get unit_id(){return parseInt(this._attr.unit_id)}get name(){return this._attr.unit_name}activate(){var e;this.active=!0,null===(e=this.parent_unit)||void 0===e||e.activate()}deactivate(){var e;this.active=!1,null===(e=this.parent_unit)||void 0===e||e.deactivate()}set count(e){this.countItems=e}get count(){return this.countItems}get fullCount(){return this.sub_units.reduce(((e,t)=>e+t.count),this.countItems)}get isCompleted(){if(!this.sub_units)return this.completed;const e=this.sub_units.length>0&&this.sub_units.every((e=>e.completed));return this.parent_unit?this.completed||e:(0===this.countItems||this.completed)&&e}},S=M(C.prototype,"active",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=M(C.prototype,"countItems",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),B=M(C.prototype,"sub_units",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),M(C.prototype,"activate",[b.action],Object.getOwnPropertyDescriptor(C.prototype,"activate"),C.prototype),M(C.prototype,"deactivate",[b.action],Object.getOwnPropertyDescriptor(C.prototype,"deactivate"),C.prototype),M(C.prototype,"count",[b.computed],Object.getOwnPropertyDescriptor(C.prototype,"count"),C.prototype),M(C.prototype,"fullCount",[b.computed],Object.getOwnPropertyDescriptor(C.prototype,"fullCount"),C.prototype),M(C.prototype,"isCompleted",[b.computed],Object.getOwnPropertyDescriptor(C.prototype,"isCompleted"),C.prototype),C);var q=i(4210),X=i(6920),L=i(5944);function $(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class V extends q.I{constructor(e){let{patient:t,caseId:i,...n}=e;super(n),$(this,"patient",null),this.caseId=i,this.title=lng("send message to '%s'",`${t.patient_first_name} ${t.patient_last_name}`).caps(),this._fields=[{visible:!t.patient_phone,type:"component",node:(0,L.tZ)("b",{style:{color:X.g.colors.negative},children:lng("patient phone number not specified").caps()})},{type:"text",name:"subject",label:lng("subject"),required:!0},{type:"richtext",name:"message",label:lng("message"),required:!0}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("patient/create_communication",Object.assign({case_id:this.caseId},e))}}var U=i(8989),H=i(2334),J=i(8904),G=i(441),W=i(7363),K=i(5560),Y=i(676),Q=i(9180),ee=i(9793),te=(i(7882),i(3205)),ie=i(8534);function ne(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class re extends q.I{constructor(e){super(e),ne(this,"attendanceUsers",void 0),ne(this,"assignmentId",void 0),ne(this,"groupId",void 0),this.groupId=e.groupId,this.assignmentId=e.assignmentId,this.attendanceUsers=e.attendanceUsers,this.saveUrl="users/verify_password",this.title=lng("approve attendance").caps(),this.confirmButtonLabel=lng("approve attendance").caps(),this._fields=[{type:"component",node:(0,L.tZ)("b",{children:lng("check-in users will no longer be able to mark self-attendance once attendance has been confirmed.").caps()})},{type:"textarea",name:"optional_text"},Blsm.InitialData.parameters.kiosk_approve_meeting_attendance_signature&&{type:"signpad",name:"signature",required:!0,label:lng("signature")},{type:"password",name:"password",label:lng("type your password to confirm"),required:!0}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,Object.assign(e))}SaveSuccess(e){if(e.pass){const e=this.values.get("optional_text"),t=this.values.get("password"),i=this.values.get("signature"),n=Object.assign({optional_text:e,password:t,signature:i,assignment:this.assignmentId,group:this.groupId},this.attendanceUsers);(0,v.SC)("meetings/approve_attendance",{method:"POST",data:n},(()=>{(0,ie.qV)(lng("attendance approved")),(0,_.vm)().closeDialog()}))}else(0,ie.Mj)(lng("wrong password")),this.status=""}}var se,oe,ae,le=i(9637),ce=i(5940),de=i(409);function pe(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function ue(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function me(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let ge=(se=class extends q.I{constructor(e){super(e),ue(this,"assignmentId",null),ue(this,"groupId",null),ue(this,"assignmentUsers",[]),pe(this,"showApproveForm",oe,this),pe(this,"allowSetAttendance",ae,this),(0,b.makeObservable)(this),this.groupId=e.data.groupId,this.assignmentId=e.data.assignmentId,this.successMessage=lng("attendance saved"),(0,v.SC)("meetings/edit_attendance",{data:{group:this.groupId,assignment:this.assignmentId}},(e=>{var t;this.allowSetAttendance=Blsm.user.isPowerManager||!e.approve_attendance,this.assignmentUsers=(null==e||null===(t=e.assignment_users)||void 0===t?void 0:t.map((e=>(e[1].disabled=!this.allowSetAttendance,new T.o(e[1],e[1].completed)))))||this.assignmentUsers,this.buildFields(e)}))}buildFields(e){this.title=`${lng("attendance:")} ${e.assignment_name}`,this.saveUrl="meetings/save_attendance/",this.headExtra=(0,L.tZ)(ee.b,{children:Blsm.InitialData.parameters.kiosk_approve_meeting_attendance&&(0,L.tZ)(ce.zx,{onClick:()=>{e.approve_attendance?(0,N.qR)((0,L.tZ)(be,{approve_attendance:e.approve_attendance}),{title:lng("attendance approving details").caps()}):this.showApproveForm=!0},children:e.approve_attendance?lng("approved by").caps()+" "+e.approve_attendance.approver_name:lng("approve attendance").caps()})}),this._fields=[{type:"component",node:(0,L.tZ)(Q.qm,{dateNote:{start:e.start_date,end:e.due_date}})},{type:"component",name:"attendance[]",node:(0,L.tZ)(ve,{assignmentUsers:this.assignmentUsers,allowSetAttendance:this.allowSetAttendance})},{type:"component",node:(0,L.tZ)(he,{assignmentUsers:this.assignmentUsers,groupId:this.groupId,assignmentId:this.assignmentId,onClose:()=>this.showApproveForm=!1}),visible:()=>this.showApproveForm}],this._prepFields(),this.ready=!0}save(){const e={};this.assignmentUsers.forEach((t=>{t._checked&&(e[`user_${t.user_id}`]="1")})),this.saveToUrl(this.saveUrl+(0,y.$t)({group:this.groupId,assignment:this.assignmentId}),{attendance:e})}},oe=me(se.prototype,"showApproveForm",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ae=me(se.prototype,"allowSetAttendance",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),se);const he=(0,K.observer)((function(e){let{onClose:t,assignmentUsers:i,assignmentId:n,groupId:r}=e;const s={};i.forEach((e=>{e._checked&&(s[`attendance[user_${e.user_id}]`]="1")}));const o=(0,W.useRef)(new re({attendanceUsers:s,assignmentId:n,groupId:r})).current;return(0,L.tZ)(te.l,{form:o,internalForm:!0,onClose:t})})),be=e=>{let{approve_attendance:t}=e;const{approver_name:i,text:n,time:r}=t;return(0,L.BX)("div",{children:[lng("approved by").caps(),": ",i," ",lng("at|date")," ",(0,L.tZ)(Q.qp,{time:r}),(0,L.tZ)("br",{}),lng("approver note").caps(),":",(0,L.tZ)("br",{}),(0,L.tZ)("div",{dangerouslySetInnerHTML:{__html:n}})]})},ve=(0,K.observer)((function(e){let{assignmentUsers:t,allowSetAttendance:i}=e;const n=["employee_id","external_id","user_identity_num"].filter((e=>{var i;return void 0!==(null===(i=t[0])||void 0===i?void 0:i[e])})),r=[{title:lng("first name")},{title:lng("last name")}];n.forEach((e=>r.push({title:(0,de.X)(e)}))),r.push({checkAll:i});for(const e in t)t[e].search_data=Object.values(t[e]).join(" ");const s=(0,K.observer)((function(e){let{row:t}=e;const{user_first_name:r,user_last_name:s}=t;return(0,L.BX)("tr",{children:[(0,L.tZ)("td",{children:r}),(0,L.tZ)("td",{children:s}),n.map((e=>(0,L.tZ)("td",{children:t[e]},e))),(0,L.tZ)(le.Fo,{o:t,disabled:!i})]})}));return(0,L.tZ)(Y.iA,{cols:r,collection:t,rowIdCol:"user_id",loading:null===t,filters:[{name:"search_data",label:lng("search"),type:"text",outOfMenu:!0}],RowRenderer:s,noWindow:!0,compact:!0})}));var _e=i(7392);function fe(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ye extends q.I{constructor(e){super(e),fe(this,"meetingsIds",[]),fe(this,"eventIds",[]),fe(this,"countDates",0),this._fields=(0,b.observable)([]),this.meetingsIds=e.meetingsIds||this.meeting,this.eventIds=e.eventIds||this.eventIds,this.title=this.eventIds.length>0?lng("duplicate event").caps():lng("duplicate meetings").caps(),this.saveUrl="meetings/duplicate",this.successMessage=lng("meetings duplicated"),this._fields.push({type:"hidden",name:"ids[meetings]",value:this.meetingsIds},{type:"hidden",name:"ids[events]",value:this.eventIds},{type:"checkbox",name:"sendMailToUsers",label:lng("send users notification about the meeting")+" ("+lng("only for meetings")+")"},{type:"row_set",fields:[{type:"date",name:`dates[${this.countDates}]`,label:lng("duplicate to date"),required:!0,grow:10},{type:"component",node:(0,L.tZ)(_e.l,{theme:"contained",onClick:()=>this.addDateField(),children:lng("add date").caps()})}]}),this._prepFields(),this.ready=!0}addDateField(){this.countDates++,this._fields.push({type:"date",name:`dates[${this.countDates}]`,label:lng("duplicate to date")})}save(e){this.saveToUrl(this.saveUrl,Object.assign(e))}}var we=i(8595);function xe(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ke extends q.I{constructor(e){super(e),xe(this,"group_id",void 0),this.group_id=e.group_id,this.title=lng("set item for sale").caps(),this.successMessage=lng("item sale data saved"),(0,v.SC)("groups/sale_data/group_id="+this.group_id,{},(e=>this.buildFields(e)))}buildFields(e){this._fields=[{type:"number",name:"price",label:lng("price"),min:0,step:"0.01",helpKey:"@price_tag",required:!0},{type:"select",name:"currency",label:lng("currency"),options:[["USD",lng("USD")],["ILS",lng("ILS")],["BRL",lng("BRL")]]}],this._prepFields(e),this.ready=!0}save(e){this.saveToUrl("groups/save_sale_data",Object.assign({group_id:this.group_id},e))}}var Ze=i(101),Ce=i(9489),Se=i(4401),Oe=i(8297),Be=i(8246),Te=i(6975);function Ne(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class Ie extends q.I{constructor(e){super(e),Ne(this,"groupId",void 0),this.groupId=e.groupId,this.title=lng("import meeting attendance").caps(),this.saveUrl="meetings/import_attendance",this.confirmButtonLabel=lng("import"),this.successMessage=lng("meeting attendance imported successfully");const t=Blsm.prm.Mainref+`api?meetings/import_attendance_excel_template/group=${this.groupId}`;this._fields=[{type:"component",node:(0,L.BX)("div",{children:[(0,L.tZ)(G.A,{theme:"highlight",href:t.csrf(),children:lng("template download").caps()}),(0,L.tZ)(Te.JO,{icon:"menu_info",toolTip:lng('to mark attendance type 1 in the "attended" column and leave it empty to signify non-attendance')})]})},{type:"file",name:"meeting_attendance_excel",label:lng("data upload")}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,Object.assign({group_id:this.groupId},e)),(0,_.vm)().closeDialog()}SaveSuccess(){}}var De=i(7138),je=i(6421);class Pe extends De.U{constructor(e){super({...e,baseRoute:"meetings"}),this.group_id=e.group_id,this.event_ids=e.event_ids,this.saveUrl="assignment/save_multi_meetings"}createAttributes(){this.attributes=[{name:"start_date",type:"date",label:lng("start date"),required:!0},{name:"location",type:"text",label:lng("location")},{name:"meeting_gathering_area",type:"text",label:lng("gathering area")},{name:"meeting_audience",type:"text",label:lng("audience")},{name:"meeting_category",type:"single_item",label:lng("proficiency category"),searchData:(e,t)=>{(0,v.SC)("assignment/get_categories",{},t)}},{name:"instructors",type:"multiple_items",label:lng("instructors"),theme:"bright",valueIsMap:!0,objectKeys:["resource_id","sequence_id"],required:!0,searchData:(e,t)=>{(0,v.SC)("meetings/search_instructors",{data:{term:e.term}},t)},buttons:[{Render:ze,onChange:(e,t)=>{let{amount_in_use:i}=t;return void 0!==i&&(e.amount_in_use=i),e}}]},{name:"clear_instructors",type:"checkbox",label:lng("clear existing instructors")},{type:"multiple_items",name:"resources",label:lng("select resources"),poster:!0,theme:"bright",valueIsMap:!0,objectKeys:["resource_id","label","amount_in_use","resource_category","note"],required:!0,searchData:(e,t)=>{(0,v.SC)("resources/search_resource",{data:{req:"AutoComplete",by_id:e.ids,term:e.term,matches_only:!0}},t)},buttons:[{Render:ze,onChange:(e,t)=>{let{amount_in_use:i}=t;return void 0!==i&&(e.amount_in_use=i),e}}]},{name:"clear_resources",type:"checkbox",label:lng("clear existing resources")}]}save(e){this.saveToUrl(this.saveUrl,Object.assign({group_id:this.group_id,ids:this.ids,event_ids:this.event_ids},e))}}const ze=e=>{let{item:t,onChange:i}=e;return(0,L.tZ)(je.I,{inline:!0,minimalist:!0,skinny:!0,wrapped:!0,type:"number",min:"1",value:t.amount_in_use,onChange:e=>i({amount_in_use:e})})};var Ee,Re=i(5519);let Fe=(Ee=class extends q.I{constructor(e){super(e),this.title=lng("send invitations"),this.confirmButtonLabel=lng("send").caps(),this.status=1;const t=(0,b.action)((()=>{this.values.get("sendMailToUsers")||this.values.get("sendMailToResources")?this.status=null:this.status=1}));this._fields=[{type:"hidden",name:"ids"},{type:"hidden",name:"invite_only"},{type:"hidden",name:"group_id"},{type:"component",Render:Re.R9,label:lng("the notification will be sent for future meetings.").caps(),bold:!0},{type:"checkbox",name:"sendMailToUsers",label:lng("send users an email invitation"),onValueChange:t},{type:"checkbox",name:"sendMailToResources",label:lng("send instructors and resources an email invitation"),onValueChange:t}],this._prepFields({ids:e.ids,invite_only:1,group_id:e.ws}),this.ready=!0}save(e){this.saveToUrl("assignment/save_meetings",e)}SaveSuccess(){(0,ie.qV)(lng("invitations sent")),(0,_.vm)().closeDialog()}get dirty(){return!1}},Me=Ee.prototype,Ae="dirty",qe=[b.override],Xe=Object.getOwnPropertyDescriptor(Ee.prototype,"dirty"),Le=Ee.prototype,$e={},Object.keys(Xe).forEach((function(e){$e[e]=Xe[e]})),$e.enumerable=!!$e.enumerable,$e.configurable=!!$e.configurable,("value"in $e||$e.initializer)&&($e.writable=!0),$e=qe.slice().reverse().reduce((function(e,t){return t(Me,Ae,e)||e}),$e),Le&&void 0!==$e.initializer&&($e.value=$e.initializer?$e.initializer.call(Le):void 0,$e.initializer=void 0),void 0===$e.initializer&&(Object.defineProperty(Me,Ae,$e),$e=null),Ee);var Me,Ae,qe,Xe,Le,$e;class Ve extends q.I{constructor(e){super(e),this.title=lng("absent members message").caps(),this.saveUrl="meetings/absent_members_message",this.confirmButtonLabel=lng("send message").caps(),this.successMessage=lng("absent members message was sent"),(0,v.SC)("meetings/absent_members_message",{data:e},(e=>{this._fields=[{type:"multiple_items",name:"members",label:lng("members that did not attend at least one of the selected meetings").caps(),theme:"bright",poster:!0,valueIsMap:!0,required:!0},{type:"system_message",name:"custom_message",label:lng("select custom message")+" ("+lng("leave empty for default message")+")",messageType:"unattended_member_notice",placeholder:lng("default message").caps(),mod:["","ENT"]},{type:"checkbox",name:"whatsapp",label:lng("also send WhatsApp matching message"),insert:Blsm.InitialData.special.whatsapp}],this._prepFields(e),this.ready=!0}))}save(e){const t={...this.params};t.options={...e},delete t.options.members,t.members=Object.values(e.members).map((e=>e.id)),t.members.length&&(this.saveToUrl("meetings/send_absent_members_message",t),(0,_.vm)().closeDialog())}SaveSuccess(){}}var Ue,He,Je,Ge,We,Ke,Ye,Qe,et,tt,it,nt,rt,st,ot,at,lt,ct,dt,pt,ut,mt,gt,ht,bt,vt,_t,ft,yt,wt,xt,kt,Zt,Ct,St,Ot,Bt,Tt,Nt,It,Dt,jt,Pt,zt,Et,Rt,Ft,Mt,At,qt,Xt,Lt,$t,Vt,Ut,Ht,Jt,Gt,Wt,Kt,Yt,Qt,ei,ti,ii,ni,ri,si,oi,ai,li,ci,di,pi,ui,mi,gi,hi,bi,vi,_i,fi,yi,wi,xi,ki,Zi,Ci,Si,Oi=i(7675),Bi=i(3634);function Ti(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Ni(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ii(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let Di=(Ue=b.action.bound,He=b.action.bound,Je=b.action.bound,Ge=b.action.bound,We=b.action.bound,Ke=b.action.bound,Ye=b.action.bound,Qe=b.action.bound,et=b.action.bound,tt=b.action.bound,it=b.action.bound,nt=b.action.bound,rt=b.action.bound,st=b.action.bound,ot=b.action.bound,at=b.action.bound,lt=b.action.bound,ct=b.action.bound,dt=b.action.bound,pt=b.action.bound,ut=b.action.bound,mt=b.action.bound,gt=b.action.bound,ht=b.action.bound,bt=b.action.bound,vt=b.action.bound,_t=b.action.bound,ft=class{constructor(e){let{id:t,nav:i}=e;Ti(this,"ready",yt,this),Ti(this,"_tab",wt,this),Ti(this,"display_message",xt,this),Ni(this,"tabs",[]),Ni(this,"lastBackTab",""),Ti(this,"managersLoaded",kt,this),Ti(this,"membersLoaded",Zt,this),Ti(this,"waitingListLoaded",Ct,this),Ti(this,"activeCalendarDate",St,this),Ti(this,"warnings",Ot,this),Ni(this,"features",{}),Ti(this,"active_unit",Bt,this),Ti(this,"active_unit_id",Tt,this),Ti(this,"activeBlog",Nt,this),Ti(this,"showRatingSurvey",It,this),Ni(this,"group_id",""),Ni(this,"group_name",""),Ni(this,"group_description",""),Ni(this,"group_type",""),Ni(this,"group_invisible",""),Ni(this,"status",null),Ni(this,"users_count",0),Ni(this,"is_course",null),Ni(this,"group_image",""),Ti(this,"group_options",Dt,this),Ni(this,"classification_name",""),Ni(this,"categoriesTree",{}),Ni(this,"sequence_id",null),Ni(this,"qual_top_name",null),Ni(this,"qual_top_id",null),Ti(this,"qual_list",jt,this),Ni(this,"required_courses",null),Ni(this,"syllabus_file",null),Ni(this,"syllabus_text",null),Ni(this,"syllabus_url",null),Ni(this,"rating",null),Ni(this,"owner_options",{}),Ni(this,"display_condition_components",null),Ni(this,"is_member",!1),Ti(this,"is_owner",Pt,this),Ti(this,"is_manager",zt,this),Ni(this,"can_create_instance",!1),Ni(this,"permissions",{}),Ni(this,"manager",null),Ni(this,"patient",null),Ni(this,"user_scores",{}),Ni(this,"scoring_details",{}),Ni(this,"arrived_to_meetings",{}),Ni(this,"manager_permission_types",{}),Ni(this,"default_manager_setting",void 0),Ni(this,"default_permissions",void 0),Ti(this,"waitingList",Et,this),Ti(this,"assignments",Rt,this),Ti(this,"_managers",Ft,this),Ti(this,"_waiting_list",Mt,this),Ti(this,"_members",At,this),Ti(this,"registeredUsers",qt,this),Ti(this,"allowedUserFields",Xt,this),Ni(this,"usersCustomFieldsNames",[]),Ti(this,"schedule",Lt,this),Ti(this,"planning",$t,this),Ti(this,"contents",Vt,this),Ti(this,"portal_id",Ut,this),Ti(this,"discussions",Ht,this),Ti(this,"blog",Jt,this),Ti(this,"polls",Gt,this),Ti(this,"tasks",Wt,this),Ti(this,"_loading_tasks",Kt,this),Ni(this,"_archive_tasks_loaded",!1),Ti(this,"tasks_stats",Yt,this),Ti(this,"_reports",Qt,this),Ti(this,"reportsLoaded",ei,this),Ti(this,"likes",ti,this),Ti(this,"userVote",ii,this),Ti(this,"bookmark_id",ni,this),Ti(this,"units",ri,this),Ti(this,"componentsView",si,this),Ti(this,"patients_communication",oi,this),Ti(this,"tasks_filterNsort",ai,this),Ti(this,"planning_filterNsort",li,this),Ti(this,"discussions_blogs_filterNsort",ci,this),Ti(this,"components_filterNsort",di,this),Ti(this,"schedule_filterNsort",pi,this),Ti(this,"waiting_list_active",ui,this),Ti(this,"max_users",mi,this),Ti(this,"showUnits",gi,this),Ti(this,"myContents",hi,this),Ti(this,"displayManagers",bi,this),Ti(this,"mailingList",vi,this),Ti(this,"mailingListLoaded",_i,this),Ni(this,"isEnterprise",Blsm.checkMod(["","ENT"])),Ti(this,"registration_status",fi,this),Ni(this,"meetingFilters",[{name:"location",label:lng("location"),type:"text"},{name:"date",label:lng("date"),type:"date"},{name:"instructorNames",label:lng("instructor"),type:"text"}]),Ti(this,"_show_members_drawer",yi,this),Ti(this,"meetingUrl",wi,this),Ti(this,"hierarchy",xi,this),Ni(this,"conditionsTree",void 0),Ti(this,"groupMessages",ki,this),Ti(this,"availableRootGroups",Zi,this),Ni(this,"requestedComponent",!1),Ni(this,"showHierarchy",!1),Ni(this,"_internalNav",!1),Ti(this,"welcome_message",Ci,this),Ti(this,"qualificationLevelsExpand",Si,this),(0,b.makeObservable)(this),this.id=t,this.nav=i,this.fetch(),_.Nd.on("commentsUpdateCount",(e=>{if("assignment"===e.connectTo.type){let t=this.assignments.find((t=>t.assignment_id==e.connectTo.object_id));t||(t=this.contents.find((t=>t.assignment_id==e.connectTo.object_id))),t&&(t.comment_count=e.length)}if("content"===e.connectTo.type){let t=this.blog.find((t=>t.lesson_id==e.connectTo.object_id));if(t){const i=e.action;"add"==i&&(t.comment_count=parseInt(t.comment_count)+1),"subtract"===i&&(t.comment_count=parseInt(t.comment_count)-1)}}})),_.Nd.on("TaskUpdate",(e=>{let t;if(e.task.group_id==this.id)if(t=this.tasks.find((t=>t.task_id==e.id)),t)for(const[i,n]of Object.entries(e.task))Object.prototype.hasOwnProperty.call(t,i)&&(0,b.set)(t,i,n);else this.tasks.unshift(new T.o(e.task))})),_.Nd.on("TaskDelete",(e=>{let{id:t}=e;return this.tasks=this.tasks.filter((e=>t!=e.task_id))})),_.Nd.on("DiscussionDelete",(e=>{let{id:t}=e;return this.discussions=this.discussions.filter((e=>t!=e.discussion_id))})),_.Nd.on("DiscussionCreate",(e=>{let{discussion:t}=e;return this.discussions=[new T.o(t),...this.discussions]})),(0,b.observe)(this.tasks_filterNsort,(()=>this.taskFilterNav())),(0,b.autorun)((()=>{var e;null!==(e=this.tasks_filterNsort)&&void 0!==e&&e.filter.archive&&!this._archive_tasks_loaded&&(this._loading_tasks=!0,(0,v.SC)("groups/group_tasks",{data:{group:this.id,archive:1}},(e=>{const t=e.map((e=>new T.o(e)));this.tasks.push(...t),this._loading_tasks=!1,this._archive_tasks_loaded=!0})))}))}get show_members_drawer(){return this._show_members_drawer}showMembersDrawer(){this._show_members_drawer=!0}deleteContent(e){this.contents=this.contents.filter((t=>t!==e))}hideMembersDrawer(){this._show_members_drawer=!1}get loading_tasks(){return this._loading_tasks}get tab(){var e,t;return null!==(e=this.sections)&&void 0!==e&&e.includes(this._tab)?this._tab:null===(t=this.tabs[0])||void 0===t?void 0:t.val}get backTabsList(){return["welcome","components","social","tasks","patients_communication","schedule","requirements","planning"]}set tab(e){this.backTabsList.includes(this.tab)&&(this.lastBackTab=this.tab);const t="components"===e&&this.active_unit_id||"";this.nav(e?[e,t]:[])}taskFilterNav(){var e,t;if(this._internalNav)return;const i={filters:(0,b.toJS)(this.tasks_filterNsort.filter),sort:null===(e=this.tasks_filterNsort.sort)||void 0===e?void 0:e.by,reverse:null!==(t=this.tasks_filterNsort.sort)&&void 0!==t&&t.desc?1:void 0};this.nav(["tasks",i],{trigger:!1})}get filteredTasks(){return(0,f.WB)(this.tasks.slice(),this.tasks_filterNsort.filter,this.tasks_filterNsort.sort)}get selectedTasks(){return this.filteredTasks.filter((e=>e._checked))}get discussionsBlogs(){const e=this.discussions.map((e=>new D.$(e))),t=this.blog.map((e=>{var t,i,n;return{type:"blog",id:"b_"+e.lesson_id,blog_id:e.lesson_id,title:e.lesson_name,user:e.author,comments_count:e.comment_count,date:(0,H._3)(e.modification_time),lesson_text_data:e.lesson_text_data,lesson_options:{lock_comments:null===(t=e.lesson_options)||void 0===t?void 0:t.lock_comments},mayEdit:"0"!=e.can_edit,likes:{likes:parseInt(null===(i=e.likes)||void 0===i?void 0:i.likes)||0,user_vote:null===(n=e.likes)||void 0===n?void 0:n.user_vote}}}));return e.concat(t).sort(((e,t)=>t.date-e.date))}get filteredDiscussionsBlogs(){return(0,f.WB)(this.discussionsBlogs,this.discussions_blogs_filterNsort.filter,this.discussions_blogs_filterNsort.sort)}get nextAssignment(){return this.assignments.find((e=>!1===e._attr.status.completed))}get nextMeeting(){return this.schedule.find((e=>!!(0,E.Lj)(e,"start_date")&&!(0,H._3)((0,E.Lj)(e,"start_date")).isBefore()))}get allEvents(){return(0,y.B5)(this.active_unit_id)||"0"===this.active_unit_id||0===this.active_unit_id?this.schedule.filter((e=>this.active_unit_id>0?e.unitId===this.active_unit_id:!e.unitId||!this.unitIds.includes(e.unitId))):this.schedule}get members(){return this.membersLoaded?this._members:(this.fetchMembers(),null)}get managers(){return this.managersLoaded?this._managers:(this.fetchManagers(),null)}get filteredAssignments(){const e=this.assignments.slice().sort(((e,t)=>(e.order+"").localeCompare(t.order+"",void 0,{numeric:!0})));return(0,y.B5)(this.active_unit_id)||"0"===this.active_unit_id||0===this.active_unit_id?e.filter((e=>this.active_unit_id>0?e.unitId===this.active_unit_id:!e.unitId||!this.unitIds.includes(e.unitId))):e}get filteredSharedContent(){const e=this.contents.slice().sort(((e,t)=>(e.order+"").localeCompare(t.order+"",void 0,{numeric:!0})));return(0,y.B5)(this.active_unit_id)||"0"===this.active_unit_id||0===this.active_unit_id?e.filter((e=>this.active_unit_id>0?e.unitId===this.active_unit_id:!e.unitId||!this.unitIds.includes(e.unitId))):e}get reports(){return this.reportsLoaded?this._reports:(this.fetchReports(),null)}get reportsBundle(){return this.reportsLoaded?this._reportsBundle:(this.fetchReports(),null)}get meetings(){return this.schedule.filter((e=>"meeting"===e.type))}get componentsList(){return[...this.assignments,...this.meetings,...this.contents]}get components(){let e=this.componentsList;return((0,y.B5)(this.active_unit_id)||"0"===this.active_unit_id||0===this.active_unit_id)&&(e=e.filter((e=>this.active_unit_id>0?e.unitId===this.active_unit_id:!(e.unitId&&this.unitIds.includes(e.unitId)||e._attr.condition_component)))),e=e.sort(((e,t)=>e.order||t.order?(e.order+"").localeCompare(t.order+"",void 0,{numeric:!0}):(e._attr.due_date+"").localeCompare(t._attr.due_date+"",void 0,{numeric:!0}))),this.mayChangeComponents()||(e=e.sort(((e,t)=>t.is_waiting-e.is_waiting))),(0,f.WB)(e,this.components_filterNsort.filter,this.components_filterNsort.sort)}get scheduleItems(){var e;const t=null!==(e=this.schedule_filterNsort.filter)&&void 0!==e&&e.show_assignments?[...this.assignmentsWithDueDate(),...this.schedule]:[...this.schedule];let i=(0,f.WB)(t,this.schedule_filterNsort.filter,this.schedule_filterNsort.sort);if("sortTime"===this.schedule_filterNsort.sort.by){let e,t,n=0,r={};e=i.map((e=>[(0,H.GG)(e.sortTime,{time:!1}),e.sortTime.unix()])),e.sort(((e,t)=>e[1]>t[1]?1:-1)),e.forEach((e=>{t!==e[0]&&(t=e[0],n++),r[e[0]]=n})),t=void 0;const s=[];return i.forEach((e=>{let i=(0,H.GG)(e.sortTime,{time:!1});t!==i?(t=i,s.push({type:"dayNumber",day:r[i],date:i},e)):s.push(e)})),s}return i}assignmentsWithDueDate(){return this.assignments.filter((e=>e.sortTime))}get filters(){const e=[this.filteredAssignments.length>0&&{val:"assignment",label:lng("assignment"),color:X.g.colors.green,icon:"menu_overview"},this.scheduleItems.length>0&&{val:"meeting",label:lng("meeting",{phrase:!0}),color:X.g.colors.purple,icon:"menu_calendar"},this.filteredSharedContent.length>0&&{val:"share",label:lng("content"),color:X.g.colors.light_blue,icon:"content"}].filter((e=>e)),t=[{name:"title",label:lng("title"),type:"text"},{name:"type",label:lng("type"),type:"button_toggle",options:e}];return(this.filteredAssignments.length>0||this.scheduleItems.length>0)&&t.push({name:"descriptionText",label:lng("description"),type:"text"}),(this.filteredAssignments.length>0||this.filteredSharedContent.length>0)&&t.push({name:"category_id",label:lng("category"),type:"tree_node",tree:this.categoriesTree}),t}getComponentById(e){return this.componentsList.find((t=>t.assignment_id==e))}updateRoute(e){let[t,i,n,r]=e;if(this._tab=t||this.group_options.default_tab,"components"===t||"components"===this.tab)if(this.ready){var s,o,a;let e;((0,y.B5)(i)||"0"===i||"-1"===i)&&(e=this.getUnitById(i))&&(0,y.DM)(e.unit_id)?this.activateUnit(e):null!==(s=this.units)&&void 0!==s&&s.length&&this.activateUnit(null!==(o=this.units[0])&&void 0!==o&&null!==(a=o.sub_units)&&void 0!==a&&a.length?this.units[0].sub_units[0]:this.units[0]),this.showComponentSide(n,r)}else this.active_unit_id=i,this.requestedComponent={id:n,tab:r};else if("tasks"===t){const e={filter:(null==i?void 0:i.filters)||{},sort:{by:(null==i?void 0:i.sort)||"",desc:"1"===(null==i?void 0:i.reverse)}};this._internalNav=!0,(0,b.set)(this.tasks_filterNsort,e),this._internalNav=!1}}showComponentSide(e,t){if((0,y.B5)(e)){const i=this.getComponentById(e);(0,_.vm)().showSideDrawer(i,{tab:t||"",close:()=>this.setActiveComponent(null)})}}maySetAttendance(){return(0,y.B5)(this.group_id)&&this.is_manager&&this.permissions[Blsm.ManagerPermissions.SET_ATTENDANCE]}mayEditSetting(){return this.is_owner||this.is_manager&&this.permissions[Blsm.ManagerPermissions.GENERAL_CONFIG]}mayEditMeetings(){return(0,y.B5)(this.group_id)&&this.is_manager&&this.permissions[Blsm.ManagerPermissions.EDIT_MEETINGS]}mayEditMembers(){return(0,y.B5)(this.group_id)&&(this.permissions[Blsm.ManagerPermissions.MEMBERS_DIRECTOR]||this.is_owner||"Ou"===this.group_type&&Blsm.hasPermission("users_admin"))}mayImportMembers(){return this.mayEditMembers()&&Blsm.canAccessModule("Groups")}mayCreateMeetings(){return["components","schedule"].includes(this.tab)&&(0,y.B5)(this.group_id)&&this.permissions[Blsm.ManagerPermissions.CREATE_MEETINGS]&&this.features.meetings}mayCreateEvents(){return"schedule"===this.tab&&this.mayCreateMeetings()}mayCreateInstance(){return(this.is_owner||this.can_create_instance)&&"Course_template"===this.group_type}mayShareContent(){return"components"===this.tab&&(0,y.B5)(this.group_id)&&this.permissions[Blsm.ManagerPermissions.CONTENT_SHARE]&&this.features.content}mayCreateAssignments(){return"components"===this.tab&&(0,y.B5)(this.group_id)&&this.permissions[Blsm.ManagerPermissions.CREATE_ASSIGNMENTS]&&this.features.assignments}mayCreateComponent(){return this.mayCreateAssignments()||this.mayShareContent()||this.mayCreateMeetings()}mayInviteGuest(e){return this.is_manager&&"prv://watchittoo"===e&&Blsm.InitialData.parameters.anonymous_assignments}mayCreateDiscussion(){return"social"===this.tab&&this.features.discussions&&this.features.new_discussions&&Blsm.isFeatureEnabled("discussions")}mayCreatePoll(){return"social"===this.tab&&this.features.polls&&(Blsm.user.isPowerManager||this.permissions["perm_assignments|1"])}mayCreatePost(){return"social"===this.tab&&this.features.blog&&(this.is_owner||this.is_manager)}mayCreateTask(){return"tasks"===this.tab}leave(){(0,N.BB)(lng('are you sure you want to leave "%s"?',this.group_name),{confirmText:lng("leave").caps(),onConfirm:()=>(0,v.SC)("registration/action",{data:{group_id:this.group_id,action:"leave"},method:"POST"},(()=>{window.location.reload(),(0,ie.LB)({msg:lng('you left "%s"',this.group_name).caps(),type:"success"})}))})}get maySendSlackMessage(){return(this.is_owner||this.is_manager)&&this.slack_webhook&&Blsm.isFeatureEnabled("slack")}get mayAddMessage(){return(this.is_owner||this.is_manager)&&this.features.group_messages}get mayEditMessageVisibility(){return(0,y.B5)(this.group_id)&&this.permissions[Blsm.ManagerPermissions.MANAGE]}get showTaskProgress(){var e;const t=null===(e=this.task_fields)||void 0===e?void 0:e.progress_percent;return t>0&&(this.is_owner||this.is_manager||1===t)}get showNewComponentButton(){return(this.components.length>0&&"components"===this.tab||this.tab)&&(this.mayCreateAssignments()||this.mayCreateMeetings()||this.mayShareContent()||this.mayAddMessage||this.mayCreateDiscussion()||this.mayCreatePoll()||this.mayCreatePost()||this.mayCreateTask())}canUploadFiles(){return"components"===this.tab&&(this.mayCreateAssignments()||this.mayShareContent())}isGeneralManager(){return(0,y.B5)(this.group_id)&&this.permissions[Blsm.ManagerPermissions.GENERAL_CONFIG]}mayChangeComponents(e){let t=!1;if(this.group_id)switch(e){case"share":t=this.permissions[Blsm.ManagerPermissions.CONTENT_SHARE];break;case"meeting":t=this.permissions[Blsm.ManagerPermissions.CREATE_MEETINGS];break;case"assignment":t=this.permissions[Blsm.ManagerPermissions.CREATE_ASSIGNMENTS];break;default:t=this.group_id&&(this.is_owner||this.permissions&&(this.permissions[Blsm.ManagerPermissions.CREATE_ASSIGNMENTS]||this.permissions[Blsm.ManagerPermissions.CREATE_MEETINGS]||this.permissions[Blsm.ManagerPermissions.CONTENT_SHARE]||this.permissions[Blsm.ManagerPermissions.GENERAL_CONFIG]))}return t}maySetCoaches(){return Blsm.isFeatureEnabled("coached_assignments")&&this.permissions[Blsm.ManagerPermissions.GENERAL_CONFIG]&&this.assignments.filter((e=>e.hasCoach)).length>0}deleteMeeting(e){const t=t=>{(0,v.SC)("meetings/delete",{method:"POST",data:{ids:e.assignment_id,cancel_invite:e.icalUid?t:void 0,group_id:e._attr.group_id}},(()=>{this.schedule.remove(e),this.activeCalendarDate=(0,H._3)(e.start_date).clone().startOf("day")}))};e.icalUid?(0,N.cS)(lng("are you sure you want to delete the meeting?"),{title:lng("delete").caps(),inputType:"checkbox",placeholder:lng("send invite cancellation"),onConfirm:t}):(0,N.BB)(lng("are you sure you want to delete the meeting?"),{title:lng("delete").caps(),onConfirm:t})}deleteEvent(e){this.schedule.remove(e),this.activeCalendarDate=(0,H._3)(e.start_date).clone().startOf("day")}setAttendance(e){let{assignmentId:t,groupId:i}=e;(0,_.vm)().openDialog("form",new ge({data:{assignmentId:t,groupId:i},onSaveSuccess:()=>(0,_.vm)().closeDialog()}))}setMeetingUrl(e){this.meetingUrl=e}_initialCalendarDay(){var e;const t=moment();let i=null;for(const e of this.allEvents){const n=e.end_time;n>t&&(!i||n<i)&&(i=n)}if(!i)for(const e of this.allEvents){const n=e.end_time;n>t&&(!i||n>i)&&(i=n)}return((null===(e=i)||void 0===e?void 0:e.clone())||t).startOf("day")}populateData(e){var t,i,n,r,s,o,a;const l=e.data||e;this.display_message=e.display_message,this.group_id=l.group_id,this.group_name=l.group_name,this.group_description=l.group_description,this.group_type=l.group_type,this.group_invisible=l.group_invisible,this.status=l.status,this.users_count=e.users_count,this.is_course=l.is_course,this.group_image=l.group_image,this.group_options=l.group_options||{},this.group_location=l.group_location,this.group_audience=l.group_audience,this.classification_name=e.classification_name,this.categoriesTree=e.categories_tree,this.required_courses=null===(t=e.required_courses)||void 0===t?void 0:t.map((e=>new Be.j(e,{qualificationRequirement:!0}))),this.qual_list=e.qual_list,this.qual_top_name=e.qual_top_name,this.qual_top_id=e.qual_top_id,this.c_completed=e.c_completed,this.c_performance_score=e.c_performance_score,this.group_close_date=l.group_close_date,this.group_open_date=l.group_open_date,this.view_pre_days=l.view_pre_days,this.view_post_days=l.view_post_days,this.activity_date_future=e.activity_date_future,this.activity_date_past=e.activity_date_past,this.course_certificate=l.course_certificate,this.diploma=e.diploma,this.sequence_id=l.sequence_id,this.syllabus_file=l.syllabus_file,this.syllabus_text=l.syllabus_text,this.syllabus_url=l.syllabus_url,this.summary_data=l.summary_data,this.owner_options=l.owner_options,this.display_condition_components=l.display_condition_components,this.is_member=e.is_member,this.is_owner=e.is_owner,this.is_manager=e.is_manager,this.can_create_instance=e.can_create_instance,this.permissions=e.permissions,this.manager=e.manager,this.patient=e.patient,this.user_scores=e.user_scores,this.task_fields=e.task_fields,this.scoring_details=e.scoring_details,this.arrived_to_meetings=e.arrived_to_meetings,this.assignments=(null===(i=e.assignments)||void 0===i?void 0:i.map((e=>new j.o(e,{workspace:this}))))||[],this.schedule=(null===(n=e.meetings)||void 0===n?void 0:n.map((e=>(0,z.aZ)(e,{workspace:this}))))||[],this.contents=(null===(r=e.contents)||void 0===r?void 0:r.map((e=>new P.m(e,{workspace:this,deleteContent:this.deleteContent}))))||[],this.portal_id=e.portal_id,this.availableRootGroups=e.available_root_groups||[],this.waitingList=null===(s=e.waiting_list)||void 0===s?void 0:s.map((e=>new T.o(e))),this.registeredUsers=null===(o=e.registered_users)||void 0===o?void 0:o.map((e=>new T.o(e))),this.waiting_list_active=l.waiting_list_active,this.planning=null===(a=l.planning)||void 0===a?void 0:a.map((e=>new T.o(e))),this.max_users=parseInt(l.max_users),this.available_to_all_users=null==e?void 0:e.available_to_all_users,this.mayLeave=null==e?void 0:e.may_leave}fetch(){this.ready=!1,(0,v.SC)("groups/"+this.id,{},(0,b.action)((e=>{var t,i,n,r,s,o,a,l;const c=(t,i)=>{this[t].replace((e[t]||[]).map((e=>i?new i(e,this):new T.o(e))))};if(this.populateData(e),e.display_message)return void(this.ready=!0);c("discussions"),c("blog"),c("polls",Z),this.tasks_stats=e.tasks_stats||{},c("tasks"),this._loading_tasks=!1,this.welcome_message=e.welcome_message,this.displayManagers=e.display_managers,this.group_access=e.group_access,this.units=(null===(t=e.units)||void 0===t?void 0:t.map((e=>new A(e,{workspace:this}))))||[],this.addDefaultUnits(),"PatientCase"===this.group_type&&e.patients_communication&&(this.patients_communication=e.patients_communication.sort(((e,t)=>t.com_id-e.com_id))),this.tabs=[],this.summary_data&&this.summary_data.custom_fields&&(this.custom_fields_data=e.custom_fields_data),null===(i=this.custom_fields_data)||void 0===i||i.forEach((t=>t.value=e[t.field_column]));const d=(e,t,i)=>{var n;const r=parseInt(this.group_options[e]);return r>0&&(this.is_owner||this.is_manager||1===r&&(i||(null===(n=t||this[e])||void 0===n?void 0:n.length)>0))};var p,u,m,g;(this.features={assignments:d("assignments"),meetings:d("meetings"),content:d("catalog",this.contents),discussions:d("discussions",null,!0)&&Blsm.isFeatureEnabled("discussions"),new_discussions:d("new_discussions",null,!0),blog:d("blog")&&Blsm.isFeatureEnabled("blog"),polls:d("polls"),tasks:d("group_tasks",this.tasks,!0),users:d("users",!1,!0),group_messages:d("notice_board",!1,!0)},(this.features.assignments||this.features.meetings||this.features.content)&&this.tabs.push({val:"components",label:lng("components",{phrase:!0})}),this.features.tasks&&this.tabs.push({val:"tasks",label:lng("tasks",{phrase:!0})}),(this.features.discussions||this.features.blog||this.features.polls)&&this.tabs.push({val:"social",label:lng("social",{phrase:!0})}),"PatientCase"===this.group_type&&this.patients_communication&&this.tabs.push({val:"patients_communication",label:lng("patient communication")}),"Qualification"===this.group_type&&(null===(n=this.required_courses)||void 0===n?void 0:n.length)>0&&this.tabs.push({val:"requirements",label:lng("requirements")}),this.features.meetings&&(this.scheduleItems.length>0||this.is_manager||this.is_owner)&&this.tabs.push({val:"schedule",label:lng("schedule",{phrase:!0})}),(this.welcome_message||null!==(r=this.displayManagers)&&void 0!==r&&r.length)&&this.tabs.push({val:"welcome",label:lng("welcome",{phrase:!0})}),"Workplan"===this.group_type&&this.tabs.push({val:"planning",label:lng("planning",{phrase:!0})}),e.show_welcome_on_first_visit&&this.is_member&&!e.first_visit&&(this.welcome_message||this.displayManagers.length)?this._tab="welcome":this._tab=this._tab||this.group_options.default_tab,this.sections=[...this.tabs.map((e=>e.val))],this.features.users&&this.group_options.show_members||this.mayEditMembers())&&(this.sections.push("members"),this.waiting_list_active&&(null===(p=e.waiting_list)||void 0===p?void 0:p.length)>0&&this.sections.push("waiting_list"),(null===(u=e.registered_users)||void 0===u?void 0:u.length)>0&&this.sections.push("registration"));(this.mayEditSetting&&["group","course","qualification","workplan"].includes(null===(s=this.group_type)||void 0===s?void 0:s.toLowerCase())&&this.sections.push("mailing_list"),(this.features.users&&(this.group_options.managers_primary||this.group_options.managers_managers||this.group_options.managers_viewers||this.group_options.managers_inherited)||this.is_owner)&&this.sections.push("managers"),this.sections.push("reports","my_contents"),e.hierarchy)&&(this.showHierarchy=(this.is_owner||this.is_manager)&&(null===(m=e.hierarchy)||void 0===m?void 0:m.length)>0||(null===(g=e.hierarchy)||void 0===g?void 0:g.length)>1,this.hierarchy=(0,Ze.Jf)(e.hierarchy),this.sections.push("hierarchy"));if(e.rating&&Blsm.isFeatureEnabled("rating_tool")&&(this.rating=e.rating),e.qual_list){const t={};for(const i of e.qual_list)t[i.group_id]=i;for(const i of e.qual_list)for(const e of i.parents)e&&t[e]&&(t[e].sons||(t[e].sons=[]),t[e].sons.push(i));for(const e of Object.values(t))e.sons&&e.sons.sort(((e,t)=>e.c_order-t.c_order));const i=Object.keys(t),n=e.qual_list.filter((e=>!(e.parents&&i.filter((t=>e.parents.includes(t))).length>0)));(0,Ze.v0)(n),this.conditionsTree=n}this.activeCalendarDate=this._initialCalendarDay(),this.ready=!0,this.countItemsPerUnit(),this.active_unit_id?this.activateUnit(this.getUnitById(this.active_unit_id)):null!==(o=this.units)&&void 0!==o&&o.length&&this.activateUnit(null!==(a=this.units[0])&&void 0!==a&&null!==(l=a.sub_units)&&void 0!==l&&l.length?this.units[0].sub_units[0]:this.units[0]),this.requestedComponent&&(this.showComponentSide(this.requestedComponent.id,this.requestedComponent.tab),this.requestedComponent=!1),"Course_template"===this.group_type&&this.warnings.push(lng("course template")),this.is_manager&&this.group_invisible==Blsm.ManagerPermissions.GROUP_MANAGERS_ONLY&&this.warnings.push(lng("manager only")),this.is_manager&&this.group_invisible==Blsm.ManagerPermissions.GROUP_INVISIBLE&&this.warnings.push(lng("not active")),this.is_manager&&"draft"==this.status&&this.warnings.push(lng("draft")),this.is_manager&&"approval"==this.status&&this.warnings.push(lng("approval waiting")),this.is_manager&&this.activity_date_past&&this.warnings.push(lng("was available until %s",(0,H.GG)(this.activity_date_past,{time:!1}))),this.is_manager&&this.activity_date_future&&this.warnings.push(lng("will be available on %s",(0,H.GG)(this.activity_date_future,{time:!1}))),this.deleted&&this.warnings.push(lng("deleted")),this.myContents=e.my_contents,this.groupMessages=e.notice_board||[],this.slack_webhook=e.slack_webhook,"Qualification"===e.group_type&&e.credit_required&&(this.creditRequired=e.credit_required,this.userCredit=e.user_credit||0),this.creditOnCompletion=e.credit_on_completion||0,this.likes=e.likes,this.userVote=e.user_vote,this.bookmark_id=e.bookmark_id})))}addDefaultUnits(){const e=this.componentsList;this.units.length>0&&e.some((e=>!e.unitId||!this.unitIds.includes(e.unitId)))&&(this.is_owner||this.is_manager)&&this.units.push(new A({unit_id:0,unit_name:lng("unassigned").caps()},{workspace:this})),this.units.length>0&&e.some((e=>e.unitId))&&!this.group_options.hide_all_learning_unit&&this.units.push(new A({unit_id:-1,unit_name:lng("all").caps()},{workspace:this}))}fetchGroupMessages(){(0,v.SC)("groups/messages",{data:{group_id:this.id}},(e=>this.groupMessages=e||[]))}fetchHierarchy(){(0,v.SC)("groups/hierarchy",{data:{group_id:this.id}},(e=>{(null==e?void 0:e.length)>1&&(this.hierarchy=(0,Ze.Jf)(e))}))}fetchQualList(){(0,v.SC)("groups/qual_list",{data:{group_id:this.id}},(e=>this.qual_list=e))}fetchManagers(){(0,v.SC)("groups/workspace_managers",{data:{group_id:this.id}},(e=>{this._managers.replace(e.managers.map((e=>new T.o(e)))),this.manager_permission_types=null==e?void 0:e.manager_permission_types,this.default_manager_setting=e.default_manager_setting,this.default_permissions=e.default_permissions,this.managersLoaded=!0}))}fetchMembers(){(0,v.SC)("groups/workspace_members",{data:{group_id:this.id}},(e=>{var t;this._members.replace((null==e||null===(t=e.members)||void 0===t?void 0:t.map((e=>new T.o(e))))||[]),this.allowedUserFields=e.allowedUserFields,this.usersCustomFieldsNames=e.users_custom_fields_names,this.membersLoaded=!0}))}fetchMailinList(){(0,v.SC)("groups/mailing_list",{data:{group_id:this.id}},(e=>{this.mailingList.replace(e.map((e=>new T.o(e)))),this.mailingListLoaded=!0}))}fetchReports(){(0,v.SC)("groups/reports_data",{data:{group_id:this.id}},(e=>{this._reports=e.reports||{},this._reportsBundle=e.bundle||[],this.reportsLoaded=!0}))}fetchTasks(){(0,v.SC)("groups/group_tasks",{data:{group:this.id}},(e=>{this.tasks.replace((e||[]).map((e=>new T.o(e)))),this._archive_tasks_loaded=!1}))}deleteTasks(e){const t=e.map((e=>e.task_id));(0,N.BB)(lng("are you sure you want to delete these tasks?").caps(),{title:lng("delete tasks"),confirmText:lng("delete"),onConfirm:()=>(0,v.SC)("tasks/delete",{data:{id:t}},(0,b.action)((()=>{this.tasks=this.tasks.filter((e=>!t.includes(e.task_id)))})))})}getDiploma(){var e,t;return!("1"!==(null===(e=this.user_scores)||void 0===e||null===(t=e.performance)||void 0===t?void 0:t.c_completed)||!(this.diploma||parseInt(this.course_certificate)>0))&&(this.diploma?(0,G.p4)({file:{file_id:this.diploma}}):!!this.course_certificate&&Blsm.prm.Mainref+"ajax/requests.php?user="+Blsm.user.id+"&group="+this.group_id+"&req=diploma")}get customFields(){var e;return null===(e=this.custom_fields_data)||void 0===e?void 0:e.filter((e=>e.value)).map((e=>{let t=e.value,i=e.field_type.toLowerCase();if("checkbox"===i)t=(0,y.P$)(t)?{icon:"mark_v"}:{icon:"mark_x"};else if("date"===i||"datetime"===i){if(!/^\d+-\d+-\d+/.test(t))return;t=(0,H.GG)(t,{time:/time/.test(i)})}else"varchar"===i&&(i="text");return[e.field_name,t,i]}))}moveTasks(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},i=e.map((e=>e.task_id));(0,N.cS)(lng("move the selected tasks to:"),{title:lng("move tasks"),inputType:"single_item",inputOptions:{searchData:(e,t)=>{(0,v.SC)("groups/autocomplete",{method:"POST",json:!0,data:{managed_perm:"manage",is_owner:1,tasks_enabled:1,types:"Workplan",term:e.term||"",exclude:[this.group_id]}},t)}},onConfirm:e=>{(0,N.BB)(lng("this will also move parent and sub tasks, continue?"),{onConfirm:()=>(0,v.SC)("tasks/move_tasks",{method:"POST",data:{tasks:i,workplan_id:e}},(n=>{const r=this.tasks.filter((e=>i.includes(e.task_id)&&e.parent_task)).map((e=>e.parent_task));i=i.concat(r),this.tasks=this.tasks.filter((e=>!i.includes(e.task_id)&&!i.includes(e.parent_task))),t(e,n)}))})}})}createPoll(){const e=new Z({},this);(0,_.vm)().openDialog("form",new I.y({data:{poll:e,groupId:this.group_id},onSaveSuccess:()=>((0,_.vm)().closeDialog(),this.polls.push(e))}))}deletePoll(e){(0,N.BB)(lng("are you sure you want to delete this poll question?").caps(),{title:lng("delete poll"),confirmText:lng("delete"),onConfirm:()=>{this.polls.remove(e),e.delete(e.assignment_id)}})}getBlogPostOrgData(e,t){return"blog"===t?this.blog.find((t=>t.lesson_id===e)):"discussion"===t?this.discussions.find((t=>t.discussion_id===e)):null}setActiveBlog(e,t){this.activeBlog=!!(0,y.B5)(e)&&this.getBlogPostOrgData(e,t)}removeBlog(e,t){(0,N.BB)(lng("are you sure you want to delete this post?"),{onConfirm:()=>{const i=this.getBlogPostOrgData(e,t);this.blog.remove(i),(0,v.SC)("content/"+i.lesson_id,{method:"DELETE"},(e=>{"error"===e.res&&this.blog.push(i)}))}})}toggleUserVotePost(e,t){var i,n,r;const s=this.getBlogPostOrgData(e,t);s.likes={likes:null!=s&&null!==(i=s.likes)&&void 0!==i&&i.user_vote?parseInt(s.likes.likes)-1:parseInt(null==s||null===(n=s.likes)||void 0===n?void 0:n.likes)+1,user_vote:null==s||null===(r=s.likes)||void 0===r||!r.user_vote};const o={req:"vote",type:"blog"===t?"content":"discussion",object_id:e,user_action:"like",group_id:this.group_id};(0,v.SC)("likes",{data:o,method:"POST"})}toggleLockPostComments(e,t){if("blog"===t)(0,v.SC)("content/lock_comments",{method:"POST",data:{lesson_id:e}});else if("discussion"===t){const t=this.discussions.find((t=>t.discussion_id===e));(0,v.SC)("discussions",{data:{discussion_id:e,lock:"1"===t.locked?"0":"1",req:"lock_discussion"},method:"PATCH"},(()=>{t.locked="1"===t.locked?"0":"1"}))}}addGroupMessageLocally(e,t){this.groupMessages.unshift({deleted:"0",text:t,time:((new Date).getTime()/1e3).toString(),id:e})}updateGroupMessageLocally(e,t){this.groupMessages=this.groupMessages.map((i=>i.id!==e?i:{...i,...t}))}addGroupMessage(){(0,_.vm)().openDialog("form",new Oe.M({data:{ws:this.id}}))}addSlackMessage(){(0,N.cS)("",{title:lng("send message to slack"),confirmText:lng("send").caps(),placeholder:lng("message"),inputType:"richtext",inputOptions:{slackMarkdown:!0},multiline:!0,onConfirm:e=>(0,v.SC)("groups/send_to_slack",{method:"POST",data:{group_id:this.id,message:e.replaceAll('<div dir="rtl">',"").replaceAll('<div dir="ltr">',"").replaceAll("</div>","")}})})}updateGroupMessage(){(0,_.vm)().openDialog("form",new Oe.M({data:{ws:this.id}}))}removeGroupMessage(e,t){(0,v.SC)("groups/message/"+e.id,{method:"DELETE",data:{ws:this.id}},(0,b.action)((()=>{this.groupMessages=this.groupMessages.filter((t=>t.id!==e.id)),t()})))}toggleGroupMessage(e){(0,v.SC)("groups/activate_message",{method:"POST",data:{id:e.id,activate:2==e.deleted?1:0}},(0,b.action)((()=>{this.groupMessages=this.groupMessages.map((t=>(t.id===e.id&&(t.deleted=2==e.deleted?0:2),t)))})))}updateNoticeBoardVisibility(e){this.group_options.notice_board=e,(0,v.SC)(`groups/update_options/${this.id}`,{data:{group_options:this.group_options},method:"POST",json:!0},(0,b.action)((()=>{!this.groupMessages&&e&&this.fetchGroupMessages()})))}get orderedUnits(){let e=[];for(const t of this.units)(0,y.B5)(t.unit_id)&&e.push(t);e=e.sort(((e,t)=>e.attr("unit_order")-t.attr("unit_order")));for(const t of this.units)(0,y.B5)(t.unit_id)||e.push(t);return e}get likesVote(){return this.userVote}get likesCount(){return this.likes}get mayLike(){return this.is_member||this.is_manager}get mayRecommend(){return this.isEnterprise&&(this.is_member||this.is_manager)&&this.available_to_all_users}get bookmarked(){return this.bookmark_id}get mayBookmark(){return this.is_member||this.is_manager}toggleBookmark(){this.bookmark_id=!this.bookmark_id;const e={type:"group",id:this.group_id,delete:this.bookmarked?"0":"1"};(0,v.SC)("bookmarks",{data:e,method:"POST"})}toggleLike(){this.userVote=!this.userVote,this.likes=this.userVote?++this.likes:Math.max(this.likes-1,0);const e={req:"vote",type:"group",object_id:this.group_id,user_action:"like"};(0,v.SC)("likes",{data:e,method:"POST"})}Recommend(){(0,_.vm)().openDialog("form",new Oi.O({object_id:this.group_id,object_type:"workspace",onSaveSuccess:()=>(0,_.vm)().closeDialog()}))}get waitingListSelected(){var e;return null===(e=this.waitingList)||void 0===e?void 0:e.filter((e=>e._checked)).map((e=>e.user_id))}get registeredUsersSelected(){var e;return null===(e=this.registeredUsers)||void 0===e?void 0:e.filter((e=>e._checked)).map((e=>e.user_id))}registeredUsersReject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,v.SC)("groups/registered_users_reject",{data:{group_id:this.id,list:this.registeredUsersSelected.join(","),reason:e},method:"POST"},(()=>{this.fetch(),this.tab="registration",(0,ie.qV)(lng("users rejected").caps())}))}waitingListApprove(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.waitingListSelected;(0,v.SC)("groups/waiting_list_approve",{data:{group_id:this.id,users:e},method:"POST"},(()=>{this.fetch(),this.tab="members",(0,ie.qV)(lng("members added"))}))}waitingListReject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.waitingListSelected;(0,v.SC)("groups/waiting_list_reject",{data:{group_id:this.id,users:e},method:"POST"},(()=>{this.fetch(),this.tab="members",(0,ie.qV)(lng("members rejected").caps())}))}canApproveMembers(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return!this.max_users||(null===(e=this.members)||void 0===e?void 0:e.length)+t<=this.max_users}toggleDisplayManager(e,t){e.stopPropagation();const i=this._managers.find((e=>e.user_id===t)),n={group_id:this.id,user_id:t},r=!i.display_about;r&&(n.checked=1),(0,v.SC)("groups/toggle_display_about",{method:"POST",data:n},(e=>{r?this.displayManagers.push(e):this.displayManagers=this.displayManagers.filter((e=>{let{user_id:i}=e;return t!==i}));const i=this._managers.map((e=>e.user_id===t?{...e,display_about:r}:e));this._managers.replace(i)}))}activateUnit(e){var t;if(this.componentsList.some((e=>e.unitId))||this.mayCreateComponent()){if(!e)return this.active_unit_id&&this.setActiveUnit({}),this.active_unit_id=null,void(this.active_unit=null);null===(t=this.active_unit)||void 0===t||t.deactivate(),0===e.count&&e.sub_units.length>0&&e.fullCount&&(e=e.sub_units.find((e=>e.count>0))),this.active_unit=e,this.active_unit_id=e.unit_id,this.activeCalendarDate=this._initialCalendarDay(),this.active_unit.activate()}}setActiveUnit(e){this.nav(["components",e.unit_id])}setActiveComponent(e,t){this.nav(["components",(0,y.DM)(this.active_unit_id)?this.active_unit_id:"",e,t])}onCalendarStripClick(e){"event"===e.type?this.mayEditMeetings()&&this.openEventForm(e):this.setActiveComponent(e.assignment_id)}getUnitById(e){const t=(e,i)=>{for(const r of e){var n;if(r.unit_id==i)return r;if(null!==(n=r.sub_units)&&void 0!==n&&n.length){const e=t(r.sub_units,i);if(e)return e}}};return t(this.units,e)}deleteUnitById(e){this.units=this.units.filter((t=>{var i;const n=t.unit_id==e;return!n&&null!==(i=t.sub_units)&&void 0!==i&&i.length&&(t.sub_units=t.sub_units.filter((t=>t.unit_id!=e))),!n})),0===this.unitsTree().length&&(this.units=[]),this.active_unit_id==e&&this.activateUnit(null)}parentUnitsList(){const e=[[0," - "+lng("root").caps()+" - "]];for(const t of this.units)(0,y.B5)(t.unit_id)&&e.push([t.unit_id,t.attr("unit_name")]);return e}unitsTree(){const e=[];for(const i of this.units){var t;if((0,y.B5)(i.unit_id))if(e.push({val:i.unit_id,label:i.attr("unit_name")}),null!==(t=i.sub_units)&&void 0!==t&&t.length)for(const t of i.sub_units)e.push({val:t.unit_id,label:" > "+t.attr("unit_name")})}return e}saveUnit(e,t){t?(0,v.SC)("groups/save_learning_unit",{method:"POST",data:{unit_id:t,...e}},(()=>{var i,n;const r=this.getUnitById(t);var s;if(r._attr=Object.assign(r._attr,e),e.unit_hide||(r._attr.unit_hide=null),((0,y.B5)(null===(i=r.parent_unit)||void 0===i?void 0:i.unit_id)||(0,y.B5)(e.parent_unit))&&(null===(n=r.parent_unit)||void 0===n?void 0:n.unit_id)!=e.parent_unit)if(null!==(s=r.parent_unit)&&void 0!==s&&s.unit_id?(r.parent_unit.sub_units=r.parent_unit.sub_units.filter((e=>e.unit_id!=t)),r.parent_unit=null):this.units=this.units.filter((e=>e.unit_id!=t)),e.parent_unit){const t=this.getUnitById(e.parent_unit);r.parent_unit=t,t.sub_units=[...t.sub_units,r]}else this.units=[...this.units,r]})):(0,v.SC)("groups/new_learning_unit",{method:"POST",data:{group_id:this.group_id,...e}},(e=>{const t=new A(e,{workspace:this}),i=0===this.units.length;if(e.parent_unit){const i=this.getUnitById(e.parent_unit);t.parent_unit=i,i.sub_units=[...i.sub_units,t]}else this.units=[...this.units,t];i&&this.addDefaultUnits()}))}deleteUnit(e){(0,v.SC)("groups/delete_learning_unit",{method:"POST",data:{unit_id:e}},(()=>{this.deleteUnitById(e)}))}get unitIds(){const e=[];return this.units.forEach((t=>{if((0,y.B5)(t.unit_id)&&(e.push(t.unit_id),t.sub_units.length)){const i=t.sub_units.map((e=>e.unit_id));i&&e.push(...i)}})),e}isUnitCompleted(e){if(0===e.length)return!1;for(let t of e){let e=this.getComponentById(t);if(!e.completed&&!e.attr("completed"))return!1}return!0}countItemsPerUnit(){const e={0:[],"-1":[]};this.componentsList.forEach((t=>{t.unitId&&this.unitIds.includes(t.unitId)?(e[t.unitId]||(e[t.unitId]=[]),e[t.unitId].push(t.attr("assignment_id"))):t._attr.condition_component||e[0].push(t.attr("assignment_id")),e[-1].push(t.attr("assignment_id"))}));for(const[t,i]of Object.entries(e)){const e=this.getUnitById(t);e&&(e.count=i.length,e.completed=this.isUnitCompleted(i))}}componentsCompactView(e){this.componentsView=e?"compact":"",U.X.set("workspace_components_view",e?"compact":void 0)}setComponentOrder(e){this.components.forEach((t=>{t.order=e.indexOf(t.assignment_id+"")})),(0,v.SC)("assignment/assignments_ordering",{method:"POST",data:{ordering:e,group_id:this.group_id}})}moveSelectedToUnit(e){const t=this.components.filter((e=>e.selected));if(0===t.length)return;const i={group_id:this.group_id,items:[...t.map((e=>e.assignment_id))],move_to:e};(0,v.SC)("groups/move_to_learning_unit",{method:"POST",data:i},(()=>{t.forEach((t=>{t.unitId=e,t.selected=!1})),this.countItemsPerUnit()}))}removeAssignment(e){this.assignments.remove(e)}deleteComponents(e,t){const i=[],n=[],r=[],s=[];e.forEach((e=>{switch(e.type){case"meeting":i.push(e.assignment_id);break;case"event":s.push(e.id);break;case"share":n.push(e.assignment_id);break;case"assignment":r.push(e.assignment_id)}})),(0,v.SC)("groups/detach_components",{method:"POST",data:{group_id:this.group_id,cancel_invite:t,meetings:i,shares:n,assignments:r,events:s}},(e=>{null==e||e.forEach((e=>{r.includes(parseInt(e))?this.assignments=this.assignments.filter((t=>t.assignment_id!=e)):n.includes(parseInt(e))?this.contents=this.contents.filter((t=>t.assignment_id!=e)):i.includes(parseInt(e))?this.schedule=this.schedule.filter((t=>t.assignment_id!=e)):s.includes(parseInt(e))&&(this.schedule=this.schedule.filter((t=>t.id!=e)))}))}))}onFileDrop(e){const t=[];this.mayShareContent()&&t.push(["content",lng("content").caps()]),this.mayCreateAssignments()&&t.push(["assignment",lng("assignment").caps()]),(0,N.cS)(lng("select component type"),{title:lng("select component type"),inputType:"select",selectOptions:(0,y.wd)(t),onConfirm:t=>{switch(t){case"content":(0,_.vm)().openDialog("form",new Ce.y({files:e,share:this.group_id,unit_id:this.active_unit_id,onSaveSuccess:e=>this.addToContents(e.lessons)}));break;case"assignment":(0,_.vm)().formPassData=e,(0,G.p4)({edit:"assignment",params:{ws:this.group_id,type:"content",multiple:1,unit:this.active_unit_id}},!0)}}})}addToContents(e){e.forEach((e=>this.contents.push(new P.m(e,{workspace:this}))))}addToMyContents(e){e.forEach((e=>this.myContents.push(e)))}createCommunication(){(0,_.vm)().openDialog("form",new V({patient:this.patient,caseId:this.group_id,onSaveSuccess:e=>{const t=lng("communication created successfully");e._sms_sent?(0,ie.qV)(lng("the patient will receive an SMS soon"),t):(0,ie.qV)(t),this.patients_communication.unshift(e),(0,_.vm)().closeDialog()}}))}headerActions(){var e,t,i,n,r,s;const o=this,a={portal_type:"group",portal_title:o.group_name,group_id:o.group_id},l=e=>((0,_.vm)().closeDialog(),o.portal_id=e.portal_id,(0,G.p4)({portal:o.portal_id},!0)),c=(null===(e=o.permissions)||void 0===e?void 0:e[Blsm.ManagerPermissions.CREATE_PORTAL])&&Blsm.isFeatureEnabled("portal")&&"Subset"!==o.group_type,d=o.is_course&&(null===(t=o.mayEditSetting)||void 0===t?void 0:t.call(o))&&Blsm.isFeatureEnabled("integration_paypal");return[Blsm.isFeatureEnabled("rating_tool")&&["Group","Qualification","Course_template"].includes(o.group_type)&&o.rating&&{icon:"bookmark_half",onClick:()=>(0,_.vm)().openDialog("Component",{width:"1200px",padded:!1,child:(0,L.tZ)(Bi.S,{ws:o}),title:`${o.group_name} ${lng("rating survey")}`})},o.maySendSlackMessage&&{icon:"slack",onClick:()=>this.addSlackMessage()},Blsm.isFeatureEnabled("users_content")&&(this.myContents&&void 0!==this.myContents.length||this.is_manager)&&(1==this.group_options.catalog||2==this.group_options.catalog&&this.is_manager)&&{icon:"content",onClick:()=>o.tab="my_contents",toolTip:lng("my content")},Blsm.isFeatureEnabled("participation_planning")&&o.is_owner&&{icon:"calendar",toolTip:lng("participation planning"),onClick:()=>(0,G.p4)({list:"participation_planning",params:`group_id=${this.group_id}`},!0)},window.bchat&&{icon:"chat",onClick:()=>Blsm.chat_with_group(o.group_id)},Blsm.InitialData.special.watchittoo&&(null===(i=o.owner_options)||void 0===i?void 0:i.watchittoo)&&{icon:"chalkboard",href:{newrow:o.group_id},toolTip:lng("liveclass")},o.is_owner||o.is_manager?(null===(n=o.group_options)||void 0===n?void 0:n.ou_report)>0&&{icon:"report",onClick:()=>o.tab="reports",toolTip:lng("reports")}:{icon:"report",href:{report:"CourseGradesReport",params:{group:this.group_id,user_mode:1}}},o.portal_id?{icon:"home",onClick:()=>(0,G.p4)({portal:o.portal_id},!0),toolTip:lng("portal")}:c&&{icon:"home",onClick:()=>(0,_.vm)().openDialog("form",new J.q({newPortalInfo:a,onSaveSuccess:l})),toolTip:lng("portal")},d&&{icon:"mng_budget",toolTip:lng("set up for sale"),onClick:()=>(0,_.vm)().openDialog("form",new ke({group_id:o.group_id,onSaveSuccess:()=>(0,_.vm)().closeDialog()}))},this.showHierarchy&&{icon:"hierarchy",onClick:()=>o.tab="hierarchy",toolTip:lng("hierarchy")},"Qualification"===o.group_type&&o.qual_list.length>1&&{icon:"map_spot",onClick:()=>{o.qualificationLevelsExpand++,window.scrollTo({top:0,behavior:"smooth"})},toolTip:lng("view full path")},o.mayLeave&&{icon:"exit_portal",onClick:()=>null==o?void 0:o.leave(),toolTip:lng("leave"),bgColor:X.g.colors.negative_bg},(null===(r=o.mayEditSetting)||void 0===r?void 0:r.call(o))&&{icon:"mng_settings",href:{edit:"workspace",id:o.group_id},toolTip:lng("settings"),bgColor:X.g.colors.grey},(null===(s=o.mayCreateInstance)||void 0===s?void 0:s.call(o))&&{icon:"new",onClick:()=>(0,G.p4)({edit:"workspace",params:{type:"course",template:o.group_id}},!0),toolTip:lng("create an instance")}]}duplicateMeetings(e){const t=e.filter((e=>e.assignment_id)).map((e=>e.assignment_id)),i=e.filter((e=>"event"===e.type)).map((e=>e.id));(0,_.vm)().openDialog("form",new ye({meetingsIds:t,eventIds:i,onSaveSuccess:e=>{null==e||e.newSchedule.forEach((e=>this.schedule.push((0,z.aZ)(e,{workspace:this})))),(0,_.vm)().closeDialog()}}))}openEventForm(e){const t=new Se.Z({event:e,group_id:this.group_id,onSaveSuccess:t=>{this.status=null,t.event_info&&(e&&this.schedule.remove(e),this.schedule.push(new we.n(t.event_info,{workspace:this})),this.activeCalendarDate=(0,H._3)(t.event_info.start_date).startOf("day"))}});(0,_.vm)().openDialog("form",t)}checkVisible(e){"schedule"===this.tab?this.scheduleItems.forEach((t=>{t.isEntity&&t.select(!!e)})):this.components.forEach((t=>t.select(!!e)))}get isVisibleChecked(){return"schedule"===this.tab?this.scheduleItems.length>0&&this.scheduleItems.filter((e=>e.isEntity)).reduce(((e,t)=>e&&t.selected),!0):this.components.reduce(((e,t)=>e&&t.selected),!0)}get tabFiltersSorts(){const e=this.filteredAssignments.length,t=this.scheduleItems.length,i=this.filteredSharedContent.length,n=[{name:"title",label:lng("title"),type:"text",outOfMenu:!0}],r=[{val:"",label:lng("default")},{val:"title",label:lng("title")},{val:"type",label:lng("type")}];if("components"===this.tab){const r=[e>0&&{val:"assignment",label:lng("assignment"),color:X.g.colors.green,icon:"menu_overview"},t>0&&{val:"meeting",label:lng("meeting",{phrase:!0}),color:X.g.colors.purple,icon:"menu_calendar"},i>0&&{val:"share",label:lng("content"),color:X.g.colors.light_blue,icon:"content"}].filter((e=>e));n.push({name:"type",label:lng("type"),type:"button_toggle",options:r}),(i>0||e>0)&&n.push({name:"category_id",label:lng("category"),type:"tree_node",tree:this.categoriesTree})}return["components","schedule"].includes(this.tab)&&(t>0&&(n.push(...this.meetingFilters),r.push({val:"location",label:lng("location")})),(e>0||t>0)&&(n.push({name:"descriptionText",label:lng("description"),type:"text"}),r.push({val:"sortTime",label:lng("date")}))),"schedule"===this.tab&&n.push({name:"show_assignments",label:lng("show assignments"),type:"checkbox"}),{filters:n,sorts:r}}MeetingActions(){const e=[],t=this.scheduleItems.length,i="schedule"===this.tab?this.scheduleItems.filter((e=>e.selected)):this.components.filter((e=>e.selected)),n=i.filter((e=>"meeting"===e.type||"event"===e.type));return e.push(this.mayChangeComponents("meeting")&&{icon:"trash",action:i.length?()=>{i.filter((e=>"meeting"===e.type&&e.icalUid)).length>0?(0,N.cS)(lng("are you sure you want to remove these components?"),{title:lng("delete").caps(),inputType:"checkbox",placeholder:lng("send invite cancellation (only for meetings where invitations were sent)"),onConfirm:e=>this.deleteComponents(i,e)}):(0,N.BB)(lng("are you sure you want to remove these components?").caps(),{title:lng("remove components"),confirmText:lng("remove").caps(),onConfirm:()=>this.deleteComponents(i,!1)})}:void 0,toolTip:lng("remove component")},"schedule"===this.tab&&(this.mayCreateEvents()||this.mayCreateMeetings())&&t>0&&{icon:"copy",action:n.length>0?()=>this.duplicateMeetings(n):void 0,toolTip:lng("duplicate")},this.maySetAttendance()&&t>0&&{icon:"meeting",toolTip:lng("import meeting attendance"),action:()=>(0,_.vm)().openDialog("form",new Ie({groupId:this.id}))},this.mayChangeComponents("meeting")&&{icon:"notifications",toolTip:lng("send invitations"),action:n.length>0?()=>{const e=n.filter((e=>e.attr("assignment_id")&&moment(e.attr("start_date")).isAfter(new Date))).map((e=>e.attr("assignment_id")));return 0===e.length?(0,ie.nb)(lng("please select at least one future meeting")):(0,_.vm)().openDialog("form",new Fe({ids:e,ws:this.id}))}:void 0},this.mayChangeComponents("meeting")&&{icon:"edit",toolTip:lng("edit multiple meetings"),action:n.length>0?()=>{(0,_.vm)().openDialog("form",new Pe({names:n.map((e=>e.assignment_name||e._attr.title)),ids:n.map((e=>e.assignment_id)).filter((e=>e)),event_ids:n.map((e=>e._attr.event_id)).filter((e=>e)),group_id:this.id,onSaveSuccess:()=>((0,_.vm)().closeDialog(),this.fetch())}))}:void 0},this.mayChangeComponents("meeting")&&t>0&&this.group_options.show_unattended_message&&{icon:"waiting_list",toolTip:lng("absent members message"),action:()=>(0,_.vm)().openDialog("form",new Ve({groupId:this.id,meetings:i.map((e=>e.assignment_id))}))}),e}get filteredPlanning(){return(0,f.WB)(this.planning.slice(),this.planning_filterNsort.filter,this.planning_filterNsort.sort)}get checkedPlanningItems(){return this.planning.filter((e=>e._checked))}},yt=Ii(ft.prototype,"ready",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wt=Ii(ft.prototype,"_tab",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),xt=Ii(ft.prototype,"display_message",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=Ii(ft.prototype,"managersLoaded",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Zt=Ii(ft.prototype,"membersLoaded",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ct=Ii(ft.prototype,"waitingListLoaded",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),St=Ii(ft.prototype,"activeCalendarDate",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return moment().startOf("day")}}),Ot=Ii(ft.prototype,"warnings",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Bt=Ii(ft.prototype,"active_unit",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tt=Ii(ft.prototype,"active_unit_id",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nt=Ii(ft.prototype,"activeBlog",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),It=Ii(ft.prototype,"showRatingSurvey",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Dt=Ii(ft.prototype,"group_options",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),jt=Ii(ft.prototype,"qual_list",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pt=Ii(ft.prototype,"is_owner",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),zt=Ii(ft.prototype,"is_manager",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Et=Ii(ft.prototype,"waitingList",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Rt=Ii(ft.prototype,"assignments",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ft=Ii(ft.prototype,"_managers",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Mt=Ii(ft.prototype,"_waiting_list",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),At=Ii(ft.prototype,"_members",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qt=Ii(ft.prototype,"registeredUsers",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Xt=Ii(ft.prototype,"allowedUserFields",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Lt=Ii(ft.prototype,"schedule",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$t=Ii(ft.prototype,"planning",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Vt=Ii(ft.prototype,"contents",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ut=Ii(ft.prototype,"portal_id",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ht=Ii(ft.prototype,"discussions",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Jt=Ii(ft.prototype,"blog",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Gt=Ii(ft.prototype,"polls",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Wt=Ii(ft.prototype,"tasks",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Kt=Ii(ft.prototype,"_loading_tasks",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Ii(ft.prototype,"tasks_stats",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Qt=Ii(ft.prototype,"_reports",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),ei=Ii(ft.prototype,"reportsLoaded",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ti=Ii(ft.prototype,"likes",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ii=Ii(ft.prototype,"userVote",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=Ii(ft.prototype,"bookmark_id",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ri=Ii(ft.prototype,"units",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),si=Ii(ft.prototype,"componentsView",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return U.X.get("workspace_components_view")||""}}),oi=Ii(ft.prototype,"patients_communication",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ai=Ii(ft.prototype,"tasks_filterNsort",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,f.Cy)()}}),li=Ii(ft.prototype,"planning_filterNsort",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,f.Cy)()}}),ci=Ii(ft.prototype,"discussions_blogs_filterNsort",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,f.Cy)()}}),di=Ii(ft.prototype,"components_filterNsort",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,f.Cy)()}}),pi=Ii(ft.prototype,"schedule_filterNsort",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,f.Cy)({},{by:"sortTime"})}}),ui=Ii(ft.prototype,"waiting_list_active",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mi=Ii(ft.prototype,"max_users",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gi=Ii(ft.prototype,"showUnits",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),hi=Ii(ft.prototype,"myContents",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bi=Ii(ft.prototype,"displayManagers",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vi=Ii(ft.prototype,"mailingList",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_i=Ii(ft.prototype,"mailingListLoaded",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fi=Ii(ft.prototype,"registration_status",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),yi=Ii(ft.prototype,"_show_members_drawer",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wi=Ii(ft.prototype,"meetingUrl",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xi=Ii(ft.prototype,"hierarchy",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ki=Ii(ft.prototype,"groupMessages",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Zi=Ii(ft.prototype,"availableRootGroups",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ci=Ii(ft.prototype,"welcome_message",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=Ii(ft.prototype,"qualificationLevelsExpand",[b.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ii(ft.prototype,"show_members_drawer",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"show_members_drawer"),ft.prototype),Ii(ft.prototype,"showMembersDrawer",[b.action],Object.getOwnPropertyDescriptor(ft.prototype,"showMembersDrawer"),ft.prototype),Ii(ft.prototype,"deleteContent",[Ue],Object.getOwnPropertyDescriptor(ft.prototype,"deleteContent"),ft.prototype),Ii(ft.prototype,"hideMembersDrawer",[b.action],Object.getOwnPropertyDescriptor(ft.prototype,"hideMembersDrawer"),ft.prototype),Ii(ft.prototype,"loading_tasks",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"loading_tasks"),ft.prototype),Ii(ft.prototype,"tab",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"tab"),ft.prototype),Ii(ft.prototype,"filteredTasks",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"filteredTasks"),ft.prototype),Ii(ft.prototype,"selectedTasks",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"selectedTasks"),ft.prototype),Ii(ft.prototype,"discussionsBlogs",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"discussionsBlogs"),ft.prototype),Ii(ft.prototype,"filteredDiscussionsBlogs",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"filteredDiscussionsBlogs"),ft.prototype),Ii(ft.prototype,"nextAssignment",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"nextAssignment"),ft.prototype),Ii(ft.prototype,"nextMeeting",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"nextMeeting"),ft.prototype),Ii(ft.prototype,"allEvents",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"allEvents"),ft.prototype),Ii(ft.prototype,"members",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"members"),ft.prototype),Ii(ft.prototype,"managers",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"managers"),ft.prototype),Ii(ft.prototype,"filteredAssignments",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"filteredAssignments"),ft.prototype),Ii(ft.prototype,"filteredSharedContent",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"filteredSharedContent"),ft.prototype),Ii(ft.prototype,"reports",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"reports"),ft.prototype),Ii(ft.prototype,"meetings",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"meetings"),ft.prototype),Ii(ft.prototype,"componentsList",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"componentsList"),ft.prototype),Ii(ft.prototype,"components",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"components"),ft.prototype),Ii(ft.prototype,"scheduleItems",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"scheduleItems"),ft.prototype),Ii(ft.prototype,"updateRoute",[b.action],Object.getOwnPropertyDescriptor(ft.prototype,"updateRoute"),ft.prototype),Ii(ft.prototype,"leave",[He],Object.getOwnPropertyDescriptor(ft.prototype,"leave"),ft.prototype),Ii(ft.prototype,"maySendSlackMessage",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"maySendSlackMessage"),ft.prototype),Ii(ft.prototype,"mayAddMessage",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"mayAddMessage"),ft.prototype),Ii(ft.prototype,"mayEditMessageVisibility",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"mayEditMessageVisibility"),ft.prototype),Ii(ft.prototype,"showTaskProgress",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"showTaskProgress"),ft.prototype),Ii(ft.prototype,"showNewComponentButton",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"showNewComponentButton"),ft.prototype),Ii(ft.prototype,"fetch",[Je],Object.getOwnPropertyDescriptor(ft.prototype,"fetch"),ft.prototype),Ii(ft.prototype,"fetchGroupMessages",[Ge],Object.getOwnPropertyDescriptor(ft.prototype,"fetchGroupMessages"),ft.prototype),Ii(ft.prototype,"fetchHierarchy",[We],Object.getOwnPropertyDescriptor(ft.prototype,"fetchHierarchy"),ft.prototype),Ii(ft.prototype,"fetchQualList",[Ke],Object.getOwnPropertyDescriptor(ft.prototype,"fetchQualList"),ft.prototype),Ii(ft.prototype,"fetchManagers",[b.action],Object.getOwnPropertyDescriptor(ft.prototype,"fetchManagers"),ft.prototype),Ii(ft.prototype,"fetchMembers",[b.action],Object.getOwnPropertyDescriptor(ft.prototype,"fetchMembers"),ft.prototype),Ii(ft.prototype,"fetchMailinList",[Ye],Object.getOwnPropertyDescriptor(ft.prototype,"fetchMailinList"),ft.prototype),Ii(ft.prototype,"fetchReports",[b.action],Object.getOwnPropertyDescriptor(ft.prototype,"fetchReports"),ft.prototype),Ii(ft.prototype,"fetchTasks",[b.action],Object.getOwnPropertyDescriptor(ft.prototype,"fetchTasks"),ft.prototype),Ii(ft.prototype,"customFields",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"customFields"),ft.prototype),Ii(ft.prototype,"createPoll",[Qe],Object.getOwnPropertyDescriptor(ft.prototype,"createPoll"),ft.prototype),Ii(ft.prototype,"deletePoll",[et],Object.getOwnPropertyDescriptor(ft.prototype,"deletePoll"),ft.prototype),Ii(ft.prototype,"getBlogPostOrgData",[tt],Object.getOwnPropertyDescriptor(ft.prototype,"getBlogPostOrgData"),ft.prototype),Ii(ft.prototype,"setActiveBlog",[it],Object.getOwnPropertyDescriptor(ft.prototype,"setActiveBlog"),ft.prototype),Ii(ft.prototype,"removeBlog",[nt],Object.getOwnPropertyDescriptor(ft.prototype,"removeBlog"),ft.prototype),Ii(ft.prototype,"toggleUserVotePost",[rt],Object.getOwnPropertyDescriptor(ft.prototype,"toggleUserVotePost"),ft.prototype),Ii(ft.prototype,"toggleLockPostComments",[st],Object.getOwnPropertyDescriptor(ft.prototype,"toggleLockPostComments"),ft.prototype),Ii(ft.prototype,"addGroupMessageLocally",[ot],Object.getOwnPropertyDescriptor(ft.prototype,"addGroupMessageLocally"),ft.prototype),Ii(ft.prototype,"updateGroupMessageLocally",[at],Object.getOwnPropertyDescriptor(ft.prototype,"updateGroupMessageLocally"),ft.prototype),Ii(ft.prototype,"addGroupMessage",[lt],Object.getOwnPropertyDescriptor(ft.prototype,"addGroupMessage"),ft.prototype),Ii(ft.prototype,"addSlackMessage",[ct],Object.getOwnPropertyDescriptor(ft.prototype,"addSlackMessage"),ft.prototype),Ii(ft.prototype,"updateGroupMessage",[dt],Object.getOwnPropertyDescriptor(ft.prototype,"updateGroupMessage"),ft.prototype),Ii(ft.prototype,"removeGroupMessage",[pt],Object.getOwnPropertyDescriptor(ft.prototype,"removeGroupMessage"),ft.prototype),Ii(ft.prototype,"toggleGroupMessage",[ut],Object.getOwnPropertyDescriptor(ft.prototype,"toggleGroupMessage"),ft.prototype),Ii(ft.prototype,"updateNoticeBoardVisibility",[mt],Object.getOwnPropertyDescriptor(ft.prototype,"updateNoticeBoardVisibility"),ft.prototype),Ii(ft.prototype,"orderedUnits",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"orderedUnits"),ft.prototype),Ii(ft.prototype,"waitingListSelected",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"waitingListSelected"),ft.prototype),Ii(ft.prototype,"registeredUsersSelected",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"registeredUsersSelected"),ft.prototype),Ii(ft.prototype,"registeredUsersReject",[gt],Object.getOwnPropertyDescriptor(ft.prototype,"registeredUsersReject"),ft.prototype),Ii(ft.prototype,"waitingListApprove",[ht],Object.getOwnPropertyDescriptor(ft.prototype,"waitingListApprove"),ft.prototype),Ii(ft.prototype,"waitingListReject",[bt],Object.getOwnPropertyDescriptor(ft.prototype,"waitingListReject"),ft.prototype),Ii(ft.prototype,"canApproveMembers",[vt],Object.getOwnPropertyDescriptor(ft.prototype,"canApproveMembers"),ft.prototype),Ii(ft.prototype,"toggleDisplayManager",[_t],Object.getOwnPropertyDescriptor(ft.prototype,"toggleDisplayManager"),ft.prototype),Ii(ft.prototype,"unitIds",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"unitIds"),ft.prototype),Ii(ft.prototype,"isVisibleChecked",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"isVisibleChecked"),ft.prototype),Ii(ft.prototype,"filteredPlanning",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"filteredPlanning"),ft.prototype),Ii(ft.prototype,"checkedPlanningItems",[b.computed],Object.getOwnPropertyDescriptor(ft.prototype,"checkedPlanningItems"),ft.prototype),ft)},4943:(e,t,i)=>{i.d(t,{I:()=>g,b:()=>m});var n,r,s,o,a=i(7363),l=i(7821),c=i(8e3),d=i(918);function p(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function u(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}const m=(0,a.createContext)(null);let g=(r=u((n=class{constructor(e){let{nav:t}=e;p(this,"_allEvents",r,this),p(this,"year",s,this),p(this,"ready",o,this),(0,l.makeObservable)(this),this.nav=t,(0,c.SC)("calendar/yearly",{},(0,l.action)((e=>{this._allEvents=e.events,this.ready=!0})))}moveYear(e){this.nav(["up"===e?this.year+1:this.year-1])}updateRoute(e){let[t]=e;this.year=parseInt(t||(new Date).getFullYear())}get eventsArray(){return(0,d.a)(this._allEvents,this.year)}}).prototype,"_allEvents",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=u(n.prototype,"year",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=u(n.prototype,"ready",[l.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),u(n.prototype,"moveYear",[l.observable],Object.getOwnPropertyDescriptor(n.prototype,"moveYear"),n.prototype),u(n.prototype,"updateRoute",[l.action],Object.getOwnPropertyDescriptor(n.prototype,"updateRoute"),n.prototype),u(n.prototype,"eventsArray",[l.computed],Object.getOwnPropertyDescriptor(n.prototype,"eventsArray"),n.prototype),n)},5033:(e,t,i)=>{i.d(t,{Al:()=>Y,zq:()=>Q,iz:()=>se,aA:()=>re,Mz:()=>ie,qz:()=>ne,Xq:()=>K});var n=i(5560),r=i(5898),s=i(5875),o=i(917),a=i(6920),l=i(7363),c=i(81),d=i(5832),p=i(8411),u=i(8318),m=i(8207),g=i(1991),h=i(3755),b=i(236),v=i(3389),_=i(4216),f=i(8534),y=i(9934),w=i(8e3),x=i(8567),k=i(7821),Z=i(9637),C=i(2334);const S={bg:"#f5f4f5",grey_1:"#7d7d7d",grey_2:"#D8D8D8",grey_3:"#5D676D",grey_4:"silver",grey_5:"#e7e7e7",grey_6:"#c0c0c0",grey_7:"#e8e8e8",grey_8:"#ebedee",grey_9:"#869299",grey_10:"#b1b8bc",grey_11:"#52636C",grey_12:"#c9c9c9",blue:"#0d2532",strong:"#ff9800",positive:"#4aaa61",negative:"#d03434",blossom:"#20ae61",warning:"#e87e0d"};let O=document.querySelector("html"),B=O.classList.contains("RTL");B&&document.getElementById("bchat_full")&&(B=!1,O.classList.remove("RTL"));const T=S;var N=i(5519),I=i(4210);function D(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class j extends I.I{constructor(e){super(e),D(this,"coaches",void 0),D(this,"checkedItems",void 0),D(this,"rowIdCol",void 0),D(this,"assignmentEntity",void 0),D(this,"possibleCoaches",void 0),D(this,"buildFields",(()=>{this._fields=[{name:"user",label:lng("select coach"),confirmText:lng("set"),type:"select",options:(0,u.wd)(this.coaches)},{name:"send_notification",type:"checkbox",label:lng("send notification to coach")}],this._prepFields(),this.ready=!0})),this.coaches=e.coaches,this.checkedItems=e.checkedItems,this.rowIdCol=e.rowIdCol,this.assignmentEntity=e.assignmentEntity,this.possibleCoaches=e.possibleCoaches,this.title=lng("set coach").caps(),this.buildFields()}save(){const e=this.checkedItems.map((e=>e[this.rowIdCol]));let t=Object.fromEntries(e.map((e=>[e,this.values.get("user")])));const i={assignment:this.assignmentEntity.assignment_id,data:t,notify_coach:this.values.get("send_notification"),users:e};(0,w.SC)("assignment/set_coach",{data:i,method:"POST"},(()=>{this.checkedItems.forEach((e=>{e.coach_name=this.possibleCoaches[this.values.get("user")],e.coach_id=this.values.get("user")})),this.values.get("send_notification")&&(0,f.qV)("notification will be sent to the selected coach")}))}}var P,z=i(3346),E=i(5944);function R(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let F=(P=class extends _.D{constructor(e){var t;let{assignment:i}=e;super({}),R(this,"_innerFilterSort",!0),R(this,"possible_coaches",void 0),R(this,"assignment_data",void 0),R(this,"assignmentEntity",void 0),(0,k.makeObservable)(this),this.assignmentEntity=i,this.RowRenderer=V,this._actionsCol=!1,this.flags={personal_dates:i.attr("personal_dates"),coachable:"coach"===i.attr("completion_requirement")||i.attr("managerun")===N.hy||(null===(t=i.attr("assignment_options"))||void 0===t?void 0:t.test_coach_review)},this._cols=[{title:lng("name"),sortVal:"full_name",input:"text"},this.flags.personal_dates&&{title:lng("start date"),sortVal:"personal_start_date",input:"date"},this.flags.personal_dates&&{title:lng("due date"),sortVal:"next_due_date",input:"date"},this.flags.coachable&&{title:lng("coach"),sortVal:"coach_name",input:"text"}].filter((e=>e)),this.colsToFiltersAndSorts(),this.rowIdCol="user_id",this.fetchUrl="assignment/assignment_users_options/&assignment="+i.assignment_id+"&group="+i.workspace.group_id,this.ready=!0,this.fetch()}_acceptDataFromServer(e){this.items.replace(e.items.map((e=>(e.personal_start_date=(0,C.GG)(e.personal_start_date,{time:!1}),e.next_due_date=(0,C.GG)(e.next_due_date,{time:!1}),new y.o(e))))),this.possible_coaches=e.possible_coaches,this.assignment_data=e.assignment_data,this._actions=[this.flags.coachable&&(this.assignment_data.coach_type?{icon:"user_sync",action:()=>this.recalculateCoach(),toolTip:lng("recalculate coach")}:{icon:"group",action:()=>this.setCoach(),toolTip:lng("set coach")}),this.flags.coachable&&{icon:"notifications",action:()=>this.notifyCoaches(),toolTip:lng("notify coaches")},this.flags.personal_dates&&{icon:"event",color:`${T.positive}`,action:()=>this.setDates("start_date"),toolTip:lng("set personal start date")},this.flags.personal_dates&&{icon:"event",color:`${T.negative}`,action:()=>this.setDates("due_date"),toolTip:lng("set personal due date")}]}setDates(e){var t;if(!this.checkedItems.map((e=>e[this.rowIdCol])).length)return(0,f.nb)(lng("please select at least one item").caps());const i=this.checkedItems,n=null===(t=this.assignmentEntity)||void 0===t?void 0:t._attr,r="due_date"===e?lng("select personal due date"):lng("select personal start date");(0,x.cS)(r.caps()+":",{title:lng("select dates"),confirmText:lng("save"),inputType:"date_time",onConfirm:t=>{const r=i.map((e=>e.user_id));(0,w.SC)("assignment/set_personal_dates",{method:"POST",data:{assignment:n.assignment_id,users:r,[e]:t}},(()=>{this.fetch()}))}})}setCoach(){if(!this.checkedItems.map((e=>e[this.rowIdCol])).length)return(0,f.nb)(lng("please select at least one item").caps());const e=(0,u.wd)(Object.entries(this.possible_coaches));if(e.length){e.sort(((e,t)=>e.val.localeCompare(t.val)));const t=new j({coaches:e,checkedItems:this.checkedItems,rowIdCol:this.rowIdCol,possibleCoaches:this.possible_coaches,assignmentEntity:this.assignmentEntity});(0,x.BB)((0,E.tZ)(I.q3.Provider,{value:t,children:(0,E.tZ)(z.au,{input:t.fields})}),{title:lng("select coach"),confirmText:lng("set"),onConfirm:()=>(t.callSave(),setTimeout(this.fetch,100))})}else(0,f.nb)(lng("no coaches found, check assignment settings"))}notifyCoaches(){const e=this.checkedItems.map((e=>e[this.rowIdCol]));if(!e.length)return(0,f.nb)(lng("please select at least one item").caps());const t={assignment:this.assignmentEntity.assignment_id,users:e};(0,w.SC)("assignment/notify_coach",{data:t,method:"POST"},(()=>{(0,f.qV)(lng("notification will be sent to selected coaches").caps())}))}recalculateCoach(){const e=this.checkedItems.map((e=>e[this.rowIdCol]));if(!e.length)return(0,f.nb)(lng("please select at least one item").caps());const t={assignment:this.assignmentEntity.assignment_id,users:e};(0,w.SC)("assignment/recalculate_coach",{data:t,method:"POST"},(()=>{this.fetch()}))}},M=P.prototype,A="_acceptDataFromServer",q=[k.override],X=Object.getOwnPropertyDescriptor(P.prototype,"_acceptDataFromServer"),L=P.prototype,$={},Object.keys(X).forEach((function(e){$[e]=X[e]})),$.enumerable=!!$.enumerable,$.configurable=!!$.configurable,("value"in $||$.initializer)&&($.writable=!0),$=q.slice().reverse().reduce((function(e,t){return t(M,A,e)||e}),$),L&&void 0!==$.initializer&&($.value=$.initializer?$.initializer.call(L):void 0,$.initializer=void 0),void 0===$.initializer&&(Object.defineProperty(M,A,$),$=null),P);var M,A,q,X,L,$;const V=(0,n.observer)((e=>{let{row:t,rowProps:i}=e;const{rowAction:n}=i;return(0,E.BX)("tr",{onClick:()=>null==n?void 0:n(t),children:[(0,E.tZ)(Z.U6,{children:t.full_name}),i.flags.personal_dates&&(0,E.tZ)("td",{children:t.personal_start_date||lng("default").caps()}),i.flags.personal_dates&&(0,E.tZ)("td",{children:t.next_due_date||lng("default").caps()}),i.flags.coachable&&(0,E.tZ)("td",{children:t.coach_name}),(0,E.tZ)(Z.Fo,{o:t})]})}));i(2906);var U=i(5007),H=(i(7882),i(4765)),J=i(6303),G=i(7154),W=i(6380);const K=(e,t)=>{switch(e){case"assignment_options":{const e=new F({assignment:t});(0,U.vm)().openDialog("Component",{child:(0,E.tZ)(v.b,{list:e}),title:lng("assignment member options")+" - "+t.title});break}}},Y=(0,n.observer)((e=>{let{assignment:t,assignee:i,inContainer:n,noComments:s,onTitleClick:o}=e;return(0,E.tZ)(r.xr,{entity:t,assignee:i,noComments:s,playLink:t.playLink?t.playLink:t.link,onTitleClick:()=>o?o(t):(0,U.vm)().showSideDrawer(t),inContainer:n,onMenuSelect:e=>K(e,t)})})),Q=e=>{let{assignment:t,inContainer:i,newTab:n=!0,short:l=!1,refLink:c,...d}=e;const p=(0,o.iv)("background-color:",a.g.colors.white,";&.short{flex-direction:column;align-items:flex-start;}",""),{title:m,type_title:g,category:b,progress:v,subTitle:_,users:f,countUsers:y,dateNote:w}=t,x=(null==f?void 0:f.length)||y||void 0,k=t.link;return c&&(0,u.Kn)(k)&&(k.ref=c),(0,E.BX)(s.o,{title:m,css:p,className:(0,u.AK)({short:l}),markColor:t.markColor,icon:t.markNew?"sparkles":void 0,iconColor:a.g.colors.dominant_orange,iconTooltip:lng("new|mark new content"),href:k,inContainer:i,newTab:n,tags:l?null:[g.toUpperCase(),b].filter((e=>e)),progress:!l&&v,subTitle:(0,E.BX)(E.HY,{children:[w&&(0,E.BX)(E.HY,{children:[(0,E.tZ)(r.jC,{noBoxShadow:!0,className:"_note",...w})," "]}),_]}),menuOptions:l?null:t.menu(),...d,children:[v&&(0,E.tZ)("div",{children:(0,E.tZ)(h.k,{numerator:v.progress[0],denominator:v.progress[1]})}),x>0&&(0,E.tZ)("div",{children:(0,E.tZ)(G.u,{text:lng("%s users|count",(0,u.lo)(x)),children:(0,E.tZ)(W.T,{badge:(0,u.lo)(x)})})})]})},ee=(0,o.iv)(">.filtersAbove{position:relative;>div{position:absolute;bottom:1em;",a.g.classes.far(0),";",a.g.mQuery.mobileNarrow,"{",a.g.classes.far("10px"),";}}}","");var te={name:"1gpzra0",styles:"margin-bottom:1em"};const ie=e=>{let{assignments:t,inContainer:i,filtersTheme:n,setShowCompleted:r,showCompleted:s,assignee:o,compactView:h,initCompactView:v=!1,mayChangeView:_,title:f,className:y,barExtraComponent:w,filtersAbove:x=!1,useCarousel:k,noFilterSort:Z,noComments:C,displayTags:S,extraFilters:O=[],onTitleClick:B}=e;const[T,N]=(0,l.useState)(v),{filtersVals:I,setFilterVals:D,sort:j,setSort:P}=(0,c.qD)();s&&(I.show_completed=!0);const z=void 0!==h?h:T;let R=[],F=[];t.forEach((e=>{e._attr.lesson_tags&&(R=[...R,...e._attr.lesson_tags]),e._attr.category_name&&(F=[...F,...e._attr.category_name])})),R=[...new Set(R)].filter((e=>e)).sort().map((e=>({val:e,label:e})));let M=Z?void 0:[{name:"title",label:lng("name"),type:"text",outOfMenu:!0},{name:"type_title",label:lng("type"),type:"select_multi",options:(0,d._V)("type_title",t)},{name:"category_name",type:"select",val:"category_name",emptyOption:!0,label:lng("category"),options:(0,d._V)("category",t)},r&&{name:"show_completed",type:"checkbox",label:lng("show completed assignments"),func:(e,t)=>t,onValueChange:e=>(r(e),I.show_completed=e.show_completed)},...O].filter((e=>e));const A=Z?void 0:[{val:"",label:lng("default")},{val:"assignment_name",label:lng("name")},{val:"assignment_type",label:lng("type")},{val:"category_name",label:lng("category")}];let q=(0,E.tZ)(p.CX,{title:f,filters:M,filtersVals:I,onFilter:D,sorts:A,sort:j,onSort:P,compactView:z,onViewSelect:_?()=>N(!z):void 0,extraComponent:w,collection:t});n&&(q=(0,E.tZ)(p.dI.Provider,{value:n,children:q}));const X=(0,d.WB)(t,I,j,{filters:M}).map((e=>z?(0,E.tZ)(H.Q,{item:e,assignee:o,onClick:()=>(0,U.vm)().showSideDrawer(e)},e.assignment_id):(0,E.tZ)(Y,{assignee:o,assignment:e,inContainer:!0,noComments:C,onTitleClick:B},e.assignment_id)));return i?(0,E.tZ)(m.W2,{head:q,className:y,children:z?(0,E.tZ)("div",{css:a.g.classes.list,children:X}):(0,E.tZ)(b.Hl,{children:X})}):(0,E.BX)("div",{css:ee,className:y,children:[(0,E.tZ)("div",{className:(0,u.AK)({filtersAbove:x}),children:q}),S&&R.length>1&&(0,E.tZ)(J._,{options:R,value:I.lesson_tags,theme:"tags",css:te,onChange:e=>D((0,u.v7)(Object.assign({},I,{lesson_tags:e||void 0})))}),k&&!z?(0,E.tZ)(g.T,{children:X}):z?(0,E.tZ)("div",{css:a.g.classes.list,children:X}):(0,E.tZ)(b.Hl,{children:X})]})},ne=e=>({content:lng("content"),readingConfirmation:lng("reading confirmation"),courseware:lng("courseware"),test:lng("test"),survey:lng("survey"),evaluation:lng("evaluation"),submit:lng("immediate completion"),approval:lng("complete on approval"),activity:lng("activity"),activityCoach:lng("activity coach"),checklistCoach:lng("checklist coach"),surveyCoach:Blsm.isFeatureEnabled("evaluation")?lng("survey/evaluation coach"):lng("survey coach"),master:lng("master"),checklist:lng("checklist"),external:lng("external|assignment"),feedback:lng("feedback"),lti:lng("lti")}[e]),re=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[{topic:"file",type:"content",text:lng("an assignment based on a file or text content in the system that doesn't have a required score"),check:Blsm.isFeatureEnabled("content")},{topic:"file",type:"readingConfirmation",text:lng("an assignment that requires the performer's reading confirmation of a document"),check:Blsm.isFeatureEnabled("content")&&Blsm.isFeatureEnabled("signatures_and_reading_confirmations")},{topic:"file",type:"courseware",text:lng("an assignment based on Scorm/Tincan"),check:Blsm.isFeatureEnabled("run_scorm")},{topic:"questionnaire",type:"test",text:lng("an assignment based on test type questionnaire"),check:Blsm.isFeatureEnabled("tests")},{topic:"questionnaire",type:"survey",text:lng("an assignment based on survey type questionnaire"),check:Blsm.isFeatureEnabled("survey")},{topic:"questionnaire",type:"evaluation",text:lng("an assignment based on evaluation type questionnaire"),check:Blsm.isFeatureEnabled("evaluation")},{topic:"submission",type:"approval",text:lng("an assignment in which the performer has to write or submit something that requires review and approval"),check:!0},{topic:"submission",type:"submit",text:lng("an assignment in which the performer has to write something. after submitting, the performance is immediately completed"),check:!0},{topic:"submission",type:"activity",text:lng("an assignment that reflects activity in the real world.").caps()+" "+lng("for example: completing a written assignment, taking the verbal test, submitting homework, etc").caps(),check:!0},{topic:"coaching",type:"activityCoach",text:lng("an assignment that a coach performs on a trainee with automatic completion"),check:Blsm.isFeatureEnabled("coached_assignments")},{topic:"coaching",type:"checklistCoach",text:lng("an assignment that contains a list of things to do in which the coach checks each time what has been done"),check:Blsm.isFeatureEnabled("coached_assignments")&&Blsm.isFeatureEnabled("checklist")},{topic:"coaching",type:"surveyCoach",text:Blsm.isFeatureEnabled("evaluation")?lng("an assignment based on survey/evaluation type questionnaire that the activator is coach"):lng("an assignment based on survey type questionnaire that the activator is coach"),check:Blsm.isFeatureEnabled("coached_assignments")&&Blsm.isFeatureEnabled("survey")},{topic:"other",type:"master",text:lng("an assignment that contains several sub assignments where each one has a weight that makes up the final score of the master assignments"),check:!0,mod:["assignments","ENT"]},{topic:"other",type:"checklist",text:lng("an assignment that contains a list of things to do in which the performer checks each time what has been done"),check:Blsm.isFeatureEnabled("checklist")},{topic:"other",type:"external",text:lng("an assignment that is not performed at all in the system and it is only necessary to set a score for the users"),check:(0,u.B5)(e.ws)},{topic:"other",type:"feedback",text:lng("an assignment in which feedback must be given on the performance of different assignment in the system. the feedback assignment is performed by another user in the system"),check:Blsm.isFeatureEnabled("feedback_assignments")},{topic:"other",type:"lti",text:lng("an assignment based on LTI"),check:Blsm.isFeatureEnabled("external_content")}];i=i.filter((e=>!!e.check&&Blsm.checkMod(e.mod)&&(0===t.length||t.includes(e.type)))),i.forEach((t=>{t.typeLabel=ne(t.type),t.action={edit:"assignment",params:{...e,type:t.type}}}));const n={file:{label:lng("file"),color:a.g.colors.set[1]},questionnaire:{label:lng("questionnaire"),color:a.g.colors.set[2]},submission:{label:lng("submission"),color:a.g.colors.set[6]},coaching:{label:lng("coaching"),color:a.g.colors.set[10]},other:{label:lng("other"),color:a.g.colors.set[13]}};return{types:i,topics:n,title:lng("create assignment")}},se=()=>re().types.map((e=>({label:e.typeLabel,href:e.action})))},619:(e,t,i)=>{i.d(t,{V:()=>x});var n=i(7363),r=i(6920),s=i(917),o=i(8207),a=i(5690),l=(i(7882),i(6975)),c=i(8318),d=i(9180),p=i(5311),u=i(7392),m=i(2334),g=i(4765),h=i(5944);const b=(0,s.iv)("font-size:1em;display:flex;align-items:center;._day{background-color:",r.g.colors.dominant_main,";color:white;font-size:2.2em;border-radius:10px;font-weight:700;width:72px;height:3em;line-height:3em;text-align:center;}._menu{",r.g.classes.opposite_float,";}._titles{color:",r.g.colors.text_sec,";",r.g.classes.margin_near("30px"),";._title{color:",r.g.colors.text_main,";font-weight:700;font-size:2em;}._subTitle{font-size:1.2em;}}",""),v=e=>{let{date:t,eventsCount:i,sideComponent:n}=e;const r=(0,m.zk)(t);return(0,h.BX)("div",{css:b,className:"event-title",children:[(0,h.tZ)("div",{className:"_day",children:t.date()}),(0,h.BX)("div",{className:"_titles",children:[(0,h.tZ)("div",{className:"_title",children:lng("daily agenda").caps()}),0===i&&(0,h.tZ)("div",{className:"_subTitle",children:(r?lng("you have no events scheduled today"):lng("no events")).caps()}),i>1&&(0,h.tZ)("div",{className:"_subTitle",children:r?lng("you have %s events today",i).caps():lng("%s events",i).caps()})]}),(0,h.tZ)(p.zh,{}),n]})},_=(0,s.iv)("font-size:1em;color:",r.g.colors.text_sec,";.subTitle{text-align:center;}.topPart{display:flex;align-items:center;font-size:1.2em;margin-bottom:1rem;height:28px;>._strike{flex-grow:1;border-top:1px solid ",r.g.colors.separator,";",r.g.classes.margin_near(".5em"),";}}._title{color:",r.g.colors.text_main,";}",""),f=e=>{let{date:t,eventsCount:i,onBackClick:n,showBackButton:s}=e;const o=(0,m.zk)(t);return(0,h.BX)("div",{css:_,children:[(0,h.BX)("div",{className:"topPart headers",children:[s&&(0,h.tZ)(l.JO,{icon:r.g.isRTL?"arrow_right":"arrow_left",smallButtonLike:!0,onClick:n,toolTip:lng("month view")}),(0,h.BX)("b",{className:"_title",children:[lng("daily agenda").caps()," "]}),(0,h.tZ)(d.qp,{time:t,showTime:!1,showYear:!1}),(0,h.tZ)("div",{className:"_strike"})]}),0===i&&(0,h.tZ)("div",{className:"subTitle headers",children:(o?lng("you have no events scheduled today"):lng("no events")).caps()})]})},y=(0,s.iv)(">._picker{>{margin:0 auto;}}>._events{._list{margin-top:1em;overflow:auto;max-height:234px;padding-right:2px;}}&.small{._navigation{",r.g.classes.margin_far("15px"),";}}&.widget{._picker,._events{padding:10px 10px 0;}.day{>div{width:32px;height:37px;padding-top:4px;}}}.event-title{margin-bottom:20px;}",""),w={name:"morozh",styles:"display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding:0 8px;>.text{font-size:21px;font-weight:600;}>.btn{font-size:16px;}"},x=function(e){let{activeDate:t,onDateSelect:i,onMonthChange:r,events:s,className:l,small:d,theme:p,sideComponent:g,onStripClick:b,minimizeOnEmpty:_,monthNavigation:x=!0,defaultDayView:Z=!1}=e;const[C,S]=(0,n.useState)(null),O=e=>(S(e),null==r?void 0:r(e)),[B,T]=(0,n.useState)([]),[N,I]=(0,n.useState)(!0),[D,j]=(0,n.useState)(Z?"day":d?"month":"all"),[P,z]=(0,n.useState)(_);return(0,n.useEffect)((()=>{s&&C&&t.isBetween(C,C.clone().endOf("month"),"day","[]")&&T(s.filter((e=>e.calRelevantForDate(t))).sort(((e,t)=>e.sortTime.diff(t.sortTime))))}),[t,C,s]),(0,n.useEffect)((()=>{j(d?"all"!==D?D:"month":"all")}),[d]),(0,n.useEffect)((()=>{var e;t&&O(null===(e=t.clone)||void 0===e?void 0:e.call(t).startOf("month"))}),[]),P&&0===s.length?(0,h.tZ)(o.W2,{className:"cont-empty",children:(0,h.BX)("div",{css:w,children:[(0,h.tZ)("div",{className:"text",children:lng("no events this month").caps()}),(0,h.tZ)(u.l,{onClick:()=>z(!1),theme:"contained",children:lng("show calendar").caps()})]})}):(0,h.tZ)(o.W2,{css:y,className:(0,c.AK)({small:d,widget:"widget"===p})+" "+l,padded:!1,children:(0,h.BX)(o.U0,{children:["day"!==D&&(0,h.tZ)("div",{className:"_picker",children:(0,h.tZ)(a.M,{activeDate:t,onDateSelect:e=>{null==i||i(e),d&&j("day"),I((0,m.zk)(e))},onMonthChange:O,events:s,monthNavigation:x})}),t&&"month"!==D&&(0,h.tZ)("div",{className:"_events",children:(0,h.BX)(h.HY,{children:["widget"===p?(0,h.tZ)(f,{showBackButton:d,onBackClick:()=>j("month"),date:t,eventsCount:(0,c.zG)(s)?B.length:void 0}):(0,h.tZ)(v,{date:t,eventsCount:(0,c.zG)(s)?B.length:void 0,sideComponent:g}),(0,h.tZ)(k,{events:B,today:N,narrow:"widget"===p,onClick:b})]})})]})})},k=function(e){let{events:t,today:i,narrow:n,onClick:r}=e;if(null==t||!t.length)return null;n=n||(0,c.tq)();const s=e=>e.end_time&&(0,m.CR)(e.end_time);return(0,h.tZ)("div",{className:"_list",children:i?(0,h.BX)(h.HY,{children:[t.filter((e=>!s(e))).map(((e,t)=>(0,h.tZ)(g.Q,{item:e,narrow:n,onClick:r,actions:{action:!0,menu:!0}},t))),t.filter(s).length>0&&(0,h.tZ)("div",{className:"_subTitle",children:lng("earlier today:").caps()}),t.filter(s).map(((e,t)=>(0,h.tZ)(g.Q,{item:e,narrow:n,onClick:r,actions:{action:!0,menu:!0}},t)))]}):t.map(((e,t)=>(0,h.tZ)(g.Q,{item:e,narrow:n,onClick:r,actions:{action:!0,menu:!0}},t)))})}},4238:(e,t,i)=>{i.d(t,{H:()=>T,Y:()=>S});var n=i(7363),r=i(917),s=i(6920),o=i(2213),a=i(4902),l=i(7154),c=i(9180),d=i(3051),p=i(5560),u=i(8318),m=i(539),g=i(6975),h=i(8567),b=i(441),v=i(7392),_=i(2808),f=(i(7882),i(1619)),y=i(1533),w=i(8989),x=i(5680),k=i(9909),Z=i(660),C=i(5944);const S=(0,n.createContext)(null),O=(0,r.iv)("color:",s.g.colors.text_sec,";>.comments_cont>div+div,.sub_comments_cont>div{margin-top:1.5em;}",""),B=e=>(0,r.iv)("display:flex;flex-direction:column;height:",e,";>.comments_cont{flex-grow:1;overflow:auto;}>*:nth-child(2){flex-shrink:0;}",""),T=(0,p.observer)((function(e){let{commentsStore:t,connectTo:i,locked:r,comments:s,setTitle:a,refresh:l,labels:c,editable:d,deletable:p,afterSend:u,confirmSend:g,richTextOptions:h,spreadHeight:b,replying:v,allowFileSharing:_=!1,createTask:f,createSubTask:y,createSiblingTask:w,titles:x,onChangeType:k}=e;const Z=void 0!==s,S=s||t.comments,T=(0,n.useRef)(0);(0,n.useEffect)((()=>{if(l)return T.current=setInterval((()=>t.refresh()),8e3),()=>clearInterval(T.current)}),[]);const N={...h||{font:!0,color:!0,link:!0,attach:_},upload:"comment"},I=(Z||t.ready)&&(0,C.BX)("div",{css:[O,b&&B(b),"",""],className:"Comments",children:[(0,C.tZ)("div",{className:Z?"sub_comments_cont":"comments_cont",children:S.map(((e,t)=>"task_change"===e.type?(0,C.tZ)(z,{comment:e},e.id):(0,C.tZ)(j,{canReply:Z&&t==S.length-1,titles:x,comment:e,locked:r,labelAllowed:c,deletable:p,replying:v,editable:void 0===d||d,createTask:f,createSubTask:y,createSiblingTask:w,onChangeType:k,richTextOptions:N},e.id)))}),!Z&&!r&&(0,C.tZ)(R,{connectTo:i,afterSend:u,confirm:g,richTextOptions:N})]});return t?t.ready?(a&&a(t.title),(0,C.tZ)(o.t0.Provider,{value:t,children:I})):(0,C.tZ)(m.$,{}):I})),N=(0,r.iv)("display:flex;position:relative;>._avatar{position:absolute;top:4px;._white_border_avatar{border:4px solid #FFF;box-sizing:content-box;}}>._main{flex-grow:1;",s.g.classes.margin_near("30px"),";>._data{>._top{display:flex;>._username{color:",s.g.colors.text_main,";font-weight:600;}>._label>span{margin:0 .5em;padding:5px 9px;background-color:#dbdbdd;border-radius:14px;font-weight:600;}._time{font-size:.8em;color:",s.g.colors.text_sec,";display:inline-block;padding-top:3px;}}>._content{margin:0.5em 0;.mentions_box,.mention{",s.g.classes.mention,";.RTL &{padding:0 1px 0 4px;}}}>._bottom{display:flex;>._reply{font-size:.9em;}}}>._collapsed{margin:1em 2em 0;cursor:pointer;color:",s.g.colors.dominant_main,";font-size:.9em;}}._grow{flex-grow:1;}",""),I=(0,p.observer)((e=>{var t,i,r,p,m;let{content:h,comment:f,canReply:y,menuOptions:w,menuOnSelect:k,className:Z,editMode:S,editAction:O,gif:B,file:I,richTextOptions:D,deletable:j,replyToMaster:P,createTaskOptions:z={}}=e;const{user:E,label:F}=f.data,{createTask:A,createSubTask:q,createSiblingTask:X,title:L,parent_title:$}=z,V=(0,n.useContext)(o.t0),U={object_id:f.id,type:"comment"},[H,J]=(0,n.useState)(!!(0,u.B5)(f.id)&&V.rememberedComment(U).notEmpty()),[G,W]=(0,n.useState)((null===(t=f.subComments)||void 0===t?void 0:t.length)<=3),K=G?f.subComments:f.subComments.slice(-3),Y=(null===(i=f.subComments)||void 0===i?void 0:i.length)-3,Q={comment_id:f.id},ee=()=>{O(!0),V.resetRememberedComment(Q)};return(0,C.BX)("div",{css:N,className:Z,ref:f.scrollTo?e=>{e&&setTimeout((()=>{e.scrollIntoView({behavior:"smooth"});const t=e.querySelector("._data");t&&(t.style.border=`1px solid ${s.g.darkMode?s.g.colors.mention_bg:s.g.colors.light_blue}`),f.scrollTo=!1}),700)}:void 0,"data-comment_id":f.id,children:[(0,C.tZ)("div",{className:"_avatar",children:(0,C.tZ)(a.qE,{user:E,size:"30px",className:"_white_border_avatar"})}),(0,C.BX)("div",{className:"_main",children:[(0,C.BX)("div",{className:"_data",children:[(0,C.BX)("div",{className:"_top",children:[(0,C.tZ)("div",{className:"_username",children:(0,u.v2)(E)}),F&&(0,C.tZ)("div",{className:"_label",children:(0,C.tZ)("span",{style:{color:(0,x.qP)(F.toLowerCase()).backgroundColor},children:F.caps()})}),(0,C.tZ)("div",{className:"_grow"}),null!==(r=(f.data.parent||f).connectTo)&&void 0!==r&&null!==(p=r.type)&&void 0!==p&&p.startsWith("task")?(0,C.tZ)(b.A,{href:{edit:"task",id:(f.data.parent||f).connectTo.object_id,section:`c=${f.id}`},newTab:!0,children:(0,C.tZ)(c.ij,{time:f.time,className:"_time"})}):(0,C.tZ)(c.ij,{time:f.time,className:"_time"}),!S&&w&&w.length>0&&(0,C.BX)(C.HY,{children:[" ",(0,C.tZ)(d.x,{className:"_menu",options:w,onSelect:k,inForm:!0,children:(0,C.tZ)(g.JO,{icon:"menu",smallButtonLike:!0})})]})]}),S?(0,C.tZ)(M,{connectTo:Q,onSend:ee,keySubmit:ee,placeholder:lng("write a comment").caps()+"...",files:!!Blsm.isFeatureEnabled("comments_attachments"),giphy:Blsm.prm.giphy,onCancel:()=>{O(!1),V.resetRememberedComment(Q)},richTextOptions:D}):(0,C.BX)(C.HY,{children:[(0,C.tZ)("div",{className:"_content",css:s.g.classes.wysiwyg,children:h}),(0,C.BX)("div",{className:"_bottom",children:[!!(I&&I.file_id&&I.file_name)&&(0,C.tZ)(l.u,{text:I.file_name,children:(0,_.Or)(I.file_name)?(0,C.tZ)(b.A,{href:{file:I},newTab:!0,"data-preview":"img",children:(0,C.tZ)("img",{src:(0,b.p4)({file:I}),alt:"image",style:{maxHeight:"285px",maxWidth:"400px"}})}):(0,C.BX)(b.A,{href:{file:I},newTab:!0,"data-preview":(0,_.BX)(I.file_name),children:[(0,C.tZ)(g.JO,{icon:"attachment"})," ",I.file_name]})}),B&&(0,C.tZ)("img",{className:"comment-gif",src:B}),(0,C.tZ)("div",{className:"_grow"}),!H&&y&&(0,C.tZ)(v.l,{className:"_reply",onClick:()=>"comment"===f.type?P(!0):J(!0),children:lng("reply").caps()})]})]})]}),(null===(m=f.subComments)||void 0===m?void 0:m.length)>0&&(0,C.BX)(C.HY,{children:[!G&&Y>0&&(0,C.BX)("div",{className:"_collapsed",onClick:()=>W(!0),children:[(0,C.tZ)(g.JO,{icon:"reply"})," ",lng("view %s older replies",Y).caps()]}),(0,C.tZ)(T,{connectTo:U,titles:{title:L,parent_title:$},comments:K,deletable:j,richTextOptions:D,replying:J,createTask:A,createSubTask:q,createSiblingTask:X})]}),H&&(0,C.tZ)(R,{connectTo:U,afterSend:()=>J(!1),replyTo:f.chainMembers(!0),richTextOptions:D})]})]})})),D=e=>(0,r.iv)(">._main>._data{background-color:",e.bgColor||s.g.colors.bg_2,";color:",s.g.colors.bg_2_text,";border-radius:",s.g.consts.CONT_BORDER_RADIUS,"px;padding:13px 18px;>._content{._text{word-break:break-all;word-break:break-word;",s.g.classes.editor_directions,";}img{max-width:100%;max-height:300px;}img.emojione{height:1.5em;vertical-align:text-bottom;}}}",""),j=e=>{let{comment:t,locked:i,labelAllowed:r,editable:s,deletable:a,richTextOptions:l,canReply:c,replying:d,createTask:p,createSubTask:m,createSiblingTask:g,titles:v,onChangeType:_}=e;const{file:y,text:x,gif:k,label:O,user:B}=t.data,[T,N]=(0,n.useState)(""),[j,P]=(0,n.useState)(!1),z=(0,n.useContext)(S)||{},E=(0,n.useContext)(o.t0),R=_&&Blsm.user.isPowerManager&&"task"===t.type,F=_&&Blsm.user.isPowerManager&&"task_manager"===t.type;let M={};"delete"===T&&(M={confirmText:lng("delete"),onConfirm:()=>E.deleteComment({comment_id:t.id,...t.connectTo}),onCancel:()=>N("")});let A={};"label"===T&&(A={title:lng("comment label").caps(),onConfirm:e=>{E.setCommentLabel({comment_id:t.id,label:e,...t.connectTo}),N("")},onCancel:()=>N(""),placeholder:lng("label").caps(),confirmText:lng("set"),inputOptions:{suggest:{table:"comments",field:"label"}},startValue:O||""});const q={createTask:p,createSubTask:m,createSiblingTask:g,title:null==v?void 0:v.title,parent_title:null==v?void 0:v.parent_title},X=[];s&&(0,u.Tz)(null==B?void 0:B.user_id)&&X.push({val:"edit",label:lng("edit").caps()}),(a||s&&(0,u.Tz)(null==B?void 0:B.user_id))&&X.push({val:"delete",label:lng("delete").caps()}),r&&X.push({val:"label",label:t.data.label?lng("edit label").caps():lng("add label").caps()}),p&&X.push({val:"create_task",label:lng("create new task").caps()}),m&&X.push({val:"create_sub_task",label:lng("create sub task").caps()}),g&&X.push({val:"create_sibling_task",label:lng("create sibling task").caps()}),F&&X.push({val:"moveToUsers",label:lng("move to user comments").caps()}),R&&X.push({val:"moveToManagers",label:lng("move to manager comments").caps()});const L=e=>{E.change({data:{id:t.id,type:e},callback:()=>{E.fullRefresh(),_()}}),N("")};return(0,C.BX)(C.HY,{children:[(0,C.tZ)(I,{comment:t,content:x&&(0,C.tZ)(f.xn,{className:"_text",content:x}),css:D(z),canReply:c||t.id&&"comment"!==t.type&&!i&&!E.noReplies,menuOptions:X,menuOnSelect:e=>(e=>{var i,n,r,s,o,a,l,c,d;switch(e){case"edit":E.setRememberComment({comment_id:t.id},new Z.g({html:x})),N("edit");break;case"delete":N("delete");break;case"label":N("label");break;case"create_task":w.X.set("create_task_from_comment",{task_description:t.data.text}),(0,b.p4)({edit:"task",params:{ws:t.connectTo.group_id||(null===(i=t.data)||void 0===i||null===(n=i.parent)||void 0===n||null===(r=n.connectTo)||void 0===r?void 0:r.group_id)}},!0);break;case"create_sub_task":w.X.set("create_task_from_comment",{task_description:t.data.text,parent_task_id:E.connectTo.object_id,parent_title:v.title}),(0,b.p4)({edit:"task",params:{ws:t.connectTo.group_id||(null===(s=t.data)||void 0===s||null===(o=s.parent)||void 0===o||null===(a=o.connectTo)||void 0===a?void 0:a.group_id)}},!0);break;case"create_sibling_task":w.X.set("create_task_from_comment",{task_description:t.data.text,parent_task_id:g,parent_title:v.parent_title}),(0,b.p4)({edit:"task",params:{ws:t.connectTo.group_id||(null===(l=t.data)||void 0===l||null===(c=l.parent)||void 0===c||null===(d=c.connectTo)||void 0===d?void 0:d.group_id)}},!0);break;default:N(e)}})(e),gif:k,file:y,editMode:"edit"===T,editAction:e=>{j||(e?(P(!0),E.sendComment(t.id?{comment_id:t.id}:{...t.connectTo},(e=>{P(!1),!0===e&&N("")}))):N(""))},replyToMaster:d,deletable:a,richTextOptions:l,createTaskOptions:q}),"delete"===T&&(0,C.tZ)(h.I4,{...M,children:lng("are you sure you want to delete this comment?").caps()}),"label"===T&&(0,C.tZ)(h.NL,{...A,children:lng("insert comment label").caps()+":"}),"moveToManagers"===T&&(0,C.tZ)(h.I4,{confirmText:lng("move"),onConfirm:()=>L("task_manager"),onCancel:()=>N(""),children:lng("move to manager comments")}),"moveToUsers"===T&&(0,C.tZ)(h.I4,{confirmText:lng("move"),onConfirm:()=>L("task"),onCancel:()=>N(""),children:lng("move to user comments")})]})},P=(0,r.iv)("._content{color:",s.g.colors.bg_2_text,";",s.g.classes.border_near("3px solid #c8cdd0"),";",s.g.classes.padding_near("15px"),";em{font-style:normal;color:",s.g.colors.text_main,";font-weight:600;}._positive{color:",s.g.colors.positive,";}._negative{color:",s.g.colors.negative,";}}>._main>._data{background-color:",s.g.colors.bg_2,";color:",s.g.colors.bg_2_text,";border-radius:",s.g.consts.CONT_BORDER_RADIUS,"px;padding:13px 18px;}",""),z=e=>{let{comment:t}=e;const{change_data:i}=t.data;let n=null;if(i.length){const e=i;let t=1;n=(0,C.tZ)("div",{children:e.map(((i,n)=>{if(!(e.length>+n+1&&e[+n+1]&&JSON.stringify(e[+n+1])===JSON.stringify(e[n]))){const i=t;return t=1,e[n].update?(0,C.BX)("div",{children:[lng("updated the")," ",(0,C.tZ)("em",{children:e[n].update})," ",i>1?lng("%d times",i):""]},n):e[n].set?(0,C.BX)("div",{children:[lng("set")," ",(0,C.tZ)("em",{children:e[n].set})," ",(0,C.tZ)("span",{className:e[n].value?"_positive":"_negative",children:e[n].value?lng("on"):lng("off")}),i>1?lng("%d times",i):""]},n):(0,C.BX)("div",{children:[lng("changed")," ",(0,C.tZ)("em",{children:e[n].field})," ",e[n].previous&&(0,C.BX)(C.HY,{children:[lng("from|value")," ",(0,C.tZ)("em",{style:e[n].previous_color?{color:e[n].previous_color}:void 0,children:e[n].previous})," "]}),lng("to|value")," ",(0,C.tZ)("em",{style:e[n].current_color?{color:e[n].current_color}:void 0,children:e[n].current?e[n].current:(0,C.tZ)("i",{children:lng("empty")})}),i>1?lng("%d times",i):""]},n)}t++}))})}return(0,C.tZ)(I,{comment:t,content:n,css:P})},E=e=>(0,r.iv)(">._content{margin-top:1.5em;position:relative;>._avatar{position:absolute;top:12px;._white_border_avatar{border:4px solid #FFF;box-sizing:content-box;}}>._main{flex-grow:1;",s.g.classes.margin_near("30px"),";background-color:",e.bgColor||s.g.colors.bg_2,";color:",s.g.colors.bg_2_text,";border-radius:",s.g.consts.CONT_BORDER_RADIUS,"px;padding:13px 18px;}}._grow{flex-grow:1;}",""),R=(0,p.observer)((function(e){let{connectTo:t,afterSend:i,replyTo:r,confirm:s,richTextOptions:l}=e;const c=(0,n.useContext)(o.t0),d=(0,n.useContext)(S)||{},[p,u]=(0,n.useState)(!1),[m,g]=(0,n.useState)(!1),b=()=>{(0,h.BB)(lng("are you sure you want to send the message?"),{onConfirm:v,confirmText:lng("send")})},v=()=>{u(!0),c.sendComment(t,(e=>{u(!1),!0===e&&((0,y.flushSync)((()=>g(!0))),g(!1),i&&i())}))};return(0,C.tZ)("div",{css:E(d),children:(0,C.BX)("div",{className:"_content",children:[(0,C.tZ)("div",{className:"_avatar",children:(0,C.tZ)(a.qE,{size:"30px",className:"_white_border_avatar"})}),(0,C.tZ)("div",{className:"_main",children:(0,C.tZ)(M,{richTextOptions:l,onSend:s?b:v,connectTo:t,keySubmit:s?b:v,placeholder:lng("write a comment").caps()+"...",files:!!Blsm.isFeatureEnabled("comments_attachments"),disabled:p,onCancel:i,clear:m,replyTo:r})})]})})})),F=(0,r.iv)("background-color:",s.g.colors.bg_input,";color:",s.g.colors.text_main,";border:1px solid #DCDCDC;border-radius:4px;padding:5px;position:relative;._buttons{position:absolute;bottom:6px;",s.g.far,":7px;.send-msg-icon{color:white;background:",s.g.colors.dominant_main,";padding:5px 10px;border-radius:8px;margin-bottom:5px;}}",""),M=(0,p.observer)((e=>{let{connectTo:t,onSend:i,keySubmit:r,onCancel:s,placeholder:a,files:l,disabled:c,clear:d,replyTo:p,richTextOptions:m}=e;const h=(0,n.useContext)(o.t0);Blsm.prm.disable_comment_attachments&&null!=m&&m.attach&&(m.attach=!1);const b=h.rememberedComment(t),_=(0,n.useRef)();(0,n.useEffect)((()=>{d&&_.current.clear()}),[d]);const f=b.html;return(0,C.tZ)("div",{css:F,children:(0,C.BX)("div",{children:[(0,C.tZ)(k.U,{focusOnShow:!!p,placeholder:a,value:f,loadState:b.state,ref:_,onChange:(e,i)=>{i&&h.setRememberComment(t,i)},keySubmit:r,canMention:Object.keys(h.mentions).length>0,mentions:h.mentions,addMentions:f?[]:p,canFile:l,toolbarOptions:m}),(0,C.BX)("div",{className:"_buttons",children:[s&&(0,C.tZ)(v.l,{className:"_button",onClick:s,children:lng("cancel").caps()}),(0,u.Oz)()?(0,C.tZ)(g.JO,{icon:"send_comment",className:"send-msg-icon",onClick:i,disabled:c||!f}):(0,C.tZ)(v.l,{theme:"contained",className:"_button",onClick:i,disabled:c||!f,children:lng("send").caps()})]})]})})}))},666:(e,t,i)=>{i.d(t,{Ob:()=>r,mG:()=>o});var n=i(6920);const r=()=>Object.values(s).some((e=>e())),s={file:()=>Blsm.canAccessModule("Content")&&Blsm.isFeatureEnabled("content"),text:()=>Blsm.canAccessModule("Content")&&Blsm.isFeatureEnabled("text_based_content"),lti:()=>Blsm.canAccessModule("Content")&&Blsm.isFeatureEnabled("external_content"),Questionnaire:()=>Blsm.canAccessModule("Questionnaires"),Checklist:()=>Blsm.isFeatureEnabled("checklist")&&Blsm.canAccessModule("Content"),kaltura:()=>Blsm.canAccessModule("Content")&&Blsm.InitialData.special.kaltura,t2k_create:()=>Blsm.isFeatureEnabled("integration_t2k")},o=()=>(()=>{let e=[{topic:"content",type:"file",label:lng("file content"),icon:"vendor_file",action:{edit:"content",params:{type:"file"}}},{topic:"content",type:"text",label:lng("text content"),icon:"vendor_text",action:{edit:"content",params:{type:"text"}}},{topic:"other",type:"lti",label:lng("lti content"),icon:"vendor_external",action:{edit:"content",params:{type:"lti"}}},{topic:"questionnaire",type:"Questionnaire",label:lng("questionnaire"),icon:"vendor_test",action:{edit:"content",type:"Questionnaire",params:"wiz"}},{topic:"other",type:"Checklist",label:lng("checklist"),icon:"vendor_checklist",action:{edit:"content",type:"Checklist"}},{topic:"other",type:"kaltura",label:lng("advanced video"),icon:"vendor_video",action:{edit:"content",params:{type:"kaltura"}}},{topic:"other",type:"t2k_create",label:lng("open Create"),action:Blsm.prm.Mainref+"redirect.php?target=t2k_cgs"}];return e=e.filter((e=>s[e.type]())).map((e=>({...e,typeLabel:e.label}))),{types:e,topics:{content:{label:lng("content"),color:n.g.colors.set[1]},questionnaire:{label:lng("questionnaire"),color:n.g.colors.set[2]},other:{label:lng("other"),color:n.g.colors.set[13]}},title:lng("create content")}})().types.map((e=>{let{action:t,label:i,icon:n}=e;return{label:i,href:t,icon:n}}))},2906:(e,t,i)=>{i.d(t,{JH:()=>d,Lj:()=>v,yY:()=>_});var n,r,s=i(8318),o=i(7821),a=i(6920),l=i(2334);function c(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let d=(n=class{constructor(e){var t,i,n,s;c(this,"isEntity",!0),t=this,i="_attr",s=this,(n=r)&&Object.defineProperty(t,i,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(s):void 0}),c(this,"hide_type",void 0),c(this,"isEnterprise",Blsm.checkMod(["","ENT"])),(0,o.makeObservable)(this),this._attr=e}attr(e){return(0,s.DM)(this[e])?this[e]:this._attr[e]}get color(){return a.g.colors.entity[this.type]||a.g.colors.text_black}},p=n.prototype,u="_attr",m=[o.observable],g={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}},b={},Object.keys(g).forEach((function(e){b[e]=g[e]})),b.enumerable=!!b.enumerable,b.configurable=!!b.configurable,("value"in b||b.initializer)&&(b.writable=!0),b=m.slice().reverse().reduce((function(e,t){return t(p,u,e)||e}),b),h&&void 0!==b.initializer&&(b.value=b.initializer?b.initializer.call(h):void 0,b.initializer=void 0),void 0===b.initializer&&(Object.defineProperty(p,u,b),b=null),r=b,n);var p,u,m,g,h,b;const v=(e,t)=>e.isEntity?e.attr(t):e[t];class _ extends d{constructor(){super(...arguments),c(this,"_start_time",void 0),c(this,"_end_time",void 0)}get start_date(){return this.start_time}get start_time(){return this._start_time||(this._start_time=(0,l._3)(this.calcStartTime()))}get end_time(){return this._end_time||(this._end_time=(0,l._3)(this.calcEndTime()))}get sortTime(){return this.start_time}calRelevantForDate(e){return this.start_time,this.end_time,this._start_time?!this._end_time||(0,l.KC)(this._start_time,this._end_time)?(0,l.KC)(e,this._start_time):e.isBetween(this._start_time,this._end_time,"day","[]"):(console.warn("missing _start_time:",this),!1)}}},6418:(e,t,i)=>{i.d(t,{$:()=>w});var n=i(745),r=i(7363),s=i(917),o=i(5560),a=i(441),l=i(6975),c=i(7154),d=i(6920),p=i(8e3),u=i(539),m=i(8318),g=i(5474),h=i(5995),b=i(4238),v=i(2213),_=i(81),f=i(5944);const y=(0,s.iv)("position:fixed;z-index:",d.g.z.file_viewer,";top:0;left:0;width:100vw;height:100vh;background-color:rgba(0, 0, 0, .7);display:flex;flex-direction:column;.prev_cont{display:flex;flex-grow:1;height:100%;&.withComments{.preview{max-width:calc(100vw - 520px);}}.comments{background-color:white;width:500px;padding:15px;}}",""),w=(0,o.observer)((function(e){var t;let{file:i,onClose:n,socialFlag:s}=e;const[o,a]=(0,r.useState)(i),[l,c]=(0,r.useState)(0),[d,u]=(0,r.useState)(!(0,m.Oz)()),g=(0,r.useRef)(),w=(0,r.useRef)(),{type:x,urlParams:Z}=o,S="img"===x,O=null===(t=o.object_ids)||void 0===t?void 0:t[l],B=(0,r.useMemo)((()=>s&&O?new v.pE({type:"file",object_id:O}):null),[O]),[T,N]=(()=>{const[e,t]=(0,r.useState)((0,m.zO)(8,"render"));return[e,()=>setTimeout((()=>t((0,m.zO)(8,"render"))),100)]})();(0,r.useEffect)((()=>{if(x){if(["img","mp4","pdf"].includes(x))if(o.a){const e=[...document.querySelectorAll("a[data-preview]")].filter((e=>{if(!(0,m.FO)(e))return!1;const t=e.getAttribute("data-preview").toLowerCase();return"img"===t||Blsm.prm.extensions.img.includes(t)})).map((e=>e.href)),t=[...new Set(e)];t.length>1&&(w.current=(0,m.wd)((0,m.w6)(t.length).map((e=>lng("file").caps()+" "+(e+1)))),a(Object.assign({},o,{images:t})),c(t.indexOf(o.a.href)))}else w.current=(0,m.wd)((0,m.w6)(o.images.length).map((e=>o.labels&&o.labels[e]||lng("image").caps()+" "+(e+1)))),a(Object.assign({},o,{images:o.images})),c(o.images.indexOf(o.url))}else if(Z){const e=(0,p.SC)("file/preview/&"+(0,m.$t)(Z),{dataType:"json",onError:()=>a({...o,type:"error"})},(e=>{"spreadsheet"===e.type&&e.tables.length>1&&(w.current=(0,m.wd)(e.tables.map((e=>e[0])))),a(Object.assign({},o,e))}));return()=>e&&e.abortFetch()}}),[]),(0,_.OR)("orientationchange",N);const I=w.current,D=(null==I?void 0:I.length)>1,j={req:"vote",type:"file",object_id:O||o.file_id,user_action:"like"},P=D&&(()=>c(l<I.length-1?l+1:0)),z=D&&(()=>c(l>0?l-1:I.length-1)),E=e=>{let t=o;return t.likes[e]={user_vote:"like"===o.likes[e].user_vote?null:"like",likes:"like"===o.likes[e].user_vote?parseInt(o.likes[e].likes)-1:parseInt(o.likes[e].likes)+1},a(Object.assign({},t)),(0,p.SC)("likes",{data:j,method:"POST"})},R=e=>{"Escape"===e.key?n&&n():I&&D&&["ArrowLeft","ArrowRight"].includes(e.key)&&document.activeElement!==g.current&&("ArrowRight"===e.key?P():z())};return S?(0,f.tZ)(h.d,{zoomIn:{step:6},zoomOut:{step:6},doubleClick:{step:6},wheel:{step:s?1:24},options:{minScale:.1},children:e=>(0,f.BX)("div",{css:y,tabIndex:0,ref:e=>null==e?void 0:e.focus(),onKeyUp:R,children:[(0,f.tZ)(k,{data:o,onClose:n,idx:l,selectOptions:I,onCommentsClick:!!s&&(()=>u(!d)),onSelect:e=>c(parseInt(e)),selectRef:g.current,zoomProps:e,onLike:s&&E,onNext:P||void 0,onPrev:z||void 0}),(0,f.BX)("div",{className:(0,m.AK)("prev_cont",{withComments:d&&s&&O}),children:[(0,f.tZ)(C,{data:o,onClose:n,idx:l,zoomProps:e}),d&&s&&O&&(0,f.BX)("div",{className:"comments",children:[(0,f.tZ)("h3",{children:lng("comments").caps()}),(0,f.tZ)(b.H,{locked:!1,commentsStore:B,deletable:!0,connectTo:B.connectTo,refresh:!0,allowFileSharing:!0})]})]})]})},T):(0,f.BX)("div",{css:y,tabIndex:0,ref:e=>null==e?void 0:e.focus(),onKeyUp:R,children:[(0,f.tZ)(k,{data:o,onClose:n,idx:l,selectOptions:I,onSelect:e=>c(parseInt(e)),onNext:P||void 0,onPrev:z||void 0}),(0,f.tZ)(C,{data:o,onClose:n,idx:l})]})})),x=(0,s.iv)("background-color:#323232;padding:10px;box-shadow:0 2px 2px rgba(0, 0, 0, 0.6);z-index:1;color:white;font-weight:600;display:flex;flex-direction:row;.Icon{font-size:1.3rem;vertical-align:middle;padding:8px;border-radius:2px;&:hover{background:rgba(255, 255, 255, .25);}}.preview_select{",d.g.classes.font_reset,";color:",d.g.colors.grey,";margin:0 15px;.InputDropDown{width:100%;}.label_text{padding:8px;}}.preview_tb_part{display:inline-flex;flex-grow:10;width:33%;}.preview_tb_part_start{flex-direction:row;}.preview_tb_part_mid{flex-direction:row;justify-content:center;}.preview_tb_part_end{flex-direction:row-reverse;}",""),k=e=>{var t,i,n;let{data:r,onClose:s,idx:o,selectOptions:p,onSelect:u,onNext:m,onPrev:h,onLike:b,onCommentsClick:v,zoomProps:_}=e;const{type:y}=r,w=null===(t=r.likes)||void 0===t?void 0:t[o];let k;return k=r.urlParams?{file:r.urlParams}:null!==(i=r.images)&&void 0!==i&&i[o]?null===(n=r.images)||void 0===n?void 0:n[o]:r.url,(0,f.BX)("div",{css:x,children:[(0,f.BX)("div",{className:"preview_tb_part preview_tb_part_start",children:[(0,f.tZ)(c.u,{text:lng("close").caps(),noPortal:!0,children:(0,f.tZ)(l.JO,{icon:"arrow_near",onClick:s})}),"img"===y&&p&&(0,f.tZ)("div",{className:"preview_select mobile_off",children:(0,f.tZ)(g.P,{options:p,value:o,onChange:u})}),b&&(0,f.tZ)(l.JO,{icon:"badge-love",onClick:()=>b(o),color:"like"===w.user_vote?d.g.colors.dominant_main:"",badge:w.likes}),v&&(0,f.tZ)(l.JO,{icon:"chat",onClick:()=>v()})]}),(0,f.tZ)("div",{className:"preview_tb_part preview_tb_part_mid",children:"img"===y&&h&&(0,f.BX)("div",{className:"preview_nextprev",children:[(0,f.tZ)(l.JO,{icon:`arrow_go_${d.g.near}`,onClick:h}),(0,f.tZ)(l.JO,{icon:`arrow_go_${d.g.far}`,onClick:m})]})}),(0,f.BX)("div",{className:"preview_tb_part preview_tb_part_end",children:[(0,f.tZ)(a.A,{href:k,newTab:!0,children:(0,f.tZ)(c.u,{text:lng("download").caps(),noPortal:!0,children:(0,f.tZ)(l.JO,{icon:"download"})})}),"img"===y&&(0,f.BX)("div",{className:"tools",children:[(0,f.BX)("span",{children:[Math.round(100*(null==_?void 0:_.scale)),"%"]}),(0,f.tZ)("span",{className:"mobile_off",children:(0,f.tZ)(l.JO,{icon:"sign_plus",onClick:null==_?void 0:_.zoomIn,disabled:(null==_?void 0:_.scale)>=8})}),(0,f.tZ)("span",{className:"mobile_off",children:(0,f.tZ)(l.JO,{icon:"sign_minus",onClick:null==_?void 0:_.zoomOut,disabled:(null==_?void 0:_.scale)<=1})}),(0,f.tZ)("span",{children:(0,f.tZ)(l.JO,{icon:"fullscreen",onClick:null==_?void 0:_.resetTransform})})]})]})]})},Z=(0,s.iv)("color:",d.g.colors.text_main,";height:calc(100% - 61px);flex-grow:1;display:flex;justify-content:center;align-items:center;direction:ltr;width:100%;>.react-transform-component,>.full_size{width:100%;height:100%;overflow:auto;}>div{>iframe{width:100%;height:100%;vertical-align:bottom;border:0!important;}>video{max-width:100%;max-height:calc(100vh - 64px);margin:auto;display:block;}>pre,>table{background:white;}>pre{margin:0;padding:5px;}}",""),C=e=>{let{data:t,onClose:i,idx:n,zoomProps:o}=e;const{type:a,url:l,style:c}=t,d=(0,r.useRef)(),p=(0,r.useRef)(),g=o?e=>{const t=Math.min(1,p.current.offsetHeight/e.target.offsetHeight,p.current.offsetWidth/e.target.offsetWidth),i=(p.current.offsetWidth-e.target.offsetWidth*t)/2,n=(p.current.offsetHeight-e.target.offsetHeight*t)/2;o.setTransform(i,n,t,100)}:void 0;return(0,f.tZ)("div",{css:Z,className:(0,m.AK)("preview backdrop",{"with-zoom":o}),onClick:e=>a&&(e.target.matches(".react-transform-component")||e.target===p.current&&d.current===p.current)&&(null==i?void 0:i()),onMouseDown:e=>d.current=e.target,ref:p,children:(b=(0,f.BX)("div",{className:["spreadsheet","pdf"].includes(a)?"full_size":void 0,children:[!a&&(0,f.tZ)(u.$,{color:"white"}),"error"===a&&(0,f.BX)("pre",{children:[lng("unable to open file")," :("]}),"spreadsheet"===a&&(0,f.tZ)("div",{css:c?(0,s.iv)(c,";",""):void 0,dangerouslySetInnerHTML:{__html:t.tables[n][1]}}),"txt"===a&&(0,f.tZ)("pre",{children:t.txt}),"pdf"===a&&(0,f.tZ)("iframe",{src:Blsm.prm.Mainref+"lib/external/pdfjs-2.16.105-legacy/web/viewer.blossom.php?file="+encodeURIComponent(l),frameBorder:"0",allowFullScreen:!0}),"img"===a&&(0,f.tZ)("img",{src:t.images[n],onLoad:g},n),"mp4"===a&&(0,f.tZ)("video",{controls:!0,autoPlay:!0,children:(0,f.tZ)("source",{type:"video/mp4",src:t.url})})]}),o?(0,f.tZ)(h.U,{children:b}):b)});var b},S=()=>{const[e,t]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{document.addEventListener("click",(e=>{const i=e.target.closest("a[data-preview]");i&&((e,i)=>{const n=e.getAttribute("data-preview"),r=e.href;let s=null;if(["csv","xls","xlsx","txt","log","pdf"].includes(n))if("pdf"===n)s={type:"pdf",a:e,url:r};else{const e=new URLSearchParams(r.split("?")[1]);s={urlParams:Object.fromEntries([...e])}}else"img"===n||Blsm.prm.extensions.img.includes(n)?s={type:"img",a:e,images:[r]}:"mp4"===n?s={type:"mp4",a:e,url:r}:"spreadsheet"===n&&(s={type:"spreadsheet",a:e,url:r});s&&(i.preventDefault(),t(s))})(i,e)}))}),[]),e?(0,f.tZ)(w,{onClose:()=>t(!1),file:e}):null};(0,m.Um)((()=>{document.getElementById("FileViewerOpener")||(0,n.s)((0,m.wq)("FileViewerOpener")).render((0,f.tZ)(S,{}))}))},6005:(e,t,i)=>{i.d(t,{D:()=>d,E:()=>p});var n=i(5560),r=(i(7882),i(676)),s=i(441),o=i(8318),a=i(4061),l=i(6920),c=i(5944);const d=function(e){let{user:t,...i}=e;return(0,c.tZ)(s.A,{...i,href:{user:t.user_id},children:(0,o.v2)(t)})},p=(0,n.observer)((function(e){let{collection:t,noFilterSort:i,actions:n,barExtraComponent:s,filters:o,sticky:d=l.g.consts.TABLE_HEAD_HEIGHT,stickyStartHeight:p=l.g.consts.DEFAULT_STICKY_START_HEIGHT,searchPage:u=!1}=e,m=i?void 0:o||[{name:"content_types",label:lng("content types"),type:"text"}];const g=i?void 0:[{val:"",label:lng("default")}];return(0,c.tZ)(r.iA,{cols:(0,a.Hc)(),collection:t,filters:m,sorts:g,RowRenderer:a.Jv,rowIdCol:"lesson_id",rowProps:{deleteContent:e=>{t.remove(e)}},compact:!0,actions:n,barExtraComponent:s,sticky:d,stickyStartHeight:p,isSearchPage:u})}))},9160:(e,t,i)=>{i.d(t,{b:()=>N});var n=i(7363),r=i(917),s=i(3380),o=i(5560),a=i(6920),l=i(1092),c=(i(7882),i(81)),d=i(7154),p=i(8318),u=i(6975),m=i(8567),g=(i(6344),i(3051)),h=i(2808),b=i(5944);const v=(0,r.iv)("position:relative;width:130px;height:130px;margin-top:10px;",a.g.classes.margin_far("10px"),";border:3px solid ",a.g.colors.border,";border-radius:2px;color:",a.g.colors.text_main,";display:flex;align-items:flex-end;>img,>video{position:absolute;width:100%;height:100%;object-fit:cover;}>._label{z-index:1;width:100%;background-color:",a.g.colors.half_black,";color:",a.g.colors.dominant_white,";padding:3px 6px;font-size:.8em;div{display:block;}._btn{",a.g.classes.ellipsis,";}}",""),_=(0,r.iv)(v,";&._active{border-color:",a.g.colors.dominant_main,";}>._menu{display:none;position:absolute;top:0;right:0;background:rgba(255, 255, 255, .7);padding:2px 5px;}&:hover>._menu{display:block;}",""),f=(0,o.observer)((function(e){let{data:t}=e;const{mf_id:i,file_id:r,imgtag:o,name:l,user_id:c}=t,v=(0,n.useContext)(s.bw),f=l&&(0,p.nu)(l.replace(/^.*[/]/,"")),y=e=>l.replace(f,"")+e+"."+l.split(".")[1],w=()=>{const e=l.split("/"),t=e[e.length-1];return(0,p.nu)(t.split(".")[0])},k=t===v.activeItem;return(0,b.BX)("div",{css:_,className:(0,p.AK)({_active:k}),ref:e=>e&&k&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()&&e.scrollIntoView(!1),onClick:()=>v.activeItem=t,children:[f&&"mp4"===(0,h.BX)(f)?(0,b.tZ)("video",{preload:"metadata",src:a.g.func.imgUrl(o)}):(0,b.tZ)("img",{src:a.g.func.imgUrl(o),loading:"lazy"}),f&&(0,b.tZ)("div",{className:"_label",children:(0,b.tZ)(d.u,{text:f,children:f})}),(Blsm.user.isPowerManager||(0,p.Tz)(c))&&(i||r)&&(0,b.tZ)(b.HY,{children:(0,b.tZ)(g.x,{className:"_menu",options:[{icon:"trash",label:lng("delete"),onClick:()=>(0,m.BB)(lng("are you sure you want to delete this file?").caps(),{onConfirm:()=>v.deleteItem(t),zIndex:a.g.z.dialog_overlay+1})},{icon:"edit",label:lng("rename"),onClick:()=>(0,m.cS)("",{title:lng("rename file"),placeholder:lng("file name"),confirmText:lng("confirm"),inputType:"text",zIndex:a.g.z.dialog_overlay+1,inputRequired:!0,startValue:w(),valueValid:x,onConfirm:e=>{const t=encodeURIComponent(e);v.renameFile({mf_id:i,file_id:r,path:y(t),name:t})}})},{icon:"AssignOutsource",label:lng("move"),onClick:()=>{let e=(0,s.aF)(v.activeTab.startsWith("my")?"my":v.activeTab).filter((e=>e+"/"!==v.activeFolder)).map((e=>({val:e,label:e})));""!==v.activeFolder&&e.push({val:"",label:lng("parent folder")}),(0,m.cS)("",{title:lng("move file"),inputType:"select",zIndex:a.g.z.dialog_overlay+1,selectOptions:e,placeholder:lng("target folder"),inputOptions:{caps:!1},onConfirm:e=>v.moveFile({folder:e,file:t})})}}],children:(0,b.tZ)(u.JO,{icon:"menu"})})})]})})),y=(0,r.iv)(v,";background-position:center;background-size:70px;background-repeat:no-repeat;>._rename{display:none;position:absolute;top:0;right:0;background:rgba(255, 255, 255, .7);padding:2px 5px;}&:hover>._rename{display:block;}",""),w=(0,o.observer)((function(e){let{data:t}=e;const{name:i,temp:r}=t,o=(0,n.useContext)(s.bw),a="../"===i;return(0,b.BX)("div",{css:y,onClick:()=>{a?(o.activeFolder=o.activeFolder.slice(0,-1).split("/").slice(0,-1).join("/"),""!==o.activeFolder&&(o.activeFolder+="/")):o.activeFolder+=i},style:{backgroundImage:`url("${Blsm.prm.Mainref}images/v4/folder${a?"_up":""}.svg")`},children:[(0,b.tZ)("div",{className:"_label",children:(0,b.tZ)(d.u,{text:i.slice(0,-1),children:i.slice(0,-1)})}),!a&&Blsm.user.isPowerManager&&(0,b.tZ)("div",{className:"_rename",children:(0,b.tZ)(u.JO,{icon:"edit",onClick:e=>(e.stopPropagation(),(0,m.cS)("",{title:lng("set folder name"),placeholder:lng("folder name"),confirmText:lng("confirm"),inputType:"text",inputRequired:!0,startValue:i.slice(0,-1),valueValid:x,onConfirm:e=>o.renameFolder({path:o.activeFolder+i,name:e,temp:r,tab:o.activeTab})}))})})]})})),x=e=>!/\/|\.\.|%2F|\.$|^\./.test(e),k=(0,r.iv)(v,";align-items:center;justify-content:center;flex-direction:column;text-align:center;",a.g.classes.drop_button,";.Icon{font-size:30px;margin-bottom:10px;}>*{max-width:100%;}>input{display:none;}",""),Z=()=>{const e=(0,n.useContext)(s.bw),t=(0,b.BX)("label",{css:k,children:[(0,b.tZ)(u.JO,{icon:"mark_plus_light",balloonAnchor:!1}),(0,b.tZ)("div",{children:lng("click or drag to add items").caps()}),(0,b.tZ)("input",{type:"file",accept:e.extensions.map((e=>"."+e)).join(","),onChange:t=>t.target.files.length&&e.uploadItems(t.target.files),multiple:!0})]});return e.albumId?t:(0,b.tZ)(g.x,{options:[("images"===e.activeTab||"my_images"===e.activeTab)&&{label:lng("pick a color..."),onClick:()=>(0,m.cS)("",{title:lng("select color"),confirmText:lng("save"),inputType:"color",inputRequired:!0,onConfirm:t=>e.createFromColor(t)})},{label:lng("new folder"),onClick:()=>(0,m.cS)("",{title:lng("create folder"),placeholder:lng("folder name"),confirmText:lng("confirm"),inputType:"text",inputRequired:!0,onConfirm:t=>t&&e.createNewFolder(t)})}],inForm:!0,children:t})},C=(0,o.observer)((function(e){let{data:t}=e;const{progress:i,name:n}=t;return(0,b.tZ)("div",{css:v,ref:e=>e&&e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()&&e.scrollIntoView(!1),style:a.g.styles.progressBG(i),children:(0,b.tZ)("div",{className:"_label",children:(0,b.tZ)(d.u,{text:n,children:n})})})}));var S=i(3346),O=i(539),B=i(5007),T=i(8207);const N=e=>{let{onSelect:t,selectedItem:i,mediaStore:r=null,tabs:o=["images","gallery"],my:a=!0,dialog:l=!1}=e;const c=(0,n.useMemo)((()=>r||new s.Er({tabs:o,activeItemUrl:i||null,my:a})),[r]),[d,p]=(0,n.useState)(!1),u=l?()=>(0,B.vm)().closeDialog():()=>p(!1),m=[{label:t?lng("cancel"):lng("close"),action:u},t&&{label:lng("confirm"),action:()=>(t(c.activeItem),u())}].filter((e=>!!e)),g=(0,b.tZ)(s.bw.Provider,{value:c,children:(0,b.tZ)(E,{onClose:u})}),h=(0,b.tZ)(P,{store:c});if(l)return()=>(0,B.vm)().openDialog("Component",{child:g,title:lng("media manager").caps(),width:"90vw",options:{tailButtons:m,fullHeight:!0},padded:!0,headExtra:h});return[(0,b.tZ)(D,{tabs:h,tail:m,onClose:u,mediaManager:g,show:d}),()=>p(!0)]};var I={name:"1gbktcb",styles:"overflow-y:scroll;height:calc(100vh - 165px);padding:20px"};const D=(0,o.observer)((function(e){let{tabs:t,tail:i,onClose:n,mediaManager:r,show:s}=e;return(0,c.IV)(n,"MediaManager",{disable:!s}),s?(0,b.tZ)(T.T,{width:"90vw",fullHeight:!0,title:lng("media manager").caps(),headTabs:t,tailButtons:i,onClose:n,children:(0,b.tZ)("div",{css:I,children:r})}):null})),j=(0,r.iv)("._tabs{width:100%;margin-bottom:-12px;",a.g.classes.margin_near("3em"),";font-weight:600;._active{font-weight:700;}}",""),P=(0,o.observer)((function(e){let{store:t}=e;const i=Object.keys(t.tabs).map((e=>({val:e,label:t.allTabs[e]||e})));return t.ready?(0,b.tZ)("div",{css:j,children:(0,b.tZ)(l.m,{tabs:i,activeTab:t.activeTab,onSelect:e=>{t.activeTab=e,t.activeFolder=""},className:"_tabs"})}):null})),z={name:"13akqc2",styles:".dropzone{position:absolute;left:15px;top:55px;width:calc(100% - 30px);height:calc(100% - 101px);}.manager{._field_wrapper{max-width:500px;}}.searchBar{display:flex;align-items:baseline;>*:first-child{flex-grow:1;}}"},E=(0,o.observer)((function(){var e;const t=(0,n.useContext)(s.bw),{dndEvents:i}=(0,c.aZ)(t.uploadItems);return t.ready?(0,b.BX)("div",{css:z,children:["gallery"!==t.activeTab&&t.activeFolder&&(0,b.BX)("span",{style:{fontWeight:600},children:[lng("folder").caps(),": ",t.activeFolder.slice(0,-1)]}),"gallery"===t.activeTab?(0,b.tZ)(R,{sections:t.tabs[t.activeTab]}):(0,b.BX)("div",{className:"manager",children:[(0,b.BX)("div",{className:"searchBar",children:[(0,b.tZ)(S.gN,{input:{type:"text",label:lng("search"),onMouseDown:e=>e.stopPropagation()},value:t.search,onChange:e=>t.search=e}),!(null!==(e=t.activeTab)&&void 0!==e&&e.startsWith("my_"))&&(0,b.tZ)(S.gN,{input:{type:"checkbox",label:lng("uploaded by me")},value:t.byMe,onChange:e=>t.byMe=e})]}),(0,b.tZ)(M,{items:null==t?void 0:t.itemsInFolder,mayAdd:!0}),(0,b.tZ)("div",{css:a.g.classes.dropzone,className:"dropzone",...i,children:lng("drop files here").caps()})]})]}):(0,b.tZ)(O.$,{})})),R=e=>{let{sections:t}=e;return(0,b.tZ)("div",{children:Object.entries(t).map((e=>{let[t,i]=e;return(0,b.tZ)(M,{title:t,items:i},t)}))})},F=(0,r.iv)(">._title{margin-top:10px;font-weight:600;color:",a.g.colors.text_main,";border-bottom:1px solid ",a.g.colors.border,";}>.thumbs{display:flex;flex-wrap:wrap;}",""),M=(0,o.observer)((function(e){let{items:t,title:i,mayAdd:n}=e;return(0,b.BX)("div",{css:F,children:[i&&(0,b.tZ)("div",{className:"_title",children:i.caps()}),(0,b.BX)("div",{className:"thumbs",children:[n&&(0,b.tZ)(Z,{}),null==t?void 0:t.map((e=>e.folder?(0,b.tZ)(w,{data:e},e.name):void 0!==e.progress?(0,b.tZ)(C,{data:e},e.mf_id):(0,b.tZ)(f,{data:e},e.imgtag)))]})]})}))},1766:(e,t,i)=>{i.d(t,{Ql:()=>f,Ux:()=>R,uP:()=>v});var n=i(5560),r=i(917),s=i(6920),o=i(8318),a=i(236),l=i(6852),c=i(5967),d=i(441),p=(i(7882),i(2334)),u=i(7376),m=i(5875),g=i(4877),h=i(5944);var b={name:"pktzvw",styles:"background-color:transparent;border-color:transparent;>a._title{font-size:1.1em;}"};const v=(0,n.observer)((function(e){let{reports:t,reportsBundle:i,group_id:n,workspace:r,...o}=e;const l=b;return(0,h.BX)(a.Hl,{children:[(null==i?void 0:i.length)>0&&(0,h.tZ)(a.$L,{css:l,title:lng("additional reports"),children:(0,h.tZ)("div",{css:(0,g.Kv)({borderless:!0}),children:i.filter((e=>e)).map(((e,t)=>{const i=_(e,r);if(i)return(0,h.tZ)(m.o,{icon:"report",iconColor:s.g.colors.dominant_main,condenced:!0,title:R[e].caps(),href:i,newTab:!0,inContainer:!0,style:{textAlign:"center"}},t)}))})}),Object.keys(t).map((e=>t[e]&&(0,h.tZ)(f,{report:e,data:t[e],group_id:n,...o},e)))]})})),_=(e,t)=>{var i,n;switch(e){case"ReportGroupStatus":return(0,d.p4)({report:"ReportGroupStatus"});case"CourseGradesReport":return(0,d.p4)({report:"CourseGradesReport"});case"ReportGroupMeetings":return(0,d.p4)({report:"ReportGroupMeetings"});case"ReportCompletion":return(0,d.p4)({report:"ReportCompletion"});case"GroupCourseParticipation":return!!("Qualification"===t.group_type&&["public","register"].includes(t.group_access)||"Qualification"!==t.group_type)&&(0,d.p4)({report:"GroupCourseParticipation",params:{group:t.group_id}});case"WorkspaceMembersListing":return(null===(i=t.members)||void 0===i?void 0:i.length)>0&&(0,d.p4)({report:"WorkspaceMembersListing",params:{group:t.group_id}});case"MeetingsSummary":return t.meetings.length>0&&(0,d.p4)({report:"MeetingsSummary",params:{group:t.group_id}});case"OnlineContentUsage":return(0,d.p4)({report:"OnlineContentUsage"});case"RatingsReport":return!(!Blsm.isFeatureEnabled("rating_tool")||!t.rating)&&(0,d.p4)({report:"RatingsReport",params:{group:t.group_id}});case"ReportCoursesinstructors":return!!(Blsm.isFeatureEnabled("resources")&&t.meetings.length>0)&&(0,d.p4)({report:"ReportCoursesinstructors",params:{group:t.group_id}});case"ReportMeetingsSchedule":return t.meetings.length>0&&(0,d.p4)({report:"ReportMeetingsSchedule",params:{range:"nextmonth",group:t.group_id}});case"ReportGroupParticipation":return(0,d.p4)({report:"ReportGroupParticipation"});case"ReportQualifications":return(0,d.p4)({report:"ReportQualifications"});case"BasicQualificationReport":return(0,d.p4)({report:"BasicQualificationReport",params:{group:t.group_id,qualification:t.group_id}});case"QualificationDependencies":return(null===(n=t.required_courses)||void 0===n?void 0:n.length)>0&&(0,d.p4)({report:"QualificationDependencies",params:{qualification:t.group_id}});case"QualificationComponents":{var r;let e="";return null===(r=t.members)||void 0===r||r.forEach((t=>e+=`${t.user_id}_`)),(0,d.p4)({report:"QualificationComponents",params:{user:e,qualification:t.group_id,group:t.group_id}})}case"Report_Approvals_Status_Reg":return!!t.sequence_id&&(0,d.p4)({report:"Report_Approvals_Status_Reg",params:{group:t.group_id}});case"PastQualificationPerformances":return(0,d.p4)({report:"PastQualificationPerformances",params:{qualification:t.group_id}})}},f=e=>{switch(e.report){case"ReportGroupStatus":return(0,h.tZ)(x,{...e});case"CourseGradesReport":return(0,h.tZ)(k,{...e});case"ReportGroupMeetings":return(0,h.tZ)(Z,{...e});case"ReportCompletion":return(0,h.tZ)(C,{...e});case"AssignmentCompletionReport":return(0,h.tZ)(B,{...e});case"ReportOuQualificationStatus":return(0,h.tZ)(T,{...e});case"OuStatusInCourses":return(0,h.tZ)(N,{...e});case"MembersVisitReport":return(0,h.tZ)(I,{...e});case"FormsPerformancesReport":return(0,h.tZ)(D,{...e});case"ReportAccumulativeAssignments":return(0,h.tZ)(j,{...e});case"OuCoursesPlanExecute":return(0,h.tZ)(P,{...e});case"ReportQualifications":return(0,h.tZ)(S,{...e});case"TasksStatusReport":return(0,h.tZ)(O,{...e});case"ReportParticipationPlanning":return(0,h.tZ)(z,{...e});default:return(0,h.tZ)(E,{...e})}},y=(0,r.iv)("display:flex;flex-direction:column;height:100%;._stats_section{display:flex;justify-content:space-around;flex-grow:1;align-items:center;._stat{height:60px;text-align:center;._number{font-weight:lighter;font-size:1.6em;color:",s.g.colors.text_sec,";}}}&._single{._chart_section{display:flex;flex-direction:column;height:100%;._chart{flex-grow:1;}}._stats_section{flex-wrap:wrap;justify-content:center;._stat{width:50%;}}}&._both{._chart_section{display:flex;border-top:1px solid ",s.g.colors.separator,";._chart{width:55%;padding:20px;}}}",""),w=e=>{let{chart:t,chartData:i,passed_total:n=null,title:r,link:s,onlyPercent:o,stats:d,wrapWidget:p=!0}=e;const u=n||(i&&"time"!==t?i.reduce(((e,t)=>e+parseFloat(t.number)),0):0),m=(0,h.BX)("div",{css:y,className:null!=d&&d.length&&null!=i&&i.length?"_both":"_single",children:[(null==d?void 0:d.length)>0&&(0,h.tZ)("div",{className:"_stats_section",children:d.map(((e,t)=>(0,h.BX)("div",{className:"_stat",children:[(0,h.tZ)("div",{children:e.label.caps()}),(0,h.tZ)("div",{className:"_number",children:e.number})]},t)))}),"time"===t&&(0,h.tZ)("div",{className:"_chart_section",children:(0,h.tZ)("div",{className:"_chart",children:(0,h.tZ)(l.k,{type:t,data:i})})}),(null==i?void 0:i.length)>0&&(0,h.BX)("div",{className:"_chart_section",children:[(0,h.tZ)("div",{className:"_chart",children:(0,h.tZ)(l.k,{type:t,data:i})}),(0,h.tZ)(c.Q,{side:(null==d?void 0:d.length)>0&&(null==i?void 0:i.length)>0,children:i.map(((e,t)=>!e.hideInLegend&&(0,h.tZ)(c.t,{denominator:u,numerator:e.number||0,label:e.label,color:e.color,onlyPercent:o},t)))})]})]});return p?(0,h.tZ)(a.$L,{title:r,link:s,children:m}):m},x=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("passed"),color:s.g.colors.chart.success,number:t.completed_course},{label:lng("failed"),color:s.g.colors.chart.failure,number:t.failed_course},{label:lng("not completed"),color:s.g.colors.chart.waiting,number:t.not_completed}];return(0,h.tZ)(w,{chart:"pie",chartData:r,title:R.ReportGroupStatus,link:(0,d.p4)({report:"ReportGroupStatus",params:{group:i}}),...n})},k=e=>{let{data:t,group_id:i,...n}=e;const r=Math.round(t.avg_score),o=r<33?s.g.colors.chart.failure:r<66?s.g.colors.chart.waiting:s.g.colors.chart.success,a=[{label:lng("average score"),color:o,number:r},{label:"",color:s.g.colors.chart.bg,number:100-r,hideInLegend:!0}];return(0,h.tZ)(w,{chart:"pie",chartData:a,title:R.CourseGradesReport,link:(0,d.p4)({report:"CourseGradesReport",params:{group:i}}),...n})},Z=e=>{let{data:t,group_id:i,...n}=e;const r=t.attendees*t.meetings,o=[{label:lng("attendance"),color:s.g.colors.chart.success,number:t.attended},{label:lng("absence"),color:s.g.colors.chart.failure,number:r-t.attended}];return(0,h.tZ)(w,{chart:"pie",chartData:o,title:lng("group meetings"),link:(0,d.p4)({report:"ReportGroupMeetings",params:{group:i}}),onlyPercent:!0,...n})},C=e=>{var t;let{data:i,group_id:n,...r}=e;const o=i.total-(parseInt(i.completed)+parseInt(i.failed)+parseInt(i.waiting)),a=null===(t=i.list_assignments)||void 0===t?void 0:t.replaceAll(",","_"),l=[{label:lng("success"),color:s.g.colors.chart.success,number:i.completed},{label:lng("failure"),color:s.g.colors.chart.failure,number:i.failed},{label:lng("in process"),color:s.g.colors.chart.progress,number:i.waiting},{label:lng("no progress"),color:s.g.colors.chart.waiting,number:o}];return(0,h.tZ)(w,{chart:"pie",chartData:l,title:lng("completion report"),link:(0,d.p4)({report:"ReportCompletion",params:{group:n,assignment:a}}),onlyPercent:!0,...r})},S=e=>{let{data:t,group_id:i,...n}=e;const r=t.in_process+t.renewing,o=[{label:lng("completed"),color:s.g.colors.chart.success,number:t.completed},{label:lng("expired"),color:s.g.colors.chart.failure,number:t.expired},{label:lng("in process")+" / "+lng("renewing"),color:s.g.colors.chart.progress,number:r},{label:lng("not completed"),color:s.g.colors.chart.waiting,number:t.not_completed}];return(0,h.tZ)(w,{chart:"pie",chartData:o,title:lng("qualifications report"),link:(0,d.p4)({report:"ReportQualifications",params:{qualification:i}}),onlyPercent:!0,...n})},O=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("open"),color:(0,u.Pp)("open"),number:t.open},{label:lng("closed"),color:(0,u.Pp)("closed"),number:t.closed},{label:lng("on hold"),color:(0,u.Pp)("on_hold"),number:t.on_hold}];return(0,h.tZ)(w,{chart:"pie",chartData:r,title:lng("tasks status report"),link:(0,d.p4)({report:"TasksStatusReport",params:{group:i}}),...n})},B=e=>{let{data:t,group_id:i,...n}=e;const r=t.total-(parseInt(t.success)+parseInt(t.failed)),o=[{label:lng("success"),color:s.g.colors.chart.success,number:t.success},{label:lng("failure"),color:s.g.colors.chart.failure,number:t.failed},{label:lng("no progress"),color:s.g.colors.chart.waiting,number:r}];return(0,h.tZ)(w,{chart:"pie",chartData:o,title:lng("org' unit assignment completion"),link:(0,d.p4)({report:"AssignmentCompletionReport",params:{ou:i}}),onlyPercent:!0,...n})},T=e=>{let{data:t,group_id:i,...n}=e;const r=(0,o.NM)(t.completed/t.qualifications_count*100,2),a=[{label:lng("progress"),color:s.g.colors.chart.progress,number:r},{label:lng("certified"),color:s.g.colors.chart.success,number:t.certified},{label:lng("no progress"),color:s.g.colors.chart.waiting,number:100-r}],l=[{label:lng("members"),color:"title",number:t.members},{label:lng("registered"),number:t.registered}];return(0,h.tZ)(w,{chart:"pie",chartData:a,stats:l,title:lng("org' unit qualifications"),link:(0,d.p4)({report:"ReportOuQualificationStatus",params:{ou:i}}),onlyPercent:!0,...n})},N=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("never started"),color:s.g.colors.chart.waiting,number:t.never_started},{label:lng("in process"),color:s.g.colors.chart.progress,number:t.in_process},{label:lng("completed"),color:s.g.colors.chart.success,number:t.completed}];return(0,h.tZ)(w,{chart:"pie",chartData:r,stats:[{label:lng("in courses"),number:t.in_courses}],title:lng("org' unit status in courses"),link:(0,d.p4)({report:"OuStatusInCourses",params:{ou:i}}),...n})},I=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("visited"),color:s.g.colors.chart.success,number:t.visited},{label:lng("first session"),color:s.g.colors.chart.progress,number:t.first_session},{label:lng("never logged"),color:s.g.colors.chart.waiting,number:t.never_logged},{label:lng("returning"),color:s.g.colors.chart.inactive,number:t.returning_users}];return(0,h.tZ)(w,{chart:"pie",passed_total:t.members,chartData:r,title:lng("org' unit members visit"),link:(0,d.p4)({report:"MembersVisitReport",params:{ou:i,range:"month"}}),...n})},D=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("forms performed"),number:t.count},{label:lng("last date performed"),number:(0,p.GG)(t.last_date)}];return(0,h.tZ)(w,{stats:r,title:lng("forms performances"),link:(0,d.p4)({report:"FormsPerformancesReport",params:{group:i}}),...n})},j=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("users"),number:t.user_count},{label:lng("assignments"),number:t.assignment_count+"%"},{label:lng("total performance"),number:(0,o.NM)(t.performance_sum/t.accumulation_sum*100)+"%"},{label:lng("average performance"),number:(0,o.NM)(t.avg_performance_percent)+"%"}];return(0,h.tZ)(w,{stats:r,title:lng("accumulative assignments"),link:(0,d.p4)({report:"ReportAccumulativeAssignments",params:{group:i}}),...n})},P=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("visited"),color:s.g.colors.chart.success,number:t.participants},{label:lng("first session"),color:s.g.colors.chart.waiting,number:t.members-t.participants}],a=[{label:lng("average score"),number:(0,o.NM)(t.avg_score)},{label:lng("average survey"),number:(0,o.NM)(t.avg_survey)},{label:lng("members"),number:t.members}];return(0,h.tZ)(w,{chart:"pie",chartData:r,stats:a,title:lng("org' unit courses plan execute"),link:(0,d.p4)({report:"OuCoursesPlanExecute",params:{ou:i}}),...n})},z=e=>{let{data:t,group_id:i,...n}=e;const r=[{label:lng("planned participants"),number:t[0].stats.total}];return(0,h.tZ)(w,{chart:"time",chartData:t[0].data,stats:r,title:lng("participation planning"),link:(0,d.p4)({report:"ReportParticipationPlanning",params:{group:i}}),...n})},E=e=>{let{data:t,group_id:i,report:n,wrapWidget:r=!0,...o}=e;const c=(0,h.tZ)(l.k,{type:"pie",data:{labels:["success","failure","waiting"],datasets:[{data:[300,50,100],backgroundColor:[s.g.colors.chart.success,s.g.colors.chart.failure,s.g.colors.chart.waiting]}],...t},...o});return r?(0,h.tZ)(a.$L,{title:n,link:void 0!==o.link?o.link:(0,d.p4)({report:n,params:{group:i}}),children:c}):c},R={ReportGroupStatus:lng("workspace status"),CourseGradesReport:lng("grades report"),ReportGroupMeetings:lng("meetings"),ReportCourseMonitoring:lng("course monitoring"),ReportCompletion:lng("completion|report"),ReportQualifications:lng("qualifications"),AssignmentCompletionReport:lng("org' unit assignments completion"),ReportOuQualificationStatus:lng("org' unit qualification status"),OuStatusInCourses:lng("courses status"),MembersVisitReport:lng("members visits"),OuCoursesPlanExecute:lng("org' unit courses plan execute"),TasksStatusReport:lng("tasks status"),RatingsReport:lng("rating report"),RatingsReportInstructor:lng("ratings report instructor"),FormsPerformancesReport:lng("forms performances"),OuCompetencyReport:lng("org' unit competency level"),UserQualificationProgression:lng("qualification progression"),BasicQualificationReport:lng("basic qualification report"),GroupCourseParticipation:lng("course participation report"),WorkspaceMembersListing:lng("workspace members listing"),MeetingsSummary:lng("meetings summary"),ReportCoursesinstructors:lng("course instructors report"),ReportMeetingsSchedule:lng("meetings schedule"),QualificationDependencies:lng("qualification dependencies"),QualificationComponents:lng("qualification components"),Report_Approvals_Status_Reg:lng("courses registration request status"),PastQualificationPerformances:lng("past qualification performances")}},3016:(e,t,i)=>{i.d(t,{O:()=>f});var n=i(5560),r=i(5832),s=i(6920),o=i(676),a=(i(7882),i(7363)),l=i(6975),c=i(441),d=i(4902),p=i(9180),u=i(917),m=i(9483),g=i(236),h=i(81),b=i(8318),v=i(9637),_=i(5944);const f=(0,n.observer)((function(e){let{filteredItems:t,items:i,filterNsort:n,actions:l,showWorkspace:c,removeBlog:d,toggleUserVotePost:p,toggleLockPostComments:u,setActiveBlog:m}=e;const g=(0,r._V)("type",i).map((e=>Object.assign(e,{color:s.g.colors.entity[e.val],icon:"blog"===e.val?"vendor_blog":e.val,label:"blog"===e.val?lng("blogs"):"discussion"===e.val?lng("discussions",{phrase:!0}):e.val})));let b=[g.length>1&&{name:"type",label:lng("type"),type:"button_toggle",options:g},{name:"title",label:lng("title"),type:"text",outOfMenu:!0}];const v=[{val:"",label:lng("default")},{val:"type",label:lng("type")},{val:"title",label:lng("title")}],f=[{title:lng("type"),sortVal:"type"},{title:lng("title"),sortVal:"title"},{title:lng("author")},c&&{title:lng("workspace")},{title:lng("last modified")},{title:lng("comments")},{title:lng("actions")}],{width:x}=(0,h.iP)(),k=(0,a.useMemo)((()=>x<1224),[x]);return(0,_.tZ)(o.iA,{cols:f,collection:t,filters:b,sorts:v,filterNsort:n,actions:l,RowRenderer:y,rowProps:{showWorkspace:c,removeBlog:d,toggleUserVotePost:p,toggleLockPostComments:u,setActiveBlog:m},rowIdCol:"id",tableReplacement:k&&(0,_.tZ)(w,{discussions:t||i,rowProps:{setActiveBlog:m}})})})),y=(0,n.observer)((function(e){var t,i;let{row:n,rowProps:r}=e;const{type:o,blog_id:a,discussion_id:u,mayEdit:m,lesson_options:g,date:h,user:f,comments_count:y,likes:w,group_name:x,data:k}=n,{removeBlog:Z,toggleLockPostComments:C,toggleUserVotePost:S,setActiveBlog:O}=r,B="blog"===o,T="discussion"===o,N=B?a:T?u:null,I=B?null==g?void 0:g.lock_comments:T?"1"===(null==k?void 0:k.locked):null,D=T?null==k||null===(t=k.likes)||void 0===t?void 0:t.likes:B?null==w?void 0:w.likes:null,j=T?null==k||null===(i=k.likes)||void 0===i?void 0:i.user_vote:B?null==w?void 0:w.user_vote:null;let P=null;"discussion"===o?P=(0,_.tZ)(l.JO,{icon:"discussion",toolTip:lng("discussion"),color:s.g.colors.entity.discussion}):"blog"===o&&(P=(0,_.tZ)(l.JO,{icon:"vendor_blog",toolTip:lng("blog",{phrase:!0}),color:s.g.colors.entity.blog}));const z=(0,b.Tz)(f.user_id)||Blsm.user.isPowerManager;return(0,_.BX)("tr",{onClick:()=>("discussion"===n.type&&(0,c.p4)({edit:"discussion",params:{id:n.discussion_id,ws:n.data.group_id}},!0),void("blog"===n.type&&O(N,o))),children:[(0,_.tZ)("td",{className:"_type_icon",children:P}),(0,_.tZ)(v.U6,{children:n.title}),(0,_.tZ)("td",{children:(0,_.tZ)(d.qE,{user:f})}),r.showWorkspace&&(0,_.tZ)("td",{children:x}),(0,_.tZ)("td",{children:(0,_.tZ)(p.ij,{time:h})}),(0,_.BX)("td",{children:[(0,_.tZ)(l.JO,{icon:"discussion"})," ",y?y+" "+lng("comments"):lng("no comments").caps()]}),(0,_.BX)(v.jA,{children:[T&&(0,_.tZ)(l.JO,{icon:j?"love_full":"love",buttonLike:!0,badge:D,onClick:()=>S(N,o),color:j?s.g.colors.dominant_main:void 0}),(B||T)&&Blsm.isFeatureEnabled("assignments_comments")&&z&&(0,_.tZ)(l.JO,{icon:"lock",color:I?s.g.colors.negative:s.g.colors.text_sec,toolTip:I?lng("click to unlock %s",o):lng("click to lock %s",o),onClick:()=>C(N,o)}),m&&(0,_.tZ)(l.JO,{icon:"edit",buttonLike:!0,onClick:()=>(0,c.p4)({edit:"content",id:N},!0)})," ",m&&(0,_.tZ)(l.JO,{icon:"trash",buttonLike:!0,onClick:()=>Z(N,o)})]})]})})),w=e=>{let{discussions:t,rowProps:i}=e;return(0,_.BX)(g.Hl,{children:[t.map((e=>(0,_.tZ)(k,{discussion:e,rowProps:i},e.discussion_id))),(0,b.w6)(3).map((e=>(0,_.tZ)("div",{className:"_filler"},e)))]})},x=(0,u.iv)("padding:7px;margin-top:10px;border-radius:8px;background-color:#FFF;",s.g.classes.shadow_light,";position:relative;min-width:",s.g.consts.CARD_WIDTH,"px;width:",s.g.consts.CARD_WIDTH,"px;a{display:flex;flex-direction:column;justify-content:space-between;min-height:125px;}&:hover{",s.g.classes.shadow_strong,";background-color:",s.g.colors.dominant_main_shade,";}.meta-row{display:flex;justify-content:space-between;font-size:.9em;margin-bottom:7px;>span{max-width:35%;max-height:35px;}&.bottom{align-items:flex-end;}}._title{color:",s.g.colors.text_main,";font-size:1.1em;font-weight:600;margin-bottom:7px;text-align:justify;white-space:nowrap;}.selected &{background-color:",s.g.colors.dominant_main_shade,";}.dragging &{background-color:",s.g.colors.dominant_main_shade,";}",""),k=(0,n.observer)((function(e){let{discussion:t,topRightIcon:i,rowProps:n}=e;const{setActiveBlog:r}=n,{type:o,blog_id:a,discussion_id:d,data:u}=t,g="blog"===o,h="discussion"===o;return(0,_.tZ)("div",{css:x,children:(0,_.BX)(c.A,{href:h?{edit:"discussion",params:{id:d,ws:null==u?void 0:u.group_id}}:void 0,onClick:g?()=>r(a,o):void 0,children:[(0,_.BX)("div",{className:"meta-row",children:[(0,_.BX)("span",{children:[h&&(0,_.tZ)(l.JO,{icon:"discussion",toolTip:lng("discussion"),color:s.g.colors.entity.discussion}),g&&(0,_.tZ)(l.JO,{icon:"vendor_blog",toolTip:lng("blog",{phrase:!0}),color:s.g.colors.entity.blog}),lng(t.type,{phrase:!0})]}),(0,_.tZ)("span",{children:(0,_.tZ)(p.ij,{time:t.date})}),i]}),(0,_.tZ)("div",{className:"_title",children:(0,_.tZ)(m.m,{children:t.title})}),(0,_.BX)("div",{className:"meta-row bottom",children:[(0,_.BX)("span",{children:[(0,_.tZ)("b",{children:lng("author")}),(0,_.tZ)("br",{}),t.user.user_first_name," ",t.user.user_last_name]}),(0,_.BX)("span",{children:[(0,_.tZ)("b",{children:lng("workspace")}),(0,_.tZ)("br",{}),t.group_name]}),(0,_.BX)("span",{children:[(0,_.tZ)(l.JO,{icon:"discussion"})," ",t.comments_count?t.comments_count+" "+lng("comments"):lng("no comments").caps()]})]})]})})}))},7018:(e,t,i)=>{i.d(t,{B:()=>O});var n=i(5560),r=i(5832),s=i(81),o=i(676),a=(i(7882),i(917)),l=i(6920),c=i(5898),d=i(7363),p=i(5007),u=i(8e3),m=i(441),g=i(7154),h=i(6975),b=i(9483),v=i(9180),_=i(5405),f=i(4902),y=i(2616),w=i(7376),x=i(2334),k=i(8318),Z=i(9637),C=i(3755),S=i(5944);const O=(0,n.observer)((function(e){let{filteredTasks:t,tasks:i,priorityOn:n,markAsSeen:a,viewMode:c,showTaskProgress:d,filterNsort:p,actions:u,noFilterSort:m,listKey:g,showArchiveFilter:h,loading:b,barExtraComponent:v,displayCount:_,title:f,scrollParent:y,sticky:x=l.g.consts.TABLE_HEAD_HEIGHT,extraFields:Z=[],stickyStartHeight:C=l.g.consts.DEFAULT_STICKY_START_HEIGHT,searchPage:O=!1}=e;const B=[...new Map(i.map((e=>[e.group_id+"",e.group_name])))].sort(((e,t)=>{var i;return null===(i=e[1])||void 0===i?void 0:i.localeCompare(t[1])})),T=[...new Map(i.map((e=>[e.allocated_to+"",e.assignee_name])))].sort(((e,t)=>{var i;return null===(i=e[1])||void 0===i?void 0:i.localeCompare(t[1])}));let D=[!0,"filter"].includes(m)?void 0:[{name:"task_id",label:"#",type:"text"},{name:"task_title",label:lng("task",{phrase:!0}),type:"text",outOfMenu:!0},{name:"task_type",label:lng("type"),type:"select_multi",options:(0,r._V)("task_type",i)},{name:"status_name",label:lng("status"),type:"select_multi",options:(0,k.cT)(i,"status_name").sort(((e,t)=>w.oJ.indexOf(e.task_resolution)-w.oJ.indexOf(t.task_resolution))).map((e=>({val:e.status_name,label:(0,w.HR)(e.status_name),color:(0,w.Pp)(e.task_resolution)})))},{name:"creator_name",label:lng("creator"),type:"select_multi",options:(0,r._V)("creator_name",i)},c&&{name:"group_id",label:lng("workspace"),type:"select_multi",options:B.map((e=>({val:e[0],label:e[1]})))},{name:"allocated_to",label:lng("assignee"),type:"select_multi",options:T.map((e=>({val:e[0],label:e[1]})))},{name:"severity",label:lng("severity"),type:"select_multi",options:(0,r._V)("severity",i,{labelFunc:w.i4})},n&&{name:"priority",label:lng("priority"),type:"select_multi",options:(0,r._V)("priority",i,{labelFunc:w.aS})},{name:"task_resolution",label:lng("resolution"),type:"select_multi",options:(0,r._V)("task_resolution",i).map((e=>{let{val:t}=e;return{val:t,label:(0,w.Ey)(t),color:(0,w.Pp)(t)}}))},{name:"due_date_status",label:lng("due date"),type:"select",options:[{val:"",label:""},{val:"future",label:lng("in the future")},{val:"week",label:lng("ends this week")},{val:"pastdue",label:lng("has passed")}]},h&&{name:"archive",label:lng("show archive"),type:"checkbox"}].filter((e=>e));const j=[!0,"sort"].includes(m)?void 0:I({viewMode:c,priorityOn:n}),P=[{title:"#",sortVal:"task_id"},{},{title:lng("task",{phrase:!0}),sortVal:"task_title"},{title:lng("type"),sortVal:"task_type"},{title:lng("status"),sortVal:"status_name"},{title:lng("creator"),sortVal:"creator_name"},c&&{title:"workspace",sortVal:"group_name"},{title:lng("last modified"),sortVal:"modified_time"},{title:lng("due date"),sortVal:"due_date"},{title:lng("assignee"),sortVal:"assignee_name"},{title:lng("severity"),sortVal:"severity"},d&&{title:lng("task progress"),sortVal:"progress_percent"},n&&{title:lng("priority"),sortVal:"priority"},...Z.map((e=>{let[,t]=e;return{title:t}})),{},!c&&{checkAll:!0}].filter((e=>e)),z=(0,s.iP)().width<1224;return(0,S.tZ)(o.iA,{title:f,cols:P,collection:t||i,filters:D,sorts:j,filterNsort:p,actions:u,RowRenderer:N,rowIdCol:"task_id",rowProps:{priorityOn:n,markAsSeen:a,viewMode:c,listKey:g,showTaskProgress:d,extraFields:Z},tableReplacement:z?(0,S.tZ)(w.D8,{tasks:t||i}):void 0,loading:b,barExtraComponent:v,displayCount:_,sticky:x,scrollParent:y,stickyStartHeight:C,isSearchPage:O})})),B=(0,a.iv)(">._bold>div{display:flex;>div:first-of-type{",l.g.classes.margin_far("3px"),";}}&.display-new{background-color:",l.g.colors.highlight,";}","");var T={name:"14tpgxo",styles:"font-size:.9em"};const N=(0,n.observer)((function(e){let{row:t,rowProps:i}=e;const{priorityOn:n,markAsSeen:r,viewMode:s,listKey:o,showTaskProgress:a,extraFields:O}=i,{due_date:N,task_id:I,shownAt:D,parent_task:j,task_title:P,task_type:z,task_type_color:E,task_resolution:R,status_name:F,group_id:M,group_name:A,progress_percent:q,modified_time:X,creator_id:L,creator_name:$,creator_avatar:V,assignee_name:U,severity:H,priority:J,bookmarked:G,comments_count:W,files_count:K}=t;let Y=null;if(N)if("closed"===R)Y=(0,S.tZ)(v.qp,{time:N,showTime:!1});else{const e=(0,x._3)(N),t=e.diff(new Date,"days"),i={icon:"clock",text:t<0?lng("overdue").caps():t<5?lng("%s days left",t):(0,x.k6)(e,{time:!1}),color:t<0?"negative":t<5?"warning":"positive",title:t<0?(0,x.k6)(e,{time:!1}):void 0};Y=(0,S.tZ)(c.jC,{...i,css:T})}const Q=(0,d.useContext)(p.l9);return(0,S.BX)("tr",{css:B,onClick:()=>(0,m.p4)({edit:"task",id:I},!0),className:D>(0,k.c7)()-60?"display-new":"",children:[(0,S.tZ)("td",{children:I}),(0,S.tZ)("td",{children:j&&(0,S.tZ)(g.u,{text:lng("sub task"),children:(0,S.tZ)(h.vB,{})})}),(0,S.tZ)(Z.U6,{children:(0,S.tZ)(b.m,{keepAlign:!0,children:(0,S.tZ)(m.A,{href:{edit:"task",id:I},css:l.g.classes.ellipsis_lines(3),stopPropagation:!0,children:P})})}),(0,S.tZ)("td",{children:z&&(0,S.tZ)(c.jC,{color:E,children:z})}),(0,S.tZ)("td",{className:"_bold",children:(0,S.BX)("div",{children:[(0,S.tZ)("div",{children:(0,S.tZ)(h.gT,{color:(0,w.Pp)(R),size:".7em"})}),(0,w.HR)(F,R).caps(!1)]})}),(0,S.tZ)("td",{children:(0,S.tZ)(_.SV,{children:(0,S.tZ)(f.qE,{user:{user_id:L,full_name:$,user_avatar:V}})})}),s&&(0,S.tZ)("td",{children:(0,S.tZ)(m.A,{href:{workspace:M,tab:"tasks"},onClick:e=>e.stopPropagation(),children:(A||"").caps()})}),(0,S.tZ)("td",{children:(0,S.tZ)(v.qp,{time:X})}),(0,S.tZ)("td",{children:Y}),(0,S.tZ)("td",{children:U}),(0,S.tZ)("td",{children:(0,w.i4)(H)}),a&&(0,S.tZ)("td",{children:(0,S.tZ)(C.k,{numerator:q,denominator:100})}),!!n&&void 0!==J&&(0,S.tZ)("td",{children:(0,w.aS)(J)}),O.map((e=>{let[i]=e;return(0,S.tZ)("td",{children:t[i]},i)})),(0,S.BX)(Z.jA,{children:[(0,S.tZ)(h.JO,{icon:G?"bookmark_filled":"bookmark",onClick:()=>(0,y.kM)(t)}),W>0&&(0,S.tZ)(h.JO,{icon:"discussion",toolTip:W+" "+lng("comments"),badge:W}),K>0&&(0,S.tZ)(h.JO,{icon:"attachment",toolTip:K+" "+lng("attachments"),badge:K}),r&&void 0!==J&&(0,S.tZ)(h.JO,{icon:"mark_v",toolTip:lng("mark as seen"),onClick:()=>{const e=Q.getStore("tasks",void 0,{onlyIfExists:!0});(0,u.SC)("tasks/mark_as_seen",{method:"POST",data:{task_id:I}},(()=>{null==e||e.removeTaskFromList(o,I)}))}})]}),!s&&(t.may_edit?(0,S.tZ)(Z.Fo,{o:t}):(0,S.tZ)("td",{}))]})})),I=e=>{let{viewMode:t,priorityOn:i}=e;return[{val:"",label:lng("default")},{val:"task_id",label:"#"},{val:"task_title",label:lng("task",{phrase:!0})},{val:"task_type",label:lng("type")},{val:"status_name",label:lng("status")},{val:"creator_name",label:lng("creator")},t&&{val:"group_name",src_field:"group_id",label:lng("workspace")},{val:"modified_time",label:lng("modification date")},{val:"due_date",label:lng("due date")},{val:"assignee_name",label:lng("assignee")},{val:"severity",label:lng("severity")},i&&{val:"priority",label:lng("priority")},{val:"task_resolution",label:lng("resolution")}].filter((e=>e))}},7376:(e,t,i)=>{i.d(t,{D8:()=>y,Ey:()=>v,HR:()=>b,Pp:()=>h,aS:()=>_,i4:()=>f,oJ:()=>g,sD:()=>x});var n=i(6975),r=i(5560),s=i(5898),o=i(917),a=i(6920),l=(i(7882),i(441)),c=i(9483),d=i(8318),p=i(236),u=i(7166),m=i(5944);const g=["open","in_progress","closed","on_hold"],h=e=>{switch(e){case"open":return a.g.colors.task.authorized;case"closed":return a.g.colors.task.completed;case"on_hold":return a.g.colors.task.incomplete;case"in_progress":return a.g.colors.task.in_progress}return a.g.colors.task.incomplete},b=(e,t)=>{if(e)return e;switch(t){case"open":return lng("open");case"closed":return lng("closed");case"on_hold":return lng("on hold");case"in_progress":return lng("in progress")}return""},v=e=>b(null,e),_=e=>{if(!e)return lng("unprioritized").caps();switch(parseInt(e)){case 1:return lng("low").caps();case 5:return lng("medium").caps();case 7:return lng("high").caps();case 9:return lng("urgent").caps()}return"-"},f=e=>{switch(parseInt(e)){case 1:return lng("cosmetic").caps();case 3:return lng("minor").caps();case 5:return lng("moderate").caps();case 7:return lng("major").caps();case 9:return lng("critical").caps()}return""},y=e=>{let{tasks:t}=e;return(0,m.BX)(p.Hl,{children:[t.map((e=>(0,m.tZ)(x,{task:e},e.task_id))),(0,d.w6)(3).map((e=>(0,m.tZ)("div",{className:"_filler"},e)))]})},w=(0,o.iv)("padding:7px;margin-top:10px;border-radius:8px;background-color:",a.g.colors.bg_cont,";",a.g.classes.shadow_light,";position:relative;min-width:",a.g.consts.CARD_WIDTH,"px;width:",a.g.consts.CARD_WIDTH,"px;color:",a.g.colors.text_main,";a{display:flex;flex-direction:column;justify-content:space-between;min-height:125px;}&:hover{",a.g.classes.shadow_strong,";background-color:",a.g.colors.dominant_main_shade,";}.meta-row{display:flex;justify-content:space-between;flex-grow:1;>span{max-width:35%;max-height:35px;font-size:0.8em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}&.bottom{align-items:flex-end;}}._title{color:",a.g.colors.text_main,";font-size:1.1em;font-weight:600;margin-bottom:7px;text-align:justify;word-break:break-word;}.selected &{background-color:",a.g.colors.dominant_main_shade,";}.dragging &{background-color:",a.g.colors.dominant_main_shade,";}",""),x=(0,r.observer)((function(e){let{task:t,topRightIcon:i,onCheck:r,checked:o}=e;const{task_id:d,task_resolution:p,status_name:g,task_type_color:v,task_type:y,task_title:x,assignee_name:k,group_name:Z,priority:C,severity:S}=t;return(0,m.tZ)("div",{css:w,children:(0,m.BX)(l.A,{href:{edit:"task",id:d},children:[(0,m.BX)("div",{className:"meta-row",children:[(0,m.BX)("span",{children:[(0,m.tZ)(n.gT,{color:h(p),size:".7em"})," ",b(g,p).caps(!1)]}),(0,m.tZ)("span",{children:(0,m.tZ)(s.jC,{color:v,children:y})}),i]}),(0,m.tZ)("div",{className:"_title",children:(0,m.tZ)(c.m,{children:x})}),(0,m.BX)("div",{className:"meta-row bottom",children:[C>0&&(0,m.BX)("span",{children:[lng("priority").caps(),": ",_(C)]}),S>0&&(0,m.BX)("span",{children:[lng("severity").caps(),": ",f(S)]})]}),(0,m.BX)("div",{className:"meta-row bottom",children:[(0,m.BX)("span",{children:[r&&(0,m.tZ)(n.JO,{icon:"checkbox"+(o?"_checked":""),color:a.g.colors.green,onClick:r})," ",(0,m.BX)("span",{className:"task-id",children:["#",d,(0,m.tZ)(u.g,{copy:""+d,success:lng("task id copied to clipboard").caps(),smallButtonLike:!0})]})]}),(0,m.tZ)("span",{children:k}),(0,m.tZ)("span",{children:Z})]})]})})}))},7938:(e,t,i)=>{i.d(t,{Z5:()=>le,J:()=>ne,h3:()=>te,DL:()=>H,PH:()=>J,v2:()=>Q});var n,r,s=i(7363),o=i(917),a=i(5560),l=(i(7882),i(676)),c=i(5007),d=i(1010),p=i(4902),u=i(441),m=i(8567),g=i(8e3),h=i(6975),b=i(8318),v=i(3051),_=i(4210),f=i(7821),y=i(9934),w=i(9637),x=i(5944);function k(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let Z=(n=class extends _.I{constructor(e){var t,i,n,o;super(e),k(this,"groupId",null),k(this,"sequenceId",null),t=this,i="users",o=this,(n=r)&&Object.defineProperty(t,i,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(o):void 0}),(0,f.makeObservable)(this);const{data:l={}}=e;this.groupId=l.group_id,this.sequenceId=l.sequenceId,this.title=lng("import members from other workspaces").caps(),this.confirmButtonLabel=lng("import").caps();const c=(0,a.observer)((e=>{let{item:t}=e;const[i,n]=(0,s.useState)("add"),r="add"===i?"new":"trash",o=lng("%s children",i);return(0,x.tZ)("div",{children:t.children&&(0,x.tZ)(h.JO,{icon:r,toolTip:o,onClick:()=>{"add"===i&&this.addChildren({children:t.children}),"remove"===i&&this.removeChildren({children:t.children}),n("add"===i?"remove":"add")}})})}));this._fields=[{type:"checkbox",name:"start_sequence",label:lng("start approval sequence"),insert:this.sequenceId},{type:"multiple_items",name:"groups",label:lng("select workspaces"),poster:!0,theme:"bright",valueIsMap:!0,searchData:(e,t)=>{var i;const n=[];null===(i=this.values.get("groups"))||void 0===i||i.forEach((e=>n.push(e.id))),(0,g.SC)("ajax/GroupsAjax.class.php",{data:{exclude:n||[],req:"searchGroups",types:["Ou","Group","Qualification","Workplan"],term:e.term||"",id:e.ids||""}},t)},buttons:[{Render:c}],onSelect:()=>this.updateUsers(),onValueChange:()=>this.updateUsers()},{type:"component",name:"users",visible:()=>this.users.length>0,node:(0,x.tZ)(I,{users:this.users})}],this._prepFields(),this.ready=!0}updateUsers(){const e=this.values.get("groups"),t=Array.from(e.keys()).join(",");(0,g.SC)("groups/import_users",{data:{group_to_join:this.groupId,groups:t}},(e=>{var t;const i=null==e||null===(t=e.items)||void 0===t?void 0:t.map((e=>{const t=this.users.find((t=>t.user_id===e.user_id)),i=!t||t._checked;return new y.o(e,i)}));this.users.replace(i||[])}))}addChildren(e){let{children:t}=e;(0,g.SC)("ajax/GroupsAjax.class.php?",{data:{req:"AutoComplete",show_all:1,types:["Ou","Group","Qualification","Workplan"],id:t.split(",")}},(e=>{if(e.length>0){const t=new Map(this.values.get("groups"));e.map((e=>t.set(e.id,e))),this.updateValue(t,"groups"),this.updateUsers()}}))}removeChildren(e){let{children:t}=e;const i=new Map(this.values.get("groups"));t.split(",").forEach((e=>i.delete(e))),this.updateValue(i,"groups"),this.updateUsers()}save(e){const t=this.users.filter((e=>e._checked)).map((e=>e.user_id)).join(",");e.groups=[this.groupId],this.saveToUrl("users/add_users_to_groups",Object.assign({users:t,ignore_exist:1},e))}},C=n.prototype,S="users",O=[f.observable],B={configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}},N={},Object.keys(B).forEach((function(e){N[e]=B[e]})),N.enumerable=!!N.enumerable,N.configurable=!!N.configurable,("value"in N||N.initializer)&&(N.writable=!0),N=O.slice().reverse().reduce((function(e,t){return t(C,S,e)||e}),N),T&&void 0!==N.initializer&&(N.value=N.initializer?N.initializer.call(T):void 0,N.initializer=void 0),void 0===N.initializer&&(Object.defineProperty(C,S,N),N=null),r=N,n);var C,S,O,B,T,N;const I=(0,a.observer)((function(e){let{users:t}=e;const i=[{title:lng("name")},{title:lng("workspace")},{title:lng("member of an instance")},{checkAll:!0}],n=(0,a.observer)((function(e){let{row:t}=e;const{name:i,group_name:n,instance:r}=t;return(0,x.BX)("tr",{children:[(0,x.tZ)(w.U6,{children:i}),(0,x.tZ)("td",{children:n}),(0,x.tZ)("td",{children:r&&(0,x.tZ)(h.JO,{icon:"mark_v"})}),(0,x.tZ)(w.Fo,{o:t})]})}));return(0,x.tZ)("div",{children:(0,x.tZ)(l.iA,{cols:i,collection:t,rowIdCol:"user_id",loading:null===t,RowRenderer:n,compact:!0,noWindow:!0})})}));var D=i(8534),j=i(3079);function P(e,t,i){return t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class z extends _.I{constructor(e){super(e),P(this,"selectedUsers",void 0),P(this,"groupId",void 0),this.selectedUsers=e.data.selectedUsers,this.groupId=e.data.groupId,this.title=lng("send schedule").caps(),this.saveUrl="invites/send_schedule",this.successMessage=lng("schedule sent");const t=[["all",`${lng("all users").caps()} (${lng("members")}, ${lng("managers")}, ${lng("owners")})`],["members",lng("only members").caps()],["mailing_list",lng("mailing list users").caps()]];this.selectedUsers&&t.unshift(["selected",lng("only selected users")]);const i=[["group_schedule",lng("workspace schedule")],["group_schedule_for_manager",lng("group schedule for manager")],["group_schedule_for_mailing_list",lng("workspace schedule for mailing list")]];this.buildFields(t,i)}buildFields(e,t){this._fields=[{type:"hidden",name:"group_id",value:this.groupId},{type:"hidden",name:"filter_users",value:this.selectedUsers,insert:this.selectedUsers},{type:"select",name:"send_schedule_to",label:lng("send to"),options:e},{type:"system_message",name:"schedule_custom_message",label:lng("select custom message")+" ("+lng("leave empty for default message")+")",messageTypes:t,mod:["","ENT"],placeholder:lng("default message").caps()},{type:"file",name:"schedule_attach_file",label:`${lng("attach a file").caps()} (${lng("optional")})`}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl(this.saveUrl,Object.assign(e))}}var E=i(6421),R=i(6920),F=i(2334),M=i(7154),A=i(4454),q=i(1855),X=i(409);class L extends _.I{constructor(e){super(e);const{data:t={}}=e;this.group_id=t.group_id,this.existingUsers=t.users,this.existingGroups=t.groups,this.title=this.group_id?lng("add members").caps():"change_ou"===t.action?lng("change users org unit").caps():lng("add selected users to workspace"),this._fields=[{type:"multiple_items",name:"mailing_list_groups",label:lng("workspaces"),poster:!0,theme:"bright",helpKey:"@group/advanced/mailing/workspaces",searchData:(e,t)=>{(0,g.SC)("ajax/GroupsAjax.class.php",{data:{req:"AutoComplete",owned:1,types:["Group"],term:e.term||"",id:e.ids||"",exclude:this.existingGroups}},t)}},{type:"multiple_items",name:"mailing_list_users",label:lng("users"),poster:!0,theme:"bright",helpKey:"@group/advanced/mailing/users",searchData:(e,t)=>{(0,g.SC)("ajax/UsersAjax.class.php",{data:{req:"AutoComplete",term:e.term||"",id:e.ids||"",exclude:this.existingUsers}},t)}}],this._prepFields(),this.ready=!0}save(e){this.saveToUrl("groups/add_to_mailing_list",Object.assign({group_id:this.group_id},e))}}var $=i(8071),V=i(1619);const U=e=>Blsm.user.isPowerManager||!Blsm.isFeatureEnabled("isolate_users")||(null==e?void 0:e.is_member)&&(e.is_owner||e.is_manager),H=function(e){let{user:t,...i}=e;return Blsm.user.isPowerManager||!Blsm.isFeatureEnabled("isolate_users")?(0,x.tZ)(u.A,{...i,href:{user:t.user_id},children:(0,b.v2)(t)}):i.toolTip?(0,x.tZ)(M.u,{text:i.toolTip,children:(0,b.v2)(t)}):(0,b.v2)(t)},J=(0,a.observer)((function(e){var t;let{collection:i,scrollParent:n,reload:r,workspace:s,noFilterSort:o,allowedUserFields:a=[],usersCustomFieldsNames:p,userActions:h=!0,sticky:b=R.g.consts.TABLE_HEAD_HEIGHT+1,stickyStartHeight:v=R.g.consts.DEFAULT_STICKY_START_HEIGHT,searchPage:_=!1}=e;const f=null==s?void 0:s.mayEditMembers(),y=null==s?void 0:s.maySetCoaches(),w=null==s?void 0:s.mayImportMembers(),k=[{narrow:!0},{title:lng("name").caps(),sortVal:"full_name"},...a.map((e=>({title:(0,X.X)(e,p),sortVal:e}))),Blsm.isFeatureEnabled("skills_occupations")&&{title:lng("skills")},h&&{},f&&{checkAll:!0}];let C=o?void 0:[{name:"user_id",label:"#",type:"text"},{name:"full_name",label:lng("name"),type:"text"},...a.map((e=>"user_gender"===e?{name:"user_gender",label:lng("gender"),type:"select",exact:!0,options:[{val:"",label:""},{val:"Male",label:lng("male").caps()},{val:"Female",label:lng("female").caps()},{val:"Other",label:lng("other",{phrase:!0}).caps()}]}:{label:(0,X.X)(e,p),name:e,type:"text"}))];const S=o?void 0:[{val:"",label:lng("default")},{val:"full_name",label:lng("name")},...a.map((e=>({val:e,label:(0,X.X)(e,p)})))],O=i.filter((e=>e._checked)),B=null==s||null===(t=s.meetings)||void 0===t?void 0:t.some((e=>!(0,F.CR)(e.start_time))),T=(0,c.vm)(),N=f?[{icon:"new",menu:[{label:lng("add members"),onClick:()=>T.openDialog("form",new d.l({data:{group_id:s.group_id,group_type:s.group_type,owner_options:s.owner_options,is_owner:s.is_owner,sequence_id:s.sequence_id},onSaveSuccess:e=>{e.warning?(0,D.nb)(e.warning):e.success?(0,D.qV)(lng("members successfully added")):e.request&&(0,D.qV)(lng("members successfully started an approval sequence")),T.closeDialog(),r()}}))},{label:lng("import members from other workspaces"),onClick:()=>T.openDialog("form",new Z({data:{group_id:s.group_id,sequenceId:s.sequence_id},onSaveSuccess:e=>{e.success?(0,D.qV)(lng("members successfully imported to the group")):e.request?(0,D.qV)(lng("members successfully started an approval sequence")):e.warning&&(0,D.nb)(e.warning),T.closeDialog(),r()}}))},w&&{label:lng("import members from a CSV or Excel"),onClick:()=>(0,u.p4)({import:"members",params:{workspace_id:s.group_id}},!0)}]},{icon:"trash",toolTip:lng("remove members"),action:0===O.length?void 0:()=>{(0,m.cS)(lng("are you sure you want to remove the selected members?").caps(),{text:lng("remove members").caps(),inputType:"textarea",placeholder:lng("reason for removing"),onConfirm:e=>(0,g.SC)("users/remove_users_from_group",{method:"POST",data:{members:O.map((e=>e.user_id)),group_id:s.group_id,reason:e},json:!0},r)})}},{icon:"users",toolTip:lng("set users active"),action:0===O.length?void 0:()=>{(0,m.cS)(lng("set an expiry date for the selected users below (optional)").caps(),{title:lng("set users active"),inputType:"date",inputOptions:{label:lng("expiry date")},onConfirm:e=>(0,g.SC)("users/set_active",{method:"POST",data:{user_id:O.map((e=>e.user_id)),group_id:s.group_id,expire_time:e?(0,F._3)(e).unix():null},json:!0},r)})}},{icon:"inactive_users",toolTip:lng("set users inactive"),action:0===O.length?void 0:()=>{(0,m.BB)(lng("are you sure you want to make the selected users inactive?").caps(),{title:lng("set users inactive"),onConfirm:()=>(0,g.SC)("users/set_inactive",{method:"POST",data:{user_id:O.map((e=>e.user_id)),group_id:s.group_id},json:!0},r)})}},U(s)&&Blsm.isFeatureEnabled("create_messages")&&{icon:"by_mail",toolTip:lng("send message"),action:O.length>0?(0,u.p4)("#messages/in/new/&to="+O.map((e=>e.user_id))):(0,u.p4)("#messages/in/new/&ws="+s.group_id)},B&&{label:lng("send schedule").caps(),action:0!==O.length&&B?()=>{T.openDialog("form",new z({data:{selectedUsers:O.map((e=>e.user_id)).join(),groupId:s.group_id},onSaveSuccess:()=>T.closeDialog()}))}:void 0},Blsm.isFeatureEnabled("participation_planning")&&{icon:"calendar",toolTip:lng("participation planning"),action:()=>(0,u.p4)({list:"participation_planning",params:`group_id=${s.group_id}`},!0)}]:void 0;return(0,x.tZ)(l.iA,{cols:k,collection:i,filters:C,sorts:S,actions:N,RowRenderer:K,rowIdCol:"user_id",scrollParent:n,sticky:b,stickyStartHeight:v,rowProps:{canAddRemove:f,canSetCoaches:y,group_id:null==s?void 0:s.group_id,group_type:null==s?void 0:s.group_type,userActions:h,allowedUserFields:a,ws:s},isSearchPage:_})})),G=(0,o.iv)("color:",R.g.colors.negative,";",""),W=(0,o.iv)("display:flex;align-items:center;border-radius:20px;font-size:.9rem;padding:5px;background-color:",R.g.colors.warning,";color:white;",""),K=(0,a.observer)((function(e){let{row:t,rowProps:i}=e;const{canAddRemove:n,canSetCoaches:r,group_id:s,group_type:o,userActions:a,allowedUserFields:l,ws:c}=i,{expire_time:d,skills:u,match_rate:m}=t;return(0,x.BX)("tr",{children:[(0,x.tZ)("td",{className:"_avatar",children:(0,x.tZ)(p.qE,{user:t,balloon:U(c)})}),(0,x.BX)(w.U6,{children:[(0,x.tZ)(H,{user:t}),d&&parseInt(d)<(0,b.c7)()&&(0,x.BX)(x.HY,{children:[(0,x.tZ)("br",{}),(0,x.tZ)(M.u,{text:lng("member expiration date is %s",(0,F.GG)(d,{time:!1})),children:(0,x.BX)("span",{css:G,children:[(0,x.tZ)(h.JO,{icon:"inactive_user"})," ",lng("inactive member").caps()]})})]})]}),l.map((e=>(0,x.tZ)("td",{children:(0,x.tZ)(V.xn,{content:t[e]})},e))),Blsm.isFeatureEnabled("skills_occupations")&&(0,x.tZ)("td",{children:(0,x.BX)("div",{css:Y,children:[(0,x.tZ)("div",{children:u}),m&&(0,x.tZ)("div",{className:"match-rate",children:(0,x.BX)(M.u,{css:W,text:lng("skill match percent").caps(),children:[m,"%"]})})]})}),a&&(0,x.tZ)(x.HY,{children:(0,x.BX)(w.jA,{children:[(0,x.tZ)(se,{user:t,canSetCoaches:r,group_id:s,group_type:o,canContactUser:U(c)}),(0,x.tZ)(oe,{user:t,group_id:s})]})}),n&&(0,x.tZ)(w.Fo,{o:t})]})})),Y={name:"ivau7f",styles:"display:flex;justify-content:space-between;.match-rate{display:flex;align-self:center;}"},Q=(0,a.observer)((e=>{let{collection:t,scrollParent:i,workspace:n,allowedUserFields:r}=e;const s=null==n?void 0:n.mayEditMembers(),o=[{narrow:!0},{title:lng("name").caps(),sortVal:"full_name"},...r.map((e=>({title:(0,X.X)(e),sortVal:e}))),s&&{},s&&{checkAll:!0}];let a=[{name:"user_id",label:"#",type:"text"},{name:"full_name",label:lng("name"),type:"text"},...r.map((e=>({val:e,label:(0,X.X)(e)})))];const c=[{val:"",label:lng("default")},{val:"full_name",label:lng("name")},...r.map((e=>({val:e,label:(0,X.X)(e)})))],d=n.canApproveMembers(n.waitingListSelected.length),p=0===n.waitingListSelected.length,g=[s&&{icon:"like",action:n.waitingListSelected.length>0&&d?()=>(0,m.BB)(lng("are you sure that you want to add the selected users to %s?",n.group_name).caps(),{onConfirm:()=>n.waitingListApprove()}):void 0,color:R.g.colors.positive,toolTip:p?void 0:d?lng("approve selected users").caps():lng("members limit reached, remove members to add").caps()},s&&{icon:"dislike",action:p?void 0:()=>(0,m.BB)(lng("are you sure that you want to reject the selected users from %s?",n.group_name).caps(),{onConfirm:()=>n.waitingListReject()}),color:R.g.colors.negative,toolTip:p?void 0:lng("reject selected users").caps()},{icon:"by_mail",action:()=>(0,u.p4)({messages:"in",id:"new",params:{to:n.waitingList.map((e=>e.user_id)).join(",")}},!0),toolTip:lng("message to waiting list").caps()}];return(0,x.tZ)(l.iA,{cols:o,collection:t,filters:a,sorts:c,actions:g,RowRenderer:ee,rowIdCol:"user_id",scrollParent:i,sticky:R.g.consts.TABLE_HEAD_HEIGHT+1,rowProps:{canAddRemove:s,canApprove:n.canApproveMembers(),approve:n.waitingListApprove,reject:n.waitingListReject,group_id:null==n?void 0:n.group_id,group_name:n.group_name,allowedUserFields:r}})})),ee=(0,a.observer)((e=>{let{row:t,rowProps:i}=e;const{canAddRemove:n,canApprove:r,approve:s,reject:o,group_name:a,allowedUserFields:l}=i,{user_id:c}=t;return(0,x.BX)("tr",{children:[(0,x.tZ)("td",{className:"_avatar",children:(0,x.tZ)(p.qE,{user:t})}),(0,x.tZ)(w.U6,{width:"300px",children:(0,x.tZ)(H,{user:t})}),l.map(((e,i)=>(0,x.tZ)("td",{children:t[e]},"allowed-user-fields_"+i))),n&&(0,x.BX)(w.jA,{children:[(0,x.tZ)(h.JO,{icon:"like",buttonLike:!0,toolTip:r?lng("approve").caps():lng("members limit reached, remove members to add").caps(),onClick:()=>(0,m.BB)(lng("are you sure that you want to add %s to %s?",(0,b.v2)(t),a),{onConfirm:()=>s([c])}),color:r&&R.g.colors.positive,disabled:!r}),(0,x.tZ)(h.JO,{icon:"dislike",buttonLike:!0,toolTip:lng("reject").caps(),onClick:()=>(0,m.BB)(lng("are you sure that you want to reject %s from %s?",(0,b.v2)(t),a),{onConfirm:()=>o([c])}),color:R.g.colors.negative})]}),n&&(0,x.tZ)(w.Fo,{o:t})]})})),te=(0,a.observer)((e=>{let{collection:t,scrollParent:i,workspace:n}=e;const r=null==n?void 0:n.mayEditMembers(),s=[{narrow:!0},{title:lng("name").caps(),sortVal:"full_name"},{title:lng("job title").caps(),sortVal:"user_job_title"},{title:lng("request time").caps(),sortVal:"addition_time"},{title:lng("last activity").caps(),sortVal:"last_activity"},{title:lng("approver name").caps(),sortVal:"approver_name"},{title:lng("department").caps(),sortVal:"user_department"},{title:lng("company").caps(),sortVal:"user_company"},{title:lng("gender").caps(),sortVal:"user_gender"},{},r&&{checkAll:!0}].filter((e=>!!e));let o=[{name:"full_name",label:lng("name"),type:"text"},{name:"user_job_title",label:lng("job title"),type:"text"},{name:"approver_name",label:lng("approver name"),type:"text"}];const a=[{val:"",label:lng("default")},{val:"full_name",label:lng("name")},{val:"user_job_title",label:lng("job title")},{val:"addition_time",label:lng("request time")},{val:"last_activity",label:lng("last activity")},{val:"approver_name",label:lng("approver name")}],c=[];return r&&c.unshift({icon:"dislike",...n.registeredUsersSelected.length>0&&{color:R.g.colors.negative,action:()=>{(0,m.cS)(lng("add rejection reason (optional)"),{title:lng("are you sure that you want to reject these requests for this workspace?"),confirmText:lng("confirm"),inputType:"text",width:"700px",onConfirm:e=>n.registeredUsersReject(e)})},toolTip:lng("reject selected users").caps()}}),Blsm.isFeatureEnabled("create_messages")&&c.unshift({icon:"by_mail",action:n.registeredUsersSelected.length>0?()=>(0,u.p4)({messages:"in",id:"new",params:{to:n.registeredUsersSelected.join(",")}},!0):()=>(0,u.p4)({messages:"in",id:"new",params:{to:n.registeredUsers.map((e=>e.user_id)).join(",")}},!0),toolTip:lng("send message").caps()}),(0,x.tZ)(l.iA,{cols:s,collection:t,filters:o,sorts:a,actions:c,RowRenderer:ie,rowIdCol:"user_id",scrollParent:i,sticky:R.g.consts.TABLE_HEAD_HEIGHT+1,rowProps:{canAddRemove:r,group_id:null==n?void 0:n.group_id,group_name:n.group_name}})})),ie=(0,a.observer)((function(e){let{row:t,rowProps:i}=e;const{canAddRemove:n}=i,{user_job_title:r,user_company:s,user_department:o,user_gender:a,addition_time:l,user_id:c,approver_name:d,last_activity:m}=t;return(0,x.BX)("tr",{children:[(0,x.tZ)("td",{className:"_avatar",children:(0,x.tZ)(p.qE,{user:t})}),(0,x.tZ)(w.U6,{width:"300px",children:(0,x.tZ)(H,{user:t})}),(0,x.tZ)("td",{children:r}),(0,x.tZ)("td",{children:(0,F.GG)(l)}),(0,x.tZ)("td",{children:(0,F.GG)(m)}),(0,x.tZ)("td",{children:d}),(0,x.tZ)("td",{children:s}),(0,x.tZ)("td",{children:o}),(0,x.tZ)("td",{children:a}),(0,x.tZ)(w.jA,{children:Blsm.isFeatureEnabled("create_messages")&&(0,x.tZ)(h.JO,{icon:"by_mail",onClick:()=>(0,u.p4)({messages:"in",id:"new",params:{to:c}},!0),buttonLike:!0})}),n&&(0,x.tZ)(w.Fo,{o:t})]})})),ne=(0,a.observer)((function(e){let{collection:t,scrollParent:i,reload:n,workspace:r,userActions:s=!0,roleWorkspace:o=!1}=e;const{group_id:a,group_type:d,is_owner:p,toggleDisplayManager:h}=r,b=!p&&!r.is_manager,v=o?[{title:lng("primary").caps()}]:[{title:lng("permission type").caps(),narrow:!b},...b?[]:[{title:lng("create assignments").caps(),narrow:!0},{title:lng("set assignments weights").caps(),narrow:!0},{title:lng("create meetings").caps(),narrow:!0},{title:lng("edit meetings").caps(),narrow:!0},{title:lng("set meetings attendance").caps(),narrow:!0},{title:lng("share content").caps(),narrow:!0},Blsm.isFeatureEnabled("evaluation")&&{title:o?void 0:lng("view evaluations").caps(),narrow:!0},{title:lng("grades management").caps(),narrow:!0},"Ou"===d?{}:{title:lng("members director").caps(),narrow:!0},{title:lng("create portal").caps(),narrow:!0},{title:lng("general").caps(),narrow:!0,tooltip:(0,$.u)()}]];let _=[{name:"user_id",label:"#",type:"text"},{name:"full_name",label:lng("name"),type:"text"}];const f=[{val:"",label:lng("default")},{val:"full_name",label:lng("name")}],y=(0,c.vm)(),w=e=>{y.openDialog("form",new A.UQ({data:{group_id:r.group_id,manager_permission_types:r.manager_permission_types,managers:e},onSaveSuccess:()=>{(0,D.qV)(lng("permissions changed successfully")),y.closeDialog(),n()}}))},k=e=>{let{areYouSure:i}=e;const s=t.filter((e=>e._checked));if(0===s.length)return;const o=s.map((e=>!!e.manager&&!e.inherited&&e.user_id)).filter((e=>e)),a=s.map((e=>!!e.owner&&e.user_id)).filter((e=>e)),l=[];if(o.length>0&&l.push({label:lng("managers"),val:"managers"}),a.length>0&&l.push({label:lng("owners"),val:"owners"}),a.length>0&&o.length>0&&l.push({label:lng("managers and owners"),val:"managers_and_owners"}),l.length>1)(0,m.cS)(lng("remove from this workspace").caps(),{title:lng("remove users"),confirmText:lng("remove"),inputType:"select",selectOptions:l,onConfirm:e=>{(0,g.SC)("users/remove_users_from_group",{method:"POST",data:{managers:e.includes("managers")&&o,owners:e.includes("owners")&&a,group_id:r.group_id},json:!0},n)}});else{const e=i||(o.length>0?lng("are you sure you want to remove the selected managers?").caps():lng("are you sure you want to remove the selected owners?").caps());(0,m.BB)(e,{text:lng("remove").caps(),onConfirm:()=>{(0,g.SC)("users/remove_users_from_group",{method:"POST",data:{managers:o,owners:a,group_id:r.group_id},json:!0},n)}})}},Z=t.filter((e=>e._checked)),C=Z.filter((e=>e.manager)),S=o?[{icon:"new",toolTip:lng("add role members"),action:()=>y.openDialog("form",new A.C3({data:{group_id:a,group_type:d},onSaveSuccess:()=>(y.closeDialog(),n())}))},{icon:"trash",toolTip:lng("remove role members"),action:()=>k({areYouSure:lng("are you sure you want to remove the selected role members?")})},{icon:"ActionsSubmit",menu:[{label:lng("import members from a CSV or Excel"),onClick:()=>(0,u.p4)({import:"members",params:{workspace_id:a}},!0)}]}]:p?[{icon:"new",menu:[{label:lng("add managers"),onClick:()=>{y.openDialog("form",new A.UQ({data:{group_id:r.group_id,manager_permission_types:r.manager_permission_types,default_manager_setting:r.default_manager_setting,default_permissions:r.default_permissions},onSaveSuccess:()=>{(0,D.qV)(lng("managers assigned successfully")),y.closeDialog(),n()}}))}},{label:lng("add owners"),onClick:()=>y.openDialog("form",new q.J({data:{group_id:a,group_type:d},onSaveSuccess:()=>(y.closeDialog(),n())}))}]},{icon:"edit",toolTip:Z.length>C.length?lng("choose only managers to change permissions"):lng("change permissions"),action:Z.length>C.length||0===C.length?void 0:()=>w(C)},{icon:"trash",toolTip:lng("remove managers & owners"),action:0===Z.length?void 0:k}]:null,O=(null==S?void 0:S.filter((e=>"new"!==e.icon)).length)>0,B=[{narrow:!0},{title:lng("name").caps(),sortVal:"full_name"},...v,0===v.length&&{},s&&{},O&&{checkAll:!0}];return(0,x.tZ)(l.iA,{cols:B,collection:t,filters:_,sorts:f,RowRenderer:re,actions:S,rowIdCol:"user_id",rowProps:{rowAction:r.is_owner?e=>{w([e])}:void 0,userActions:s,roleWorkspace:o,group_id:a,group_type:d,less:b,is_owner:p,setPrimary:e=>{(0,g.SC)("users/set_manager_permissions",{method:"POST",json:!0,data:{user_id:e.user_id,group_id:a,main_manager:!0}}),t.forEach((e=>e.main_manager=!1)),e.main_manager=!0},ws:r,toggleDisplayManager:h,showCheckboxesCol:O},scrollParent:i,sticky:R.g.consts.TABLE_HEAD_HEIGHT+1})})),re=(0,a.observer)((function(e){let{row:t,rowProps:i}=e;const{userActions:n,group_id:r,group_type:s,less:o,is_owner:a,roleWorkspace:l,showCheckboxesCol:c,ws:d,toggleDisplayManager:u}=i,{inherited:m,owner:g,main_manager:v,mpt_name:_,perm_assignments:f,perm_meetings:y,perm_content:k,perm_portal:Z,perm_config:C,members_director:S,perm_evaluation:O,perm_grades_management:B,display_about:T}=t,N=!!t.manager,I=Blsm.user.isPowerManager||!Blsm.isFeatureEnabled("isolate_users"),D=[];return g&&D.push(lng("owner")),v&&D.push(lng("primary")),m&&D.push(lng("inherited")),N&&g&&!v&&!m&&D.push(lng("manager")),D.length>0&&(D[0]=D[0].caps()),(0,x.BX)("tr",{onClick:m||!N?void 0:()=>{var e;return null===(e=i.rowAction)||void 0===e?void 0:e.call(i,t)},children:[(0,x.tZ)("td",{className:"_avatar",children:(0,x.tZ)(p.qE,{user:t,balloon:U(d)})}),(0,x.BX)(w.U6,{width:"300px",children:[(0,b.v2)(t),l?"":D.length>0&&(0,x.BX)("b",{children:[" (",D.join(", "),")"]})]}),l?(0,x.tZ)("td",{children:v?(0,x.tZ)(h.JO,{icon:"radio_checked",color:R.g.colors.positive,buttonLike:!0}):(0,x.tZ)(h.JO,{icon:"radio",buttonLike:!0,color:R.g.colors.grey,onClick:()=>i.setPrimary(t)})}):(0,x.BX)(x.HY,{children:[(0,x.tZ)("td",{className:(0,b.AK)({_center:!o}),children:_}),!o&&(0,x.BX)(x.HY,{children:[(0,x.tZ)("td",{className:"_center",children:"1"==f?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:f>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:"1"==y?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:"1"==y||"2"==y?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:y>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:k>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),Blsm.isFeatureEnabled("evaluation")&&(0,x.tZ)("td",{className:"_center",children:O>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:B>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:S>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:Z>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""}),(0,x.tZ)("td",{className:"_center",children:C>0?(0,x.tZ)(h.JO,{icon:"mark_v_strong"}):""})]})]}),n&&(0,x.tZ)(x.HY,{children:(0,x.BX)(w.jA,{children:[(0,x.tZ)(se,{display_about:T,toggleDisplayManager:u,user:t,group_id:r,group_type:s,connected_user_is_owner:a,canContactUser:U(d)}),(0,x.tZ)(oe,{user:t,userLink:I,managersTable:!0})]})}),c&&(0,x.tZ)(w.Fo,{o:t})]})})),se=function(e){let{user:t,canSetCoaches:i,group_id:n,group_type:r,connected_user_is_owner:o,canContactUser:a,display_about:l,toggleDisplayManager:d}=e;const{pretend:p,user_id:m,members_director:b,manager:v,inherited:_}=t,[f,y]=(0,s.useState)(b);return(0,x.BX)(x.HY,{children:[p&&(0,x.tZ)(h.JO,{icon:"pretend",onClick:()=>(0,c.vm)().pretend(m),toolTip:lng("pretend to be this user"),buttonLike:!0}),a&&void 0!==window.bchat&&(0,x.tZ)(h.JO,{icon:"chat",onClick:()=>window.bchat.openChat(m),toolTip:lng("start chat"),buttonLike:!0}),a&&Blsm.isFeatureEnabled("create_messages")&&(0,x.tZ)(h.JO,{icon:"message",buttonLike:!0,onClick:()=>(0,u.p4)({message:"new",params:{to:t.user_id}},!0),toolTip:lng("send message")}),i&&(0,x.tZ)(h.JO,{icon:"manager",buttonLike:!0,toolTip:lng("set coaches"),onClick:()=>(0,c.vm)().openDialog("Component",{child:(0,x.tZ)(ae,{user:t,group_id:n}),title:lng("assignment member options")})}),o&&v&&"1"!==_&&"Ou"!==r&&(0,x.tZ)(h.JO,{icon:"user_sync",color:f?R.g.colors.positive:"",toolTip:lng("set as members director"),buttonLike:!0,onClick:()=>{const e=f?0:1;(0,g.SC)("users/set_members_director",{data:{group_id:n,user_id:m,set:e},method:"POST"},(()=>(0,D.qV)(e?lng("members director set"):lng("members director removed")))),y(e)}}),v&&!_&&(0,x.tZ)(h.JO,{icon:"menu_info",buttonLike:!0,toolTip:lng("display info about manager"),color:l?R.g.colors.positive:"",onClick:e=>d(e,m)})]})},oe=e=>{let{user:t,userLink:i,managersTable:n}=e;const{user_id:r,automatic_enrollment:s,owned:o}=t,a=(0,j.N)({user_id:r,is_manager:o}).map((e=>({...e,newTab:!0})));return(0,x.BX)(x.HY,{children:[i&&r&&(0,x.tZ)(h.JO,{icon:"user",buttonLike:!0,onClick:()=>(0,u.p4)({user:r},!0),toolTip:lng("user profile")}),!n&&(0,x.tZ)(v.x,{options:a,children:(0,x.tZ)(h.JO,{icon:"report",buttonLike:!0})}),s&&(0,x.tZ)(h.JO,{icon:"auto_enrolled",toolTip:lng("auto enrolled")})]})},ae=(0,a.observer)((function(e){let{user:t,group_id:i}=e;const[n,r]=(0,s.useState)(null);n||(0,g.SC)("assignment/assignment_users_options",{data:{user:t.user_id,group:i}},(e=>{r(e.items.map((e=>new y.o(e))))}));const o=[{title:lng("assignment name").caps()},{title:lng("coach").caps()},n&&{checkAll:!0}],c=(0,a.observer)((function(e){let{row:t,rowProps:i}=e;const{assignment_name:n,assignment_id:r,possible_coaches:o,coach_id:a,coach_type:l,set_coach:c}=t,{updateCoach:d}=i,[p,u]=(0,s.useState)(a||"");return l?(0,x.BX)("tr",{children:[(0,x.tZ)("td",{children:n}),(0,x.tZ)("td",{children:c||lng("not set").caps()}),(0,x.tZ)("td",{})]}):(0,x.BX)("tr",{children:[(0,x.tZ)("td",{children:n}),(0,x.tZ)("td",{children:(0,x.tZ)(E.I,{wrapped:!0,type:"select",options:(0,b.wd)(o),value:p,emptyOption:!0,onChange:e=>(t.coach_id=e,u(e),d({[r]:e}))})}),(0,x.tZ)(w.Fo,{o:t})]})})),d=e=>{(0,g.SC)("assignment/set_coach",{data:{user:t.user_id,data:e},method:"POST"})},p=n?[{icon:"group",toolTip:lng("set coach"),action:0===n.filter((e=>e._checked)).length?void 0:()=>{const e=n.filter((e=>e._checked)),t={};e.forEach((e=>Object.assign(t,(0,f.toJS)(e.possible_coaches)))),(0,m.cS)(lng("select coach"),{title:lng("select coach"),confirmText:lng("set"),inputType:"select",selectOptions:(0,b.wd)(t),onConfirm:t=>{const i={};e.map((e=>{Object.keys(e.possible_coaches).includes(t)&&(i[e.assignment_id]=t,e.coach_id=t)})),d(i),r(n.map((e=>(e._checked&&i[e.assignment_id]&&(e.coach_id=t),e))))}})}},{icon:"notifications",toolTip:lng("notify coaches"),action:0===n.filter((e=>e._checked)).length?void 0:()=>{const e=n.filter((e=>e._checked)).map((e=>e.assignment_id));(0,g.SC)("assignment/notify_coach",{data:{user:t.user_id,assignments:e},method:"POST"},(()=>(0,D.qV)("notification will be sent to selected coaches")))}}]:void 0;return(0,x.BX)("div",{children:[(0,x.tZ)("b",{children:t.full_name}),(0,x.tZ)(l.iA,{cols:o,collection:n,RowRenderer:c,loading:null===n,actions:p,rowIdCol:"assignment_id",rowProps:{updateCoach:d},noWindow:!0})]})})),le=(0,a.observer)((e=>{let{scrollParent:t,workspace:i}=e;i.mailingListLoaded||i.fetchMailinList();const n=[{narrow:!0},{title:lng("name").caps(),sortVal:"object_name"},i.mailingList.length>0&&{checkAll:!0}].filter((e=>!!e));let r=[{name:"full_name",label:lng("name"),type:"text"}];const s=[{val:"",label:lng("default")},{val:"name",label:lng("name")}],o=i.mailingList.filter((e=>e._checked&&"user"===e.object_type)).map((e=>e.user_id)),a=i.mailingList.filter((e=>e._checked&&"group"===e.object_type)).map((e=>e.group_id)),d=[{icon:"new",action:()=>{(0,c.vm)().openDialog("form",new L({data:{group_id:i.group_id,users:i.mailingList.filter((e=>"user"===e.object_type)).map((e=>e.user_id)),groups:i.mailingList.filter((e=>"group"===e.object_type)).map((e=>e.group_id))},onSaveSuccess:()=>{(0,c.vm)().closeDialog(),i.fetchMailinList()}}))}},{icon:"send_schedule",toolTip:lng("send schedule"),action:0===o.length&&0===a.length?void 0:()=>{(0,g.SC)("ajax/GroupsAjax.class.php",{method:"POST",data:{req:"send_schedule_mailing_list",users:o,groups:a,group_id:i.group_id}},(e=>1==e&&(0,D.qV)(lng("schedule sent successfully"))))}},{icon:"trash",action:0===o.length&&0===a.length?void 0:()=>{(0,m.BB)(lng("are you sure you want to delete the selected from mailing list?"),{onConfirm:()=>{(0,g.SC)("groups/remove_from_mailing_list",{method:"POST",data:{users:o,groups:a,group_id:i.group_id}},(()=>{i.mailingList=i.mailingList.filter((e=>!e._checked))}))}})}}];return(0,x.tZ)(l.iA,{cols:n,collection:i.mailingList,loading:!i.mailingListLoaded,filters:r,sorts:s,actions:d,RowRenderer:ce,rowIdCol:"key",scrollParent:t,sticky:R.g.consts.TABLE_HEAD_HEIGHT+1})})),ce=(0,a.observer)((e=>{let{row:t}=e;const{object_name:i,object_id:n,object_type:r}=t;return(0,x.BX)("tr",{children:[(0,x.tZ)("td",{className:"_avatar",children:"user"===r&&(0,x.tZ)(p.qE,{user:t})}),(0,x.BX)(w.U6,{children:["#",n," ",i,"group"===r&&(0,x.tZ)(h.JO,{icon:"manager",toolTip:lng("a schedule will be sent to the managers of the workspaces|help")})]}),(0,x.tZ)(w.Fo,{o:t})]})}))},443:(e,t,i)=>{i.d(t,{B:()=>p});var n=i(917),r=i(6920),s=(i(7882),i(1092)),o=i(2755),a=i(5311),l=i(8318),c=i(5944);const d=(0,n.iv)("padding-bottom:15px;margin-bottom:20px;border-bottom:1px solid ",r.g.colors.separator,";display:flex;align-items:center;>._children{display:flex;align-items:center;&._is_mobile{flex-direction:column;}>._separator{margin:10px;}}._tabs{color:",r.g.colors.text_main,";font-weight:bold;position:relative;top:22px;}.Icon{",r.g.classes.margin_near("11px"),";}",""),p=function(e){let{title:t,icons:i=[],tabs:n,tab:p,onTabSelect:u,content:m,children:g}=e;return(0,c.BX)("div",{css:d,className:"widget-header",children:[(0,c.BX)("div",{css:r.g.classes.flex_grow,children:[t&&(0,c.tZ)("div",{css:r.g.classes.widget_title,children:t.caps()}),n&&(0,c.tZ)(s.m,{tabs:n,activeTab:p,onSelect:u,className:"_tabs"}),m]}),g&&(0,c.BX)(c.HY,{children:[(0,c.BX)("div",{className:(0,l.AK)("_children",{_is_mobile:(0,l.tq)()}),children:[g.reduce(((e,t)=>e?(0,c.BX)(c.HY,{children:[e,(0,c.tZ)("div",{className:"_separator"}),t]}):t),null),(0,c.tZ)(a.zh,{})]}),(0,c.tZ)(a.zh,{})]}),(0,c.tZ)(o.bV,{icons:i})]})}},9234:(e,t,i)=>{i.d(t,{Iy:()=>j,PQ:()=>D,T0:()=>E,TY:()=>N,gL:()=>S,j$:()=>z,ol:()=>C,tP:()=>O,tc:()=>P,uO:()=>T});var n=i(917),r=i(5898),s=i(5875),o=i(6920),a=i(8207),l=i(5832),c=i(8411),d=i(8318),p=i(81),u=(i(7882),i(441)),m=i(1991),g=i(4902),h=i(3755),b=i(236),v=i(409),_=(i(2906),i(5562),i(5007)),f=i(6303),y=i(5560),w=i(6975),x=i(4765),k=i(8989),Z=i(5944);const C=e=>{let{entity:t,inContainer:i,className:n}=e;return(0,Z.tZ)(r.xr,{className:(0,d.AK)("smooth-theme",n),entity:t,playLink:t.link,inContainer:i,noComments:!0})},S=e=>{let{entity:t,inContainer:i,className:n,activeTab:s}=e;return(0,Z.tZ)(r.xr,{className:(0,d.AK)("smooth-theme",n),entity:t,playLink:{courseCatalog:!0,tab:s,id:(null==t?void 0:t.url_id)||t.group_id},inContainer:i,noComments:!0})},O=e=>{var t,i;let{entity:n,inContainer:r,className:o,href:a,showImg:l,newTab:c=!1,onClick:d,children:p,...u}=e;return(0,Z.BX)(s.o,{title:n.title,markColor:n.markColor,className:o,href:void 0!==a?a:{workspace:n.group_id,newTab:c},newTab:c,onClick:d,inContainer:r,img:l?n.image:void 0,menuOptions:n.menu(),tags:n.tags||[!n.hide_type&&(null===(t=n.type_title)||void 0===t?void 0:t.toUpperCase()),n.category].filter((e=>e)),progress:n.progress,...u,children:[p,n.progress&&(0,Z.tZ)("div",{children:(0,Z.tZ)(h.k,{numerator:n.progress[0],denominator:n.progress[1]})}),(null===(i=n.users)||void 0===i?void 0:i.length)>0&&(0,Z.tZ)("div",{children:(0,Z.tZ)(g.I9,{users:n.users,totalCount:n.count_users,maxSlots:3})})]})};var B={name:"1gpzra0",styles:"margin-bottom:1em"};const T=e=>{let{workspaces:t,compactView:i,onViewSelect:n,className:r,setShowOld:s,recent:o,displayCount:u}=e;const{filtersVals:m,setFilterVals:g,sort:h,setSort:b}=(0,p.qD)(),_=(0,l._V)("classification_name",t);t.find((e=>!e.attr("classification_name")))&&_.unshift({val:null,label:lng("no classification").caps()});const y={Ou:1,Course:2,Group:3,Qualification:4,Workplan:5,Campus:6,Course_template:7,Subset:8,PatientCase:9},w=[{val:"",label:lng("all")},...(0,l._V)("group_type",t,{labelFunc:e=>(0,v.p)(e,null,!0),sortFunc:(e,t)=>y[e]-y[t]})],x=[{name:"group_name",label:lng("name"),type:"text",outOfMenu:!0},!Blsm.isFeatureEnabled("hide_group_types")&&{name:"group_type",label:lng("type"),type:"tab",options:w},{name:"membership",label:lng("membership"),type:"select_multi",options:[{val:"is_manager",label:lng("is manager").caps()},{val:"is_member",label:lng("is member").caps()}],func:(e,t)=>e.some((e=>"1"===(null==t?void 0:t._attr[e])))},{name:"show_old",label:lng("include past workspaces"),type:"checkbox",func:(e,t)=>t},{name:"bookmarked",label:lng("bookmarked"),type:"checkbox"},{name:"recent_groups",label:lng("recently viewed workspaces"),type:"checkbox",func:(e,t)=>{if(e){return(k.X.get("recent_groups")||[]).includes(+t.group_id)}return!0}}].filter((e=>!!e)),C=[{val:"",label:lng("default")},{val:"group_name",label:lng("name")},{val:"group_type",label:lng("type")},{val:"classification_name",label:lng("classification")},{val:"sorting_open_date",label:lng("open date")},{val:"sorting_close_date",label:lng("close date")}],S=(0,l.WB)(t,m,h,{recent:o,filters:x}),O=(0,Z.tZ)(c.CX,{filters:x,filtersVals:m,onFilter:e=>{s(!!e.show_old),g(e)},sorts:C,sort:h,onSort:b,compactView:i,onViewSelect:n,alwaysShow:!0,displayCount:{count:S.length,display:u}});return(0,Z.BX)(a.W2,{head:O,className:r,noBottomPadding:!0,children:[_.length>1&&(0,Z.tZ)(f._,{options:_,value:m.classification_name,theme:"tags",css:B,onChange:e=>g((0,d.v7)(Object.assign({},m,{classification_name:e||void 0})))}),(0,Z.tZ)(N,{workspaces:(0,l.WB)(t,m,h,{recent:o,filters:x}),compactView:i})]})},N=(0,y.observer)((function(e){let{workspaces:t,compactView:i,page:n,activeTab:r,title:s,mainTitle:a,useCarousel:l,floatingControls:c}=e;const d=t.map((e=>{const t={key:e.url_id||e.group_id,entity:e,inContainer:!0};let s;return i?s=(0,Z.tZ)(x.Q,{item:e},e.group_id):"registration"===n?s=(0,Z.tZ)(S,{...t,activeTab:r}):"dashboard"===n?("assignments"===r&&(t.key=e.assignment_dashboard_id),s=(0,Z.tZ)(j,{...t,activeTab:r})):s=(0,Z.tZ)(C,{...t}),s}));return(0,Z.BX)("div",{children:[s&&t.length>0&&(0,Z.tZ)(D,{title:s,mainTitle:a,count:t.length}),l?(0,Z.tZ)(m.T,{floatingControls:c,children:d}):i?(0,Z.tZ)("div",{css:o.g.classes.list,children:d}):(0,Z.tZ)(b.Hl,{children:d})]})})),I=(e,t)=>(0,n.iv)("font-size:",e?"1.4rem;":"1.2rem;",";font-weight:600;margin:10px 0;padding:5px 0;>span{font-size:1.2rem;color:",o.g.colors.text_sec,";margin:10px 0;padding:5px 0;}.suffix{color:",t||o.g.colors.text_sec,";}.Icon{display:none;font-size:",e?"1rem;":".8rem;",";}&:hover{.Icon{display:inline;}}",""),D=e=>{let{title:t,count:i,mainTitle:n,icon:r,className:s,suffix:o}=e;const a="string"==typeof r?(0,Z.tZ)(w.JO,{icon:r}):r;return(0,Z.BX)("div",{className:s,css:I(n,null==o?void 0:o.color),children:[null==t?void 0:t.caps(),i>0&&(0,Z.BX)("span",{children:[" (",i,")"]})," ",(0,Z.tZ)("span",{children:a}),o&&(0,Z.tZ)("span",{className:"suffix",children:o.text})]})},j=e=>{let{entity:t,inContainer:i,className:n}=e;return(0,Z.tZ)(r.xr,{className:(0,d.AK)(n),entity:t,inContainer:i,onTitleClick:()=>{"assignment"===t.type?(0,_.vm)().showSideDrawer(t):"workspace"===t.type&&(0,u.p4)({workspace:t.group_id},!0)},noComments:!0,noAction:!0})},P=e=>Blsm.CanUser("create","groups")&&"Group"===e||Blsm.CanUser("create","templates")&&"Course_template"===e||Blsm.CanUser("create","ous")&&"Ou"===e||Blsm.CanUser("create","workplans")&&"Workplan"===e||Blsm.CanUser("create","patientcase")&&"PatientCase"===e||Blsm.CanUser("create","qualifications")&&"Qualification"===e,z=()=>Blsm.CanUser("create","groups")||Blsm.CanUser("create","templates")||Blsm.CanUser("create","ous")||Blsm.CanUser("create","workplans")||Blsm.CanUser("create","patientcase")||Blsm.CanUser("create","qualifications"),E=()=>[{type:"Course",label:lng("course"),icon:"mng_courses",check:P("Group")},{type:"Course_template",label:lng("course template"),icon:"mng_courses",check:P("Course_template")},{type:"Qualification",label:lng("qualification"),icon:"mng_qualifications",check:P("Qualification")},{type:"Group",label:lng("group"),icon:"mng_users",check:P("Group")}].filter((e=>{let{check:t}=e;return!!t})).map((e=>{let{type:t,label:i,icon:n}=e;return{label:i,icon:n,href:{edit:"workspace",params:{type:t.toLowerCase()}}}}))},918:(e,t,i)=>{i.d(t,{a:()=>w,v:()=>u});var n=i(917),r=i(6920),s=i(7154),o=i(8318),a=i(441),l=i(6344),c=i(7363),d=i(5944);const p=(0,n.iv)("width:100%;table-layout:fixed;border-collapse:collapse;border:1px solid ",r.g.colors.border,";color:",r.g.colors.text_sec,";th{border:1px solid ",r.g.colors.border,";height:30px;padding:0;}th.weekend{background-color:",r.g.colors.highlight,";}td.month-name,th:first-of-type{width:90px;}",""),u=e=>{let{curYear:t,eventsArray:i}=e;const n=(0,o.w6)(37),r=(0,o.w6)(12).map((e=>{const i=new Date(t,e,1).getDay(),n=new Date(t,e+1,0).getDate();return{month:e,startIndex:i,endIndex:i+n,daysInMonth:n}}));return(0,d.BX)("table",{css:p,children:[(0,d.tZ)("thead",{children:(0,d.BX)("tr",{children:[(0,d.tZ)("th",{}),n.map((e=>(0,d.tZ)("th",{className:e%7>4?"weekend":"",children:(0,d.tZ)("div",{children:Blsm.lang.shortWeekDays[e%7]})},e)))]})}),(0,d.tZ)("tbody",{children:r.map((e=>{let{startIndex:n,endIndex:r,month:s,daysInMonth:o}=e;return(0,d.tZ)(g,{startIndex:n,endIndex:r,daysInMonth:o,month:s,year:t,monthEvents:i[s]},s)}))})]})},m=(0,n.iv)("td{border:solid ",r.g.colors.border,";border-width:1px 0 1px;vertical-align:top;.month-label{text-align:center;}&:first-child{border-",r.g.far,"-width:1px;}}",""),g=e=>{let{year:t,month:i,startIndex:n,endIndex:r,daysInMonth:s,monthEvents:a}=e;const l=(0,o.w6)(37),c=a.sort(((e,t)=>e.start-t.start)),p=[],u={};return c.length&&c.forEach((e=>{e.curMonthDayStart=t===e.start_year&&i===e.start_month?e.start_day-1:0,e.curMonthDayEnd=t===e.end_year&&i===e.end_month?e.end_day-1:s-1,e.open=i===e.start_month&&e.start_year===t,e.close=i===e.end_month&&e.end_year===t;const n=y(e,p,s);for(let t=e.curMonthDayStart;t<=e.curMonthDayEnd;t++)p[n][t]=e.id;u[n]=u[n]||{},u[n][e.curMonthDayStart]={...e}})),(0,d.BX)(d.HY,{children:[(0,d.BX)("tr",{css:m,children:[(0,d.tZ)("td",{rowSpan:p.length+1,className:"month-name",children:(0,d.tZ)("div",{className:"month-label",children:Blsm.lang.Months[i]})}),l.map((e=>(0,d.tZ)(b,{dayIndex:e,startIndex:n,endIndex:r},e)))]}),p.map(((e,t)=>(0,d.tZ)("tr",{children:l.map((e=>u[t][e-n]?(0,d.tZ)(_,{month:i,event:u[t][e-n]},i+"_"+t+"_"+e):(0,d.tZ)(f,{},t+"_"+e)))},t)))]})},h=(0,n.iv)("color:",r.g.colors.text_light_disabled,";text-align:center;&.weekend{background-color:",r.g.colors.highlight,";}",""),b=e=>{let{dayIndex:t,startIndex:i,endIndex:n}=e;return t>=i&&t<n?(0,d.tZ)("td",{css:h,className:t%7>4?"weekend":"",children:(0,d.tZ)(s.u,{text:Blsm.lang.weekDays[t%7],children:t-i+1})}):(0,d.tZ)(f,{})},v=(0,n.iv)("color:white;cursor:default;position:relative;.event{line-height:1em;&:hover{box-shadow:0 1px 3px ",r.g.colors.blue,";}&.open{border-top-",r.g.near,"-radius:",r.g.consts.SKINNY_BORDER_RADIUS,"px;border-bottom-",r.g.near,"-radius:",r.g.consts.SKINNY_BORDER_RADIUS,"px;}&.close{border-top-",r.g.far,"-radius:",r.g.consts.SKINNY_BORDER_RADIUS,"px;border-bottom-",r.g.far,"-radius:",r.g.consts.SKINNY_BORDER_RADIUS,"px;}.label{padding:2px 4px;white-space:nowrap;}div{width:100%;display:inline-block;}&>div>div{",r.g.classes.ellipsis,";}}",""),_=e=>{let{event:t}=e;const[i,n]=(0,c.useState)(),{curMonthDayEnd:p,curMonthDayStart:u,datesString:m,eventIndex:g,id:h,name:b,open:_,close:f,className:y}=t,w=1+p-u,x=r.g.colors.set[g%16],k={color:(0,l.ou)(x),backgroundColor:x,width:i?i*w+"px":`${w}00%`};return(0,d.tZ)("td",{css:v,ref:e=>e&&n(e.getBoundingClientRect().width),children:(0,d.tZ)("div",{onClick:()=>(0,a.p4)({workspace:h},!0),className:(0,o.AK)("event",y,{open:_,close:f}),style:k,children:(0,d.tZ)(s.u,{text:b+"\r\n"+m,children:(0,d.tZ)("div",{className:"label",children:b})})})})},f=()=>(0,d.tZ)("td",{css:(0,n.iv)("background-color:",r.g.colors.bg_page_containers,";","")}),y=(e,t,i)=>{let n=0;for(;n>=0;){if(!t[n])return t[n]=Array(i),n;let r=!0;for(let i=e.curMonthDayStart;i<=e.curMonthDayEnd;i++)r=r&&!t[n][i];if(r)return n;n++}},w=(e,t)=>{const i=[[],[],[],[],[],[],[],[],[],[],[],[]];return null==e||e.forEach(((e,n)=>{e.eventIndex=n+1;const r=new Date(1e3*e.start),s=new Date(1e3*e.end);if(r.getFullYear()===t||s.getFullYear()===t){e.start_year=r.getFullYear(),e.start_month=e.start_year<t?0:r.getMonth(),e.start_day=e.start_year<t?1:r.getDate(),e.end_year=s.getFullYear(),e.end_month=e.end_year>t?11:s.getMonth(),e.end_day=e.end_year>t?31:s.getDate(),e.datesString=moment(r).format("DD.MM.YYYY")+" - "+moment(s).format("DD.MM.YYYY");for(let t=e.start_month;t<=e.end_month;t++)i[t].push(e)}})),i}},8172:(e,t,i)=>{i.d(t,{Du:()=>me,iX:()=>pe,IW:()=>de});var n=i(5560),r=i(917),s=i(6920),o=i(7363),a=i(3051),l=i(4902),c=i(6975),d=i(441),p=i(8318),u=i(81),m=i(8e3),g=i(8207),h=i(3178),b=i(6421),v=i(7392),_=i(5007),f=i(5944);const y=(0,r.iv)(".exp{margin-bottom:30px;}.error{color:",s.g.colors.negative,";}.inputs{margin:15px 0;display:flex;align-items:center;>*+*{",s.g.classes.margin_near("10px"),";}}.qrWrapper{position:relative;}.expiredLabel{position:absolute;top:calc(50% - 1em);font-size:1.5em;font-weight:bold;display:inline;left:0;width:calc(100% - 20px);text-align:center;}&.expired{.qr{opacity:0.1;}}",""),w=function(){const[e,t]=(0,o.useState)(""),[i,n]=(0,o.useState)(""),[r,s]=(0,o.useState)(""),a=(0,u.tm)();let l;let c=window.location.protocol+"//"+window.location.host+Blsm.prm.relative_path;return r&&"expired"!==r&&(c+="?"+(0,p.Wh)({login_token:r})),(0,f.tZ)("div",{css:y,width:"650px",className:(0,p.AK)({expired:"expired"===r}),children:(0,f.BX)(g.U0,{children:[(0,f.BX)("div",{className:"qrWrapper",children:[(0,f.tZ)(h.s,{value:c,size:260,className:"qr"}),"expired"===r&&(0,f.tZ)("div",{className:"expiredLabel",children:lng("expired").caps()})]}),(0,f.BX)("div",{children:[(0,f.tZ)("div",{className:"exp",children:lng("scan the QR code with your mobile device.").caps()}),(0,f.BX)("form",{onSubmit:function(t){t.preventDefault(),e&&(0,m.SC)("users/login_token",{data:{password:e},method:"POST"},(e=>{clearTimeout(l),a.current&&(e.error?(s(""),n(e.error)):e.login_token&&(s(e.login_token),n(e.error)),l=setTimeout((()=>a.current&&s("expired")),3e5))}))},children:[lng("you may enter your password to skip login screen on your device:").caps(),(0,f.BX)("div",{className:"inputs",children:[(0,f.tZ)(b.I,{type:"password",wrapped:!0,label:lng("password"),value:e||void 0,onChange:t,error:i}),(0,f.tZ)("div",{children:(0,f.tZ)(v.l,{theme:"contained",formButton:!0,disabled:!e,children:lng("confirm").caps()})})]})]}),i&&(0,f.tZ)("div",{className:"error",children:i}),r&&(0,f.tZ)("div",{children:lng("QR code will be valid for 5 minutes!")})]})]})})},x=()=>(0,_.vm)().openDialog("Component",{child:(0,f.tZ)(w,{}),title:lng("mobile qr code")});var k=i(8989);const Z=(0,r.iv)("display:flex;justify-content:center;align-items:center;>._main{",s.g.classes.margin_near("1em"),";",s.g.classes.margin_far("0.5em"),";._label{display:block;color:",s.g.colors.text_main,";font-weight:700;&:hover{text-decoration:underline;}}._sub_label{font-size:.8em;}}",s.g.mQuery.max(650),"{>._main{display:none;}}",""),C=e=>{var t,i,n;let{user:r,className:s}=e;const{id:o,real_data:u}=r,g=[{onClick:()=>(0,d.p4)({logout:!0},!0),label:lng("logout").caps(),icon:"exit"},u&&{onClick:()=>(0,_.vm)().pretend(0),label:lng("stop pretending").caps(),icon:"no_entry"},!(null!==(t=Blsm.InitialData.parameters)&&void 0!==t&&t.dont_go_mobile)&&!(0,p.tq)()&&{onClick:x,label:lng("go mobile").caps(),icon:"qrcode"}];let h=k.X.get("recent_pretend")||[];u&&(null===(i=h[0])||void 0===i?void 0:i.id)!==o&&(h.unshift({id:o,name:(0,p.v2)(r),path:Blsm.prm.Mainref||null}),h=h.filter(((e,t)=>h.findIndex((t=>t.id==e.id&&(!e.path||e.path==t.path)))===t)),h.length=Math.min(11,h.length),k.X.set("recent_pretend",h));const b=Blsm.user.isPowerManager||(null===(n=Blsm.user.real_data)||void 0===n?void 0:n.isPowerManager),v=h.filter((e=>{let{id:t,path:i}=e;return!((0,p.Tz)(t)||i&&i!==Blsm.prm.Mainref)})).map((e=>{let{id:t,name:i}=e;return{val:t,label:i}}))||[];(v.length||u||Blsm.user.isAdmin||b)&&(g.push({separator:!0,label:lng("pretend").caps()}),(u||Blsm.user.isAdmin||b)&&g.push({input:{type:"text",label:lng("pretend to be")+"...",maxWidth:"136px",wrapped:!0,showId:!0,suggest:{getData:(0,p.pR)(((e,t)=>{var i;return(0,m.SC)("users/autocomplete",{method:"POST",json:!0,data:{term:e||"",cross_domain:1,show_domain:Blsm.user.isAdmin||null!==(i=Blsm.user.real_data)&&void 0!==i&&i.isAdmin?1:0,exclude:null==u?void 0:u.id}},t)}))},onSelect:e=>(0,_.vm)().pretend(e.id)},inputOnly:!0}),v.length&&g.push(...v));let y,w=[],C=!1;if(Blsm.user.domains_list){C=lng("admins").caps(),Blsm.user.isAdmin||w.push({val:null,label:lng("admins").caps()});const e=parseInt(Blsm.user.domain_id);Blsm.user.domains_list.forEach((t=>{let[i,n]=t;Blsm.user.isAdmin||i!==e?w.push({val:i,label:n}):C=n})),y=e=>(0,m.SC)("ajax/requests.php",{method:"POST",data:{req:"AdminSwitchDomain",domain:e}},(()=>location.reload(!0)))}else Blsm.user.multi_user.length&&(Blsm.user.multi_user.forEach((e=>{let[t,i]=e;parseInt(Blsm.user.id)===t?C=i:w.push({val:t,label:i})})),y=e=>(0,m.SC)("ajax/requests.php",{method:"POST",data:{req:"SwitchMultiUser",multiuser:e}},(()=>{Blsm.cookies.set("csrf_token","",{expires:-1,path:Blsm.prm.relative_path}),window.location.replace(location.href.split("#")[0])})));return(0,f.BX)("div",{css:Z,className:s,children:[(0,f.tZ)(d.A,{href:{user:o},children:(0,f.tZ)(l.qE,{className:"_avatar",size:"2.3em",rounded:!1,user:r,balloon:!1})}),(0,f.BX)("div",{className:"_main",children:[(0,f.tZ)(d.A,{href:{user:o},className:"_label",children:(0,p.v2)(r)}),(0,f.BX)("div",{className:"_sub_label",children:[u&&(0,f.tZ)(d.A,{href:{user:u.id},children:(0,p.v2)(u)}),w.length>0&&(0,f.BX)(f.HY,{children:[u&&(0,f.tZ)(f.HY,{children:", "}),(0,f.tZ)(a.x,{dropDownLike:!0,options:w,onSelect:y,scrollable:!0,children:C})]})]})]}),(0,f.tZ)(a.x,{options:g,onSelect:e=>e&&(0,_.vm)().pretend(e),children:(0,f.tZ)(c.JO,{icon:"menu",buttonLike:!0})})]})};var S=i(7154),O=i(3205),B=i(7861);const T=(0,r.iv)("display:flex;align-items:center;",s.g.classes.margin_far("5px"),";>.search_input{background-color:",s.g.darkMode?s.g.colors.bg_input:"#F6F6F6",";padding:0 10px;display:flex;align-items:center;border-radius:8px;height:41px;>.Icon-search{cursor:pointer;transition:font-size .1s;}>input{flex-grow:1;background-color:transparent;height:100%;border:0;color:",s.g.colors.text_main,";width:250px;&::placeholder{color:",s.g.colors.text_placeholder,";}}}",s.g.mQuery.max(520),"{",s.g.classes.margin_near("10px"),";.Icon-search{font-size:17px;}.search_input{>input{width:150px;}}&._focused{position:fixed;top:0;left:0;right:0;height:",s.g.consts.TOP_BAR_HEIGHT,"px;background:white;border-radius:0;z-index:1;}}",""),N=(0,n.observer)((function(){const{searchStore:e}=(0,o.useContext)(_.l9),[t,i]=(0,o.useState)(!1),n=(0,p.tq)();if(n&&!t)return(0,f.tZ)("div",{css:T,children:(0,f.tZ)(c.JO,{icon:"search",onClick:()=>i(!0)})});const r=e.skillSearchForm?[...e.skillSearchForm.values.values()].map((e=>e)):[],s=["content","mycontent","catalog","assignments","users","groups"].includes(e.activeCategory);return(0,f.BX)("form",{css:T,onSubmit:e=>e.preventDefault(),className:(0,p.AK)({_focused:t}),children:[e.recentSearches.length>0&&(0,f.tZ)(j,{icon:"clock",contextMenu:{items:e.recentSearches,onSelect:t=>e.loadHistory(t),title:lng("recent searches")}})," ",!n&&(0,f.tZ)(j,{icon:"search",label:(0,B.hI)()[e.activeCategory],contextMenu:{items:e.searchCategories,title:lng("search category"),onSelect:t=>e.activeCategory=t,inForm:!0}})," ",(0,f.BX)("div",{className:"search_input",children:[(0,f.tZ)("input",{type:"text",placeholder:lng("search").caps()+"...",value:e.searchTerm,onChange:t=>e.setQDelayed(t.target.value),onKeyUp:t=>"Escape"===t.key?e.clearSearch():"Enter"===t.key?e.doSearch():void 0,ref:e=>t&&(null==e?void 0:e.focus()),onBlur:()=>i(!1)}),(0,f.tZ)(c.JO,{icon:"arrow_go_"+Blsm.lang.lngAlignOpposite,onClick:()=>e.doSearch(),toolTip:lng("search")})]})," ",e.skillSearchForm&&(0,f.tZ)(j,{form:e.skillSearchForm,icon:"skill",label:lng("skills"),active:r.length>0,disabled:!s})]})})),I=(0,r.iv)("padding:0 10px;border-radius:8px;height:41px;border:1px solid ",s.g.colors.separator_light,";display:flex;align-items:center;cursor:pointer;&:hover{color:",s.g.colors.blue,";background-color:",s.g.colors.blue_shade,";}>div.label{margin:0 10px;white-space:nowrap;}&.active{.search-option-icon{color:",s.g.colors.blue,";}}&.disabled{color:",s.g.colors.disabled_text,";background-color:",s.g.colors.disabled_input,";cursor:not-allowed;}",""),D={name:"24arfb",styles:"padding:0 10px 12px"},j=e=>{let t,{form:i,contextMenu:n,icon:r,label:s,active:o,disabled:l}=e;return i?t=(0,f.tZ)("div",{css:D,children:(0,f.tZ)(O.l,{type:"inline",form:i})}):n&&(t=(0,f.tZ)(a.h,{...n})),l?(0,f.tZ)("div",{children:(0,f.BX)("div",{css:I,className:(0,p.AK)({disabled:l}),children:[r&&(0,f.tZ)(c.JO,{icon:r,className:"search-option-icon"}),s&&(0,f.tZ)("div",{className:"label",children:s.caps()})]})}):(0,f.tZ)("div",{children:(0,f.tZ)(S.y,{content:t,behavior:n?"menu":"click",balloonModes:{align:Blsm.lang.lngAlignOpposite,ignoreAnchor:!0,noTriangle:!0},children:(0,f.BX)("div",{css:I,className:(0,p.AK)({active:o}),children:[r&&(0,f.tZ)(c.JO,{icon:r,className:"search-option-icon"}),s&&(0,f.tZ)("div",{className:"label",children:s.caps()}),i&&(0,f.tZ)(c.JO,{icon:"triangle_down"})]})})})};var P=i(9180),z=i(5405),E=i(7376),R=i(9483),F=i(5597),M=i(7137);const A={name:"1plv9oe",styles:"justify-content:center;display:flex;align-items:center;.Icon{font-size:1.4rem;}.Icon-light_bulb{font-size:1rem;}.empty-notifications{padding:10px 20px;}.skills-notification{-webkit-animation:colored 20s infinite linear;animation:colored 10s infinite linear;}@-webkit-keyframes colored{from{filter:hue-rotate(0deg);}50%{filter:hue-rotate(-360deg);}to{filter:hue-rotate(0deg);}}"},q=(0,n.observer)((function(){const e=(0,o.useContext)(_.l9),t=[1,2,3].map((e=>(0,M.r0)(e).color)),[i,n]=(0,o.useState)(0),r=e.notificationsStore.approvalTypesSorted(),a=e.notificationsStore.totalApprovals(),l=r.map((e=>F.KX[e])).join(", "),p=(0,o.useRef)(0),u=!e.notificationsStore.skillsExist,g=e.notificationsStore.t2k_echo_req;(0,o.useEffect)((()=>{const e=setTimeout((()=>n((i+1)%3)),5e3);return()=>clearTimeout(e)}),[i]);return(0,f.BX)("div",{css:A,children:[u&&Blsm.isFeatureEnabled("skills_occupations")&&(0,f.tZ)(c.JO,{smallButtonLike:!0,toolTip:lng("select and rank your skills").caps(),className:"skills-notification",icon:"skill",onClick:()=>(0,d.p4)({user:!0,tab:"skills"},!0),color:t[i]}),a>0&&(0,f.tZ)(c.JO,{icon:"sign_notification",color:s.g.colors.blossom,smallButtonLike:!0,toolTip:lng("%s approvals waiting",a)+` (${l})`,href:{list:"approvals",params:`type=${r[0]}`}}),g&&(0,f.tZ)(z.SV,{children:(0,f.tZ)(c.JO,{icon:"light_bulb",title:lng("Instructor Insights|timetoknow").caps(),badge:e.notificationsStore.t2k_echo_count,alertBadge:!0,smallButtonLike:!0,href:"#t2k_echo"})}),(0,f.tZ)(c.JO,{icon:"by_mail",onClick:()=>(0,d.p4)({message:!0},!0),badge:e.notificationsStore.inbox_unread_count,smallButtonLike:!0,alertBadge:!0}),(0,f.tZ)(S.y,{content:(0,f.tZ)(L,{}),onOpen:()=>{e.notificationsStore.new_count&&(p.current=setTimeout((()=>{e.notificationsStore.new_count=0,Blsm.helpers.favicon_dot(!1),(0,m.SC)("notifications/update_gui_notification_time",{method:"POST"})}),1500))},onClose:()=>clearTimeout(p.current),mobileLayoutSupport:!0,noPortal:!0,children:(0,f.tZ)(c.JO,{icon:"notifications",badge:e.notificationsStore.new_count,alertBadge:!0,smallButtonLike:!0})})]})})),X=(0,r.iv)("min-width:350px;color:",s.g.colors.text_sec,";.notification-header{display:flex;padding:10px;align-items:baseline;.spacer{flex-grow:1;}.mark-read,.show-important{font-size:.9em;color:",s.g.colors.text_main,";cursor:pointer;&:hover{text-decoration:underline;}}.important-on{color:",s.g.colors.dominant_main,";}.title{font-size:1.1em;font-weight:bold;color:",s.g.colors.text_main,";}}.notifications-list{max-height:calc(100vh - 170px);overflow:auto;}.empty-notifications{text-align:center;}.get-more{background-color:",s.g.colors.bg_1,";color:",s.g.colors.text_main,";text-align:center;cursor:pointer;padding:1px;}.activity-row2{max-width:500px;}",""),L=(0,n.observer)((function(){const e=(0,o.useContext)(_.l9);return(0,f.BX)("div",{css:X,children:[(0,f.BX)("div",{className:"notification-header",children:[(0,f.tZ)("div",{className:"title",children:lng("notifications").caps()}),(0,f.tZ)("div",{className:"spacer"}),(0,f.tZ)("div",{className:"show-important"+(e.notificationsStore.showImportant?" important-on":""),onClick:()=>e.notificationsStore.toggleImportant(),children:e.notificationsStore.showImportant?lng("show all").caps():lng("show important").caps()}),"|",(0,f.tZ)("div",{className:"mark-read",onClick:()=>e.notificationsStore.markNotificationsRead(),children:lng("mark all as read").caps()})]}),e.notificationsStore.filteredNotifications.length?(0,f.tZ)("div",{className:"notifications-list",children:e.notificationsStore.filteredNotifications.map((e=>(0,f.tZ)($,{notification:e},e.pn_id)))}):(0,f.tZ)("div",{className:"empty-notifications",children:(0,f.tZ)(c.JO,{icon:"notifications_off"})}),e.notificationsStore.notifications.length<e.notificationsStore.total&&(0,f.BX)("div",{className:"get-more",onClick:()=>e.notificationsStore.fetchNotifications({more:!0}),children:[lng("more").caps(),"..."]})]})})),$=e=>(0,f.tZ)(z.SV,{children:(0,f.tZ)(V,{...e})}),V=(0,n.observer)((function(e){let{notification:t}=e;switch(t.object_type){case"message":return(0,f.tZ)(Y,{notification:t});case"activity":return(0,f.tZ)(U,{notification:t});case"following_assignment":return(0,f.tZ)(Q,{notification:t});case"comment_mention":return(0,f.tZ)(ee,{notification:t});default:return console.error("NotificationItem: unknown notification",t),(0,f.tZ)("div",{})}})),U=(0,n.observer)((function(e){let{notification:t}=e;switch(t.activity_type){case"assignment":return(0,f.tZ)(H,{notification:t});case"task":return(0,f.tZ)(J,{notification:t});case"comment":return"patients_communication"===t._attr.data.comment_type?(0,f.tZ)(K,{notification:t}):(0,f.tZ)(G,{notification:t});case"discussion":return(0,f.tZ)(W,{notification:t});default:return console.error("BaseActivityNotificationItem: unknown activity",t),(0,f.tZ)("div",{})}})),H=(0,n.observer)((e=>{let{notification:t}=e;const{context_group_id:i,data:n}=t._attr,r={title:n.activity_assignment_name,is_read:t.is_read,href:`#workspace/${i}/components//${n.activity_assignment_id}`,time:t.time,user:t.user,pn_id:t.pn_id,status:{}},s=(0,f.BX)("div",{children:["update"===n.action&&lng("updated by").caps()+" "+(0,p.v2)(t.user),(0,f.tZ)(P.ij,{time:r.time})]});return(0,f.tZ)(ie,{...r,children:s})})),J=(0,n.observer)((e=>{let{notification:t}=e;const{data:i}=t._attr,n={title:t.task_title,is_read:t.is_read,href:{edit:"task",id:t.task_id},time:t.time,user:t.user,pn_id:t.pn_id,status:{task_resolution:t.task_resolution,task_status:t.task_status,assignee:t.assignee_name,updates:t.subs.length}};let r="";switch(i.action){case"create":r=(0,f.BX)("span",{children:[lng("created by").caps()," ",(0,p.v2)(t.user)]});break;case"update":r=(0,f.BX)("span",{children:[lng("updated by").caps()," ",(0,p.v2)(t.user)]})}return(0,f.tZ)(ie,{...n,children:r})})),G=(0,n.observer)((e=>{let{notification:t}=e,{context_group_id:i,data:n}=t._attr;const r={title:"",is_read:t.is_read,href:null,time:t.time,user:t.user,pn_id:t.pn_id,status:{}};let s,o=(0,p.v2)(t.user),a={},l=i,c=n,u=t.time,m="";const g=c.comment_text?(0,p.s9)(c.comment_text):null;if("create"===c.action)switch(c.comment_type){case"discussion":s={edit:"discussion",id:n.discussion_id},m=(0,f.BX)("span",{children:[lng("commented in")," '",c.discussion_title,"'"]});break;case"task_manager":case"task":o=t.task_title,a={task_resolution:t.task_resolution,task_status:t.task_status,assignee:t.assignee_name,updates:t.subs.length},s={edit:"task",id:c.task_id,section:`c=${c.comment_id}`},m=g?(0,f.tZ)(S.u,{html:c.comment_text.mentions(),children:(0,f.BX)("div",{children:[(0,p.v2)(t.user)," ",lng("commented on the task")]})}):(0,f.BX)("div",{children:[(0,p.v2)(t.user)," ",lng("commented on the task")]});break;case"assignment":"catalog"===c.assignment_type?(s=(0,d.p4)({workspace:l,tab:"components",component:c.assignment_id}),m=(0,f.BX)("span",{children:[lng("commented on the content")," '",c.assignment_name,"'"]})):(s=(0,d.p4)({workspace:l,tab:"components",component:c.assignment_id}),m=(0,f.BX)("span",{children:[lng("commented on the assignment")," '",c.assignment_name,"'"]}));break;case"content":s=(0,d.p4)({workspace:l,tab:"social",component:c.lesson_id}),m=(0,f.BX)("span",{children:[lng("commented on the blog post")," '",c.assignment_name,"'"]});break;case"comment":switch(c.real_type){case"task_manager":case"task":o=t.task_title,a={task_resolution:t.task_resolution,task_status:t.task_status,assignee:t.assignee_name,updates:t.subs.length},s={edit:"task",id:c.task_id,section:`c=${c.comment_id}`},m=g?(0,f.tZ)(S.u,{html:c.comment_text.mentions(),children:(0,f.BX)("div",{children:[(0,p.v2)(t.user)," ",lng("replied to a comment on the task")]})}):(0,f.BX)("div",{children:[(0,p.v2)(t.user)," ",lng("replied to a comment on the task")]});break;case"discussion":s={edit:"discussion",id:n.discussion_id},m=(0,f.BX)("span",{children:[lng("replied to a comment on the discussion")," '",c.discussion_title,"'"]});break;case"assignment":"catalog"===c.assignment_type?(s=(0,d.p4)({workspace:l,tab:"components",component:c.assignment_id}),m=(0,f.BX)("span",{children:[lng("replied to a comment on the content")," '",c.assignment_name,"'"]})):(s=(0,d.p4)({workspace:l,tab:"components",component:c.assignment_id}),m=(0,f.BX)("span",{children:[lng("replied to a comment on the assignment")," '",c.assignment_name,"'"]}));break;case"content":s=(0,d.p4)({workspace:l,tab:"social",component:c.lesson_id}),m=(0,f.BX)("span",{children:[lng("replied to a comment on the blog post")," '",c.assignment_name,"'"]});break;default:console.error("note: unknown activity",c)}break;case"performance":s=(0,d.p4)({report:"Performance",params:{performance_id:c.performance_id}}),m=(0,f.BX)("span",{children:[lng("commented on a performance for")," '",c.performance_name,"'"]});break;default:console.error("note: unknown activity",c)}return r.title=o,r.href=s,r.status=a,r.time=u,(0,f.tZ)(ie,{...r,children:m})})),W=(0,n.observer)((e=>{let{notification:t}=e;const{data:i}=t._attr,n={title:(0,p.v2)(t.user),is_read:t.is_read,href:{edit:"discussion",id:i.discussion_id},time:t.time,user:t.user,pn_id:t.pn_id},r=(0,f.tZ)("div",{children:"create"===i.action&&`${lng("started the new discussion")} '${i.discussion_title}'`});return(0,f.tZ)(ie,{...n,children:r})})),K=(0,n.observer)((e=>{let{notification:t}=e;const{patient:i}=t._attr,n={title:i.patient_first_name+" "+i.patient_last_name,is_read:t.is_read,href:{workspace:i.patient_case+"/patients_communication"},time:t.time,user:{user_avatar:i.patient_photo,user_first_name:i.patient_first_name,user_last_name:i.patient_last_name,user_id:i.patient_id},pn_id:t.pn_id};return(0,f.tZ)(ie,{...n,children:(0,f.tZ)("span",{children:lng("replied to your message on the subject %s",i.patient_case_subject)})})})),Y=(0,n.observer)((e=>{let{notification:t}=e;const{data:i,user:n}=t._attr,r={title:"",is_read:t.is_read,href:Blsm.prm.Mainref+"#messages/in/"+i.message_id,time:t.time,user:n,pn_id:t.pn_id};let s;return n?(r.title=(0,p.v2)(n),s=`${lng("wrote you the message")} '${i.message_subject}'`):(r.title=lng("system message").caps(),s=i.message_subject),(0,f.tZ)(ie,{...r,children:s})})),Q=(0,n.observer)((e=>{let{notification:t}=e;const{object_id:i,data:n}=t._attr,r={title:lng("you have a following assignment").caps(),is_read:t.is_read,href:(0,d.p4)({launcher:"assignment",id:i,cuser:n.cuser,absolute:!0}),time:t.time,user:t.user,pn_id:t.pn_id},s=(0,f.BX)("span",{children:[lng("the assignment").caps(),' "',n.assignment_name,'" ',lng("is waiting for you following the completion of the assignment"),' "',n.original_assignment_name,'"']});return(0,f.tZ)(ie,{...r,children:s})})),ee=(0,n.observer)((e=>{let{notification:t}=e;const{data:i}=t._attr,n={title:t.task_title,is_read:t.is_read,href:{edit:"task",id:i.task_id,section:`c=${i.comment_id}`},time:t.time,user:t.user,pn_id:t.pn_id};let r=(0,f.BX)("span",{children:[(0,p.v2)(i)," ",(0,f.tZ)("span",{style:{color:s.g.colors.dominant_main,fontWeight:600},children:lng("mentioned")})," ",lng("you in a comment")]});return(0,f.tZ)(ie,{...n,children:r})})),te=(0,r.iv)(">div{padding:10px 20px;font-weight:500;cursor:pointer;font-size:.9em;display:flex;&.unread{background-color:",s.g.colors.bg_1,";font-weight:600;.activity-title{color:",s.g.colors.text_main,";}}&:hover{background-color:",s.g.colors.bg_2,";}}._avatar{",s.g.classes.margin_far("6px"),";}.activity-row1{display:flex;",s.g.mQuery.mobile,"{flex-direction:column;}}.activity-title{font-weight:600;color:",s.g.colors.text_main,";display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:calc(100vw - 65px);}.relative-date{font-style:italic;font-size:.9em;",s.g.classes.margin_near("5px"),";}",""),ie=(0,n.observer)((e=>{let{pn_id:t,href:i,is_read:n,user:r,title:s,status:a,time:p,children:u}=e;const m=(0,o.useContext)(_.l9);return(0,f.tZ)(d.A,{href:i,newTab:"string"==typeof i&&"#"!==i[0],css:te,onClick:()=>m.notificationsStore.markRead(t),children:(0,f.BX)("div",{className:n?"":"unread",children:[(0,f.tZ)("div",{children:r?(0,f.tZ)(l.qE,{className:"_avatar",size:"2.3em",rounded:!1,user:r,balloon:!1}):""}),(0,f.BX)("div",{children:[(0,f.BX)("div",{className:"activity-row1",children:[(0,f.tZ)(R.m,{elType:"span",className:"activity-title",children:s}),a&&a.task_resolution?(0,f.BX)("span",{className:"activity-status",children:[" ",(0,f.tZ)(c.gT,{color:(0,E.Pp)(a.task_resolution),size:".6em"})," ",(0,E.HR)(a.task_status,a.task_resolution).caps(!1)," ",(0,f.BX)("span",{className:"action-assignee",title:lng("assignee"),children:["(",a.assignee,")"]})]}):"",p?(0,f.tZ)(P.ij,{className:"relative-date",time:p}):""]}),(0,f.tZ)("div",{className:"activity-row2",children:u})]})]})})}));var ne=i(5940),re=i(5033),se=i(666),oe=i(9234),ae=i(8567),le=i(6059),ce=i(7787);const de=(0,r.iv)("position:fixed;z-index:",s.g.z.top_bar,";top:0;height:",s.g.consts.TOP_BAR_HEIGHT,"px;",s.g.classes.near(s.g.consts.SIDE_BAR_WIDTH+"px"),";width:calc(100vw - ",s.g.consts.SIDE_BAR_WIDTH+"px",");",s.g.mQuery.mobile,"{",s.g.classes.near("0"),";width:100vw;}",""),pe=(0,r.iv)("background-color:",s.g.colors.bg_main,";color:",s.g.colors.text_sec,";box-shadow:0 0 5px rgba(",s.g.darkMode?"255, 255, 255, 1":"0, 0, 0, .3",");display:flex;align-items:center;padding:0 1em;",""),ue=(0,r.iv)(".Icon-hierarchy{cursor:pointer;}._search{flex-grow:50;max-width:500px;}._padding{flex-grow:50;}._create_new{",s.g.classes.margin_far("10px"),";font-weight:600;.Button{>.Icon{",s.g.classes.margin_far("7px"),";",s.g.classes.margin_near("0"),";}}}.Icon-support{font-size:1.4rem;}.Icon{margin:0 3px;}._user{",s.g.classes.margin_near("8px"),";}.Icon-burger{font-size:1.2rem;}.Icon-qrcode_scan{font-size:27px;}",""),me=()=>(0,f.tZ)(z.SV,{css:de,children:(0,f.tZ)(ge,{})}),ge=(0,n.observer)((function(){var e,t;const i=(0,o.useContext)(_.l9),{user:n,hierarchy_button_show:r,sideMenuStore:s,searchStore:l}=i,[p,u]=(0,o.useState)(!1),g=[];Blsm.InitialData.support_auth_on&&g.push({href:Blsm.prm.Mainref+"redirect.php?target=jwt_blossom_support",label:lng("Blossom support center"),newTab:!0}),Blsm.canAccessModule("Manage")&&null!==(e=Blsm.InitialData.branding)&&void 0!==e&&e.manual&&g.push({href:Blsm.InitialData.branding.manual[1],label:Blsm.InitialData.branding.manual[0],newTab:!0}),null!==(t=Blsm.InitialData.branding)&&void 0!==t&&t.contact_link&&g.push({href:Blsm.InitialData.branding.contact_link,label:lng("contact & support").caps(!1),newTab:!0}),window.Branch.helpLinks(g);const h=[];return(0,se.Ob)()&&h.push({label:lng("content"),menu:(0,se.mG)()}),Blsm.canAccessModule("Elearning")&&h.push({label:lng("assignment"),menu:(0,re.iz)()}),(0,oe.j$)()&&h.push({label:lng("workspace"),menu:(0,oe.T0)()}),Blsm.InitialData.may_create_meetings&&h.push({label:lng("meeting"),onClick:()=>(u(!1),void(0,ae.cS)("",{title:lng("create meeting"),confirmText:lng("create"),inputType:"single_item",inputRequired:!0,inputOptions:{label:lng("select workspace").caps(),searchData:(e,t)=>(0,m.SC)("groups/autocomplete",{method:"POST",json:!0,data:{managed_perm:le.P.ManagerPermissions.CREATE_MEETINGS,term:e.term||""}},t),focusOnShow:!1},onConfirm:e=>(0,d.p4)({edit:"meeting",params:{ws:e}},!0)}))}),Blsm.InitialData.may_create_tasks&&h.push({label:lng("task"),onClick:()=>(u(!1),(0,ce.l)())}),(0,f.tZ)("div",{css:[de,pe,ue,"",""],className:"react_container",children:Blsm.user.id?(0,f.BX)(f.HY,{children:[(0,f.tZ)(c.JO,{icon:"burger",className:"mobile_only",onClick:()=>s.opened=!0}),r&&(0,f.tZ)(S.u,{text:lng("hierarchy")+"...",children:(0,f.tZ)(c.JO,{icon:"hierarchy",id:"react_bc_hierarchy_button",className:"mobile_off",onClick:e=>(e.stopPropagation(),Platform.MainView.hierarchy_view.$el.toggle())})}),l.searchCategories.length>0&&(0,f.tZ)("div",{className:"_search",children:(0,f.tZ)(N,{})}),(0,f.tZ)("div",{className:"_padding"}),h.length>0&&(0,f.tZ)("div",{className:"_create_new mobile_off",children:(0,f.tZ)(a.x,{options:h,trigger:p,onClose:()=>u(!1),behavior:"trigger",children:(0,f.BX)(v.l,{theme:"contained",onClick:()=>u(!0),children:[(0,f.tZ)(c.JO,{icon:"mark_plus"}),lng("create").caps()]})})}),g.length>0&&(0,f.tZ)("div",{children:g.length>1?(0,f.tZ)(a.x,{options:g,children:(0,f.tZ)(c.JO,{icon:"support",smallButtonLike:!0})}):(0,f.tZ)(S.u,{text:g[0].label.caps(),children:(0,f.tZ)(d.A,{href:g[0].href,newTab:!0,children:(0,f.tZ)(c.JO,{icon:"support",smallButtonLike:!0})})})}),(0,f.tZ)(q,{}),(0,f.tZ)(C,{className:"_user",user:n})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)("div",{className:"_padding"}),(0,f.BX)(ne.zx,{onClick:x,children:[(0,f.tZ)(c.JO,{icon:"qrcode"}),lng("go mobile").caps()]}),(0,f.BX)(ne.zx,{href:"login",children:[(0,f.tZ)(c.JO,{icon:"user"}),lng("login").caps()]})]})})}))},8162:(e,t,i)=>{i.d(t,{$:()=>z,d:()=>I});var n=i(7363),r=i(917),s=i(5560),o=i(8207),a=i(6920),l=i(1137),c=i(6975),d=i(5898),p=i(8318),u=i(9844),m=i(441),g=i(2808),h=i(4210),b=i(8567),v=i(5944);class _ extends h.I{constructor(e){super(e),this.confirmButtonLabel=lng("submit").caps();const{data:t={},group_id:i,user_id:n}=e;t.user_id=n,t.group_id=i,Object.assign(this._initialValues,t),this.title=t.receipt_id?lng("edit expense"):lng("new expense"),this.successMessage=lng("saved"),this.saveUrl="groups/save_external_course_receipt",this.buildFields(this._initialValues,e.limitAmount,e.excessAmount||0)}buildFields(e,t,i){this._fields=[{type:"hidden",name:"receipt_id"},{type:"hidden",name:"group_id"},{type:"hidden",name:"user_id"},{type:"text",name:"description",label:lng("description"),required:!0},{type:"text",name:"notes",label:lng("notes")},{type:"row_set",fields:[{type:"number",name:"amount",label:lng("amount|money"),symbol:(0,p.OM)().symbol,min:0,max:t+t*i/100,required:!0},{type:"component",node:(0,v.tZ)(z,{label:lng("maximum"),amount:t})}]}],(0,p.w6)(20).forEach((e=>this._fields.push({type:"file",name:`files[${e}]`,label:0===e?lng("attach a file"):void 0,visible:e?()=>!!this.values.get(`files[${e-1}]`):void 0,required:!e}))),this._prepFields(e),this.ready=!0}save(e){const t=Object.values(e.files||{}).length;(0,b.BB)((0,v.BX)(v.HY,{children:[(0,v.BX)("div",{children:[lng("amount|money").caps(),": ",(0,v.tZ)("b",{children:(0,p.vC)(e.amount)}),"."]}),(0,v.BX)("div",{children:[lng("description").caps(),": ",(0,v.tZ)("b",{children:e.description}),"."]}),(0,v.BX)("div",{children:[t?lng("%s attached files",t).caps():(0,v.tZ)("b",{children:lng("no attached files").caps()}),"."]}),(0,v.BX)("div",{children:[lng("your submission is final.").caps()," ",lng("are you sure you want to continue?").caps()]})]}),{title:lng("please confirm these details"),confirmText:lng("submit").caps(),onConfirm:()=>this.saveToUrl(this.saveUrl,e)})}}var f=i(8e3);const y=(0,r.iv)("position:absolute;background-color:#eee;top:0;left:0;opacity:0.8;width:100%;height:100%;text-align:center;.lds-ellipsis{display:inline-block;position:relative;width:64px;height:100%;}.lds-ellipsis div{position:absolute;top:40%;width:11px;height:11px;border-radius:50%;background:",a.g.colors.blossom,";animation-timing-function:cubic-bezier(0, 1, 1, 0);}.lds-ellipsis div:nth-child(1){left:6px;animation:lds-ellipsis1 0.6s infinite;}.lds-ellipsis div:nth-child(2){left:6px;animation:lds-ellipsis2 0.6s infinite;}.lds-ellipsis div:nth-child(3){left:26px;animation:lds-ellipsis2 0.6s infinite;}.lds-ellipsis div:nth-child(4){left:45px;animation:lds-ellipsis3 0.6s infinite;}@keyframes lds-ellipsis1{0%{transform:scale(0);}100%{transform:scale(1);}}@keyframes lds-ellipsis3{0%{transform:scale(1);}100%{transform:scale(0);}}@keyframes lds-ellipsis2{0%{transform:translate(0, 0);}100%{transform:translate(19px, 0);}}","");function w(){return(0,v.tZ)("div",{css:y,children:(0,v.BX)("div",{className:"lds-ellipsis",children:[(0,v.tZ)("div",{}),(0,v.tZ)("div",{}),(0,v.tZ)("div",{}),(0,v.tZ)("div",{})]})})}var x=i(8534),k=i(9180),Z=i(7154),C=i(5597),S=i(1092),O=i(7392),B=i(3205);i(7882);const T={name:"7djjp0",styles:".amounts{margin-bottom:10px;}.link_to_report{display:block;margin-top:10px;}"};var N={name:"1m8i2j7",styles:"overflow:auto;max-height:calc(100%)"};const I=(0,s.observer)((function(e){let{external:t,receipts:i,readOnly:r,onClose:s,approvalRequest:d,performApprovalAction:p,...u}=e;const g=(0,n.useRef)(null),{group_id:h,ect_options:b}=t,[y,k]=(0,n.useState)(null),[I,j]=(0,n.useState)(null),P=e=>parseFloat(e||0),[E,R]=(0,n.useState)("receipts"),F=[{val:"receipts",label:lng("receipts")}];return null!=d&&d.request_id&&F.push({val:"requestDetails",label:lng("request details")}),y||(0,f.SC)(`groups/excourse_details/${h}`,{},(e=>k(e))),(0,v.tZ)(l.d,{from:a.g.near,ref:g,scroll:!0,onClose:s,...u,children:(0,v.tZ)(o.W2,{head:(0,v.tZ)(o.$0,{icon:"receipt",title:`${lng("receipts")} - ${t.group_name}`,onClose:()=>g.current.close()}),stickyHead:!0,css:T,children:(0,v.BX)(v.HY,{children:[(0,v.tZ)("b",{children:t.ect_name}),y?(0,v.BX)(v.HY,{children:[F.length>1&&(0,v.tZ)(S.m,{tabs:F,onSelect:R,activeTab:E}),"requestDetails"!==E&&(0,v.BX)(v.HY,{children:[(0,v.BX)("div",{className:"amounts",children:[(0,v.tZ)(z,{amount:y.approved_funding,label:lng("total funding"),alwaysDisplay:!0}),(0,v.tZ)(z,{amount:y.amount_approved,label:lng("amount approved")}),(0,v.tZ)(z,{amount:P(y.amount_waiting),label:lng("amount waiting")}),(0,v.tZ)(z,{amount:y.amount_rejected,label:lng("amount rejected")}),(0,v.tZ)(z,{amount:P(y.approved_funding)-P(y.amount_approved)-P(y.amount_waiting),label:lng("available amount|expenses")})]}),!r&&(0,v.tZ)(Z.u,{text:(null==y?void 0:y.amount_spare)<=0?lng("cannot report more than the approved amount"):null,children:(0,v.BX)(O.l,{theme:"contained",disabled:(null==y?void 0:y.amount_spare)<=0,onClick:()=>{if((null==y?void 0:y.amount_spare)<=0)return(0,x.Mj)(lng("cannot report more than the approved amount"));j(I?null:new _({external:t,group_id:h,user_id:Blsm.user.id,initialData:{},limitAmount:Math.max(0,y.amount_spare),excessAmount:null==b?void 0:b.receipt_excess,onSaveSuccess:e=>{i.push(e),k(null),j(null)}}))},children:[(0,v.tZ)(c.JO,{icon:"mark_plus_light"})," ",lng("report an expense").caps()]})}),I&&(0,v.tZ)(B.l,{type:"inline",form:I,enableConfirmButton:!0,onClose:()=>j(null)}),(0,v.tZ)("div",{css:N,children:i.map((e=>(0,v.tZ)(D,{receipt:e,readOnly:r},e.receipt_id)))}),Blsm.canAccessModule("Reports")&&(0,v.tZ)(m.A,{className:"link_to_report",theme:"highlight",href:{report:"ReportExternalCourseExpenses",params:{user:Blsm.user.id,group:h}},children:lng("expenses status report").caps()})]}),"requestDetails"===E&&(0,v.tZ)(C.rl,{approvalRequest:d,performAction:p})]}):(0,v.tZ)(w,{})]})})})})),D=(0,s.observer)((function(e){let{receipt:t}=e;const i=(0,r.iv)("border-radius:",a.g.consts.FIELD_BORDER_RADIUS,"px;background:",t.highlight?a.g.colors.highlight:a.g.colors.background_dark,";border-color:",t.highlight?a.g.colors.dominant_orange:a.g.colors.border_dark,";border-style:solid;border-width:1px;padding:0 10px 10px 10px;margin-top:20px;width:calc(100% - 10px);._note{margin-top:calc(-.5em - 10px);}.inner{display:flex;flex-direction:row;gap:20px;.left{display:flex;flex-direction:column;min-width:calc(100% - 100px);}.right{width:100%;}.title{font-weight:bold;}.files{display:block;text-align:",a.g.far,";}}",""),{description:n,notes:s,amount:o,files:l,time:c}=t,m=(0,u.O)(t.status||null);return(0,v.BX)("div",{css:i,children:[(0,v.tZ)(d.jC,{color:m.color,children:m.title.caps()}),(0,v.BX)("div",{className:"inner",children:[(0,v.BX)("div",{className:"left",children:[(0,v.BX)("span",{className:"title",children:[(0,v.tZ)("div",{children:(0,p.vC)(o)}),(0,v.tZ)("div",{children:n||" "})]}),(0,v.tZ)("div",{children:s||" "}),(0,v.tZ)("div",{children:(0,v.tZ)(k.qp,{time:c,showTime:!1,showDate:!0})})]}),(0,v.tZ)("div",{className:"right",children:(0,v.tZ)("div",{className:"files",children:null==l?void 0:l.map((e=>(0,v.tZ)(j,{file:e},e.file_id)))})})]})]})})),j=(0,s.observer)((function(e){let{file:t}=e;const{file_name:i}=t,n=(0,r.iv)("._icon{font-size:","18px",";}","");return(0,v.tZ)(c.JO,{newTab:!0,href:{file:t},"data-preview":(0,g.BX)(i),css:n,icon:"attachment",className:"_icon",toolTip:i,buttonLike:!0})}));var P={name:"1gammwy",styles:"margin-top:5px"};const z=(0,s.observer)((function(e){let{amount:t,label:i,alwaysDisplay:n,toolTip:r}=e;if(!n&&!+t)return null;const s=(0,v.BX)("div",{css:P,children:[i.caps(),": ",(0,p.vC)(t)]});return r?(0,v.tZ)(Z.u,{text:r,children:s}):s}))},2620:(e,t,i)=>{i.d(t,{G:()=>B,a:()=>T});var n,r,s,o,a=i(7363),l=i(917),c=i(5560),d=(i(7882),i(8207)),p=i(6920),u=i(1137),m=i(6975),g=i(9180),h=i(441),b=i(8567),v=i(2808),_=i(5680),f=i(4210),y=i(7821),w=i(5007);function x(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Z(e,t,i,n,r){var s={};return Object.keys(n).forEach((function(e){s[e]=n[e]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(e,t,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(e,t,s),s=null),s}let C=(n=y.action.bound,r=class extends f.I{constructor(e){super(e),k(this,"file",void 0),k(this,"ext",void 0),k(this,"store",void 0),k(this,"userId",void 0),k(this,"updateFile",void 0),x(this,"runOnSuccess",s,this),x(this,"newFile",o,this),this.file=e.file,this.ext=e.ext,this.store=e.store,this.userId=e.userId,this.updateFile=e.updateFile,this.isNew=!!e.isNew,this.title=e.isNew?lng("upload file"):lng("edit file"),this.confirmButtonLabel=e.isNew?lng("upload").caps():lng("save").caps(),this.buildFields(e.file)}buildFields(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Blsm.user.isPowerManager||Blsm.hasPermission("users_admin"),i=[{val:"1",label:lng("available to user")},(t||Blsm.user.user_id!=this.userId)&&{val:"2",label:lng("available to user's direct manager")},t&&{val:"3",label:lng("available only to power manager and users admins only")}].filter((e=>!!e));this._fields=[this.isNew&&{type:"file",name:"file",disabled:!0,label:lng("file to upload")},{type:"text",name:"file_name",label:lng("name"),required:!0},{type:"tags",name:"tags",label:lng("tags"),objectType:"UserFile"},(t||Blsm.user.user_id!=this.userId)&&{type:"select",name:"file_availability",label:lng("availability"),options:i}],this.isNew?this._prepFields({file:e,file_name:e.name.slice(0,e.name.lastIndexOf(".")),file_availability:"1"}):this._prepFields({file_name:e.file_name.slice(0,e.file_name.lastIndexOf(".")),tags:e.tags,file_availability:e.file_availability}),this.ready=!0}save(e){const t={file_name:e.file_name+"."+this.ext,tags:e.tags||[],file_availability:e.file_availability||1};this.isNew?(this.runOnSuccess=e=>{let[t]=e;return this.store.files.unshift(t)},this.saveToUrl("file/user_file_upload",{user_id:this.userId,new_user_file:e.file,details:t})):(e.file_name+="."+this.ext,this.runOnSuccess=()=>this.updateFile(t),this.saveToUrl(`file/user_file_update=${this.file.file_id}`,{...t,user_id:this.userId}))}SaveSuccess(e){this.runOnSuccess(e),(0,w.vm)().closeDialog()}},s=Z(r.prototype,"runOnSuccess",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>!0}}),o=Z(r.prototype,"newFile",[y.observable],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z(r.prototype,"SaveSuccess",[n],Object.getOwnPropertyDescriptor(r.prototype,"SaveSuccess"),r.prototype),r);var S=i(5944);const O=(0,l.iv)("._children{>*{margin-top:1em;}}.new_file{margin-top:0;height:61px;border-width:2px;border-radius:7px;",p.g.classes.flex_center,";",p.g.classes.drop_button,";>.Icon{font-size:1.3rem;}>input{display:none;}}",""),B=(0,c.observer)((function(e){let{userStore:t}=e;const i=(0,a.useRef)(null),{userFiles:n,user_id:r}=t;return(0,S.tZ)(u.d,{from:"side",size:"300px",ref:i,onClose:()=>n.showFiles=!1,scroll:!0,children:(0,S.BX)(d.W2,{head:(0,S.tZ)(d.$0,{icon:"vendor_file",title:lng("files"),onClose:()=>i.current.close()}),stickyHead:!0,css:O,children:[n.canUploadFiles&&(0,S.BX)("label",{className:"new_file",children:[(0,S.tZ)(m.JO,{icon:"mark_plus_light"})," ",lng("add file").caps(),(0,S.tZ)("input",{type:"file",multiple:!1,onChange:e=>{return t=e.target.files[0],void(0,w.vm)().openDialog("form",new C({file:t,store:n,userId:r,ext:(0,v.BX)(t.name),isNew:!0}));var t}})]}),n.tags&&(0,S.tZ)(_.r$,{title:lng("relevant tags"),children:n.tags.map((e=>(0,S.tZ)(_.Vp,{tag:e,active:n.selectedTags.has(e),onClick:()=>n.toggleTagSelection(e)},e)))}),n.list.map((e=>(0,S.tZ)(N,{file:e,store:n,userId:r},e.file_id)))]})})})),T=(0,l.iv)(p.g.classes.font_reset,";color:",p.g.colors.text_sec,";border:1px solid ",p.g.colors.border,";border-radius:7px;padding:5px;._availability_note{font-size:12px;}.meta{display:flex;margin-bottom:3px;.Icon{font-size:1.4rem;color:",p.g.colors.text_main,";}.Icon-trash,.Icon-edit{font-size:.8rem;}.time{font-size:.8em;}}.name{font-weight:600;word-break:break-word;}",""),N=(0,c.observer)((function(e){let{file:t,store:i,userId:n}=e;const{org_file_name:r,file_id:s,file_name:o,creation_time:a,progress:l,file_availability:c}=t;let d;return d=2==c?lng("available to user's direct manager"):lng("available to user"),(0,S.BX)("div",{css:T,style:p.g.styles.progressBG(l),children:[(0,S.BX)("div",{className:"meta",children:[(0,S.tZ)(m.JO,{icon:(0,v.DW)(r,!0),toolTip:(0,v.BX)(r).toUpperCase()}),(0,S.tZ)("div",{css:p.g.classes.flex_grow}),void 0===l&&(0,S.BX)("div",{children:[(0,S.tZ)(g.qp,{time:a,showTime:!1,className:"time"})," ",i.canUploadFiles&&(0,S.BX)(S.HY,{children:[(0,S.tZ)(m.JO,{icon:"trash",toolTip:lng("delete file"),onClick:()=>{(0,b.BB)(lng("are you sure you want to delete this file?").caps(),{title:lng("delete file"),confirmText:lng("delete"),onConfirm:()=>i.deleteFile(t.file_id)})},smallButtonLike:!0})," ",(0,S.tZ)(m.JO,{icon:"edit",toolTip:lng("edit file"),onClick:()=>{(0,w.vm)().openDialog("form",new C({file:t,ext:(0,v.BX)(r),store:i,userId:n,updateFile:e=>i.updateFileData(t,e)}))},smallButtonLike:!0})]})]})]}),(0,S.tZ)(h.A,{theme:"highlight",href:{file:`type=user_file&id=${s}&prevent_download=1`},"data-preview":(0,v.BX)(o),toolTip:r,className:"name",children:o}),t.tags&&(0,S.tZ)(_.r$,{justify:!0,children:t.tags.map((e=>(0,S.tZ)(_.Vp,{tag:e,smaller:!0},e)))}),c<3&&!(1==c&&n==Blsm.user.user_id)&&(0,S.BX)("span",{className:"_availability_note",children:[(0,S.tZ)(m.JO,{icon:"preview"})," ",d.caps()]})]})}))},9844:(e,t,i)=>{i.d(t,{O:()=>k,V:()=>_});var n=i(676),r=i(7363),s=i(6920),o=i(5560),a=(i(7882),i(6975)),l=i(8207),c=i(9180),d=i(8318),p=i(6704),u=i(8162),m=i(8567),g=i(8e3),h=i(8534),b=i(5597),v=i(5944);const _=(0,o.observer)((function(e){let{userStore:t}=e;const{external:i,requests:n,manageGroups:r,user_id:s,removeUserExternalCourse:o}=t;return(0,v.BX)(v.HY,{children:[i.length>0&&(0,v.tZ)(f,{title:lng("external events"),collection:i,manageGroups:r,user_id:s,removeUserExternalCourse:o}),n.length>0&&(0,v.tZ)(w,{title:lng("user courses requests status"),collection:n,user_id:s})]})})),f=(0,o.observer)((function(e){let{title:t,collection:i,manageGroups:r,user_id:s,removeUserExternalCourse:o}=e;const a=i.some((e=>e.time_commitment)),c=i.some((e=>e.weekly_hours)),p=[lng("name"),lng("start date"),lng("end date"),lng("academic hours"),lng("days off"),lng("paid leave days"),lng("tuition"),lng("total required funding"),lng("diploma"),a&&lng("time commitment"),c&&lng("weekly hours"),((0,d.Tz)(s)||r)&&lng("actions")];return(0,v.BX)(v.HY,{children:[t&&(0,v.tZ)(l.uD,{children:t.caps()}),(0,v.tZ)(n.iA,{cols:p,rowIdCol:"group_id",collection:i,RowRenderer:y,compact:!0,noWindow:!0,mobileSupport:!0,rowProps:{hasTimeCommitment:a,hasWeeklyHours:c,manageGroups:r,user_id:s,removeUserExternalCourse:o}})]})})),y=(0,o.observer)((function(e){let{row:t,rowProps:i}=e;const{hasTimeCommitment:s,hasWeeklyHours:o,manageGroups:l,user_id:m,removeUserExternalCourse:g}=i,{type:h,group_id:_,group_name:f,group_open_date:y,group_close_date:w,target_data:x,diploma_file:k,time_commitment:Z,weekly_hours:C,request_id:S,ect_id:O}=t,B=x||{},[T,N]=(0,r.useState)(null),[I,D]=(0,r.useState)(null),j=[{type:"main",_:f},y||B.group_open_date?{_:(0,v.tZ)(c.qp,{time:y||B.group_open_date})}:"",w||B.group_close_date?{_:(0,v.tZ)(c.qp,{time:w||B.group_close_date})}:"",(0,b._9)("hours",B),(0,b._9)("days_off",B),(0,b._9)("paid_leave",B),(0,b._9)("price",B),(0,b._9)("funding",B),{type:"icons",_:k&&(0,v.tZ)(a.JO,{icon:"diploma",toolTip:lng("download diploma"),href:{file:k}})},s&&{_:Z&&(0,v.BX)(v.HY,{children:[Z," ",((0,d.P$)(Z)?lng("month"):lng("months")).caps()]})},o&&C,((0,d.Tz)(m)||l)&&{type:"icons",_:(0,v.BX)(v.HY,{children:[(0,v.tZ)(a.JO,{icon:"edit",toolTip:lng("details").caps(),onClick:()=>N(!0),smallButtonLike:!0}),l&&(0,v.tZ)(a.JO,{icon:"trash",toolTip:lng("remove external event").caps(),onClick:()=>g(t),smallButtonLike:!0}),T&&(0,v.tZ)(p.G,{request_id:S,group_id:_,ect_id:O,readOnly:!0,onClose:()=>N(!1),approvalRequest:t}),I&&(0,v.tZ)(u.d,{external:t,receipts:t.receipts,readOnly:!(0,d.Tz)(m),onClose:()=>D(!1)}),t.ect_receipt_sequence&&(0,v.tZ)(a.JO,{icon:"receipt",toolTip:lng("expenses").caps(),onClick:()=>D(!I),smallButtonLike:!0}),"RegExtMgr"===h&&(0,v.tZ)(a.JO,{icon:"manager",toolTip:lng("manager registration").caps()})]})}];return(0,v.tZ)(n.lF,{tds:j})})),w=(0,o.observer)((function(e){let{title:t,collection:i,user_id:r}=e;const s=[lng("name"),lng("external event"),lng("request date"),lng("decision date"),lng("status"),lng("description")];return Blsm.user.isPowerManager&&s.push(lng("actions")),(0,v.BX)(v.HY,{children:[t&&(0,v.tZ)(l.uD,{children:t.caps()}),(0,v.tZ)(n.iA,{cols:s,rowIdCol:"request_id",collection:i,RowRenderer:x,rowProps:{user_id:r},compact:!0,noWindow:!0,mobileSupport:!0,whiteSpace:"normal"})]})})),x=(0,o.observer)((function(e){let{row:t,rowProps:i}=e;const{status:s,approver_name:o,approval_step:l,sequence_length:d,group_id:u,group_name:b,target_data:_,request_date:f,decision_date:y,step_status:w,ect_name:x,request_id:Z,origin_ect_name:C,origin_ext_course_name:S,type:O}=t,[B,T]=(0,r.useState)(null),{user_id:N}=i,I=k(s),D=s?"":o+" - "+lng("step %s of %s",l,d).caps(),j=[{type:"main",_:(b||(null==_?void 0:_.ext_course_name))+(S?` (${S})`:"")},{_:(0,v.BX)(v.HY,{children:[x," ","RegExtMgr"===O&&(0,v.tZ)(a.JO,{icon:"manager"})," ",C&&` (${C})`]})},{_:(0,v.tZ)(c.qp,{time:f})},{_:(0,v.tZ)(c.qp,{time:y})},{_:(0,v.BX)(v.HY,{children:[(0,v.tZ)(a.JO,{icon:I.icon,color:I.color})," ",I.title," ",D&&(0,v.tZ)(a.An,{})," ",D," "]})},w||(0,v.tZ)("td",{})];return Blsm.user.isPowerManager&&j.push({_:(0,v.BX)(v.HY,{children:[(0,v.tZ)(a.JO,{icon:"trash",onClick:()=>(0,m.BB)((0,v.BX)(v.HY,{children:[lng("are you sure you want to delete this request?").caps(),(0,v.tZ)("br",{}),lng("this action cannot be undone").caps(),"."]}),{confirmText:lng("delete"),onConfirm:()=>(0,g.SC)("approval/delete_approval_requests",{method:"DELETE",data:{id:Z}},(()=>(0,h.qV)(lng("operation completed successfully!")+" "+lng("refresh to update.").caps())))})}),["RegExt","RegExtMgr"].includes(O)&&(0,v.tZ)(a.JO,{icon:"edit",toolTip:lng("edit external event").caps(),onClick:()=>T(!0),smallButtonLike:!0}),B&&(0,v.tZ)(p.G,{approvalRequest:t,request_id:Z,group_id:u,user_id:N,ect_id:null==_?void 0:_.ect_id,onClose:()=>T(!1)})]})}),(0,v.tZ)(n.lF,{tds:j})})),k=e=>{let t,i,n,r;switch(e){case"approved":t="like",i=lng("approved").caps(),n=lng("approve").caps(),r=s.g.colors.positive;break;case"rejected":t="dislike",i=lng("rejected").caps(),n=lng("reject").caps(),r=s.g.colors.negative;break;case"canceled":case"back":t="mark_x",i=lng("canceled by user").caps(),n=lng("cancel").caps(),r=s.g.colors.text_black;break;case"waiting_list":t="waiting_list",i=lng("waiting list").caps(),n=lng("add to waiting list").caps(),r=s.g.colors.chart.progress;break;case null:t="manager",i=lng("waiting for approval").caps(),r=s.g.colors.chart.progress}return{icon:t,title:i,color:r,action:n}}},4765:(e,t,i)=>{i.d(t,{Q:()=>O});var n=i(917),r=i(6920),s=i(5007),o=i(5560),a=i(7363),l=i(5405),c=i(3550),d=i(8318),p=i(6975),u=i(5898),m=i(5680),g=i(9159),h=i(3051),b=i(5033),v=i(441),_=i(2755),f=i(9180),y=i(1858),w=i(8152),x=(i(7882),i(5104)),k=i(3634),Z=i(5944);const C=(0,n.iv)("margin:3px 0;height:70px;.padding{flex-direction:column;.main,.meta{display:flex;align-items:center;place-items:center;width:100%;max-width:none;flex-basis:auto;}.meta{justify-content:end;}.item-kind{width:28px;font-size:18px;text-align:center;}.item-name{font-size:1em;padding:0 3px;flex-basis:auto;",r.g.classes.ellipsis_lines(2),";}.actions{width:auto;}.item-type-title,.item-menu{display:none;}.meta>*{min-width:0;width:auto;font-size:.8em;}}",""),S=e=>{let{type:t}=e;return(0,n.iv)("border:1px solid ",r.g.colors.separator,";border-radius:6px;margin:10px 0;height:60px;background-color:",r.g.colors.bg_cont,";position:relative;overflow:hidden;display:flex;align-items:center;box-shadow:rgb(0 0 0 / 5%) 1.95px 1.95px 2.6px;.padding{padding:10px;display:flex;align-items:center;width:100%;}.main,.meta{display:flex;align-items:center;}&:not(:first-of-type){margin-top:10px;}.main{flex-grow:1;",r.g.classes.margin_far("10px"),";.item-kind{width:37px;font-size:22px;color:",r.g.colors.entity[t]||r.g.colors.text_main,";}.item-name{font-weight:600;font-size:1.1em;align-self:center;}}.meta{display:flex;width:53%;min-width:53%;gap:5px;.item-date{text-align:center;display:flex;justify-content:space-between;width:180px;}.item-type-title{flex-grow:1;white-space:nowrap;display:flex;justify-content:flex-end;gap:6px;padding:0 5px;}.item-status{min-width:80px;>div{display:inline-block;}}.actions{display:flex;align-items:center;gap:2px;justify-content:flex-end;.invisible{visibility:hidden;display:flex;align-items:center;}}}&:hover{border:1px solid ",r.g.colors.entity[t],";}&:hover,&.item-selected{.meta .actions .invisible{visibility:visible;}}&.narrow{",C,";}",r.g.mQuery.mobileNarrow,"{",C,";}","")},O=e=>(0,Z.tZ)(l.SV,{children:(0,Z.tZ)(B,{...e})}),B=(0,o.observer)((function(e){var t,i,n,o,l;let{item:_,onClick:C,narrow:O,assignee:B,actions:D={action:!0,menu:!0,select:!0}}=e;const j=(0,a.useContext)(c.y),P=(0,a.useContext)(x.M),{id:z,dateNote:E,cardNote:R,status:F,link:M,customIcons:A,title:q,displayWorkspace:X,workspace:L,type:$,category:V,category_id:U,notice:H,selected:J}=_,G=(null==L?void 0:L.group_name)||_.attr("group_name"),W=(null===(t=_.workspace)||void 0===t||null===(i=t.mayChangeComponents)||void 0===i?void 0:i.call(t,_.type))&&!_._attr.condition_component,K=(0,d.g4)(_.menu,_),Y=_.hide_type?null:_.type_title,Q=_.onClick?()=>_.onClick(_):C?()=>C(_):null,ee=O?{ceiling:15,floor:5}:{},te=Blsm.isFeatureEnabled("rating_tool")&&(null==L?void 0:L.rating)&&"meeting"===_.type&&moment().isSameOrAfter(_.end_time)&&"1"===_._attr.completed;return(0,Z.tZ)("div",{css:S({type:$}),className:(0,d.AK)({"item-selected":_.selected,narrow:O}),onClick:Q,children:(0,Z.BX)("div",{className:"padding",children:[(0,Z.BX)("div",{className:"main",children:[(0,Z.tZ)("div",{className:"item-kind",children:(0,Z.tZ)(p.JO,{icon:_.icon,toolTip:_.iconTooltip})}),q&&(0,Z.BX)("div",{className:"item-name",children:[_._attr.condition_component&&(0,Z.BX)(Z.HY,{children:[(0,Z.tZ)(p.JO,{icon:"tree",color:r.g.colors.dominant_main,toolTip:`${lng("from")}: ${_._attr.origin_group_name}`})," "]}),(0,Z.tZ)(y.u,{text:q+(X&&G?` (${G})`:""),...ee})]})]}),(0,Z.BX)("div",{className:"meta",children:[(0,Z.tZ)("div",{className:"item-date",children:null!=R&&R.text?(0,Z.tZ)(u.jC,{...R,className:"mainNote"}):(0,Z.tZ)(f.qm,{dateNote:E})}),(0,Z.BX)("div",{className:"item-type-title",children:[Y&&(0,Z.tZ)("span",{css:_._attr.group_type?r.g.classes.ws_type_style:r.g.classes.content_type_style,children:Y.caps()}),V&&(0,Z.tZ)(w.W,{category:V,category_id:U})]}),(0,Z.tZ)("div",{className:"item-status",children:(null==F?void 0:F.text)&&(0,Z.tZ)(m.Vp,{tag:F.text,color:null==F?void 0:F.color,tooltip:null==F?void 0:F.tooltip})}),(0,Z.BX)("div",{className:"actions",children:[W&&j&&(0,Z.tZ)("span",{className:"invisible mobile_off",...j.attributes,...j.listeners,children:(0,Z.tZ)(p.JO,{icon:"move"})}),D.action&&(0,Z.BX)("div",{className:"item-action",children:[M?(0,Z.tZ)(T,{item:_,assignee:B}):H?(0,Z.tZ)(N,{message:H}):A?null:(0,Z.tZ)(I,{}),A]}),P&&((null===(n=_.workspace)||void 0===n||null===(o=n.mayEditMeetings)||void 0===o?void 0:o.call(n))||(null===(l=_.mayEditMeetings)||void 0===l?void 0:l.call(_)))&&(0,Z.tZ)(p.JO,{icon:"edit",onClick:e=>{var t;return e.stopPropagation(),"meeting"===$?(0,v.p4)({edit:"meeting",id:z},!0):null===(t=_.workspace)||void 0===t?void 0:t.openEventForm(_)}}),te&&(0,Z.tZ)(p.JO,{icon:"bookmark_half",buttonLike:!0,onClick:e=>(e=>{e.stopPropagation(),(0,s.vm)().openDialog("Component",{child:(0,Z.tZ)(k.S,{ws:L,options:{type:"meeting",objectId:z}}),padded:!1,width:"1200px"})})(e)}),D.menu&&K&&K.length>0&&(0,Z.tZ)("div",{className:"item-menu",onClick:e=>e.stopPropagation(),children:(0,Z.tZ)(h.x,{className:"item-menu",options:K,onSelect:e=>(0,b.Xq)(e,_),children:(0,Z.tZ)(p.JO,{icon:"menu_h",smallButtonLike:!0})})}),D.select&&W&&(0,Z.tZ)("div",{className:"invisible mobile_off",children:(0,Z.tZ)(g.XZ,{className:J?"item-cb-selected":"item-cb",value:J,onChange:e=>_.select(e)})})]})]})]})})})),T=e=>{var t;let{item:i,assignee:n}=e;if(!1===(null===(t=i.canPlay)||void 0===t?void 0:t.call(i)))return(0,Z.tZ)(I,{});const s="workspace"===i.type?"enter":"play",o="workspace"===i.type?i.color:r.g.colors.positive,a=Object.assign({},i.link);return(0,d.B5)(n)&&(a.params=[],a.params.assignee=n),(0,Z.tZ)(v.A,{href:a,processHrefClick:!0,stopPropagation:!0,newTab:i.newTab,children:(0,Z.tZ)(_.ZT,{icon:s,toolTip:i.linkToolTip,color:o,bgColor:o+"1A",size:24})})},N=e=>{let{message:t}=e;return(0,Z.tZ)(_.ZT,{icon:"lock",toolTip:t,color:r.g.colors.negative,bgColor:r.g.colors.negative+"1A",size:24})},I=()=>(0,Z.tZ)("div",{style:{height:"24px",width:"24px"}})},8337:(e,t,i)=>{i.d(t,{Eq:()=>Z,Tt:()=>C});var n=i(7363),r=i(8e3),s=i(539),o=i(2334),a=i(2883),l=i(9483),c=i(6975),d=i(676),p=i(917),u=i(6920),m=(i(7882),i(8116)),g=i(5560),h=i(8973),b=i(8318),v=i(81),_=i(7392),f=i(5007),y=i(5944);const w=e=>{var t;let{group_id:i,printMode:g}=e;const[h,_]=(0,n.useState)(null);if((0,n.useEffect)((()=>{g&&h&&setTimeout((()=>window.print()),1e3)}),[h]),(0,v.iP)(),h||(0,r.SC)("groups/group_summary",{data:{group_id:i}},(e=>_(e))),!h)return(0,y.tZ)(s.$,{css:(0,p.iv)("margin-top:",g?"50px":"0",";","")});const{group_image:f,group_name:w,group_description:x,group_open_date:Z,group_close_date:C,group_location:S,group_audience:O,required_assignments_completion:B,required_meetings_attendance:T,custom_fields_data:N,sum_meetings_duration:I}=h,D=null===(t=h.meetings)||void 0===t?void 0:t.map((e=>new m.Ag(e))),{audience:j,custom_fields:P,meetings_list:z,passing_grade:E,percentage:R,sum_hours:F}=JSON.parse(null==h?void 0:h.summary_data),M=(0,o.k6)((0,o._3)(Z),{date:!0,time:!1}),A=(0,o.k6)((0,o._3)(C),{date:!0,time:!1}),q=A&&A!==M,X=!!(M||F&&I||j&&O||S),L=!!(E&&h.passing_grade||R&&(B||T)),$=!(!P||!N),V=!!(z&&D.length>0),U=!!(X||L||$),H=[{title:lng("meeting name").caps()},{title:lng("date").caps()},{title:lng("time").caps()},{title:lng("location").caps()},{title:lng("instructors").caps()}],J=!!P&&Object.values(N).filter((e=>h[e.field_column])).map((e=>[e.field_name,"checkbox"===e.field_type.toLowerCase()?{icon:h[e.field_column]?"mark_v":"mark_x"}:h[e.field_column],"varchar"===e.field_type.toLowerCase()?"text":e.field_type.toLowerCase()]));return(0,y.BX)("div",{css:(G=f,(0,p.iv)("position:relative;background-color:",u.g.colors.bg_page_containers,";>.summary{display:flex;justify-content:space-between;flex-direction:",(0,b.tq)()?"column":"row-reverse",";>.summary-header{display:flex;margin:-50px auto 0;flex-direction:column;max-width:",(0,b.tq)()?"95%":"70%",";align-items:flex-end;>.image{background-image:url(",u.g.func.imgUrl(G),");color-adjust:exact!important;width:165px;height:165px;justify-content:flex-end;background-position:center;background-size:cover;background-repeat:no-repeat;z-index:1;border-radius:20px;margin:0 auto;}>.group-name{font-weight:bold;font-size:1.4rem;margin:0 auto;}>.group-desc{margin:0 auto;}}>.summary-content{padding:10px;border-radius:20px;margin:10px;background-color:",u.g.colors.bg_cont,";",u.g.classes.margin_near("10px"),";.mini-section{margin-bottom:10px;padding-bottom:10px;.mini-section-header{font-size:1.2em;font-weight:600;margin-bottom:5px;}}.mini-section:not(:last-child){border-bottom:1px solid ",u.g.colors.separator_light,";}>div{margin:10px 0;}}}.Icon{color:",u.g.colors.dominant_main,";font-size:1.6em;margin:0 5px;width:30px;text-align:center;}>.meetings{padding:10px;background-color:",u.g.colors.bg_cont,";margin:10px;border-radius:20px;>.meetings-header{font-size:1.2em;font-weight:600;}>div{margin:10px 0;}}","")),children:[(0,y.tZ)(a.Fz,{}),(0,y.BX)("div",{className:"summary",children:[(0,y.BX)("div",{className:"summary-header",children:[(0,y.tZ)("div",{className:"image"}),(0,y.tZ)("div",{className:"group-name",children:w}),x&&(0,y.tZ)(l.m,{className:"group-desc",keepAlign:!0,dangerouslySetInnerHTML:{__html:x.nl2br()}})]}),U&&(0,y.BX)("div",{className:"summary-content",children:[X&&(0,y.BX)("div",{className:"mini-section",children:[(0,y.tZ)("div",{className:"mini-section-header",children:lng("general").caps()}),M&&(0,y.BX)("div",{children:[(0,y.tZ)(c.JO,{icon:"calendar",toolTip:lng("activity dates")})," ",M&&M," ",q&&" - "," ",q&&A]}),F&&I&&(0,y.BX)("div",{children:[(0,y.tZ)(c.JO,{icon:"sand_clock",toolTip:lng("duration")})," ",`${I} ${I>1?lng("hours"):lng("hour")}`]}),S&&(0,y.BX)("div",{children:[(0,y.tZ)(c.JO,{icon:"pointer_alt",toolTip:lng("location")})," ",S]}),j&&O&&(0,y.BX)("div",{children:[(0,y.tZ)(c.JO,{icon:"users",toolTip:lng("audience")})," ",O]})]}),L&&(0,y.BX)("div",{className:"mini-section",children:[(0,y.tZ)("div",{className:"mini-section-header",children:lng("completion conditions").caps()}),E&&h.passing_grade&&(0,y.BX)("div",{children:[lng("passing score").caps()+":"," ",h.passing_grade]}),R&&B&&(0,y.BX)("div",{children:[`${lng("required assignments completion").caps()}: ${B}`,"%"]}),R&&T&&(0,y.BX)("div",{children:[`${lng("required meetings attendance").caps()}: ${T}`,"%"]})]}),$&&(0,y.BX)("div",{className:"mini-section",children:[(0,y.tZ)("div",{className:"mini-section-header",children:lng("additional fields").caps()}),(0,y.tZ)(d.VD,{pairs:J})]})]})]}),V&&(0,y.BX)("div",{className:"meetings",children:[(0,y.tZ)("div",{className:"meetings-header",children:lng("meetings").caps()}),(0,y.tZ)(d.iA,{cols:H,collection:D,RowRenderer:k,rowIdCol:"id"})]})]});var G},x={name:"rcuu3s",styles:"span{font-weight:600;}"},k=e=>{let{row:t}=e;const{id:i,instructorNames:n,start_date:r,start_time:s,end_time:a,locations:l,title:c}=t;return(0,y.BX)("tr",{css:x,children:[(0,y.tZ)("td",{children:c.caps()}),(0,y.tZ)("td",{children:(0,o.k6)(r,{time:!1})}),(0,y.BX)("td",{children:[(0,o.k6)(s,{date:!1})," - ",(0,o.k6)(a,{date:!1})]}),(0,y.tZ)("td",{children:null==l?void 0:l.map((e=>{const{label:t,value:i}=e;return(0,y.BX)("div",{children:[(0,y.BX)("span",{children:[t,":"]})," ",i]},t)}))}),(0,y.tZ)("td",{children:n||""})]},i)},Z=(0,g.observer)((function(e){let{group_id:t}=e;return(0,y.BX)(y.HY,{children:[(0,y.tZ)(h.Y,{bgColor:"#fff"}),(0,y.tZ)(w,{group_id:t,printMode:!0})]})})),C=e=>{let{groupId:t,bold:i,className:n}=e;return(0,y.tZ)(_.l,{onClick:()=>(e=>(0,f.vm)().openDialog("Component",{child:(0,y.tZ)(w,{group_id:e}),width:(0,b.tq)()?"100%":"65%",padded:!1,title:lng("meetings and more details"),headExtra:(0,y.tZ)(c.JO,{icon:"print",onClick:()=>window.open(Blsm.prm.Mainref+"group_summary?gid="+e)})}))(t),className:n,bold:i,theme:"outlined",children:lng("meetings and more details").caps()})}},5104:(e,t,i)=>{i.d(t,{D:()=>v,M:()=>h});var n=i(917),r=i(5560),s=i(81),o=i(5007),a=i(6920),l=i(8411),c=i(4765),d=i(6975),p=i(7363),u=i(2334),m=i(5944);const g={name:"pss8dm",styles:"display:flex;.components{flex-grow:1;overflow:auto;min-height:550px;}"},h=(0,p.createContext)(null);var b={name:"13z6iip",styles:"font-size:1.5em"};const v=(0,r.observer)((function(e){let{ws:t}=e;const i=t.scheduleItems.length>0,{filtersVals:n,setFilterVals:r,sort:a,setSort:v}=(0,s.qD)(t.schedule_filterNsort),{filters:_,sorts:y}=t.tabFiltersSorts,{scheduleItems:w}=t,x=(0,p.useMemo)((()=>{const e=[],t=[];for(let i of w)"dayNumber"===i.type?(0,u._3)(i.date).isAfter()||(0,u.zk)((0,u._3)(i.date))?t.push(i):e.push(i):i.start_time.isAfter()||(0,u.zk)(i.start_time)?t.push(i):e.push(i);return[...t,...e]}),[w]);w.forEach((e=>{var t;const i=[];null!==(t=e.zoomRecordings)&&void 0!==t&&t.length&&i.push({icon:"zoom_meeting",toolTip:lng("zoom recordings")}),e.warnings&&i.push({icon:"warning_triangle",toolTip:e.warnings}),i.length&&(e.customIcons=(0,m.tZ)(m.HY,{children:i.map(((e,t)=>(0,m.tZ)(d.JO,{...e,css:b},t)))}))}));const k="sortTime"===a.by?x:w;return(0,m.tZ)("div",{css:g,children:(0,m.BX)("div",{className:"components",children:[(0,m.tZ)(l.CX,{actions:t.MeetingActions(),filters:_,filtersVals:n,onFilter:r,sorts:i?y:[],sort:a,onSort:v,alwaysShow:!0,checkAll:t.mayChangeComponents()&&{checked:t.isVisibleChecked,onCheck:e=>t.checkVisible(e)}}),(0,m.tZ)(h.Provider,{value:!0,children:k.map((e=>"dayNumber"!==e.type?(0,m.tZ)(c.Q,{item:e,onClick:()=>(0,o.vm)().showSideDrawer(e)},e.type+"_"+(e.assignment_id||e.id)):(0,m.tZ)(f,{...e},e.day)))})]})})})),_=(0,n.iv)("border-radius:7px;background-color:",a.g.colors.background_dark,";text-align:center;font-weight:600;font-size:1.1em;padding:10px;",""),f=e=>{let{day:t,date:i}=e;return(0,m.BX)("div",{css:_,children:[i," ",lng("day").caps()," #",t]})}},8432:(e,t,i)=>{i.d(t,{Yy:()=>$,bP:()=>M,bp:()=>y,iR:()=>N,ns:()=>V,p8:()=>O});var n=i(917),r=i(6920),s=i(7363),o=i(8207),a=i(7154),l=i(4902),c=i(8318),d=i(7392),p=i(1619),u=i(443),m=i(5311),g=i(6975),h=i(2205),b=(i(421),i(81)),v=i(8337),_=i(5944);const f=(0,n.iv)("width:370px;",r.g.classes.margin_far("1em"),";color:",r.g.colors.text_main,";.container-children{display:flex;flex-direction:column;justify-content:space-between;height:100%;}._status{color:",r.g.colors.negative,";text-align:center;margin-top:10px;}._details{display:flex;flex-direction:column;justify-content:space-between;}._users{margin-top:5px;}._manager{margin-top:10px;border-top:1px solid ",r.g.colors.separator,";padding-top:8px;}",""),y=e=>{let{ws:t}=e;return(0,_.BX)(o.W2,{css:f,children:[(0,_.tZ)(O,{ws:t}),(0,_.tZ)("div",{className:"_status",children:t.warnings.map((e=>(0,_.tZ)("div",{children:e.caps()},e)))}),(0,_.BX)("div",{className:"_details",children:[(0,_.tZ)(D,{ws:t}),(0,_.BX)("div",{children:[(0,_.tZ)(q,{ws:t}),(0,_.tZ)(L,{ws:t})]})]})]})},w={name:"1nlm8k2",styles:"width:240px;height:240px;margin:0 auto 25px;background-color:#e4e4e4;background-size:cover;background-position:center;border-radius:10px"},x=e=>{let{patient:t,onClose:i}=e;const n=[[lng("name").caps(),t.patient_first_name+" "+t.patient_last_name],[lng("phone").caps(),(0,_.tZ)(C,{phone:t.patient_phone},"phone")],[lng("email").caps(),(0,_.tZ)(S,{email:t.patient_email},"email")],[lng("identity number").caps(),t.patient_identity_number],[lng("birthdate").caps(),t.patient_birthdate]];return(0,_.BX)(o.T,{title:lng("patient info").caps(),onClose:i,children:[(0,_.tZ)("div",{css:w,style:{backgroundImage:`url("${t.patient_photo}")`}}),(0,_.tZ)(Z,{data:n})]})},k=(0,n.iv)("margin:0 150px;>div{display:flex;justify-content:space-between;margin-bottom:10px;div:last-of-type{font-weight:600;}}",r.g.mQuery.max(640),"{margin:0 10px;}",""),Z=e=>{let{data:t}=e;return(0,_.tZ)("div",{css:k,children:t.map(((e,t)=>(0,_.BX)("div",{children:[(0,_.tZ)("div",{children:e[0]}),(0,_.tZ)("div",{children:e[1]})]},t)))})},C=e=>{let{phone:t}=e;return(0,_.tZ)("a",{href:`tel:${t}`,children:t})},S=e=>{let{email:t}=e;return(0,_.tZ)("a",{href:`mailto:${t}`,children:t})},O=e=>{let{ws:t}=e;const i=t.status?"draft"===t.status?lng("draft"):lng("approval waiting"):void 0;return(0,_.tZ)(h.d,{title:t.group_name,poster:t.group_image,status:i,entity:t})},B=(0,n.iv)("width:100%;",r.g.classes.margin_far("1em"),";color:",r.g.colors.text_main,";._poster-outline{border-radius:20px;height:164px;width:164px;margin:-102px auto 0;box-shadow:0 2px 6px rgba(0, 0, 0, 0.5);overflow:hidden;._poster{height:164px;width:164px;background-color:",r.g.colors.bg_1,";background-size:cover;background-position:center;}}._status{color:",r.g.colors.negative,";text-align:center;margin-top:10px;}.widget-header{width:calc(100% - 200px);}._top{justify-content:space-between;align-items:flex-start;margin-bottom:10px;}._users{",r.g.classes.margin_far("30px"),";}._desc{min-width:300px;max-width:300px;",r.g.classes.margin_far("30px"),";}",""),T=(0,n.iv)("width:100%;color:",r.g.colors.text_main,";._all{flex-direction:column;gap:15px 0;.widget-header{margin-bottom:0;}}",""),N=e=>{let{ws:t}=e;const i=(0,_.tZ)(m.c_,{children:t.patient&&(0,_.tZ)(R,{patient:t.patient})});return(0,b.iP)(),(0,c.tq)()?(0,_.tZ)(o.W2,{css:T,children:(0,_.BX)(m.c_,{className:"_all",children:[(0,_.tZ)(O,{ws:t}),(0,_.BX)(u.B,{icons:t.headerActions(),content:i,children:[(0,_.tZ)($,{ws:t}),(0,_.tZ)(V,{ws:t})]}),t.group_description&&(0,_.tZ)(P,{desc:t.group_description}),(0,_.BX)("div",{style:{textAlign:"center"},children:[t.classification_name&&(0,_.tZ)(E,{name:t.classification_name}),(0,_.tZ)(M,{ws:t})]}),(0,_.tZ)(q,{ws:t}),(0,_.tZ)(L,{ws:t})]})}):(0,_.BX)(o.W2,{css:B,children:[(0,_.BX)(m.c_,{className:"_top",children:[(0,_.tZ)(O,{ws:t}),(0,_.BX)(u.B,{icons:t.headerActions(),content:i,children:[(0,_.tZ)($,{ws:t}),(0,_.tZ)(V,{ws:t})]})]}),(0,_.BX)(m.c_,{children:[(0,_.tZ)(P,{desc:t.group_description}),(0,_.BX)("div",{style:{textAlign:"center"},children:[t.classification_name&&(0,_.tZ)(E,{name:t.classification_name}),(0,_.tZ)(M,{ws:t})]}),(0,_.tZ)(m.zh,{}),(0,_.tZ)(q,{ws:t}),(0,_.tZ)(L,{ws:t})]})]})},I={name:"10etijs",styles:"._syllabus{margin-top:6px;}._classification{margin-top:6px;}._patient{margin-top:5px;}"},D=e=>{let{ws:t}=e;const{patient:i,group_description:n,classification_name:r}=t;return(0,_.BX)("div",{css:I,className:"_metadata",children:[(0,_.tZ)(P,{desc:n}),i&&(0,_.tZ)(R,{patient:i}),(0,_.tZ)(m.zh,{}),(0,_.BX)("div",{style:{textAlign:"center"},children:[(0,_.tZ)(M,{ws:t}),r&&(0,_.tZ)(E,{name:r})]})]})};var j={name:"1azakc",styles:"text-align:center"};const P=e=>{let{desc:t}=e;return(0,_.tZ)("div",{css:j,children:(0,_.tZ)(a.u,{html:null==t?void 0:t.nl2br(),children:(0,_.tZ)(p.xn,{className:"_desc",content:t,css:r.g.classes.descriptionShowMore})})})},z={name:"yvzwtf",styles:"&._classification{font-size:1.1em;font-weight:600;}"},E=e=>{let{name:t}=e;return(0,_.BX)("div",{css:z,className:"_classification",children:[(0,_.tZ)(g.An,{})," ",(0,_.tZ)(a.u,{text:lng("classification"),children:t})," ",(0,_.tZ)(g.An,{})]})},R=e=>{let{patient:t}=e;const[i,n]=(0,s.useState)(!1);return(0,_.BX)("div",{className:"_patient",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i&&(0,_.tZ)(x,{patient:t,onClose:()=>n(!1)}),(0,_.tZ)("div",{css:r.g.classes.flex_grow,children:lng("patient").caps()}),(0,_.tZ)("div",{css:r.g.classes.margin_far("5px"),children:(0,_.BX)(d.l,{theme:"outlined",onClick:()=>n(!0),children:[t.patient_first_name," ",t.patient_last_name]})})]})},F=(0,n.iv)("._syllabus{}._summary{",r.g.classes.margin_near("15px"),";}",""),M=e=>{let{ws:t,...i}=e;const[n,r]=(0,s.useState)(!1),{syllabus_text:a,syllabus_url:l,syllabus_file:p,summary_data:u}=t,m=t.group_id||t.id;return a||l||p||u?(0,_.BX)("div",{css:F,...i,children:[n&&(0,_.tZ)(o.T,{title:lng("syllabus").caps(),onClose:()=>r(!1),children:(0,c.rj)(a)}),p&&(0,_.tZ)(d.l,{theme:"outlined",className:"_syllabus",href:{file:"type=syllabus&group_id="+m},newTab:!0,children:lng("syllabus").caps()}),a&&(0,_.tZ)(d.l,{theme:"outlined",className:"_syllabus",onClick:()=>r(!0),children:lng("syllabus").caps()}),l&&(0,_.tZ)(d.l,{theme:"highlight",className:"_syllabus",href:l,newTab:!0,children:lng("syllabus").caps()}),u&&(0,_.tZ)(v.Tt,{className:"_summary",groupId:m})]}):null},A=(0,n.iv)("&._users{display:flex;align-items:center;justify-content:space-between;min-width:150px;>div{margin:0 5px;}>div:first-of-type{text-align:center;>div{color:",r.g.colors.text_sec,";}}}",""),q=e=>{let{ws:t}=e;if(!(t.group_options.show_members&&t.features.users||t.mayEditMembers()))return null;const i="Course_template"===t.group_type;if(i&&(0,c.xb)(t.waitingList))return null;const n=i?lng("waiting list"):lng("members");return(0,_.BX)("div",{className:"_users",css:A,children:[(0,_.BX)("div",{children:[(0,_.tZ)("div",{children:n.caps()}),(0,_.tZ)("b",{children:i?t.waitingList.length:t.users_count})]}),(0,_.tZ)("div",{css:r.g.classes.flex_grow}),(0,_.tZ)(d.l,{theme:"contained",onClick:()=>t.tab=i?"waiting_list":"members",children:lng("see all").caps()})]})},X={name:"15rzxwi",styles:"&._manager{display:flex;align-items:center;._label{padding:0 10px;}}"},L=e=>{let{ws:t}=e;const{manager:i,group_options:n,is_owner:r,features:s}=t,{managers_primary:o,managers_managers:a,managers_viewers:p,managers_inherited:u}=n;return[o,a,p,u].some((e=>e))||r?(r||(0,c.B5)(null==i?void 0:i.user_id))&&(0,_.BX)("div",{className:"_manager",css:X,children:[(0,c.B5)(null==i?void 0:i.user_id)&&(o||r)&&(0,_.BX)(m.c_,{children:[(0,_.tZ)(l.qE,{user:i,size:"42px"}),(0,_.BX)("div",{className:"_label",children:[(0,_.tZ)("b",{children:i.full_name}),(0,_.tZ)("br",{}),lng("manager").caps()]})]}),(0,_.tZ)(m.zh,{}),(s.users||r)&&(0,_.tZ)("div",{children:(0,_.tZ)(d.l,{theme:"contained",onClick:()=>t.tab="managers",children:lng("see managers").caps()})})]}):null},$=e=>{let{ws:t}=e;return t.creditRequired?(0,_.BX)("div",{children:[(0,_.BX)("div",{children:[lng("credits required").caps(),": ",t.creditRequired]}),(0,_.BX)("div",{children:[lng("credits earned").caps(),": ",t.userCredit]})]}):null},V=e=>{let{ws:t}=e;return t.creditOnCompletion>0?(0,_.BX)("div",{children:[lng("credit units given on completion").caps(),": ",t.creditOnCompletion]}):null}},6059:(e,t,i)=>{i.d(t,{P:()=>n});const n={hasPermission:function(e){var t,i;return!!Blsm.user.isPowerManager||!(null===(t=Blsm.InitialData)||void 0===t||null===(i=t.permissions)||void 0===i||!i[e])},canAccessModule:function(e){var t=e.split("|");for(var i in t){var n,r;if(null!==(n=Blsm.InitialData)&&void 0!==n&&null!==(r=n.modules)&&void 0!==r&&r[t[i]])return!0}return!1},isFeatureEnabled:function(e){var t,i;return!(null===(t=Blsm.InitialData)||void 0===t||null===(i=t.features)||void 0===i||!i[e])},checkMod(e){var t;if(!e)return!0;const i={ENT:1,PRO:2}[e[1]];return(!e[0]||Blsm.isFeatureEnabled(e[0])||Blsm.canAccessModule(e[0]))&&(!i||i>=(null===(t=Blsm.InitialData)||void 0===t?void 0:t.plan))},isGuiFeatureEnabled:function(e){var t,i;return!(null===(t=Blsm.InitialData)||void 0===t||null===(i=t.gui_features)||void 0===i||!i[e])},GuiFeatureValue:function(e){var t,i;return null===(t=Blsm.InitialData)||void 0===t||null===(i=t.gui_features)||void 0===i?void 0:i[e]},ManagerPermissions:{MEMBERS_DIRECTOR:"members_director|1",CREATE_ASSIGNMENTS:"perm_assignments|1",SET_WEIGHTS:"perm_assignments|2",CREATE_MEETINGS:"perm_meetings|1",EDIT_MEETINGS:"perm_meetings|2",SET_ATTENDANCE:"perm_meetings|3",CONTENT_SHARE:"perm_content|1",VIEW_EVALUATIONS:"perm_evaluation|1",GRADES_MANAGEMENT:"perm_grades_management|1",CREATE_PORTAL:"perm_portal|1",GENERAL_CONFIG:"perm_config|1",VIEW:"view",MANAGE:"manage",GROUP_ACTIVE:"0",GROUP_MANAGERS_ONLY:"1",GROUP_INVISIBLE:"2"},CanUser:function(e,t,i){var n,r,s,o=null===(n=Blsm.InitialData)||void 0===n||null===(r=n.base_permissions)||void 0===r||null===(s=r[t])||void 0===s?void 0:s[e];return i?o&&o[i]:o&&o.no_options},GetDomainGeneralOption:function(e){var t,i;return null===(t=Blsm.InitialData)||void 0===t||null===(i=t.general_options)||void 0===i?void 0:i[e]}}},7363:e=>{e.exports=React},1533:e=>{e.exports=ReactDOM},7821:e=>{e.exports=mobx},5560:e=>{e.exports=mobxReactLite},7657:e=>{e.exports=moment},2334:(e,t,i)=>{i.d(t,{CR:()=>u,ER:()=>c,FT:()=>m,GG:()=>s,KC:()=>g,Mx:()=>n,WQ:()=>b,_3:()=>o,_9:()=>r,f1:()=>h,k6:()=>a,xt:()=>d,zk:()=>p});const n=6e4,r=36e5,s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&a(o(e,t),t)},o=function(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e instanceof moment?e:e?("string"==typeof e&&/^\d+$/.test(e)&&(e=+e),"object"!=typeof e||e instanceof moment||e instanceof Date||(e=(e.date||"")+" "+(e.hour||"")),"string"!=typeof e||/^\d{4}-\d\d-\d\d/.test(e)||(t=moment(e,Blsm.prm.datetime_moment_format)),"number"==typeof e&&e<9e9&&(e*=1e3),t||(t=i.utc?moment.utc(e):moment(e)),void 0!==t._tzm&&t.utcOffset(t._tzm),t):void 0},a=(e,t)=>{const i=b().startOf("day");if(!e)return;let n={date:!0,time:!0,year:!0,leading_zero:!1,named_month:!1,format:!1,html5format:!1,relative:!1,obj:!1,...t},r={};if(void 0!==e._tzm&&e.utcOffset(e._tzm),n.relative&&e.isAfter(i))return l(e);if(n.html5format)return e.format(Blsm.prm[(n.date?"date":"")+(n.time?"time":"")+"_input_format"]);if(n.format)return e.format(n.format);let s=e.format(n.year?Blsm.prm.date_moment_format:Blsm.prm.short_date_moment_format),o=e.format(Blsm.prm.time_moment_format);return n.hideMidnight&&/^0+\D0+$/.test(o)&&(o=""),n.obj?(n.date&&(r.date=s),n.time&&(r.hour=o),r):(r="",(!0===n.date||"not_today"===n.date&&e.isBefore(i))&&(r=s),!n.time&&r||(r+=(r?" ":"")+o),r)},l=e=>{let t=parseInt(Date.now()/1e3),i=t-e.unix();return i<60?lng("few seconds ago"):(i=Math.round(i/60),i<2?lng("one minute ago"):i<60?lng("%s minutes ago",i):e.format("M-D-Y")!==o(t).format("M-D-Y")?a(e,{time:!1}):a(e,{date:!1}))},c=function(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"+",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{repeat:!1,stopDate:null,stopAfter:!1};const s=r.stopDate||b();let o,a;"+"===n?(o=r.stopAfter&&!r.repeat?"isAfter":"isBefore",a="add",s.add(5,"minute")):(o="isAfter",a="subtract",s.subtract(5,"minute"));const l=i.clone();if(l[a](t,e),!(l[o](s)||r.stopAfter&&r.repeat))return!1;if(r.repeat&&t>0){let i,n=!0;for(;;){if(i=l.clone(),n||l[a](t,e),!l[o](s))return r.stopAfter&&!n&&i.add(t,e),i.format(Blsm.prm.date_moment_format);n&&(n=!1)}}return l.format(Blsm.prm.date_moment_format)},d=e=>moment.utc(1e3*e).format("HH:mm:ss"),p=e=>e.isSame(new Date,"day"),u=e=>e.isBefore(new Date),m=(e,t)=>e.isSame(t,"year"),g=(e,t)=>e.isSame(t,"day"),h=(e,t)=>t.diff(e)<864e5&&!g(e,t),b=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=new moment(...t);return n.utcOffset(Blsm.prm.timezone_offset),n}},1125:(e,t,i)=>{i.d(t,{vy:()=>n,wj:()=>r});let n={ActionsSubmit:"far fa-caret-square-down",AssignActivity:"far fa-clipboard-check",AssignOutsource:"fas fa-share-square",AssignReview:"fas fa-users",accessibility:"fal fa-glasses",align_center:"far fa-align-center",align_left:"far fa-align-left",align_right:"far fa-align-right",arrow_down:"fas fa-chevron-down",arrow_down_double:"fas fa-chevrons-down",arrow_go_left:"far fa-arrow-left",arrow_go_right:"far fa-arrow-right",arrow_left:"fas fa-chevron-left",arrow_left_double:"fas fa-chevrons-left",arrow_out_square:"far fa-arrow-up-right-from-square",arrow_right:"fas fa-chevron-right",arrow_right_double:"fas fa-chevrons-right",arrow_to_left:"far fa-arrow-to-left",arrow_to_right:"far fa-arrow-to-right",arrow_up:"fas fa-chevron-up",arrow_up_double:"fas fa-chevrons-up",asterisk:"fas fa-asterisk",attachment:"far fa-paperclip",auto_enrolled:"fas fa-sync-alt",back:"fas fa-reply","badge-airplane":"fas fa-plane","badge-ambulance":"fas fa-ambulance","badge-badge":"fas fa-award","badge-bananas":"fas fa-sausage","badge-beer":"fas fa-beer","badge-bicycle":"fas fa-biking","badge-branch":"fas fa-leaf-maple","badge-bulb":"fas fa-lightbulb","badge-bus":"fas fa-bus","badge-cake":"fas fa-birthday-cake","badge-car":"fas fa-car","badge-cherries":"fas fa-apple-alt","badge-chilis":"fas fa-pepper-hot","badge-clapper":"fas fa-ticket","badge-fire":"fas fa-fire","badge-flag":"fas fa-flag","badge-flower":"fas fa-flower-tulip","badge-globe":"fas fa-globe-stand","badge-good-mood":"fas fa-smile-beam","badge-graduation":"fas fa-diploma","badge-ice-crystal":"fas fa-snowflake","badge-juice":"fas fa-glass-citrus","badge-leaf":"fas fa-leaf","badge-lifting":"fas fa-whistle","badge-lightning":"fas fa-bolt","badge-line-chart":"fas fa-chart-bar","badge-love":"fas fa-heart","badge-medal":"fas fa-medal","badge-mobile-phone":"fas fa-mobile-android-alt","badge-money-bag":"fas fa-sack-dollar","badge-moon":"fas fa-moon","badge-old-phone":"fas fa-phone-rotary","badge-open-book":"fas fa-book-open","badge-rain":"fas fa-cloud-showers-heavy","badge-rising-graph":"fas fa-chart-line","badge-running":"fas fa-running","badge-shield":"fas fa-shield-alt","badge-ski":"fas fa-skiing","badge-strech":"fas fa-boxing-glove","badge-sun":"fas fa-sun","badge-swimming":"fas fa-swimmer","badge-target":"fas fa-bullseye-arrow","badge-taxi":"fas fa-taxi","badge-tea-cup":"fas fa-mug-tea","badge-traffic-light":"fas fa-traffic-light","badge-train":"fas fa-train","badge-tree":"fas fa-tree-alt","badge-trophy":"fas fa-trophy","badge-video-camera":"fas fa-camera-movie","badge-wine-glasses":"fas fa-champagne-glasses","badge-wrench-screw":"fas fa-tools",bold:"far fa-bold",bookmark:"far fa-star",bookmark_half:"far fa-star-half-stroke",bookmark_filled:"fas fa-star",bug:"fas fa-bug",bullseye:"fas fa-bullseye-pointer",burger:"fas fa-bars",broken_graph:"far fa-chart-pie",by_mail:"far fa-envelope",cactus:"fal fa-cactus",calendar:"fas fa-calendar-alt",call:"fas fa-phone-alt",camera:"fas fa-camera",canban:"far fa-square-kanban",caret_down:"fas fa-caret-down",caret_up:"fas fa-caret-up",chalkboard:"fas fa-chalkboard",challenge:"fas fa-bullseye-arrow",channel:"fas fa-signal-stream",chat:"fas fa-comment-dots",chat_info:"far fa-comment-exclamation",checkbox:"far fa-square",checkbox_checked:"fas fa-check-square",checkbox_half:"fas fa-square-minus",cheers:"fas fa-champagne-glasses",circle:"far fa-circle",circle_dot:"far fa-circle-dot",clear:"far fa-minus-hexagon",clock:"far fa-clock",clone:"far fa-clone",close:"fas fa-times",close_circle:"far fa-circle-xmark",coach:"fas fa-chalkboard-teacher",collapse_all:"far fa-compress-alt",content:"fas fa-book-open",copy:"far fa-copy",course:"fas fa-graduation-cap",create:"fas fa-pen-square",crop:"fas fa-crop",cupcake:"far fa-birthday-cake",desktop:"fas fa-briefcase",details:"far fa-list-alt",digging:"fas fa-person-digging",diploma:"far fa-diploma",discussion:"far fa-comments-alt",dislike:"fas fa-thumbs-down",download:"fas fa-download",edit:"fas fa-pencil-alt",empty:"",empty_cart:"fas fa-dolly-empty",enter:"fas fa-sign-in-alt",entity_assignment:"fas fa-clipboard-check",entity_course:"fas fa-graduation-cap",entity_event:"fas fa-calendar-star",entity_external:"fas fa-suitcase-rolling",entity_group:"fas fa-people-group",entity_meeting:"fas fa-calendar-alt",entity_org_unit:"fas fa-sitemap",entity_qualification:"fas fa-stamp",entity_share:"fas fa-book-open",entity_workplan:"fas fa-briefcase",equals:"far fa-equals",event:"fas fa-calendar-star",explanation_box:"fas fa-comment-alt-plus",exit:"fas fa-sign-out-alt",exit_bookmark:"fas fa-cogs",exit_full_screen:"fas fa-compress",exit_portal:"fal fa-portal-exit",expand_all:"far fa-expand-alt",export:"fas fa-file-export",external_content:"fas fa-puzzle",face_frown:"far fa-face-frown",face_frown_full:"fas fa-face-frown",face_frown_slight:"far fa-face-frown-slight",face_frown_slight_full:"fas fa-face-frown-slight",face_meh:"far fa-face-meh",face_meh_full:"fas fa-face-meh",face_smile:"far fa-face-smile",face_smile_full:"fas fa-face-smile",face_smile_beam:"far fa-face-smile-beam",face_smile_beam_full:"fas fa-face-smile-beam",feedback:"fas fa-comment-alt-edit",filter:"far fa-filter",fire:"fas fa-fire",font:"far fa-font",for_u:"fas fa-hand-holding-seedling",forward:"fas fa-share",fresh:"far fa-sparkles",full_screen:"fas fa-expand",fullscreen:"fas fa-expand",game:"fas fa-gamepad-alt","globe-americas":"fas fa-globe-americas",go_arrow:"fas fa-arrow-right",go_backward:"fas fa-backward",go_forward:"fas fa-forward",google:"fab fa-google",group:"fas fa-user-friends",hierarchy:"fas fa-folder-tree",history:"fas fa-history",home:"fas fa-home",image:"far fa-image",import:"fas fa-file-plus",inactive_user:"fas fa-user-slash",inactive_users:"fas fa-users-slash",info:"far fa-info-circle",island_tropic:"fas fa-island-tropical",italic:"far fa-italic",kiosk:"fas fa-tablet-alt",label:"fas fa-tag",light_bulb:"fal fa-lightbulb-on",like:"fas fa-thumbs-up",link:"far fa-link",list:"far fa-list",list_music:"fas fa-list-music",list_ol:"fas fa-list-ol",location:"fas fa-location-dot",lock:"fas fa-lock-alt",lock_open:"fas fa-lock-open-alt",love:"far fa-heart",love_full:"fas fa-heart",mailbox:"fas fa-inbox",manager:"fas fa-user-tie",map_spot:"fas fa-map-marked-alt",mark_plus:"far fa-plus",mark_plus_light:"far fa-plus",mark_v:"fas fa-check",mark_v_light:"fas fa-check",mark_v_strong:"fas fa-check",mark_x:"fas fa-times",mark_x_light:"fas fa-times",media:"far fa-photo-video",meeting:"fas fa-users-class",menu:"far fa-ellipsis-v",menu_calendar:"fas fa-calendar-alt",menu_dashboard:"fas fa-tachometer-alt",menu_h:"far fa-ellipsis-h",menu_info:"fas fa-info-circle",menu_library:"fas fa-book-open",menu_management:"fas fa-cog",menu_messages:"fas fa-inbox",menu_overview:"fas fa-clipboard-check",menu_workspaces:"fas fa-briefcase",message:"fas fa-envelope",message_dots:"far fa-message-dots",mfa:"far fa-shield",mfa_on:"far fa-shield-check",minimize:"far fa-window-minimize",mng_approvals:"fas fa-file-certificate",mng_budget:"fas fa-wallet",mng_courses:"fas fa-graduation-cap",mng_domain:"fas fa-server",mng_elearning:"fas fa-clipboard-check",mng_qualifications:"fas fa-stamp",mng_resources:"fas fa-box-open",mng_settings:"fas fa-cog",mng_site:"fas fa-at",mng_users:"fas fa-users",mobile:"fas fa-mobile-alt",move:"fas fa-arrows-alt",new:"far fa-plus-square",no_entry:"fas fa-ban",notice:"fas fa-megaphone",notifications:"far fa-bell",notifications_off:"far fa-bell-slash",online_content:"fas fa-globe-americas",open:"fas fa-folder-open",open_answer:"far fa-pen-field",order:"far fa-list-ol",pause:"fas fa-pause",party_horn:"fas fa-party-horn",pen_to_square:"fas fa-pen-to-square",phone:"fas fa-mobile-alt",photos:"far fa-images",pin:"far fa-thumbtack",pin_filled:"fas fa-thumbtack",placeholder:"far fa-brackets-curly",play:"fas fa-play",pointer:"fas fa-map-marker",pointer_alt:"fas fa-map-marker-alt",poll:"fas fa-poll",popout:"fas fa-external-link",portal:"fas fa-archway",pretend:"fas fa-mask",preview:"fas fa-eye","preview-off":"fas fa-eye-slash",print:"fas fa-print",publish_grade:"fas fa-user-graduate",qrcode:"fas fa-qrcode",stretch:"fas fa-up-right-and-down-left-from-center",unstretch:"fas fa-down-left-and-up-right-to-center",question_category_matching:"far fa-network-wired",question_checklist:"far fa-hexagon-check",question_completion:"far fa-input-text",question_date_time:"far fa-calendar-clock",question_hotspot:"far fa-square-up-right",question_matching:"far fa-puzzle-piece",question_matching_arrows:"far fa-arrows-left-right",question_media:"far fa-image-landscape",question_multiple_choice:"far fa-list",question_rating_scale:"far fa-star",question_signature:"far fa-signature",question_single_textbox:"far fa-square-question",question_sorting:"far fa-bars-sort",question_table_question:"far fa-table",question_user_field:"far fa-address-card",radio:"far fa-circle",radio_checked:"fas fa-check-circle",radio_full:"fas fa-circle",receipt:"fas fa-file-invoice-dollar",recommend:"fal fa-hand-holding-seedling",recycle:"fas fa-recycle",reload:"fas fa-redo",reply:"fas fa-reply",reply_all:"fas fa-reply-all",report:"fas fa-chart-column",required:"fas fa-star-of-life",rescue:"far fa-comment-alt-medical",reset:"fas fa-undo",sand_clock:"fas fa-hourglass-end",save:"far fa-save",search:"fas fa-search",send:"fas fa-paper-plane",send_comment:"fas fa-paper-plane-top",send_schedule:"fal fa-envelope-open-text",settings:"fas fa-cog",share:"fas fa-share-alt",shuffle:"fas fa-random",sign_minus:"fas fa-minus-circle",sign_notification:"fas fa-exclamation-circle",sign_ok:"far fa-check-circle",sign_plus:"fas fa-plus-circle",signature:"fas fa-file-signature",skill:"fas fa-brain",skill_l0:"fas fa-paper-plane",skill_l1:"fas fa-helicopter",skill_l2:"fas fa-fighter-jet",skill_l3:"fas fa-space-shuttle",skill_unranked:"fas fa-circle-question",slack:"fab fa-slack",sort:"fas fa-sort",sort_down:"fad fa-sort-down",sort_grip:"fas fa-grip-dots-vertical",sort_up:"fad fa-sort-up",sparkles:"fas fa-sparkles",split:"fas fa-users-class",strikethrough:"far fa-strikethrough",suitcase:"fas fa-suitcase",support:"fas fa-headset",support_login:"fas fa-headset",switch_users:"fas fa-people-arrows",sync:"fas fa-sync-alt","task-updated":"far fa-flag",tasks:"fas fa-tags",telescope:"fas fa-telescope",tomato:"far fa-tomato",tomato_full:"fas fa-tomato",trash:"far fa-trash-alt",trash_all:"fas fa-broom",tree:"fas fa-project-diagram",triangle_down:"fas fa-caret-down",underline:"far fa-underline",upload:"fas fa-cloud-upload-alt",user:"fas fa-user",user_advanced_filter:"fas fa-users-cog",user_empty:"far fa-user",user_pin:"fas fa-id-badge",user_plus:"fas fa-user-plus",user_sync:"fas fa-users-cog",users:"fas fa-users",vendor_activity:"far fa-flag-checkered",vendor_assignment:"far fa-clipboard-check",vendor_audio:"far fa-file-audio",vendor_blog:"far fa-blog",vendor_checklist:"far fa-list-check",vendor_courseware:"far fa-file",vendor_dictionary:"far fa-spell-check",vendor_doc:"far fa-file-word",vendor_evaluation:"far fa-chart-simple",vendor_excel:"far fa-file-times",vendor_external:"far fa-link",vendor_faq:"far fa-question-square",vendor_file:"far fa-file",vendor_final:"far fa-badge-check",vendor_form:"far fa-file-lines",vendor_general:"far fa-file",vendor_glossary:"far fa-spell-check",vendor_html:"far fa-file-code",vendor_image:"far fa-file-image",vendor_lesson:"far fa-file",vendor_master:"far fa-archive",vendor_meeting:"far fa-stopwatch",vendor_pdf:"far fa-file-pdf",vendor_ppt:"far fa-file-powerpoint",vendor_scorm:"far fa-shapes",vendor_survey:"far fa-messages-question",vendor_swf:"far fa-shapes",vendor_test:"far fa-ballot-check",vendor_text:"far fa-text-size",vendor_tincan:"far fa-shapes",vendor_video:"far fa-file-video",vendor_wiki:"fab fa-wikipedia-w",view_list:"fas fa-bars",view_tiles:"fas fa-grid-2",visible_off:"fas fa-eye-low-vision",volume:"fas fa-volume",volume_mute:"fas fa-volume-mute",waiting_list:"fas fa-user-clock",warning_triangle:"fas fa-triangle-exclamation",width:"fas fa-arrows-h",wizard:"fas fa-magic",zoom_meeting:"fad fa-camera-home"};const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"arrow_far"===e?e="arrow_"+(t?"left":"right"):"arrow_near"===e&&(e="arrow_"+(t?"right":"left")),"arrow_to_far"===e?e="arrow_to_"+(t?"left":"right"):"arrow_to_near"===e&&(e="arrow_to_"+(t?"right":"left")),"arrow_go_far"===e?e="arrow_go_"+(t?"left":"right"):"arrow_go_near"===e&&(e="arrow_go_"+(t?"right":"left")),e in n?n[e]:(console.log(`unknown '${e}' icon`),"fas fa-bug")}}},s={};function o(e){var t=s[e];if(void 0!==t)return t.exports;var i=s[e]={id:e,loaded:!1,exports:{}};return r[e].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=r,e=[],o.O=(t,i,n,r)=>{if(!i){var s=1/0;for(d=0;d<e.length;d++){for(var[i,n,r]=e[d],a=!0,l=0;l<i.length;l++)(!1&r||s>=r)&&Object.keys(o.O).every((e=>o.O[e](i[l])))?i.splice(l--,1):(a=!1,r<s&&(s=r));if(a){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[i,n,r]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var r=Object.create(null);o.r(r);var s={};t=t||[null,i({}),i([]),i(i)];for(var a=2&n&&e;"object"==typeof a&&!~t.indexOf(a);a=i(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>e[t]));return s.default=()=>e,o.d(r,s),r},o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,i)=>(o.f[i](e,t),t)),[])),o.u=e=>({94:"alyssum.full_calendar",218:"alyssum.vendors.react-beautiful-dnd",263:"alyssum.reportspage",287:"alyssum.vendors.fullcalendar",340:"alyssum.vendors.d3",533:"alyssum.chart_bubble",547:"alyssum.chart",583:"alyssum.testpage",740:"alyssum.vendors.chartjs",800:"alyssum.edit_page",822:"alyssum.lists",833:"alyssum.vendors.react-xarrows",844:"alyssum.editor"}[e]+".js?hash="+{94:"dc0dbc0c056040b88c23",218:"eabc45963f952a56d4fb",263:"01f7df073a8827602efc",287:"8b129ae87c4e2c949ae0",340:"6b02d09fa9892c93aae9",533:"3a30c98b80840decfff1",547:"3465fe649fdc2c2d742c",583:"db823cc87963afae6179",740:"a000a366e6c2f1a7db0b",800:"71049da957f946d91a6e",822:"f6b506860417c104b978",833:"7a340c0b5a0d9f0175ec",844:"c6081ce1dabc90b4ef98"}[e]),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},o.l=(e,t,i,r)=>{if(n[e])n[e].push(t);else{var s,a;if(void 0!==i)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")=="ui:"+i){s=d;break}}s||(a=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.setAttribute("data-webpack","ui:"+i),s.src=e),n[e]=[t];var p=(t,i)=>{s.onerror=s.onload=null,clearTimeout(u);var r=n[e];if(delete n[e],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach((e=>e(i))),t)return t(i)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),a&&document.head.appendChild(s)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");i.length&&(e=i[i.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{o.b=document.baseURI||self.location.href;var e={770:0};o.f.j=(t,i)=>{var n=o.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var r=new Promise(((i,r)=>n=e[t]=[i,r]));i.push(n[2]=r);var s=o.p+o.u(t),a=new Error;o.l(s,(i=>{if(o.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,n[1](a)}}),"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,i)=>{var n,r,[s,a,l]=i,c=0;if(s.some((t=>0!==e[t]))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(l)var d=l(o)}for(t&&t(i);c<s.length;c++)r=s[c],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(d)},i=self.webpackChunkui=self.webpackChunkui||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),o.nc=void 0;var a=o.O(void 0,[866],(()=>o(6694)));a=o.O(a)})();